{
    "_initiator": {
        "type": "script",
        "stack": {
            "callFrames": [
                {
                    "functionName": "importWrapper",
                    "scriptId": "3",
                    "url": "https:\/\/www.instagram.com\/static_resources\/webworker\/init_script\/?worker_type=MODULE&__hs=19825.HYP%3Ainstagram_web_pkg.2.1..0.1&__spin_r=1012738129&__spin_b=trunk&__spin_t=1712935560",
                    "lineNumber": 0,
                    "columnNumber": 441
                },
                {
                    "functionName": "",
                    "scriptId": "3",
                    "url": "https:\/\/www.instagram.com\/static_resources\/webworker\/init_script\/?worker_type=MODULE&__hs=19825.HYP%3Ainstagram_web_pkg.2.1..0.1&__spin_r=1012738129&__spin_b=trunk&__spin_t=1712935560",
                    "lineNumber": 0,
                    "columnNumber": 892
                },
                {
                    "functionName": "processHRP",
                    "scriptId": "3",
                    "url": "https:\/\/www.instagram.com\/static_resources\/webworker\/init_script\/?worker_type=MODULE&__hs=19825.HYP%3Ainstagram_web_pkg.2.1..0.1&__spin_r=1012738129&__spin_b=trunk&__spin_t=1712935560",
                    "lineNumber": 0,
                    "columnNumber": 817
                },
                {
                    "functionName": "initMessageHandler",
                    "scriptId": "3",
                    "url": "https:\/\/www.instagram.com\/static_resources\/webworker\/init_script\/?worker_type=MODULE&__hs=19825.HYP%3Ainstagram_web_pkg.2.1..0.1&__spin_r=1012738129&__spin_b=trunk&__spin_t=1712935560",
                    "lineNumber": 0,
                    "columnNumber": 3142
                }
            ],
            "parentId": {
                "id": "2127",
                "debuggerId": "-771272715759562662.-2377773656252341762"
            }
        }
    },
    "_priority": "High",
    "_resourceType": "script",
    "cache": [],
    "request": {
        "method": "GET",
        "url": "https:\/\/static.cdninstagram.com\/rsrc.php\/v3\/yO\/r\/_bzeARGYj2A.js?_nc_x=Ij3Wp8lg5Kz",
        "httpVersion": "h3",
        "headers": [
            {
                "name": "Referer",
                "value": "https:\/\/www.instagram.com\/"
            },
            {
                "name": "Origin",
                "value": "https:\/\/www.instagram.com"
            },
            {
                "name": "User-Agent",
                "value": "Mozilla\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/123.0.0.0 Safari\/537.36"
            }
        ],
        "queryString": [
            {
                "name": "_nc_x",
                "value": "Ij3Wp8lg5Kz"
            }
        ],
        "cookies": [],
        "headersSize": -1,
        "bodySize": 0
    },
    "response": {
        "status": 200,
        "statusText": "",
        "httpVersion": "h3",
        "headers": [
            {
                "name": "date",
                "value": "Fri, 12 Apr 2024 15:26:12 GMT"
            },
            {
                "name": "content-encoding",
                "value": "zstd"
            },
            {
                "name": "x-content-type-options",
                "value": "nosniff"
            },
            {
                "name": "content-md5",
                "value": "9u1u3z\/XlUapm62c6raZ7A=="
            },
            {
                "name": "document-policy",
                "value": "force-load-at-top"
            },
            {
                "name": "cross-origin-resource-policy",
                "value": "cross-origin"
            },
            {
                "name": "alt-svc",
                "value": "h3=\":443\"; ma=86400"
            },
            {
                "name": "content-length",
                "value": "325177"
            },
            {
                "name": "reporting-endpoints",
                "value": "permissions_policy=\"https:\/\/www.facebook.com\/ajax\/browser_error_reports\/\""
            },
            {
                "name": "x-fb-connection-quality",
                "value": "GOOD; q=0.7, rtt=149, rtx=3244, c=194, mss=1232, tbw=10192905, tp=8346, tpl=3244, uplat=1, ullat=-1"
            },
            {
                "name": "x-fb-debug",
                "value": "QmLnLOTDP8XJGAwaVB4Iyf5K\/invWI7YMTEcFRZGyoVUcgo\/Pj8a49jS1vVEF2nTcrkLT6gfzhTreSKBOglEVA=="
            },
            {
                "name": "last-modified",
                "value": "Mon, 01 Jan 2001 08:00:00 GMT"
            },
            {
                "name": "vary",
                "value": "Origin"
            },
            {
                "name": "report-to",
                "value": "{\"max_age\":21600,\"endpoints\":[{\"url\":\"https:\\\/\\\/www.facebook.com\\\/ajax\\\/browser_error_reports\\\/\"}],\"group\":\"permissions_policy\"}"
            },
            {
                "name": "content-type",
                "value": "application\/x-javascript; charset=utf-8"
            },
            {
                "name": "access-control-allow-origin",
                "value": "https:\/\/www.instagram.com"
            },
            {
                "name": "origin-agent-cluster",
                "value": "?0"
            },
            {
                "name": "cache-control",
                "value": "public,max-age=31536000,immutable"
            },
            {
                "name": "permissions-policy",
                "value": "accelerometer=(), attribution-reporting=(), autoplay=(), bluetooth=(), camera=(), ch-device-memory=(), ch-downlink=(), ch-ect=(), ch-rtt=(), ch-save-data=(), ch-ua-arch=(), ch-ua-bitness=(), clipboard-read=(), clipboard-write=(), display-capture=(), encrypted-media=(), fullscreen=(self), gamepad=(), geolocation=(), gyroscope=(), hid=(), idle-detection=(), keyboard-map=(), local-fonts=(), magnetometer=(), microphone=(), midi=(), otp-credentials=(), payment=(), picture-in-picture=(), publickey-credentials-get=(), screen-wake-lock=(), serial=(), usb=(), window-management=(), xr-spatial-tracking=();report-to=\"permissions_policy\""
            },
            {
                "name": "timing-allow-origin",
                "value": "*"
            },
            {
                "name": "priority",
                "value": "u=1"
            },
            {
                "name": "expires",
                "value": "Fri, 11 Apr 2025 23:41:33 GMT"
            }
        ],
        "cookies": [],
        "content": {
            "size": 2131719,
            "mimeType": "application\/x-javascript",
            "text": ";\/*FB_PKG_DELIM*\/\n\n__d(\"MAWAbPropsConverters\",[\"MAWAbPropsTypes\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"convertDbAbPropsToParsed: unsure how to read \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"convertAbPropsParsedToDbEntity: unsure how to read \",\"\"]);i=function(){return a};return a}function a(a){var b={expoKeyStr:a.expoKeyStr,internalExpoKeys:a.internalExpoKeys?Array.from(a.internalExpoKeys):[],lastSyncTime:a.lastSyncTime,refresh:a.refresh};a.abHash!=null&&(b.abHash=a.abHash);a.abKey!=null&&(b.abKey=a.abKey);if(a.propExpoKeys){var c=a.propExpoKeys,e=[];Object.keys(c).forEach(function(a){a=Number(a);var b={expoKey:a};c[a]!=null&&(b.value=c[a]);e.push(b)});b.propExpoKeys=e}if(a.propValues){var f=a.propValues,g=[];Object.keys(f).forEach(function(a){var b={name:a,value:{}};switch(typeof f[a]){case\"boolean\":b.value.boolValue=f[a];break;case\"number\":b.value.intValue=f[a];break;case\"string\":b.value.strValue=f[a];break;default:d(\"WALogger\").WARN(i(),f[a]);return}g.push(b)});b.propValues=g}return b}function b(a){var b={expoKeyStr:a.expoKeyStr,internalExpoKeys:a.internalExpoKeys,lastSyncTime:a.lastSyncTime,propExpoKeys:a.propExpoKeys,refresh:a.refresh};a.hash!=null&&(b.abHash=a.hash);a.abKey!=null&&(b.abKey=a.abKey);if(a.propValues){var c=a.propValues,d={};Object.keys(c).forEach(function(a){c[a]!=null&&(d[a]=c[a])});b.propValues=d}return b}function c(a){var b=a.abHash,c=a.abKey,e=a.expoKeyStr,f=a.internalExpoKeys,g=a.lastSyncTime,i=a.propExpoKeys,j=a.propValues;a=a.refresh;b={abHash:b,abKey:c,expoKeyStr:e,lastSyncTime:g,refresh:a};f!=null&&(b.internalExpoKeys=new Set(f));if(i!=null){var k={};i.forEach(function(a){a.expoKey!=null&&(k[a.expoKey]=a.value)});b.propExpoKeys=k}if(j!=null){var l={};j.forEach(function(a){var b=a.name,c=d(\"MAWAbPropsTypes\").ABPropConfigs[b];if(c==null||c.length<3)return;c=c[2];switch(typeof c){case\"boolean\":l[b]=a.value.boolValue;return;case\"number\":l[b]=a.value.intValue;return;case\"string\":l[b]=a.value.strValue;return;default:d(\"WALogger\").WARN(h(),c);return}});b.propValues=l}return b}g.convertAbPropsParsedToDbEntity=a;g.convertAbPropsDataToParsed=b;g.convertDbAbPropsToParsed=c}),98);\n__d(\"WAAbPropsHelpers\",[\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"maybeUpdateExpoKeys: config_expo_key \",\" changed\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"maybeUpdateExpoKeys: deleting config_expo_key \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"maybeUpdatePropValues: deleting config \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"parseValue: unsure how to read \",\"\"]);k=function(){return a};return a}var l=86400,m=600,n=604800;function a(a){return a==null?l:Math.max(m,Math.min(n,a))}function o(a){var b=[];Object.keys(a).forEach(function(c){var d=a[c],e=d[0];d[1];d=d[2];if(typeof e!==\"number\")return;b.push({configName:c,configCode:e,configDefault:d})});return b}function b(a,b){a=a[b][0];return typeof a===\"number\"?a:null}function p(a,b){switch(typeof b){case\"boolean\":return a===\"1\";case\"number\":return parseFloat(a);case\"string\":return a;default:d(\"WALogger\").WARN(k(),a);return null}}function c(a,b){var c=new Map();b.forEach(function(a){var b=a.configCode,d=a.configValue;a=a.configExpoKey;c.set(b,{configValue:d,configExpoKey:a})});var d={},e={};o(a).forEach(function(a){var b=a.configName,f=a.configCode;a=a.configDefault;var g=c.get(f);if(g==null)return;var h=g.configValue;g=g.configExpoKey;h=p(h,a);h!=null&&(d[b]=h);e[f]=g!=null?g:null});return{values:d,expoKeys:e}}function e(a,b,c){var e=babelHelpers[\"extends\"]({},b,a),f={};Object.keys(e).forEach(function(a){if(c[a]==null){d(\"WALogger\").LOG(j(),a);return}f[a]=e[a]});return f}function f(a,b,c){var e=babelHelpers[\"extends\"]({},b,a),f={};a=o(c).map(function(a){return a.configCode});var g=new Set(a),j=new Set();Object.keys(e).forEach(function(a){a=parseInt(a,10);var c=b?b[a]:null;!g.has(a)?(d(\"WALogger\").LOG(i(),a),c!=null&&c.trim()&&j.add(c)):(e[a]!==c&&(d(\"WALogger\").LOG(h(),a),c!=null&&c.trim()&&j.add(c)),f[a]=e[a])});return{propExpoKeys:f,expoKeysToDelete:j}}function q(a,b){if(b==null)return;var c=b;a.forEach(function(a){c[\"delete\"](a)});if(c.size===0)return;return{internalExpoKeys:c,expoKeyStr:Array.from(c).join(\",\")}}g.maybeUpdateRefresh=a;g.asAbList=o;g.asAbCode=b;g.parseAbProps=c;g.maybeUpdatePropValues=e;g.maybeUpdateExpoKeys=f;g.maybeUpdateInternalExpoKeys=q}),98);\n__d(\"WAAbProps\",[\"WAAbPropsHelpers\",\"WAErr\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=null;function i(a){if(h)return h;else throw c(\"WAErr\")(\"abProps::\"+a+\" called before startAbProps\")}function a(a,b){h==null&&(h={db:a,config:b})}function b(){return i(\"getHash\").db.getHash()}function e(){return i(\"getRefreshSecs\").db.getRefreshSecs().then(function(a){return d(\"WAAbPropsHelpers\").maybeUpdateRefresh(a)})}function f(){return i(\"getConfig\").config}function j(){return i(\"getAbProps\").db.getAbProps()}function k(a){return i(\"getAbProps\").db.setAbProps(a)}g.startAbProps=a;g.getHash=b;g.getRefreshSecs=e;g.getConfig=f;g.getAbProps=j;g.setAbProps=k}),98);\n__d(\"WAAbPropConverters\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a){if(!a)return{};var b={};Object.keys(a).forEach(function(c){var d=a[c];d!=null&&(b[c]=d)});return b}f.convertAbPropsToPlainObject=a}),66);\n__d(\"WAAbPropsCache\",[\"WAAbPropConverters\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=86400;a=function(){function a(a){var b=a.abKey,c=a.abHash,d=a.lastSyncTime,e=a.expoKeyStr,f=a.refresh,g=a.internalExpoKeys,h=a.propExpoKeys,i=a.propValues;a=a.overridePropValues;this.$1=a!=null?a:{};this.$2=i;this.$4=c;this.$3=b;this.$5=d;this.$7=f;this.$6=e;this.$8=g;this.$9=h}var b=a.prototype;b.getAbProp=function(a){var b;return this.$1[a]!=null?this.$1[a]:(b=this.$2)==null?void 0:b[a]};b.getHash=function(){return this.$4};b.getRefreshSecs=function(){var a;return(a=this.$7)!=null?a:h};b.overrideAbProp=function(a,b){this.$1[a]=b};b.readAll=function(){var a={abKey:this.$3,hash:this.getHash(),refresh:this.getRefreshSecs(),lastSyncTime:this.$5||0};this.$9!=null&&(a.propExpoKeys=this.$9);this.$8!=null&&(a.internalExpoKeys=this.$8);this.$6!=null&&(a.expoKeyStr=this.$6);if(this.$2!=null){var b=this.$2;b!=null&&(a.propValues=d(\"WAAbPropConverters\").convertAbPropsToPlainObject(b),this.$1!=null&&(a.propValues=babelHelpers[\"extends\"]({},a.propValues,d(\"WAAbPropConverters\").convertAbPropsToPlainObject(this.$1))))}return a};b.rewrite=function(a){var b=a.abKey,c=a.abHash,d=a.lastSyncTime,e=a.expoKeyStr,f=a.refresh,g=a.internalExpoKeys,h=a.propExpoKeys;a=a.propValues;this.$2=a;this.$4=c;this.$3=b;this.$5=d;this.$7=f;this.$6=e;this.$8=g;this.$9=h};return a}();g.AbPropsCache=a}),98);\n__d(\"WAGetAbPropsApi\",[\"WAGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){return d(\"WAGlobals\").getDbImpls().getMeta().then(function(a){a=a.abProps;return a})};g.getAbProps=a}),98);\n__d(\"WASetAbPropsApi\",[\"WAGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){return d(\"WAGlobals\").getDbImpls().setMeta({abProps:a})};g.setAbProps=a}),98);\n__d(\"MAWAbProps\",[\"MAWAbPropsConverters\",\"MAWAbPropsToUI\",\"MAWAbPropsTypes\",\"MAWBridge\",\"Promise\",\"WAAbProps\",\"WAAbPropsCache\",\"WAGetAbPropsApi\",\"WALogger\",\"WASetAbPropsApi\",\"asyncToGeneratorRuntime\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"ABProps inited\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Starting ABProps store\"]);j=function(){return a};return a}var k;function a(){if(!k)throw c(\"err\")(\"Trying to get hash before AbProps gets initialized\");return(h||(h=b(\"Promise\"))).resolve(k.getHash())}function e(){if(!k)throw c(\"err\")(\"Trying to get refresh secs before AbProps gets initialized\");return(h||(h=b(\"Promise\"))).resolve(k.getRefreshSecs())}var l={getAbProps:function(){if(!k)throw c(\"err\")(\"Trying to read ABProps before they gets initialized\");return(h||(h=b(\"Promise\"))).resolve(k.readAll())},getHash:a,getRefreshSecs:e,setAbProps:function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b;a=d(\"MAWAbPropsConverters\").convertAbPropsDataToParsed(a);(b=k)==null?void 0:b.rewrite(a);yield d(\"WASetAbPropsApi\").setAbProps(d(\"MAWAbPropsConverters\").convertAbPropsParsedToDbEntity(a));m(a)});function c(b){return a.apply(this,arguments)}return c}()};function m(a){if(!a.propValues)return;a=d(\"MAWAbPropsToUI\").prepareAbPropsForUI(a.propValues);d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"abPropsUpdated\",{abProps:a})}function f(){return n.apply(this,arguments)}function n(){n=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){d(\"WALogger\").LOG(j());var a=(yield d(\"WAGetAbPropsApi\").getAbProps()),b={};a&&(b=d(\"MAWAbPropsConverters\").convertDbAbPropsToParsed(a));k=new(d(\"WAAbPropsCache\").AbPropsCache)(b);d(\"WAAbProps\").startAbProps(l,d(\"MAWAbPropsTypes\").ABPropConfigs);m(b);d(\"WALogger\").LOG(i())});return n.apply(this,arguments)}function o(a,b){if(k==null)throw c(\"err\")(\"Trying to override ABProp before they get initialized\");var e=k;e.overrideAbProp(a,b);m(d(\"MAWAbPropsConverters\").convertAbPropsDataToParsed(e.readAll()))}function p(a){return d(\"MAWAbPropsTypes\").ABPropConfigs[a][2]}function q(){if(!k)throw c(\"err\")(\"Trying to read ABProps before they get initialized\");return k.readAll()}function r(a){if(!k)throw c(\"err\")(\"Trying to read ABProp \"+a+\" before AbProps gets initialized\");var b=k.getAbProp(a);return b!=null?b:p(a)}g.getHash=a;g.getRefreshSecs=e;g.initAbProps=f;g.overrideAbProp=o;g.getAbDefault=p;g.getAbProps=q;g.getAbProp=r}),98);\n__d(\"WAArrayGroupBy\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a,b){var c=new Map();for(var d=0;d<a.length;d++){var e=b(a[d]),f=c.get(e);f==null?c.set(e,[a[d]]):f.push(a[d])}return Array.from(c.entries())}f.groupBy=a}),66);\n__d(\"MAWBulkEditMsgsTxns\",[\"FBLogger\",\"MAWAckLevel\",\"MAWBridgeMsg\",\"MAWBridgeTypesCreators\",\"MAWDbEditMsgHistory\",\"MAWDbEditMsgHistoryTxns\",\"MAWDexieTable\",\"MAWEBSwitch\",\"MAWEBUploadTrackingUtils\",\"MAWIndexedDb\",\"MAWJidUtils\",\"MAWLoadReplyMediaTxns\",\"MAWThreadSnippetForTextMsg\",\"MAWUnsafeCoerce\",\"WAArrayGroupBy\",\"WAGlobals\",\"WAJids\",\"WAMsgMap\",\"WAMsgType\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a,b,e){var f=[];for(var g=0;g<a.length;g++){var h=a[g],i=d(\"MAWJidUtils\").maybeToProtocolMsgId(h.author,h.threadJid,h.originalMsgExternalId);if(i!=null){i=(i=e.get(i))==null?void 0:i.msgId;i!=null?f.push(babelHelpers[\"extends\"]({},h,{editMsgHistoryId:d(\"MAWDbEditMsgHistory\").convertToEditMsgHistoryId64(b[g]),originalMsgId:i})):c(\"FBLogger\")(\"messenger_e2ee_web\").warn(\"[edit messagehistory] Failed to get the original msgId for a msg that has been edited.\")}}d(\"MAWIndexedDb\").afterTransaction({tag:\"EditMsgHistoryAdded\",value:f})}function a(a,b){var c=new Set(),e=[];b.forEach(function(a){var b=a.chatJid;a=a.msg;c.add(b);e.push(a.originalMsgExternalId)});return d(\"MAWDexieTable\").dexieAll([a.messages.where(\"externalId\").anyOf(e).toArray(),a.messages.where(\"quoteExternalId\").anyOf(e).toArray(),a.editMsgHistory.where(\"originalMsgExternalId\").anyOf(e).toArray(),a.threads.where(\"jid\").anyOf(Array.from(c)).toArray()]).then(function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return{editMsgHistory:d,originalMsgs:b,quoteMessages:c,threads:a}})}function b(a,b,e){var f=e.editMsgHistory,g=e.originalMsgs,j=e.quoteMessages;e=e.threads;var k=new Map(e.map(function(a){return[a.jid,a]})),l=g.reduce(function(a,b){var c=d(\"MAWJidUtils\").toProtocolMsgId(b);return c==null?a:a.set(c,b)},new((e=d(\"WAMsgMap\")).MsgMap)()),m=f.reduce(function(a,b){var c=d(\"MAWJidUtils\").toProtocolMsgId(b);return c==null?a:a.set(c,b)},new e.MsgMap()),n=new e.MsgMap(),o=new e.MsgMap(),p=[];b.forEach(function(a){var b,e=a.chatJid;a=a.msg;var f=d(\"MAWJidUtils\").maybeToProtocolMsgId(a.author,e,a.originalMsgExternalId);if(f==null)throw c(\"err\")(\"Cannot get the protocol id for the edit action with external id %s\",a.originalMsgExternalId);p.push(i(a,e));b=(b=n.get(f))!=null?b:0;n.set(f,b+1);if(m.get(f)==null&&b===0){b=l.get(f);if(b==null)throw c(\"err\")(\"Cannot find the original msg with externalId \"+f.externalId+\" for the edit action.\");if(b.type!==d(\"WAMsgType\").MSG_TYPE.TEXT)throw c(\"err\")(\"Msg other than text cannot be edited.\");p.push(i(b,e))}b=o.get(f);e=b==null?void 0:b.serverTs;b=a==null?void 0:a.serverTs;(e==null||b==null||e<b)&&o.set(f,a)});return d(\"MAWDbEditMsgHistoryTxns\").bulkAddEditMsgHistory(a,p,!1).then(function(b){h(p,b,l);var e=new(d(\"WAMsgMap\").MsgMap)();o.entries().forEach(function(a){var b=a[0];a=a[1];var f=l.get(b);if(f==null)throw c(\"err\")(\"Cannot find the original msg for the edit action.\");if(f.type!==d(\"WAMsgType\").MSG_TYPE.TEXT)throw c(\"err\")(\"Msg other than text cannot be edited.\");c(\"MAWEBSwitch\").isEnabled()&&!d(\"WAGlobals\").getConfig().useEbUploadQueue()&&d(\"MAWEBUploadTrackingUtils\").startTrackingForMiddleware(f.externalId,d(\"WAMsgType\").MSG_TYPE.EDIT_ACTION,\"receive\");f=babelHelpers[\"extends\"]({},f,{editCount:((f=f.editCount)!=null?f:0)+((f=n.get(b))!=null?f:0),msgContent:a.editMsgContent});e.set(b,f)});b=d(\"WAArrayGroupBy\").groupBy(e.values(),function(a){a=a.threadJid;return(a=a)!=null?a:d(\"WAJids\").unsafeCoerceToChatJid(\"\")});b.forEach(function(a){var b=a[0];a=a[1];var e=k.get(b);if(e==null||a.length===0)return;b=a.filter(function(a){return a.msgId===e.newestMsg})[0];if(b!=null){a=b.author;if(a===\"@system\")throw c(\"err\")(\"[edit message] author should not be @system.\");a=d(\"WAJids\").userIdFromJid(a===\"@me\"?d(\"WAGlobals\").getMyUserJid():a);b=c(\"MAWThreadSnippetForTextMsg\")(b,a,d(\"WAJids\").interpretAsGroupJid(e.jid)!=null);var f=b.snippetParams;b=b.snippetType;d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadUpdated\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdatedThread({snippetParams:f,snippetSenderContactId:a,snippetType:b,threadId:e.chatId,threadJid:e.jid})})}});var f=j.map(function(a){var b=a.quote,f=a.quoteExternalId,g=a.threadJid;if(b==null){c(\"FBLogger\")(\"messenger_e2ee_web\").warn(\"[edit message] Failed to get the quoted content for a msg that has been quoted.\",a.externalId);return}g=d(\"MAWJidUtils\").maybeToProtocolMsgId(b.content.author,g,f);if(g==null)return;f=e.get(g);if(f==null)return;return babelHelpers[\"extends\"]({},a,{quote:babelHelpers[\"extends\"]({},b,{content:babelHelpers[\"extends\"]({},b.content,{msgContent:babelHelpers[\"extends\"]({},f.msgContent)})})})}).filter(Boolean);return a.messages.bulkPut(e.values().concat(f)).then(function(){e.values().forEach(function(b){return d(\"MAWLoadReplyMediaTxns\").getReplyMediaForMsgQuote(a,b).then(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgUpdated\",value:d(\"MAWBridgeMsg\").createBridgeMsg(b,void 0,a)})})})}).then(function(){f.forEach(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgUpdated\",value:d(\"MAWBridgeMsg\").createBridgeMsg(a)})})})})}function i(a,b){var c;return{author:a.author,editExternalId:a.externalId,editTs:(c=a.serverTs)!=null?c:a.ts,msgContent:(c=a.editMsgContent)!=null?c:d(\"MAWUnsafeCoerce\").unsafeCoerce(a.msgContent),originalMsgExternalId:(c=a.originalMsgExternalId)!=null?c:a.externalId,sendStatus:d(\"MAWAckLevel\").ACK.sent,specialTextSize:a.specialTextSize,threadJid:b}}g.prepareDataForMessageEdit=a;g.bulkEditMsgs=b}),98);\n__d(\"MAWDbReaction\",[\"MAWAckLevel\",\"MAWGlobals\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){if(a.reactToAuthor!==\"@me\"||a.reaction==null)return null;var b=a.author===\"@me\"||a.author===\"@system\"?null:a.author;return b==null?null:babelHelpers[\"extends\"]({},a,{author:b,reaction:a.reaction,reactToAuthor:a.reactToAuthor})}function b(a,b,c){var e=d(\"MAWGlobals\").getMyUserJid();return a.find(function(a){return a.threadJid===b&&d(\"WAJids\").authorToUserId(a.author,e)===d(\"WAJids\").authorToUserId(c,e)})}function c(a){return a}function e(a,b,c,e,f,g,h,i,j,k,l,m){m===void 0&&(m=d(\"MAWAckLevel\").ACK.clock);m={ack:m,author:k,externalId:b,groupingKey:g,reaction:f,reactionId:c,reactToAuthor:h,reactToExternalId:e,reactToMsgId:i,threadJid:a,ts:j};return l!=null?babelHelpers[\"extends\"]({},m,{rowId:l}):m}g.castToIncomingDbReaction=a;g.findMatchingReaction=b;g.reactionIdToMsgId=c;g.formatReactionForDb=e}),98);\n__d(\"MAWDbReactionUtils\",[\"MAWBridgeTypesCreators\",\"MAWIndexedDb\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){var c=a.author,e=a.reaction,f=a.reactToMsgId,g=a.threadJid;a=a.ts;if(f==null)return;d(\"MAWIndexedDb\").afterTransaction(e==null?{tag:\"DeleteReaction\",value:d(\"MAWBridgeTypesCreators\").createBridgeDeleteReaction({author:c,chatId:b,chatJid:g,reactToMsgId:f})}:{tag:\"UpsertReaction\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpsertReaction({author:c,chatId:b,chatJid:g,reaction:e||\"\",reactToMsgId:f,ts:a})})}g.dispatchReaction=a}),98);\n__d(\"MAWBulkPutReactionsWithThreadUpdateTxn\",[\"MAWDbReaction\",\"MAWDbReactionUtils\",\"MAWDbReactionsTxns\",\"MAWDexieTable\",\"MAWJidUtils\",\"MAWThreadSnippetBuildTxns\",\"WAArrayGroupBy\",\"WAJids\",\"WAMsgMap\",\"err\",\"qex\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a){return a.reduce(function(a,b){var c=d(\"MAWJidUtils\").maybeToProtocolMsgId(b.author,b.threadJid,b.reactToExternalId);if(c==null)return a;a.set(c,d(\"MAWDbReactionsTxns\").coerceToReaction(b));return a},new(d(\"WAMsgMap\").MsgMap)()).values()}function a(a,b,e){if(b.length===0)return d(\"MAWDexieTable\").dexieResolve();b=h(b);var f=b.map(function(a){var b=e.get(a.threadJid);if(b==null)throw c(\"err\")(\"Should not have got here - expect thread to exist for flow\");b=b.chatId;c(\"qex\")._(\"1215\")!==!0&&d(\"MAWDbReactionUtils\").dispatchReaction(a,b);return a});b=d(\"WAArrayGroupBy\").groupBy(f,function(a){a=a.threadJid;return a});b=b.map(function(b){var c=b[0];b=b[1];c=e.get(c);if(c==null||b.length===0)return null;var f=null;for(var g=b.length-1;g>=0;g--){f=d(\"MAWDbReaction\").castToIncomingDbReaction(b[g]);if(f!=null)break}g=b.filter(function(a){return a.reaction==null});b=d(\"WAJids\").interpretAsGroupJid(c.jid)!=null;return d(\"MAWThreadSnippetBuildTxns\").getThreadChangesetForReactionChanges(a,c,{newestReaction:f,reactionsToClear:g},b)}).filter(Boolean);return d(\"MAWDexieTable\").dexieAll(b).then(function(b){return d(\"MAWDexieTable\").dexieAll([a.threads.bulkPut(b),a.reactions.bulkPut(f)]).then(function(){})})}g.bulkPutReactionsWithThreadUpdates=a}),98);\n__d(\"MAWBulkWriteReactionsTxns\",[\"LSMEBTaskCreationSource\",\"MAWAuthor\",\"MAWBulkPutReactionsWithThreadUpdateTxn\",\"MAWDbMsg\",\"MAWDbReaction\",\"MAWDbReactionsTxns\",\"MAWDexieTable\",\"MAWEncryptedBackupCacheManager\",\"MAWGlobals\",\"MAWIndexedDb\",\"WAArrayGroupBy\",\"WAJids\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){var e=[],f=[];b.forEach(function(a){var b=a.chatJid;a=a.unstoredReaction;a=a.reactToExternalId;e.push(b);f.push(a)});return d(\"MAWDexieTable\").dexieAll([a.threads.where(\"jid\").anyOf(e).toArray(),a.messages.where(\"externalId\").anyOf(f).toArray(),a.reactions.where(\"reactToExternalId\").anyOf(f).toArray()]).then(function(e){var f=e[0],g=e[1];e=e[2];var h=new Map(f.map(function(a){return[a.jid,a]})),i=new Map(d(\"WAArrayGroupBy\").groupBy(g,function(a){return a.externalId})),j=new Map(d(\"WAArrayGroupBy\").groupBy(e,function(a){return a.reactToExternalId})),k=[];g=f.map(function(b){return d(\"MAWDbReactionsTxns\").getNextReactionIdNumberForThread(a,b).then(function(a){return[b.jid,a]})});return d(\"MAWDexieTable\").dexieAll(g).then(function(a){var e=new Map(a);b.forEach(function(a){var b=a.chatJid;a=a.unstoredReaction;var f=a.author,g=a.externalId,l=a.groupingKey,m=a.reaction,n=a.reactToAuthor,o=a.reactToExternalId,p=a.ts,q=h.get(b);if(q==null)return\"missing_thread\";b=e.get(q.jid);if(b==null)throw c(\"err\")(\"nextInChatReactionId should not be null\");e.set(q.jid,b+1);var r=j.get(a.reactToExternalId)||[];r=d(\"MAWDbReaction\").findMatchingReaction(r,q.jid,f);var s=d(\"MAWAuthor\").getAuthorUserJid(n),t=i.get(a.reactToExternalId);if(t==null&&d(\"MAWGlobals\").getConfig().useEbUploadQueue()&&!d(\"MAWEncryptedBackupCacheManager\").peekRestoreCache(a.reactToExternalId)){var u=d(\"WAJids\").threadIdForChatJid(q.jid);d(\"MAWEncryptedBackupCacheManager\").addMsgEntryToReuploadCache(q.chatId,a.reactToExternalId);d(\"MAWIndexedDb\").afterTransaction({tag:\"IssuePointQuery\",value:{jid:q.jid,messageId:a.reactToExternalId,startSortKey:void 0,taskSource:c(\"LSMEBTaskCreationSource\").EB_POINT_QUERY_IN_ACT,threadId:u}})}a=t==null?void 0:t.find(function(a){return a.thread===q.chatId&&s===d(\"MAWAuthor\").getAuthorUserJid(a.author)});t=d(\"MAWDbReaction\").formatReactionForDb(q.jid,g,d(\"MAWDbMsg\").craftReactionId(q.chatId,b),o,m,l,n,a==null?void 0:a.msgId,p,(u=f)!=null?u:d(\"WAJids\").AUTHOR_ME,r==null?void 0:r.rowId);k.push(t)});return{chatJidToDbThread:h,unstoredDbReactionsForInsertion:k}})})}function b(a,b){var c=b.chatJidToDbThread;b=b.unstoredDbReactionsForInsertion;return d(\"MAWBulkPutReactionsWithThreadUpdateTxn\").bulkPutReactionsWithThreadUpdates(a,b,c)}g.prepareReactionsData=a;g.bulkWriteReactions=b}),98);\n__d(\"MAWDbIdentityTxns\",[\"MAWAddQPLPointForHandleIncomingMsgApi\",\"MAWDexieTable\",\"MAWGlobals\",\"WAArrayZip\",\"WABaseGlobals\",\"WACryptoUtils\",\"WAJids\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Invalidate dhash for \",\"\"]);h=function(){return a};return a}function i(a,b){if(b==null)return void 0;a=d(\"WAJids\").isAuthorMe(a)?d(\"WABaseGlobals\").getMyUserJid():a;return d(\"WAJids\").toDeviceJid(a,b)}function a(a,b){var c=Array.from(b.map(function(a){return a.msgData}).reduce(function(a,b){var c=b.device;b=b.id;b=i(b.author,c==null?void 0:c.id);return b==null?a:a.add(b)},new Set())),e=new Map();return a.identity.bulkGet(Array.from(c)).then(function(a){d(\"WAArrayZip\").zip(c,a).forEach(function(a){var b=a[0];a=a[1];e.set(b,a==null);d(\"MAWAddQPLPointForHandleIncomingMsgApi\").addQPLPointForHIMApi(\"hasDeviceJid\",{bool:{knownDevice:a!=null}})});e.set(void 0,!0);return e})}function b(a,b){return j(a,b).then(function(a){return a.map(function(a){if(a==null)return;return{id:a.deviceJid,identity:a.identity}}).filter(Boolean)})}function c(a,b){return a.identity.bulkPut(b).then(function(){})}function e(a,b){return j(a,b).then(function(a){var c=new Map();for(var d=0;d<a.length;d++){var e=a[d],f=b[d];e!=null&&c.set(f,{pubKey:e.identity})}return c})}function j(a,b){return a.identity.bulkGet(b)}function k(a,b){return a.identity.where(\"userJid\").equals(b).toArray()}function f(a,b){return a.identity.where(\"userJid\").anyOf(b).toArray()}function l(a,b,c){var e=[],f=new Map();b.forEach(function(b){var d=k(a,b).then(function(a){var d=[];a.forEach(function(a){if(c!=null&&a.deviceJid===c)return;d.push(a)});d.length>0&&f.set(b,d)});e.push(d)});return d(\"MAWDexieTable\").dexieAll(e).then(function(){return f})}function m(a,b){var c=b.find(function(a){return a.deviceJid===d(\"MAWGlobals\").getMyDeviceJid()});if(c!=null)return a.identity.get(c.deviceJid).then(function(a){if(a!=null&&!d(\"WACryptoUtils\").uint8ArraysEqual(c.identity,a.identity))return!0;else return!1});else return d(\"MAWDexieTable\").dexieResolve(!1)}function n(a,b){d(\"WALogger\").DEV(h(),b);return a.contacts.bulkGet(b).then(function(b){b=b.filter(Boolean);b.forEach(function(a){a.dhash=null});return a.contacts.bulkPut(b)}).then(function(){})}g.getDeviceJid=i;g.bulkGetUnknownDeviceStatus=a;g.bulkGetIdentities=b;g.bulkPutIdentities=c;g.getIdentitiesForDevices=e;g.bulkGetIdentityRows=j;g.getIdentitiesForUser=k;g.getIdentitiesForUsers=f;g.getIdentitiesForMultipleUsers=l;g.compareIdentityMismatch=m;g.invalidateDhash=n}),98);\n__d(\"MAWDbRavenActionTxns\",[\"MAWBridgeTypesCreators\",\"MAWDbMsg\",\"MAWIndexedDb\",\"MAWMsg\",\"MAWRavenUtils\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,e){return a.messages.where(\"externalId\").equals(b.ravenActionToMsgExternalId).filter(function(a){return a.threadJid===e.jid}).first().then(function(f){var g=f==null?void 0:f.msgId;if(g==null)throw c(\"err\")(\"Cannot Write Raven Action without ID of Raven Message\");return h(a,f).then(function(c){var d=babelHelpers[\"extends\"]({msgId:g,thread:e.chatId,threadJid:e.jid},b);return a.unrenderedMessages.add(d).then(function(a){return babelHelpers[\"extends\"]({rowId:a},d)})}).then(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"RavenActionUpdate\",value:d(\"MAWBridgeTypesCreators\").createBridgeRavenAction(a)});return})})}function h(a,b){if((b==null?void 0:b.type)!==\"Raven\")throw c(\"err\")(\"Cannot Modify Message because Message is not Raven Message\");var e=[d(\"MAWMsg\").MAWRavenMsgEphemeralMediaState.cast(Number(b.ravenEphemeralMediaState)),d(\"MAWMsg\").MAWRavenMsgEphemeralType.cast(Number(b.ravenEphemeralType))],f=e[0];e=e[1];if(f==null||e==null)throw c(\"err\")(\"ravenEphemeralMediaStateEnum or ravenEphemeralTypeEnum is null\");f=d(\"MAWRavenUtils\").getNextRavenMessageEphemeralState(f,e);return a.messages.put(babelHelpers[\"extends\"]({},b,{ravenEphemeralMediaState:f}))}function b(a,b,c){c=d(\"MAWDbMsg\").isRavenActionMsgType(c)&&(b==null?void 0:b.externalId)!=null?[b.externalId]:[];return a.messages.where(\"externalId\").anyOf(c).filter(function(a){return a.author===(b==null?void 0:b.author)&&a.threadJid===(b==null?void 0:b.chat)}).first()}g.writeRavenActionMsg=a;g.modifyRavenMsgWithActionMsg=h;g.maybeGetRavenMsgQueryByProtocolMsgId=b}),98);\n__d(\"MAWMsgActionType\",[],(function(a,b,c,d,e,f){\"use strict\";a={DELETE_FOR_ME:\"DELETE_FOR_ME\",NO_ACTION:\"NO_ACTION\",REVOKE:\"REVOKE\",UPDATE_CIPHERTEXT:\"UPDATE_CIPHERTEXT\",UPDATE_CIPHERTEXT_WITH_ASSOCIATED:\"UPDATE_CIPHERTEXT_WITH_ASSOCIATED\",WRITE:\"WRITE\",WRITE_NEW:\"WRITE_NEW\",WRITE_WITH_ASSOCIATED:\"WRITE_WITH_ASSOCIATED\"};f.MSG_ACTION=a}),66);\n__d(\"MAWDbReceiptTxns\",[\"WAJids\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unexpectedly fetched null data from a msgIdToReceiptData map\"]);h=function(){return a};return a}function a(a,b,c,d){return i(a,[{deliveryReceipts:c===\"delivered\"?d:[],msgId:b,readReceipts:c===\"read\"?d:[],senderReceipts:c===\"sender\"?d:[]}]).then(function(a){return a[0]||{type:\"missing\"}})}function i(a,b){var c=b.map(function(a){return a.msgId}),e=new Map();b.forEach(function(a){e.set(a.msgId,a)});return a.receipts.where(\"msgId\").anyOf(c).toArray().then(function(b){var c=b.map(function(a){var b=e.get(a.msgId);if(b==null){d(\"WALogger\").ERROR(h());return null}var c=new Set(),f=a.statusTsPerUser,g=a.permittedIdentitiesPerDevice,i=b.deliveryReceipts,m=b.readReceipts;b=b.senderReceipts;[{receiptType:\"delivered\",receivers:i},{receiptType:\"read\",receivers:m},{receiptType:\"sender\",receivers:b}].forEach(function(a){var b=a.receiptType;a=a.receivers;a.forEach(function(a){var e=a.device;a=a.ts;var h=d(\"WAJids\").extractUserJid(e),i=!1;if(b!==\"sender\"){var l=f.get(h);if(l==null)return;a=j(l,b,a);f.set(h,a);i=k(l,a)}l=g!=null?g[\"delete\"](e):!1;(l||i)&&c.add(h)})});i=babelHelpers[\"extends\"]({},a,{permittedIdentitiesPerDevice:l(g),statusTsPerUser:f});return{affectedUserJids:c,receipt:i,type:c.size>0?\"updated\":\"unchanged\"}}).filter(Boolean);return a.receipts.bulkPut(c.map(function(a){return a.receipt})).then(function(){return c})})}function j(a,b,c){var d;d=(d=a==null?void 0:a.deliveredTs)!=null?d:c;a=a==null?void 0:a.readTs;b===\"read\"&&a==null&&(a=c);return{deliveredTs:d,readTs:a}}function k(a,b){return((b==null?void 0:b.deliveredTs)||0)>((a==null?void 0:a.deliveredTs)||0)||((b==null?void 0:b.readTs)||0)>((a==null?void 0:a.readTs)||0)}function l(a){if(a==null||a.size===0)return;return a}function b(a,b){return a.receipts.bulkDelete(b)}function c(a,b){return a.receipts.bulkGet(b)}g.writeReceiptsForDevices=a;g.bulkWriteReceiptsForDevices=i;g.bulkDeleteAllReceiptsForMessages=b;g.getReceipts=c}),98);\n__d(\"MAWIncomingReceiptUtils\",[\"WALogger\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"User \",\" is in affectedUserJids in receipt-writing results, but they have no corresponding read\/delivery receipt entry in the DB\"]);h=function(){return a};return a}function a(a){var b=new Map();a.forEach(function(a){if(a.type!==\"updated\"||a.msgRenderType===\"unrendered\")return;a.affectedUserJids.forEach(function(c){var e=a.receipt.statusTsPerUser.get(c);if(e==null){d(\"WALogger\").WARN(h(),c);return}c=[a.threadJid,c];var f=b.get(JSON.stringify(c)),g=e.deliveredTs!=null,i=e.readTs!=null;g=g?a.msgTs:0;i=i?a.msgTs:0;e=(e=e.readTs)!=null?e:0;if(f!=null){var j=f.lastDeliveredMsgTs,k=f.lastReadMsgTs;f=f.lastReadActionTs;g=Math.max(g,j);i=Math.max(i,k);e=Math.max(e,f)}b.set(JSON.stringify(c),{lastDeliveredMsgTs:d(\"WATimeUtils\").castToUnixTime(g),lastReadActionTs:d(\"WATimeUtils\").castToUnixTime(e),lastReadMsgTs:d(\"WATimeUtils\").castToUnixTime(i)})})});return new Map(Array.from(b).map(function(a){var b=a[0];a=a[1];return[JSON.parse(b),a]}))}g.getMaxTimestampsPerParticipant=a}),98);\n__d(\"MAWAckAndTimestampUpdatesForReceiptsTxns\",[\"MAWBridgeMsgCountdown\",\"MAWDbMsgTxns\",\"MAWDbParticipantTxns\",\"MAWDbUnrenderedMsgTxns\",\"MAWDexieTable\",\"MAWEphemeralCleaner\",\"MAWEphemeralGatingUtil\",\"MAWEphemeralMsgTxns\",\"MAWIncomingReceiptUtils\",\"MAWIndexedDb\",\"MAWLoggerUtils\",\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"EphemeralCounter: Showing UI counter for \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Updating timestamps for \",\" participants\"]);i=function(){return a};return a}var j=d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.Ephemeral,d(\"MAWLoggerUtils\").Tag.Countdown,d(\"MAWLoggerUtils\").Tag.Incoming]);function a(a,b,c,e){b=d(\"MAWIncomingReceiptUtils\").getMaxTimestampsPerParticipant(b);j.LOG(i(),b.size);var f=[];b.forEach(function(a,b){f.push({deliveredWatermarkTs:a.lastDeliveredMsgTs,lastReadActionTs:a.lastReadActionTs,lastReadWatermarkTs:a.lastReadMsgTs,participantKey:b})});b=c.regular.length>0?d(\"MAWDbMsgTxns\").bulkUpdateSystemAck(a,c.regular):d(\"MAWDexieTable\").dexieResolve();c=c.unrendered.length>0?d(\"MAWDbUnrenderedMsgTxns\").bulkUpdateSystemAckForUnrenderedMsgs(a,c.unrendered):d(\"MAWDexieTable\").dexieResolve();b=d(\"MAWDexieTable\").dexieAll([b,c]);return d(\"MAWDexieTable\").dexieAll([b,f.length>0?d(\"MAWDbParticipantTxns\").bulkUpdateParticipantTimestamps(a,f):d(\"MAWDexieTable\").dexieResolve(),!d(\"MAWEphemeralGatingUtil\").isSendBasedDisappearingMessageEnabled()&&e.length>0?d(\"MAWEphemeralMsgTxns\").bulkUpdateEphemeralMessageTimestamps(a,e,\"handleAckAndTimestampUpdatesForReceipts\"):d(\"MAWDexieTable\").dexieResolve([void 0,void 0,[]])]).then(function(a){a=a[2];var b=a[0],c=a[1];a=a[2];b!=null&&c!=null&&a.length>0&&(d(\"MAWEphemeralCleaner\").addNewEphemeralTimestamp(b,c),j.LOG(h(),a.map(function(a){return a.msgId})),d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgsStartCountdown\",value:d(\"MAWBridgeMsgCountdown\").createBridgeMsgsStartCountdown(a)}))})}g.handleAckAndTimestampUpdatesForReceipts=a}),98);\n__d(\"MAWDbPendingReceiptTxns\",[\"WAJids\",\"WAMsg\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){var c=b.map(function(a){var b=a.author,c=a.externalId;a=a.thread;return d(\"WAMsg\").craftWAMsgIdString({author:b,chat:a,externalId:c})});return a.pendingReceipts.where(\"id\").anyOf(c).toArray().then(function(c){var e=new Map();c.forEach(function(a){e.set(a.id,a)});var f=b.map(function(a){var b=a.author,c=a.externalId,f=a.thread,g=d(\"WAMsg\").craftWAMsgIdString({author:b,chat:f,externalId:c}),h=e.get(g),i=(h=h)!=null?h:{author:b,deliveryReceipts:[],externalId:c,id:g,readReceipts:[],thread:f};b===d(\"WAJids\").AUTHOR_ME?(a.deliveryReceipts.forEach(function(a){i.deliveryReceipts.push(a)}),a.readReceipts.forEach(function(a){i.readReceipts.push(a)})):(i.deliveryReceipts=[],a.readReceipts.forEach(function(a){i.readReceipts.push(a)}));return i});return a.pendingReceipts.bulkPut(f).then(function(){return f})})}function b(a,b){return a.pendingReceipts.bulkGet(b)}g.bulkAddPendingReceipts=a;g.getPendingReceipts=b}),98);\n__d(\"MAWIncomingReceiptDataFormatUtils\",[\"MAWAckLevel\",\"MAWDbMsg\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){var c=[],e=[];a.forEach(function(a){if(a.type!==\"updated\")return;var f=null,g=a.receipt.msgId,h=a.receipt.statusTsPerUser,i=b.get(g);if(i==null)return;var j=i.msg;i=i.renderType;a.affectedUserJids.forEach(function(a){var b,c=null;((b=h.get(a))==null?void 0:b.readTs)!=null?c=d(\"MAWAckLevel\").ACK.read:((b=h.get(a))==null?void 0:b.deliveredTs)!=null&&(c=d(\"MAWAckLevel\").ACK.received);f=f==null||c!=null&&c>f?c:f});f!=null&&f>j.ack&&(i===\"regular\"?c.push({ack:f,msgId:g,reportingMeta:null}):(i,e.push({ack:f,msgId:g})))});return{regular:c,unrendered:e}}function b(a,b,c){return a.map(function(a){var e=b.get(a.receipt.msgId);if(e==null)return null;var f=e.msg,g=c.get(f.msgId);return g==null||g.deliveryReceipts.length===0&&g.readReceipts.length===0?null:babelHelpers[\"extends\"]({},a,{externalId:f.externalId,msgRenderType:e.renderType,msgTs:d(\"MAWDbMsg\").getCanonicalTsFromMsg(f),threadId:f.thread,threadJid:f.threadJid})}).filter(Boolean)}g.createUpdateSystemAckParams=a;g.formatWriteReceiptResultsWithExtras=b}),98);\n__d(\"MAWReceiptTrace\",[\"ArmadilloDataTraceType\",\"MAWBridgeTrace\",\"MAWBridgeTraceEvent\",\"MAWIndexedDb\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){if(a===\"delivered\"){a=b.reduce(function(a,b){return b.type===\"updated\"&&b.externalId!=null?[].concat(a,[b.externalId]):a},[]);a.length>0&&d(\"MAWIndexedDb\").afterTransaction({tag:\"UpdateTrace\",value:d(\"MAWBridgeTrace\").createBridgeUpdateTraceData(a,c(\"MAWBridgeTraceEvent\").ReceivedReceipt,d(\"ArmadilloDataTraceType\").armadilloMessageSend)})}}g.flushTrace=a}),98);\n__d(\"MAWIncomingReceiptTxns\",[\"MAWAckAndTimestampUpdatesForReceiptsTxns\",\"MAWDbPendingReceiptTxns\",\"MAWDbReceiptTxns\",\"MAWDexieTable\",\"MAWEphemeralConsts\",\"MAWGlobals\",\"MAWIncomingReceiptDataFormatUtils\",\"MAWLoggerUtils\",\"MAWReceiptTrace\",\"WAJids\",\"WATagsLogger\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Message \",\" sent to \",\" has been read, countdown started\"]);h=function(){return a};return a}function a(a,b){if(b==null)return d(\"MAWDexieTable\").dexieResolve();var c=b.msgIdToDbMsgMap,e=b.pendingReceiptsToWrite,f=b.receiptsToWriteMap;b=Array.from(f.values());return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbReceiptTxns\").bulkWriteReceiptsForDevices(a,b),d(\"MAWDbPendingReceiptTxns\").bulkAddPendingReceipts(a,e)]).then(function(b){b=b[0];var e=d(\"MAWIncomingReceiptDataFormatUtils\").createUpdateSystemAckParams(b,c),g=i(b,c);b=d(\"MAWIncomingReceiptDataFormatUtils\").formatWriteReceiptResultsWithExtras(b,c,f);var h=b.filter(function(a){a=((a=f.get(a.receipt.msgId))==null?void 0:a.deliveryReceipts)||[];return a.length>0});h.length>0&&d(\"MAWReceiptTrace\").flushTrace(\"delivered\",h);return d(\"MAWAckAndTimestampUpdatesForReceiptsTxns\").handleAckAndTimestampUpdatesForReceipts(a,b,e,g)})}function i(a,b){var c=[];a.forEach(function(a){if(a.type!==\"updated\")return;var e=a.receipt.msgId,f=a.receipt.statusTsPerUser,g=b.get(e);if(g==null)return;if(g.renderType===\"unrendered\")return;g=g.msg;var i=g.author;g=g.ephemeralSetting;var j=g==null?void 0:g.ephemeralExpirationInSec;if(j==null||j===0)return;if(i!==d(\"WAJids\").AUTHOR_ME)return;a.affectedUserJids.forEach(function(a){if(a!==d(\"MAWGlobals\").getMyUserJid()){var b;b=(b=f.get(a))==null?void 0:b.readTs;if(b!=null){var g=d(\"WATimeUtils\").castToUnixTime(b+j),i=d(\"WATimeUtils\").castToUnixTime(g+d(\"MAWEphemeralConsts\").ephemeralReportingWindowInSeconds);d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.Ephemeral,d(\"MAWLoggerUtils\").Tag.PeerReceipt,d(\"MAWLoggerUtils\").Tag.Countdown]).LOG(h(),e,a);c.push({messageDeleteTs:i,messageExpirationTs:g,msgId:e,readTsForLogging:b})}}})});return c}g.bulkHandleIncomingReceipts=a;g.createUpdateEphemeralTimestampsParams=i}),98);\n__d(\"MAWMessageRequestUtils\",[\"MAWDbContact\",\"MAWFolderTypes\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){a=a===d(\"MAWFolderTypes\").FOLDER_ID.PENDING||a===d(\"MAWFolderTypes\").FOLDER_ID.OTHER;return a}function b(a,b){return(a===null||a===d(\"MAWFolderTypes\").FOLDER_ID.INBOX)&&(b===d(\"MAWDbContact\").REVERSED_ONE_WAY_CONTACT||b===d(\"MAWDbContact\").NON_CONTACT)}g.isMessageRequestOrSpamThread=a;g.isInboxRequest=b}),98);\n__d(\"MAWMarkThreadAsReadTxns\",[\"FBLogger\",\"MAWBridgeThread\",\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWMessageRequestUtils\",\"MAWTimeUtils\",\"WATimeUtils\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,d,e,f){f===void 0&&(f=!1);var g=new Map();g.set(b,{msgId:d,sortOrderMs:e});return h(a,g,f).then(function(a){a=a.get(b);if(a==null)throw c(\"FBLogger\")(\"messenger_e2ee_web\",\"maw_mark_thread_as_read\").warn(\"ThreadReadReceiptInfo unexpectedly unavailable for thread\\n         in markThreadAsReadUpToMsgSortOrderMs()\");return a})}function h(a,b,c){c===void 0&&(c=!1);return j(a,b).then(function(b){var e=b.threadJidToReadReceiptInfo,f=b.updatedThreads;return a.threads.bulkPut(f).then(function(){f.forEach(function(a){var b=a.lastReadMsgTs==null?null:d(\"WATimeUtils\").castToMillisTime(a.lastReadMsgTs);b!=null&&!c&&d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadTimestampsUpdated\",value:d(\"MAWBridgeThread\").createBridgeThreadTimestampsUpdated(a.jid,a.chatId,b,b)});e.set(a.jid,{isReadReceiptExpectedToBeSent:(a=(b=e.get(a.jid))==null?void 0:b.isReadReceiptExpectedToBeSent)!=null?a:!1,type:\"success\"})});return e})})}function i(a,b,c){return d(\"MAWDbMsgTxns\").getThreadOldestMessageIdBySortOrder(a,b).then(function(a){if(a==null||b.lastReadMsgTs!=null&&b.lastReadMsgTs>=c.sortOrderMs)return null;a=d(\"MAWTimeUtils\").ensureValidMillisTime(b.newestMsgTs);return babelHelpers[\"extends\"]({},b,{lastReadMsg:c.msgId,lastReadMsgTs:c.sortOrderMs,newestMsgTs:a})})}function j(a,b){var e=new Map(),f=Array.from(b.keys()),g=[];return a.threads.where(\"jid\").anyOf(f).toArray().then(function(h){var j=new Map();h.forEach(function(a){return j.set(a.jid,a)});f.forEach(function(a){j.has(a)||j.set(a,null)});h=Array.from(j).map(function(d){var f=d[0];d=d[1];if(d==null){e.set(f,{isReadReceiptExpectedToBeSent:!1,type:\"missing\"});return}f=k(d.folder);e.set(d.jid,{isReadReceiptExpectedToBeSent:f,type:\"success\"});f=b.get(d.jid);if(f==null)throw c(\"FBLogger\")(\"messenger_e2ee_web\",\"maw_mark_thread_as_read\").warn(\"ThreadReadReceiptInfo unexpectedly unavailable for thread\\n            in getThreadJidToReadReceiptInfo()\");return i(a,d,f).then(function(a){a!=null&&g.push(a)})});return d(\"MAWDexieTable\").dexieAll(h).then(function(){return{threadJidToReadReceiptInfo:e,updatedThreads:g}})})}function k(a){return!d(\"MAWMessageRequestUtils\").isMessageRequestOrSpamThread(a)}function b(a,b,c,d){d===void 0&&(d=!1);return l(a,[{threadId:b,upToMsgId:c}],d).then(function(a){a=a.get(b);return a==null?{isReadReceiptExpectedToBeSent:!1,type:\"missing\"}:a})}function l(a,b,e){e===void 0&&(e=!1);var f=[],g=new Map();b.map(function(a){f.push(a.threadId),g.set(a.threadId,a.upToMsgId)});var h=new Map();return a.threads.bulkGet(f).then(function(b){var i=[],j=b.filter(Boolean),l=new Map(),m=new Map(),n=j.map(function(b){return d(\"MAWDbMsgTxns\").getThreadOldestMessageIdBySortOrder(a,b).then(function(a){a!=null&&l.set(b.jid,a)})});n.concat(j.map(function(b){return d(\"MAWDbMsgTxns\").getThreadNewestMessageTsBySortOrder(a,b).then(function(a){a!=null&&m.set(b.jid,a)})}));return d(\"MAWDexieTable\").dexieAll([n]).then(function(){b.forEach(function(a,b){if(a==null){h.set(f[b],{isReadReceiptExpectedToBeSent:!1,type:\"missing\"});return}var d=k(a.folder),e=l.get(a.jid);if(e==null){h.set(f[b],{isReadReceiptExpectedToBeSent:d,type:\"success\"});return}e=g.get(a.chatId);if(e==null)throw c(\"err\")(\"This is for flow error check\");if(a.lastReadMsg!=null&&a.lastReadMsg>=e){h.set(f[b],{isReadReceiptExpectedToBeSent:d,type:\"success\"});return}i.push({isReadReceiptExpectedToBeSent:d,thread:a})});var j=[],n=[];i.map(function(a){var b=a.thread,c=g.get(b.chatId);a=a.isReadReceiptExpectedToBeSent;var e=d(\"MAWTimeUtils\").ensureValidMillisTime(m.get(b.jid));b=babelHelpers[\"extends\"]({},b,{lastReadMsg:c,lastReadMsgTs:e});j.push(b);n.push(a)});return a.threads.bulkPut(j).then(function(){j.forEach(function(a,b){var c=d(\"MAWTimeUtils\").ensureValidMillisTime(a.lastReadMsgTs);c!=null&&!e&&d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadTimestampsUpdated\",value:d(\"MAWBridgeThread\").createBridgeThreadTimestampsUpdated(a.jid,a.chatId,c,c)});h.set(a.chatId,{isReadReceiptExpectedToBeSent:n[b],type:\"success\"})});return h})})})}g.markThreadAsReadUpToMsgSortOrderMs=a;g.bulkMarkThreadAsReadUpToMsgSortOrderMs=h;g.isReadReceiptExpectedToBeSentFor=k;g.markThreadAsReadUpToMsgId__DONOTUSE=b;g.bulkMarkThreadAsReadUpToMsgId__DONOTUSE=l}),98);\n__d(\"MAWPendingReceiptProcessingTxns\",[\"MAWBridgeMsgCountdown\",\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDbParticipantTxns\",\"MAWDbReceiptTxns\",\"MAWDexieTable\",\"MAWEphemeralCleaner\",\"MAWEphemeralGatingUtil\",\"MAWEphemeralMsgTxns\",\"MAWIncomingReceiptTxns\",\"MAWIndexedDb\",\"MAWLoggerUtils\",\"MAWMarkThreadAsReadTxns\",\"WAJids\",\"WALogger\",\"WAMsg\",\"WATagsLogger\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Read metadata received for \",\" from \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Processing pending receipts for \",\" from \",\"\"]);i=function(){return a};return a}function a(a,b,c){var e=d(\"WAMsg\").craftWAMsgIdString({author:c.author,chat:b,externalId:c.externalId});return a.pendingReceipts.get(e).then(function(b){if(b==null)return;d(\"WALogger\").LOG(i(),c.externalId,c.author);if(b.author===d(\"WAJids\").AUTHOR_ME){var f=d(\"MAWDexieTable\").dexieResolve();b.deliveryReceipts.length>0&&(f=f.then(function(){return d(\"MAWDbReceiptTxns\").writeReceiptsForDevices(a,c.msgId,\"delivered\",b.deliveryReceipts)}));b.readReceipts.length>0&&(f=f.then(function(){return d(\"MAWDbReceiptTxns\").writeReceiptsForDevices(a,c.msgId,\"read\",b.readReceipts)}));return f.then(function(b){var f=[],g=d(\"MAWDexieTable\").dexieResolve();b!=null&&b.type!==\"missing\"&&(b.receipt.statusTsPerUser.forEach(function(b,e){var g=b.deliveredTs!=null?c.ts:d(\"WATimeUtils\").castToUnixTime(0),h=b.readTs!=null?c.ts:d(\"WATimeUtils\").castToUnixTime(0);b=(b=b.readTs)!=null?b:d(\"WATimeUtils\").castToUnixTime(0);f.push(d(\"MAWDbParticipantTxns\").updateParticipantTimestamps(a,[c.threadJid,e],g,h,b))}),d(\"MAWEphemeralGatingUtil\").isSendBasedDisappearingMessageEnabled()||(g=d(\"MAWEphemeralMsgTxns\").bulkUpdateEphemeralMessageTimestamps(a,d(\"MAWIncomingReceiptTxns\").createUpdateEphemeralTimestampsParams([b],new Map([[c.msgId,{msg:c,renderType:\"regular\"}]])))));return d(\"MAWDexieTable\").dexieAll([g,d(\"MAWDexieTable\").dexieAll(f)]).then(function(b){b=b[0];if(b!=null){b=(b=b)!=null?b:[void 0,void 0,[]];var c=b[0],f=b[1];b=b[2];c!=null&&f!=null&&d(\"MAWEphemeralCleaner\").addNewEphemeralTimestamp(c,f);d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgsStartCountdown\",value:d(\"MAWBridgeMsgCountdown\").createBridgeMsgsStartCountdown(b)})}a.pendingReceipts[\"delete\"](e)})})}else{f=j(b);f=f!=null&&!d(\"MAWEphemeralGatingUtil\").isSendBasedDisappearingMessageEnabled()?d(\"MAWEphemeralMsgTxns\").bulkMarkEphemeralMessageAsRead(a,[f]):d(\"MAWDexieTable\").dexieResolve();return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbMsgTxns\").IS_SORT_ORDER_COMPARISON_ENABLED?d(\"MAWMarkThreadAsReadTxns\").markThreadAsReadUpToMsgSortOrderMs(a,c.threadJid,c.msgId,d(\"WATimeUtils\").castToMillisTime(d(\"MAWDbMsg\").getSortOrderWithFallback(c))):d(\"MAWMarkThreadAsReadTxns\").markThreadAsReadUpToMsgId__DONOTUSE(a,c.thread,c.msgId),f]).then(function(){return a.pendingReceipts[\"delete\"](e)})}})}function j(a){var b=a.author,c=a.externalId,e=a.readReceipts;a=a.thread;if(!d(\"WAJids\").isAuthorMe(b)&&!d(\"WAJids\").isAuthorSystem(b)){a={author:b,chat:a,externalId:c};c=e.length>0?e.reduce(function(a,b){return b.ts<a?b.ts:a},e[0].ts):null;if(c!=null){d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.Ephemeral,d(\"MAWLoggerUtils\").Tag.PeerReceipt,d(\"MAWLoggerUtils\").Tag.Countdown]).LOG(h(),a,b);return{msgId:a,ts:c}}}return null}g.processPendingReceipts=a}),98);\n__d(\"MAWDbGroupInviteTxns\",[\"MAWDexieTable\",\"MAWMsgType\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){return a.groupInvites.put(b).then(function(){return b})}function b(a,b,c){return a.groupInvites.where([\"threadJid\",\"inviteeJid\"]).anyOf([[b,c]])[\"delete\"]()}function h(a,b,c){return a.groupInvites.where([\"threadJid\",\"inviteeJid\"]).equals([b,c]).first()}function c(a,b,c){return a.groupInvites.where([\"threadJid\",\"inviteeJid\"]).anyOf([[b,c]]).toArray()}function e(a,b){return b.type===d(\"MAWMsgType\").MSG_TYPE.GROUP_INVITE?b.invitedParticipantUserJid==null?d(\"MAWDexieTable\").dexieResolve():h(a,b.threadJid,b.invitedParticipantUserJid):d(\"MAWDexieTable\").dexieResolve()}g.putGroupInvite=a;g.deleteGroupInvitesByThreadAndInvitedParticipant=b;g.maybeGetGroupInvite=h;g.getGroupInvitesByThreadAndInvitedParticipant=c;g.getAndCheckGroupInviteFromMsg=e}),98);\n__d(\"MAWGroupInviteManagementTxns\",[\"MAWDbGroupInviteTxns\",\"MAWDbParticipantTxns\",\"MAWDexieTable\",\"MAWGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){var c=!1;return d(\"MAWDbParticipantTxns\").getInvitedParticipantsInThread(a,b).then(function(e){if(e.length===0){c=!0;var f=d(\"MAWGlobals\").getMyUserJid();return d(\"MAWDbGroupInviteTxns\").deleteGroupInvitesByThreadAndInvitedParticipant(a,b,f).then(function(){return c})}else{var g=[];e.forEach(function(c){g.push(d(\"MAWDbGroupInviteTxns\").deleteGroupInvitesByThreadAndInvitedParticipant(a,b,c.userJid))});return d(\"MAWDexieTable\").dexieAll(g).then(function(){return c})}})}g.deleteGroupInvitesByThread=a}),98);\n__d(\"MAWLoadMessageRequestCapabilitiesTxns\",[\"MAWDexieTable\",\"MAWIndexedDb\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){for(var b=0;b<a.length;b++){var c=a[b],e=d(\"WAJids\").interpretAsUserJid(c.jid);if(e==null)continue;d(\"MAWIndexedDb\").afterTransaction({tag:\"OneToOneMessageRequestLoaded\",value:{fbid:d(\"WAJids\").extractUserId(e),threadId:c.chatId,threadJid:c.jid}})}return d(\"MAWDexieTable\").dexieResolve()}g.loadMessageRequestDataForThreads=a}),98);\n__d(\"MAWThreadManagementTxns\",[\"MAWBridgeEventTransmitter\",\"MAWBridgeParticipants\",\"MAWBridgeTypesCreators\",\"MAWDbGroupInfoTxns\",\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDbParticipantTxns\",\"MAWDbReactionsTxns\",\"MAWDbReceiptTxns\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWGetOrCreateThreadTxns\",\"MAWGlobals\",\"MAWGroupInviteManagementTxns\",\"MAWIndexedDb\",\"MAWLoadMessageRequestCapabilitiesTxns\",\"WAJids\",\"WALogger\",\"WAMsgType\",\"WASortedLists\",\"WATimeUtils\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Successfully deleted \",\" media rows and \",\" chunk rows\"]);h=function(){return a};return a}function a(a,b){var c=b.authoritativeThreadKey,e=b.createTs,f=b.folder,g=b.lastActivityTimestamp,h=b.lastReadWatermarkTimestamp,i=b.offlineThreadingId,j=b.userJid;return d(\"MAWGetOrCreateThreadTxns\").getOrCreateThread(a,{authoritativeThreadKey:c,clientThreadKey:i,createTs:e,description:\"getOrSetupOneToOneThread\",folder:f,jid:j,lastActivityTimestamp:g,lastReadWatermarkTimestamp:h}).then(function(b){var c=b.created;b=b.thread;return l(a,j,c,b)})}function b(a,b,c,e){return d(\"MAWDbGroupInfoTxns\").getGroupInfo(a,b).then(function(b){if(!b.success)return null;var f=b.value;return d(\"MAWGetOrCreateThreadTxns\").getOrCreateThread(a,{createTs:d(\"WATimeUtils\").castUnixTimeToMillisTime(f.creationTs),description:\"getOrRepairGroupThread\",folder:c,jid:f.groupJid,skipVerifyThread:e}).then(function(b){var c=b.created,e=b.thread;b=e.chatId;if(c){var g=babelHelpers[\"extends\"]({},f,{threadId:b});return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbGroupInfoTxns\").updateGroupInfo(a,g)]).then(function(){return{created:c,groupInfo:g,thread:e}})}return{created:c,groupInfo:f,thread:e}})})}function i(a,b){var c=[],e=[];b.forEach(function(a){d(\"MAWDbMsg\").isMediaMsg(a)&&a.mediaId!=null&&(c.push(a.mediaId),e.push(a.msgId))});return a.media.bulkGet(c).then(function(b){var c=[],f=[];b.forEach(function(a,b){if(a!=null){var g=e[b];a.msgIds=d(\"WASortedLists\").filter(a.msgIds,function(a){return a!==g});a.mediaEntries[\"delete\"](g);a.msgIds.length===0&&a.mediaEntries.size===0&&(a.plaintextHash!=null&&c.push(a.hashedPlaintextHash),f.push(a.mediaId))}});b=a.media.bulkDelete(f);var g=a.chunk.where(\"hashedPlaintextHash\").anyOf(c)[\"delete\"]();return d(\"MAWDexieTable\").dexieAll([b,g]).then(function(){d(\"WALogger\").LOG(h(),f.length,c.length)})})}function j(a,b){return d(\"MAWDbMsgTxns\").getThreadNewestMessageTsBySortOrder(a,b).then(function(c){return a.messages.where(\"threadJid\").equals(b.jid).toArray().then(function(d){return k(a,b,c,d,!0)})})}function e(a,b,c,e){var f=c==null?void 0:c.lastMessageTimestamp;if(c==null)return j(a,b);var g=a.messages.where(\"threadJid\").equals(b.jid).toArray(),h=d(\"MAWDbMsgTxns\").getThreadNewestMessageTsBySortOrder(a,b);return d(\"MAWDexieTable\").dexieAll([g,h]).then(function(g){var h=g[0];g=g[1];var i=[],j=new Set();f!=null&&h.forEach(function(a){a.ts<=f+1&&(j.add(a.msgId),i.push(a))});if((c==null?void 0:c.messages.length)!==0){var l=new Set();c.messages.forEach(function(a){l.add((a=a.key)==null?void 0:a.id)});h.forEach(function(a){l.has(a.externalId)&&!j.has(a.msgId)&&(j.add(a.msgId),i.push(a))})}if(i.length!==h.length)for(var m=h,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var p;if(n){if(o>=m.length)break;p=m[o++]}else{o=m.next();if(o.done)break;p=o.value}p=p;if(!j.has(p.msgId)&&p.type!==d(\"WAMsgType\").ADMIN)return k(a,b,g,i,!1,e)}return k(a,b,g,h,!0,e)})}function k(a,b,c,e,f,g){var h=d(\"WAJids\").interpretAsGroupJid(b.jid),j=f?d(\"MAWDbThreadTxns\").deleteThreadRow(a,b.chatId):d(\"MAWDexieTable\").dexieResolve(),k=f?d(\"MAWDbParticipantTxns\").deleteAllParticipantsForThread(a,b.jid):d(\"MAWDexieTable\").dexieResolve(),l=d(\"MAWDexieTable\").dexieResolve(!1),m=d(\"MAWDexieTable\").dexieResolve();h!=null&&f&&(l=d(\"MAWGroupInviteManagementTxns\").deleteGroupInvitesByThread(a,h),m=d(\"MAWDbGroupInfoTxns\").deleteGroupInfo(a,h));return d(\"MAWDexieTable\").dexieAll([i(a,e),d(\"MAWDbReceiptTxns\").bulkDeleteAllReceiptsForMessages(a,e.map(function(a){return a.msgId})),d(\"MAWDbReactionsTxns\").deleteAllReactionsForMessages(a,e),d(\"MAWDbMsgTxns\").deleteMessages(a,e,g),j,k,m,l]).then(function(a){a[0];a[1];a[2];a[3];a[4];a[5];a[6];a=a[7];f?(d(\"MAWBridgeEventTransmitter\").deleteMessagesOfThreadAfterTxn(b,c),h!=null&&a&&d(\"MAWIndexedDb\").afterTransaction({tag:\"DeleteGroupInvite\",value:d(\"MAWBridgeTypesCreators\").createBridgeDeleteGroupInvite(b.chatId,b.jid)}),d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadHidden\",value:b.chatId})):d(\"MAWIndexedDb\").afterTransaction({tag:\"DeleteMessages\",value:d(\"MAWBridgeTypesCreators\").createBridgeDeleteMessages(b.chatId,b.jid,e)})})}function f(a,b){var c=b.offlineThreadingId,e=b.userJid;return d(\"MAWGetOrCreateThreadTxns\").createThread(a,{clientThreadKey:c,description:\"setupOneToOneThread\",jid:e}).then(function(b){return l(a,e,!0,b)})}function l(a,b,e,f){var g=[d(\"MAWLoadMessageRequestCapabilitiesTxns\").loadMessageRequestDataForThreads([f])];b=[{type:\"participant\",userJid:b}];var h=d(\"MAWGlobals\").getMyUserJid();h!==f.jid&&b.push({type:\"participant\",userJid:h});if(c(\"gkx\")(\"23923\")){g.push(d(\"MAWDbParticipantTxns\").bulkUpsertParticiantsInThread(a,f.chatId,f.jid,b).then(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"ParticipantsUpdated\",value:d(\"MAWBridgeParticipants\").createBridgeParticipants(a)})}));return d(\"MAWDexieTable\").dexieAll(g).then(function(){return{created:e,thread:f}})}e?g.push(d(\"MAWDbParticipantTxns\").bulkAddParticipants(a,f.chatId,f.jid,b).then(function(){})):g.push(d(\"MAWDbParticipantTxns\").getParticipantsInThread(a,f.jid).then(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"ParticipantsUpdated\",value:d(\"MAWBridgeParticipants\").createBridgeParticipants(a)})}));return d(\"MAWDexieTable\").dexieAll(g).then(function(){return{created:e,thread:f}})}g.getOrSetupOneToOneThread=a;g.getOrRepairGroupThread=b;g.deleteAllThreadData=j;g.metaSyncChatDeleteThread=e;g.setupOneToOneThread=f}),98);\n__d(\"WAGroupInviteUtils\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a){return a}f.toInviteCode=a}),66);\n__d(\"MAWWriteGroupInviteTxns\",[\"MAWAddQPLPointForHandleIncomingMsgApi\",\"MAWBridgeTypesCreators\",\"MAWDbGroupInviteTxns\",\"MAWDbParticipant\",\"MAWDbParticipantTxns\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWLowLevelApiTypes\",\"MAWThreadManagementTxns\",\"WAGroupInviteUtils\",\"WAJids\",\"WAResultOrError\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,c){return d(\"MAWDbThreadTxns\").getThreadByJid(a,c).then(function(c){return!c.success?d(\"MAWLowLevelApiTypes\").WRITE_GROUP_INVITE_ERROR.MISSING_GROUP:d(\"MAWDbGroupInviteTxns\").maybeGetGroupInvite(a,b.threadJid,b.inviteeJid).then(function(c){return c&&!d(\"WATimeUtils\").isInFuture(c.inviteExpirationTs)?d(\"MAWLowLevelApiTypes\").WRITE_GROUP_INVITE_ERROR.EXISTING_GROUP_INVITE:d(\"MAWDbGroupInviteTxns\").putGroupInvite(a,b)})})}function b(a,b,c,e){var f=b.caption,g=b.groupJid,h=b.inviteCode;b=b.inviteExpiration;d(\"MAWAddQPLPointForHandleIncomingMsgApi\").addQPLPointForHIMApi(\"writeIncomingGroupInviteMsg\");var i=d(\"WAJids\").interpretAsUserJid(c);if(g==null||b==null||h==null||i==null)return d(\"MAWDexieTable\").dexieResolve(d(\"WAResultOrError\").makeError({type:\"invalid_args\"}));c=[d(\"WATimeUtils\").castLongIntToUnixTime(b),d(\"WAJids\").toGroupJid(g),d(\"WAGroupInviteUtils\").toInviteCode(h)];var j=c[0];b=c[1];var k=c[2],l={folder:e,groupJid:b,inviteCode:k,inviteExpireTs:j,inviterJid:i,type:\"group_invite\"};return d(\"MAWThreadManagementTxns\").getOrRepairGroupThread(a,b,e,!0).then(function(b){return b==null?d(\"WAResultOrError\").makeError(l):d(\"MAWDbParticipantTxns\").getParticipant(a,b.thread.chatId,i)}).then(function(b){if(!b.success)return d(\"WAResultOrError\").makeError(l);var c=d(\"MAWGlobals\").getMyUserJid(),e=d(\"MAWDbParticipant\").craftParticipantId__DEPRECATED(b.value.threadId,d(\"MAWGlobals\").getMyUserJid());return d(\"MAWDbGroupInviteTxns\").putGroupInvite(a,{caption:f==null?void 0:f.text,inviteCode:k,invitedParticipantId:e,inviteeJid:c,inviteExpirationTs:j,inviterJid:i,threadJid:b.value.threadJid}).then(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"GroupInviteUpdate\",value:d(\"MAWBridgeTypesCreators\").createBridgeGroupInvite(a)});return d(\"WAResultOrError\").makeResult()})})}g.writeGroupInvite=a;g.writeIncomingGroupInviteMsg=b}),98);\n__d(\"MAWBridgeXMA\",[\"MAWBridgeUIEventDataValidation\",\"MAWDbMedia\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAWBridge - createBridgeXMA received unexpected media type - \",\"\"]);h=function(){return a};return a}function i(a){if(a==null)return void 0;switch(a){case\"Image\":case\"Sticker\":return\"image\/png\";case\"Gif\":return\"image\/gif\";case\"Video\":return\"video\/mp4\";case\"Ptt\":return\"audio\/wav\"}}function a(a,b,c){var e=c.contentRef,f=c.ctas,g=c.defaultCTA,j=c.defaultPreviewMediaId,k=c.faviconMediaId,l=c.headerMediaId,m=c.headerTitle,n=c.maxSubtitleNumOfLines,o=c.maxTitleNumOfLines,p=c.msgId,q=c.offlineAttachmentId,r=c.overlayIconGlyph,s=c.overlayTitle,t=c.subtitleText,u=c.targetId,v=c.targetType,w=c.targetUsername,x=c.threadJid,y=c.titleText,z=c.xmaId;c=c.xmaLayoutType;b!=null&&b.mediaType!==d(\"MAWDbMedia\").IMAGE&&d(\"WALogger\").WARN(h(),b.mediaType);u!=null&&d(\"MAWBridgeUIEventDataValidation\").stringToI64Opt(u);return{contentRef:e,ctas:f,defaultCTA:g,defaultPreviewMediaId:j,duration:null,faviconMediaId:k,filesize:b==null?void 0:b.size,headerMediaId:l,headerTitle:m,maxSubtitleNumOfLines:n,maxTitleNumOfLines:o,mediaType:b==null?void 0:b.mediaType,msgId:p,offlineAttachmentId:q,overlayIconGlyph:r,overlayTitle:s,playableUrlMimeType:i(b==null?void 0:b.mediaType),previewHeight:b==null?void 0:(e=b.validatedImageInfo)==null?void 0:e.jpegThumbnailHeight,previewHeightLarge:b==null?void 0:(f=b.validatedImageInfo)==null?void 0:f.height,previewUrlMimeType:i(b==null?void 0:b.mediaType),previewWidth:b==null?void 0:(g=b.validatedImageInfo)==null?void 0:g.jpegThumbnailWidth,previewWidthLarge:b==null?void 0:(j=b.validatedImageInfo)==null?void 0:j.width,subtitleText:t,targetId:u,targetType:v,targetUsername:w,threadId:a,threadJid:x,titleText:y,ts:b==null?void 0:b.ts,xmaId:z,xmaLayoutType:c}}function b(a,b){var c=a.msgId,d=a.thread;a=a.threadJid;return{chatId:d,msgId:c,threadJid:a,xmaId:b}}function c(a,b){var c=a.msgId,d=a.thread;a=a.threadJid;return{msgId:c,threadId:d,threadJid:a,xmaId:b}}g.createBridgeXMA=a;g.createBridgeXMAShareExpired=b;g.createBridgeXMAShareTombstoned=c}),98);\n__d(\"MAWExpiredXMACleaner\",[\"MAWMsgCleaner\",\"WALogger\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"ExpiredXMACleaner: Adding timestamps backend(\",\")\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"startExpiredXMACleaner invoked\"]);j=function(){return a};return a}var k=null;function a(a){d(\"WALogger\").LOG(j()),k==null&&(k=new(d(\"MAWMsgCleaner\").MsgCleaner)(a,d(\"MAWMsgCleaner\").CLEANER_TYPE.XMA))}function b(a){if(k==null){var b=\"Trying to add new addNewExpiredXMACleanerTimestamp before the cleaner is initialized!\";d(\"WALogger\").ERROR(i(),b);throw c(\"err\")(b)}else d(\"WALogger\").DEV(h(),a),k.update(a)}function e(){return k}function f(){k=null}g.startExpiredXMACleaner=a;g.addNewExpiredXMACleanerTimestamp=b;g.getExpiredXMACleaner_FOR_TESTING_ONLY=e;g.resetExpiredXMACleaner_FOR_TESTING_ONLY=f}),98);\n__d(\"MAWXMAManagementTxns\",[\"MAWDexieTable\",\"MAWMediaManagementTxns\",\"MAWXMAUtils\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,c,e,f){var g=b.unstoredDbXMA,i=b.unstoredFavicon,j=b.unstoredHeaderMedia,k=b.unstoredPreviews;f===void 0&&(f=!1);var l=new Map(),m=function(b){return b!=null?d(\"MAWMediaManagementTxns\").handleUnstoredDbMedia(a,b,c,!0).then(function(a){return[b.plaintextHash,a]}):d(\"MAWDexieTable\").dexieResolve([void 0,void 0])};f||(l.set(i==null?void 0:i.plaintextHash,m(i)).set(j==null?void 0:j.plaintextHash,m(j)),k==null?void 0:k.forEach(function(a){l.set(a==null?void 0:a.plaintextHash,m(a))}));b=Array.from(l.values());return d(\"MAWDexieTable\").dexieAll(b).then(function(b){var l,m=new Map(b),n=((l=k)!=null?l:[]).map(function(a){return m.get(a.plaintextHash)}).filter(Boolean);return h(a,f?d(\"MAWXMAUtils\").buildUnstoredTombstonedXMA(g):g,(l=m.get(i==null?void 0:i.plaintextHash))==null?void 0:l.mediaId,(l=m.get(j==null?void 0:j.plaintextHash))==null?void 0:l.mediaId,n.map(function(a){return a.mediaId}),c,e).then(function(a){return{dbMedias:b.map(function(a){a[0];a=a[1];return a}).filter(Boolean),dbXMA:a,firstPreview:n[0]}})})}function h(a,b,d,e,f,g,h){h=babelHelpers[\"extends\"]({},b,{associatedMessageId:(b=h)!=null?b:void 0,defaultPreviewMediaId:f[0],faviconMediaId:d,headerMediaId:e,msgId:g.msgId,previewMediaIds:f});return a.xma.add(h).then(function(b){return a.xma.get(b)}).then(function(a){if(a==null)throw c(\"err\")(\"Failed to write XMA to db\");return a})}function b(a,b,c,e,f,g,h,i,j,k){var l=d(\"MAWXMAUtils\").isXMAExpired(!1,j.targetExpiringAtSec);h=babelHelpers[\"extends\"]({},j,{associatedMessageId:(j=h)!=null?j:void 0,author:i.author,externalId:i.externalId,isTombstoned:l,msgId:g,offlineAttachmentId:k,targetType:f,threadJid:i.chat});var m=l?h:babelHelpers[\"extends\"]({},h,{defaultPreviewMediaId:(j=b)!=null?j:void 0,faviconMediaId:(g=e)!=null?g:void 0,headerMediaId:(k=c)!=null?k:void 0,previewMediaIds:b!=null?[b]:[]});return a.xma.add(m).then(function(a){return babelHelpers[\"extends\"]({},m,{xmaId:a})})}g.handleUnstoredXMAContent=a;g.saveXMA=b}),98);\n__d(\"MAWWriteXMAMessageTxns\",[\"MAWBridgeMsg\",\"MAWBridgeXMA\",\"MAWDbXMATxns\",\"MAWDexieTable\",\"MAWExpiredXMACleaner\",\"MAWIndexedDb\",\"MAWMsgType\",\"MAWWriteMsgTxns\",\"MAWXMAManagementTxns\",\"MAWXMAUtils\",\"WAJids\",\"WATimeUtils\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";f=6*d(\"WATimeUtils\").HOUR_SECONDS;function a(a,b,c,e){var f=c.unstoredAssociatedMsg,g=c.unstoredDbXMA;return d(\"MAWDbXMATxns\").maybeGetAssociatedXMAMsg(a,f,e.jid).then(function(c){var h=b;if(c!=null&&c.type===d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT){var i=c.serverTs,j=c.sortOrderMs;c=c.ts;h=babelHelpers[\"extends\"]({},b,{serverTs:i,sortOrderMs:j!=null?j-1:j,ts:c})}i=[g.targetExpiringAtSec,g.targetType];j=i[0];c=i[1];d(\"MAWXMAUtils\").isXMAStoryReaction(c)&&(f==null?void 0:f.msgContent)!=null&&(h=babelHelpers[\"extends\"]({},b,{msgContent:f.msgContent}));i=d(\"MAWXMAUtils\").isXMAExpired(g.isTombstoned,j);h.isExpiredXmaMsg=i;j=!d(\"MAWXMAUtils\").isXMAStoryReaction(c)&&f!=null?d(\"MAWWriteMsgTxns\").prepareMsgWriteData(a,f,e):d(\"MAWDexieTable\").dexieResolve(null);return d(\"MAWDexieTable\").dexieAll([d(\"MAWWriteMsgTxns\").prepareMsgWriteData(a,h,e),j]).then(function(a){var b=a[0];a=a[1];return{associatedData:a,associatedMsg:f,xmaData:b,xmaMsg:h}})})}function b(a,b,c,e){var f=c.unstoredDbXMA,g=[f.targetExpiringAtSec,f.targetType],h=g[0];g=g[1];if(b==null||b.type===d(\"MAWMsgType\").MSG_TYPE.DELETE_FOR_ME)return d(\"MAWDexieTable\").dexieResolve({dbMedias:null,dbXMA:null});b.isExpiredXmaMsg!==!0&&h!=null&&d(\"MAWExpiredXMACleaner\").addNewExpiredXMACleanerTimestamp(h);d(\"MAWXMAUtils\").isXMAStoryReaction(g)&&d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgUpdated\",value:d(\"MAWBridgeMsg\").createBridgeMsg(b)});return d(\"MAWXMAManagementTxns\").handleUnstoredXMAContent(a,babelHelpers[\"extends\"]({},c,{unstoredDbXMA:f}),b,e,b.isExpiredXmaMsg===!0).then(function(a){var c=a.dbMedias,e=a.dbXMA;a=a.firstPreview;e!=null&&!d(\"MAWXMAUtils\").isXMAStoryReply(e.targetType)&&(b.isExpiredXmaMsg!==!0&&d(\"MAWIndexedDb\").afterTransaction({tag:\"NewXMA\",value:d(\"MAWBridgeXMA\").createBridgeXMA(b.thread,a,e)}));return{dbMedias:c,dbXMA:e}})}function e(a,b,e,f,g,h){if(g.type!==d(\"MAWMsgType\").MSG_TYPE.TEXT)throw c(\"err\")(\"flow check, this message type is only in text type\");var i=b.author;if(i===\"@system\")throw c(\"err\")(\"wrong author of story reply\");var j=d(\"WAJids\").interpretAsUserJid(f);if(j==null)throw c(\"err\")(\"this is a flow check, participant jid can not be null\");i={author:i===d(\"WAJids\").AUTHOR_ME?j:d(\"WAJids\").AUTHOR_ME,externalId:g.externalId,mediaId:h?void 0:e==null?void 0:e.defaultPreviewMediaId,sourceId:(j=(i=e.defaultCTA)==null?void 0:i.nativeUrl)!=null?j:(h=e.defaultCTA)==null?void 0:h.actionUrl,ts:b.ts,type:d(\"MAWMsgType\").MSG_TYPE.XMA,xmaMessageType:e.targetType};var k=babelHelpers[\"extends\"]({},g,{quote:{content:i,remoteJid:f}});return a.messages.put(k).then(function(){d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgUpdated\",value:d(\"MAWBridgeMsg\").createBridgeMsg(k)})})}g.REVOKE_CONTENT_EXPIRATION_IN_SEC=f;g.prepareXMAWriteData=a;g.handleIncomingXMA=b;g.handleXMAReplyMsg=e}),98);\n__d(\"MAWHandleIncomingMsgApi\",[\"MAWAddQPLPointForHandleIncomingMsgApi\",\"MAWDbRavenActionTxns\",\"MAWDexieTable\",\"MAWEBSwitch\",\"MAWEphemeralAdminMsgBuildTxns\",\"MAWEphemeralMsgTxns\",\"MAWEphemeralSettingsTxns\",\"MAWJidUtils\",\"MAWMediaManagementTxns\",\"MAWMsgActionType\",\"MAWMsgType\",\"MAWPendingReceiptProcessingTxns\",\"MAWReceiveToUploadUtils\",\"MAWWriteGroupInviteTxns\",\"MAWWriteMsgTxns\",\"MAWWriteRevokeMessageTxns\",\"MAWWriteXMAMessageTxns\",\"MAWXMAUtils\",\"WAJids\",\"WALogger\",\"WAResultOrError\",\"err\",\"requireDeferred\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleIncomingMsgInternal: Finished writing the incoming message\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[HIM] Could not write dbAssociatedMsg but it exists: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[HandleIncomingMsg] Unstored message is missing\"]);j=function(){return a};return a}var k=c(\"requireDeferred\")(\"ArmadilloReceiveWriteDbSuccessFalcoEvent\").__setRef(\"MAWHandleIncomingMsgApi\"),l=c(\"requireDeferred\")(\"EncryptedBackupTaskSkippedFalcoEvent\").__setRef(\"MAWHandleIncomingMsgApi\"),m=d(\"MAWDexieTable\").dexieResolve(d(\"WAResultOrError\").makeResult(void 0));function a(a,b){if(b.action===d(\"MAWMsgActionType\").MSG_ACTION.NO_ACTION)return m;var e=function(c,e,f){return d(\"MAWEphemeralMsgTxns\").syncEphemeralSettingOnIncomingMsg(a,c,e,b.thread,b.device,f)};d(\"MAWAddQPLPointForHandleIncomingMsgApi\").addQPLPointForHIMApi(\"write_msg_start\");switch(b.type){case null:d(\"WALogger\").ERROR(j());return m;case d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT:case d(\"MAWMsgType\").MSG_TYPE.UNAVAILABLE:return d(\"MAWWriteMsgTxns\").writeNewIncomingMsg(a,b.msg,b.thread).then(function(){return d(\"WAResultOrError\").makeResult(null)});case d(\"MAWMsgType\").MSG_TYPE.RAVEN_ACTION:return d(\"MAWDbRavenActionTxns\").writeRavenActionMsg(a,b.msg,b.thread).then(function(){return d(\"WAResultOrError\").makeResult(null)});case d(\"MAWMsgType\").MSG_TYPE.REACTION:return d(\"MAWDexieTable\").dexieResolve(d(\"WAResultOrError\").makeResult({reactToExternalId:b.msg.reactToExternalId}));case d(\"MAWMsgType\").MSG_TYPE.GROUP_INVITE:return d(\"WAJids\").isAuthorMe(b.id.author)?m:d(\"MAWWriteGroupInviteTxns\").writeIncomingGroupInviteMsg(a,b.msg,b.thread.jid,b.folder);case d(\"MAWMsgType\").MSG_TYPE.TEXT:case d(\"MAWMsgType\").MSG_TYPE.FUTUREPROOF:case d(\"MAWMsgType\").MSG_TYPE.IMAGE:case d(\"MAWMsgType\").MSG_TYPE.VIDEO:case d(\"MAWMsgType\").MSG_TYPE.PTT:case d(\"MAWMsgType\").MSG_TYPE.GIF:case d(\"MAWMsgType\").MSG_TYPE.STICKER:case d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE:case d(\"MAWMsgType\").MSG_TYPE.RAVEN:case d(\"MAWMsgType\").MSG_TYPE.BUMP_EXISTING_MESSAGE:if(b.action===d(\"MAWMsgActionType\").MSG_ACTION.DELETE_FOR_ME)return d(\"MAWWriteMsgTxns\").handleDeleteForMeMessage(a,b.msg,b.thread,b.pendingDeleteForMeStanza).then(function(a){return o(a)});var f=b.action===d(\"MAWMsgActionType\").MSG_ACTION.UPDATE_CIPHERTEXT?d(\"MAWWriteMsgTxns\").writeCiphertextUpdate(a,b.msg,b.existingMsg,b.thread):b.action===d(\"MAWMsgActionType\").MSG_ACTION.REVOKE?d(\"MAWWriteMsgTxns\").handleOutOfOrderRevokedMessage(a,b.msg,b.thread,b.pendingRevokedStanza):d(\"MAWWriteMsgTxns\").writeNewIncomingMsg(a,b.msg,b.thread);return f.then(function(c){var f=b.media!=null?d(\"MAWMediaManagementTxns\").handleUnstoredDbMedia(a,b.media,c):d(\"MAWDexieTable\").dexieResolve();return f.then(function(f){return d(\"MAWDexieTable\").dexieAll([q(a,b.id,c,c.type!==d(\"MAWMsgType\").MSG_TYPE.FUTUREPROOF),e(c,d(\"MAWJidUtils\").getAuthorJid(b.id.author),b.ts)]).then(function(a){a[0];a=a[1];return o(c,a,f==null?null:[f])})})});case d(\"MAWMsgType\").MSG_TYPE.REVOKED:return d(\"MAWWriteRevokeMessageTxns\").writeIncomingRevokeMsg(a,b.msg,b.thread,b.originalMsg,b.previousRevokeMsg).then(function(c){return d(\"MAWDexieTable\").dexieAll([q(a,b.id,c),e(c,d(\"MAWJidUtils\").getAuthorJid(b.id.author),b.ts)]).then(function(a){a[0];a=a[1];return p(c,a)})});case d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:return d(\"MAWEphemeralSettingsTxns\").handleAndWriteIncomingEphemeralSetting(a,d(\"MAWJidUtils\").getAuthorJid(b.id.author),b.device,b.msg.ephemeralExpirationInSec,b.msg.ephemeralLastUpdatedOrSetTimestamp,b.msg.isEphemeralSettingReset,b.thread,b.ts,b.id.externalId,!0).then(function(c){return q(a,b.id,c==null?void 0:c.dbMsg).then(function(){return o(c==null?void 0:c.dbMsg,c==null?void 0:c.outOfSyncEphemeralSetting)})});case d(\"MAWMsgType\").MSG_TYPE.ICDC_ALERT:return d(\"MAWDexieTable\").dexieResolve(d(\"WAResultOrError\").makeResult({msgType:void 0,outOfSyncEphemeralSetting:void 0,plaintextHashs:void 0}));case d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:return d(\"MAWEphemeralAdminMsgBuildTxns\").writeEphemeralScreenshotActionMsg(a,d(\"MAWJidUtils\").getAuthorJid(b.id.author),b.thread,b.ts,b.screenshotActionType,b.id.externalId,b.existingMsg).then(function(c){return d(\"MAWDexieTable\").dexieAll([q(a,b.id,c),e(c,d(\"MAWJidUtils\").getAuthorJid(b.id.author),b.ts)]).then(function(a){a[0];a=a[1];return o(c,a)})});case d(\"MAWMsgType\").MSG_TYPE.XMA:if(b.action===d(\"MAWMsgActionType\").MSG_ACTION.DELETE_FOR_ME)return d(\"MAWWriteMsgTxns\").handleDeleteForMeMessage(a,b.msg,b.thread,b.pendingDeleteForMeStanza).then(function(a){return o(a)});f=b.action===d(\"MAWMsgActionType\").MSG_ACTION.WRITE_WITH_ASSOCIATED||b.action===d(\"MAWMsgActionType\").MSG_ACTION.UPDATE_CIPHERTEXT_WITH_ASSOCIATED?n(a,b).then(function(c){return d(\"MAWWriteMsgTxns\").writeNewIncomingMsg(a,b.associatedMsg,b.thread).then(function(e){return d(\"MAWWriteXMAMessageTxns\").handleIncomingXMA(a,c,b.xma,e.msgId).then(function(f){var g=f.dbMedias;f=f.dbXMA;e==null&&d(\"WALogger\").ERROR(i(),b.associatedMsg.externalId);return(e!=null&&f!=null&&d(\"MAWXMAUtils\").isXMAStoryReply(f.targetType)?d(\"MAWWriteXMAMessageTxns\").handleXMAReplyMsg(a,b.msg,f,b.thread.jid,e,b.msg.isExpiredXmaMsg===!0):d(\"MAWDexieTable\").dexieResolve()).then(function(){return{dbAssociatedMsg:e,dbMedias:g,dbMsg:c}})})})}):b.action===d(\"MAWMsgActionType\").MSG_ACTION.REVOKE?n(a,b):n(a,b).then(function(c){return d(\"MAWWriteXMAMessageTxns\").handleIncomingXMA(a,c,b.xma,null).then(function(a){return babelHelpers[\"extends\"]({},a,{dbMsg:c})})});return f.then(function(c){var f=c.dbAssociatedMsg,g=c.dbMedias,h=c.dbMsg;return d(\"MAWDexieTable\").dexieAll([q(a,b.id,h,!0,f),e(h,d(\"MAWJidUtils\").getAuthorJid(b.id.author),b.ts)]).then(function(a){a[0];a=a[1];return o(h,a,g)})});default:throw c(\"err\")(\"We do not support handleIncomingMsgInternal with type: \"+((f=b.type)!=null?f:\"\"))}}function n(a,b){return b.action===d(\"MAWMsgActionType\").MSG_ACTION.UPDATE_CIPHERTEXT||b.action===d(\"MAWMsgActionType\").MSG_ACTION.UPDATE_CIPHERTEXT_WITH_ASSOCIATED?d(\"MAWWriteMsgTxns\").writeCiphertextUpdate(a,b.msg,b.existingMsg,b.thread):b.action===d(\"MAWMsgActionType\").MSG_ACTION.REVOKE?d(\"MAWWriteMsgTxns\").handleOutOfOrderRevokedMessage(a,b.msg,b.thread,b.pendingRevokedStanza):d(\"MAWWriteMsgTxns\").writeNewIncomingMsg(a,b.msg,b.thread)}function o(a,b,c){return d(\"WAResultOrError\").makeResult({msgType:a==null?void 0:a.type,outOfSyncEphemeralSetting:(a=b)!=null?a:void 0,plaintextHashs:c==null?void 0:c.map(function(a){return a.plaintextHash})})}function p(a,b){return d(\"WAResultOrError\").makeResult({msgType:a==null?void 0:a.type,outOfSyncEphemeralSetting:(b=b)!=null?b:void 0,revokeProtocolMsgId:a==null?void 0:(b=d(\"MAWJidUtils\").maybeToProtocolMsgId(a==null?void 0:a.author,a==null?void 0:a.threadJid,a==null?void 0:a.revokedExternalId))!=null?b:void 0})}function q(a,b,e,f,g){var i=b.author,j=b.chat,m=b.externalId;f===void 0&&(f=!1);if(e==null)return d(\"MAWDexieTable\").dexieResolve();d(\"MAWAddQPLPointForHandleIncomingMsgApi\").addQPLPointForHIMApi(\"write_msg_end\",{bool:{hasMessageBeenWritten:e!=null,isOneToOne:j.endsWith(d(\"WAJids\").MSGR_USER_DOMAIN)},string:{msgType:e.type}});d(\"MAWReceiveToUploadUtils\").checkUploadEligbility(m)&&(void k.load().then(function(a){return a.log(function(){return{encrypted_backup_enable:c(\"MAWEBSwitch\").isEnabled(),message_id:m}})}),(!f||!c(\"MAWEBSwitch\").isEnabled())&&void l.load().then(function(a){return a.log(function(){return{message_id:m,skipped_reason:\"Msg type: \"+e.type+\", EB enabled: \"+c(\"MAWEBSwitch\").isEnabled().toString()}})}));if(e==null)return d(\"MAWDexieTable\").dexieResolve();d(\"MAWAddQPLPointForHandleIncomingMsgApi\").addQPLPointForHIMApi(\"write_receipts_start\");b=d(\"MAWPendingReceiptProcessingTxns\").processPendingReceipts(a,j,e);f=i===d(\"WAJids\").AUTHOR_ME&&g!=null&&g.type!==d(\"MAWMsgType\").MSG_TYPE.DELETE_FOR_ME?d(\"MAWPendingReceiptProcessingTxns\").processPendingReceipts(a,j,g):d(\"MAWDexieTable\").dexieResolve();return d(\"MAWDexieTable\").dexieAll([b,f]).then(function(){d(\"WALogger\").LOG(h()),d(\"MAWAddQPLPointForHandleIncomingMsgApi\").addQPLPointForHIMApi(\"write_receipts_end\")})}g.handleIncomingMsgInternal=a;g.processReceipts=q}),98);\n__d(\"MAWLinkReactionsToMsgsTxns\",[\"LSQueryBulkUtils\",\"MAWDbMsgTxns\",\"MAWDbReactionUtils\",\"MAWDexieCastToPromise\",\"MAWRestoreRewriteUtils\",\"MAWTransactor\",\"WAMsgMap\",\"asyncToGeneratorRuntime\",\"err\",\"qex\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a){return a.reduce(function(a,b){var c,d={author:b.reactToAuthor,chat:b.threadJid,externalId:b.reactToExternalId};c=(c=a.get(d))!=null?c:[];c.push(b);return a.set(d,c)},new(d(\"WAMsgMap\").MsgMap)())}function i(a,b){b.forEach(function(b){var e=a.get(b.threadJid);if(e==null)throw c(\"err\")(\"Cannot send bridge update for reaction msg id\");d(\"MAWDbReactionUtils\").dispatchReaction(b,e)})}function j(a,b){return k.apply(this,arguments)}function k(){k=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){a=(yield d(\"MAWTransactor\").runInLSDB(function(a){return d(\"LSQueryBulkUtils\").bulkGetByIndex(a.e2ee_reactions.index(\"reactToExternalId\"),b)}));return a});return k.apply(this,arguments)}function l(a,b){return a.reactions.where(\"reactToExternalId\").anyOf(b).toArray()}function m(a,b){var c=d(\"MAWRestoreRewriteUtils\").shouldUseRestoreLLA()?function(){return d(\"MAWDexieCastToPromise\").promiseCastToDexiePromise_I_KNOW_WHAT_I_AM_DOING(j(a,b))}:function(){return l(a,b)};return c().then(function(a){return h(a.filter(function(a){return a.reactToMsgId==null}))})}function a(a,b){return m(a,b).then(function(b){return d(\"MAWDbMsgTxns\").getMsgsByProtocolMsgId(a,b.keys()).then(function(a){return a.flatMap(function(a){var c={author:a.author,chat:a.threadJid,externalId:a.externalId};c=(c=b.get(c))!=null?c:[];return c.map(function(b){b.reactToMsgId=a.msgId;return b})})})})}function n(a,b,c){return a.reactions.bulkPut(b).then(function(){i(c,b)})}function o(a,b,c){return p.apply(this,arguments)}function p(){p=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,e,f){yield d(\"MAWTransactor\").runInLSDB(function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=a.e2ee_reactions;yield d(\"LSQueryBulkUtils\").bulkPut(a,e);c(\"qex\")._(\"1215\")!==!0&&i(f,e)});return function(b){return a.apply(this,arguments)}}())});return p.apply(this,arguments)}function e(a,b){var c=new Set(b.map(function(a){return a.threadJid}));return a.threads.where(\"jid\").anyOf(Array.from(c)).toArray().then(function(c){c=new Map(c.map(function(a){return[a.jid,a.chatId]}));return d(\"MAWRestoreRewriteUtils\").shouldUseRestoreLLA()?d(\"MAWDexieCastToPromise\").promiseCastToDexiePromise_I_KNOW_WHAT_I_AM_DOING(o(a,b,c)):n(a,b,c)})}g.getReactionLinkUpdatesForExternalIds=a;g.updateReactionLinks=e}),98);\n__d(\"MAWLinkReactionsToMsgsApi\",[\"MAWIndexedDb\",\"MAWLinkReactionsToMsgsTxns\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,reactions:d(\"MAWTransactionMode\").READWRITE,threads:d(\"MAWTransactionMode\").READONLY},\"linkReactionsToMsgs\",function(a){return function(b){return d(\"MAWLinkReactionsToMsgsTxns\").getReactionLinkUpdatesForExternalIds(a,b).then(function(b){return d(\"MAWLinkReactionsToMsgsTxns\").updateReactionLinks(a,b)})}});function a(a){return h(a)}g.linkReactionsToMsgs=a}),98);\n__d(\"MAWOfflineThreadTxns\",[\"MAWBridgeThread\",\"MAWDbGroupInfoTxns\",\"MAWDbParticipantTxns\",\"MAWDbThread\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWLoadMessageRequestCapabilitiesTxns\",\"MAWWriteBulkWriteIncomingAdminMsgTxns\",\"WAArrayZip\",\"WAJids\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,c){var e=new Set(b),f=new Map(),g=new Map();c.forEach(function(a){g.set(a.jid,\"exists\"),f.set(a.jid,a),e[\"delete\"](a.jid)});return e.size===0?d(\"MAWDexieTable\").dexieResolve({threadCreationResult:g,threads:f}):n(a,e).then(function(b){b.groupThreadsCreationData.forEach(function(a,b){a.groupInfo==null&&g.set(b,\"missing\")});return a.threads.bulkAdd(o(b),{allKeys:!0}).then(function(c){return d(\"MAWDbThreadTxns\").getThreadsByJids(a,Array.from(e.values())).then(function(c){l(c);var e=p(c),i=e.newGroupThreads;e=e.newOneToOneThreads;return d(\"MAWDexieTable\").dexieAll([h(a,e),j(a,b.groupThreadsCreationData,i),d(\"MAWWriteBulkWriteIncomingAdminMsgTxns\").writeE2EEAdminMsgsForIncomingCreatedThreads(a,c)]).then(function(){c.forEach(function(a){return f.set(a.jid,a)});return{threadCreationResult:g,threads:f}})})})})}function h(a,b){return d(\"MAWDexieTable\").dexieAll([i(a,b),d(\"MAWLoadMessageRequestCapabilitiesTxns\").loadMessageRequestDataForThreads(Array.from(b.values()))])}function i(a,b){var c=[],e=d(\"MAWGlobals\").getMyUserJid();b.forEach(function(a,b){c.push({threadId:a.chatId,threadJid:b,type:\"participant\",userJid:b}),e!==b&&c.push({threadId:a.chatId,threadJid:b,type:\"participant\",userJid:e})});return d(\"MAWDbParticipantTxns\").bulkAddParticipantsInThreads(a,c).then(function(){})}function j(a,b,c){var e=new Map();b.forEach(function(a,b){a=(a=a.groupInfo)==null?void 0:a.threadId;b=(b=c.get(b))==null?void 0:b.chatId;a!=null&&b!=null&&e.set(a,b)});return d(\"MAWDexieTable\").dexieAll([k(a,b,c),d(\"MAWDbParticipantTxns\").bulkMigrateParticipantsToNewThreads(a,e)])}function k(a,b,c){var e=[];b.forEach(function(a,b){a=a.groupInfo;b=c.get(b);if(!(a===null||b==null))return babelHelpers[\"extends\"]({},a,{threadId:b.chatId})});return d(\"MAWDbGroupInfoTxns\").bulkUpdateGroupInfo(a,e).then(function(){})}function l(a){a.forEach(function(a){return d(\"MAWIndexedDb\").afterTransaction({tag:\"VerifyThreadExists\",value:d(\"MAWBridgeThread\").createBridgeThread(a,a.optimisticThreadKey,void 0,\"createAllThreadsForOfflineMsgs\")})})}function m(a,b){return{folder:null,jid:a,lastReadMsg:null,lastReadMsgReceiptSent:null,lastReadMsgTs:null,newestMsg:null,newestMsgTs:b!=null?d(\"WATimeUtils\").castUnixTimeToMillisTime(b):null,oldestMsg:null,optimisticThreadKey:void 0,threadOrder:d(\"MAWDbThread\").craftThreadOrder(d(\"WATimeUtils\").millisTime(),a)}}function n(a,b){var c=[],e=[];b.forEach(function(a){d(\"WAJids\").switchOnMsgrChatJidType(a,{group:function(a){return c.push(a)},user:function(a){return e.push(a)}})});return d(\"MAWDbGroupInfoTxns\").getGroupInfos(a,c).then(function(a){var b=new Map(d(\"WAArrayZip\").zip(c,a));a=new Map(c.map(function(a){var c=b.get(a);return[a,{groupInfo:c,thread:m(a,c==null?void 0:c.creationTs)}]}));var f=new Map(e.map(function(a){return[a,{thread:m(a,null)}]}));return{groupThreadsCreationData:a,oneToOneThreadsCreationData:f}})}function o(a){var b=a.groupThreadsCreationData;a=a.oneToOneThreadsCreationData;return Array.from(b.values()).map(function(a){a=a.thread;return a}).concat(Array.from(a.values()).map(function(a){a=a.thread;return a}))}function p(a){var b=new Map(),c=new Map();a.forEach(function(a){d(\"WAJids\").switchOnMsgrChatJidType(a.jid,{group:function(c){return b.set(c,a)},user:function(b){return c.set(b,a)}})});return{newGroupThreads:b,newOneToOneThreads:c}}g.createAllThreadsForOfflineMsgs=a}),98);\n__d(\"MAWPreprocessMsgs\",[\"MAWAddQPLPointForHandleIncomingMsgApi\",\"MAWBuildIncomingMsgs\",\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWMediaManagementTxns\",\"MAWMsgActionType\",\"MAWMsgType\",\"MAWWriteMsgTxns\",\"MAWWriteXMAMessageTxns\",\"WAGlobals\",\"WAJids\",\"WALogger\",\"WAMsgMap\",\"WAResultOrError\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[BulkHIM] No unstored content for incoming message: SHOULD NEVER HAPPEN\"]);h=function(){return a};return a}function a(a){var b=new(d(\"WAMsgMap\").MsgMap)(),c=[];a.forEach(function(a){var e=a.msgData;a=a.unstoredContent;switch(e.type){case\"InvisibleMsg\":b.set(e.id,d(\"WAResultOrError\").makeResult({protocolMsgId:e.id,unknownDevice:!1,unknownGroup:!1}));break;default:c.push({msgData:e,unstoredContent:a});break}});return{messageResults:b,msgs:c}}function b(){}function e(a){var b=[],e=[];a.forEach(function(a){var f=a.msgData;a=a.unstoredContent;switch(f.type){case\"IncomingMsg\":var g=f.folder,i=f.id,j=f.reportingMeta;f=f.ts;var k=i.author,l=i.chat;i=i.externalId;if(a==null){d(\"WALogger\").ERROR(h());throw c(\"err\")(\"Missing unstored content\")}var m=a.unstoredDbEditActionMsg;a=a.unstoredDbReaction;if(a!=null){k={author:k,chat:l,externalId:i,folder:g,reportingMeta:j,serverTs:f,unstoredDbReaction:a};b.push(k)}m!=null&&e.push({chatJid:l,msg:m});break;case\"IncomingCiphertextMsg\":default:break}});return{editActionMsgs:e,reactionMsgs:b}}function f(a,b,e){var f=b.msgData,g=b.unstoredContent;d(\"MAWAddQPLPointForHandleIncomingMsgApi\").addQPLPointForHIMApi(\"handle_msg_start\",{string:{type:\"0\"}});b=f.folder;var h=f.id,j=f.ts,k={id:h,thread:e,ts:j},l=d(\"MAWDexieTable\").dexieResolve(babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.NO_ACTION,msg:null,type:null}));switch(f.type){case\"IncomingMsg\":if(g==null)return l;var m=g.unstoredDbMsg,n=g.unstoredDbRavenActionMsg,o=g.unstoredDbReaction,p=g.unstoredIncomingDbGroupInvite;if(n!=null)return d(\"MAWDexieTable\").dexieResolve(babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,msg:n,type:d(\"MAWMsgType\").MSG_TYPE.RAVEN_ACTION}));else if(o!=null)return d(\"MAWDexieTable\").dexieResolve(babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,msg:o,type:d(\"MAWMsgType\").MSG_TYPE.REACTION}));else if(p!=null)return d(\"MAWDexieTable\").dexieResolve(babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,device:f.device,folder:b,msg:p,type:d(\"MAWMsgType\").MSG_TYPE.GROUP_INVITE}));else if(m==null)return l;else if(m.type===d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SETTING_ADMIN){n=f.msg;if(n.version===\"v3\"&&n.type===\"ephemeral\")return d(\"MAWDexieTable\").dexieResolve(babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,device:f.device,msg:n,type:m.type}));else throw c(\"err\")(\"Unexpected msg type when writing ephemeral setting message\")}else if(m.type===d(\"MAWMsgType\").MSG_TYPE.ICDC_ALERT)return d(\"MAWDexieTable\").dexieResolve(babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,data:null,device:f.device,folder:b,type:m.type}));else if(m.type===d(\"MAWMsgType\").MSG_TYPE.TEXT||m.type===d(\"MAWMsgType\").MSG_TYPE.FUTUREPROOF)return d(\"MAWWriteMsgTxns\").prepareMsgWriteData(a,m,e).then(function(a){var b=a.existingMsg,c=a.isDeletedWithThread,e=a.isDeleteForMeOrRevoked,g=a.pendingDeleteForMeStanza;a=a.pendingRevokedStanza;var h=i(b,m);if(e||c||b!=null&&h!==!0)return l;if(h&&b!=null)return babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.UPDATE_CIPHERTEXT,device:f.device,existingMsg:b,msg:m,type:m.type});if(g!=null)return babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.DELETE_FOR_ME,msg:m,pendingDeleteForMeStanza:g,type:m.type});return a!=null?babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.REVOKE,device:f.device,msg:m,pendingRevokedStanza:a,type:m.type}):babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,device:f.device,msg:m,type:m.type})});else if(m.type===d(\"MAWMsgType\").MSG_TYPE.IMAGE||m.type===d(\"MAWMsgType\").MSG_TYPE.VIDEO||m.type===d(\"MAWMsgType\").MSG_TYPE.PTT||m.type===d(\"MAWMsgType\").MSG_TYPE.GIF||m.type===d(\"MAWMsgType\").MSG_TYPE.STICKER||m.type===d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE||m.type===d(\"MAWMsgType\").MSG_TYPE.RAVEN)return d(\"MAWMediaManagementTxns\").prepareMediaWriteData(a,m,g==null?void 0:g.unstoredDbMedia,e).then(function(a){var b=a.existingMsg,c=a.isDeletedWithThread,e=a.isDeleteForMeOrRevoked,h=a.pendingDeleteForMeStanza,j=a.pendingRevokedStanza;a=a.shouldDropDocument;var n=[g==null?void 0:g.unstoredDbMedia,i(b,m)],o=n[0];n=n[1];if(a===!0||e||c||o==null||b!=null&&!n)return l;if(n&&b!=null)return babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.UPDATE_CIPHERTEXT,device:f.device,existingMsg:b,media:o,msg:m,type:m.type});if(h!=null)return babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.DELETE_FOR_ME,msg:m,pendingDeleteForMeStanza:h,type:m.type});return j!=null?babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.REVOKE,device:f.device,msg:m,pendingRevokedStanza:j,type:m.type}):babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,device:f.device,media:o,msg:m,type:m.type})});else if(m.type===d(\"MAWMsgType\").MSG_TYPE.XMA){var q=g==null?void 0:g.unstoredXMA;return q==null?l:d(\"MAWWriteXMAMessageTxns\").prepareXMAWriteData(a,m,q,e).then(function(a){var b=a.xmaData.existingMsg,c=i(b,m);if(a.associatedMsg!=null&&a.associatedData!=null&&!a.associatedData.isDeletedWithThread&&!a.associatedData.isDeleteForMeOrRevoked)if(c&&b!=null)return babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.UPDATE_CIPHERTEXT_WITH_ASSOCIATED,associatedMsg:a.associatedMsg,device:f.device,existingMsg:b,msg:a.xmaMsg,type:m.type,xma:q});else return babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE_WITH_ASSOCIATED,associatedMsg:a.associatedMsg,device:f.device,msg:a.xmaMsg,type:m.type,xma:q});if(c&&b!=null)return babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.UPDATE_CIPHERTEXT,device:f.device,existingMsg:b,msg:a.xmaMsg,type:m.type,xma:q});c=a.xmaData;var e=c.isDeletedWithThread,g=c.isDeleteForMeOrRevoked,h=c.pendingDeleteForMeStanza;c=c.pendingRevokedStanza;if(e||g||b!=null)return l;if(h!=null)return babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.DELETE_FOR_ME,msg:a.xmaMsg,pendingDeleteForMeStanza:h,type:m.type});return c!=null?babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.REVOKE,device:f.device,msg:a.xmaMsg,pendingRevokedStanza:c,type:m.type}):babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,device:f.device,msg:a.xmaMsg,type:m.type,xma:q})})}else if(m.type===d(\"MAWMsgType\").MSG_TYPE.REVOKED)return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbMsgTxns\").maybeGetMsgByExternalId(a,m.revokedExternalId,e.chatId,h.author),d(\"MAWDbMsgTxns\").maybeGetMsgByExternalId(a,m.externalId,e.chatId,h.author)]).then(function(a){var b=a[0];a=a[1];return babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,device:f.device,msg:m,originalMsg:b,previousRevokeMsg:a,type:m.type})});else if(m.type===d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION){o=d(\"WAJids\").isAuthorMe(h.author)?d(\"WAGlobals\").getMyUserJid():h.author;return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbMsgTxns\").maybeGetMsgByExternalId(a,h.externalId,e.chatId,o)]).then(function(a){a=a[0];return babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,device:f.device,existingMsg:a,screenshotActionType:m.msgContent.screenshotActionType,type:m.type})})}else if(m.type===d(\"MAWMsgType\").MSG_TYPE.BUMP_EXISTING_MESSAGE)return d(\"MAWDexieTable\").dexieResolve(babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,device:f.device,msg:m,type:m.type}));else throw c(\"err\")(\"[BulkHIM] Unsupported message type on preprocessing\");case\"IncomingCiphertextMsg\":if(!((p=f==null?void 0:f.createPlaceholder)!=null?p:!1))return l;var r=d(\"MAWBuildIncomingMsgs\").buildUnstoredCiphertextMsg(h,j);return d(\"MAWWriteMsgTxns\").prepareMsgWriteData(a,r,e).then(function(a){var b=a.existingMsg,c=a.isDeletedWithThread;a=a.isDeleteForMeOrRevoked;return a||c||b!=null?l:babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,msg:r,type:d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT})});case\"UnavailableMsg\":case\"FrankingInvalidMsg\":var s=d(\"MAWBuildIncomingMsgs\").buildUnstoredUnavailableMsg(h,j);return d(\"MAWWriteMsgTxns\").prepareMsgWriteData(a,s,e).then(function(a){var b=a.existingMsg,c=a.isDeletedWithThread;a=a.isDeleteForMeOrRevoked;return a||c||b!=null?l:babelHelpers[\"extends\"]({},k,{action:d(\"MAWMsgActionType\").MSG_ACTION.WRITE,msg:s,type:d(\"MAWMsgType\").MSG_TYPE.UNAVAILABLE})})}}function i(a,b){return a!=null&&a.type===d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT&&b.type!==d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT}g.separateResultsForInvisibleMessages=a;g.getIsDeviceKnown=b;g.classifyIncomingMsgs=e;g.getMessageDataByType=f;g.isCiphertextUpdate=i}),98);\n__d(\"WAThrottle\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a,b){var c=0,d=null,e;function f(){var f=Date.now(),g=f-c;for(var h=arguments.length,i=new Array(h),j=0;j<h;j++)i[j]=arguments[j];e=i;g>=b?(clearTimeout(d),d=null,a.apply(void 0,i),c=Date.now()):d==null&&(d=setTimeout(function(){return a.apply(void 0,e)},b-g))}return f}f.throttle=a}),66);\n__d(\"MAWSharedOfflineResumeUINotifier\",[\"MAWBridge\",\"MAWQplProxy\",\"MAWSharedProtocolQueueConst\",\"WAOfflineUtils\",\"WATagsLogger\",\"WAThrottle\",\"promiseDone\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([' -> Unable to send \"Offline Complete\" event ',\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([' -> \"Offline Complete\" bridge event sent']);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAW UI: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Set thread metadata: \",\", \",\"\"]);k=function(){return a};return a}var l=1e3\/3,m=d(\"WATagsLogger\").TAGS([\"ProtocolQueue\",\"MAWConsumer\"]);a=function(){function a(){var a=this;this.$1={};this.$2={};this.$3=0;this.$4=\"wa\";this.$5=!1;this.$6=0;this.$7=0;this.$8=0;this.$9=0;this.$10=null;this.$17=d(\"WAThrottle\").throttle(function(){if(a.$5)return;a.$16(d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Processing)},l);this.$12=d(\"WAThrottle\").throttle(function(){a.$4===\"wa\"&&a.$5===!1&&a.$11(d(\"WAOfflineUtils\").WAClientInfraOfflineProgress.Processing)},l)}var b=a.prototype;b.subscribeToWAEvents=function(a){var b=this;a.subscribe(function(a){switch(a.type){case\"offline-start\":b.$10=d(\"MAWQplProxy\").performanceAbsoluteNow();b.$6=a.offlineStats.count;b.$8=a.offlineStats.message;b.$11(d(\"WAOfflineUtils\").WAClientInfraOfflineProgress.Initializing,b.$10);b.$5=!1;b.$4=\"wa\";break;case\"offline-processed\":break;case\"offline-entity\":b.$7++;b.$12();break;case\"offline-end\":b.$11(d(\"WAOfflineUtils\").WAClientInfraOfflineProgress.Complete);b.$4=\"maw\";break;case\"connection-lost\":b.$11(d(\"WAOfflineUtils\").WAClientInfraOfflineProgress.Failed);break;default:a}})};b.subscribeToMawEvents=function(a){var b=this;a.subscribe(function(a){switch(a.type){case\"maw-infra-start\":b.$10==null&&(b.$10=d(\"MAWQplProxy\").performanceAbsoluteNow());b.$13();break;case\"maw-infra-end\":a.success?b.$14():b.$15();b.$10=null;break}})};b.subscribeToMessageEvents=function(a){var b=this;a.subscribe(function(a){switch(a.type){case\"new-message\":if(a.commonMessageBase.offline==null)return;b.addWAMessage();break}})};b.addWAMessage=function(){this.$9++,this.$12()};b.$13=function(){this.$3=0,this.$5=!1,this.$16(d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Initializing)};b.setThreadMetadata=function(a){var b=a.reduce(function(a,b){a[b.from]=b.t;return a},{});a=a.reduce(function(a,b){b=b.from;a[b]={chatStatus:d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Processing,snippetStatus:d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Processing};return a},{});m.DEV(k(),JSON.stringify(b),JSON.stringify(a));this.$1=b;this.$2=a};b.notifyUIChatReady=function(a){this.$2[a]={chatStatus:d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Complete,snippetStatus:d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Complete},this.$16(d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Processing)};b.updateChatState=function(a){var b=this;Object.entries(a).forEach(function(a){var c=a[0];a=a[1];if(b.$1[c]!=null){var e=b.$1[c];a>=e&&(b.$2[c]={chatStatus:d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Complete,snippetStatus:d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Complete})}});this.$17()};b.addMAWEntity=function(a){this.$3+=a,this.$17()};b.$14=function(){var a=this;Object.keys(this.$2).forEach(function(b){a.$2[b]={chatStatus:d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Complete,snippetStatus:d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Complete}});this.$5=!0;this.$16(d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Complete);this.$1={};this.$2={}};b.$15=function(){var a=this;Object.keys(this.$2).forEach(function(b){a.$2[b]={chatStatus:d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Complete,snippetStatus:d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Complete}});this.$16(d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Failed);this.$1={};this.$2={}};b.maybeNotifyUI=function(){this.$17()};b.$11=function(a,b){d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"offlineSnapshot\",{downloaded:{count:this.$7,message:this.$9},expected:{count:this.$6,message:this.$8},status:a,timestamp:b!=null?b:d(\"MAWQplProxy\").performanceAbsoluteNow()})};b.$16=function(a){var b=d(\"MAWQplProxy\").performanceAbsoluteNow();b={chatJidStatus:this.$2,startTime:this.$10!=null?this.$10:null,status:a,timestamp:b,totalExpectedCount:this.$6,totalProcessedCount:this.$3};m.LOG(j(),JSON.stringify(b));a===d(\"MAWSharedProtocolQueueConst\").OfflineConsumerStatus.Complete?c(\"promiseDone\")(d(\"MAWBridge\").getBridge().sendAndReceive(\"event\",\"offlineConsumerProgress\",b),function(){m.LOG(i())},function(a){m.ERROR(h(),a)}):d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"offlineConsumerProgress\",b)};return a}();b=new a();g.ConsumerUINotifier=a;g.offlineResumeUINotifier=b}),98);\n__d(\"MAWLoadGroupInvitesTxns\",[\"MAWBridgeTypesCreators\",\"MAWDbGroupInviteTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"WAGlobals\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){var c=[],e=d(\"WAGlobals\").getMyUserJid();b.forEach(function(b){return d(\"WAJids\").switchOnMsgrChatJidType(b.jid,{group:function(){c.push(d(\"MAWDbGroupInviteTxns\").getGroupInvitesByThreadAndInvitedParticipant(a,b.jid,e))},user:function(){}})});return d(\"MAWDexieTable\").dexieAll(c).then(function(a){a.forEach(function(a,b){a.forEach(function(b,a){d(\"MAWIndexedDb\").afterTransaction({tag:\"GroupInviteUpdate\",value:d(\"MAWBridgeTypesCreators\").createBridgeGroupInvite(b)})})})})}g.loadGroupInvites=a}),98);\n__d(\"MAWLoadMsgsTxns\",[\"MAWBridgeMsg\",\"MAWBridgeMsgCountdown\",\"MAWBridgeTypesCreators\",\"MAWBridgeXMA\",\"MAWDbChunkTxns\",\"MAWDbEditMsgHistoryTxns\",\"MAWDbMediaTxns\",\"MAWDbMsgTxns\",\"MAWDbReactionUtils\",\"MAWDbReactionsTxns\",\"MAWDbXMATxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWLoadReplyMediaTxns\",\"MAWLoggerUtils\",\"MAWMediaAfterTxns\",\"MAWXMAUtils\",\"WATagsLogger\",\"qex\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"EphemeralCounter: Showing UI counter for \",\"\"]);h=function(){return a};return a}function i(a,b){return d(\"MAWDbMediaTxns\").getMsgMediaPairFromMsgs(a,b).then(function(b){return d(\"MAWDexieTable\").dexieAll(b.map(function(b){var c=b[0],e=b[1];return d(\"MAWDbChunkTxns\").hasMediaChunk(a,e.hashedPlaintextHash).then(function(a){d(\"MAWMediaAfterTxns\").handleNewMediaAfterTxn(c,e,a)})}))})}function j(a,b,c){return d(\"MAWDbXMATxns\").getXMAFromMsgs(a,b).then(function(b){return d(\"MAWDexieTable\").dexieAll(b.map(function(b){if(d(\"MAWXMAUtils\").isXMAStoryReply(b.targetType))return;return d(\"MAWDbMediaTxns\").maybeGetMediaFromMediaId(a,b.defaultPreviewMediaId).then(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"NewXMA\",value:d(\"MAWBridgeXMA\").createBridgeXMA(c,a,b)})})}))})}function k(a,b,c){return d(\"MAWDbReactionsTxns\").getReactionsFromMessages(a,b).then(function(a){a.forEach(function(a){return d(\"MAWDbReactionUtils\").dispatchReaction(a,c)});return a})}function a(a,b,e,f,g,l,m){l===void 0&&(l=!1);return d(\"MAWDbMsgTxns\").getMsgsFromOffset(a,b,f,g,l,!1,m).then(function(b){var c=b.msgs,e=babelHelpers.objectWithoutPropertiesLoose(b,[\"msgs\"]);return d(\"MAWDexieTable\").dexieAll(c.map(function(b){return d(\"MAWLoadReplyMediaTxns\").getReplyMediaForMsgQuote(a,b)})).then(function(a){return babelHelpers[\"extends\"]({msgs:c,replyMediaInfo:a},e)})}).then(function(g){var n=g.hasMoreAfter,o=g.hasMoreBefore,p=g.msgs,q=g.replyMediaInfo;if(p.length>0&&c(\"qex\")._(\"1210\")!==!0){g=p.map(function(a,b){if(d(\"MAWXMAUtils\").isXMAStoryReply(a.xmaMessageType))return;return d(\"MAWBridgeMsg\").createBridgeMsg(a,void 0,(q||[])[b])}).filter(Boolean);g.length>0&&d(\"MAWIndexedDb\").afterTransaction({tag:\"NewMsgs\",value:{msgs:g}})}g=p.filter(function(a){return a.ephemeralCounterStarted});g.length>0&&(d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.Ephemeral,d(\"MAWLoggerUtils\").Tag.Countdown,d(\"MAWLoggerUtils\").Tag.OnLoad]).LOG(h(),g.map(function(a){return a.msgId})),d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgsStartCountdown\",value:d(\"MAWBridgeMsgCountdown\").createBridgeMsgsStartCountdown(g)}));(p.length>0||f==null)&&d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgsLoaded\",value:d(\"MAWBridgeTypesCreators\").createBridgeMsgsLoadedInfo(b,e,p,l,o,n,m)});return d(\"MAWDexieTable\").dexieAll([k(a,p,b),d(\"MAWDbEditMsgHistoryTxns\").loadEditMsgHistory(a,p),i(a,p),j(a,p,b)]).then(function(a){a=a[0];return{hasMoreAfter:n,hasMoreBefore:o,msgs:p,reactions:a}})})}g.loadMsgsAndMediaFromOffset=a}),98);\n__d(\"MAWLoadThreadsTxns\",[\"FBLogger\",\"MAWBridgeParticipants\",\"MAWBridgeThread\",\"MAWBridgeTypesCreators\",\"MAWDbMsg\",\"MAWDbParticipantTxns\",\"MAWDbReaction\",\"MAWDbReactionUtils\",\"MAWDexieTable\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWLoadGroupInvitesTxns\",\"MAWLoadMessageRequestCapabilitiesTxns\",\"MAWLoadMsgsTxns\",\"MAWThreadSnippetBuildTxns\",\"MAWTransactionMode\",\"WAJids\",\"WALogger\",\"err\",\"qex\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,c,e,f){f===void 0&&(f=\"loadContentsForThreads\");b.forEach(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"VerifyThreadExists\",value:d(\"MAWBridgeThread\").createBridgeThread(a,e==null?void 0:e.get(a.jid),void 0,f)})});return d(\"MAWDexieTable\").dexieAll([].concat(b.map(function(b){return j(a,b,c)}),[h(a,b),l(a,b),d(\"MAWLoadMessageRequestCapabilitiesTxns\").loadMessageRequestDataForThreads(b),d(\"MAWLoadGroupInvitesTxns\").loadGroupInvites(a,b)])).then(function(){return b})}function b(a,b,c,e){return d(\"MAWDexieTable\").dexieAll([h(a,[c]),j(a,c,e),i(a,c)]).then(function(e){e=e[0];b||n(a,c.jid,c.chatId,d(\"WAJids\").interpretAsGroupJid(c.jid)!=null,!1,c.cannotReplyReason,c.archived);return e})}function h(a,b){return b.length===0?d(\"MAWDexieTable\").dexieResolve([]):d(\"MAWDbParticipantTxns\").getParticipantsInThreads(a,b.map(function(a){return a.jid})).then(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"ParticipantsUpdated\",value:d(\"MAWBridgeParticipants\").createBridgeParticipants(a)});return a})}function i(a,b){var e=b.chatId,f=b.newestMsg,g=b.snippetMsg;g=(g=g)!=null?g:f;return g==null?d(\"MAWDexieTable\").dexieResolve():d(\"MAWDexieTable\").dexieAll([a.messages.get({msgId:g}),a.reactions.get({reactionId:g})]).then(function(f){var g=f[0];f=f[1];g!=null&&f!=null&&c(\"FBLogger\")(\"mpf_web_foundations\").warn(\"[MAWLoadThreadsTxns] msgId collision detected between Reaction and Message\");f!=null&&c(\"qex\")._(\"1215\")!==!0&&d(\"MAWDbReactionUtils\").dispatchReaction(f,e);return k(a,g,b,f).then(function(a){if(a!=null){var c=a.snippetParams,e=a.snippetSenderContactId;a=a.snippetType;d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadUpdated\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdatedThread({snippetParams:c,snippetSenderContactId:e,snippetType:a,threadId:b.chatId,threadJid:b.jid})})}})})}function j(a,b,c){var e=b.chatId;return d(\"MAWLoadMsgsTxns\").loadMsgsAndMediaFromOffset(a,e,b.jid,null,c,!0)}function k(a,b,c,e){e=e!=null?d(\"MAWDbReaction\").castToIncomingDbReaction(e):e;return e!=null&&e.ts>(b!=null?d(\"MAWDbMsg\").getCanonicalTsFromMsg(b):0)?d(\"MAWThreadSnippetBuildTxns\").buildReactionThreadSnippet(a,e.author,e.reaction,c.jid):b==null?d(\"MAWDexieTable\").dexieResolve(null):d(\"MAWThreadSnippetBuildTxns\").buildThreadSnippet(a,b,c)}function l(a,b){var c=[];b.forEach(function(a){return d(\"WAJids\").switchOnMsgrChatJidType(a.jid,{group:function(a){return c.push(a)},user:function(){}})});return a.groupInfo.bulkGet(c).then(function(a){a.forEach(function(a){a!=null&&d(\"MAWIndexedDb\").afterTransaction({tag:\"GroupInfoUpdated\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdatedGroupInfo(a)})})})}e=function(a){var b=a.threadId;a=a.threadJid;return m(a,b)};var m=d(\"MAWIndexedDb\").makeMsgrTransactor({participants:d(\"MAWTransactionMode\").READONLY},\"checkIfGroupParticipant\",function(a){return function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];return n.apply(void 0,[a].concat(c))}});function n(a,b,e,f,g,h,i){f===void 0&&(f=!0);g===void 0&&(g=!0);var j=d(\"MAWGlobals\").getMyUserJid();return d(\"MAWDbParticipantTxns\").getParticipant(a,e,j).then(function(a){if(!a.success){var k=f?\"group\":\"one_to_one\";d(\"WALogger\").LOG([\"[Occamadillo] User is not a participant of \"+k+\" thread\\n        \"+e.toString()+\", showing a VIEWER_NOT_SUBSCRIBED composer blocker\"]);if(h==null){var l;c(\"FBLogger\")(\"mpf_web_foundations\",\"checkIfParticipant\").catching((l=a.payload)!=null?l:c(\"err\")(a.error)).warn(\"[Occamdillo] User %s is not a participant of %s thread %s, occam: %s, archived: %s, cannotReplyReason null.\",j,k,e.toString(),g,i)}l={cannotReplyReason:\"viewer_not_subscribed\",fromCheckIfParticipant:!0,threadId:e,threadJid:b};d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadUpdated\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdatedThread(l)})}})}g.loadContentsForThreads=a;g.loadParticipantsAndMsgs=b;g.loadParticipants=h;g.loadGroups=l;g.checkIfGroupParticipant=e}),98);\n__d(\"MAWThreadFetchAndEmitTxns\",[\"MAWBridgeTypesCreators\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWLoadGroupInvitesTxns\",\"MAWLoadMessageRequestCapabilitiesTxns\",\"MAWLoadThreadsTxns\",\"MAWThreadManagementTxns\",\"WAJids\",\"WATimeUtils\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,c,e,f){f===void 0&&(f=\"fetchAndEmitThread\");return d(\"WAJids\").switchOnMsgrChatJidType(b,{group:function(b){return d(\"MAWThreadManagementTxns\").getOrRepairGroupThread(a,b,c).then(function(a){return a==null?null:{created:a.created,thread:a.thread}})},user:function(b){var f;return d(\"MAWThreadManagementTxns\").getOrSetupOneToOneThread(a,{createTs:e==null?void 0:d(\"WATimeUtils\").castUnixTimeToMillisTime(e),folder:(f=c)!=null?f:void 0,userJid:b})}}).then(function(b){return b==null||b.thread==null?null:d(\"MAWLoadThreadsTxns\").loadContentsForThreads(a,[b.thread],1,null,f).then(function(){return b})})}function b(a,b){if(b.size===0)return d(\"MAWDexieTable\").dexieResolve();b=Array.from(b);return a.threads.where(\"jid\").anyOf(b).toArray().then(function(b){var e=b.filter(Boolean);c(\"gkx\")(\"23922\")&&b.forEach(function(a){return d(\"MAWIndexedDb\").afterTransaction({tag:\"UpdateMessageRange\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdateMessageRange(babelHelpers[\"extends\"]({},a,{newestMsg:null,newestMsgTs:null}))})});return d(\"MAWDexieTable\").dexieAll([d(\"MAWLoadThreadsTxns\").loadParticipants(a,e),d(\"MAWLoadThreadsTxns\").loadGroups(a,e),d(\"MAWLoadMessageRequestCapabilitiesTxns\").loadMessageRequestDataForThreads(e),d(\"MAWLoadGroupInvitesTxns\").loadGroupInvites(a,e)])}).then(function(){})}g.fetchAndEmitThread=a;g.emitThreadContents=b}),98);\n__d(\"MAWBulkHandleIncomingMsgApi\",[\"MAWBulkEditMsgsTxns\",\"MAWBulkWriteReactionsTxns\",\"MAWDbIdentityTxns\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWEBSwitch\",\"MAWEBUploadTrackingUtils\",\"MAWGlobals\",\"MAWHandleIncomingMsgApi\",\"MAWIndexedDb\",\"MAWLinkReactionsToMsgsApi\",\"MAWMsgType\",\"MAWODSProxy\",\"MAWOfflineThreadTxns\",\"MAWPreprocessMsgs\",\"MAWSharedOfflineResumeUINotifier\",\"MAWThreadFetchAndEmitTxns\",\"MAWTransactionMode\",\"WAGlobals\",\"WALogger\",\"WAOdsEnums\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[BulkHandleIncomingMessage] Previous message processing action failed so subsequent one can't succeed\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[BulkHandleIncomingMessage] ERROR!!! At this point we must have fields in the map, \",\"\"]);i=function(){return a};return a}function a(a){var b;return d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor({chunk:(b=d(\"MAWTransactionMode\")).READWRITE,contacts:b.READWRITE,deletedMessages:b.READWRITE,deviceChangeAlerts:b.READWRITE,editMsgHistory:b.READWRITE,ephemeralSettings:b.READWRITE,existingUsers:b.READWRITE,groupInfo:b.READWRITE,groupInvites:b.READWRITE,identity:b.READWRITE,media:b.READWRITE,mediaBackup:b.READWRITE,messages:b.READWRITE,meta:b.READONLY,participants:b.READWRITE,pendingReceipts:b.READWRITE,pendingStanzas:b.READWRITE,personalSenderKeyStatuses:b.READWRITE,reactions:b.READWRITE,receipts:b.READWRITE,threads:b.READWRITE,unrenderedMessages:b.READWRITE,xma:b.READWRITE},\"bulkHandleIncomingMsgs\",function(b){return function(){var e=d(\"MAWDexieTable\").dexieResolve();d(\"MAWODSProxy\").odsBumpEntityKey({amount:a.length,entity:d(\"WAOdsEnums\").Entity.TOTAL_INCOMING_MESSAGE,key:\"msgs\"});d(\"MAWDexieTable\").setDexiePSDItem(\"offlineQueueSize\",a.length);var f=d(\"MAWPreprocessMsgs\").separateResultsForInvisibleMessages(a),g=f.messageResults,k=f.msgs,l=new Set(k.map(function(a){a=a.msgData;return a.id.chat}));f=function(){var a=Array.from(l);return d(\"MAWDbThreadTxns\").getThreadsByJids(b,a).then(function(c){return d(\"MAWOfflineThreadTxns\").createAllThreadsForOfflineMsgs(b,a,c)})};var m=d(\"MAWPreprocessMsgs\").classifyIncomingMsgs(k),n=m.editActionMsgs,o=m.reactionMsgs,p=function(){var a=o.map(function(a){return{chatJid:a.chat,unstoredReaction:a.unstoredDbReaction}});return d(\"MAWBulkWriteReactionsTxns\").prepareReactionsData(b,a).then(function(a){c(\"MAWEBSwitch\").isEnabled()&&!d(\"WAGlobals\").getConfig().useEbUploadQueue()&&a.unstoredDbReactionsForInsertion.forEach(function(a){var b=d(\"MAWEBUploadTrackingUtils\").genInstanceKeyForMiddleware(a.reactToExternalId);b!=null&&d(\"MAWEBUploadTrackingUtils\").startUploadTracking(a.reactToExternalId,d(\"MAWMsgType\").MSG_TYPE.REACTION,\"receive\",b)});return d(\"MAWBulkWriteReactionsTxns\").bulkWriteReactions(b,a)})},q=function(a,b){var c=g.get(a);if(!b.success)g.set(a,b);else if(c==null)d(\"WALogger\").ERROR(i(),b);else if(!c.success)d(\"WALogger\").WARN(h());else{c=c.value;b=b.value;var e=b==null?void 0:b.revokeProtocolMsgId;e!=null&&(c=babelHelpers[\"extends\"]({},c,{revokeProtocolMsgId:e}));(b==null?void 0:b.outOfSyncEphemeralSetting)!=null&&(c=babelHelpers[\"extends\"]({},c,{outOfSyncEphemeralSetting:b.outOfSyncEphemeralSetting}));if((b==null?void 0:b.plaintextHashs)!=null){c=babelHelpers[\"extends\"]({},c,{plaintextHashs:(e=c.plaintextHashs)!=null?e:b.plaintextHashs})}(b==null?void 0:b.reactToExternalId)!=null&&(c=babelHelpers[\"extends\"]({},c,{reactToExternalId:b.reactToExternalId}));c=babelHelpers[\"extends\"]({},c,{msgType:(e=(e=c)==null?void 0:e.msgType)!=null?e:b==null?void 0:b.msgType});g.set(a,d(\"WAResultOrError\").makeResult(c))}};return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbIdentityTxns\").bulkGetUnknownDeviceStatus(b,k),f()]).then(function(a){var c=a[0];a=a[1];var f=a.threadCreationResult,h=a.threads;return p().then(function(){var a=d(\"MAWDexieTable\").dexieAll(k.map(function(a){var e,i=a.msgData;e=[h.get(i.id.chat),(e=f.get(i.id.chat))!=null?e:\"missing\",(e=c.get(d(\"MAWDbIdentityTxns\").getDeviceJid(i.id.author,(e=i.device)==null?void 0:e.id)))!=null?e:!0];var j=e[0],k=e[1];e=e[2];if(j==null){g.set(i.id,d(\"WAResultOrError\").makeError({type:\"no_thread\"}));return}g.set(i.id,d(\"WAResultOrError\").makeResult({protocolMsgId:i.id,unknownDevice:e,unknownGroup:k===\"missing\"}));return d(\"MAWPreprocessMsgs\").getMessageDataByType(b,a,j)}).filter(Boolean));return a.then(function(a){a.forEach(function(a){e=e.then(function(){return d(\"MAWHandleIncomingMsgApi\").handleIncomingMsgInternal(b,a)}).then(function(b){q(a.id,b),j(a.id,a.ts)})});return e}).then(function(){var a=n.length===0?d(\"MAWDexieTable\").dexieResolve():d(\"MAWBulkEditMsgsTxns\").prepareDataForMessageEdit(b,n).then(function(a){return d(\"MAWBulkEditMsgsTxns\").bulkEditMsgs(b,n,a)});return a.then(function(){return d(\"MAWThreadFetchAndEmitTxns\").emitThreadContents(b,l).then(function(){return{msgResults:g}})})})})})}})().then(function(a){var b=new Set();a.msgResults.values().forEach(function(a){if(a.success){a=a.value;(a==null?void 0:a.reactToExternalId)!=null?b.add(a.reactToExternalId):(a==null?void 0:a.protocolMsgId)!=null&&b.add(a.protocolMsgId.externalId)}});return d(\"MAWLinkReactionsToMsgsApi\").linkReactionsToMsgs(Array.from(b)).then(function(){return a})})}function j(a,b){var c;a=a.chat.toString();d(\"MAWSharedOfflineResumeUINotifier\").offlineResumeUINotifier.updateChatState((c={},c[a]=b,c));d(\"MAWSharedOfflineResumeUINotifier\").offlineResumeUINotifier.addMAWEntity(1);d(\"MAWGlobals\").getOfflineResumeStats().addMAWEntity(1)}g.bulkHandleIncomingMsgs=a}),98);\n__d(\"MAWCompareIdentity\",[\"MAWDbIdentityTxns\",\"MAWODSProxy\",\"MAWQplProxy\",\"SignalDbTypes\",\"WABase64\",\"WACryptoUtils\",\"WAJids\",\"WALogger\",\"WAOdsEnums\",\"WASignalKeys\",\"gkx\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Got identity mismatch \",\", \",\" in compare identity\"]);h=function(){return a};return a}function a(a){return a.meta.bulkGet([d(\"SignalDbTypes\").MetaKeysEnum.fbid,d(\"SignalDbTypes\").MetaKeysEnum.deviceId,d(\"SignalDbTypes\").MetaKeysEnum.identityKeyPair]).then(function(b){var e=b[0],f=b[1];b=b[2];e=e==null?void 0:e.value.fbid;f=f==null?void 0:f.value.deviceId;var g=b==null?void 0:b.value.identityKeyPair;if(e!=null&&f!=null){b=d(\"WAJids\").toDeviceJid(d(\"WAJids\").toMsgrUserJid(e),f);return d(\"MAWDbIdentityTxns\").bulkGetIdentities(a,[b]).then(function(a){if(!(a.length===0)){a=a[0];if((g==null?void 0:g.publicKey)==null)return!0;if(!d(\"WACryptoUtils\").serializedPubKeysEqual(a.identity,d(\"WASignalKeys\").serializePubKey(g))){var b=d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(741087294,\"2028\"));b.endSuccess();d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.COMPARE_IDENTITY,key:\"meta_identity_mismatch\"});c(\"gkx\")(\"23915\")&&c(\"gkx\")(\"23916\")&&d(\"WALogger\").ERROR(h(),d(\"WABase64\").encodeB64(a.identity),d(\"WABase64\").encodeB64(d(\"WASignalKeys\").serializePubKey(g)));return!1}}return!0})}return!0})}g.compareIdentityDexie=a}),98);\n__d(\"MAWCreateThreadThroughMI\",[\"MAWDexieTable\",\"MAWGetOrCreateThreadTxns\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWLoadThreadsTxns\",\"MAWThreadManagementTxns\",\"MAWTransactionMode\",\"WAJids\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READWRITE,editMsgHistory:a.READONLY,groupInfo:a.READWRITE,media:a.READWRITE,messages:a.READWRITE,participants:a.READWRITE,reactions:a.READONLY,threads:a.READWRITE,xma:a.READONLY},\"createThreadByJid\",function(a){return function(b){var c=b.authoritativeThreadKey,e=b.chatJid,f=b.lastActivityTimestampMs,g=b.lastReadWatermarkTimestampMs,h=b.numOfMsgsToLoad,i=d(\"WATimeUtils\").castToMillisTime(f),j=d(\"WATimeUtils\").castToMillisTime(g),k=d(\"MAWGlobals\").getMyUserJid();return d(\"WAJids\").switchOnMsgrChatJidType(e,{group:function(b){return d(\"MAWGetOrCreateThreadTxns\").getOrCreateThread(a,{authoritativeThreadKey:c,description:\"createThreadThroughMI\",jid:b,lastActivityTimestamp:i,lastReadWatermarkTimestamp:j})},user:function(b){return d(\"MAWThreadManagementTxns\").getOrSetupOneToOneThread(a,{authoritativeThreadKey:c,lastActivityTimestamp:i,lastReadWatermarkTimestamp:j,userJid:b})}}).then(function(b){var c=d(\"WAJids\").interpretAsGroupJid(b.thread.jid),e=c!=null;c=b.thread?b.thread:b;return d(\"MAWDexieTable\").dexieAll([d(\"MAWLoadThreadsTxns\").loadParticipantsAndMsgs(a,b.created&&e,c,(c=h)!=null?c:1)]).then(function(a){a=a[0];a=e&&(b.created||a.length===0||a.some(function(a){return a.addressable!==!0}));e&&d(\"MAWIndexedDb\").afterTransaction({tag:\"GroupInviteLoaded\",value:{actorId:d(\"WAJids\").extractUserId(k),threadId:b.thread.chatId,threadJid:b.thread.jid}});return{chatId:b.thread.chatId,chatJid:b.thread.jid,isCreated:b.created,shouldQueryForGroup:a}})})}});g.createThreadThroughMI=b}),98);\n__d(\"MAWDbAddDeviceChangeAlertsTxn\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a,b){return a.deviceChangeAlerts.add(b)}f.addDeviceChangeAlertsTxn=a}),66);\n__d(\"MAWDbAppDataTxns\",[\"MAWAckLevel\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"updateAppDataSystemAck on sent appData\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"updateAppDataSystemAck on non existing appData\"]);i=function(){return a};return a}function a(a,b,c){return a.appData.get({externalId:b}).then(function(b){if(!b){d(\"WALogger\").LOG(i());return null}if(b.ack>d(\"MAWAckLevel\").ACK.clock){d(\"WALogger\").LOG(h());return b}var e=babelHelpers[\"extends\"]({},b,{ack:c});return a.appData.put(e).then(function(){return e})})}function b(a,b){return a.appData.bulkGet(b)}g.updateAppDataSystemAck=a;g.bulkGetAppData=b}),98);\n__d(\"MAWDbContactsTxns\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a,b){return a.contacts.where(\"contactJid\").anyOf(b).toArray()}function b(a,b){return a.contacts.get({contactJid:b})}f.getContacts=a;f.getContact=b}),66);\n__d(\"MAWDbGetDeviceChangeAlertsByOptionsTxn\",[\"WAGlobals\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=d(\"WATimeUtils\").pastUnixTime(30*d(\"WATimeUtils\").DAY_SECONDS);function a(a,b){var c=b.after,e=b.isArchived,f=e===void 0?!1:e;e=b.limit;b=e===void 0?20:e;e=a.deviceChangeAlerts;return(c==null?e:e.where(\"deviceChangeAlertsId\").above(c)).filter(function(a){return a.isArchived===f&&a.ts>=h}).reverse().limit(b).toArray().then(function(a){return a.map(function(a){return babelHelpers[\"extends\"]({},a,{isCurrentDevice:d(\"WAGlobals\").getMyDeviceJid()===a.deviceJid})})})}g.getDeviceChangeAlertsByOptionsTxn=a}),98);\n__d(\"MAWDbGetDeviceChangeAlertsTxn\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a,b){return a.deviceChangeAlerts.get(b)}f.getDeviceChangeAlertsTxn=a}),66);\n__d(\"MAWDbGetUnArchivedDeviceChangeAlertsCountTxn\",[\"MAWIndexedDb\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return a.deviceChangeAlerts.filter(function(a){return a.isArchived===!1}).toArray().then(function(a){return d(\"MAWIndexedDb\").afterTransaction({tag:\"UnArchivedSelfDeviceChangeAlerts\",value:a.length})})}g.getUnArchivedDeviceChangeAlertsCountTxn=a}),98);\n__d(\"MAWDbMetaTxns\",[\"MAWTransactionMode\",\"MAWTransactor\",\"SignalDbTypes\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=d(\"MAWTransactor\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READWRITE},\"saveCAT\",function(a){return function(b){return a.meta.put({key:d(\"SignalDbTypes\").MetaKeysEnum.cat,value:{cat:b}}).then(function(){return b})}});function a(a){return a.meta.get(d(\"SignalDbTypes\").MetaKeysEnum.deviceUUID).then(function(a){return{deviceUUID:a==null?void 0:a.value.deviceUUID}})}function b(a){return a.meta.bulkGet([d(\"SignalDbTypes\").MetaKeysEnum.lastSignedPrekeyId,d(\"SignalDbTypes\").MetaKeysEnum.identityKeyPair]).then(function(a){var b=a[0];a=a[1];b=b==null?void 0:b.value.lastSignedPrekeyId;a=a==null?void 0:a.value.identityKeyPair;return{identityPair:a,keyId:b}})}function c(a){return a.meta.get(d(\"SignalDbTypes\").MetaKeysEnum.lastPrekeyId).then(function(a){return a==null?void 0:a.value.lastPrekeyId})}function e(a){return a.meta.get(d(\"SignalDbTypes\").MetaKeysEnum.lastPrekeyGenerationId).then(function(a){return a==null?void 0:a.value.lastPrekeyGenerationId})}function f(a){return a.meta.toArray()}g.saveCAT=h;g.getPushMetaData=a;g.maybeGetLastSignedPrekeyIdAndIdentity=b;g.maybeGetLastPrekeyId=c;g.maybeGetLastPrekeyGenerationId=e;g.getAllMeta=f}),98);\n__d(\"MAWDbPersonalSenderKeyStatusTxns\",[\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h={hasSenderKey:new Set(),rotateSenderKey:!0,senderKeyId:null,senderKeyTs:d(\"WATimeUtils\").castToUnixTime(0)};function a(a,b){var c=babelHelpers[\"extends\"]({},h,{groupJid:b});return a.personalSenderKeyStatuses.put(c).then(function(){return c})}function b(a,b,c){return k(a,b).then(function(b){var d=[];b.forEach(function(a){if(a==null||a.rotateSenderKey)return;c.forEach(function(b){return a.hasSenderKey[\"delete\"](b)});d.push(a)});return a.personalSenderKeyStatuses.bulkPut(d).then(function(){return b})})}function c(a,b){return a.personalSenderKeyStatuses.bulkDelete(b)}function e(a,b){return i(a,[b]).then(function(a){return a[0]})}function i(a,b){return k(a,b).then(function(b){var c=[];b.forEach(function(a){if(a==null)return;a.rotateSenderKey=!0;c.push(a)});return a.personalSenderKeyStatuses.bulkPut(c).then(function(){return b})})}function f(a,b){return a.personalSenderKeyStatuses.bulkPut(b).then(function(){})}function j(a,b,c,d){return a.personalSenderKeyStatuses.get(b).then(function(e){var f=babelHelpers[\"extends\"]({},e||h,{groupJid:b,rotateSenderKey:!1,senderKeyId:c,senderKeyTs:d});return a.personalSenderKeyStatuses.put(f).then(function(){return f})})}function k(a,b){return a.personalSenderKeyStatuses.bulkGet(b)}g.putNewPersonalSenderKeyStatus=a;g.removeDevicesToMultiplePersonalSenderKeyStatuses=b;g.bulkDeletePersonalSenderKeyStatus=c;g.setRotateSenderKeyToTrue=e;g.bulkSetRotateSenderKeyToTrueTxn=i;g.bulkUpdateSenderKeyStatus=f;g.updateSenderKeyStatusAsRotated=j;g.bulkGetPersonalSenderKeyStatuses=k}),98);\n__d(\"WAGetPrekeyIdsInRange\",[\"WASignalKeys\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=16777215;function i(a){return a}function a(a,b){var c=[];a=i(a);var e=i(b);if(a<=e)for(var f=a;f<=b;f++)c.push(d(\"WASignalKeys\").castToPreKeyId(f));else{for(b=a;b<h;b++)c.push(d(\"WASignalKeys\").castToPreKeyId(b));for(f=1;f<=e;f++)c.push(d(\"WASignalKeys\").castToPreKeyId(f))}return c}g.PRE_KEY_MAX_ID=h;g.getPrekeyIdsInRange=a}),98);\n__d(\"MAWDbPrekeyTxns\",[\"MAWDexieTable\",\"WAGetPrekeyIdsInRange\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){return a.prekeyGeneration.get(b).then(function(b){if(b==null)throw c(\"err\")(\"Expected a prekey generation row\");b=d(\"WAGetPrekeyIdsInRange\").getPrekeyIdsInRange(b.startingId,b.endingId);return h(a,b).then(function(a){return a.filter(Boolean).map(function(a){return a.encoded})})})}function b(a,b){return b.length===0?d(\"MAWDexieTable\").dexieResolve():a.prekey.bulkDelete(b).then(function(){})}function h(a,b){return a.prekey.bulkGet(b)}function e(a,b){return a.prekeyGeneration.bulkGet(b)}g.getPrekeysForGeneration=a;g.bulkDeletePreKeys=b;g.getPrekeys=h;g.getPrekeyGenerations=e}),98);\n__d(\"MAWDbSenderKeySessionTxns\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a,b){return a.senderKeySessions.bulkPut(b).then(function(){})}function b(a,b){return a.senderKeySessions.where(\"groupJid\").equals(b)[\"delete\"]()}function c(a,b){return a.senderKeySessions.bulkGet(b)}f.bulkPutSenderKeySessions=a;f.deleteSenderKeysByGroupJid=b;f.getSenderKeySessionsBySenderKeySessionId=c}),66);\n__d(\"MAWDbSessionTxns\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a,b){return a.session.bulkPut(b).then(function(){})}function b(a,b){return a.session.bulkGet(b)}f.bulkSaveSessions=a;f.bulkGetSessions=b}),66);\n__d(\"MAWDbSignedPrekeyTxns\",[\"MAWDbMetaTxns\",\"WAResultOrError\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return d(\"MAWDbMetaTxns\").maybeGetLastSignedPrekeyIdAndIdentity(a).then(function(b){var e=b.identityPair;b=b.keyId;if(b==null)if(e==null)return d(\"WAResultOrError\").makeError(\"missing-last-signed-prekey-id\",c(\"err\")(\"No lastSignedPrekeyId and registration in meta table.\"));else return d(\"WAResultOrError\").makeError(\"missing-last-signed-prekey-id\",c(\"err\")(\"No lastSignedPrekeyId in meta table but identity exists. Very bad\"));return a.signedPrekey.get({keyId:b}).then(function(a){return a==null?d(\"WAResultOrError\").makeError(\"missing-last-signed-prekey-id\",c(\"err\")(\"No signed prekey matches the lastSignedPrekeyId supplied\")):d(\"WAResultOrError\").makeResult(a.encoded)})})}function b(a,b){return a.signedPrekey.bulkGet(b)}g.getLatestSignedPreKey=a;g.getSignedPrekeys=b}),98);\n__d(\"MAWDbGetAlertsWithDeviceJidTxn\",[\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){return a.deviceChangeAlerts.filter(function(a){return a.deviceJid===b&&!a.loggedOut}).toArray().then(function(a){a.length>1&&c(\"err\")(\"Invalid result, more than one active devices with the same deviceJid: \"+b);return a[0]})}g.getAlertsWithDeviceJidTxn=a}),98);\n__d(\"MAWDbUpdateDeviceChangeAlertsTxn\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a,b){return a.deviceChangeAlerts.put(b)}f.updateDeviceChangeAlertsTxn=a}),66);\n__d(\"MAWDbUpdateDeviceChangeAlertsLogInStatusTxn\",[\"MAWDbGetAlertsWithDeviceJidTxn\",\"MAWDbUpdateDeviceChangeAlertsTxn\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){return d(\"MAWDbGetAlertsWithDeviceJidTxn\").getAlertsWithDeviceJidTxn(a,b).then(function(b){return d(\"MAWDbUpdateDeviceChangeAlertsTxn\").updateDeviceChangeAlertsTxn(a,babelHelpers[\"extends\"]({},b,{loggedOut:!0}))})}g.updateDeviceChangeAlertsLogInStatusTxn=a}),98);\n__d(\"WADevToolsDebugFns\",[\"WADevToolsBridge\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b={};for(var c in a){var e=a[c];b[c]={id:c,args:e.serializedArgs,desc:e.desc,title:e.name}}d(\"WADevToolsBridge\").getDevToolBridge().setHandlers(\"backend\",{getDebugFns:function(){return b},callDebugFn:function(b){var c=b.id;b=b.args;(c=a[c]).execute.apply(c,b)}})}function b(a,b){return babelHelpers[\"extends\"]({name:a},b)}g.registerDebugFnsToDevTool=a;g.defineDebugFunction=b}),98);\n__d(\"MAWDebugHydrateOfflineQueue\",[\"MAWExternalId\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWJobDefinitions\",\"MAWTransactionMode\",\"WADevToolsDebugFns\",\"asyncToGeneratorRuntime\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=function(a,c){var e=c.maxMessages,f=c.minMessages;return d(\"MAWIndexedDb\").makeMsgrTransactor({participants:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"debug\",function(c){return function(){return c.participants.toArray().then(function(b){return b.filter(function(b){return b.userJid===a.contactJid})}).then(function(a){a=a.map(function(a){return a.threadJid});return c.threads.where(\"jid\").anyOf(a).toArray().then(function(a){return Array.from(new Set(a.filter(function(a){return(a==null?void 0:a.archived)!==!0}).map(function(a){return a==null?void 0:a.jid}).filter(Boolean)))})}).then(function(a){setTimeout(b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){for(var b of a){var c=Math.floor(Math.random()*e)+f;for(var g=0;g<c;g++)yield d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.sendMsg(b,{content:\"Message \"+g},d(\"MAWExternalId\").generateExternalId()))}}),0)})}})()},i=function(a){return d(\"MAWIndexedDb\").makeSignalTransactor({contacts:d(\"MAWTransactionMode\").READONLY},\"debug\",function(b){return function(){var d=b.contacts.filter(function(b){return b.contactJid===a}).toArray();return d.then(function(a){if(a.length===0)throw c(\"err\")(\"No participant found\");a=a[0];return a})}})()};a=d(\"WADevToolsDebugFns\").defineDebugFunction(\"hydrateOfflineQueue\",{desc:\"Hydrate the offline queue for a target user\",execute:function(a,b,c){return i(a).then(function(a){return h(a,{maxMessages:b,minMessages:c})})},serializedArgs:[{desc:\"Name or Jid of the target user\",name:\"targetUserNameOrJid\",placeholder:\"Target user name or Jid\",type:\"string\"},{desc:\"Max number of messages per thread to send\",name:\"maxMessages\",placeholder:\"30\",type:\"number\"},{desc:\"Min number of messages per thread to send\",name:\"minMessages\",placeholder:\"1\",type:\"number\"}]});g.hydrateOfflineQueue=a}),98);\n__d(\"MAWDebugSendMultipleMsgs\",[\"MAWGlobals\",\"MAWJobDefinitions\",\"Promise\",\"WADevToolsDebugFns\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;a=d(\"WADevToolsDebugFns\").defineDebugFunction(\"sendMultipleMsgs\",{desc:\"Sends multiple messages to a thread\",execute:function(a,c){return(h||(h=b(\"Promise\"))).all(Array.from(Array(c).keys()).map(function(b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.sendMsg(a,{content:b+\" message\"}))}))},serializedArgs:[{desc:\"ChatJid of the thread to send messages to\",name:\"chatJid\",placeholder:\"1234@msgr\",type:\"string\"},{desc:\"Number of messages to send\",name:\"numberOfMsgs\",placeholder:\"100\",type:\"number\"}]});g.sendMultipleMsgs=a}),98);\n__d(\"MAWGetContactAndIdentitiesApi\",[\"MAWDbContactsTxns\",\"MAWDbIdentityTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({contacts:d(\"MAWTransactionMode\").READONLY,identity:d(\"MAWTransactionMode\").READONLY},\"getContactAndIdentitiesForUser\",function(a){return function(b){return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbContactsTxns\").getContact(a,b),d(\"MAWDbIdentityTxns\").getIdentitiesForUser(a,b)]).then(function(a){var b=a[0];a=a[1];if(b==null)return d(\"WAResultOrError\").makeError(\"missing_contact\");else{b={contact:{dhash:b.dhash,icdcInfo:b.icdcInfo},identities:a.map(function(a){return{deviceJid:a.deviceJid,identity:a.identity}})};return d(\"WAResultOrError\").makeResult(b)}})}});g.getContactAndIdentitiesForUser=a}),98);\n__d(\"MAWConvertXMATargetTypeToExtendedContentTargetType\",[\"EchoMessageXMAFieldUtils\",\"WAArmadilloXMA.pb\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Not a valid xmaTargetType: \",\"\"]);h=function(){return a};return a}function a(a){switch(a){case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_STORY_PHOTO_MENTION:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_SINGLE_IMAGE_POST_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_MULTIPOST_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_SINGLE_VIDEO_POST_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_STORY_PHOTO_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_STORY_VIDEO_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_CLIPS_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_IGTV_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_IGTV_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_SHOP_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SHOP_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_PROFILE_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_PROFILE_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_STORY_PHOTO_HIGHLIGHT_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_STORY_VIDEO_HIGHLIGHT_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_STORY_REPLY:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.IG_STORY_REACTION:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.FB_FEED_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.FB_STORY_REPLY:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.FB_STORY_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.FB_STORY_MENTION:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.FB_FEED_VIDEO_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_VIDEO_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.FB_GAMING_CUSTOM_UPDATE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.FB_PRODUCER_STORY_REPLY:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.MSG_EXTERNAL_LINK_SHARE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.RTC_AUDIO_CALL:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.RTC_VIDEO_CALL:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.RTC_MISSED_AUDIO_CALL:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.RTC_MISSED_VIDEO_CALL:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.RTC_GROUP_AUDIO_CALL:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.RTC_GROUP_VIDEO_CALL:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.FB_EVENT:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_EVENT;case d(\"EchoMessageXMAFieldUtils\").XMAContentType.MSG_RECEIVER_FETCH:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH;default:d(\"WALogger\").ERROR(h(),a);return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE}}g.convertXMATargetTypeToExtendedContentTargetType=a}),98);\n__d(\"MAWHandleEchoMsgsRestoreApiUtils\",[\"$InternalEnum\",\"EchoMessage\",\"EchoMessageMediaFieldUtils\",\"MAWAckLevel\",\"MAWConvertXMATargetTypeToExtendedContentTargetType\",\"MAWGlobals\",\"MAWJids\",\"MAWMsgType\",\"MAWRepliesRestoreUtils\",\"WAJids\",\"WALogger\",\"WAStanzaUtils\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Message content is empty for the message origin: \",\" type: \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Author info is missing from msg: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] thread has unsupported message type: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] thread has unsupported message content type: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] thread has unsupported message content type: \",\"\"]);l=function(){return a};return a}c=b(\"$InternalEnum\")({INITIAL_RESTORE:\"initial_restore\",POINT_RESTORE:\"point_restore\",PAGINATED_RESTORE:\"paginated_restore\"});function m(a){var b=a.contentType;switch(b){case d(\"EchoMessage\").EchoMessageContentType.TEXT:return d(\"MAWMsgType\").MSG_TYPE.TEXT;case d(\"EchoMessage\").EchoMessageContentType.MEDIA:return n(a);case d(\"EchoMessage\").EchoMessageContentType.PLACEHOLDER:if(a.contentSubtype===d(\"EchoMessage\").EchoMessageContentSubtype.UNSEND)return d(\"MAWMsgType\").MSG_TYPE.REVOKED;d(\"WALogger\").ERROR(l(),d(\"EchoMessage\").EchoMessageContentType.getName(b));break;case d(\"EchoMessage\").EchoMessageContentType.XMA:return d(\"MAWMsgType\").MSG_TYPE.XMA;case d(\"EchoMessage\").EchoMessageContentType.DECRYPTION_FAILURE:return d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT;default:d(\"WALogger\").ERROR(k(),d(\"EchoMessage\").EchoMessageContentType.getName(b))}return null}function n(a){a=a.mediaData;if(a!=null){switch(a.attachmentType){case d(\"EchoMessageMediaFieldUtils\").AttachmentType.IMAGE:return d(\"MAWMsgType\").MSG_TYPE.IMAGE;case d(\"EchoMessageMediaFieldUtils\").AttachmentType.STICKER:return d(\"MAWMsgType\").MSG_TYPE.STICKER;case d(\"EchoMessageMediaFieldUtils\").AttachmentType.VIDEO:return d(\"MAWMsgType\").MSG_TYPE.VIDEO;case d(\"EchoMessageMediaFieldUtils\").AttachmentType.GIF:return d(\"MAWMsgType\").MSG_TYPE.GIF;case d(\"EchoMessageMediaFieldUtils\").AttachmentType.PTT:return d(\"MAWMsgType\").MSG_TYPE.PTT;case d(\"EchoMessageMediaFieldUtils\").AttachmentType.XMA:return d(\"MAWMsgType\").MSG_TYPE.XMA;case d(\"EchoMessageMediaFieldUtils\").AttachmentType.DOCUMENT:return d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE}d(\"WALogger\").ERROR(j(),d(\"EchoMessageMediaFieldUtils\").AttachmentType.getName(a.attachmentType))}return null}function a(a,b,c,e){var f=a.from;if(f==null){d(\"WALogger\").ERROR(i(),e);return null}var g=m(a);if(g==null||a.isTombstoned!=null&&a.isTombstoned)return null;switch(g){case d(\"MAWMsgType\").MSG_TYPE.TEXT:case d(\"MAWMsgType\").MSG_TYPE.REVOKED:case d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT:return s(a,b,c,f,g,e);case d(\"MAWMsgType\").MSG_TYPE.IMAGE:case d(\"MAWMsgType\").MSG_TYPE.VIDEO:case d(\"MAWMsgType\").MSG_TYPE.STICKER:case d(\"MAWMsgType\").MSG_TYPE.GIF:case d(\"MAWMsgType\").MSG_TYPE.PTT:case d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE:return o(a,b,c,f,g,e);case d(\"MAWMsgType\").MSG_TYPE.XMA:return q(a,b,c,f,g,e)}return null}function o(a,b,c,d,e,f){a=t(a,b,c,d,e,f);return p(e,a)}function p(a,b){switch(a){case d(\"MAWMsgType\").MSG_TYPE.IMAGE:return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.IMAGE});case d(\"MAWMsgType\").MSG_TYPE.STICKER:return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.STICKER});case d(\"MAWMsgType\").MSG_TYPE.VIDEO:return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.VIDEO});case d(\"MAWMsgType\").MSG_TYPE.GIF:return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.GIF});case d(\"MAWMsgType\").MSG_TYPE.PTT:return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.PTT});case d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE:return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE})}}function q(a,b,c,e,f,g){b=t(a,b,c,e,f,g);return a.xmaData!=null&&a.xmaData.xmaTargetType!=null?babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.XMA,xmaMessageType:d(\"MAWConvertXMATargetTypeToExtendedContentTargetType\").convertXMATargetTypeToExtendedContentTargetType(a.xmaData.xmaTargetType)}):null}function r(a){if(a==null)return void 0;else switch(a){case d(\"EchoMessage\").MessageTextSize.SMALL:return 1;case d(\"EchoMessage\").MessageTextSize.MEDIUM:return 2;case d(\"EchoMessage\").MessageTextSize.LARGE:return 3;default:return void 0}}function s(a,b,c,e,f,g){var i=a.text;if(i==null&&f!==d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT){d(\"WALogger\").ERROR(h(),a.serializationOrigin,f);return null}b=t(a,b,c,e,f,g);if(f===d(\"MAWMsgType\").MSG_TYPE.REVOKED){i!=null&&(b.msgContent={content:i});a.revokeSentTimestampMs!=null&&(b.originalTs=d(\"WATimeUtils\").castToUnixTime(a.revokeSentTimestampMs));return babelHelpers[\"extends\"]({},b,{revokedExternalId:d(\"WAStanzaUtils\").toStanzaId(\"0\"),type:d(\"MAWMsgType\").MSG_TYPE.REVOKED,unsendMsgContentDeleteTs:a.revokeUnsentTimestampMS!=null?d(\"WATimeUtils\").castToUnixTime(a.revokeUnsentTimestampMS):b.ts})}else if(f===d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT)return babelHelpers[\"extends\"]({},b,{specialTextSize:r(a.textSize),type:d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT});else if(i!=null)return babelHelpers[\"extends\"]({},b,{msgContent:{content:i},specialTextSize:r(a.textSize),type:d(\"MAWMsgType\").MSG_TYPE.TEXT})}function t(a,b,c,e,f,g){e=u(e);e={ack:e===d(\"WAJids\").AUTHOR_ME?d(\"MAWAckLevel\").ACK.sent:d(\"MAWAckLevel\").ACK.received,altIndex:void 0,author:e,externalId:g,isForwarded:a.isForwarded,sortOrderMs:a.sortOrderMs,thread:b,threadJid:c,ts:d(\"WATimeUtils\").castToUnixTime(a.displayTimestampMs\/1e3),type:f};a.authoritativeTimestampMs!=null&&(e.serverTs=d(\"WATimeUtils\").castToUnixTime(a.authoritativeTimestampMs\/1e3));if(a.quoteData!=null){g=d(\"MAWRepliesRestoreUtils\").getQuoteDataFromEchoMessage(a);g!=null&&(e.quote=g,e.quoteExternalId=g.content.externalId)}return e}function u(a){a=d(\"MAWJids\").toUserJid(a.localKey);return a===d(\"MAWGlobals\").getMyUserJid()?d(\"WAJids\").AUTHOR_ME:a}g.MAWRestoreType=c;g.getUnstoredDbMessageFromEchoMessage=a;g.resolveAuthorFromEchoAddress=u}),98);\n__d(\"MAWRepliesRestoreUtils\",[\"FBLogger\",\"MAWBridgeMsg\",\"MAWDexieTable\",\"MAWGetMsgQuoteTxn\",\"MAWHandleEchoMsgsRestoreApiUtils\",\"MAWIndexedDb\",\"MAWLoadReplyMediaTxns\",\"MAWMsgType\",\"MAWTransactionMode\",\"MAWUpdateQuotedMsgTxns\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Quote data is missing for message: \",\"\"]);h=function(){return a};return a}function a(a,b){if(b==null||!d(\"MAWMsgType\").isQuotedMsgType(b.type))return a;else{b={author:b.author,externalId:b.externalId,ts:b.ts,type:b.type};b={content:b,remoteJid:null};return babelHelpers[\"extends\"]({},a,{quote:b})}}function b(a){if(a.quoteData!=null&&a.quoteData.quoteMessageId!=null&&a.quoteData.quoteMessageSender!=null){var b;b={author:d(\"MAWHandleEchoMsgsRestoreApiUtils\").resolveAuthorFromEchoAddress(a.quoteData.quoteMessageSender),externalId:(b=a.quoteData)==null?void 0:b.quoteMessageId,ts:a.displayTimestampMs,type:d(\"MAWMsgType\").MSG_TYPE.TEXT};return{content:b,remoteJid:null}}else d(\"WALogger\").ERROR(h(),a.messageId);return null}f=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(e=d(\"MAWTransactionMode\")).READONLY,media:e.READONLY,messages:e.READWRITE,threads:e.READWRITE,xma:e.READONLY},\"updateQuoteDataForReplyMessages\",function(a){return function(b,c){c==null?void 0:c.addPoint(\"replies_restore_start\");b=b.restoredMsgsData;if(b){var e=b.existingMsgs;b=b.newlyAddedMsgs;b=b.concat(e);return d(\"MAWDexieTable\").dexieAll(b.map(function(b){return d(\"MAWUpdateQuotedMsgTxns\").associateQuotedMessage(a,b.thread,b).then(function(a){var c=[];b.quoteExternalId!=null&&c.push(b);a!=null&&c.push.apply(c,a);return c})})).then(function(b){b=b.reduce(function(a,b){return b.length>0?a.concat(b):a},[]);return i(a,b)}).then(function(a){c==null?void 0:c.addPoint(\"replies_restore_end\",{\"int\":{replies:a}});return a})}return d(\"MAWDexieTable\").dexieResolve(0)}});function i(a,b){return d(\"MAWDexieTable\").dexieAll(b.map(function(b){var e=j(b);if(b.threadJid!=null)return d(\"MAWGetMsgQuoteTxn\").enhanceMsgWithQuoteInfo(a,e,b.threadJid).then(function(a){return babelHelpers[\"extends\"]({},a,{msgId:b.msgId,originalTs:b.originalTs,rowId:b.rowId,thread:b.thread,threadJid:b.threadJid,unsendMsgContentDeleteTs:b.unsendMsgContentDeleteTs})});else c(\"FBLogger\")(\"labyrinth_web\",\"thread_id_absent\").mustfix(\"Reply restore: threadId cannot be null for a restored msg\")})).then(function(a){return a.filter(Boolean).filter(function(a){return a.quote!=null})}).then(function(b){return a.messages.bulkPut(b).then(function(c){return b.map(function(b){return d(\"MAWLoadReplyMediaTxns\").getReplyMediaForMsgQuote(a,b).then(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgUpdated\",value:d(\"MAWBridgeMsg\").createBridgeMsg(b,void 0,a,void 0,void 0,\"EncryptedBackups\")})})})}).then(function(a){return(a=b==null?void 0:b.length)!=null?a:0})})}function j(a){a.msgId;a.originalTs;a.rowId;a.thread;a.threadJid;a.unsendMsgContentDeleteTs;a=babelHelpers.objectWithoutPropertiesLoose(a,[\"msgId\",\"originalTs\",\"rowId\",\"thread\",\"threadJid\",\"unsendMsgContentDeleteTs\"]);return a}g.addQuoteDataToReplyMessage=a;g.getQuoteDataFromEchoMessage=b;g.updateQuoteDataForReplyMessages=f;g.enhanceAndPersistReplyMessagesWithQuoteData=i}),98);\n__d(\"MAWHandleEchoReactionsRestore\",[\"MAWAckLevel\",\"MAWAuthor\",\"MAWBulkWriteReactionsTxns\",\"MAWHandleEchoMsgsRestoreApiUtils\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"Promise\",\"WAJids\",\"WALogger\",\"WAStanzaUtils\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] reaction fields in backup data uneven in length\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] reactToAuthor field is null\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] reaction external id missing\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] reaction string is not a single character\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Cannot have reactions empty author\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Cannot have reactions for system author\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] echo document is absent for a restored msg\"]);o=function(){return a};return a}function a(a,c){c==null?void 0:c.addPoint(\"reactions_restore_start\");var d=a.echoMsgMap,e=a.restoredMsgsData,f=0;if(e){a=e.existingMsgs;var g=e.newlyAddedMsgs;g=g.concat(a);var i=e.threadJid;a=g.filter(function(a){var b=d.get(a.externalId);return q(d,a)&&b!=null&&r(b)});if(a.length===0)return(h||(h=b(\"Promise\"))).resolve();var j=a.flatMap(function(a){var b=d.get(a.externalId);a=u(e.threadJid,a.externalId,a.msgId,a.author,b);return a.map(function(a){return{chatJid:i,unstoredReaction:a}})});return j.length===0?(h||(h=b(\"Promise\"))).resolve():p(j).then(function(a){f+=j.length,c==null?void 0:c.addPoint(\"reactions_restore_end\",{\"int\":{reactions:f}})})}return(h||(h=b(\"Promise\"))).resolve()}var p=d(\"MAWIndexedDb\").makeMsgrTransactor({groupInfo:(c=d(\"MAWTransactionMode\")).READWRITE,messages:c.READWRITE,reactions:c.READWRITE,threads:c.READWRITE},\"restoreWriteReactionsToDb\",function(a){return function(b){return d(\"MAWBulkWriteReactionsTxns\").prepareReactionsData(a,b).then(function(b){return d(\"MAWBulkWriteReactionsTxns\").bulkWriteReactions(a,b)})}});function q(a,b){a=a.get(b.externalId);if(a==null){d(\"WALogger\").ERROR(o());return!1}if(d(\"WAJids\").isAuthorSystem(b.author)){d(\"WALogger\").ERROR(n());return!1}if(d(\"MAWAuthor\").getAuthorUserJid(b.author)==null){d(\"WALogger\").ERROR(m());return!1}return!0}function r(a){return a.reactions!=null&&a.reactions.length!==0&&a.reactionXOfflineThreadingIds!=null&&a.reactionXOfflineThreadingIds.length!==0&&a.reactionAuthoritativeTimestampMs!=null&&a.reactionAuthoritativeTimestampMs.length!==0}function s(a,b,c){if((a==null?void 0:a.length)===0){d(\"WALogger\").ERROR(l());return!1}if(b==null){d(\"WALogger\").ERROR(k());return!1}if(c==null){d(\"WALogger\").ERROR(j());return!1}return!0}function t(a,b,c){return(a||[]).map(function(a,e){if(c==null||b==null||(c==null?void 0:c.length)<=e||(b==null?void 0:b.length)<=e){d(\"WALogger\").WARN(i());return[]}return[a,b[e],c[e]]})}function u(a,b,c,e,f){var g=d(\"MAWAuthor\").getAuthorUserJid(e);if(f==null||g==null)return[];var h=f.reactionAuthoritativeTimestampMs;h=h===void 0?[]:h;var i=f.reactionXOfflineThreadingIds;i=i===void 0?[]:i;f=f.reactions;return t(f,i,h).filter(function(a){var b=a[0];a=a[1];return a!=null&&s(b.displayName,a.displayName,d(\"MAWAuthor\").getAuthorUserJid(e))}).map(function(e){var f=e[0],h=e[1];e=e[2];var i=f.displayName;f=d(\"MAWHandleEchoMsgsRestoreApiUtils\").resolveAuthorFromEchoAddress(f);return{ack:f===d(\"WAJids\").AUTHOR_ME?d(\"MAWAckLevel\").ACK.sent:d(\"MAWAckLevel\").ACK.received,author:f,externalId:d(\"WAStanzaUtils\").toStanzaId(h.displayName||\"\"),groupingKey:i,reaction:i,reactToAuthor:g,reactToExternalId:b,reactToMsgId:c,threadJid:a,ts:d(\"WATimeUtils\").castToUnixTime(Number(e.displayName)\/1e3)}})}g.writeEchoReactionsToReactionsStore=a}),98);\n__d(\"MAWConvertXMAGatingTypeToExtendedContentOverlayIconGlyph\",[\"EchoMessageXMAFieldUtils\",\"WAArmadilloXMA.pb\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Not a valid xmaGatingType: \",\"\"]);h=function(){return a};return a}function a(a){switch(a){case d(\"EchoMessageXMAFieldUtils\").XMAGatingType.INFO:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.INFO;case d(\"EchoMessageXMAFieldUtils\").XMAGatingType.EYE_OFF:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.EYE_OFF;case d(\"EchoMessageXMAFieldUtils\").XMAGatingType.NEWS_OFF:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NEWS_OFF;case d(\"EchoMessageXMAFieldUtils\").XMAGatingType.WARNING:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.WARNING;case d(\"EchoMessageXMAFieldUtils\").XMAGatingType.PRIVATE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE;case d(\"EchoMessageXMAFieldUtils\").XMAGatingType.NONE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE;default:d(\"WALogger\").ERROR(h(),a);return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE}}g.convertXMAGatingTypeToExtendedContentOverlayIconGlyph=a}),98);\n__d(\"MAWConvertXMALayoutTypeToExtendedContentXMLLayoutType\",[\"EchoMessageXMAFieldUtils\",\"WAArmadilloXMA.pb\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Not a valid xmaLayoutType: \",\"\"]);h=function(){return a};return a}function a(a){switch(a){case d(\"EchoMessageXMAFieldUtils\").XMALayoutType.SINGLE:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.SINGLE;case d(\"EchoMessageXMAFieldUtils\").XMALayoutType.PORTRAIT:return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.PORTRAIT;default:d(\"WALogger\").ERROR(h(),a);return d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.SINGLE}}g.convertXMALayoutTypeToExtendedContentXMLLayoutType=a}),98);\n__d(\"MAWParseSubprotocolVersionConsts\",[],(function(a,b,c,d,e,f){\"use strict\";a=2;b=2;c=1;d=2;e=1;var g=1;f.ASSOCIATED_MESSAGE_SUBPROTOCOL_VERSION=a;f.XMA_PREVIEW_SUBPROTOCOL_VERSION=b;f.XMA_FAVICON_SUBPROTOCOL_VERSION=c;f.XMA_HEADER_SUBPROTOCOL_VERSION=d;f.RAVEN_IMAGE_MESSAGE_SUBPROTOCOL_VERSION=e;f.RAVEN_VIDEO_MESSAGE_SUBPROTOCOL_VERSION=g}),66);\n__d(\"WAParseMessageApplication\",[\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b,c,e=a.payload;if(e==null)return{version:\"v3\",type:\"error\",error:\"The messageApplication has no payload\"};if(d(\"decodeProtobuf\").getUnknownFields(a.payload)!=null)return{version:\"v3\",type:\"error\",error:\"There are unknown fields in the message application payload\"};e=e.subProtocol;if(e==null)return{version:\"v3\",type:\"error\",error:\"The messageApplication payload has no subProtocol\"};if(d(\"decodeProtobuf\").getUnknownFields(e)!=null)return{version:\"v3\",type:\"error\",error:\"messageApplication subProtocol has unknown fields\",futureProof:e.futureProof};e=[];b=(b=a.payload)==null?void 0:(b=b.subProtocol)==null?void 0:b.consumerMessage;c=(c=a.payload)==null?void 0:(c=c.subProtocol)==null?void 0:c.armadillo;a=(a=a.payload)==null?void 0:(a=a.subProtocol)==null?void 0:a.multiDevice;if(b!=null){if(b.payload==null)return{version:\"v3\",type:\"error\",error:\"subprotocol of type consumerMessage has no payload\"};e.push({payload:new Uint8Array(b.payload),type:\"success\",subprotocolType:\"consumerMessage\"})}if(c!=null){if(c.payload==null)return{version:\"v3\",type:\"error\",error:\"subprotocol of type armadillo has no payload\"};e.push({payload:new Uint8Array(c.payload),type:\"success\",subprotocolType:\"armadillo\"})}if(a!=null){if(a.payload==null)return{version:\"v3\",type:\"error\",error:\"subprotocol of type multiDevice has no payload\"};e.push({payload:new Uint8Array(a.payload),type:\"success\",subprotocolType:\"multiDevice\"})}return e.length!==1?{version:\"v3\",type:\"error\",error:\"Wrong number of subprotocols: \"+e.length}:e[0]}g.parseMessageApplication=a}),98);\n__d(\"MAWParseXMAProtocol\",[\"MAWGlobals\",\"MAWMsgType\",\"MAWParseSubprotocolVersionConsts\",\"WAArmadilloXMA.pb\",\"WAHex\",\"WALogger\",\"WAMedia\",\"WAMsgApplication.pb\",\"WAParseConsumerMessageProtocol\",\"WAParseMediaTransportProtocol\",\"WAParseMessageApplication\",\"WAParseProtocolUtils\",\"WAStanzaUtils\",\"WATimeUtils\",\"decodeProtobuf\",\"err\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Invalid message text during XMA restore\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Invalid url prefix during XMA restore\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Invalid url for action url during XMA restore\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Invalid url for native url during XMA restore\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"ExternalId: \",\" textId: \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\\n      received previews version is older than expected \",\". \"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\\n    received favicon version is older than expected \",\". \"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\\n    received headerImage version is older than expected \",\". \"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\\n      received associatedMessage version is older than expected \",\" as expected. \"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[XMA] received associated message with incorrect version \",\"\"]);q=function(){return a};return a}function r(a,b){return a==null||a.payload==null?void 0:d(\"WAParseMediaTransportProtocol\").decodeImageTransport(a.payload,b)}function aa(a,b,e,f,g){if(b==null||b.payload==null)return null;b.version!==d(\"MAWParseSubprotocolVersionConsts\").ASSOCIATED_MESSAGE_SUBPROTOCOL_VERSION&&d(\"WALogger\").ERROR(q(),b.version);b=d(\"decodeProtobuf\").decodeProtobufWithUnknowns(d(\"WAMsgApplication.pb\").MessageApplicationSpec,b.payload);b=d(\"WAParseMessageApplication\").parseMessageApplication(b);if(b.type===\"error\")throw c(\"err\")(\"XMA contains unparseable message application.\");b=b;if(b.subprotocolType!==\"consumerMessage\")throw c(\"err\")(\"XMA contains incorrect message application type: \"+b.subprotocolType);return d(\"WAParseConsumerMessageProtocol\").parseConsumerMessageProtocol(a,b.payload,e,f,g)}var s=\"https:\/\/www.instagram.com\/stories\/\",t=\"https:\/\/www.instagram.com\/reel\/\",u=\"https:\/\/www.instagram.com\/tv\/\",v=\"https:\/\/www.instagram.com\/_n\/profile_shop?\",w=\"https:\/\/www.instagram.com\/\",x=\"https:\/\/www.alpha.facebook.com\/share\/\",y=\"https:\/\/m.facebook.com\/share\/\",z=\"https:\/\/www.facebook.com\/share\/\",A=\"https:\/\/m.alpha.facebook.com\/share\/\",B=\"https:\/\/facebook.com\/share\/\",C=\"https:\/\/www.alpha.facebook.com\/stories\/\",D=\"https:\/\/www.facebook.com\/stories\/\",E=\"https:\/\/fb.gg\/\",F=\"https:\/\/www.facebook.com\/\",G=\"https:\/\/m.facebook.com\/\",H=\"https:\/\/www.alpha.facebook.com\/\",I=\"https:\/\/m.alpha.facebook.com\/\",J=\"https:\/\/facebook.com\/\",K=\"https:\/\/fb.watch\/\",L=\"https:\/\/www.facebook.com\/l.php\",M=\"https:\/\/m.facebook.com\/l.php\",N=\"https:\/\/www.alpha.facebook.com\/l.php\",O=\"https:\/\/m.alpha.facebook.com\/l.php\",P=\"https:\/\/facebook.com\/l.php\",Q=\"https:\/\/l.facebook.com\/l.php\",R=\"https:\/\/facebook.com\/events\/\",ba=\"https:\/\/www.facebook.com\/events\/\",ca=\"https:\/\/www.alpha.facebook.com\/events\/\",da=\"https:\/\/m.facebook.com\/events\/\",ea=\"https:\/\/m.alpha.facebook.com\/events\/\",S=\"fb-messenger:\/\/payments\/receipt?product_id=\",T=\"messenger:\/\/location_share\",fa=\"http:\/\/m.me\/\",ga=\":\",U=\"http:\/\/\",ha=\"https:\/\/\";function a(a){var b=a.chat,e=a.content,f=a.meta,g=a.metadata;a=a.protobuf;e=e.extendedContentMessage;if(e==null)throw c(\"err\")(\"extendedContentMessage has no content\");if(!V(e))throw c(\"err\")(\"extendedContentMessage does not have URL content\");var h=e.targetType;if(h==null||!d(\"MAWGlobals\").getConfig().supportedXMATargetTypes().has(h))return{contentTypeForLogging:\"extendedContentMessage\",unstoredMedia:null,unstoredMsg:{ack:f.ack,id:f.id,msgContent:{protobuf:d(\"WAHex\").bytesToBuffer(a),subtype:ia(h)},reportingMeta:f.reportingMeta,sentTs:f.sentTs,serverTs:f.serverTs,ts:f.ts,type:d(\"MAWMsgType\").MSG_TYPE.FUTUREPROOF},unstoredQuotedMedia:null,unstoredXMA:null,xmaTargetTypeForLogging:h};var i=d(\"WAParseProtocolUtils\").parseEphemerality(f,g),j=i.deleteTs,k=i.ephemeralSetting;i=i.expirationTs;var q=d(\"WAParseProtocolUtils\").enhanceReportingMeta(f,g),s=e.associatedMessage,t=e.contentRef,u=e.ctas,v=e.favicon,w=e.headerImage,x=e.headerTitle,y=e.maxSubtitleNumOfLines,z=e.maxTitleNumOfLines,A=e.messageText,B=e.overlayDescription,C=e.overlayIconGlyph,D=e.overlayTitle,E=e.previews,F=e.sentWithMessageId,G=e.subtitleText,H=e.targetId,I=e.targetUsername,J=e.titleText,K=e.xmaLayoutType;s!=null&&(s.version==null||s.version<d(\"MAWParseSubprotocolVersionConsts\").ASSOCIATED_MESSAGE_SUBPROTOCOL_VERSION)&&d(\"WALogger\").WARN(p(),d(\"MAWParseSubprotocolVersionConsts\").ASSOCIATED_MESSAGE_SUBPROTOCOL_VERSION);w!=null&&(w.version==null||w.version<d(\"MAWParseSubprotocolVersionConsts\").XMA_HEADER_SUBPROTOCOL_VERSION)&&d(\"WALogger\").WARN(o(),d(\"MAWParseSubprotocolVersionConsts\").XMA_HEADER_SUBPROTOCOL_VERSION);v!=null&&(v.version==null||v.version<d(\"MAWParseSubprotocolVersionConsts\").XMA_FAVICON_SUBPROTOCOL_VERSION)&&d(\"WALogger\").WARN(n(),d(\"MAWParseSubprotocolVersionConsts\").XMA_FAVICON_SUBPROTOCOL_VERSION);E.every(function(a){(a.version==null||a.version<d(\"MAWParseSubprotocolVersionConsts\").XMA_PREVIEW_SUBPROTOCOL_VERSION)&&d(\"WALogger\").WARN(m(),d(\"MAWParseSubprotocolVersionConsts\").XMA_PREVIEW_SUBPROTOCOL_VERSION)});e=e.targetExpiringAtSec!=null?d(\"WATimeUtils\").castLongIntToUnixTime(e.targetExpiringAtSec):void 0;var L=s!=null&&F!=null?[d(\"WAStanzaUtils\").toStanzaId(F),f.id.externalId]:[f.id.externalId,void 0],M=L[0];L=L[1];var N=[];if(E!=null)for(var O=0;O<E.length;O++){var P,Q=r(E[O],f.ts);Q!=null&&!((h===d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE||h===d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE)&&Q.mediaType===d(\"WAMedia\").MEDIA_TYPE.IMAGE&&((P=Q.validatedImageInfo)==null?void 0:P.height)===1&&((P=Q.validatedImageInfo)==null?void 0:P.width)===1)&&N.push(Q)}P=r(w,f.ts);Q=r(v,f.ts);O=babelHelpers[\"extends\"]({deleteTs:j,ephemeralSetting:k,expirationTs:i,id:babelHelpers[\"extends\"]({},f.id,{externalId:M}),reportingMeta:q,type:d(\"MAWMsgType\").MSG_TYPE.XMA},f);E=u.map(function(a){a.actionContentBlob;a=babelHelpers.objectWithoutPropertiesLoose(a,[\"actionContentBlob\"]);return a});w=E.slice(1);h===d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE&&u.length===1&&(w=E);k={author:f.id.author,contentRef:t,ctas:w,defaultCTA:E[0],externalId:M,faviconMediaId:(v=Q==null?void 0:Q.plaintextHash)!=null?v:void 0,headerMediaId:(j=P==null?void 0:P.plaintextHash)!=null?j:void 0,headerTitle:x,isTombstoned:e!=null?d(\"WATimeUtils\").unixTime()>e:!1,maxSubtitleNumOfLines:y,maxTitleNumOfLines:z,overlayDescription:B,overlayIconGlyph:C,overlayTitle:D,previewMediaIds:N.length>0?N.map(function(a){return a.plaintextHash}):void 0,sentWithMessage:A,subtitleText:G,targetExpiringAtSec:e,targetId:H,targetType:h,targetUsername:I,threadJid:b,titleText:J,xmaLayoutType:K};var R;if(s!=null&&F==null)throw c(\"err\")(\"XMA associatedMessage cannot be received without sentWithMessageId field\");s!=null&&L!=null&&(R=aa(b,s,f,a,g));if(((i=R)==null?void 0:i.unstoredMedia)!=null)throw c(\"err\")(\"XMA associated msg cannot have additioinal dbMedia\");t=(u=(q=R)==null?void 0:q.unstoredMsg)!=null?u:null;if(t!=null&&t.type!==\"Text\")throw c(\"err\")('XMA associated msg cannot have type different from \"Text\". Received type: '+t.type);L!=null&&t!=null&&(d(\"WALogger\").DEV(l(),M,L),t.id=babelHelpers[\"extends\"]({},t.id,{externalId:L}),O.id=babelHelpers[\"extends\"]({},t.id,{externalId:M}),k.externalId=M);return{contentTypeForLogging:\"extendedContentMessage\",unstoredMedia:null,unstoredMsg:O,unstoredQuotedMedia:null,unstoredXMA:{unstoredAssociatedMsg:t!=null?t:void 0,unstoredFavicon:Q,unstoredHeaderMedia:P,unstoredPreviews:N.length>0?N:void 0,xma:k},xmaTargetTypeForLogging:h}}function V(a){var b=a.ctas,d=a.targetType;if(d==null)throw c(\"err\")(\"extendedContentMessage does not have a targetType\");var e=!0;b.forEach(function(a){a.actionContentBlob;a=babelHelpers.objectWithoutPropertiesLoose(a,[\"actionContentBlob\"]);e=e&&W(a,d)});return e}function W(a,b,c){var e=a.nativeUrl;a=a.actionUrl;if(!X(e,b,c)){c!=null&&c&&d(\"WALogger\").ERROR(k());return!1}if(!X(a,b,c)){c!=null&&c&&d(\"WALogger\").ERROR(j());return!1}return!0}function ia(a){if(!c(\"gkx\")(\"1564\"))return null;switch(a){case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING_V2:return\"locationMessage\";default:return null}}function X(a,b,c){if(a==null)return!0;if(ka(a,b)===!1){c!=null&&c&&d(\"WALogger\").ERROR(i());return!1}if(!la(a)){c!=null&&c&&d(\"WALogger\").ERROR(h());return!1}return!0}function Y(a){return a.startsWith(x)||a.startsWith(y)||a.startsWith(z)||a.startsWith(A)||a.startsWith(B)}function ja(a){return a.startsWith(L)||a.startsWith(M)||a.startsWith(N)||a.startsWith(O)||a.startsWith(P)||a.startsWith(Q)}function Z(a){return a.startsWith(F)||a.startsWith(G)||a.startsWith(H)||a.startsWith(I)||a.startsWith(J)}function $(a){return a.startsWith(R)||a.startsWith(ba)||a.startsWith(ca)||a.startsWith(da)||a.startsWith(ea)}function ka(a,b){if(a==null)return!0;switch(b){case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_HIGHLIGHT_REPLY:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_HIGHLIGHT_REACTION:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_MENTION:return a.startsWith(s);case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:return a.startsWith(t);case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_IGTV_SHARE:return a.startsWith(u);case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SHOP_SHARE:return a.startsWith(v);case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_PROFILE_SHARE:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_IG_MEDIA_SHARE:return a.startsWith(w);case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION:return a.startsWith(D)||a.startsWith(C)||Y(a);case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE:return a.startsWith(E);case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_POST_PRIVATE_REPLY:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_SHORT:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_VIDEO_SHARE:return(Z(a)||a.startsWith(K))&&!ja(a);case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING_V2:return a.startsWith(T);case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_LOCAL_EVENT_REPLY:return $(a);case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_EVENT:return $(a)||Y(a);case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_CONTACT:return Z(a)||a.startsWith(fa);case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_EXTERNAL_LINK:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_GROUP_AUDIO_CALL:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_GROUP_VIDEO_CALL:if(a.includes(ga)&&(!a.startsWith(U)&&!a.startsWith(ha)))return!1;break;case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_RECEIVER_FETCH:case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.DATACLASS_SENDER_COPY:return!0;case d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_P2P_PAYMENT:return a.startsWith(S)}return!0}function la(a){for(var b=0;b<a.length;b++){var c=a.charAt(b);switch(c){case\"\\u202c\":case\"\\u202d\":case\"\\u202e\":return!1;default:break}}return!0}g.kIGStoryCtaPrefix=s;g.kIGClipsCtaPrefix=t;g.kIGTVCtaPrefix=u;g.kIGShopCtaPrefix=v;g.kIGDefaultCtaPrefix=w;g.kFBStoryCtaPrefix=D;g.kFBGamingCustomUpdateCtaPrefix=E;g.kFBDefaultWWWCtaPrefix=F;g.kFBEventCtaPrefix=R;g.kMSGP2PPaymentUrlPrefix=S;g.kMessengerLocationSharePrefix=T;g.kHttpPrefix=U;g.parseXMAProtocol=a;g.isXMAContentValid=V;g.isValidCTA=W}),98);\n__d(\"MAWHandleEchoXMARestoreV2\",[\"EchoMessage\",\"LSDataTraceCheckPoint\",\"LSIntEnum\",\"MAWBridge\",\"MAWBridgeXMA\",\"MAWConvertXMAGatingTypeToExtendedContentOverlayIconGlyph\",\"MAWConvertXMALayoutTypeToExtendedContentXMLLayoutType\",\"MAWConvertXMATargetTypeToExtendedContentTargetType\",\"MAWDbMediaTxns\",\"MAWDbMsg\",\"MAWIndexedDb\",\"MAWParseXMAProtocol\",\"MAWTraceUtils\",\"MAWTransactionMode\",\"Promise\",\"WAArmadilloXMA.pb\",\"WALogger\",\"WAMediaUtils\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] invalid CTA observed while restoring XMA. Echo message origin \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] threadJid field is not present in the restoredMsg. Echo message origin \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] xmaLayoutType field is not present in the echo doc. Echo message origin \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] xmaGatingType field is not present in the echo doc. Echo message origin \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] xmaTargetType field is not present in the echo doc. Echo message origin \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] xmaDefaultCTA field is not present in the echo doc. Echo message origin \",\"\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] xmaData is missing in the echo doc. Echo message origin \",\"\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] dbXMA is null. EchoMessage origin \",\"\"]);q=function(){return a};return a}a=function(a,e,f,g){f==null?void 0:f.addPoint(\"xma_restore_start\");d(\"MAWTraceUtils\").recordCheckpointForTrace(g,(i||(i=d(\"LSIntEnum\"))).ofNumber(c(\"LSDataTraceCheckPoint\").LABYRINTH_WEB_XMA_RESTORE_STARTED),[],!1);var j=a.restoredMsgsData;if(j){var k=j.newlyAddedMsgs;k=k.concat(j.existingMsgs);var l=[];k.map(function(b){var c=b.externalId;c=a.echoMsgMap.get(c);c!=null&&(c.contentType===d(\"EchoMessage\").EchoMessageContentType.XMA&&l.push(b))});return l.length===0?(h||(h=b(\"Promise\"))).resolve():r(l,a.echoMsgMap,e,g).then(function(a){f==null?void 0:f.addPoint(\"xma_restore_end\",{\"int\":{xma:a.length}});d(\"MAWTraceUtils\").recordCheckpointForTrace(g,(i||(i=d(\"LSIntEnum\"))).ofNumber(c(\"LSDataTraceCheckPoint\").LABYRINTH_WEB_XMA_RESTORE_ENDED),[],!1);return(h||(h=b(\"Promise\"))).resolve()})}f==null?void 0:f.addPoint(\"xma_restore_end\",{\"int\":{xma:0}});return(h||(h=b(\"Promise\"))).resolve()};function r(a,b,e,f){var g=new Map(a.map(function(a){var c=b.get(a.externalId);c=c==null?void 0:(c=c.mediaData)==null?void 0:c.attachmentObjectId;if(c!=null)return[d(\"WAMediaUtils\").stringToDeliveryObjectId(c),a]}).filter(Boolean)),h=Array.from(g.keys()),j=new Map();return s(h).then(function(k){var l=[];h.forEach(function(a){var b;b=(b=g.get(a))==null?void 0:b.externalId;b!=null&&j.set(b,a)});a.filter(function(a){return d(\"MAWDbMsg\").isXMAMsg(a)}).forEach(function(a){var e=b.get(a.externalId);if(e){var g=j.get(a.externalId),h;if(g!=null){g=k.get(g);g!=null&&(h=g.mediaId)}g=e.serializationOrigin;g==null&&(g=d(\"EchoMessage\").EchoSerializationOriginType.UNKNOWN);a=u(a,e,h,g);a==null?(d(\"WALogger\").ERROR(q(),g),d(\"MAWTraceUtils\").recordCheckpointForTrace(f,(i||(i=d(\"LSIntEnum\"))).ofNumber(c(\"LSDataTraceCheckPoint\").LABYRINTH_WEB_XMA_RESTORE_DBXMA_NULL),[],!1)):l.push(a)}});return t(l).then(function(a){if(a.length>0){a.map(function(a){var b=j.get(a.externalId);if(e!=null){var c;b!=null&&(c=k.get(b));d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"uiUpdate\",{events:[{tag:\"NewXMA\",value:d(\"MAWBridgeXMA\").createBridgeXMA(e,c,a)}]})}});return a}return a})})}var s=d(\"MAWIndexedDb\").makeMsgrTransactor({media:d(\"MAWTransactionMode\").READONLY,mediaBackup:d(\"MAWTransactionMode\").READONLY},\"restoreGetMediaForXMAByObjectIds\",function(a){return function(b){return d(\"MAWDbMediaTxns\").maybeGetMediaBackupRowsFromObjectIds(a,b).then(function(b){var c=Array.from(b.values()).map(function(a){return a.mediaId});return a.media.bulkGet(c).then(function(a){var c=new Map();a!=null&&a.forEach(function(a){a!=null&&c.set(a.mediaId,a)});var d=new Map();b.forEach(function(a,b){a=c.get(a.mediaId);a!=null&&d.set(b,a)});return d})})}}),t=d(\"MAWIndexedDb\").makeMsgrTransactor({xma:d(\"MAWTransactionMode\").READWRITE},\"restoreWriteXMAsToDb\",function(a){return function(b){return a.xma.bulkAdd(b,{allKeys:!0}).then(function(a){return a.map(function(a,c){return babelHelpers[\"extends\"]({},b[c],{xmaId:a})})})}});function u(a,b,c,e){var f;if(b.xmaData==null){d(\"WALogger\").ERROR(p(),e);return null}var g;if(b.xmaData.xmaDefaultCTA!=null){var h;g=v((h=b.xmaData)==null?void 0:h.xmaDefaultCTA)}else d(\"WALogger\").WARN(o(),e);if(((h=b.xmaData)==null?void 0:h.xmaTargetType)!=null)h=d(\"MAWConvertXMATargetTypeToExtendedContentTargetType\").convertXMATargetTypeToExtendedContentTargetType(b.xmaData.xmaTargetType);else{d(\"WALogger\").ERROR(n(),e);return null}var i;((f=b.xmaData)==null?void 0:f.xmaGatingType)!=null?i=d(\"MAWConvertXMAGatingTypeToExtendedContentOverlayIconGlyph\").convertXMAGatingTypeToExtendedContentOverlayIconGlyph(b.xmaData.xmaGatingType):d(\"WALogger\").WARN(m(),e);var q;((f=b.xmaData)==null?void 0:f.xmaLayoutType)!=null?q=d(\"MAWConvertXMALayoutTypeToExtendedContentXMLLayoutType\").convertXMALayoutTypeToExtendedContentXMLLayoutType(b.xmaData.xmaLayoutType):d(\"WALogger\").WARN(l(),e);if(a.threadJid!=null)f=a.threadJid;else{d(\"WALogger\").ERROR(k(),e);return null}if(g!=null&&!d(\"MAWParseXMAProtocol\").isValidCTA(g,h,!0)){d(\"WALogger\").ERROR(j(),e);return null}var r;((e=b.xmaData)==null?void 0:e.xmaContentRef)!=null&&(r=b.xmaData.xmaContentRef);return{author:a.author,contentRef:r,ctas:[],defaultCTA:g,defaultPreviewMediaId:(e=c)!=null?e:void 0,externalId:a.externalId,headerTitle:b==null?void 0:(e=b.xmaData)==null?void 0:e.xmaHeaderTitle,isTombstoned:b==null?void 0:(e=b.xmaData)==null?void 0:e.xmaIsTombstoned,maxSubtitleNumOfLines:b==null?void 0:(e=b.xmaData)==null?void 0:e.xmaMaxSubtitleNumLines,maxTitleNumOfLines:b==null?void 0:(e=b.xmaData)==null?void 0:e.xmaMaxTitleNumLines,msgId:a.msgId,overlayIconGlyph:i,overlayTitle:b==null?void 0:(e=b.xmaData)==null?void 0:e.xmaHeaderSubtitle,previewMediaIds:c!=null?[c]:[],subtitleText:b==null?void 0:(a=b.xmaData)==null?void 0:a.xmaSubtitleText,targetExpiringAtSec:((e=b.xmaData)==null?void 0:e.xmaTargetExpiry)!=null?d(\"WATimeUtils\").castToUnixTime(Number((c=b.xmaData)==null?void 0:c.xmaTargetExpiry)):void 0,targetId:b==null?void 0:(a=b.xmaData)==null?void 0:a.xmaTargetId,targetType:h,targetUsername:b==null?void 0:(e=b.xmaData)==null?void 0:e.xmaTargetUsername,threadJid:f,titleText:(c=b.xmaData)==null?void 0:c.xmaTitleText,xmaLayoutType:q}}function v(a){return{actionUrl:a,buttonType:d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:a}}g.writeXMAToXMAStore=a}),98);\n__d(\"MAWHandlePointRestoredMsgV2\",[\"MAWEBUploadTrackingUtils\",\"MAWEncryptedBackupCacheManager\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"MAWUploadMessagesBackup\",\"Promise\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Completed handling of point restored message\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Completed handling of point restored message\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Started handling of point restored message\"]);k=function(){return a};return a}function a(a){d(\"WALogger\").LOG(k());a=a.restoredMsgsData;if(a){var c=a.existingMsgs;a=a.newlyAddedMsgs;a=a.concat(c);var e=[],f=new Map(),g=[],l=new Map();a.filter(function(a){return d(\"MAWEncryptedBackupCacheManager\").checkForMsgEntryInReuploadCache(a.thread,a.externalId)}).forEach(function(a){e.push(a);g.push(a.externalId);var b=d(\"MAWEBUploadTrackingUtils\").genInstanceKeyOnly();l.set(a.externalId,b);d(\"MAWEBUploadTrackingUtils\").startUploadTracking(a.externalId,a.type,\"pointrestore\",b)});c=m(g);return c.then(function(a){a.forEach(function(a){var b=a.quoteExternalId;b!=null&&f.set(b,a)});return e.length>0?d(\"MAWUploadMessagesBackup\").uploadUniqueMessage(e,f,void 0,void 0,l).then(function(a){e.forEach(function(a){d(\"MAWEncryptedBackupCacheManager\").removeMsgEntryFromReuploadCache(a.thread,a.externalId)})}):(h||(h=b(\"Promise\"))).resolve()}).then(function(a){d(\"WALogger\").LOG(j())})}d(\"WALogger\").LOG(i());return(h||(h=b(\"Promise\"))).resolve()}function l(a,b){return a.messages.where(\"quoteExternalId\").anyOf(b).toArray()}var m=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"maybeBatchGetMsgsByQuoteExternalId\",function(a){return function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];return l.apply(void 0,[a].concat(c))}});g.uploadPointRestoredMessageIfRequired=a}),98);\n__d(\"MAWDbDyiBatch\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a){return a}f.numberToBatchId=a}),66);\n__d(\"MAWDyiBatchRestoreDataSync\",[\"MAWDataSyncQueue\",\"MAWDbDyiBatch\",\"MAWDexieTable\",\"MAWEBBackendQPLUtils\",\"MAWIndexedDb\",\"MAWQplProxy\",\"MAWTransactionMode\",\"Promise\",\"WALogger\",\"gkx\",\"justknobx\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] User is not eligible to use DYI\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] No message batch entry corresponding to batch id \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Expecting one dyi batch entry with non-null numThreadsRestored entry to track DYI progress. Stopping DYI\"]);k=function(){return a};return a}var l=c(\"justknobx\")._(\"1485\");function m(a,b,c,e){b={tag:\"RestoreMessageBatch\",value:{newerNumMessages:0,numMessages:l,oldestTs:b,qplInstanceKeyE2E:e,qplInstanceKeyForThread:c,threadJid:a}};d(\"MAWIndexedDb\").afterTransaction(b)}function n(a,b){return a.dyiBatch.count().then(function(c){if(c===1)return a.dyiBatch.clear().then(function(){d(\"MAWIndexedDb\").afterTransaction({tag:\"UpdateDyiStatus\",value:{qplInstanceKeyE2E:b,status:!0}})})})}function o(a,b,e){if(b.length>0){var f=new Set(b);return a.dyiBatch.filter(function(a){return a.threadId!=null&&f.has(a.threadId)}).toArray().then(function(a){a.forEach(function(a){a.threadId!=null&&a.qplInstanceKeyForThread!=null&&d(\"MAWEBBackendQPLUtils\").endSuccessDYIBackupRestoreQplUserFlow(a.qplInstanceKeyForThread,a.threadId)});return a}).then(function(b){var f=b.filter(function(a){return a.isThread}).length;return a.dyiBatch.bulkDelete(b.filter(Boolean).map(function(a){return a.batchId})).then(function(){return a.dyiBatch.filter(function(a){return a.threadId==null&&a.numThreadsRestored!=null}).toArray().then(function(b){if(b.length!==1){d(\"WALogger\").ERROR(k());e!=null&&d(\"MAWQplProxy\").sendQPLFailThroughBridge(c(\"qpl\")._(521478596,\"1329\"),\"dyi_backup_restore_error\",void 0,e);return p(a,void 0,e)}b=b[0];if(e!=null&&b.numThreadsRestored!=null){var g=b.numThreadsRestored+f;return a.dyiBatch.update(b.batchId,{numThreadsRestored:g}).then(function(){d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(521478596,\"1329\"),\"dyi_backup_restore_update\",{annotations:{\"int\":{numThreadsRestored:g}},instanceKey:e});return n(a,e)})}else return n(a,e)})})})}return d(\"MAWDexieTable\").dexieResolve()}function p(a,b,c){b!=null&&b.forEach(function(a){d(\"WALogger\").ERROR(j(),a)});d(\"MAWIndexedDb\").afterTransaction({tag:\"UpdateDyiStatus\",value:{qplInstanceKeyE2E:c,status:!1}});return d(\"MAWEBBackendQPLUtils\").cleanupDYIBackupRestoreQplUserFlow(a).then(function(b){return a.dyiBatch.clear()})}var q=d(\"MAWIndexedDb\").makeMsgrTransactor({dyiBatch:d(\"MAWTransactionMode\").READWRITE},\"processNextDyiBatchEntry\",function(a){return function(b){var c=[];b.forEach(function(a){if(a.type===\"put\"||a.type===\"add\"){a=a.value.key;if(typeof a===\"number\"){a=a;c.push(d(\"MAWDbDyiBatch\").numberToBatchId(a))}}});return a.dyiBatch.count().then(function(b){if(b>0)return a.dyiBatch.bulkGet(c).then(function(b){var e,f=new Map(),g=[];c.map(function(a,c){b[c]!=null&&!b[c].isThread?f.set(a,b[c]):b[c]==null&&g.push(a)});e=(e=b.find(function(a){if((a==null?void 0:a.qplInstanceKeyE2E)!=null)return!0}))==null?void 0:e.qplInstanceKeyE2E;if(g.length>0)p(a,g,e);else{var h=[],i=[];f.forEach(function(a,b){b=a.threadId;a.numMessages<l&&b!=null?(d(\"MAWEBBackendQPLUtils\").addPointDYIBackupRestoreQplUserFlow(!0,a),h.push(b)):(d(\"MAWEBBackendQPLUtils\").addPointDYIBackupRestoreQplUserFlow(!1,a),i.push(a))});i.forEach(function(a){a.threadId!=null&&m(a.threadId,a.oldestTs)});return o(a,h,e)}})})}}),r=function(a){a=a.filter(function(a){return a.value.tableName===\"dyiBatch\"&&a.type!==\"delete\"&&a.type!==\"deleteRange\"});return a.length>0?q(a).then(function(a){return(h||(h=b(\"Promise\"))).resolve()}):(h||(h=b(\"Promise\"))).resolve()};a=function(){if(!c(\"gkx\")(\"23911\")){d(\"WALogger\").WARN(i());return}d(\"MAWDataSyncQueue\").registerDataSyncCallback(r)};g.DYI_BATCH_SIZE=l;g.restoreMessagesForThread=m;g.initDyiBatchUpload=a}),98);\n__d(\"MAWRestoreMsgsUiUpdator\",[\"MAWBridgeEventTransmitter\",\"MAWDbMsg\",\"MAWDbThread\",\"MAWDexieTable\",\"MAWFolderTypes\",\"MAWRestoreRewriteUtils\",\"MAWThreadSnippetBuildTxns\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,c,e,f,g,j,l,m,n,o,p){c=h(a,g,c,e,f,l,m);return c.then(function(c){if(g.oldestMsg==null||j){var e=k(c);e&&d(\"MAWBridgeEventTransmitter\").updateThreadOutsideTxn(c.cannotReplyReason,d(\"MAWFolderTypes\").FOLDER_ID.INBOX,c.chatId,c.jid);return i(a,b,c,n,o,p).then(function(){return c})}return c}).then(function(b){return d(\"MAWThreadSnippetBuildTxns\").refreshThreadSnippet(a,b)}).then(function(){})}function h(a,b,c,e,f,g,h){var i=babelHelpers[\"extends\"]({},b,{lastReadMsg:g,lastReadMsgTs:f,newestMsg:c,newestMsgTs:e,oldestMsg:h,threadOrder:d(\"MAWDbThread\").craftThreadOrder(e,b.jid)});return a.threads.put(i).then(function(){return i})}function i(a,b,c,e,f,g){var h=b.map(function(a){return a}).reverse(),i=c.chatId,k=c.jid;if(e!=null){e=d(\"MAWDbMsg\").toMsgId(e);if(e!=null)return a.messages.get({msgId:e}).then(function(e){if(e!=null){e=e.sortOrderMs;var l;d(\"MAWRestoreRewriteUtils\").isOneDBEnabled()?l=d(\"MAWDexieTable\").dexieResolve(0):l=a.messages.where([\"threadJid\",\"sortOrderMs\"]).between([k,h[0].sortOrderMs],[k,e],!1,!1).count();return l.then(function(a){a===0&&(j(h,f,c),d(\"MAWBridgeEventTransmitter\").issueMsgLoadedEventAfterTxn(i,c.jid,h,c.oldestMsg===null,g,!1));return{chatId:i,restoredMessages:b}})}return{chatId:i,restoredMessages:b}})}d(\"MAWBridgeEventTransmitter\").issueMsgLoadedEventAfterTxn(i,c.jid,h,c.oldestMsg===null,g,!1);return d(\"MAWDexieTable\").dexieResolve({chatId:i,restoredMessages:b})}function j(a,b,c){var e=b==null?void 0:b.sortOrderMs,f=a[a.length-1],g=f.sortOrderMs;b!=null&&f!=null&&e!=null&&g!=null&&e<g&&(a.push(b),d(\"MAWBridgeEventTransmitter\").deleteMessageRangesV2AfterTxn(b.msgId,d(\"MAWDbMsg\").getSortOrderWithFallback(b),c.chatId,c.jid))}function k(a){return a.archived===!0&&a.cannotReplyReason!==\"viewer_not_subscribed\"}g.updateThreadAndMessages=a;g.shouldThreadBeUnarchived=k}),98);\n__d(\"MAWRestoreMsgsTxns\",[\"ArmadilloDataTraceType\",\"FBLogger\",\"LSMEBTaskCreationSource\",\"MAWBridgeEventTransmitter\",\"MAWBridgeTypesCreators\",\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWDyiBatchRestoreDataSync\",\"MAWEBBackendQPLUtils\",\"MAWIndexedDb\",\"MAWLocalizationType\",\"MAWMsgType\",\"MAWQplProxy\",\"MAWRestoreMsgsUiUpdator\",\"MAWTimeUtils\",\"MAWTransactionMode\",\"WAHashStringToNumber\",\"WAJids\",\"WALogger\",\"WATimeUtils\",\"gkx\",\"qex\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Failed to create restored messages and update thread metadata \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Thread with id \",\" does not exist for restore\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"DYI attempting to re-restore previous batch - halting DYI for thread \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] DYI for thread with jid \",\" is not currently in progress\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"error occurred on restore - stopping DYI for thread with chat jid \",\"\"]);l=function(){return a};return a}function m(a,b,c){return c!=null?a.messages.where([\"threadJid\",\"sortOrderMs\"]).between([b.jid,c.ts],[b.jid,d(\"MAWDbMsg\").MAX_MSG_SORT_ORDER],!1,!0).limit(1).first():d(\"MAWDexieTable\").dexieResolve()}function a(a,b,c){return d(\"MAWDbMsgTxns\").maybeGetMsg(a,c).then(function(c){if(c!=null)return a.messages.where([\"threadJid\",\"sortOrderMs\"]).between([b.jid,c.sortOrderMs],[b.jid,d(\"MAWDbMsg\").MAX_MSG_SORT_ORDER],!1,!0).limit(1).first();else return d(\"MAWDexieTable\").dexieResolve()})}function n(a){return a!=null&&a.type===d(\"MAWMsgType\").MSG_TYPE.ADMIN&&(a.msgContent.adminType===d(\"MAWLocalizationType\").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION||a.msgContent.adminType===d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE||a.msgContent.adminType===d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CUTOVER_IGD_THREAD_ADMIN_MESSAGE||a.msgContent.adminType===d(\"MAWLocalizationType\").LOCALIZATION_TYPE.DUAL_THREAD_CUTOVER_ADMIN_MESSAGE)}var o=(e=d(\"MAWIndexedDb\")).makeMsgrTransactor({messages:(f=d(\"MAWTransactionMode\")).READONLY},\"checkForDecryptionFailuresToPointRestore\",function(a){return function(){return a.messages.filter(function(a){return a.type===d(\"MAWMsgType\").MSG_TYPE.UNAVAILABLE||a.type===d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT}).toArray().then(function(a){a.forEach(function(a){a.threadJid!=null&&d(\"MAWBridgeEventTransmitter\").issuePointQueryOutsideTxn(a.externalId,d(\"WAJids\").threadIdForChatJid(a.threadJid),void 0,c(\"LSMEBTaskCreationSource\").EB_POINT_QUERY_RETRY_DECRYPTION_FAILURES,a.threadJid)})})}});function p(a,b){a=Number(a);for(var e=0;e<b.length;e++){var f=b[e];c(\"FBLogger\")(\"labyrinth_web\").info(\"completed point restore of an unavailable msg with instanceKey: %s\",a);d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(1056840931,\"814\"),\"eb_point_restore_end\",{annotations:{\"int\":{msgId:d(\"WAHashStringToNumber\").hashStringToNumber(f.externalId)},string:{jid:f.threadJid}},instanceKey:a});d(\"MAWQplProxy\").sendQPLSuccessThroughBridge(c(\"qpl\")._(1056840931,\"814\"),{\"int\":{msgId:d(\"WAHashStringToNumber\").hashStringToNumber(f.externalId)}},a)}}function q(a,b,c,e,f,g,h,i,j){var k=g.isOldestMsgUpdated,l=g.lastReadMsg,m=g.lastReadMsgTs,n=g.newestMsgId,o=g.newestMsgTs,p=g.oldestMsgId,q=!0;return d(\"MAWDbMsgTxns\").getThreadNewestMessageIdBySortOrder(a,c).then(function(g){b&&(g!=null&&(q=s(g,e)));g=d(\"MAWDexieTable\").dexieResolve();q&&(f.length>0&&(g=d(\"MAWRestoreMsgsUiUpdator\").updateThreadAndMessages(a,f,n,o,m,c,k,l,p,h,i,j)));return g.then(function(){return E(a,e,c)})})}function b(a){var b=a.existingMsgs,e=a.hasMoreBefore,f=a.instanceKey,g=a.isPointRestore,h=a.maybeNewestMsg,i=a.maybeOldestAdminMsg,j=a.maybeOldestMsg,k=a.minMsgId,l=a.newMsgs,m=a.optimisticMsgs,n=a.taskSource,o=a.thread,q=a.traceId,r=n===c(\"LSMEBTaskCreationSource\").EB_POINT_QUERY_RETRY_DECRYPTION_FAILURES,s=new Map(),t=[];b.map(function(a){a.type===d(\"MAWMsgType\").MSG_TYPE.UNAVAILABLE||a.type===d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT?t.push(a):s.set(a.externalId,a)});a=[];return H(l,b,o.chatId,s,h,g,i,j,a,m,f,e,k,r,t).then(function(a){r&&p(q,t);return a})}function r(a,b,c,e){a.altIndex!==d(\"MAWDbMsg\").SPAM_ALT_INDEX&&a.altIndex!==d(\"MAWDbMsg\").FUTUREPROOF_SPAM_ALT_INDEX&&(d(\"MAWBridgeEventTransmitter\").startTraceOutsideTxn(a,b,d(\"ArmadilloDataTraceType\").armadilloMessageSend),d(\"MAWBridgeEventTransmitter\").issueNewMsgUiEventOutsideTxn(a,c,e))}function s(a,b){var c=!1;for(var e=0;e<b.length;e++){var f=b[e];d(\"MAWDbMsg\").getInChatMsgIdFromMsgId(a)<=d(\"MAWDbMsg\").getInChatMsgIdFromMsgId(f.msgId)&&(c=!0)}return c}function t(a,b,c){var e=c.map(function(a){return a.rowId});return a.messages.bulkDelete(e).then(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"DeleteMessages\",value:d(\"MAWBridgeTypesCreators\").createBridgeDeleteMessages(b.chatId,b.jid,c)})})}var u=e.makeMsgrTransactor({messages:f.READONLY},\"getMsgsByProtocolMsgIds\",function(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d(\"MAWDbMsgTxns\").getMsgsByProtocolMsgId.apply(void 0,[a].concat(c))}}),v=e.makeMsgrTransactor({messages:f.READONLY},\"restoreGetMsg\",function(a){return function(b){return d(\"MAWDbMsgTxns\").maybeGetMsg(a,b)}}),w=e.makeMsgrTransactor({messages:f.READONLY},\"restoreMaybeGetOldestNonAdminMessage\",function(a){return function(b){return d(\"MAWDbMsgTxns\").getThreadOldestMessageBySortOrderOrCache(a,b).then(function(c){if(c==null)return d(\"MAWDexieTable\").dexieResolve({maybeOldestAdminMsg:null,maybeOldestMsg:null});else if(n(c))return m(a,b,c).then(function(a){return{maybeOldestAdminMsg:c,maybeOldestMsg:a}});return{maybeOldestAdminMsg:null,maybeOldestMsg:c}})}});function x(a,b,c,e,f,g,h,i,j){return d(\"MAWDexieTable\").dexieAll(b.map(function(b){return d(\"MAWDbMsgTxns\").maybeGetMsgByExternalId(a,b.externalId,c.chatId,b.author).then(function(a){if(a!=null)return;a=e.get(b.externalId);if(a==null){a=d(\"WATimeUtils\").castUnixTimeToMillisTime(b.ts);i.newestMsgTs=a>i.newestMsgTs?a:i.newestMsgTs;var k=d(\"MAWDbMsg\").craftMsgIdV2(c.chatId,i.msgNextInChatMsgId,b);i.msgNextInChatMsgId+=1;(i.oldestMsgId==null||!g&&a<i.oldestMsgTs)&&(i.isOldestMsgUpdated=!0,i.oldestMsgId=h!=null&&d(\"WATimeUtils\").castUnixTimeToMillisTime(h.ts)<a?h.msgId:k,i.oldestMsgTs=h!=null&&d(\"WATimeUtils\").castUnixTimeToMillisTime(h.ts)<a?d(\"WATimeUtils\").castUnixTimeToMillisTime(h.ts):a);(i.newestMsgTs===a||n(f))&&(i.newestMsgId=k);b.author===d(\"WAJids\").AUTHOR_ME&&(i.lastReadMsgTs==null||a>i.lastReadMsgTs)&&(i.lastReadMsg=k,i.lastReadMsgTs=a);a=babelHelpers[\"extends\"]({},b,{msgId:k,sortOrderMs:d(\"MAWDbMsg\").getSortOrderWithFallback(b)});j.push(a)}})})).then(function(){})}function y(a,b){d(\"WALogger\").ERROR(l(),b);return a.dyiBatch.filter(function(a){return a.threadId===b}).toArray().then(function(c){var e;e=(e=c.find(function(a){return a.qplInstanceKeyForThread!==null}))==null?void 0:e.qplInstanceKeyForThread;d(\"MAWEBBackendQPLUtils\").markErrorDyiBackupRestoreStoppingDyi(e,b);return a.dyiBatch.bulkDelete(c.map(function(a){return a.batchId}))})}function z(a,b,c){return a.dyiBatch.filter(function(a){return a.isThread&&a.threadId===b}).toArray().then(function(b){b=b[0];if(b.numMessagesRestored!=null)return a.dyiBatch.update(b.batchId,{numMessagesRestored:b.numMessagesRestored+c}).then(function(){})})}function A(a,b,c){b={isThread:!1,numMessages:b,oldestTs:0,threadId:a.jid};if(c.length>0){a=c.reduce(function(a,b){if(b.sortOrderMs!=null&&a.sortOrderMs!=null&&b.sortOrderMs<a.sortOrderMs)return b;else return a},c[0]);a.sortOrderMs!=null&&(b.oldestTs=a.sortOrderMs)}return b}function B(a,b,c,e){var f=A(b,c,e);if(f.oldestTs!==0&&f.numMessages===d(\"MAWDyiBatchRestoreDataSync\").DYI_BATCH_SIZE)return D(a,b,f.oldestTs).then(function(d){if(!d)return a.dyiBatch.add(f).then(function(){return z(a,b.jid,c)})});else return a.dyiBatch.add(f).then(function(){return z(a,b.jid,c)})}function C(a,b){return a.dyiBatch.filter(function(a){return a.threadId===b.jid}).toArray().then(function(a){var c=!1;for(var e=a,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;h.isThread&&(c=!0)}g=(h=a.find(function(a){return a.qplInstanceKeyForThread!==null}))==null?void 0:h.qplInstanceKeyForThread;c||(d(\"MAWEBBackendQPLUtils\").markErrorDyiBackupRestoreBatchNotInProgress(g,b.jid),d(\"WALogger\").ERROR(k(),b.jid));return c})}function D(a,b,c){return a.dyiBatch.filter(function(a){return!a.isThread&&a.threadId===b.jid}).toArray().then(function(e){if(e.length>0){var f=!1,g=[];for(var e=e,h=Array.isArray(e),i=0,e=h?e:e[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var k;if(h){if(i>=e.length)break;k=e[i++]}else{i=e.next();if(i.done)break;k=i.value}k=k;k.oldestTs<=c?(d(\"WALogger\").ERROR(j(),b.chatId),d(\"MAWEBBackendQPLUtils\").markErrorDyiBackupRestoreThreadHalt(k.qplInstanceKeyForThread,b.chatId),f=!0):g.push(k.batchId)}return f?y(a,b.jid).then(function(a){return!0}):a.dyiBatch.bulkDelete(g).then(function(a){return!1})}return d(\"MAWDexieTable\").dexieResolve(!1)})}function E(a,b,e){if(!c(\"gkx\")(\"23911\"))return d(\"MAWDexieTable\").dexieResolve();var f=b.length;return a.dyiBatch.count().then(function(c){return c===0?d(\"MAWDexieTable\").dexieResolve():C(a,e).then(function(c){if(!c)return a.dyiBatch.filter(function(a){return a.threadId===e.jid}).toArray().then(function(b){a.dyiBatch.bulkDelete(b.map(function(a){return a.batchId}))});else return B(a,e,f,b)})})}function F(a,b){return d(\"MAWDbMsgTxns\").getNextMsgIdNumberForThread(a,b).then(function(e){var f=c(\"qex\")._(\"867\");return f===!0?d(\"MAWDbMsgTxns\").getThreadNewestMessageBySortOrder(a,b.jid).then(function(a){return{newestMsgId:a==null?void 0:a.msgId,newestMsgTs:(a==null?void 0:a.sortOrderMs)!=null?d(\"WATimeUtils\").castToMillisTime(a.sortOrderMs):null,nextInChatMsgId:e}}):d(\"MAWDexieTable\").dexieResolve({newestMsgId:b.newestMsg,newestMsgTs:b.newestMsgTs,nextInChatMsgId:e})})}function G(a,b,c,e,f,g,h,i,j,k){return x(a,b,c,e,f,g,h,i,j).then(function(b){if(k!=null)for(b=0;b<j.length;b++){var e=j[b],f=e.externalId;f=k.get(f);f!=null&&(e.ts=d(\"WATimeUtils\").castMilliSecondsToUnixTime(f.ts))}return a.messages.bulkAdd(j,{allKeys:!0}).then(function(a){return a.map(function(a,b){return babelHelpers[\"extends\"]({},j[b],{rowId:a})})}).then(function(b){return a.threads.put(c).then(function(){return b})})})}var H=e.makeMsgrTransactor({dyiBatch:f.READWRITE,groupInfo:f.READWRITE,messages:f.READWRITE,threads:f.READWRITE},\"createRestoredMessagesAndUpdateThread\",function(a){return function(b,c,e,f,g,j,k,l,m,n,o,p,s,u,v){return a.threads.get(e).then(function(w){if(w==null){d(\"WALogger\").ERROR(i(),e);return d(\"MAWDexieTable\").dexieResolve()}return F(a,w).then(function(e){var i=e.newestMsgId,x=e.newestMsgTs;e=e.nextInChatMsgId;var y={isOldestMsgUpdated:!1,lastReadMsg:w.lastReadMsg,lastReadMsgTs:d(\"MAWTimeUtils\").ensureValidMillisTime(w.lastReadMsgTs),msgNextInChatMsgId:e,newestMsgId:i,newestMsgTs:d(\"MAWTimeUtils\").ensureValidMillisTime(x)||d(\"WATimeUtils\").castToMillisTime(0),oldestMsgId:l==null?void 0:l.msgId,oldestMsgTs:d(\"WATimeUtils\").castUnixTimeToMillisTime((e=l==null?void 0:l.ts)!=null?e:d(\"WATimeUtils\").castToUnixTime(0))};i=d(\"MAWDexieTable\").dexieResolve();u&&(i=t(a,w,v));return i.then(function(){return G(a,b,w,f,g,j,k,y,m,n).then(function(b){for(var d=0;d<b.length;d++){var e=b[d];r(e,w.jid,o,n)}e=c.concat(b);var f={existingMsgs:c,newlyAddedMsgs:b,threadJid:w.jid};return q(a,j,w,e,b,y,s,k,p).then(function(){return f})})[\"catch\"](function(a){d(\"WALogger\").ERROR(h(),a)})})})})}});g.getNextMsgBasedOnSortOrderMs=a;g.isE2eeOrCutoverAdminMsg=n;g.checkForDecryptionFailuresToPointRestore=o;g.restoreMsgsForThread=b;g.getMsgsByProtocolMsgIds=u;g.getMsg=v;g.maybeGetOldestNonAdminMessage=w;g.prepareUnstoredMsgArrayAndUpdateKeyVariables=x;g.stopDyiForThread=y;g.checkIfBatchInProgress=C}),98);\n__d(\"MAWHandleEchoMsgsRestoreApiV2\",[\"EchoBackupCompareUtils\",\"EchoMessage\",\"EchoMessageMediaFieldUtils\",\"LSDataTraceCheckPoint\",\"LSIntEnum\",\"LSMEBTaskCreationSource\",\"MAWAckLevel\",\"MAWBridgeEventTransmitter\",\"MAWConvertXMATargetTypeToExtendedContentTargetType\",\"MAWDbEditMsgHistoryTxns\",\"MAWDbMsg\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWEncryptedBackupCacheManager\",\"MAWHandleEchoMediaMsgsRestoreV2\",\"MAWHandleEchoMsgsRestoreApiUtils\",\"MAWHandleEchoReactionsRestore\",\"MAWHandleEchoXMARestoreV2\",\"MAWHandlePendingStanzasInRestoreV2\",\"MAWHandlePointRestoredMsgV2\",\"MAWIndexedDb\",\"MAWJids\",\"MAWMsgType\",\"MAWQplProxy\",\"MAWRepliesRestoreUtils\",\"MAWRestoreMsgsTxns\",\"MAWTraceUtils\",\"MAWTransactionMode\",\"Promise\",\"WAGlobals\",\"WAJids\",\"WAResultOrError\",\"WAStanzaUtils\",\"WATagsLogger\",\"WATimeUtils\",\"asyncToGeneratorRuntime\",\"gkx\",\"promiseDone\",\"qex\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web][MAWHandleEchoMsgsRestoreApiV2] Missing authoritative timestamp ms for external id \",\", origin \",\", type \",\", TS \",\" \"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] thread has unsupported message type: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] thread has unsupported message content type: \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] thread has unsupported message content type: \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Message content is empty for the message: \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Author info is missing from msg: \",\"\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] timestamp field should not be null as it is required for attachment download retry\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] timestamp field should not be null as it is required for attachment download retry\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] from field is missing from media message\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] from field is missing from media message\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Media data is null for the message: \",\"\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Media data is null for the message: \",\"\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Echo message is missing from the map: \",\"\"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Echo message is missing from the map: \",\"\"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Missed restoring optimistic messages for thread: \",\" count: \",\" }\"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] threadJidPrimaryId \",\" missing from index db\"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Oldest message timestamp: \",\" and newest message timestamp: \",\" of the batch for thread: \",\"\"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] No more messages to restore for thread: \",\"\"]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Ignore duplicate restore request of an existing message\"]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Message ID must not be null\"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Failed to decode the message\"]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] No messages to be restored for thread: \",\"\"]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Missing thread for thread jid: \",\"\"]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Error while restoring media\/reaction: \",\"\"]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] handleEchoMsgsRestore v2 completed. newlyAdded: \",\" existing: \",\" isPointRestore: \",\"\"]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Error while deleting point restored messages: \",\"\"]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Message creation complete. MessagesCreated: \",\" isPointRestore: \",\" startSortKey: \",\" taskSource: \",\"\"]);J=function(){return a};return a}function K(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Low level api handleEchoMsgsRestore v2 initiated restore of \",\" messages. isPointRestore: \",\" startSortKey: \",\" taskSource: \",\"\"]);K=function(){return a};return a}var L={initial_restore:20,paginated_restore:10,point_restore:1};a=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,e,f,g,j,k,l,m,n,o,p){d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(j=l)!=null?j:\"\"]).LOG(K(),e.length,f,m,p);var q=f?d(\"MAWHandleEchoMsgsRestoreApiUtils\").MAWRestoreType.POINT_RESTORE:m!=null?d(\"MAWHandleEchoMsgsRestoreApiUtils\").MAWRestoreType.PAGINATED_RESTORE:d(\"MAWHandleEchoMsgsRestoreApiUtils\").MAWRestoreType.INITIAL_RESTORE,r=d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(521486220,\"827\"),{\"int\":{messages:e.length},string:{restore_type:q,trace_id:(j=l)!=null?j:\"\"}});d(\"MAWTraceUtils\").recordCheckpointForTrace(l,(i||(i=d(\"LSIntEnum\"))).ofNumber(c(\"LSDataTraceCheckPoint\").LABYRINTH_WEB_ECHO_MESSAGE_RESTORE_BEGIN),[],!1);var s=(yield P(a,l)),t={messageIds:[],pendingRestoreSortKeys:[]};if(s){j=M(s,e,f,g,r,k,n,o,l,p);var u=a;return j.then(function(g){var j,k=((j=g.restoredMsgsData)==null?void 0:j.newlyAddedMsgs)?(j=g.restoredMsgsData)==null?void 0:j.newlyAddedMsgs.length:0;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(j=l)!=null?j:\"\"]).LOG(J(),k,f,m,p);S(a,g,n,o);return(h||(h=b(\"Promise\"))).all([Q(g,r),R(g,r,l,f),d(\"MAWHandleEchoReactionsRestore\").writeEchoReactionsToReactionsStore(g,r),V(u,g,s==null?void 0:s.jid)]).then(function(j){d(\"MAWEncryptedBackupCacheManager\").setRestoredCacheStatusAsDone(Array.from(g.echoMsgMap.keys()));return(h||(h=b(\"Promise\"))).all([d(\"MAWRepliesRestoreUtils\").updateQuoteDataForReplyMessages(g,r),d(\"MAWHandleEchoXMARestoreV2\").writeXMAToXMAStore(g,s.chatId,r,l),c(\"gkx\")(\"23948\")?d(\"MAWHandlePendingStanzasInRestoreV2\").applyPendingStanzas(g,f,r):d(\"MAWDexieTable\").dexieResolve()]).then(function(){c(\"promiseDone\")(d(\"MAWHandlePointRestoredMsgV2\").uploadPointRestoredMessageIfRequired(g));var j=g.restoredMsgsData;f&&j!=null&&N(j.newlyAddedMsgs)[\"catch\"](function(a){var b;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(b=l)!=null?b:\"\"]).ERROR(I(),a)});j=g.restoredMsgsData;j=(j==null?void 0:j.existingMsgs)?j==null?void 0:j.existingMsgs.length:0;var m=e.length;r.endSuccess({\"int\":{existingMsgs:j,messages_lost:Math.min(e.length,L[q])-j-k,newlyAddedMsgs:k,restoredMsgs:j+k,totalMsgsToRestore:m},string:{threadJidPrimaryId:a}});d(\"MAWTraceUtils\").recordCheckpointForTrace(l,(i||(i=d(\"LSIntEnum\"))).ofNumber(c(\"LSDataTraceCheckPoint\").LABYRINTH_RESTORE_MESSAGES_SUCCESS),[],!1);d(\"MAWTraceUtils\").recordCheckpointForTrace(l,i.ofNumber(c(\"LSDataTraceCheckPoint\").FLOW_END_AND_FLUSH),[],!0);g.quotesToBeRestored.forEach(function(a){t.messageIds.push(a.messageId),t.pendingRestoreSortKeys.push(a.sortOrderMs)});d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(m=l)!=null?m:\"\"]).LOG(H(),k,j,f);return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(t))})})[\"catch\"](function(a){var c;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(c=l)!=null?c:\"\"]).ERROR(G(),a);r.endFail(\"error_in_handle_media_or_reaction\");return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(t))})})}else{r.endFail(\"missing_thread_for_thread_jid\");d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(g=l)!=null?g:\"\"]).ERROR(F(),a);S(a,null,n,o)}return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(t))});return function(b,c,d,e,f,g,h,i,j,k,l){return a.apply(this,arguments)}}();function M(a,c,e,f,g,i,j,k,l,m){g==null?void 0:g.addPoint(\"message_restore_start\");var n=new Map(),o=[];c=O(c,e,a,n,f,g,l);var p=c.dbThread,q=c.hasMoreBefore,r=c.messagesToAdd;f=c.quotesToBeRestoredForThread;o.push.apply(o,f);c=r.map(function(b){return{author:b.author,chat:a.jid,externalId:d(\"WAStanzaUtils\").toStanzaId(b.externalId)}});return(h||(h=b(\"Promise\"))).all([d(\"MAWRestoreMsgsTxns\").getMsg(a.newestMsg),d(\"MAWRestoreMsgsTxns\").maybeGetOldestNonAdminMessage(a),d(\"MAWRestoreMsgsTxns\").getMsgsByProtocolMsgIds(c)]).then(function(a){var b=a[0],c=a[1],f=c.maybeOldestAdminMsg;c=c.maybeOldestMsg;a=a[2];var h=new Set(a.map(function(a){return a.externalId})),s=r.filter(function(a){return!h.has(a.externalId)});a={existingMsgs:a,hasMoreBefore:q,instanceKey:j,isPointRestore:e,maybeNewestMsg:b,maybeOldestAdminMsg:f,maybeOldestMsg:c,minMsgId:i,newMsgs:s,optimisticMsgs:k,taskSource:m,thread:p,traceId:l};return d(\"MAWRestoreMsgsTxns\").restoreMsgsForThread(a).then(function(a){g==null?void 0:g.addPoint(\"message_restore_end\");return{echoMsgMap:n,quotesToBeRestored:o,restoredMsgsData:a,thread:p}})})}var N=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:(e=d(\"MAWTransactionMode\")).READWRITE},\"restoreDeleteMessages\",function(a){return function(b){var c=[];for(var d=0;d<b.length;d++)c.push(b[d].rowId);return a.messages.bulkDelete(c)}});function O(a,b,c,e,f,g,h){var i=new Set(),j=new Map(),k=[];if(a==null||a.length===0){var l;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(l=h)!=null?l:\"\"]).WARN(E(),c.jid);return{dbThread:c,hasMoreBefore:!1,messagesToAdd:[],quotesToBeRestoredForThread:k}}var m=0;a.forEach(function(a){a=d(\"EchoMessage\").decodeEchoMessage(a);if(a==null){var b;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(b=h)!=null?b:\"\"]).ERROR(D());return}a.contentType===d(\"EchoMessage\").EchoMessageContentType.DECRYPTION_FAILURE&&m++;b=a.xOfflineThreadingId;if(b==null){var f;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(f=h)!=null?f:\"\"]).ERROR(C());return}if(i.has(b)){d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(f=h)!=null?f:\"\"]).WARN(B());return}i.add(b);f=d(\"WAStanzaUtils\").toStanzaId(b);b=W(a,c.chatId,c.jid,f,h);if(b!=null){d(\"MAWEncryptedBackupCacheManager\").addMsgEntryToRestoredCache(f,d(\"EchoBackupCompareUtils\").buildEchoDocCacheValue(a));j.set(f,b);e.set(f,a);a=a==null?void 0:a.quoteData;if(a!=null){var g=d(\"WAStanzaUtils\").toStanzaId(a.quoteMessageId);if(g!=null&&!j.has(g))k.push({messageId:a.quoteMessageId,sortOrderMs:a.quoteSortOrderInMs.toString()});else{a=d(\"MAWRepliesRestoreUtils\").addQuoteDataToReplyMessage(b,j.get(g));j.set(f,a)}}}});m===a.length&&(g==null?void 0:g.addPoint(\"decryption_failure_batch\",{\"int\":{decryptionFailuresCount:m}}));l=Array.from(j.values());l.sort(function(a,b){return((a=a.sortOrderMs)!=null?a:0)-((a=b.sortOrderMs)!=null?a:0)});a=b||f!==!1;if(!a){d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(g=h)!=null?g:\"\"]).LOG(A(),c.jid)}if(l.length>0){d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(b=h)!=null?b:\"\"]).LOG(z(),l[0].sortOrderMs,l[l.length-1].sortOrderMs,c.jid)}return{dbThread:c,hasMoreBefore:a,messagesToAdd:l,quotesToBeRestoredForThread:k}}var P=d(\"MAWIndexedDb\").makeMsgrTransactor({dyiBatch:e.READWRITE,threads:e.READONLY},\"restoreGetThread\",function(a){return function(b,c){return d(\"MAWDbThreadTxns\").getThreadByJidPrimaryId(a,b).then(function(e){if(e.success)return e.value;else{d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(e=c)!=null?e:\"\"]).ERROR(y(),b);e=d(\"WAJids\").unsafeCoerceToChatJid(b+\"@msgr\");return d(\"MAWRestoreMsgsTxns\").stopDyiForThread(a,e)}})}}),Q=d(\"MAWIndexedDb\").makeMsgrTransactor({editMsgHistory:e.READWRITE,messages:e.READWRITE},\"restoreEditMsgHistory\",function(a){return function(b,e){if(!c(\"gkx\")(\"23918\")||c(\"qex\")._(\"778\")===!0)return d(\"MAWDexieTable\").dexieResolve();e==null?void 0:e.addPoint(\"msg_history_start\");var f=b.restoredMsgsData;if(f!=null){var g=f.newlyAddedMsgs.map(function(c){var e=[],g=c.externalId,h=c.author,i=f.threadJid;c=b.echoMsgMap.get(g);if(c!=null){var j=c.editHistory;return d(\"MAWDbEditMsgHistoryTxns\").getEditHistoryAsEcho(a,g,h,i).then(function(b){if(b.length>=j.length)return d(\"MAWDexieTable\").dexieResolve([]);j.forEach(function(a){return e.push({author:h,editExternalId:a.messageId!=null?d(\"WAStanzaUtils\").toStanzaId(a.messageId):null,editTs:d(\"WATimeUtils\").castToUnixTime(a.timestamp),msgContent:{content:a.text},originalMsgExternalId:g,sendStatus:d(\"MAWAckLevel\").ACK.sent,threadJid:i})});b.length>0&&d(\"MAWDbEditMsgHistoryTxns\").bulkRemoveEditHistory(a,g,h,i);return d(\"MAWDexieTable\").dexieResolve(e)})}else return d(\"MAWDexieTable\").dexieResolve([])});return d(\"MAWDexieTable\").dexieAll(g).then(function(b){return d(\"MAWDbEditMsgHistoryTxns\").bulkAddEditMsgHistory(a,b.flat(),!0).then(function(a){return e==null?void 0:e.addPoint(\"msg_history_end\")})})}else{e==null?void 0:e.addPoint(\"msg_history_end\");return d(\"MAWDexieTable\").dexieResolve()}}}),R=function(a,c,d,e){c==null?void 0:c.addPoint(\"media_restore_start\");return T(a,d,e).then(function(a){c==null?void 0:c.addPoint(\"media_restore_end\",{\"int\":{media:a}});return(h||(h=b(\"Promise\"))).resolve()})};function S(a,b,e,f,g){if(e!=null&&c(\"gkx\")(\"23961\")){var h,i;h=(h=b==null?void 0:(h=b.restoredMsgsData)==null?void 0:h.newlyAddedMsgs.length)!=null?h:0;i=(i=b==null?void 0:(i=b.restoredMsgsData)==null?void 0:i.existingMsgs.length)!=null?i:0;if(f!=null&&f.size>0){var j,k=new Set([].concat((b==null?void 0:(j=b.restoredMsgsData)==null?void 0:(j=j.newlyAddedMsgs)==null?void 0:j.map(function(a){return a.externalId}))||[],(b==null?void 0:(j=b.restoredMsgsData)==null?void 0:(b=j.existingMsgs)==null?void 0:b.map(function(a){return a.externalId}))||[]));j=Array.from(f.keys()).reduce(function(a,b){return a+(k.has(b)?0:1)},0);if(j>0){d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(b=g)!=null?b:\"\"]).WARN(x(),a,j);d(\"MAWQplProxy\").sendQPLFailThroughBridge(c(\"qpl\")._(521482576,\"1069\"),\"optimistic_msgs_missed_restore\",{\"int\":{messages_backend_existing:i,messages_backend_restored:h,missed_message_count:j,optimistic_msgs_count:f.size}},e)}else d(\"MAWQplProxy\").sendQPLSuccessThroughBridge(c(\"qpl\")._(521482576,\"1069\"),{\"int\":{messages_backend_existing:i,messages_backend_restored:h,optimistic_msgs_count:f.size}},e)}else d(\"MAWQplProxy\").sendQPLSuccessThroughBridge(c(\"qpl\")._(521482576,\"1069\"),{\"int\":{messages_backend_existing:i,messages_backend_restored:h,optimistic_msgs_count:0}},e)}}function T(a,c,e){var f=a.restoredMsgsData,g=0;if(f){var i=f.existingMsgs.filter(function(a){return d(\"MAWDbMsg\").isMediaMsg(a)&&a.mediaId==null}),j=f.newlyAddedMsgs;i=[].concat(i,j);var k=f.threadJid,l=[];i.map(function(b){var e=b.externalId;e=a.echoMsgMap.get(e);if((e==null?void 0:e.contentType)===d(\"EchoMessage\").EchoMessageContentType.MEDIA||(e==null?void 0:e.contentType)===d(\"EchoMessage\").EchoMessageContentType.XMA){b=U(k,b,a.echoMsgMap,a.thread.chatId,(e==null?void 0:e.contentType)===d(\"EchoMessage\").EchoMessageContentType.XMA,c);b!=null&&(g+=1,l.push(b))}});return d(\"MAWHandleEchoMediaMsgsRestoreV2\").downloadMediaAndWriteToMediaStore(l,a.thread.chatId,a.thread.jid,e).then(function(a){return g})}return(h||(h=b(\"Promise\"))).resolve(g)}function U(a,b,e,f,g,h){e=e.get(b.externalId);if(e==null){if(g){var i;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",\"xma\",(i=h)!=null?i:\"\"]).WARN(w(),b.externalId)}else{d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",\"xma\",(i=h)!=null?i:\"\"]).ERROR(v(),b.externalId)}return null}i=e.mediaData;if(i==null){if(g){var j;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",\"media\",(j=h)!=null?j:\"\"]).WARN(u(),e.messageId)}else{d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",\"media\",(j=h)!=null?j:\"\"]).ERROR(t(),e.messageId)}return null}j=e.from;if(j==null){if(g){var k;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",\"media\",(k=h)!=null?k:\"\"]).WARN(s())}else{d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",\"media\",(k=h)!=null?k:\"\"]).ERROR(r())}return null}k=e.sortOrderMs;if(k==null){if(g){var l;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",\"media\",(l=h)!=null?l:\"\"]).WARN(q())}else{d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",\"media\",(l=h)!=null?l:\"\"]).ERROR(p())}return null}h=d(\"MAWJids\").toUserJid(j.localKey);l=h===d(\"WAGlobals\").getMyUserJid()?d(\"WAJids\").AUTHOR_ME:h;j=b.externalId;h=b.msgId;b={author:l,chatId:f,echoMsg:e,externalId:j,isXMA:g,messageTimestamp:k,msgId:h,threadJId:a};l=c(\"gkx\")(\"23925\");return babelHelpers[\"extends\"]({},b,{mediaData:i,previewMediaData:l?e.previewMediaData:null})}function V(a,b,e){a!=null&&e!=null&&b.quotesToBeRestored.map(function(b){d(\"MAWBridgeEventTransmitter\").issuePointQueryOutsideTxn(b.messageId,a,b.sortOrderMs,c(\"LSMEBTaskCreationSource\").EB_POINT_QUERY_IN_ACT,e)})}function W(a,b,c,e,f){var g=a.from;if(g==null){var h;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(h=f)!=null?h:\"\"]).ERROR(o(),e);return null}h=Z(a,f);if(h==null||a.isTombstoned!=null&&a.isTombstoned)return null;switch(h){case d(\"MAWMsgType\").MSG_TYPE.TEXT:case d(\"MAWMsgType\").MSG_TYPE.REVOKED:case d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT:return X(a,b,c,g,h,e,f);case d(\"MAWMsgType\").MSG_TYPE.IMAGE:case d(\"MAWMsgType\").MSG_TYPE.VIDEO:case d(\"MAWMsgType\").MSG_TYPE.STICKER:case d(\"MAWMsgType\").MSG_TYPE.GIF:case d(\"MAWMsgType\").MSG_TYPE.PTT:case d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE:return ba(a,b,c,g,h,e);case d(\"MAWMsgType\").MSG_TYPE.XMA:return da(a,b,c,g,h,e)}return null}function X(a,b,e,f,g,h,i){var j=a.text;if(j==null){var k;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(k=i)!=null?k:\"\"]).ERROR(n(),h);return null}k=$(a,b,e,f,g,h,i);if(g===d(\"MAWMsgType\").MSG_TYPE.REVOKED){j!=null&&(k.msgContent={content:j});a.revokeSentTimestampMs!=null&&(k.originalTs=d(\"WATimeUtils\").castToUnixTime(a.revokeSentTimestampMs));return babelHelpers[\"extends\"]({},k,{revokedExternalId:d(\"WAStanzaUtils\").toStanzaId(\"0\"),type:d(\"MAWMsgType\").MSG_TYPE.REVOKED,unsendMsgContentDeleteTs:a.revokeUnsentTimestampMS!=null?d(\"WATimeUtils\").castToUnixTime(a.revokeUnsentTimestampMS):k.ts})}else if(g===d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT)return babelHelpers[\"extends\"]({},k,{msgContent:{content:j},specialTextSize:Y(a.textSize),type:d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT});else{b=babelHelpers[\"extends\"]({},k,{msgContent:{content:j},specialTextSize:Y(a.textSize),type:d(\"MAWMsgType\").MSG_TYPE.TEXT});if(c(\"gkx\")(\"23918\")||c(\"qex\")._(\"778\")===!0)return babelHelpers[\"extends\"]({},b,{editCount:Math.max(a.editHistory.length-1,0)});else return b}}function Y(a){if(a==null)return void 0;else switch(a){case d(\"EchoMessage\").MessageTextSize.SMALL:return 1;case d(\"EchoMessage\").MessageTextSize.MEDIUM:return 2;case d(\"EchoMessage\").MessageTextSize.LARGE:return 3;default:return void 0}}function Z(a,b){var c=a.contentType;switch(c){case d(\"EchoMessage\").EchoMessageContentType.TEXT:return d(\"MAWMsgType\").MSG_TYPE.TEXT;case d(\"EchoMessage\").EchoMessageContentType.MEDIA:return aa(a);case d(\"EchoMessage\").EchoMessageContentType.PLACEHOLDER:if(a.contentSubtype===d(\"EchoMessage\").EchoMessageContentSubtype.UNSEND)return d(\"MAWMsgType\").MSG_TYPE.REVOKED;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(a=b)!=null?a:\"\"]).ERROR(m(),d(\"EchoMessage\").EchoMessageContentType.getName(c));break;case d(\"EchoMessage\").EchoMessageContentType.XMA:return d(\"MAWMsgType\").MSG_TYPE.XMA;case d(\"EchoMessage\").EchoMessageContentType.DECRYPTION_FAILURE:return d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT;default:d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(a=b)!=null?a:\"\"]).ERROR(l(),d(\"EchoMessage\").EchoMessageContentType.getName(c))}return null}function aa(a,b){a=a.mediaData;if(a!=null){switch(a.attachmentType){case d(\"EchoMessageMediaFieldUtils\").AttachmentType.IMAGE:return d(\"MAWMsgType\").MSG_TYPE.IMAGE;case d(\"EchoMessageMediaFieldUtils\").AttachmentType.STICKER:return d(\"MAWMsgType\").MSG_TYPE.STICKER;case d(\"EchoMessageMediaFieldUtils\").AttachmentType.VIDEO:return d(\"MAWMsgType\").MSG_TYPE.VIDEO;case d(\"EchoMessageMediaFieldUtils\").AttachmentType.GIF:return d(\"MAWMsgType\").MSG_TYPE.GIF;case d(\"EchoMessageMediaFieldUtils\").AttachmentType.PTT:return d(\"MAWMsgType\").MSG_TYPE.PTT;case d(\"EchoMessageMediaFieldUtils\").AttachmentType.XMA:return d(\"MAWMsgType\").MSG_TYPE.XMA;case d(\"EchoMessageMediaFieldUtils\").AttachmentType.DOCUMENT:return d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE}d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(b=b)!=null?b:\"\"]).ERROR(k(),d(\"EchoMessageMediaFieldUtils\").AttachmentType.getName(a.attachmentType))}return null}function ba(a,b,c,d,e,f){a=$(a,b,c,d,e,f);return ca(e,a)}function ca(a,b){switch(a){case d(\"MAWMsgType\").MSG_TYPE.IMAGE:return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.IMAGE});case d(\"MAWMsgType\").MSG_TYPE.STICKER:return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.STICKER});case d(\"MAWMsgType\").MSG_TYPE.VIDEO:return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.VIDEO});case d(\"MAWMsgType\").MSG_TYPE.GIF:return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.GIF});case d(\"MAWMsgType\").MSG_TYPE.PTT:return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.PTT});case d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE:return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE})}}function da(a,b,c,e,f,g){b=$(a,b,c,e,f,g);c=a.text;if(a.xmaData!=null&&a.xmaData.xmaTargetType!=null){e=babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.XMA,xmaMessageType:d(\"MAWConvertXMATargetTypeToExtendedContentTargetType\").convertXMATargetTypeToExtendedContentTargetType(a.xmaData.xmaTargetType)});c!=null&&(e.msgContent={content:c});return e}return null}function $(a,b,c,e,f,g,h){e=d(\"MAWHandleEchoMsgsRestoreApiUtils\").resolveAuthorFromEchoAddress(e);e={ack:e===d(\"WAJids\").AUTHOR_ME?d(\"MAWAckLevel\").ACK.sent:d(\"MAWAckLevel\").ACK.received,altIndex:void 0,author:e,externalId:g,isForwarded:a.isForwarded,sortOrderMs:a.sortOrderMs,thread:b,threadJid:c,ts:d(\"WATimeUtils\").castToUnixTime(a.displayTimestampMs\/1e3),type:f};if(a.authoritativeTimestampMs!=null)e.serverTs=d(\"WATimeUtils\").castToUnixTime(a.authoritativeTimestampMs\/1e3);else{b=a.serializationOrigin?a.serializationOrigin:\"\";d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"eb_restore\",(c=h)!=null?c:\"\"]).WARN(j(),g,b,f,(a.displayTimestampMs\/1e3).toString());e.serverTs=d(\"WATimeUtils\").castToUnixTime(a.sortOrderMs\/1e3)}if(a.quoteData!=null){h=d(\"MAWRepliesRestoreUtils\").getQuoteDataFromEchoMessage(a);h!=null&&(e.quote=h,e.quoteExternalId=h.content.externalId)}return e}g.handleEchoMsgsBulkRestore=a;g.deleteMessages=N;g.getThread=P;g.getMediaMetadataForDownload=U}),98);\n__d(\"MAWLoadMsgsTxnsV2\",[\"MAWBridgeMsg\",\"MAWBridgeMsgCountdown\",\"MAWBridgeTypesCreators\",\"MAWBridgeXMA\",\"MAWDbChunkTxns\",\"MAWDbEditMsgHistoryTxns\",\"MAWDbMediaTxns\",\"MAWDbReactionsTxns\",\"MAWDbXMATxns\",\"MAWDexieTable\",\"MAWLoadReplyMediaTxns\",\"MAWLoggerUtils\",\"MAWODSProxy\",\"MAWXMAUtils\",\"WALogger\",\"WAOdsEnums\",\"WATagsLogger\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"LoadMoreMsgs: From:\",\" orignalMsgId:\",\". \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"LoadMsgs: Point direction requires sortOrderMs\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"EphemeralCounter: Showing UI counter for \",\"\"]);j=function(){return a};return a}function k(a,b,c,e,f,g,h){g===void 0&&(g=!1);var i=0,j=!1,k=0,l=d(\"WATimeUtils\").unixTime();switch(c){case\"before\":return m();case\"after\":return n().then(function(a){return a.reverse()});default:c;return d(\"MAWDexieTable\").dexieAll([m(),n()]).then(function(a){var b=a[0];a=a[1];return o(b,a)})}function m(){return a.messages.where([\"threadJid\",\"sortOrderMs\"]).between([b,0],[b,f],!0,!0).reverse().filter(function(a){return g||a.messageExpirationTs==null||a.messageExpirationTs>l}).until(p,!0).toArray()}function n(){return a.messages.where([\"threadJid\",\"sortOrderMs\"]).between([b,f],[b,Number.MAX_SAFE_INTEGER],!0,!0).filter(function(a){return g||a.messageExpirationTs==null||a.messageExpirationTs>l}).until(p,!0).toArray()}function o(a,b){var c=new Map();b.reverse().forEach(function(a){return c.set(a.msgId,a)});a.forEach(function(a){return c.set(a.msgId,a)});return Array.from(c.values())}function p(a){i++;if(i>e&&a.sortOrderMs!==f)return!0;a.msgId===h&&(j=!0);j&&k++;return k>e?!0:!1}}function l(a,b,c){return d(\"MAWDbReactionsTxns\").getReactionsFromMessages(a,b).then(function(a){return a.map(function(a){var b=a.author,e=a.reaction,f=a.reactToMsgId,g=a.threadJid;a=a.ts;if(f==null)return;return e==null?{reaction:d(\"MAWBridgeTypesCreators\").createBridgeDeleteReaction({author:b,chatId:c,chatJid:g,reactToMsgId:f}),type:\"delete\"}:{reaction:d(\"MAWBridgeTypesCreators\").createBridgeUpsertReaction({author:b,chatId:c,chatJid:g,reaction:e||\"\",reactToMsgId:f,ts:a}),type:\"upsert\"}}).filter(Boolean)})}function m(a,b){return d(\"MAWDbMediaTxns\").getMsgMediaPairFromMsgs(a,b).then(function(b){return d(\"MAWDexieTable\").dexieAll(b.map(function(b){var c=b[0],e=b[1];return d(\"MAWDbChunkTxns\").hasMediaChunk(a,e.hashedPlaintextHash).then(function(a){return d(\"MAWBridgeTypesCreators\").createBridgeMedia(c.thread,c.threadJid,e,a,c.sortOrderMs)})}))})}function n(a,b,c){return d(\"MAWDbXMATxns\").getXMAFromMsgs(a,b).then(function(b){return d(\"MAWDexieTable\").dexieAll(b.map(function(b){return d(\"MAWXMAUtils\").isXMAStoryReply(b.targetType)?d(\"MAWDexieTable\").dexieResolve(null):d(\"MAWDbMediaTxns\").maybeGetMediaFromMediaId(a,b.defaultPreviewMediaId).then(function(a){return d(\"MAWBridgeXMA\").createBridgeXMA(c,a,b)})}))}).then(function(a){return a.filter(Boolean)})}function o(a,b,c,e,f,g){return k(a,b,e,c,f,!1,g).then(function(b){return d(\"MAWDexieTable\").dexieAll(b.map(function(b){return d(\"MAWLoadReplyMediaTxns\").getReplyMediaForMsgQuote(a,b)})).then(function(a){return{msgs:b,replyMediaInfo:a}})})}function p(a){a=a.filter(function(a){return a.ephemeralCounterStarted});if(a.length>0){d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.Ephemeral,d(\"MAWLoggerUtils\").Tag.Countdown,d(\"MAWLoggerUtils\").Tag.OnLoad]).LOG(j(),a.map(function(a){return a.msgId}));return d(\"MAWBridgeMsgCountdown\").createBridgeMsgsStartCountdown(a).msgs}return[]}function q(a,b){if(a!=null)return a;switch(b){case\"before\":return Number.MAX_SAFE_INTEGER;case\"after\":return Number.MIN_SAFE_INTEGER;default:b;d(\"WALogger\").ERROR(i());return 0}}function a(a,b,c,e,f,g,i,j){var k=q(f,e);return o(a,b,c,e,k,i).then(function(b){var f=b.msgs,o=b.replyMediaInfo;b=f;g||(b=b.filter(function(a){return a.msgId!==i}),b.length===f.length&&f.length!==0&&d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.LOAD_MORE_NO_ORIGINAL_MSG_IN_MAW,key:\"mismatch\"}));var q=f.length;if(q===0||b.length===0)return{editMsgHistory:[],expiringCountdown:[],hasMoreAfter:s(q,c,e),hasMoreBefore:r(q,c,e),medias:[],msgs:[],reactions:[],xmas:[]};var t=b.map(function(a,b){if(d(\"MAWXMAUtils\").isXMAStoryReply(a.xmaMessageType))return;return d(\"MAWBridgeMsg\").createBridgeMsg(a,void 0,(o||[])[b])}).filter(Boolean),u=p(b);f=f[0].thread;d(\"WATagsLogger\").TAGS([\"MAWSecureLocalDBDataSource\"]).LOG(h(),k,i,t.map(function(a){return a.msgId+\":\"+a.sortOrderMs}));return d(\"MAWDexieTable\").dexieAll([j.reactions?l(a,b,f):d(\"MAWDexieTable\").dexieResolve([]),j.media?m(a,b):d(\"MAWDexieTable\").dexieResolve([]),j.xma?n(a,b,f):d(\"MAWDexieTable\").dexieResolve([]),j.editMsgHistory?d(\"MAWDbEditMsgHistoryTxns\").loadEditMsgHistory(a,b):d(\"MAWDexieTable\").dexieResolve([])]).then(function(a){var b=a[0],d=a[1],f=a[2];a=a[3];return{editMsgHistory:a,expiringCountdown:u,hasMoreAfter:s(q,c,e),hasMoreBefore:r(q,c,e),medias:d,msgs:t,reactions:b,xmas:f}})})}function r(a,b,c){switch(c){case\"before\":return a>=b;case\"point\":return a>1;default:c;return!0}}function s(a,b,c){switch(c){case\"after\":return a>=b;case\"point\":return a>1;default:c;return!0}}g.getMsgsFromTs=k;g.loadMoreMsgsAndMediaFromTs=a}),98);\n__d(\"MAWLoadMsgsApi\",[\"MAWIndexedDb\",\"MAWLoadMsgsTxns\",\"MAWLoadMsgsTxnsV2\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,editMsgHistory:a.READONLY,media:a.READONLY,messages:a.READONLY,reactions:a.READONLY,threads:a.READONLY,xma:a.READONLY},\"loadMsgsFromTs\",function(a){return function(b,c,e,f,g,h,i){return d(\"MAWLoadMsgsTxnsV2\").loadMoreMsgsAndMediaFromTs(a,b,c,e,f,g,h,i)}});c=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:a.READONLY,editMsgHistory:a.READONLY,media:a.READONLY,messages:a.READONLY,reactions:a.READONLY,threads:a.READONLY,xma:a.READONLY},\"loadMsgs\",function(a){return function(b,c,e,f,g){return d(\"MAWLoadMsgsTxns\").loadMsgsAndMediaFromOffset(a,b,c,e,f,!0,(b=g)!=null?b:\"before\").then(function(a){var b=a.hasMoreAfter;a=a.hasMoreBefore;return{hasMoreAfter:b,hasMoreBefore:a}})}});g.loadMsgsFromTs=b;g.loadMsgs=c}),98);\n__d(\"MAWDeviceRegistrationTypes\",[],(function(a,b,c,d,e,f){\"use strict\";a=25;b=7;c=100;d=\"https:\/\/reg-e2ee.facebook.com\";e=d;var g=\"https:\/\/v.whatsapp.net\",h=\"https:\/\/reg-e2ee.instagram.com\",i=\"\/v2\/fb_icdc_fetch\",j=\"\/v2\/fb_register_v2\",k=\"Device has already been registered to WA servers\",l=\"Device registration finished successfully\",m=\"Device registration retries failed \"+b+\" times. No longer attempting registration.\",n=\"Device registration response was null\",o=\"Current user id is zero\",p=\"CryptoAuthToken is empty\",q=\"CryptoAuthToken is expired\",r={failed:\"failed\",finished:\"finished\"};f.MAX_USERS_FOR_NOTIFY_DEVICE_CHANGE=a;f.MAX_DEVICE_REGISTRATION_RETRIES=b;f.MAX_ROTATE_CRYPTO_AUTH_TOKEN_RETRIES=c;f.REG_FB_DOMAIN=d;f.REG_MSGR_DOMAIN=e;f.REG_WA_DOMAIN=g;f.REG_IGD_DOMAIN=h;f.ICDC_ENDPOINT=i;f.REGISTRATION_ENDPOINT=j;f.DEVICE_ALREADY_REGISTERED=k;f.DEVICE_SUCCESSFULLY_REGISTERED=l;f.FAILED_REGISTRATION_RETRIES=m;f.NULL_RESPONSE_FROM_SERVER=n;f.DEVICE_REGISTER_ERROR_ZERO_AS_USER_ID=o;f.DEVICE_REGISTER_ERROR_EMPTY_CAT_TOKEN=p;f.DEVICE_REGISTER_ERROR_EXPIRED_CAT_TOKEN=q;f.RegistrationStatesEnum=r}),66);\n__d(\"WARetryUtils\",[],(function(a,b,c,d,e,f){\"use strict\";a={algo:{type:\"adjust\",backoff:{type:\"fibonacci\",first:1,second:1},toMs:function(a){return 1e3*(a+9)}},max:62e4};f.FIBONACCI_BACKOFF=a}),66);\n__d(\"MAWRotateCAT\",[\"MAWBridge\",\"MAWDbMetaTxns\",\"MAWDeviceRegistrationTypes\",\"MAWGlobals\",\"WAArrayBufferUtils\",\"WALogger\",\"WAPromiseRetryLoop\",\"WARetryUtils\",\"asyncToGeneratorRuntime\",\"getErrorSafe\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Rotate CAT finished, ending rotate CAT promise retry loop\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unable to rotate CAT\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[MAWRotateCAT] Got an error while attempting to rotate CAT: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"CAT Finished Rotating\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Starting rotate CAT Task Bridge event\"]);l=function(){return a};return a}function m(){d(\"WALogger\").LOG(l());return d(\"MAWBridge\").getBridge().sendAndReceive(\"event\",\"rotateCryptoAuthToken\",{}).then(function(a){return d(\"MAWDbMetaTxns\").saveCAT(a)}).then(function(a){d(\"MAWGlobals\").setFbCat(d(\"WAArrayBufferUtils\").stringToArrayBuffer(a.encrypted_serialized_cat));d(\"WALogger\").LOG(k());return a})[\"catch\"](function(a){d(\"WALogger\").EXPECTED_ERROR(j(),c(\"getErrorSafe\")(a)).expect([\"1357004\"]);return null})}function a(){var a=0,c=new(d(\"WAPromiseRetryLoop\").PromiseRetryLoop)({code:function(){var c=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(b){a===d(\"MAWDeviceRegistrationTypes\").MAX_ROTATE_CRYPTO_AUTH_TOKEN_RETRIES&&d(\"WALogger\").ERROR(i());var c=(yield m());c!=null&&(d(\"WALogger\").LOG(h()),b());a++});function e(a){return c.apply(this,arguments)}return e}(),name:\"rotateCAT\",timer:d(\"WARetryUtils\").FIBONACCI_BACKOFF});c.start();return c.promise()}g.rotateCAT=m;g.tryRotateCAT=a}),98);\n__d(\"WAPreEstablishOutgoingSessionForGroup\",[\"Promise\",\"WACryptoManagerUtils\",\"WAGlobals\",\"WAResultOrError\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;c=10;var i=new Set();function j(a,c){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:if(!i.has(a)){f.next=2;break}return f.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult()));case 2:f.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return a.storage.bulkLoadIdentities(c)},{flush:!1,afterInit:!0,operationType:\"pre_establish_session\"}).then(function(a){return Array.from(a).flatMap(function(a){a=a[1];return Array.from(a.keys())})}));case 4:e=f.sent;f.next=7;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getWaOneQueue().enqueue(function(a){return d(\"WACryptoManagerUtils\").bulkPreEstablishOutgoingSession(e,a)},{operationType:\"pre_establish_session\",flush:!0,afterInit:!0}));case 7:i.add(a);return f.abrupt(\"return\",d(\"WAResultOrError\").makeResult());case 9:case\"end\":return f.stop()}},null,this)}function a(a,c){return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:if(d(\"WAGlobals\").getConfig().isPreEstablishSessionEnabled()){e.next=2;break}return e.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve());case 2:e.next=4;return b(\"regeneratorRuntime\").awrap(j(a,c));case 4:case\"end\":return e.stop()}},null,this)}g.PRE_ESTABLISH_GROUP_PARTICIPANT_THRESHOLD=c;g.preEstablishOutgoingSession=j;g.maybePreEstablishOutgoingSession=a}),98);\n__d(\"MAWSendSenderKeyDistributionMsg\",[\"MAWExternalId\",\"MAWGlobals\",\"MAWJobDefinitions\",\"MAWMsgType\",\"Promise\",\"WAJobOrchestratorTypes\",\"WAPreEstablishOutgoingSessionForGroup\",\"WAResultOrError\",\"WATimeUtils\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=new Set();function j(a,b){return k.apply(this,arguments)}function k(){k=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,c){if(i.has(a))return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult());yield d(\"MAWGlobals\").getDbImpls().writeDebugMsg(a,\"Sending key distribution msg\");c=(yield d(\"MAWGlobals\").getDbImpls().writeOutgoingMsg(c,a,d(\"WATimeUtils\").unixTime(),{},d(\"MAWMsgType\").MSG_TYPE.SK_DISTRIBUTION));if(c.type===\"already_sent\")return d(\"WAResultOrError\").makeError(\"already_sent\");else if(c.type===\"missing_thread\")return d(\"WAResultOrError\").makeError(\"missing_thread\");yield d(\"MAWGlobals\").getJobManager().waitUntilPersisted(d(\"MAWJobDefinitions\").createStartJobInfo(\"sendWrittenMsg\",{protocolMsgId:c.protocolMsgId,scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.UI_ACTION},type:\"message\"}));i.add(a);return d(\"WAResultOrError\").makeResult()});return k.apply(this,arguments)}function a(a,b){return l.apply(this,arguments)}function l(){l=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,c){var e=c.length;if(!d(\"MAWGlobals\").getConfig().isSenderKeyPredistributionEnabled()||e<d(\"WAPreEstablishOutgoingSessionForGroup\").PRE_ESTABLISH_GROUP_PARTICIPANT_THRESHOLD)return(h||(h=b(\"Promise\"))).resolve();yield d(\"WAPreEstablishOutgoingSessionForGroup\").preEstablishOutgoingSession(a,c);yield j(a,d(\"MAWExternalId\").generateExternalId())});return l.apply(this,arguments)}g.sendSenderKeyDistributionMsg=j;g.maybePreEstablishSessionsAndSendSenderKeyDistributionMsg=a}),98);\n__d(\"MAWSetEphemeralSettingsFromFrontendApi\",[\"FBLogger\",\"MAWBridge\",\"MAWEphemeralSettingsTxns\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWJobDefinitions\",\"MAWTransactionMode\",\"Promise\",\"WATimeUtils\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,contacts:a.READWRITE,ephemeralSettings:a.READWRITE,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE},\"handleAndWriteOutgoingUserEphemeralSettingChange\",function(a){return function(b,c,e,f){return d(\"MAWEphemeralSettingsTxns\").handleAndWriteOutgoingUserEphemeralSettingChange(a,b,c,e,f)}});e=function(a){var e=a.chatJid,f=a.ephemeralExpirationInSec,g=a.ephemeralLastUpdatedOrSetTimestamp,j=a.isEphemeralSettingReset;a=a.threadId;var k=(e=e)!=null?e:a;if(k==null){c(\"FBLogger\")(\"messenger_e2ee_web\").mustfix(\"Both chatJid and threadId passed to setEphemeralSettingsFromFrontend are null\");return(h||(h=b(\"Promise\"))).resolve({success:!1})}var l=(e=g)!=null?e:d(\"WATimeUtils\").unixTime();return i(k,f,l,j).then(function(a){if(a.success){var b={ephemeralExpirationInSec:f,ephemeralLastUpdatedOrSetTimestamp:l};d(\"MAWGlobals\").getJobManager().fireAndForget(d(\"MAWJobDefinitions\").jobSerializers.sendEphemeralSettingMsg(k,{ephemeralSetting:b,isEphemeralSettingReset:j,isForSyncResponse:!1}));c(\"gkx\")(\"23920\")||d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"uiUpdate\",{events:[{tag:\"EphemeralSettingsUpdatedForUI\",value:{chatJid:k,ephemeralSettingArgs:b,isEphemeralSettingReset:j}}]})}return a})};g.setEphemeralSettingsFromFrontend=e}),98);\n\/**\n * License: https:\/\/www.facebook.com\/legal\/license\/MDzNl_j9yvg\/\n *\/\n__d(\"fflate-0.6.10\",[],(function(a,b,c,d,e,f){\"use strict\";var g={},h={exports:g};function i(){var a,b=\"\";try{a={}.Worker}catch(a){}g[\"default\"]=a?function(c,d,e,f,g){var h=!1,i=new a(c+b,{eval:!0}).on(\"error\",function(a){return g(a,null)}).on(\"message\",function(a){return g(null,a)}).on(\"exit\",function(a){a&&!h&&g(new Error(\"exited with code \"+a),null)});i.postMessage(e,f);i.terminate=function(){h=!0;return a.prototype.terminate.call(i)};return i}:function(a,b,c,d,e){setImmediate(function(){return e(new Error(\"async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)\"),null)});a=function(){};return{terminate:a,postMessage:a}}}var j=!1;function k(){j||(j=!0,i());return h.exports}var l={},m={exports:l};function n(){var a=k(),b=Uint8Array,c=Uint16Array,d=Uint32Array,e=new b([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),f=new b([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),g=new b([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=function(a,b){var e=new c(31);for(var f=0;f<31;++f)e[f]=b+=1<<a[f-1];a=new d(e[30]);for(var f=1;f<30;++f)for(b=e[f];b<e[f+1];++b)a[b]=b-e[f]<<5|f;return[e,a]},i=h(e,2),j=i[0],m=i[1];j[28]=258,m[258]=28;i=h(f,0);var n=i[0],o=i[1],p=new c(32768);for(h=0;h<32768;++h){i=(h&43690)>>>1|(h&21845)<<1;i=(i&52428)>>>2|(i&13107)<<2;i=(i&61680)>>>4|(i&3855)<<4;p[h]=((i&65280)>>>8|(i&255)<<8)>>>1}var q=function(a,b,d){var e=a.length,f=0,g=new c(b);for(;f<e;++f)++g[a[f]-1];var h=new c(b);for(f=0;f<b;++f)h[f]=h[f-1]+g[f-1]<<1;if(d){g=new c(1<<b);d=15-b;for(f=0;f<e;++f)if(a[f]){var i=f<<4|a[f],j=b-a[f],k=h[a[f]-1]++<<j;for(j=k|(1<<j)-1;k<=j;++k)g[p[k]>>>d]=i}}else{g=new c(e);for(f=0;f<e;++f)a[f]&&(g[f]=p[h[a[f]-1]++]>>>15-a[f])}return g},r=new b(288);for(h=0;h<144;++h)r[h]=8;for(h=144;h<256;++h)r[h]=9;for(h=256;h<280;++h)r[h]=7;for(h=280;h<288;++h)r[h]=8;var s=new b(32);for(h=0;h<32;++h)s[h]=5;var t=q(r,9,0),u=q(r,9,1),v=q(s,5,0),w=q(s,5,1),x=function(a){var b=a[0];for(var c=1;c<a.length;++c)a[c]>b&&(b=a[c]);return b},y=function(a,b,c){var d=b\/8|0;return(a[d]|a[d+1]<<8)>>(b&7)&c},z=function(a,b){var c=b\/8|0;return(a[c]|a[c+1]<<8|a[c+2]<<16)>>(b&7)},aa=function(a){return(a\/8|0)+(a&7&&1)},A=function(a,e,f){(e==null||e<0)&&(e=0);(f==null||f>a.length)&&(f=a.length);var g=new(a instanceof c?c:a instanceof d?d:b)(f-e);g.set(a.subarray(e,f));return g},B=function(a,c,d){var h=a.length;if(!h||d&&!d.l&&h<5)return c||new b(0);var i=!c||d,k=!d||d.i;d||(d={});c||(c=new b(h*3));var l=function(a){var d=c.length;if(a>d){d=new b(Math.max(d*2,a));d.set(c);c=d}},m=d.f||0,o=d.p||0,p=d.b||0,r=d.l,s=d.d,t=d.m,v=d.n,B=h*8;do{if(!r){d.f=m=y(a,o,1);var C=y(a,o+1,3);o+=3;if(!C){var D=aa(o)+4,E=a[D-4]|a[D-3]<<8,F=D+E;if(F>h){if(k)throw\"unexpected EOF\";break}i&&l(p+E);c.set(a.subarray(D,F),p);d.b=p+=E,d.p=o=F*8;continue}else if(C==1)r=u,s=w,t=9,v=5;else if(C==2){E=y(a,o,31)+257;F=y(a,o+10,15)+4;C=E+y(a,o+5,31)+1;o+=14;var G=new b(C),H=new b(19);for(var I=0;I<F;++I)H[g[I]]=y(a,o+I*3,7);o+=F*3;F=x(H);var J=(1<<F)-1;H=q(H,F,1);for(var I=0;I<C;){F=H[y(a,o,J)];o+=F&15;var D=F>>>4;if(D<16)G[I++]=D;else{F=0;var K=0;D==16?(K=3+y(a,o,3),o+=2,F=G[I-1]):D==17?(K=3+y(a,o,7),o+=3):D==18&&(K=11+y(a,o,127),o+=7);while(K--)G[I++]=F}}D=G.subarray(0,E);K=G.subarray(E);t=x(D);v=x(K);r=q(D,t,1);s=q(K,v,1)}else throw\"invalid block type\";if(o>B){if(k)throw\"unexpected EOF\";break}}i&&l(p+131072);J=(1<<t)-1;H=(1<<v)-1;C=o;for(;;C=o){F=r[z(a,o)&J];G=F>>>4;o+=F&15;if(o>B){if(k)throw\"unexpected EOF\";break}if(!F)throw\"invalid length\/literal\";if(G<256)c[p++]=G;else if(G==256){C=o,r=null;break}else{E=G-254;if(G>264){var I=G-257;D=e[I];E=y(a,o,(1<<D)-1)+j[I];o+=D}F=s[z(a,o)&H];G=F>>>4;if(!F)throw\"invalid distance\";o+=F&15;K=n[G];if(G>3){D=f[G];K+=z(a,o)&(1<<D)-1,o+=D}if(o>B){if(k)throw\"unexpected EOF\";break}i&&l(p+131072);F=p+E;for(;p<F;p+=4)c[p]=c[p-K],c[p+1]=c[p+1-K],c[p+2]=c[p+2-K],c[p+3]=c[p+3-K];p=F}}d.l=r,d.p=C,d.b=p;r&&(m=1,d.m=t,d.d=s,d.n=v)}while(!m);return p==c.length?c:A(c,0,p)},C=function(a,b,c){c<<=b&7;b=b\/8|0;a[b]|=c;a[b+1]|=c>>>8},D=function(a,b,c){c<<=b&7;b=b\/8|0;a[b]|=c;a[b+1]|=c>>>8;a[b+2]|=c>>>16},E=function(a,d){var e=[];for(var f=0;f<a.length;++f)a[f]&&e.push({s:f,f:a[f]});a=e.length;var g=e.slice();if(!a)return[L,0];if(a==1){var h=new b(e[0].s+1);h[e[0].s]=1;return[h,1]}e.sort(function(a,b){return a.f-b.f});e.push({s:-1,f:25001});h=e[0];var i=e[1],j=0,k=1,l=2;e[0]={s:-1,f:h.f+i.f,l:h,r:i};while(k!=a-1)h=e[e[j].f<e[l].f?j++:l++],i=e[j!=k&&e[j].f<e[l].f?j++:l++],e[k++]={s:-1,f:h.f+i.f,l:h,r:i};h=g[0].s;for(var f=1;f<a;++f)g[f].s>h&&(h=g[f].s);var m=new c(h+1);i=F(e[k-1],m,0);if(i>d){var f=0;j=0;l=i-d;h=1<<l;g.sort(function(a,b){return m[b.s]-m[a.s]||a.f-b.f});for(;f<a;++f){e=g[f].s;if(m[e]>d)j+=h-(1<<i-m[e]),m[e]=d;else break}j>>>=l;while(j>0){k=g[f].s;m[k]<d?j-=1<<d-m[k]++-1:++f}for(;f>=0&&j;--f){e=g[f].s;m[e]==d&&(--m[e],++j)}i=d}return[new b(m),i]},F=function(a,b,c){return a.s==-1?Math.max(F(a.l,b,c+1),F(a.r,b,c+1)):b[a.s]=c},G=function(a){var b=a.length;while(b&&!a[--b]);var d=new c(++b),e=0,f=a[0],g=1,h=function(a){d[e++]=a};for(var i=1;i<=b;++i)if(a[i]==f&&i!=b)++g;else{if(!f&&g>2){for(;g>138;g-=138)h(32754);g>2&&(h(g>10?g-11<<5|28690:g-3<<5|12305),g=0)}else if(g>3){h(f),--g;for(;g>6;g-=6)h(8304);g>2&&(h(g-3<<5|8208),g=0)}while(g--)h(f);g=1;f=a[i]}return[d.subarray(0,e),b]},H=function(a,b){var c=0;for(var d=0;d<b.length;++d)c+=a[d]*b[d];return c},I=function(a,b,c){var d=c.length;b=aa(b+2);a[b]=d&255;a[b+1]=d>>>8;a[b+2]=a[b]^255;a[b+3]=a[b+1]^255;for(var e=0;e<d;++e)a[b+e+4]=c[e];return(b+4+d)*8},J=function(a,b,d,h,i,j,k,l,m,n,o){C(b,o++,d);++i[256];d=E(i,15);var p=d[0];d=d[1];var u=E(j,15),w=u[0];u=u[1];var x=G(p),y=x[0];x=x[1];var z=G(w),aa=z[0];z=z[1];var A=new c(19);for(var B=0;B<y.length;++B)A[y[B]&31]++;for(var B=0;B<aa.length;++B)A[aa[B]&31]++;var F=E(A,7),J=F[0];F=F[1];var K=19;for(;K>4&&!J[g[K-1]];--K);var L=n+5<<3,M=H(i,r)+H(j,s)+k;i=H(i,p)+H(j,w)+k+14+3*K+H(A,J)+(2*A[16]+3*A[17]+7*A[18]);if(L<=M&&L<=i)return I(b,o,a.subarray(m,m+n));C(b,o,1+(i<M)),o+=2;if(i<M){j=q(p,d,0),k=p,A=q(w,u,0),L=w;a=q(J,F,0);C(b,o,x-257);C(b,o+5,z-1);C(b,o+10,K-4);o+=14;for(var B=0;B<K;++B)C(b,o+3*B,J[g[B]]);o+=3*K;m=[y,aa];for(n=0;n<2;++n){i=m[n];for(var B=0;B<i.length;++B){M=i[B]&31;C(b,o,a[M]),o+=J[M];M>15&&(C(b,o,i[B]>>>5&127),o+=i[B]>>>12)}}}else j=t,k=r,A=v,L=s;for(var B=0;B<l;++B)if(h[B]>255){M=h[B]>>>18&31;D(b,o,j[M+257]),o+=k[M+257];M>7&&(C(b,o,h[B]>>>23&31),o+=e[M]);d=h[B]&31;D(b,o,A[d]),o+=L[d];d>3&&(D(b,o,h[B]>>>5&8191),o+=f[d])}else D(b,o,j[h[B]]),o+=k[h[B]];D(b,o,j[256]);return o+k[256]},K=new d([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),L=new b(0),M=function(a,g,h,i,j,k){var l=a.length,n=new b(i+l+5*(1+Math.ceil(l\/7e3))+j),p=n.subarray(i,n.length-j),q=0;if(!g||l<8)for(var r=0;r<=l;r+=65535){var s=r+65535;s<l?q=I(p,q,a.subarray(r,s)):(p[r]=k,q=I(p,q,a.subarray(r,l)))}else{s=K[g-1];g=s>>>13;s=s&8191;var t=(1<<h)-1,u=new c(32768),v=new c(t+1),w=Math.ceil(h\/3),x=2*w;h=function(b){return(a[b]^a[b+1]<<w^a[b+2]<<x)&t};var y=new d(25e3),z=new c(288),B=new c(32),C=0,D=0,r=0,E=0,F=0,G=0;for(;r<l;++r){var H=h(r),M=r&32767,N=v[H];u[M]=N;v[H]=M;if(F<=r){var O=l-r;if((C>7e3||E>24576)&&O>423){q=J(a,p,0,y,z,B,D,E,G,r-G,q);E=C=D=0,G=r;for(var P=0;P<286;++P)z[P]=0;for(var P=0;P<30;++P)B[P]=0}var Q=2,R=0,ba=s,S=M-N&32767;if(O>2&&H==h(r-S)){H=Math.min(g,O)-1;var ca=Math.min(32767,r);O=Math.min(258,O);while(S<=ca&&--ba&&M!=N){if(a[r+Q]==a[r+Q-S]){var T=0;for(;T<O&&a[r+T]==a[r+T-S];++T);if(T>Q){Q=T,R=S;if(T>H)break;T=Math.min(S,T-2);var da=0;for(var P=0;P<T;++P){var U=r-S+P+32768&32767,V=u[U];V=U-V+32768&32767;V>da&&(da=V,N=U)}}}M=N,N=u[M];S+=M-N+32768&32767}}if(R){y[E++]=268435456|m[Q]<<18|o[R];V=m[Q]&31;U=o[R]&31;D+=e[V]+f[U];++z[257+V];++B[U];F=r+Q;++C}else y[E++]=a[r],++z[a[r]]}}q=J(a,p,k,y,z,B,D,E,G,r-G,q);!k&&q&7&&(q=I(p,q+1,L))}return A(n,0,i+aa(q)+j)},N=function(){var a=new Int32Array(256);for(var b=0;b<256;++b){var c=b,d=9;while(--d)c=(c&1&&-306674912)^c>>>1;a[b]=c}return a}(),O=function(){var a=-1;return{p:function(b){var c=a;for(var d=0;d<b.length;++d)c=N[c&255^b[d]]^c>>>8;a=c},d:function(){return~a}}},P=function(){var a=1,b=0;return{p:function(c){var d=a,e=b,f=c.length;for(var g=0;g!=f;){var h=Math.min(g+2655,f);for(;g<h;++g)e+=d+=c[g];d=(d&65535)+15*(d>>16),e=(e&65535)+15*(e>>16)}a=d,b=e},d:function(){a%=65521,b%=65521;return(a&255)<<24|a>>>8<<16|(b&255)<<8|b>>>8}}},Q=function(a,b,c,d,e){return M(a,b.level==null?6:b.level,b.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(a.length)))*1.5):12+b.mem,c,d,!e)},R=function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c},ba=function(b,c,a){var d=b();b=b.toString();b=b.slice(b.indexOf(\"[\")+1,b.lastIndexOf(\"]\")).replace(\/ \/g,\"\").split(\",\");for(var e=0;e<d.length;++e){var f=d[e],g=b[e];if(typeof f==\"function\"){c+=\";\"+g+\"=\";var h=f.toString();if(f.prototype)if(h.indexOf(\"[native code]\")!=-1){var i=h.indexOf(\" \",8)+1;c+=h.slice(i,h.indexOf(\"(\",i))}else{c+=h;for(i in f.prototype)c+=\";\"+g+\".prototype.\"+i+\"=\"+f.prototype[i].toString()}else c+=h}else a[g]=f}return[c,a]},S=[],ca=function(a){var e=[];for(var f in a)(a[f]instanceof b||a[f]instanceof c||a[f]instanceof d)&&e.push((a[f]=new a[f].constructor(a[f])).buffer);return e},T=function(c,d,e,f){var b;if(!S[e]){var g=\"\",h={},i=c.length-1;for(var j=0;j<i;++j)b=ba(c[j],g,h),g=b[0],h=b[1];S[e]=ba(c[i],g,h)}b=R({},S[e][1]);return a[\"default\"](S[e][0]+\";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=\"+d.toString()+\"}\",e,b,ca(b),f)},da=function(){return[b,c,d,e,f,g,j,n,u,w,p,q,x,y,z,aa,A,B,za,ha,ia]},U=function(){return[b,c,d,e,f,g,m,o,t,r,v,s,p,K,L,q,C,D,E,F,G,H,I,J,aa,A,M,Q,wa,ha]},V=function(){return[ma,pa,Z,O,N]},ea=function(){return[na,oa]},fa=function(){return[qa,Z,P]},ga=function(){return[ra]},ha=function(a){return postMessage(a,[a.buffer])},ia=function(a){return a&&a.size&&new b(a.size)},ja=function(a,b,c,d,e,f){var g=T(c,d,e,function(b,a){g.terminate(),f(b,a)});g.postMessage([a,b],b.consume?[a.buffer]:[]);return function(){g.terminate()}},W=function(a){a.ondata=function(a,b){return postMessage([a,b],[a.buffer])};return function(b){return a.push(b.data[0],b.data[1])}},ka=function(a,b,c,d,e){var f,g=T(a,d,e,function(a,c){a?(g.terminate(),b.ondata.call(b,a)):(c[1]&&g.terminate(),b.ondata.call(b,a,c[0],c[1]))});g.postMessage(c);b.push=function(a,c){if(f)throw\"stream finished\";if(!b.ondata)throw\"no stream handler\";g.postMessage([a,f=c],[a.buffer])};b.terminate=function(){g.terminate()}},X=function(a,b){return a[b]|a[b+1]<<8},Y=function(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24)>>>0},la=function(a,b){return Y(a,b)+Y(a,b+4)*4294967296},Z=function(a,b,c){for(;c;++b)a[b]=c,c>>>=8},ma=function(a,b){var c=b.filename;a[0]=31,a[1]=139,a[2]=8,a[8]=b.level<2?4:b.level==9?2:0,a[9]=3;b.mtime!=0&&Z(a,4,Math.floor(new Date(b.mtime||Date.now())\/1e3));if(c){a[3]=8;for(b=0;b<=c.length;++b)a[b+10]=c.charCodeAt(b)}},na=function(a){if(a[0]!=31||a[1]!=139||a[2]!=8)throw\"invalid gzip data\";var b=a[3],c=10;b&4&&(c+=a[10]|(a[11]<<8)+2);for(var d=(b>>3&1)+(b>>4&1);d>0;d-=!a[c++]);return c+(b&2)},oa=function(a){var b=a.length;return(a[b-4]|a[b-3]<<8|a[b-2]<<16|a[b-1]<<24)>>>0},pa=function(a){return 10+(a.filename&&a.filename.length+1||0)},qa=function(a,b){b=b.level;b=b==0?0:b<6?1:b==9?3:2;a[0]=120,a[1]=b<<6|(b?32-2*b:1)},ra=function(a){if((a[0]&15)!=8||a[0]>>>4>7||(a[0]<<8|a[1])%31)throw\"invalid zlib data\";if(a[1]&32)throw\"invalid zlib data: preset dictionaries not supported\"};function sa(a,b){!b&&typeof a==\"function\"&&(b=a,a={});this.ondata=b;return a}var ta=function(){function a(a,b){!b&&typeof a==\"function\"&&(b=a,a={}),this.ondata=b,this.o=a||{}}a.prototype.p=function(a,b){this.ondata(Q(a,this.o,0,0,!b),b)};a.prototype.push=function(a,b){if(this.d)throw\"stream finished\";if(!this.ondata)throw\"no stream handler\";this.d=b;this.p(a,b||!1)};return a}();l.Deflate=ta;var ua=function(){function a(a,b){ka([U,function(){return[W,ta]}],this,sa.call(this,a,b),function(a){a=new ta(a.data);onmessage=W(a)},6)}return a}();l.AsyncDeflate=ua;function va(a,b,c){c||(c=b,b={});if(typeof c!=\"function\")throw\"no callback\";return ja(a,b,[U],function(a){return ha(wa(a.data[0],a.data[1]))},0,c)}l.deflate=va;function wa(a,b){return Q(a,b||{},0,0)}l.deflateSync=wa;var $=function(){function a(a){this.s={},this.p=new b(0),this.ondata=a}a.prototype.e=function(a){if(this.d)throw\"stream finished\";if(!this.ondata)throw\"no stream handler\";var c=this.p.length,d=new b(c+a.length);d.set(this.p),d.set(a,c),this.p=d};a.prototype.c=function(a){this.d=this.s.i=a||!1;a=this.s.b;var b=B(this.p,this.o,this.s);this.ondata(A(b,a,this.s.b),this.d);this.o=A(b,this.s.b-32768),this.s.b=this.o.length;this.p=A(this.p,this.s.p\/8|0),this.s.p&=7};a.prototype.push=function(a,b){this.e(a),this.c(b)};return a}();l.Inflate=$;var xa=function(){function a(a){this.ondata=a,ka([da,function(){return[W,$]}],this,0,function(){var a=new $();onmessage=W(a)},7)}return a}();l.AsyncInflate=xa;function ya(a,b,c){c||(c=b,b={});if(typeof c!=\"function\")throw\"no callback\";return ja(a,b,[da],function(a){return ha(za(a.data[0],ia(a.data[1])))},1,c)}l.inflate=ya;function za(a,b){return B(a,b)}l.inflateSync=za;var Aa=function(){function a(a,b){this.c=O(),this.l=0,this.v=1,ta.call(this,a,b)}a.prototype.push=function(a,b){ta.prototype.push.call(this,a,b)};a.prototype.p=function(a,b){this.c.p(a);this.l+=a.length;a=Q(a,this.o,this.v&&pa(this.o),b&&8,!b);this.v&&(ma(a,this.o),this.v=0);b&&(Z(a,a.length-8,this.c.d()),Z(a,a.length-4,this.l));this.ondata(a,b)};return a}();l.Gzip=Aa;l.Compress=Aa;i=function(){function a(a,b){ka([U,V,function(){return[W,ta,Aa]}],this,sa.call(this,a,b),function(a){a=new Aa(a.data);onmessage=W(a)},8)}return a}();l.AsyncGzip=i;l.AsyncCompress=i;function Ba(a,b,c){c||(c=b,b={});if(typeof c!=\"function\")throw\"no callback\";return ja(a,b,[U,V,function(){return[Ca]}],function(a){return ha(Ca(a.data[0],a.data[1]))},2,c)}l.gzip=Ba;l.compress=Ba;function Ca(a,b){b||(b={});var c=O(),d=a.length;c.p(a);a=Q(a,b,pa(b),8);var e=a.length;return ma(a,b),Z(a,e-8,c.d()),Z(a,e-4,d),a}l.gzipSync=Ca;l.compressSync=Ca;var Da=function(){function a(a){this.v=1,$.call(this,a)}a.prototype.push=function(a,b){$.prototype.e.call(this,a);if(this.v){a=this.p.length>3?na(this.p):4;if(a>=this.p.length&&!b)return;this.p=this.p.subarray(a),this.v=0}if(b){if(this.p.length<8)throw\"invalid gzip stream\";this.p=this.p.subarray(0,-8)}$.prototype.c.call(this,b)};return a}();l.Gunzip=Da;var Ea=function(){function a(a){this.ondata=a,ka([da,ea,function(){return[W,$,Da]}],this,0,function(){var a=new Da();onmessage=W(a)},9)}return a}();l.AsyncGunzip=Ea;function Fa(a,b,c){c||(c=b,b={});if(typeof c!=\"function\")throw\"no callback\";return ja(a,b,[da,ea,function(){return[Ga]}],function(a){return ha(Ga(a.data[0]))},3,c)}l.gunzip=Fa;function Ga(a,c){return B(a.subarray(na(a),-8),c||new b(oa(a)))}l.gunzipSync=Ga;var Ha=function(){function a(a,b){this.c=P(),this.v=1,ta.call(this,a,b)}a.prototype.push=function(a,b){ta.prototype.push.call(this,a,b)};a.prototype.p=function(a,b){this.c.p(a);a=Q(a,this.o,this.v&&2,b&&4,!b);this.v&&(qa(a,this.o),this.v=0);b&&Z(a,a.length-4,this.c.d());this.ondata(a,b)};return a}();l.Zlib=Ha;h=function(){function a(a,b){ka([U,fa,function(){return[W,ta,Ha]}],this,sa.call(this,a,b),function(a){a=new Ha(a.data);onmessage=W(a)},10)}return a}();l.AsyncZlib=h;function Ia(a,b,c){c||(c=b,b={});if(typeof c!=\"function\")throw\"no callback\";return ja(a,b,[U,fa,function(){return[Ja]}],function(a){return ha(Ja(a.data[0],a.data[1]))},4,c)}l.zlib=Ia;function Ja(a,b){b||(b={});var c=P();c.p(a);a=Q(a,b,2,4);return qa(a,b),Z(a,a.length-4,c.d()),a}l.zlibSync=Ja;var Ka=function(){function a(a){this.v=1,$.call(this,a)}a.prototype.push=function(a,b){$.prototype.e.call(this,a);if(this.v){if(this.p.length<2&&!b)return;this.p=this.p.subarray(2),this.v=0}if(b){if(this.p.length<4)throw\"invalid zlib stream\";this.p=this.p.subarray(0,-4)}$.prototype.c.call(this,b)};return a}();l.Unzlib=Ka;var La=function(){function a(a){this.ondata=a,ka([da,ga,function(){return[W,$,Ka]}],this,0,function(){var a=new Ka();onmessage=W(a)},11)}return a}();l.AsyncUnzlib=La;function Ma(a,b,c){c||(c=b,b={});if(typeof c!=\"function\")throw\"no callback\";return ja(a,b,[da,ga,function(){return[Na]}],function(a){return ha(Na(a.data[0],ia(a.data[1])))},5,c)}l.unzlib=Ma;function Na(a,b){return B((ra(a),a.subarray(2,-4)),b)}l.unzlibSync=Na;var Oa=function(){function a(a){this.G=Da,this.I=$,this.Z=Ka,this.ondata=a}a.prototype.push=function(a,c){if(!this.ondata)throw\"no stream handler\";if(!this.s){if(this.p&&this.p.length){var d=new b(this.p.length+a.length);d.set(this.p),d.set(a,this.p.length)}else this.p=a;if(this.p.length>2){var e=this;d=function(){e.ondata.apply(e,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(d):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(d):new this.Z(d);this.s.push(this.p,c);this.p=null}}else this.s.push(a,c)};return a}();l.Decompress=Oa;i=function(){function a(a){this.G=Ea,this.I=xa,this.Z=La,this.ondata=a}a.prototype.push=function(a,b){Oa.prototype.push.call(this,a,b)};return a}();l.AsyncDecompress=i;function Pa(a,b,c){c||(c=b,b={});if(typeof c!=\"function\")throw\"no callback\";return a[0]==31&&a[1]==139&&a[2]==8?Fa(a,b,c):(a[0]&15)!=8||a[0]>>4>7||(a[0]<<8|a[1])%31?ya(a,b,c):Ma(a,b,c)}l.decompress=Pa;function Qa(a,b){return a[0]==31&&a[1]==139&&a[2]==8?Ga(a,b):(a[0]&15)!=8||a[0]>>4>7||(a[0]<<8|a[1])%31?za(a,b):Na(a,b)}l.decompressSync=Qa;var Ra=function(a,c,d,e){for(var f in a){var g=a[f],h=c+f;g instanceof b?d[h]=[g,e]:Array.isArray(g)?d[h]=[g[0],R(e,g[1])]:Ra(g,h+\"\/\",d,e)}},Sa=typeof TextEncoder!=\"undefined\"&&new TextEncoder(),Ta=typeof TextDecoder!=\"undefined\"&&new TextDecoder(),Ua=0;try{Ta.decode(L,{stream:!0}),Ua=1}catch(a){}var Va=function(a){for(var b=\"\",c=0;;){var d=a[c++],e=(d>127)+(d>223)+(d>239);if(c+e>a.length)return[b,A(a,c-1)];!e?b+=String.fromCharCode(d):e==3?(d=((d&15)<<18|(a[c++]&63)<<12|(a[c++]&63)<<6|a[c++]&63)-65536,b+=String.fromCharCode(55296|d>>10,56320|d&1023)):e&1?b+=String.fromCharCode((d&31)<<6|a[c++]&63):b+=String.fromCharCode((d&15)<<12|(a[c++]&63)<<6|a[c++]&63)}};Ba=function(){function a(a){this.ondata=a,Ua?this.t=new TextDecoder():this.p=L}a.prototype.push=function(a,c){if(!this.ondata)throw\"no callback\";c=!!c;if(this.t){this.ondata(this.t.decode(a,{stream:!0}),c);if(c){if(this.t.decode().length)throw\"invalid utf-8 data\";this.t=null}return}if(!this.p)throw\"stream finished\";var d=new b(this.p.length+a.length);d.set(this.p);d.set(a,this.p.length);a=Va(d);d=a[0];a=a[1];if(c){if(a.length)throw\"invalid utf-8 data\";this.p=null}else this.p=a;this.ondata(d,c)};return a}();l.DecodeUTF8=Ba;h=function(){function a(a){this.ondata=a}a.prototype.push=function(a,b){if(!this.ondata)throw\"no callback\";if(this.d)throw\"stream finished\";this.ondata(Wa(a),this.d=b||!1)};return a}();l.EncodeUTF8=h;function Wa(a,c){if(c){var d=new b(a.length);for(var e=0;e<a.length;++e)d[e]=a.charCodeAt(e);return d}if(Sa)return Sa.encode(a);d=a.length;var f=new b(a.length+(a.length>>1)),g=0,h=function(a){f[g++]=a};for(var e=0;e<d;++e){if(g+5>f.length){var i=new b(g+8+(d-e<<1));i.set(f);f=i}i=a.charCodeAt(e);i<128||c?h(i):i<2048?(h(192|i>>6),h(128|i&63)):i>55295&&i<57344?(i=65536+(i&1023<<10)|a.charCodeAt(++e)&1023,h(240|i>>18),h(128|i>>12&63),h(128|i>>6&63),h(128|i&63)):(h(224|i>>12),h(128|i>>6&63),h(128|i&63))}return A(f,0,g)}l.strToU8=Wa;function Xa(a,b){if(b){b=\"\";for(var c=0;c<a.length;c+=16384)b+=String.fromCharCode.apply(null,a.subarray(c,c+16384));return b}else if(Ta)return Ta.decode(a);else{c=Va(a);b=c[0];a=c[1];if(a.length)throw\"invalid utf-8 data\";return b}}l.strFromU8=Xa;var Ya=function(a){return a==1?3:a<6?2:a==9?1:0},Za=function(a,b){return b+30+X(a,b+26)+X(a,b+28)},$a=function(a,b,c){var d=X(a,b+28),e=Xa(a.subarray(b+46,b+46+d),!(X(a,b+8)&2048));d=b+46+d;var f=Y(a,b+20);c=c&&f==4294967295?ab(a,d):[f,Y(a,b+24),Y(a,b+42)];f=c[0];var g=c[1];c=c[2];return[X(a,b+10),f,g,e,d+X(a,b+30)+X(a,b+32),c]},ab=function(a,b){for(;X(a,b)!=1;b+=4+X(a,b+2));return[la(a,b+12),la(a,b+4),la(a,b+20)]},bb=function(a){var b=0;if(a)for(var c in a){var d=a[c].length;if(d>65535)throw\"extra field too long\";b+=d+4}return b},cb=function(b,c,d,e,f,g,h,i){var a=e.length,j=d.extra,k=i&&i.length,l=bb(j);Z(b,c,h!=null?33639248:67324752),c+=4;h!=null&&(b[c++]=20,b[c++]=d.os);b[c]=20,c+=2;b[c++]=d.flag<<1|(g==null&&8),b[c++]=f&&8;b[c++]=d.compression&255,b[c++]=d.compression>>8;f=new Date(d.mtime==null?Date.now():d.mtime);var m=f.getFullYear()-1980;if(m<0||m>119)throw\"date not in range 1980-2099\";Z(b,c,m<<25|f.getMonth()+1<<21|f.getDate()<<16|f.getHours()<<11|f.getMinutes()<<5|f.getSeconds()>>>1),c+=4;g!=null&&(Z(b,c,d.crc),Z(b,c+4,g),Z(b,c+8,d.size));Z(b,c+12,a);Z(b,c+14,l),c+=16;h!=null&&(Z(b,c,k),Z(b,c+6,d.attrs),(Z(b,c+10,h),c+=14));b.set(e,c);c+=a;if(l)for(m in j){f=j[m];g=f.length;Z(b,c,+m);Z(b,c+2,g);b.set(f,c+4),c+=4+g}k&&(b.set(i,c),c+=k);return c},db=function(a,b,c,d,e){Z(a,b,101010256),Z(a,b+8,c),Z(a,b+10,c),Z(a,b+12,d),Z(a,b+16,e)},eb=function(){function a(a){this.filename=a,this.c=O(),this.size=0,this.compression=0}a.prototype.process=function(a,b){this.ondata(null,a,b)};a.prototype.push=function(a,b){if(!this.ondata)throw\"no callback - add to ZIP archive before pushing\";this.c.p(a);this.size+=a.length;b&&(this.crc=this.c.d());this.process(a,b||!1)};return a}();l.ZipPassThrough=eb;Ia=function(){function a(a,b){var c=this;b||(b={});eb.call(this,a);this.d=new ta(b,function(a,b){c.ondata(null,a,b)});this.compression=8;this.flag=Ya(b.level)}a.prototype.process=function(a,b){try{this.d.push(a,b)}catch(a){this.ondata(a,null,b)}};a.prototype.push=function(a,b){eb.prototype.push.call(this,a,b)};return a}();l.ZipDeflate=Ia;i=function(){function a(a,b){var c=this;b||(b={});eb.call(this,a);this.d=new ua(b,function(a,b,d){c.ondata(a,b,d)});this.compression=8;this.flag=Ya(b.level);this.terminate=this.d.terminate}a.prototype.process=function(a,b){this.d.push(a,b)};a.prototype.push=function(a,b){eb.prototype.push.call(this,a,b)};return a}();l.AsyncZipDeflate=i;Pa=function(){function a(a){this.ondata=a,this.u=[],this.d=1}a.prototype.add=function(c){var d=this;if(this.d&2)throw\"stream finished\";var e=Wa(c.filename),a=e.length,f=c.comment,g=f&&Wa(f);f=a!=c.filename.length||g&&f.length!=g.length;var h=a+bb(c.extra)+30;if(a>65535)throw\"filename too long\";a=new b(h);cb(a,0,c,e,f);var i=[a],j=function(){for(var a=0,b=i;a<b.length;a++){var c=b[a];d.ondata(null,c,!1)}i=[]},k=this.d;this.d=0;var l=this.u.length,m=R(c,{f:e,u:f,o:g,t:function(){c.terminate&&c.terminate()},r:function(){j();if(k){var a=d.u[l+1];a?a.r():d.d=1}k=1}}),n=0;c.ondata=function(a,e,f){if(a)d.ondata(a,e,f),d.terminate();else{n+=e.length;i.push(e);if(f){a=new b(16);Z(a,0,134695760);Z(a,4,c.crc);Z(a,8,n);Z(a,12,c.size);i.push(a);m.c=n,m.b=h+n+16,m.crc=c.crc,m.size=c.size;k&&m.r();k=1}else k&&j()}};this.u.push(m)};a.prototype.end=function(){var a=this;if(this.d&2){if(this.d&1)throw\"stream finishing\";throw\"stream finished\"}this.d?this.e():this.u.push({r:function(){if(!(a.d&1))return;a.u.splice(-1,1);a.e()},t:function(){}});this.d=3};a.prototype.e=function(){var c=0,d=0,e=0;for(var f=0,a=this.u;f<a.length;f++){var g=a[f];e+=46+g.f.length+bb(g.extra)+(g.o?g.o.length:0)}a=new b(e+22);for(var f=0,h=this.u;f<h.length;f++){var g=h[f];cb(a,c,g,g.f,g.u,g.c,d,g.o);c+=46+g.f.length+bb(g.extra)+(g.o?g.o.length:0),d+=g.b}db(a,c,this.u.length,e,d);this.ondata(null,a,!0);this.d=2};a.prototype.terminate=function(){for(var b=0,a=this.u;b<a.length;b++){var c=a[b];c.t()}this.d=2};return a}();l.Zip=Pa;function fb(a,c,d){d||(d=c,c={});if(typeof d!=\"function\")throw\"no callback\";var e={};Ra(a,\"\",e,c);var f=Object.keys(e),g=f.length,h=0,i=0,j=g,k=new Array(g),l=[],m=function(){for(var a=0;a<l.length;++a)l[a]()},n=function(){var a=new b(i+22),c=h,e=i-h;i=0;for(var f=0;f<j;++f){var g=k[f];try{var l=g.c.length;cb(a,i,g,g.f,g.u,l);var m=30+g.f.length+bb(g.extra),n=i+m;a.set(g.c,n);cb(a,h,g,g.f,g.u,l,i,g.m),h+=16+m+(g.m?g.m.length:0),i=n+l}catch(a){return d(a,null)}}db(a,h,k.length,e,c);d(null,a)};g||n();a=function(b){var c=f[b],a=e[c],j=a[0],o=a[1],p=O(),q=j.length;p.p(j);var r=Wa(c),s=r.length,t=o.comment,u=t&&Wa(t),v=u&&u.length,w=bb(o.extra),x=o.level==0?0:8;a=function(a,e){if(a)m(),d(a,null);else{a=e.length;k[b]=R(o,{size:q,crc:p.d(),c:e,f:r,m:u,u:s!=c.length||u&&t.length!=v,compression:x});h+=30+s+w+a;i+=76+2*(s+w)+(v||0)+a;--g||n()}};s>65535&&a(\"filename too long\",null);if(!x)a(null,j);else if(q<16e4)try{a(null,wa(j,o))}catch(b){a(b,null)}else l.push(va(j,o,a))};for(c=0;c<j;++c)a(c);return m}l.zip=fb;function gb(c,d){d||(d={});var e={},f=[];Ra(c,\"\",e,d);c=0;d=0;for(var g in e){var a=e[g],h=a[0];a=a[1];var i=a.level==0?0:8,j=Wa(g),k=j.length,l=a.comment,m=l&&Wa(l),n=m&&m.length,o=bb(a.extra);if(k>65535)throw\"filename too long\";var p=i?wa(h,a):h,q=p.length,r=O();r.p(h);f.push(R(a,{size:h.length,crc:r.d(),c:p,f:j,m:m,u:k!=g.length||m&&l.length!=n,o:c,compression:i}));c+=30+k+o+q;d+=76+2*(k+o)+(n||0)+q}a=new b(d+22);h=c;r=d-c;for(p=0;p<f.length;++p){var j=f[p];cb(a,j.o,j,j.f,j.u,j.c.length);m=30+j.f.length+bb(j.extra);a.set(j.c,j.o+m);cb(a,c,j,j.f,j.u,j.c.length,j.o,j.m),c+=16+m+(j.m?j.m.length:0)}db(a,c,f.length,r,h);return a}l.zipSync=gb;var hb=function(){function a(){}a.prototype.push=function(a,b){this.ondata(null,a,b)};a.compression=0;return a}();l.UnzipPassThrough=hb;Qa=function(){function a(){var a=this;this.i=new $(function(b,c){a.ondata(null,b,c)})}a.prototype.push=function(a,b){try{this.i.push(a,b)}catch(c){this.ondata(c,a,b)}};a.compression=8;return a}();l.UnzipInflate=Qa;Ba=function(){function a(a,b){var c=this;b<32e4?this.i=new $(function(a,b){c.ondata(null,a,b)}):(this.i=new xa(function(a,b,d){c.ondata(a,b,d)}),this.terminate=this.i.terminate)}a.prototype.push=function(a,b){this.i.terminate&&(a=A(a,0)),this.i.push(a,b)};a.compression=8;return a}();l.AsyncUnzipInflate=Ba;h=function(){function a(a){this.onfile=a,this.k=[],this.o={0:hb},this.p=L}a.prototype.push=function(a,c){var d=this;if(!this.onfile)throw\"no callback\";if(!this.p)throw\"stream finished\";if(this.c>0){var e=Math.min(this.c,a.length),f=a.subarray(0,e);this.c-=e;this.d?this.d.push(f,!this.c):this.k[0].push(f);a=a.subarray(e);if(a.length)return this.push(a,c)}else{f=0;var g=0;e=void 0;var h=void 0;!this.p.length?h=a:!a.length?h=this.p:(h=new b(this.p.length+a.length),(h.set(this.p),h.set(a,this.p.length)));var i=h.length,j=this.c;a=j&&this.d;var k=function(){var a=Y(h,g);if(a==67324752){f=1,e=g;l.d=null;l.c=0;var b=X(h,g+6),c=X(h,g+8),k=b&2048;b=b&8;var m=X(h,g+26),n=X(h,g+28);if(i>g+30+m+n){var o=[];l.k.unshift(o);f=2;var p=Y(h,g+18),q=Y(h,g+22),r=Xa(h.subarray(g+30,g+=30+m),!k);p==4294967295?(m=b?[-2]:ab(h,g),p=m[0],q=m[1]):b&&(p=-1);g+=n;l.c=p;var s,t={name:r,compression:c,start:function(){if(!t.ondata)throw\"no callback\";if(!p)t.ondata(null,L,!0);else{var a=d.o[c];if(!a)throw\"unknown compression type \"+c;s=p<0?new a(r):new a(r,p,q);s.ondata=function(c,b,a){t.ondata(c,b,a)};for(var a=0,b=o;a<b.length;a++){var e=b[a];s.push(e,!1)}d.k[0]==o&&d.c?d.d=s:s.push(L,!0)}},terminate:function(){s&&s.terminate&&s.terminate()}};p>=0&&(t.size=p,t.originalSize=q);l.onfile(t)}return\"break\"}else if(j)if(a==134695760){e=g+=12+(j==-2&&8),f=3,l.c=0;return\"break\"}else if(a==33639248){e=g-=4,f=3,l.c=0;return\"break\"}},l=this;for(;g<i-4;++g){var m=k();if(m===\"break\")break}this.p=L;if(j<0){m=f?h.subarray(0,e-12-(j==-2&&8)-(Y(h,e-16)==134695760&&4)):h.subarray(0,g);a?a.push(m,!!f):this.k[+(f==2)].push(m)}if(f&2)return this.push(h.subarray(g),c);this.p=h.subarray(g)}if(c){if(this.c)throw\"invalid zip file\";this.p=null}};a.prototype.register=function(a){this.o[a.compression]=a};return a}();l.Unzip=h;function ib(a,c){if(typeof c!=\"function\")throw\"no callback\";var d=[],e=function(){for(var a=0;a<d.length;++a)d[a]()},f={},g=a.length-22;for(;Y(a,g)!=101010256;--g)if(!g||a.length-g>65558){c(\"invalid zip file\",null);return}var h=X(a,g+8);h||c(null,{});var i=h,j=Y(a,g+16),k=j==4294967295;if(k){g=Y(a,g-12);if(Y(a,g)!=101075792){c(\"invalid zip file\",null);return}i=h=Y(a,g+32);j=Y(a,g+48)}g=function(g){g=$a(a,j,k);var i=g[0],l=g[1],m=g[2],n=g[3],o=g[4];g=g[5];g=Za(a,g);j=o;o=function(a,b){a?(e(),c(a,null)):(f[n]=b,--h||c(null,f))};if(!i)o(null,A(a,g,g+l));else if(i==8){g=a.subarray(g,g+l);if(l<32e4)try{o(null,za(g,new b(m)))}catch(a){o(a,null)}else d.push(ya(g,{size:m},o))}else o(\"unknown compression type \"+i,null)};for(var l=0;l<i;++l)g(l);return e}l.unzip=ib;function jb(c){var d={},e=c.length-22;for(;Y(c,e)!=101010256;--e)if(!e||c.length-e>65558)throw\"invalid zip file\";var f=X(c,e+8);if(!f)return{};var g=Y(c,e+16),h=g==4294967295;if(h){e=Y(c,e-12);if(Y(c,e)!=101075792)throw\"invalid zip file\";f=Y(c,e+32);g=Y(c,e+48)}for(e=0;e<f;++e){var a=$a(c,g,h),i=a[0],j=a[1],k=a[2],l=a[3],m=a[4];a=a[5];a=Za(c,a);g=m;if(!i)d[l]=A(c,a,a+j);else if(i==8)d[l]=za(c.subarray(a,a+j),new b(k));else throw\"unknown compression type \"+i}return d}l.unzipSync=jb}var o=!1;function p(){o||(o=!0,n());return m.exports}function a(a){switch(a){case void 0:return p()}}e.exports=a}),null);\n__d(\"fflate\",[\"fflate-0.6.10\"],(function(a,b,c,d,e,f){e.exports=b(\"fflate-0.6.10\")()}),null);\n__d(\"WAGzip\",[\"Promise\",\"WAErr\",\"fflate\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c;c=b.call(this,a)||this;c.$GzipWrapper2=[];c.ondata=function(a,b){c.$GzipWrapper2.push(a);if(!b)return;var d=0;c.$GzipWrapper2.forEach(function(a){d+=a.length});var e=new Uint8Array(d),f=0;c.$GzipWrapper2.forEach(function(a){e.set(a,f),f+=a.length});c.$GzipWrapper1=e};return c}var e=a.prototype;e.push=function(a,e){if(this.$GzipWrapper1!=null)throw c(\"WAErr\")(\"Tried to push chunk to compressor after final block\");a instanceof Uint8Array?b.prototype.push.call(this,a,e):a instanceof ArrayBuffer?b.prototype.push.call(this,new Uint8Array(a),e):b.prototype.push.call(this,d(\"fflate\").strToU8(a),e)};e.result=function(){if(this.$GzipWrapper1==null)throw c(\"WAErr\")(\"Tried to access result before adding final block\");return this.$GzipWrapper1};return a}(d(\"fflate\").Gzip);function a(a){a===void 0&&(a={});return new i(a)}function j(a){return d(\"fflate\").decompressSync(a)}function e(a){return(h||(h=b(\"Promise\"))).resolve(j(a))}g.GzipWrapper=i;g.createDeflate=a;g.inflate=j;g.gzipInflate=e}),98);\n__d(\"WAJobRequirement\",[\"Promise\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"JobRequirement[\",\"] blocker errored \",\"\"]);i=function(){return a};return a}c=function(){function a(a){var c=this;this.$1=(h||(h=b(\"Promise\"))).resolve();this.$2=!0;this.$3=null;this.$4=function(){var a=c.$3;if(a!=null){c.$3=null;return(h||(h=b(\"Promise\"))).all(a).then(c.$4)}c.$2=!0};this.name=a}var c=a.prototype;c.addBlocker=function(a){var c=this;a=a[\"catch\"](function(a){d(\"WALogger\").ERROR(i(),c.name,a).sendLogs(\"job-blocker-rejected\")});if(this.$2)this.$2=!1,this.$1=(h||(h=b(\"Promise\"))).all([this.$1,a]).then(this.$4);else{var e=this.$3;e!=null?e.push(a):this.$3=[a]}};c.waitUntilSatisfied=function(){return this.$1};c.isSatisfied=function(){return this.$2};c.isSatisfiable=function(){return!0};return a}();e=function(a){babelHelpers.inheritsLoose(c,a);function c(c){c=a.call(this,c)||this;a.prototype.addBlocker.call(babelHelpers.assertThisInitialized(c),new(h||(h=b(\"Promise\")))(function(){}));return c}var d=c.prototype;d.addBlocker=function(){};d.isSatisfiable=function(){return!1};return c}(c);function a(a,c){var d=a.filter(function(a){return!a.isSatisfiable()});if(d.length>0){var e=d.map(function(a){return a.name});return function(a){c==null?void 0:c(\"unsatisfiable\",e,a);return d[0].waitUntilSatisfied()}}var f=a.map(function(){return(h||(h=b(\"Promise\"))).resolve()}),g=(h||(h=b(\"Promise\"))).resolve(),i=null,j=function c(){if(f.every(function(b,c){return b===a[c].waitUntilSatisfied()})){i=null;return}var d=[],e=a.map(function(a){var b=a.waitUntilSatisfied();a.isSatisfied()||(d.push(a.name),b.then(function(){var b=d.indexOf(a.name);d.splice(b,1)}));return b});f=e;i=d;return(h||(h=b(\"Promise\"))).all(e).then(c)};return function(a){if(i==null){var b=j();b!=null&&(g=g.then(function(){return b}))}c==null?void 0:c(i==null?\"satisfied\":\"unsatisfied\",i,a);return g}}g.JobRequirement=c;g.UnsatisfiableJobRequirement=e;g.joinRequirements=a}),98);\n__d(\"WAPersistedJobManager\",[\"Promise\",\"WAJobRequirement\",\"WALogger\",\"WAPromiseBackoffs\",\"WATimeUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" waiting on \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" halting because of \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"waitUntilCompletedNonPersisted not implemented in PersistedJobManager\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"fireAndForgetNonPersisted not implemented in PersistedJobManager\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" has been loaded and is marked as deprecated\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"addPersistedJobImplementation called twice for \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"onJobStarted for \",\" threw exception \",\"\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": \",\" step not found\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" failed with error \",\"\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"onJobFinished for \",\" threw exception \",\"\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": finished job\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": Unhandled exception: \",\"\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": Unhandled exception. Tried \",\" times\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": RetryOnBackoff\"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": requires page\"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": delaying until \",\"\"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": trim wait from \",\" to \",\"\"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No implementation for \",\".\",\"\"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": removing completed, expired job from db\"]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": skew detected, adjusting accordingly\"]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Running deprecated job \",\"\"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No implementation for deprecated \",\", job deleted\"]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No implementation for \",\". Maybe it should have been put to the deprecated list?\"]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": InterruptJob\"]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": running step\"]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Persisted job missing for given ID\"]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No entry for job \",\"\"]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": restarting\"]);J=function(){return a};return a}function K(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": stuck on the step \",\", aborting the job\"]);K=function(){return a};return a}var L=1,M=function(){function a(a){this.feature=a}var b=a.prototype;b.toString=function(){return\"RequiresPage: \"+this.feature};return a}(),N=function(){function a(a){this.backoffOptions=a}var b=a.prototype;b.toString=function(){return\"RetryOnBackoff\"};return a}(),O=function(a){this.result=a},P=\"$unstarted\",Q=\"$finished\";a=function(){function a(a){var c=this,e=a.isRestartAfterCrash,f=a.accessors,g=a.unfinishedJobEntries,i=new Map();g=g.then(function(a){var g=[],j=[];a.forEach(function(a){a.stepHardStartCountAfterTimeout>=5?g.push(a):j.push(a)});return(h||(h=b(\"Promise\"))).all(g.map(function(a){d(\"WALogger\").ERROR(K(),S(a),a.step).devConsole(R(a)).sendLogs(\"job-stuck-\"+a.type);return f.deletePersistedJob(a.jobId)})).then(function(){j.forEach(function(a){if(i.has(a.jobId))return;d(\"WALogger\").LOG(J(),R(a));i.set(a.jobId,c.$1(a,e))})})});this.implementationLoaders=new Map();this.implementations=new Map();this.stepBlockers=new WeakMap();this.accessors=f;this.activeJobs=i;this.initialJobsPromise=g;this.listeners=a.listeners;this.deprecatedJobs=a.deprecatedJobs}var c=a.prototype;c.loadAndRunJobFromId=function(a){var b=this.activeJobs.get(a);if(b!=null)return b;b=this.$2(a);this.activeJobs.set(a,b);return b};c.$2=function(a){var c,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:c=this.initialJobsPromise,e=this.accessors;g.next=3;return b(\"regeneratorRuntime\").awrap(c);case 3:g.next=5;return b(\"regeneratorRuntime\").awrap(e.readPersistedJob(a));case 5:f=g.sent;if(f){g.next=10;break}d(\"WALogger\").DEV(I(),a);d(\"WALogger\").WARN(H());return g.abrupt(\"return\",null);case 10:return g.abrupt(\"return\",this.$1(f,!1));case 11:case\"end\":return g.stop()}},null,this)};c.$3=function(a){var b=this.implementations,c=this.implementationLoaders,d=b.get(a);if(d)return d;d=c.get(a);if(!d)return null;c=d();b.set(a,c);return c};c.$4=function(a,c){if(c==null||c.length===0)return(h||(h=b(\"Promise\"))).resolve();var e=this.stepBlockers,f=e.get(c);f==null&&(f=d(\"WAJobRequirement\").joinRequirements(c.map(function(a){return a()}),U),e.set(c,f));return f(a)};c.$5=function(a,b,c,e){var f=this;c===void 0&&(c=!1);var g=a.step,h=b.findIndex(function(a){return a.stepName===g}),i=b[h].info(a.current,a.original,V(a,c)),j=i.requirements,k=i.code;i=this.$4(a,j);e&&(i=i.then(e));return i.then(function(){d(\"WALogger\").LOG(G(),T(a));return k(a.current,a.original,V(a,c))}).then(function(e){if(e instanceof O){d(\"WALogger\").LOG(F(),T(a));return e.result}var g=h+1;if(g>=b.length)return e;g=b[g];a.step=g.stepName;a.current=e;a.stepHardStartCountAfterTimeout=0;a.stepFirstStartTime=d(\"WATimeUtils\").unixTime();a.stepUnexpectedErrorCount=0;a.waitUntil=null;a.backedOffCount=0;return f.accessors.updatePersistedJob(a).then(function(){return f.$5(a,b,c)})})};c.$1=function(a,c){var e,f=this,g,i,j,k,l,m,n,F,G,H,I,J,K,O,S,U;return b(\"regeneratorRuntime\").async(function(W){while(1)switch(W.prev=W.next){case 0:g=this.accessors,i=this.activeJobs,j=this.deprecatedJobs,k=this.listeners,l=k.onJobFinished,m=k.onJobStarted;W.next=3;return b(\"regeneratorRuntime\").awrap(this.$3(a.type));case 3:n=W.sent;F=j[a.type];if(n){W.next=21;break}if(F){W.next=13;break}d(\"WALogger\").ERROR(E(),a.type).sendLogs(\"missing-job-implementation\");W.next=10;return b(\"regeneratorRuntime\").awrap(g.deletePersistedJob(a.jobId));case 10:return W.abrupt(\"return\",null);case 13:if(!(F===\"NOOP\")){W.next=18;break}d(\"WALogger\").WARN(D(),a.type);W.next=17;return b(\"regeneratorRuntime\").awrap(g.deletePersistedJob(a.jobId));case 17:return W.abrupt(\"return\",null);case 18:W.next=20;return b(\"regeneratorRuntime\").awrap(F());case 20:n=W.sent;case 21:G=n;F&&d(\"WALogger\").LOG(C(),a.type);H=(e=a.stepFirstStartTime)!=null?e:d(\"WATimeUtils\").unixTime();a.stepFirstStartTime=H;a.stepUnexpectedErrorCount=a.stepUnexpectedErrorCount||0;a.backedOffCount=a.backedOffCount||0;if(!(a.step===Q)){W.next=44;break}I=a.waitUntil;J=d(\"WATimeUtils\").secondsUntil(H);if(!(I!=null&&d(\"WATimeUtils\").isInFuture(I)&&J>0)){W.next=38;break}d(\"WALogger\").LOG(B(),R(a));I=d(\"WATimeUtils\").castToUnixTime(I-J);if(!d(\"WATimeUtils\").isInFuture(I)){W.next=38;break}a.stepFirstStartTime=d(\"WATimeUtils\").castToUnixTime(H-J);a.waitUntil=I;W.next=38;return b(\"regeneratorRuntime\").awrap(this.accessors.updatePersistedJob(a));case 38:if(!(I==null||!d(\"WATimeUtils\").isInFuture(I))){W.next=42;break}d(\"WALogger\").LOG(A(),R(a));W.next=42;return b(\"regeneratorRuntime\").awrap(g.deletePersistedJob(a.jobId));case 42:i[\"delete\"](a.jobId);return W.abrupt(\"return\",a.current);case 44:K=a.step!==P?n.find(function(b){return b.stepName===a.step}):n[0];if(K){W.next=50;break}d(\"WALogger\").ERROR(z(),a.type,a.step).sendLogs(\"missing-job-step\");W.next=49;return b(\"regeneratorRuntime\").awrap(g.deletePersistedJob(a.jobId));case 49:return W.abrupt(\"return\",null);case 50:a.step=K.stepName;O=function e(){var g=a.waitUntil,i=(h||(h=b(\"Promise\"))).resolve();if(g!=null){var j=d(\"WATimeUtils\").futureUnixTime(d(\"WATimeUtils\").DAY_SECONDS);g>j?(d(\"WALogger\").LOG(y(),T(a),g,j),a.waitUntil=j,i=f.accessors.updatePersistedJob(a).then(function(){return d(\"WATimeUtils\").delayUntil(j)})):(d(\"WALogger\").LOG(x(),T(a),g),i=d(\"WATimeUtils\").delayUntil(g))}return i.then(function(){var g=function(){a.waitUntil=null;d(\"WATimeUtils\").happenedWithin(H,d(\"WATimeUtils\").DAY_SECONDS)||a.stepHardStartCountAfterTimeout++;return f.accessors.updatePersistedJob(a)};return f.$5(a,G,c,g)[\"catch\"](function(c){if(c instanceof M){d(\"WALogger\").LOG(w(),T(a));a.stepHardStartCountAfterTimeout>0&&(--a.stepHardStartCountAfterTimeout,f.accessors.updatePersistedJob(a));return new(h||(h=b(\"Promise\")))(function(){})}else if(c instanceof N){d(\"WALogger\").LOG(v(),T(a));var g=d(\"WAPromiseBackoffs\").getDelay(++a.backedOffCount,c.backoffOptions);a.waitUntil=d(\"WATimeUtils\").futureUnixTime(Math.ceil(g\/1e3));a.stepHardStartCountAfterTimeout>0&&--a.stepHardStartCountAfterTimeout;return f.accessors.updatePersistedJob(a).then(e)}else if(a.stepUnexpectedErrorCount<L){d(\"WALogger\").WARN(u(),T(a),a.stepUnexpectedErrorCount);d(\"WALogger\").WARN(t(),T(a),c);a.stepUnexpectedErrorCount++;return f.accessors.updatePersistedJob(a).then(e)}throw c})})};S=O();U=S.then(function(c){var e;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:d(\"WALogger\").LOG(s(),T(a));e=null;try{e=l(a.jobId,a.type,a.original,c)}catch(b){d(\"WALogger\").ERROR(r(),a.type,b).sendLogs(\"onJobFinished-threw\")}if(!(e!=null&&e>0)){h.next=12;break}a.waitUntil=d(\"WATimeUtils\").futureUnixTime(Math.ceil(e\/1e3));a.step=Q;a.current=c;a.stepFirstStartTime=d(\"WATimeUtils\").unixTime();h.next=10;return b(\"regeneratorRuntime\").awrap(f.accessors.updatePersistedJob(a));case 10:h.next=15;break;case 12:h.next=14;return b(\"regeneratorRuntime\").awrap(g.deletePersistedJob(a.jobId));case 14:i[\"delete\"](a.jobId);case 15:case\"end\":return h.stop()}},null,this)},function(e){var f,h;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:d(\"WALogger\").ERROR(q(),a.type,e).sendLogs(\"job-threw-exception-\"+a.type);f=G.find(function(b){return b.stepName===a.step});if(f){j.next=6;break}d(\"WALogger\").ERROR(p(),a.type,a.step);j.next=10;break;case 6:h=f.info(a.current,a.original,V(a,c));if(!(h.stopRetryIf!=null)){j.next=10;break}j.next=10;return b(\"regeneratorRuntime\").awrap(h.stopRetryIf.onStopRetry(a.current,a.original,V(a,c)));case 10:j.next=12;return b(\"regeneratorRuntime\").awrap(g.deletePersistedJob(a.jobId));case 12:i[\"delete\"](a.jobId);case 13:case\"end\":return j.stop()}},null,this)});try{m(a.jobId,a.type,a.original)}catch(b){d(\"WALogger\").ERROR(o(),a.type,b).sendLogs(\"onJobStarted-threw\")}return W.abrupt(\"return\",U.then(function(){return S}));case 56:case\"end\":return W.stop()}},null,this)};c.addPersistedJobImplementation=function(a,b){var c=this.implementationLoaders,e=this.deprecatedJobs;if(c.has(a)){d(\"WALogger\").ERROR(n(),a).sendLogs(\"repeat-job-loader\");return}e&&e[a]&&d(\"WALogger\").DEV(m(),a);c.set(a,b)};c.fireAndForget=function(a){var b=this;this.accessors.maybeCreateJob(a).then(function(a){a=a.id;return b.loadAndRunJobFromId(a)})};c.waitUntilPersisted=function(a){var b=this;return this.accessors.maybeCreateJob(a).then(function(a){a=a.id;b.loadAndRunJobFromId(a)})};c.waitUntilCompleted=function(a){var b=this;return this.accessors.maybeCreateJob(a).then(function(a){a=a.id;return b.loadAndRunJobFromId(a)})};c.fireAndForgetNonPersisted=function(a){d(\"WALogger\").LOG(l())};c.waitUntilCompletedNonPersisted=function(a){return(h||(h=b(\"Promise\"))).resolve(function(){return d(\"WALogger\").LOG(k())})};return a}();function R(a){return\"Job[\"+a.jobId+\"] (\"+a.type+\")\"}function S(a){return\"[Job \"+a.type+\"] \"}function T(a){return\"Job[\"+a.jobId+\"] (\"+a.type+\".\"+a.step+\")\"}function U(a,b,c){a===\"unsatisfiable\"?d(\"WALogger\").LOG(j(),T(c),b):a===\"unsatisfied\"?d(\"WALogger\").LOG(i(),T(c),b):a}function V(a,b){b===void 0&&(b=!1);return{jobStartTime:a.startTime,afterCrash:b,interruptJob:W}}function W(a){return new O(a)}g.RequiresPage=M;g.RetryOnBackoff=N;g.InterruptJob=O;g.UNSTARTED_JOB=P;g.FINISHED_JOB=Q;g.PersistedJobManager=a}),98);\n__d(\"WASmaxInDevicesIQErrorResponseMixin\",[\"WAResultOrError\",\"WASmaxParseReference\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"id\"]);if(!c.success)return c;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"id\",c.value);if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"to\"]);if(!c.success)return c;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"from\",c.value);if(!b.success)return b;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"error\");return!c.success?c:d(\"WAResultOrError\").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);\n__d(\"WASmaxInDevicesIQErrorBadRequestMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"bad-request\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",400);return!a.success?a:d(\"WAResultOrError\").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);\n__d(\"WASmaxInDevicesIQErrorItemNotFoundMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"item-not-found\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",404);return!a.success?a:d(\"WAResultOrError\").makeResult({text:b.value,code:a.value})}g.parseIQErrorItemNotFoundMixin=a}),98);\n__d(\"WASmaxInDevicesIQErrorBadRequestOrItemNotFoundMixinGroup\",[\"WAResultOrError\",\"WASmaxInDevicesIQErrorBadRequestMixin\",\"WASmaxInDevicesIQErrorItemNotFoundMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInDevicesIQErrorBadRequestMixin\").parseIQErrorBadRequestMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"IQErrorBadRequest\",value:b.value});var c=d(\"WASmaxInDevicesIQErrorItemNotFoundMixin\").parseIQErrorItemNotFoundMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"IQErrorItemNotFound\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"IQErrorBadRequest\",\"IQErrorItemNotFound\"],[b,c])}g.parseIQErrorBadRequestOrItemNotFoundMixinGroup=a}),98);\n__d(\"WASmaxInDevicesNonRetryableRemoveDeviceIQErrorMixin\",[\"WAResultOrError\",\"WASmaxInDevicesIQErrorBadRequestOrItemNotFoundMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxInDevicesIQErrorBadRequestOrItemNotFoundMixinGroup\").parseIQErrorBadRequestOrItemNotFoundMixinGroup(a);return!b.success?b:d(\"WAResultOrError\").makeResult({iQErrorBadRequestOrItemNotFoundMixinGroup:b.value})}g.parseNonRetryableRemoveDeviceIQErrorMixin=a}),98);\n__d(\"WASmaxInDevicesIQErrorInternalServerErrorMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"internal-server-error\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",500);return!a.success?a:d(\"WAResultOrError\").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);\n__d(\"WASmaxInDevicesIQErrorServiceUnavailableMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"service-unavailable\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",503);return!a.success?a:d(\"WAResultOrError\").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);\n__d(\"WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup\",[\"WAResultOrError\",\"WASmaxInDevicesIQErrorInternalServerErrorMixin\",\"WASmaxInDevicesIQErrorServiceUnavailableMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInDevicesIQErrorInternalServerErrorMixin\").parseIQErrorInternalServerErrorMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"IQErrorInternalServerError\",value:b.value});var c=d(\"WASmaxInDevicesIQErrorServiceUnavailableMixin\").parseIQErrorServiceUnavailableMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"IQErrorServiceUnavailable\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"IQErrorInternalServerError\",\"IQErrorServiceUnavailable\"],[b,c])}g.parseIQErrorInternalServerErrorOrServiceUnavailableMixinGroup=a}),98);\n__d(\"WASmaxInDevicesRetryableIQErrorMixin\",[\"WAResultOrError\",\"WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"backoff\",0,86400);if(!b.success)return b;a=d(\"WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup\").parseIQErrorInternalServerErrorOrServiceUnavailableMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({backoff:b.value,iQErrorInternalServerErrorOrServiceUnavailableMixinGroup:a.value})}g.parseRetryableIQErrorMixin=a}),98);\n__d(\"WASmaxInDevicesRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup\",[\"WAResultOrError\",\"WASmaxInDevicesNonRetryableRemoveDeviceIQErrorMixin\",\"WASmaxInDevicesRetryableIQErrorMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInDevicesRetryableIQErrorMixin\").parseRetryableIQErrorMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"RetryableIQError\",value:b.value});var c=d(\"WASmaxInDevicesNonRetryableRemoveDeviceIQErrorMixin\").parseNonRetryableRemoveDeviceIQErrorMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"NonRetryableRemoveDeviceIQError\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"RetryableIQError\",\"NonRetryableRemoveDeviceIQError\"],[b,c])}g.parseRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup=a}),98);\n__d(\"WASmaxInDevicesRemoveResponseError\",[\"WAResultOrError\",\"WASmaxInDevicesIQErrorResponseMixin\",\"WASmaxInDevicesRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInDevicesIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInDevicesRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup\").parseRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup(c.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{errorRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup:b.value}))}g.parseRemoveResponseError=a}),98);\n__d(\"WASmaxInDevicesIQResultResponseMixin\",[\"WAResultOrError\",\"WASmaxParseReference\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"id\"]);if(!c.success)return c;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"id\",c.value);if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"to\"]);if(!c.success)return c;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"from\",c.value);if(!b.success)return b;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"result\");return!c.success?c:d(\"WAResultOrError\").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);\n__d(\"WASmaxInDevicesRemoveResponseSuccess\",[\"WASmaxInDevicesIQResultResponseMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxInDevicesIQResultResponseMixin\").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseRemoveResponseSuccess=a}),98);\n__d(\"WASmaxOutDevicesBaseIQSetRequestMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(){var a=d(\"WASmaxJsx\").smax(\"iq\",{id:d(\"WAWap\").generateId(),type:\"set\"});return a}function a(a){var b=h();return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeBaseIQSetRequestMixin=a}),98);\n__d(\"WASmaxOutDevicesKeyDataMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyElementValue;a=d(\"WASmaxJsx\").smax(\"smax$any\",null,a);return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeKeyDataMixin=a}),98);\n__d(\"WASmaxOutDevicesIdentityKeyMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutDevicesKeyDataMixin\"],(function(a,b,c,d,e,f,g){function h(a){a=d(\"WASmaxJsx\").smax(\"smax$any\",null,d(\"WASmaxOutDevicesKeyDataMixin\").mergeKeyDataMixin(d(\"WASmaxJsx\").smax(\"identity\",null),a));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeIdentityKeyMixin=a}),98);\n__d(\"WASmaxOutDevicesRemoveRequest\",[\"WASmaxJsx\",\"WASmaxOutDevicesBaseIQSetRequestMixin\",\"WASmaxOutDevicesIdentityKeyMixin\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=a.removeId;a=a.identityKeyMixinArgs;b=d(\"WASmaxOutDevicesBaseIQSetRequestMixin\").mergeBaseIQSetRequestMixin(d(\"WASmaxJsx\").smax(\"iq\",{to:d(\"WAWap\").S_WHATSAPP_NET,xmlns:\"fbid:devices\"},d(\"WASmaxOutDevicesIdentityKeyMixin\").mergeIdentityKeyMixin(d(\"WASmaxJsx\").smax(\"remove\",{id:d(\"WAWap\").INT(b)}),a)));return b}g.makeRemoveRequest=a}),98);\n__d(\"WASmaxDevicesRemoveRPC\",[\"WAComms\",\"WASmaxInDevicesRemoveResponseError\",\"WASmaxInDevicesRemoveResponseSuccess\",\"WASmaxOutDevicesRemoveRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:e=d(\"WASmaxOutDevicesRemoveRequest\").makeRemoveRequest(a);i.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(e,c));case 3:f=i.sent;g=d(\"WASmaxInDevicesRemoveResponseSuccess\").parseRemoveResponseSuccess(f,e);if(!g.success){i.next=7;break}return i.abrupt(\"return\",{name:\"RemoveResponseSuccess\",value:g.value});case 7:h=d(\"WASmaxInDevicesRemoveResponseError\").parseRemoveResponseError(f,e);if(!h.success){i.next=10;break}return i.abrupt(\"return\",{name:\"RemoveResponseError\",value:h.value});case 10:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Remove\",{Success:g,Error:h}));case 11:case\"end\":return i.stop()}},null,this)}g.sendRemoveRPC=a}),98);\n__d(\"WARemoveDevice\",[\"WAJobs\",\"WALogger\",\"WAPersistedJobManager\",\"WAResultOrError\",\"WASignalOther\",\"WASmaxDevicesRemoveRPC\",\"WATimeUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"removeDevice result for \",\": \",\" \"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"removeDevice called for device \",\" and identity \",\"\"]);i=function(){return a};return a}a=d(\"WAJobs\").getPersistedJobsApi().definePersistedJob().finalStep(\"removeDevice\",function(a){var c,d,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:c=a.deviceId,d=a.identity;f.next=3;return b(\"regeneratorRuntime\").awrap(j(c,d));case 3:e=f.sent;return f.abrupt(\"return\",e.success===!0);case 5:case\"end\":return f.stop()}},null,this)}).end();function j(a,c){var e,f,g,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:d(\"WALogger\").DEV(i(),a,c);e=d(\"WASignalOther\").sliceBytes(c,1,32);k.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WASmaxDevicesRemoveRPC\").sendRemoveRPC({removeId:a,identityKeyMixinArgs:{anyElementValue:e}}));case 4:f=k.sent;d(\"WALogger\").LOG(h(),a,f);if(!(f.name===\"RemoveResponseSuccess\")){k.next=10;break}return k.abrupt(\"return\",d(\"WAResultOrError\").makeResult());case 10:f.name;g=f.value.errorRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup;if(!(g.name!==\"RetryableIQError\")){k.next=14;break}return k.abrupt(\"return\",d(\"WAResultOrError\").makeError());case 14:g.name;j=g.value.backoff;if(!(j!=null)){k.next=20;break}throw new(d(\"WAPersistedJobManager\").RetryOnBackoff)({algo:{type:\"constant\",delay:j},jitter:0});case 20:throw new(d(\"WAPersistedJobManager\").RetryOnBackoff)({algo:{type:\"exponential\",first:d(\"WATimeUtils\").HOUR_MILLISECONDS\/60},jitter:.1});case 21:case\"end\":return k.stop()}},null,this)}g.removeDeviceJob=a;g.removeDevice=j}),98);\n__d(\"MAWDebug\",[\"MAWAbProps\",\"MAWBridge\",\"MAWBulkHandleIncomingMsgApi\",\"MAWCompareIdentity\",\"MAWCreateThreadThroughMI\",\"MAWDbAddDeviceChangeAlertsTxn\",\"MAWDbAppDataTxns\",\"MAWDbChunkTxns\",\"MAWDbContactsTxns\",\"MAWDbEditMsgHistoryTxns\",\"MAWDbGetDeviceChangeAlertsByOptionsTxn\",\"MAWDbGetDeviceChangeAlertsTxn\",\"MAWDbGetUnArchivedDeviceChangeAlertsCountTxn\",\"MAWDbGroupInfoTxns\",\"MAWDbGroupInviteTxns\",\"MAWDbIdentityTxns\",\"MAWDbMediaTxns\",\"MAWDbMetaTxns\",\"MAWDbMsgTxns\",\"MAWDbMsgTypeVersionTxns\",\"MAWDbObjDecode\",\"MAWDbObjEncode\",\"MAWDbParticipantTxns\",\"MAWDbPendingReceiptTxns\",\"MAWDbPersonalSenderKeyStatusTxns\",\"MAWDbPrekeyTxns\",\"MAWDbReactionsTxns\",\"MAWDbReceiptTxns\",\"MAWDbSenderKeySessionTxns\",\"MAWDbSessionTxns\",\"MAWDbSignedPrekeyTxns\",\"MAWDbThreadTxns\",\"MAWDbUnrenderedMsgTxns\",\"MAWDbUpdateDeviceChangeAlertsLogInStatusTxn\",\"MAWDbUpdateDeviceChangeAlertsTxn\",\"MAWDbVersion\",\"MAWDbXMATxns\",\"MAWDebugHydrateOfflineQueue\",\"MAWDebugSendMultipleMsgs\",\"MAWEncryptedBackupCacheManager\",\"MAWEphemeralCleaner\",\"MAWEphemeralSettingsTxns\",\"MAWExceededStorageQuota\",\"MAWExternalId\",\"MAWGetContactAndIdentitiesApi\",\"MAWGlobals\",\"MAWHandleEchoMsgsRestoreApiV2\",\"MAWJobDefinitions\",\"MAWKeychainCrypto\",\"MAWKeychainNaClCrypto\",\"MAWLoadMsgsApi\",\"MAWMediaUtils\",\"MAWProtocolQueueUtils\",\"MAWRotateCAT\",\"MAWSendSenderKeyDistributionMsg\",\"MAWSetEphemeralSettingsFromFrontendApi\",\"MAWTransactionMode\",\"MAWTransactor\",\"MAWVault\",\"MWEARKeychainV3\",\"OfflineThreadingId\",\"Promise\",\"SignalDbTypes\",\"WAArmadilloXMA.pb\",\"WAArrayBufferUtils\",\"WADevicesState\",\"WAGatherMediaInfo\",\"WAGlobals\",\"WAGzip\",\"WAHandleFailureUtils\",\"WAJids\",\"WAJobOrchestratorTypes\",\"WALogger\",\"WAMediaUtils\",\"WAPreEstablishOutgoingSessionForGroup\",\"WAProtocolQueueState\",\"WARemoveDevice\",\"WASignalKeys\",\"WASignalOther\",\"WATimeUtils\",\"WebStorageEstimator\",\"asyncToGeneratorRuntime\",\"err\",\"gkx\",\"promiseDone\",\"unrecoverableViolation\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"CAT was successfully updated\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"New Cat: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Old Cat: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\"\"]);l=function(){return a};return a}var m={UNSAFE_changeMyIdentity:function(){void o({meta:d(\"MAWTransactionMode\").READWRITE})(function(a){return a.meta.put({key:d(\"SignalDbTypes\").MetaKeysEnum.identityKeyPair,value:{identityKeyPair:d(\"WASignalKeys\").makeKeyPair()}}).then(function(){})})()},addBadProtocolQueueInstruction:function(){var a={consumerRetries:0,instruction:\"bad\",type:\"instruction\"};return d(\"WAProtocolQueueState\").persistStanzas([a])},addDeviceChangeAlerts:function(a){return n(o({deviceChangeAlerts:d(\"MAWTransactionMode\").READWRITE})(d(\"MAWDbAddDeviceChangeAlertsTxn\").addDeviceChangeAlertsTxn)(a))},addGroupParticipants:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.addGroupParticipants(a,b))},checkStorageQuota:function(){return d(\"MAWExceededStorageQuota\").checkStorageQuota()},clearICDCInfo:function(a){return n(o({contacts:d(\"MAWTransactionMode\").READWRITE})(function(b){return b.contacts.get(a).then(function(a){if(a!=null){a.icdcInfo=void 0;a.icdcFails=void 0;a.lastSyncTs=d(\"WATimeUtils\").unixTime();return b.contacts.put(a).then(function(){return\"contact-updated\"})}return\"contact-missing\"})})())},compareIdentity:function(){return n(o({identity:d(\"MAWTransactionMode\").READONLY,meta:d(\"MAWTransactionMode\").READONLY})(d(\"MAWCompareIdentity\").compareIdentityDexie)())},createGroup:function(a,b,c){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").createStartJobInfo(\"createGroup\",{extras:{clientThreadKey:c,platform:\"msgr\"},key:c,subject:a,users:b}))},createThread:function(a){return d(\"MAWBridge\").getBridge().sendAndReceive(\"backend\",\"createThread\",{contactFbid:a,threadKey:d(\"OfflineThreadingId\").createOfflineThreadingID()})},createThreadThroughMI:function(a,b,c,e){return d(\"MAWCreateThreadThroughMI\").createThreadThroughMI({authoritativeThreadKey:a,chatJid:b,lastActivityTimestampMs:c,lastReadWatermarkTimestampMs:e,numOfMsgsToLoad:1}).then(function(){})},decodeEAR:function(a,b){return d(\"MAWDbObjDecode\").decodeDbObj(a,b)},decryptEARTweetNaCl:function(a,b){return d(\"MAWKeychainNaClCrypto\").decryptTweetNaCl(a,b)},decryptWithKeyVersion:function(a,b){var c=d(\"MWEARKeychainV3\").getDbEncryptionKey(a);c=c.key;return d(\"MAWKeychainNaClCrypto\").decrypt(c,b,a)},deflate:function(a){var b=d(\"WAGzip\").createDeflate();b.push(a,!0);return b.result()},deleteGroupInvitesByThreadAndInvitedParticipant:function(a,b){return n(o({groupInvites:d(\"MAWTransactionMode\").READWRITE})(d(\"MAWDbGroupInviteTxns\").deleteGroupInvitesByThreadAndInvitedParticipant)(a,b))},deleteGroups:function(a){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.deleteGroups(a))},demoteGroupParticipants:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.demoteGroupParticipants(a,b))},deregisterPhone:function(){c(\"promiseDone\")(d(\"WAHandleFailureUtils\").deregisterPhone())},dropExpiredMessagesFromDB:function(){var a=d(\"MAWEphemeralCleaner\").getEphemeralCleaner_FOR_TESTING_ONLY();if(a)a.backend.update(d(\"WATimeUtils\").futureUnixTime(5));else throw c(\"err\")(\"Cannot delete expired msgs as cleaner is not initialized!\")},dropExpiredMessagesFromUI:function(){var a=d(\"MAWEphemeralCleaner\").getEphemeralCleaner_FOR_TESTING_ONLY();if(a)a.ui.update(d(\"WATimeUtils\").futureUnixTime(5));else throw c(\"err\")(\"Cannot delete expired msgs as cleaner is not initialized!\")},encodeEAR:function(a,b){return d(\"MAWDbObjEncode\").encodeDbObj(a,b)},encryptEARTweetNaCl:function(a,b,c){return d(\"MAWKeychainNaClCrypto\").encryptTweetNaCl(a,b,c)},establishOutgoingSession:function(a,b){return d(\"WAPreEstablishOutgoingSessionForGroup\").preEstablishOutgoingSession(a,b)},estimateStorage:function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=(yield d(\"WebStorageEstimator\").estimateStorage());return a});function c(){return a.apply(this,arguments)}return c}(),executeQuery:function(a){var b=Object.keys(d(\"MAWDbVersion\").CURRENT_MAW_STORES).filter(function(a){return d(\"MAWDbVersion\").CURRENT_MAW_STORES[a]!=null}).reduce(function(a,b){return babelHelpers[\"extends\"]({},a,(a={},a[b+\"\"]=d(\"MAWTransactionMode\").READWRITE,a))},{});return o(b)(a)()},failAck:function(a){return n(d(\"MAWProtocolQueueUtils\").failAck(a)).then(function(){})},forwardMsg:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").createStartJobInfo(\"forwardMsg\",{chatJid:a,externalId:d(\"MAWExternalId\").generateExternalId(),protocolMsgId:b}))},fromUnixTime:function(a){return d(\"WATimeUtils\").toDate(a)},gatherMediaInfo:function(){c(\"promiseDone\")(d(\"WAGatherMediaInfo\").gatherMediaInfo())},generateAndUploadPreKeys:function(){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").createStartJobInfo(\"generateAndUploadPreKeys\",{scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH},uniqueJob:!0}))},generateAndUploadPreKeysMultipleCalls:function(){return(h||(h=b(\"Promise\"))).all([d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").createStartJobInfo(\"generateAndUploadPreKeys\",{scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH},uniqueJob:!0})),d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").createStartJobInfo(\"generateAndUploadPreKeys\",{scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH},uniqueJob:!0})),d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").createStartJobInfo(\"generateAndUploadPreKeys\",{scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH},uniqueJob:!0}))])},generateMessagesForChat:function(a,b){return d(\"MAWBulkHandleIncomingMsgApi\").bulkHandleIncomingMsgs(Array.from({length:b}).map(function(b,c){b=d(\"WATimeUtils\").castMilliSecondsToUnixTime(Date.now());var e=d(\"MAWExternalId\").generateExternalId();c={ack:2,altIndex:void 0,author:\"@me\",externalId:e,msgContent:{content:\"Stub message #\"+c},serverTs:b,ts:b,type:\"Text\"};return{msgData:{device:{id:d(\"WAJids\").extractDeviceId(d(\"WAGlobals\").getMyDeviceJid()),identity:null},folder:null,id:{author:\"@me\",chat:a,externalId:e},msg:{encoded:new Uint8Array(0),version:\"v2\"},recipientsCount:null,reportingMeta:null,ts:b,type:\"IncomingMsg\"},unstoredContent:{unstoredDbMedia:null,unstoredDbMsg:c,unstoredDbReaction:null}}})).then(function(){})},getAbProp:function(a){return d(\"MAWAbProps\").getAbProp(a)},getAbProps:function(){return d(\"MAWAbProps\").getAbProps()},getAllMessageIdsAndRangesForThread:function(a,b){return d(\"MAWBridge\").getBridge().sendAndReceive(\"backend\",\"getAllMessageIdsAndRangesForThread\",{chatJid:a,limit:b})},getAppDatas:function(a){return n(o({appData:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbAppDataTxns\").bulkGetAppData)(a))},getAppMetaByKey:function(a){return n(o({appMeta:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbMsgTypeVersionTxns\").getAppMetaValue)(a))},getChunksByChunkId:function(a){return n(o({chunk:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbChunkTxns\").bulkGetChunks)(a))},getConfig:function(){return Object.fromEntries(Object.entries(d(\"MAWGlobals\").getConfig()).map(function(a){var b=a[0];a=a[1];var c;a;try{c=a()}catch(b){c=a}return[b,c]}))},getContacts:function(a){return n(o({contacts:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbContactsTxns\").getContacts)(a))},getCurrentUserDeviceList:function(){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.getCurrentUserDeviceList({priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW}))},getCurrentUserDeviceListNonPersisted:function(){return d(\"MAWGlobals\").getJobManager().waitUntilCompletedNonPersisted(d(\"MAWJobDefinitions\").jobSerializers.getCurrentUserDeviceList({priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH}))},getDeviceChangeAlerts:function(a){return n(o({deviceChangeAlerts:d(\"MAWTransactionMode\").READWRITE})(d(\"MAWDbGetDeviceChangeAlertsTxn\").getDeviceChangeAlertsTxn)(a))},getDeviceChangeAlertsByOptions:function(a){return n(o({deviceChangeAlerts:d(\"MAWTransactionMode\").READWRITE,meta:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbGetDeviceChangeAlertsByOptionsTxn\").getDeviceChangeAlertsByOptionsTxn)(a))},getDeviceChangeAlertsByOptionsLLA:function(a){return d(\"MAWBridge\").getBridge().sendAndReceive(\"backend\",\"getDeviceChangeAlertsByOptions\",{options:a})},getDevices:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").createStartJobInfo(\"getDevices\",{ignoreDhash:b,reason:\"debug\",scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW},users:new Set(a)}))},getDevicesState:function(){return d(\"WADevicesState\").getDevicesState()},getEAREncryptKeyVersion:function(a){return d(\"MAWKeychainCrypto\").getKeyVersionFromCipherDataString(a)},getEBRestoreCache:function(){return d(\"MAWEncryptedBackupCacheManager\").restoredCache},getEditMsgHistoryByEditMsgHistoryId:function(a){return n(o({editMsgHistory:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbEditMsgHistoryTxns\").bulkGetEditMsgHistorys)(a))},getEditMsgHistoryByProtocolMsgId:function(a){return n(o({editMsgHistory:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbEditMsgHistoryTxns\").maybeGetEditMsgHistoryFromProtocolMsgId)(a))},getGroupInfosByGroupJid:function(a){return n(o({groupInfo:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbGroupInfoTxns\").getGroupInfos)(a))},getGroupInvite:function(a,b){return n(o({groupInvites:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbGroupInviteTxns\").maybeGetGroupInvite)(a,b))},getGroupInvitesByThreadAndInvitedParticipant:function(a,b){return n(o({groupInvites:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbGroupInviteTxns\").getGroupInvitesByThreadAndInvitedParticipant)(a,b))},getHmacKeyFromGlobals:function(){return d(\"MAWGlobals\").getHMACKey()},getIdentityByDeviceJid:function(a){return n(o({identity:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbIdentityTxns\").bulkGetIdentityRows)(a))},getMediaBackupForObjectId:function(a){return n(o({mediaBackup:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbMediaTxns\").maybeGetMediaBackupRowFromObjectId)(a))},getMediaByIdWithDecodedMediaEntries:function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=(yield o({media:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbMediaTxns\").bulkGetMedias)(a));a.forEach(function(a){if(!(a==null?void 0:a.mediaEntries))return;a.mediaEntries=new Map(Array.from(a.mediaEntries,function(a){var b=a[0];a=a[1];return[b,d(\"WAMediaUtils\").decodeMediaEntryData(a)]}))});return n((h||(h=b(\"Promise\"))).resolve(a))});function c(b){return a.apply(this,arguments)}return c}(),getMediaByMediaId:function(a){return n(o({media:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbMediaTxns\").bulkGetMedias)(a))},getMessagesByMsgIds:function(a){return n(o({messages:d(\"MAWTransactionMode\").READONLY})(function(b){return b.messages.where(\"msgId\").anyOf(a).toArray().then(function(a){return a.filter(Boolean)})})(a))},getMeta:function(){return n(o({meta:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbMetaTxns\").getAllMeta)())},getMsgsByChat:function(a){return n(o({messages:d(\"MAWTransactionMode\").READONLY})(function(b){return b.messages.where(\"threadJid\").equals(a).toArray()})())},getMsgsByMsgId:function(a){return n(o({messages:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbMsgTxns\").getMsgsByMsgIds)(a))},getMsgsByProtocolMsgId:function(a){return n(o({messages:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbMsgTxns\").getMsgsByProtocolMsgId)(a))},getParticipantsByParticipantKeys:function(a){return n(o({participants:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbParticipantTxns\").bulkGetParticipants)(a))},getPendingReceipts:function(a){return n(o({pendingReceipts:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbPendingReceiptTxns\").getPendingReceipts)(a))},getPersonalSenderKeyStatusesByGroupJid:function(a){return n(o({personalSenderKeyStatuses:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbPersonalSenderKeyStatusTxns\").bulkGetPersonalSenderKeyStatuses)(a))},getPlatform:function(a){return d(\"MAWExternalId\").getPlatform(a)},getPrekeyByPrekeyId:function(a){return n(o({prekey:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbPrekeyTxns\").getPrekeys)(a))},getPrekeyGenerationByGenerationId:function(a){return n(o({prekeyGeneration:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbPrekeyTxns\").getPrekeyGenerations)(a))},getProtocolMsgId:function(a){return d(\"MAWBridge\").getBridge().sendAndReceive(\"backend\",\"getProtocolMsgIdByMsgId\",{msgId:a})},getReactionByReactToMsgId:function(a){return n(o({messages:d(\"MAWTransactionMode\").READONLY,reactions:d(\"MAWTransactionMode\").READONLY})(function(b){return b.messages.where(\"msgId\").anyOf(a).toArray().then(function(a){return d(\"MAWDbReactionsTxns\").getReactionsFromMessages(b,a)})})(a))},getReceiptsByMsgId:function(a){return n(o({receipts:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbReceiptTxns\").getReceipts)(a))},getSenderKeySessionsBySenderKeySessionId:function(a){return n(o({senderKeySessions:d(\"MAWTransactionMode\").READWRITE})(d(\"MAWDbSenderKeySessionTxns\").getSenderKeySessionsBySenderKeySessionId)(a))},getSessionsByDeviceJid:function(a){return n(o({session:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbSessionTxns\").bulkGetSessions)(a))},getSignedPrekesByPrekeyId:function(a){return n(o({signedPrekey:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbSignedPrekeyTxns\").getSignedPrekeys)(a))},getThreadsByChatId:function(a){return n(o({threads:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbThreadTxns\").getThreads)(a))},getThreadsByChatJids:function(a){return n(o({threads:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbThreadTxns\").getThreadsByJids)(a))},getUnArchivedDeviceChangeAlertsCount:function(){return n(o({deviceChangeAlerts:d(\"MAWTransactionMode\").READWRITE})(d(\"MAWDbGetUnArchivedDeviceChangeAlertsCountTxn\").getUnArchivedDeviceChangeAlertsCountTxn)())},getUnrenderedMsgsByMsgId:function(a){return n(o({unrenderedMessages:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbUnrenderedMsgTxns\").getUnrenderedMsgsByMsgIds)(a))},getXMAByXMAId:function(a){return n(o({xma:d(\"MAWTransactionMode\").READONLY})(d(\"MAWDbXMATxns\").bulkGetXMAs)(a))},handleEchoMsgsBulkRestore:function(a,b,c,e,f,g,h,i){return n(d(\"MAWHandleEchoMsgsRestoreApiV2\").handleEchoMsgsBulkRestore(a,b,c,e,f,g,h,i))},hmacPlaintextHash:function(a){return d(\"MAWMediaUtils\").genHMACPlaintextHash(a)},hydrateOfflineQueue:d(\"MAWDebugHydrateOfflineQueue\").hydrateOfflineQueue.execute,inflate:function(a){return d(\"WAGzip\").inflate(a)},leaveGroups:function(a){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.leaveGroups(a))},loadMsgs:function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b;b=(yield d(\"MAWLoadMsgsApi\").loadMsgsFromTs(a.chatJid,(b=a.numMsgs)!=null?b:10,a.direction,a.sortOrderMs,a.loadOriginalMsg,a.msgId,{editMsgHistory:!0,media:!0,reactions:!0,xma:!0}));return babelHelpers[\"extends\"]({},b,{msgs:b.msgs.map(function(a){return babelHelpers[\"extends\"]({},a,{content:a.content!=null?d(\"MAWVault\").unvault(a.content):\"\"})})})});function c(b){return a.apply(this,arguments)}return c}(),makeError:function(a){throw c(\"unrecoverableViolation\")(a,\"messenger_e2ee_web\",{error:c(\"err\")(a)})},makeWAError:function(a){d(\"WALogger\").ERROR(l(),a)},markThreadAsRead:function(a,b,c){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.markThreadAsRead(a,null,!1,!1,b,c,{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.UI_ACTION}))},notifyDeviceChange:function(a){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").createStartJobInfo(\"notifyDeviceChange\",{uniqueJob:!0,users:a}))},overrideAbProp:function(a,b){d(\"MAWAbProps\").overrideAbProp(a,b)},promoteGroupParticipants:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.promoteGroupParticipants(a,b))},putGroupInvite:function(a){return n(o({groupInvites:d(\"MAWTransactionMode\").READWRITE})(d(\"MAWDbGroupInviteTxns\").putGroupInvite)(a))},putNewPersonalSenderKeyStatus:function(a){return o({personalSenderKeyStatuses:d(\"MAWTransactionMode\").READWRITE})(d(\"MAWDbPersonalSenderKeyStatusTxns\").putNewPersonalSenderKeyStatus)(a)},queryAllGroups:function(){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.queryGroups())},readProtocolQueue:function(a){return n(d(\"WAProtocolQueueState\").where(a))},removeDevice:function(a,b){return d(\"WARemoveDevice\").removeDevice(a,b)},removeGroupParticipants:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.removeGroupParticipants(a,b))},reportUserSpam:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.reportUserSpam(a,\"frx\",b,!1,[\"harassment\"],\"fake debug context\"))},requestAllSyncdMissingKeys:function(){return d(\"MAWGlobals\").getJobManager().fireAndForgetNonPersisted(d(\"MAWJobDefinitions\").jobSerializers.requestAllSyncdMissingKeys())},requestPreKeyDigest:function(){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").createStartJobInfo(\"requestPreKeyDigest\",{}))},reregisterPhone:function(){return d(\"WAHandleFailureUtils\").reregisterPhone()},resetSyncd:function(){return d(\"MAWGlobals\").getDbImpls().handleSyncdFatal({fromServer:!1})},restoreMessagesFromEncryptedBackups:function(a,b,c,e,f,g,h,i,j,k){return n(d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.restoreMessagesFromEncryptedBackups(a,b,c,e,f,g,h,i,j,k)))},revokeMsg:function(a){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.revokeMsgs([a]))},rotateCryptoAuthToken:function(){var a=d(\"WAArrayBufferUtils\").arrayBufferToString(d(\"MAWGlobals\").getFbCat());d(\"WALogger\").LOG(k(),a);return d(\"MAWRotateCAT\").tryRotateCAT().then(function(){var b=d(\"WAArrayBufferUtils\").arrayBufferToString(d(\"MAWGlobals\").getFbCat());d(\"WALogger\").LOG(j(),b);a!==b&&d(\"WALogger\").LOG(i())})},rotateSignedPreKey:function(){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").createStartJobInfo(\"rotateSignedPreKey\",{uniqueJob:!0}))},sendAppData:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.sendAppData({contents:a,deviceIds:b}))},sendEditMsg:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.sendEditMsg(a,b))},sendEphemeralSettingMsg:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.sendEphemeralSettingMsg(a,b))},sendInvisibleMsg:function(a){return d(\"MAWSendSenderKeyDistributionMsg\").sendSenderKeyDistributionMsg(a,d(\"MAWExternalId\").generateExternalId())},sendInvisibleMsgToAllExistingGroups:function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=(yield o({groupInfo:d(\"MAWTransactionMode\").READONLY})(function(a){return a.groupInfo.toArray()})()),b=[];for(a of a)b.push(d(\"MAWSendSenderKeyDistributionMsg\").sendSenderKeyDistributionMsg(a.groupJid,d(\"MAWExternalId\").generateExternalId()));return b});function c(){return a.apply(this,arguments)}return c}(),sendMessageTooAllExistingGroups:function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=(yield o({groupInfo:d(\"MAWTransactionMode\").READONLY})(function(a){return a.groupInfo.toArray()})()),b=[];for(a of a)b.push(m.sendMsg(a.groupJid,{content:\"message to \"+a.groupJid+\" at \"+new Date().getTime()}));return b});function c(){return a.apply(this,arguments)}return c}(),sendMsg:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.sendMsg(a,b))},sendMultipleMsgs:d(\"MAWDebugSendMultipleMsgs\").sendMultipleMsgs.execute,sendRavenActionMsg:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.sendRavenActionMsg(a,b))},sendReaction:function(a,b,c,e){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.sendReactionMsg(a,b,c,e))},sendXMAShareMsg:function(a,b,c,e){var f=new File([\"Hello\"],\"aaa\",{type:\"image\/jpeg\"});return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.sendXMAShareMsg(a,{file:f,height:0,width:0},void 0,void 0,(a=c)!=null?a:\"hey\",babelHelpers[\"extends\"]({},b,{xmaMessageType:d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY}),void 0,void 0,e))},setEphemeralSettingsFromFrontend:function(a,b,c,e){return n(d(\"MAWSetEphemeralSettingsFromFrontendApi\").setEphemeralSettingsFromFrontend({chatJid:b,ephemeralExpirationInSec:c,isEphemeralSettingReset:e,threadId:a}))},setEphemeralSettingWithoutUpdate:function(a,b,c,e){c=c==null?d(\"WATimeUtils\").unixTime():d(\"WATimeUtils\").futureUnixTime(c);return n(o({contacts:d(\"MAWTransactionMode\").READWRITE,ephemeralSettings:d(\"MAWTransactionMode\").READWRITE,groupInfo:d(\"MAWTransactionMode\").READONLY,messages:d(\"MAWTransactionMode\").READWRITE,threads:d(\"MAWTransactionMode\").READWRITE})(d(\"MAWEphemeralSettingsTxns\").handleAndWriteOutgoingUserEphemeralSettingChange)(a,b,c,e))},setGroupSubject:function(a,b){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.setGroupSubject(a,b))},setICDCData:function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,c){var e=(yield d(\"MAWGetContactAndIdentitiesApi\").getContactAndIdentitiesForUser(a));if(!e.success)return\"generateICDCInfo failed with error \"+e.error;else if(e.value==null)return\"Could not find contact info\";var f=e.value.contact,g=f.icdcInfo;if(g==null)return\"Could not find contact ICDC info\";var h=g.sequence;c.sequenceInc!=null&&(h=g.sequence+c.sequenceInc);var i=d(\"WAJids\").interpretAsDeviceId(999);yield d(\"WAGlobals\").getWaOneQueue().enqueue(function(){var f=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(b){b=b.cryptoManager;if(c.additionDevices===\"inject\"){var f=d(\"WASignalOther\").makeBytes(33);f[0]=5;e.value.identities.push({deviceJid:d(\"WAJids\").toDeviceJid(a,i),identity:f});yield b.storage.updateUserDevicesInfo([{devices:e.value.identities.map(function(a){var b=a.deviceJid;a=a.identity;return{id:d(\"WAJids\").extractDeviceId(b),identity:a}}),dhash:null,icdcInfo:null,jid:a,lastSyncTs:d(\"WATimeUtils\").unixTime(),notificationTs:null}])}else c.additionDevices===\"clear\"&&(yield b.storage.updateUserDevicesInfo([{devices:e.value.identities.filter(function(b){return b.deviceJid!==d(\"WAJids\").toDeviceJid(a,i)}).map(function(a){var b=a.deviceJid;a=a.identity;return{id:d(\"WAJids\").extractDeviceId(b),identity:a}}),dhash:null,icdcInfo:null,jid:a,lastSyncTs:d(\"WATimeUtils\").unixTime(),notificationTs:null}]))});return function(a){return f.apply(this,arguments)}}(),{afterInit:!0,flush:!0,operationType:\"debug_operation\"});return n(o({contacts:d(\"MAWTransactionMode\").READWRITE})(function(b){return b.contacts.get(a).then(function(a){if(a!=null){a.icdcInfo=babelHelpers[\"extends\"]({},g,{sequence:h});c.resetICDCError===!0&&(a.icdcFails=void 0);a.lastSyncTs=d(\"WATimeUtils\").unixTime();return b.contacts.put(a).then(function(){return\"contact-updated\"})}return\"contact-missing\"})})())});function c(b,c){return a.apply(this,arguments)}return c}(),syncAbProps:function(a){a=a!==!0;return d(\"MAWGlobals\").getJobManager().waitUntilCompletedNonPersisted(d(\"MAWJobDefinitions\").createStartJobInfo(\"syncAbProps\",{sendHash:a}))},syncdSyncAllCollections:function(){return d(\"MAWGlobals\").getJobManager().fireAndForgetNonPersisted(d(\"MAWJobDefinitions\").jobSerializers.syncdSyncAllCollections())},updateDeviceChangeAlerts:function(a){return n(o({deviceChangeAlerts:d(\"MAWTransactionMode\").READWRITE})(d(\"MAWDbUpdateDeviceChangeAlertsTxn\").updateDeviceChangeAlertsTxn)(a))},updateDeviceChangeAlertsLLA:function(a){return d(\"MAWBridge\").getBridge().sendAndReceive(\"backend\",\"updateDeviceChangeAlerts\",{alert:a})},updateDeviceChangeAlertsLogInStatus:function(a){return n(o({deviceChangeAlerts:d(\"MAWTransactionMode\").READWRITE})(d(\"MAWDbUpdateDeviceChangeAlertsLogInStatusTxn\").updateDeviceChangeAlertsLogInStatusTxn)(a))},uploadRetroactiveThreadsAndMessages:function(){return n(d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.uploadRetroactiveThreadsAndMessages()))}};function n(a){return a.then(function(a){return a})}c(\"gkx\")(\"23903\")&&(self.Debug=m);function o(a){return function(b){return d(\"MAWTransactor\").makeMsgrAndSignalTransactor(a,\"debug\",function(a){return function(){for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b.apply(void 0,[a].concat(d))}})}}g.MAWDebugFuncs=m}),98);\n__d(\"MAWDebugSendReaction\",[\"MAWGlobals\",\"MAWJobDefinitions\",\"WADevToolsDebugFns\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"WADevToolsDebugFns\").defineDebugFunction(\"sendReaction\",{desc:\"Sends reaction to a message\",execute:function(a,b,c,e){return d(\"MAWGlobals\").getJobManager().waitUntilCompleted(d(\"MAWJobDefinitions\").jobSerializers.sendReactionMsg(a,b,c,e))},serializedArgs:[{desc:\"ChatJid of the thread containing the message to react to\",name:\"chatJid\",placeholder:\"ChatJid\",type:\"string\"},{desc:\"ProtocolMsgId of the message to react to\",name:\"reactTo\",placeholder:\"ProtocolMsgId\",type:\"object\"},{desc:\"FBID of the author of the message to react to\",name:\"author\",placeholder:\"FBID\",type:\"string\"},{desc:\"Reaction emoji to use\",name:\"reaction\",placeholder:\"\\ud83d\\ude00\",type:\"string\"}]});g.sendReaction=a}),98);\n__d(\"MAWDebugDefineFunctions\",[\"MAWDebug\",\"MAWDebugHydrateOfflineQueue\",\"MAWDebugSendMultipleMsgs\",\"MAWDebugSendReaction\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a,b){return{desc:a,execute:b,name:a,serializedArgs:[]}}function a(){var a=Object.keys(d(\"MAWDebug\").MAWDebugFuncs).reduce(function(a,b){return Object.assign(a,(a={},a[b]=h(b,d(\"MAWDebug\").MAWDebugFuncs[b]),a))},{});return babelHelpers[\"extends\"]({},a,{hydrateOfflineQueue:d(\"MAWDebugHydrateOfflineQueue\").hydrateOfflineQueue,sendMultipleMsgs:d(\"MAWDebugSendMultipleMsgs\").sendMultipleMsgs,sendReaction:d(\"MAWDebugSendReaction\").sendReaction})}g.getAllDebugFunctions=a}),98);\n__d(\"MAWRestoreDbBackwardMigration\",[\"I64\",\"MAWCurrentUser\",\"MAWDbSchema.restore\",\"MAWExceededStorageQuota\",\"MAWIndexedDb\",\"MAWIndexedDbMetadata\",\"MAWQplProxy\",\"MAWReStoreMigrationUtils\",\"MAWRestoreDbState\",\"MAWRestoreSchemaIndexedDB\",\"MAWTransactionMode\",\"MWEARKeychainV3\",\"Promise\",\"ReQL\",\"WATagsLogger\",\"asyncToGeneratorRuntime\",\"gkx\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Armadillo DB to ReStore migration error: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Database cleanup done.\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Migration complete, adding meta to prevent future migrations.\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Starting backwards migration to dexie\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Old database purged\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Purging old database\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Checking if we need to migrate the database: \",\"\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Already migrated to Dexie\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No ReStore database to migrate\"]);r=function(){return a};return a}var s=d(\"WATagsLogger\").TAGS([\"DBInit\",\"Migration\",\"Revert\"]);function t(){return(i||(i=b(\"Promise\"))).resolve(d(\"MAWRestoreSchemaIndexedDB\").createDB())}function u(a,b){return v.apply(this,arguments)}function v(){v=babelHelpers.wrapAsyncGenerator(function*(a,b){a=a.iterator(new WeakMap());var c=[],d=(yield babelHelpers.awaitAsyncGenerator(a.next()));while(!d.done){var e=d.value;e[0];e=e[1];c.push(e);c.length===b&&(yield c,c=[]);d=(yield babelHelpers.awaitAsyncGenerator(a.next()))}c.length&&(yield c)});return v.apply(this,arguments)}function w(a){return function(b){var c;return babelHelpers[\"extends\"]({},b,(c={},c[a]=(h||(h=d(\"I64\"))).to_int32(b[a]),c))}}function x(){if(c(\"gkx\")(\"1159\")&&d(\"MAWRestoreDbState\").getTargetDbState()===\"dexie\")return!0;if(c(\"gkx\")(\"1159\")&&d(\"MAWRestoreDbState\").getTargetDbState()===\"restore\")return!1;return c(\"gkx\")(\"23906\")?!1:c(\"gkx\")(\"23907\")}function a(){return y.apply(this,arguments)}function y(){y=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=d(\"MAWCurrentUser\").getID(),e=d(\"MAWIndexedDbMetadata\").restoreDbName2(a);a=d(\"MAWIndexedDbMetadata\").dbName(a);if(!x())return!1;e=(yield d(\"MAWReStoreMigrationUtils\").getDBForMigration(e));if(e==null){s.LOG(r());return!0}e=d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(1056837640,\"750\"));try{e.addPoint(\"get_restore_db_start\");var f=(yield t());e.addPoint(\"get_restore_db_end\");var g=(yield f.table(\"e2ee_appMeta\").get(\"restoreToDexieMigrationComplete\"));if((g==null?void 0:g.value.restoreToDexieMigrationComplete)===!0){s.LOG(q());d(\"MAWRestoreSchemaIndexedDB\").closeDB();return!0}s.LOG(p(),f!=null);g=(yield d(\"MAWReStoreMigrationUtils\").getDBForMigration(a));g!=null&&(e.addPoint(\"purge_old_dexie_db_start\"),s.LOG(o()),g.close(),yield d(\"MAWReStoreMigrationUtils\").deleteDB(a),s.LOG(n()),e.addPoint(\"purge_old_dexie_db_end\"));s.LOG(m());e.addPoint(\"create_dexie_db_start\");yield d(\"MAWIndexedDb\").makeDB(d(\"MWEARKeychainV3\").getDbEncryptionKey,{enableDataSyncMiddleware:!1,shimEnabled:!1});e.addPoint(\"create_dexie_db_end\");var h=d(\"MAWIndexedDb\").getDBExn();g=d(\"MAWDbSchema.restore\").clientSchema.map(function(a){return a.name}).filter(function(a){return a.includes(\"e2ee_\")});var v=new Map(d(\"MAWDbSchema.restore\").clientSchema.map(function(a){return[a.name,a]}));e.addPoint(\"migration_start\");yield (i||(i=b(\"Promise\"))).all(g.map(function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b,c=a.replace(\"e2ee_\",\"\"),e=v.get(a);b=(b=e==null?void 0:e.primary_key)!=null?b:[];var g=b[0];b=(b=e==null?void 0:e.auto_increment)!=null?b:!1;var i=h.stores[c],j=!0,k=!1,l;try{var m=function*(){var a=o,b=g!=null&&(e==null?void 0:e.auto_increment)===!0?a.map(w(g)):a;yield h.transact(d(\"MAWTransactionMode\").READWRITE,[c],function(){return i.bulkPut(b).then(function(){})});f.clearCacheIfSupported==null?void 0:f.clearCacheIfSupported()};for(var n=babelHelpers.asyncIterator(u(d(\"ReQL\").fromTableAscending(f.table(a)),100)),a,o;a=(yield n.next()),j=a.done,o=(yield a.value),!j;j=!0)yield* m()}catch(a){k=!0,l=a}finally{try{!j&&n[\"return\"]!=null&&(yield n[\"return\"]())}finally{if(k)throw l}}b&&g!=null});return function(b){return a.apply(this,arguments)}}()));e.addPoint(\"migration_end\");s.LOG(l());yield f.runInTransaction(function(a){return a.e2ee_appMeta.put({key:\"restoreToDexieMigrationComplete\",value:{restoreToDexieMigrationComplete:!0}})},\"readwrite\");d(\"MAWRestoreSchemaIndexedDB\").closeDB();e.endSuccess();s.LOG(k());return!0}catch(a){yield d(\"MAWIndexedDb\").closeDB();s.ERROR(j(),a);d(\"MAWExceededStorageQuota\").checkQuotaExceededError(a);e.endFail(a);return!1}});return y.apply(this,arguments)}g.migrateToDexieFromRestore=a}),98);\n__d(\"MAWFTSIndexedDb\",[\"Deferred\",\"FBLogger\",\"MAWCurrentUser\",\"MAWDexieTable\",\"MAWErrorObject\",\"MAWIDbSetupQpl\",\"MAWIDbSetupQplEventListener\",\"MAWIndexedDBDeletion\",\"MAWIndexedDbMetadata\",\"MAWTransactionMode\",\"Promise\",\"WALogger\",\"WATagsLogger\",\"asyncToGeneratorRuntime\",\"err\",\"promiseDone\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"DB setup complete, marking as ready\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"DB Open blocked\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Starting DB Setup\"]);k=function(){return a};return a}var l=null,m=null,n=new(c(\"Deferred\"))(),o=!1,p=d(\"WATagsLogger\").TAGS([\"DBInit\",\"DbSetup\"]);function q(){n=null,o=!1}function a(){var a=d(\"MAWCurrentUser\").getID();if(l!=null)return(h||(h=b(\"Promise\"))).resolve();if(o){var e;return((e=n)==null?void 0:e.getPromise())||(h||(h=b(\"Promise\"))).reject(\"error-setting-up-fts\")}p.LOG(k());o=!0;n=(e=n)!=null?e:new(c(\"Deferred\"))();d(\"MAWIDbSetupQplEventListener\").trackDbSetupFailure(c(\"MAWIDbSetupQpl\"),function(){var a;(a=n)==null?void 0:a.reject();q()});m=d(\"MAWIndexedDbMetadata\").ftsDbName(a);l=new(d(\"MAWDexieTable\").DexieTable)(m,function(a){a.version(1).stores({ftsBackloggedMessages:\"rowId\",ftsEncryptionMeta:\"key\",ftsIndexV3:\"++ftsRowId,id,chatId,*prefixes\"}),a.version(2).stores({ftsManifest:\"key\"}),a.on(\"blocked\",function(){p.ERROR(j())}),a.on(\"ready\",function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){p.LOG(i());if(a==null){d(\"WALogger\").ERROR([\"DB is null\"]);(a=n)==null?void 0:a.reject();q();return}(a=n)==null?void 0:a.resolve();q()});return function(b){return a.apply(this,arguments)}}())},!0,{});return((e=n)==null?void 0:e.getPromise())||(h||(h=b(\"Promise\"))).reject(\"error-setting-up-fts\")}function r(){if(l==null)throw c(\"err\")(\"IndexDB has not been initialized before executing transactor\");return l}function s(){if(l!=null&&!o)return(h||(h=b(\"Promise\"))).resolve(l);n=n||new(c(\"Deferred\"))();return n.getPromise().then(function(){return r()})}function e(){return t.apply(this,arguments)}function t(){t=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=(yield s());a!=null&&(a.close(),l=null)});return t.apply(this,arguments)}function f(a){l=a,q()}function u(){l!=null&&(l.close(),l=null)}function v(a){u();var b=m;b===null&&a!=null&&(b=d(\"MAWIndexedDbMetadata\").dbName(a));c(\"promiseDone\")(d(\"MAWIndexedDBDeletion\").deleteDB(b,\"maw\"))}function w(a){var b=c(\"FBLogger\")(\"messenger_e2ee_web\");if(a)return b.catching(a);else return b}function x(a,b){var c=Object.keys(a),e=c.some(function(b){return a[b]===d(\"MAWTransactionMode\").READWRITE})?d(\"MAWTransactionMode\").READWRITE:d(\"MAWTransactionMode\").READONLY;return function(){for(var a=arguments.length,f=new Array(a),g=0;g<a;g++)f[g]=arguments[g];return s().then(function(a){return a.transact(e,c,function(){return b(a.stores).apply(void 0,f)[\"catch\"](function(a){a=d(\"MAWErrorObject\").getErrorObject(a);throw w(a).mustfixThrow(\"Error performing FTS transaction\")})})})[\"catch\"](function(a){a=d(\"MAWErrorObject\").getErrorObject(a);throw w(a).mustfixThrow(\"Error performing FTS transaction\")})}}g.makeFTSDB=a;g.getDBExn=r;g.getDB=s;g.closeDB_INTERNAL_USE_ONLY=e;g.setDB_INTERNAL_USE_ONLY=f;g.closeDb=u;g.deleteDb=v;g.makeMsgrFTSTransactor=x}),98);\n__d(\"MAWMessageIndexerFtsIndexTableAdapter\",[\"FBLogger\",\"MAWDexieTable\",\"MAWFTSIndexedDb\",\"MAWTransactionMode\",\"asyncToGeneratorRuntime\",\"nullthrows\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=function(a){var b=new Map();for(a of a){var c=a.ftsRowId;if(typeof c!==\"number\")continue;if(b.has(c))continue;b.set(c,a)}return Array.from(b.values())},i=function(a,b){return a.ftsIndexV3.bulkPut(b).then(function(){})},j=function(a,b,c){return b==null?d(\"MAWDexieTable\").dexieResolve():a.ftsIndexV3.update(b,c).then(function(){})},k=function(a,b){return a.ftsIndexV3.bulkGet(b.filter(Boolean))},l=function(a,b,e){if(b.length!==1){c(\"FBLogger\")(\"maw_fts\").mustfix(\"indexNames should have exactly one element\");return d(\"MAWDexieTable\").dexieResolve([])}if(e.length===0){c(\"FBLogger\")(\"maw_fts\").mustfix(\"indexValues should have at least one element\");return d(\"MAWDexieTable\").dexieResolve([])}b=b[0];a=a.ftsIndexV3.where(b).equals(e[0]);for(var f=1;f<e.length;++f)a=a.or(b).equals(e[f]);return a.toArray().then(h)};function m(a){a=new Uint8Array(a.slice(0));for(var b=a.length-1;b>=0;--b){if(a[b]!==255){a[b]+=1;return a.buffer}a[b]=0}b=new Uint8Array(a.length+1);b[0]=1;for(var c=1;c<=a.length;++c)b[c]=255;return b.buffer}var n=function(a,b,e){if(b.length!==1){c(\"FBLogger\")(\"maw_fts\").mustfix(\"indexNames should have exactly one element\");return d(\"MAWDexieTable\").dexieResolve([])}if(e.length===0){c(\"FBLogger\")(\"maw_fts\").mustfix(\"indexValues should have at least one element\");return d(\"MAWDexieTable\").dexieResolve([])}b=b[0];var f=e[0];if(typeof f===\"string\"){var g=a.ftsIndexV3.where(b).startswith(f);for(var i=1;i<e.length;++i){var j=e[i];g=g.or(b).startsWith(j)}return g.toArray()}if(!(f instanceof ArrayBuffer)){c(\"FBLogger\")(\"maw_fts\").mustfix(\"Expecting an array buffer or a string type for indexValues\");return d(\"MAWDexieTable\").dexieResolve([])}j=m(f);i=a.ftsIndexV3.where(b).between(f,j,!0,!1);for(g=1;g<e.length;++g){a=e[g];if(!(a instanceof ArrayBuffer)){c(\"FBLogger\")(\"maw_fts\").mustfix(\"Expecting an array buffer or a string type for indexValues\");return d(\"MAWDexieTable\").dexieResolve([])}f=m(a);i=i.or(b).between(a,f,!0,!1)}return i.toArray().then(h)},o=function(a,b,c,d,e){return a.ftsIndexV3.where(b[0]).between(c,d,(a=e==null?void 0:e.lowerInclusive)!=null?a:!0,(b=e==null?void 0:e.upperInclusive)!=null?b:!1).toArray().then(h)},p=function(a,b,c){return a.ftsIndexV3.where(b[0]).equals(c[0]).primaryKeys().then(function(b){return a.ftsIndexV3.bulkDelete(b)})},q=function(a){return a.ftsIndexV3.clear()};a=function(){function a(a){this.$1=null,this.$2=a}var e=a.prototype;e.$3=function(){return c(\"nullthrows\")(this.$1)};e.transact=function(a){var b=this;a=a;var c=a;return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsIndexV3:d(\"MAWTransactionMode\").READWRITE},function(a){return function(){b.$1=a;return c()[\"finally\"](function(){b.$1=null})}})()};e.bulkPut=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(this.$1!=null){yield i(this.$3(),a);return}return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsIndexV3:d(\"MAWTransactionMode\").READWRITE},function(b){return function(){return i(b,a)}})()});function c(b){return a.apply(this,arguments)}return c}();e.merge=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){if(this.$1!=null){yield j(this.$3(),a,b);return}return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsIndexV3:d(\"MAWTransactionMode\").READWRITE},function(c){return function(){return j(c,a,b)}})()});function c(b,c){return a.apply(this,arguments)}return c}();e.bulkCreate=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(this.$1!=null){yield i(this.$3(),a);return}return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsIndexV3:d(\"MAWTransactionMode\").READWRITE},function(b){return function(){return i(b,a)}})()});function c(b){return a.apply(this,arguments)}return c}();e.bulkGetByKey=function(a){return this.$1!=null?d(\"MAWDexieTable\").undexify(k(this.$3(),a)):d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsIndexV3:d(\"MAWTransactionMode\").READWRITE},function(b){return function(){return k(b,a)}})()};e.bulkGetAnyOf=function(a,b){return this.$1!=null?d(\"MAWDexieTable\").undexify(l(this.$3(),a,b)):d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsIndexV3:d(\"MAWTransactionMode\").READWRITE},function(c){return function(){return l(c,a,b)}})()};e.bulkGetStartsWithAnyOf=function(a,b){return this.$1!=null?d(\"MAWDexieTable\").undexify(n(this.$3(),a,b)):d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsIndexV3:d(\"MAWTransactionMode\").READWRITE},function(c){return function(){return n(c,a,b)}})()};e.between=function(a,b,c,e){return this.$1!=null?d(\"MAWDexieTable\").undexify(o(this.$3(),a,b,c,e)):d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsIndexV3:d(\"MAWTransactionMode\").READWRITE},function(d){return function(){return o(d,a,b,c,e)}})()};e.bulkRemoveByIndex=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){if(this.$1!=null){yield p(this.$3(),a,b);return}return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsIndexV3:d(\"MAWTransactionMode\").READWRITE},function(c){return function(){return p(c,a,b)}})()});function c(b,c){return a.apply(this,arguments)}return c}();e.erase=function(){return this.$1!=null?d(\"MAWDexieTable\").undexify(q(this.$3())):d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsIndexV3:d(\"MAWTransactionMode\").READWRITE},function(a){return function(){return q(a)}})()};e.getKey=function(){return this.$2};return a}();g[\"default\"]=a}),98);\n__d(\"getDexieCollectionFromRetrievalOptions\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a,b){var c=b==null?void 0:b.offset;b=b==null?void 0:b.limit;a=a;c!=null&&(a=a.offset(c));b!=null&&(a=a.limit(b));return a}f[\"default\"]=a}),66);\n__d(\"MAWMessageIndexerMessageSource\",[\"MAWFTSIndexedDb\",\"MAWIndexedDb\",\"MAWMsgType\",\"MAWTransactionMode\",\"MAWVault\",\"asyncToGeneratorRuntime\",\"getDexieCollectionFromRetrievalOptions\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a){return d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"_getMessagesForRowIds\",function(b){return function(){return b.messages.bulkGet(a)}})()}function i(a){return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsBackloggedMessages:d(\"MAWTransactionMode\").READWRITE},function(b){return function(){return c(\"getDexieCollectionFromRetrievalOptions\")(b.ftsBackloggedMessages.toCollection(),a).toArray()}})().then(function(a){a=a.map(function(a){a=a.rowId;return a});return h(a)})}function j(){return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsBackloggedMessages:d(\"MAWTransactionMode\").READONLY},function(a){return function(){return a.ftsBackloggedMessages.count().then(function(a){return a>0})}})()}function k(a){return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsBackloggedMessages:d(\"MAWTransactionMode\").READWRITE},function(b){return function(){return b.ftsBackloggedMessages.bulkDelete(a)}})()}function l(a,b){return d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"getMessagesAfterId\",function(d){return function(){return c(\"getDexieCollectionFromRetrievalOptions\")(d.messages.where(\"rowId\").above(a),b).toArray()}})()}function m(a){return d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"getAllMessages\",function(b){return function(){return c(\"getDexieCollectionFromRetrievalOptions\")(b.messages.toCollection(),a).toArray()}})()}function n(){return d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"getSize\",function(a){return function(){return a.messages.count()}})()}function o(a){if(a==null||a.type!==d(\"MAWMsgType\").MSG_TYPE.TEXT)return null;var b=a.msgContent,c=a.rowId,e=a.thread;a=a.ts;b=b.content;return{chatId:e.toString(),id:c.toString(),textFragments:[d(\"MAWVault\").unvault(b)],timestamp:a}}a=function(){function a(){}var c=a.prototype;c.getBacklogged=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=(yield i(a));a=a.map(o).filter(Boolean);return a.length===0?null:a});function c(b){return a.apply(this,arguments)}return c}();c.hasBacklogged=function(){return j()};c.removeFromBacklog=function(a){return k(a.map(function(a){return Number(a)}))};c.getAllAfterId=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){if(a===\"\")return this.getAll(b);a=(yield l(Number(a),b));return a.map(o).filter(Boolean)});function c(b,c){return a.apply(this,arguments)}return c}();c.getAll=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=(yield m(a));return a.map(o).filter(Boolean)});function c(b){return a.apply(this,arguments)}return c}();c.size=function(){return n()};return a}();g[\"default\"]=a}),98);\n__d(\"MAWMessageSearchFTSKeyUtil\",[\"MAWCryptoConsts\",\"MAWFTSIndexedDb\",\"MAWKeychainCrypto\",\"MAWSubtleCrypto\",\"MAWTransactionMode\",\"WABase64\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=function(a){return a.ftsEncryptionMeta.toCollection().first()},i=function(){return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsEncryptionMeta:d(\"MAWTransactionMode\").READONLY},function(a){return function(){return h(a)}})()};function j(a){return d(\"MAWSubtleCrypto\").MAWSubtleCrypto.importKey(\"raw\",d(\"WABase64\").decodeB64(a.key),{name:d(\"MAWCryptoConsts\").HKDF},!1,[\"deriveKey\"])}var k=function(a){return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsEncryptionMeta:d(\"MAWTransactionMode\").READWRITE},function(b){return function(){return h(b).then(function(c){if(c!=null)return c;var d={key:a};return b.ftsEncryptionMeta.add(d).then(function(){return d})})}})()};function l(){var a=new Uint8Array(128);self.crypto.getRandomValues(a);return k(d(\"WABase64\").encodeB64(a.buffer))}function a(){return m.apply(this,arguments)}function m(){m=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=(yield i());a=(a=a)!=null?a:yield l();a=(yield j(a));return d(\"MAWSubtleCrypto\").MAWSubtleCrypto.deriveKey({hash:d(\"MAWCryptoConsts\").SHA256,info:new Uint8Array(0),name:d(\"MAWCryptoConsts\").HKDF,salt:d(\"MAWKeychainCrypto\").getAccountKeyBuffer()},a,{hash:d(\"MAWCryptoConsts\").SHA256,name:\"HMAC\"},!1,[\"sign\"])});return m.apply(this,arguments)}g.fetchOrGenerateFTSCryptoKey=a}),98);\n__d(\"WAFtsTokenizerBaseNormalizer\",[],(function(a,b,c,d,e,f){\"use strict\";a=function(){function a(a){var b=this,c=[];this.$1=new Map();a.forEach(function(a){var d=a[0];a=a[1];b.$1.set(d,a);c.push(d)});this.$2=new RegExp(c.join(\"|\"),\"g\")}var b=a.prototype;b.normalize=function(a){var b=this;a===void 0&&(a=\"\");return a.replace(this.$2,function(a){var c=b.$1.get(a);return c!=null?c:a})};return a}();f[\"default\"]=a}),66);\n__d(\"WAFtsTokenizerPostLowercaseNormalizer\",[\"WAFtsTokenizerBaseNormalizer\"],(function(a,b,c,d,e,f,g){\"use strict\";a=[[\"\\u0131\",\"i\"],[\"\\u0629\",\"\\u0647\"],[\"\\u0640\",\"\"],[\"\\u0649\",\"\\u064a\"],[\"\\u0671\",\"\\u0627\"],[\"\\u06a4\",\"\\u0641\"],[\"\\u06a9\",\"\\u0643\"],[\"\\u06ba\",\"\\u0646\"],[\"\\u06be\",\"\\u0647\"],[\"\\u06c3\",\"\\u06c2\"],[\"\\u06cc\",\"\\u064a\"],[\"\\u06d2\",\"\\u064a\"],[\"\\u06d5\",\"\\u0647\"],[\"\\u06f0\",\"\\u0660\"],[\"\\u06f1\",\"\\u0661\"],[\"\\u06f2\",\"\\u0662\"],[\"\\u06f3\",\"\\u0663\"],[\"\\u06f4\",\"\\u0664\"],[\"\\u06f5\",\"\\u0665\"],[\"\\u06f6\",\"\\u0666\"],[\"\\u06f7\",\"\\u0667\"],[\"\\u06f8\",\"\\u0668\"],[\"\\u06f9\",\"\\u0669\"],[\"\\u08bb\",\"\\u0641\"],[\"\\u08bc\",\"\\u0642\"],[\"\\u08bd\",\"\\u0646\"],[\"\\u200c\",\"\"],[\"\\u0966\",\"0\"],[\"\\u0967\",\"1\"],[\"\\u0968\",\"2\"],[\"\\u0969\",\"3\"],[\"\\u096a\",\"4\"],[\"\\u096b\",\"5\"],[\"\\u096c\",\"6\"],[\"\\u096d\",\"7\"],[\"\\u096e\",\"8\"],[\"\\u096f\",\"9\"],[\"\\u0901\",\"\\u0902\"],[\"\\u0903\",\"\"],[\"\\u093c\",\"\"],[\"\\u09e6\",\"0\"],[\"\\u09e7\",\"1\"],[\"\\u09e8\",\"2\"],[\"\\u09e9\",\"3\"],[\"\\u09ea\",\"4\"],[\"\\u09eb\",\"5\"],[\"\\u09ec\",\"6\"],[\"\\u09ed\",\"7\"],[\"\\u09ee\",\"8\"],[\"\\u09ef\",\"9\"],[\"\\u0a66\",\"0\"],[\"\\u0a67\",\"1\"],[\"\\u0a68\",\"2\"],[\"\\u0a69\",\"3\"],[\"\\u0a6a\",\"4\"],[\"\\u0a6b\",\"5\"],[\"\\u0a6c\",\"6\"],[\"\\u0a6d\",\"7\"],[\"\\u0a6e\",\"8\"],[\"\\u0a6f\",\"9\"],[\"\\u0c66\",\"0\"],[\"\\u0c67\",\"1\"],[\"\\u0c68\",\"2\"],[\"\\u0c69\",\"3\"],[\"\\u0c6a\",\"4\"],[\"\\u0c6b\",\"5\"],[\"\\u0c6c\",\"6\"],[\"\\u0c6d\",\"7\"],[\"\\u0c6e\",\"8\"],[\"\\u0c6f\",\"9\"],[\"\\u0ae6\",\"0\"],[\"\\u0ae7\",\"1\"],[\"\\u0ae8\",\"2\"],[\"\\u0ae9\",\"3\"],[\"\\u0aea\",\"4\"],[\"\\u0aeb\",\"5\"],[\"\\u0aec\",\"6\"],[\"\\u0aed\",\"7\"],[\"\\u0aee\",\"8\"],[\"\\u0aef\",\"9\"],[\"\\u0ce6\",\"0\"],[\"\\u0ce7\",\"1\"],[\"\\u0ce8\",\"2\"],[\"\\u0ce9\",\"3\"],[\"\\u0cea\",\"4\"],[\"\\u0ceb\",\"5\"],[\"\\u0cec\",\"6\"],[\"\\u0ced\",\"7\"],[\"\\u0cee\",\"8\"],[\"\\u0cef\",\"9\"],[\"\\u0d66\",\"0\"],[\"\\u0d67\",\"1\"],[\"\\u0d68\",\"2\"],[\"\\u0d69\",\"3\"],[\"\\u0d6a\",\"4\"],[\"\\u0d6b\",\"5\"],[\"\\u0d6c\",\"6\"],[\"\\u0d6d\",\"7\"],[\"\\u0d6e\",\"8\"],[\"\\u0d6f\",\"9\"],[\"\\u0142\",\"l\"]];b=new(c(\"WAFtsTokenizerBaseNormalizer\"))(a);d=b;g[\"default\"]=d}),98);\n__d(\"WAFtsTokenizerPreNFKDNormalizer\",[\"WAFtsTokenizerBaseNormalizer\"],(function(a,b,c,d,e,f,g){\"use strict\";a=[[\"\\u0675\",\"\\u0674\\u0627\"],[\"\\u0676\",\"\\u0674\\u0648\"],[\"\\u0677\",\"\\u0674\\u06c7\"],[\"\\u0678\",\"\\u0674\\u0649\"],[\"\\u0905\\u0946\",\"\\u0904\"],[\"\\u0905\\u093e\",\"\\u0906\"],[\"\\u0930\\u094d\\u0907\",\"\\u0908\"],[\"\\u0909\\u0941\",\"\\u090a\"],[\"\\u090f\\u0945\",\"\\u090d\"],[\"\\u090f\\u0946\",\"\\u090e\"],[\"\\u090f\\u0947\",\"\\u0910\"],[\"\\u0905\\u0949\",\"\\u0911\"],[\"\\u0906\\u0945\",\"\\u0911\"],[\"\\u0905\\u094a\",\"\\u0912\"],[\"\\u0906\\u0946\",\"\\u0912\"],[\"\\u0905\\u094b\",\"\\u0913\"],[\"\\u0906\\u0947\",\"\\u0913\"],[\"\\u0905\\u094c\",\"\\u0914\"],[\"\\u0906\\u0948\",\"\\u0914\"],[\"\\u0905\\u0945\",\"\\u0972\"],[\"\\u0905\\u093a\",\"\\u0973\"],[\"\\u0905\\u093b\",\"\\u0974\"],[\"\\u0906\\u093a\",\"\\u0974\"],[\"\\u0905\\u094f\",\"\\u0975\"],[\"\\u0905\\u0956\",\"\\u0976\"],[\"\\u0905\\u0957\",\"\\u0977\"],[\"\\u0985\\u09be\",\"\\u0986\"],[\"\\u098b\\u09c3\",\"\\u09e0\"],[\"\\u098c\\u09e2\",\"\\u09e1\"],[\"\\u0a05\\u0a3e\",\"\\u0a06\"],[\"\\u0a72\\u0a3f\",\"\\u0a07\"],[\"\\u0a72\\u0a40\",\"\\u0a08\"],[\"\\u0a73\\u0a41\",\"\\u0a09\"],[\"\\u0a73\\u0a42\",\"\\u0a0a\"],[\"\\u0a72\\u0a47\",\"\\u0a0f\"],[\"\\u0a05\\u0a48\",\"\\u0a10\"],[\"\\u0a73\\u0a4b\",\"\\u0a13\"],[\"\\u0a05\\u0a4c\",\"\\u0a14\"],[\"\\u0a85\\u0abe\",\"\\u0a86\"],[\"\\u0a85\\u0ac5\",\"\\u0a8d\"],[\"\\u0a85\\u0ac7\",\"\\u0a8f\"],[\"\\u0a85\\u0ac8\",\"\\u0a90\"],[\"\\u0a85\\u0ac9\",\"\\u0a91\"],[\"\\u0a85\\u0acb\",\"\\u0a93\"],[\"\\u0a85\\u0abe\\u0ac5\",\"\\u0a93\"],[\"\\u0a85\\u0acc\",\"\\u0a94\"],[\"\\u0a85\\u0abe\\u0ac8\",\"\\u0a94\"],[\"\\u0ac5\\u0abe\",\"\\u0ac9\"],[\"\\u0b05\\u0b3e\",\"\\u0b06\"],[\"\\u0b0f\\u0b57\",\"\\u0b10\"],[\"\\u0b13\\u0b57\",\"\\u0b14\"],[\"\\u0bb8\\u0bcd\\u0bb0\\u0bc0\",\"\\u0bb6\\u0bcd\\u0bb0\\u0bc0\"],[\"\\u0c12\\u0c55\",\"\\u0c13\"],[\"\\u0c12\\u0c4c\",\"\\u0c14\"],[\"\\u0c3f\\u0c55\",\"\\u0c40\"],[\"\\u0c46\\u0c55\",\"\\u0c47\"],[\"\\u0c4a\\u0c55\",\"\\u0c4b\"],[\"\\u0c89\\u0cbe\",\"\\u0c8a\"],[\"\\u0c92\\u0ccc\",\"\\u0c94\"],[\"\\u0c8b\\u0cbe\",\"\\u0ce0\"],[\"\\u0d07\\u0d57\",\"\\u0d08\"],[\"\\u0d09\\u0d57\",\"\\u0d0a\"],[\"\\u0d0e\\u0d46\",\"\\u0d10\"],[\"\\u0d12\\u0d3e\",\"\\u0d13\"],[\"\\u0d12\\u0d57\",\"\\u0d14\"],[\"\\u0d23\\u0d4d\\u200d\",\"\\u0d7a\"],[\"\\u0d28\\u0d4d\\u200d\",\"\\u0d7b\"],[\"\\u0d30\\u0d4d\\u200d\",\"\\u0d7c\"],[\"\\u0d32\\u0d4d\\u200d\",\"\\u0d7d\"],[\"\\u0d33\\u0d4d\\u200d\",\"\\u0d7e\"],[\"\\u0d85\\u0dcf\",\"\\u0d86\"],[\"\\u0d85\\u0dd0\",\"\\u0d87\"],[\"\\u0d85\\u0dd1\",\"\\u0d88\"],[\"\\u0d8b\\u0ddf\",\"\\u0d8c\"],[\"\\u0d8d\\u0dd8\",\"\\u0d8e\"],[\"\\u0d8f\\u0ddf\",\"\\u0d90\"],[\"\\u0d91\\u0dca\",\"\\u0d92\"],[\"\\u0d91\\u0dd9\",\"\\u0d93\"],[\"\\u0d94\\u0ddf\",\"\\u0d96\"]];b=new(c(\"WAFtsTokenizerBaseNormalizer\"))(a);d=b;g[\"default\"]=d}),98);\n__d(\"WAFtsTokenizerNormalizers\",[\"WAFtsTokenizerPostLowercaseNormalizer\",\"WAFtsTokenizerPreNFKDNormalizer\"],(function(a,b,c,d,e,f){\"use strict\";f.preNFKDNormalizer=importDefault(\"WAFtsTokenizerPreNFKDNormalizer\"),f.postLowerCaseNormalizer=importDefault(\"WAFtsTokenizerPostLowercaseNormalizer\")}),66);\n__d(\"WAFtsMultiLangTokenizer\",[\"WAFtsTokenizerNormalizers\"],(function(a,b,c,d,e,f,g){\"use strict\";var h={NFC_CHARACTER:\/(?!(?:[0-9\\xB2\\xB3\\xB9\\xBC-\\xBE\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u09F4-\\u09F9\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0B72-\\u0B77\\u0BE6-\\u0BF2\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0CE6-\\u0CEF\\u0D58-\\u0D5E\\u0D66-\\u0D78\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F33\\u1040-\\u1049\\u1090-\\u1099\\u1369-\\u137C\\u16EE-\\u16F0\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19DA\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u2182\\u2185-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2CFD\\u3007\\u3021-\\u3029\\u3038-\\u303A\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\uA620-\\uA629\\uA6E6-\\uA6EF\\uA830-\\uA835\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19]|\\uD800[\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDEE1-\\uDEFB\\uDF20-\\uDF23\\uDF41\\uDF4A\\uDFD1-\\uDFD5]|\\uD801[\\uDCA0-\\uDCA9]|\\uD802[\\uDC58-\\uDC5F\\uDC79-\\uDC7F\\uDCA7-\\uDCAF\\uDCFB-\\uDCFF\\uDD16-\\uDD1B\\uDDBC\\uDDBD\\uDDC0-\\uDDCF\\uDDD2-\\uDDFF\\uDE40-\\uDE48\\uDE7D\\uDE7E\\uDE9D-\\uDE9F\\uDEEB-\\uDEEF\\uDF58-\\uDF5F\\uDF78-\\uDF7F\\uDFA9-\\uDFAF]|\\uD803[\\uDCFA-\\uDCFF\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDF1D-\\uDF26\\uDF51-\\uDF54\\uDFC5-\\uDFCB]|\\uD804[\\uDC52-\\uDC6F\\uDCF0-\\uDCF9\\uDD36-\\uDD3F\\uDDD0-\\uDDD9\\uDDE1-\\uDDF4\\uDEF0-\\uDEF9]|\\uD805[\\uDC50-\\uDC59\\uDCD0-\\uDCD9\\uDE50-\\uDE59\\uDEC0-\\uDEC9\\uDF30-\\uDF3B]|\\uD806[\\uDCE0-\\uDCF2\\uDD50-\\uDD59]|\\uD807[\\uDC50-\\uDC6C\\uDD50-\\uDD59\\uDDA0-\\uDDA9\\uDFC0-\\uDFD4]|\\uD809[\\uDC00-\\uDC6E]|\\uD81A[\\uDE60-\\uDE69\\uDF50-\\uDF59\\uDF5B-\\uDF61]|\\uD81B[\\uDE80-\\uDE96]|\\uD834[\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDFCE-\\uDFFF]|\\uD838[\\uDD40-\\uDD49\\uDEF0-\\uDEF9]|\\uD83A[\\uDCC7-\\uDCCF\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]))(?:[#\\*0-9\\xA9\\xAE\\u203C\\u2049\\u2122\\u2139\\u2194-\\u2199\\u21A9\\u21AA\\u231A\\u231B\\u2328\\u23CF\\u23E9-\\u23F3\\u23F8-\\u23FA\\u24C2\\u25AA\\u25AB\\u25B6\\u25C0\\u25FB-\\u25FE\\u2600-\\u2604\\u260E\\u2611\\u2614\\u2615\\u2618\\u261D\\u2620\\u2622\\u2623\\u2626\\u262A\\u262E\\u262F\\u2638-\\u263A\\u2640\\u2642\\u2648-\\u2653\\u265F\\u2660\\u2663\\u2665\\u2666\\u2668\\u267B\\u267E\\u267F\\u2692-\\u2697\\u2699\\u269B\\u269C\\u26A0\\u26A1\\u26A7\\u26AA\\u26AB\\u26B0\\u26B1\\u26BD\\u26BE\\u26C4\\u26C5\\u26C8\\u26CE\\u26CF\\u26D1\\u26D3\\u26D4\\u26E9\\u26EA\\u26F0-\\u26F5\\u26F7-\\u26FA\\u26FD\\u2702\\u2705\\u2708-\\u270D\\u270F\\u2712\\u2714\\u2716\\u271D\\u2721\\u2728\\u2733\\u2734\\u2744\\u2747\\u274C\\u274E\\u2753-\\u2755\\u2757\\u2763\\u2764\\u2795-\\u2797\\u27A1\\u27B0\\u27BF\\u2934\\u2935\\u2B05-\\u2B07\\u2B1B\\u2B1C\\u2B50\\u2B55\\u2E80-\\u2E99\\u2E9B-\\u2EF3\\u2F00-\\u2FD5\\u3005\\u3007\\u3021-\\u3029\\u3030\\u3038-\\u303B\\u303D\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FD-\\u30FF\\u31F0-\\u31FF\\u3297\\u3299\\u32D0-\\u32FE\\u3300-\\u3357\\u3400-\\u4DBF\\u4E00-\\u9FFC\\uA000-\\uA48C\\uA490-\\uA4C6\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFF66-\\uFF6F\\uFF71-\\uFF9D]|\\uD81B[\\uDFF0\\uDFF1]|\\uD82C[\\uDC00-\\uDD1E\\uDD50-\\uDD52\\uDD64-\\uDD67]|\\uD83C[\\uDC04\\uDCCF\\uDD70\\uDD71\\uDD7E\\uDD7F\\uDD8E\\uDD91-\\uDD9A\\uDDE6-\\uDE02\\uDE1A\\uDE2F\\uDE32-\\uDE3A\\uDE50\\uDE51\\uDF00-\\uDF21\\uDF24-\\uDF93\\uDF96\\uDF97\\uDF99-\\uDF9B\\uDF9E-\\uDFF0\\uDFF3-\\uDFF5\\uDFF7-\\uDFFF]|\\uD83D[\\uDC00-\\uDCFD\\uDCFF-\\uDD3D\\uDD49-\\uDD4E\\uDD50-\\uDD67\\uDD6F\\uDD70\\uDD73-\\uDD7A\\uDD87\\uDD8A-\\uDD8D\\uDD90\\uDD95\\uDD96\\uDDA4\\uDDA5\\uDDA8\\uDDB1\\uDDB2\\uDDBC\\uDDC2-\\uDDC4\\uDDD1-\\uDDD3\\uDDDC-\\uDDDE\\uDDE1\\uDDE3\\uDDE8\\uDDEF\\uDDF3\\uDDFA-\\uDE4F\\uDE80-\\uDEC5\\uDECB-\\uDED2\\uDED5-\\uDED7\\uDEE0-\\uDEE5\\uDEE9\\uDEEB\\uDEEC\\uDEF0\\uDEF3-\\uDEFC\\uDFE0-\\uDFEB]|\\uD83E[\\uDD0C-\\uDD3A\\uDD3C-\\uDD45\\uDD47-\\uDD78\\uDD7A-\\uDDCB\\uDDCD-\\uDDFF\\uDE70-\\uDE74\\uDE78-\\uDE7A\\uDE80-\\uDE86\\uDE90-\\uDEA8\\uDEB0-\\uDEB6\\uDEC0-\\uDEC2\\uDED0-\\uDED6]|[\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879\\uD880-\\uD883][\\uDC00-\\uDFFF]|\\uD869[\\uDC00-\\uDEDD\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF34\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]|\\uD884[\\uDC00-\\uDF4A])\/g,NFC_WORD:\/((?!(?:[0-9\\xB2\\xB3\\xB9\\xBC-\\xBE\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u09F4-\\u09F9\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0B72-\\u0B77\\u0BE6-\\u0BF2\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0CE6-\\u0CEF\\u0D58-\\u0D5E\\u0D66-\\u0D78\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F33\\u1040-\\u1049\\u1090-\\u1099\\u1369-\\u137C\\u16EE-\\u16F0\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19DA\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u2182\\u2185-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2CFD\\u3007\\u3021-\\u3029\\u3038-\\u303A\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\uA620-\\uA629\\uA6E6-\\uA6EF\\uA830-\\uA835\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19]|\\uD800[\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDEE1-\\uDEFB\\uDF20-\\uDF23\\uDF41\\uDF4A\\uDFD1-\\uDFD5]|\\uD801[\\uDCA0-\\uDCA9]|\\uD802[\\uDC58-\\uDC5F\\uDC79-\\uDC7F\\uDCA7-\\uDCAF\\uDCFB-\\uDCFF\\uDD16-\\uDD1B\\uDDBC\\uDDBD\\uDDC0-\\uDDCF\\uDDD2-\\uDDFF\\uDE40-\\uDE48\\uDE7D\\uDE7E\\uDE9D-\\uDE9F\\uDEEB-\\uDEEF\\uDF58-\\uDF5F\\uDF78-\\uDF7F\\uDFA9-\\uDFAF]|\\uD803[\\uDCFA-\\uDCFF\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDF1D-\\uDF26\\uDF51-\\uDF54\\uDFC5-\\uDFCB]|\\uD804[\\uDC52-\\uDC6F\\uDCF0-\\uDCF9\\uDD36-\\uDD3F\\uDDD0-\\uDDD9\\uDDE1-\\uDDF4\\uDEF0-\\uDEF9]|\\uD805[\\uDC50-\\uDC59\\uDCD0-\\uDCD9\\uDE50-\\uDE59\\uDEC0-\\uDEC9\\uDF30-\\uDF3B]|\\uD806[\\uDCE0-\\uDCF2\\uDD50-\\uDD59]|\\uD807[\\uDC50-\\uDC6C\\uDD50-\\uDD59\\uDDA0-\\uDDA9\\uDFC0-\\uDFD4]|\\uD809[\\uDC00-\\uDC6E]|\\uD81A[\\uDE60-\\uDE69\\uDF50-\\uDF59\\uDF5B-\\uDF61]|\\uD81B[\\uDE80-\\uDE96]|\\uD834[\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDFCE-\\uDFFF]|\\uD838[\\uDD40-\\uDD49\\uDEF0-\\uDEF9]|\\uD83A[\\uDCC7-\\uDCCF\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]))[\\u1100-\\u11FF\\u302E\\u302F\\u3131-\\u318E\\u3200-\\u321E\\u3260-\\u327E\\uA960-\\uA97C\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uFFA0-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC])+|((?!(?:[0-9\\xB2\\xB3\\xB9\\xBC-\\xBE\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u09F4-\\u09F9\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0B72-\\u0B77\\u0BE6-\\u0BF2\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0CE6-\\u0CEF\\u0D58-\\u0D5E\\u0D66-\\u0D78\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F33\\u1040-\\u1049\\u1090-\\u1099\\u1369-\\u137C\\u16EE-\\u16F0\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19DA\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u2182\\u2185-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2CFD\\u3007\\u3021-\\u3029\\u3038-\\u303A\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\uA620-\\uA629\\uA6E6-\\uA6EF\\uA830-\\uA835\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19]|\\uD800[\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDEE1-\\uDEFB\\uDF20-\\uDF23\\uDF41\\uDF4A\\uDFD1-\\uDFD5]|\\uD801[\\uDCA0-\\uDCA9]|\\uD802[\\uDC58-\\uDC5F\\uDC79-\\uDC7F\\uDCA7-\\uDCAF\\uDCFB-\\uDCFF\\uDD16-\\uDD1B\\uDDBC\\uDDBD\\uDDC0-\\uDDCF\\uDDD2-\\uDDFF\\uDE40-\\uDE48\\uDE7D\\uDE7E\\uDE9D-\\uDE9F\\uDEEB-\\uDEEF\\uDF58-\\uDF5F\\uDF78-\\uDF7F\\uDFA9-\\uDFAF]|\\uD803[\\uDCFA-\\uDCFF\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDF1D-\\uDF26\\uDF51-\\uDF54\\uDFC5-\\uDFCB]|\\uD804[\\uDC52-\\uDC6F\\uDCF0-\\uDCF9\\uDD36-\\uDD3F\\uDDD0-\\uDDD9\\uDDE1-\\uDDF4\\uDEF0-\\uDEF9]|\\uD805[\\uDC50-\\uDC59\\uDCD0-\\uDCD9\\uDE50-\\uDE59\\uDEC0-\\uDEC9\\uDF30-\\uDF3B]|\\uD806[\\uDCE0-\\uDCF2\\uDD50-\\uDD59]|\\uD807[\\uDC50-\\uDC6C\\uDD50-\\uDD59\\uDDA0-\\uDDA9\\uDFC0-\\uDFD4]|\\uD809[\\uDC00-\\uDC6E]|\\uD81A[\\uDE60-\\uDE69\\uDF50-\\uDF59\\uDF5B-\\uDF61]|\\uD81B[\\uDE80-\\uDE96]|\\uD834[\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDFCE-\\uDFFF]|\\uD838[\\uDD40-\\uDD49\\uDEF0-\\uDEF9]|\\uD83A[\\uDCC7-\\uDCCF\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]))[\\u0E01-\\u0E3A\\u0E40-\\u0E5B])+|((?!(?:[0-9\\xB2\\xB3\\xB9\\xBC-\\xBE\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u09F4-\\u09F9\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0B72-\\u0B77\\u0BE6-\\u0BF2\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0CE6-\\u0CEF\\u0D58-\\u0D5E\\u0D66-\\u0D78\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F33\\u1040-\\u1049\\u1090-\\u1099\\u1369-\\u137C\\u16EE-\\u16F0\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19DA\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u2182\\u2185-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2CFD\\u3007\\u3021-\\u3029\\u3038-\\u303A\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\uA620-\\uA629\\uA6E6-\\uA6EF\\uA830-\\uA835\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19]|\\uD800[\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDEE1-\\uDEFB\\uDF20-\\uDF23\\uDF41\\uDF4A\\uDFD1-\\uDFD5]|\\uD801[\\uDCA0-\\uDCA9]|\\uD802[\\uDC58-\\uDC5F\\uDC79-\\uDC7F\\uDCA7-\\uDCAF\\uDCFB-\\uDCFF\\uDD16-\\uDD1B\\uDDBC\\uDDBD\\uDDC0-\\uDDCF\\uDDD2-\\uDDFF\\uDE40-\\uDE48\\uDE7D\\uDE7E\\uDE9D-\\uDE9F\\uDEEB-\\uDEEF\\uDF58-\\uDF5F\\uDF78-\\uDF7F\\uDFA9-\\uDFAF]|\\uD803[\\uDCFA-\\uDCFF\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDF1D-\\uDF26\\uDF51-\\uDF54\\uDFC5-\\uDFCB]|\\uD804[\\uDC52-\\uDC6F\\uDCF0-\\uDCF9\\uDD36-\\uDD3F\\uDDD0-\\uDDD9\\uDDE1-\\uDDF4\\uDEF0-\\uDEF9]|\\uD805[\\uDC50-\\uDC59\\uDCD0-\\uDCD9\\uDE50-\\uDE59\\uDEC0-\\uDEC9\\uDF30-\\uDF3B]|\\uD806[\\uDCE0-\\uDCF2\\uDD50-\\uDD59]|\\uD807[\\uDC50-\\uDC6C\\uDD50-\\uDD59\\uDDA0-\\uDDA9\\uDFC0-\\uDFD4]|\\uD809[\\uDC00-\\uDC6E]|\\uD81A[\\uDE60-\\uDE69\\uDF50-\\uDF59\\uDF5B-\\uDF61]|\\uD81B[\\uDE80-\\uDE96]|\\uD834[\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDFCE-\\uDFFF]|\\uD838[\\uDD40-\\uDD49\\uDEF0-\\uDEF9]|\\uD83A[\\uDCC7-\\uDCCF\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]))[\\u0E81\\u0E82\\u0E84\\u0E86-\\u0E8A\\u0E8C-\\u0EA3\\u0EA5\\u0EA7-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF])+|((?!(?:[0-9\\xB2\\xB3\\xB9\\xBC-\\xBE\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u09F4-\\u09F9\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0B72-\\u0B77\\u0BE6-\\u0BF2\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0CE6-\\u0CEF\\u0D58-\\u0D5E\\u0D66-\\u0D78\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F33\\u1040-\\u1049\\u1090-\\u1099\\u1369-\\u137C\\u16EE-\\u16F0\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19DA\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u2182\\u2185-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2CFD\\u3007\\u3021-\\u3029\\u3038-\\u303A\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\uA620-\\uA629\\uA6E6-\\uA6EF\\uA830-\\uA835\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19]|\\uD800[\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDEE1-\\uDEFB\\uDF20-\\uDF23\\uDF41\\uDF4A\\uDFD1-\\uDFD5]|\\uD801[\\uDCA0-\\uDCA9]|\\uD802[\\uDC58-\\uDC5F\\uDC79-\\uDC7F\\uDCA7-\\uDCAF\\uDCFB-\\uDCFF\\uDD16-\\uDD1B\\uDDBC\\uDDBD\\uDDC0-\\uDDCF\\uDDD2-\\uDDFF\\uDE40-\\uDE48\\uDE7D\\uDE7E\\uDE9D-\\uDE9F\\uDEEB-\\uDEEF\\uDF58-\\uDF5F\\uDF78-\\uDF7F\\uDFA9-\\uDFAF]|\\uD803[\\uDCFA-\\uDCFF\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDF1D-\\uDF26\\uDF51-\\uDF54\\uDFC5-\\uDFCB]|\\uD804[\\uDC52-\\uDC6F\\uDCF0-\\uDCF9\\uDD36-\\uDD3F\\uDDD0-\\uDDD9\\uDDE1-\\uDDF4\\uDEF0-\\uDEF9]|\\uD805[\\uDC50-\\uDC59\\uDCD0-\\uDCD9\\uDE50-\\uDE59\\uDEC0-\\uDEC9\\uDF30-\\uDF3B]|\\uD806[\\uDCE0-\\uDCF2\\uDD50-\\uDD59]|\\uD807[\\uDC50-\\uDC6C\\uDD50-\\uDD59\\uDDA0-\\uDDA9\\uDFC0-\\uDFD4]|\\uD809[\\uDC00-\\uDC6E]|\\uD81A[\\uDE60-\\uDE69\\uDF50-\\uDF59\\uDF5B-\\uDF61]|\\uD81B[\\uDE80-\\uDE96]|\\uD834[\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDFCE-\\uDFFF]|\\uD838[\\uDD40-\\uDD49\\uDEF0-\\uDEF9]|\\uD83A[\\uDCC7-\\uDCCF\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]))[\\u0F00-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F97\\u0F99-\\u0FBC\\u0FBE-\\u0FCC\\u0FCE-\\u0FD4\\u0FD9\\u0FDA])+|((?!(?:[0-9\\xB2\\xB3\\xB9\\xBC-\\xBE\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u09F4-\\u09F9\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0B72-\\u0B77\\u0BE6-\\u0BF2\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0CE6-\\u0CEF\\u0D58-\\u0D5E\\u0D66-\\u0D78\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F33\\u1040-\\u1049\\u1090-\\u1099\\u1369-\\u137C\\u16EE-\\u16F0\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19DA\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u2182\\u2185-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2CFD\\u3007\\u3021-\\u3029\\u3038-\\u303A\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\uA620-\\uA629\\uA6E6-\\uA6EF\\uA830-\\uA835\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19]|\\uD800[\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDEE1-\\uDEFB\\uDF20-\\uDF23\\uDF41\\uDF4A\\uDFD1-\\uDFD5]|\\uD801[\\uDCA0-\\uDCA9]|\\uD802[\\uDC58-\\uDC5F\\uDC79-\\uDC7F\\uDCA7-\\uDCAF\\uDCFB-\\uDCFF\\uDD16-\\uDD1B\\uDDBC\\uDDBD\\uDDC0-\\uDDCF\\uDDD2-\\uDDFF\\uDE40-\\uDE48\\uDE7D\\uDE7E\\uDE9D-\\uDE9F\\uDEEB-\\uDEEF\\uDF58-\\uDF5F\\uDF78-\\uDF7F\\uDFA9-\\uDFAF]|\\uD803[\\uDCFA-\\uDCFF\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDF1D-\\uDF26\\uDF51-\\uDF54\\uDFC5-\\uDFCB]|\\uD804[\\uDC52-\\uDC6F\\uDCF0-\\uDCF9\\uDD36-\\uDD3F\\uDDD0-\\uDDD9\\uDDE1-\\uDDF4\\uDEF0-\\uDEF9]|\\uD805[\\uDC50-\\uDC59\\uDCD0-\\uDCD9\\uDE50-\\uDE59\\uDEC0-\\uDEC9\\uDF30-\\uDF3B]|\\uD806[\\uDCE0-\\uDCF2\\uDD50-\\uDD59]|\\uD807[\\uDC50-\\uDC6C\\uDD50-\\uDD59\\uDDA0-\\uDDA9\\uDFC0-\\uDFD4]|\\uD809[\\uDC00-\\uDC6E]|\\uD81A[\\uDE60-\\uDE69\\uDF50-\\uDF59\\uDF5B-\\uDF61]|\\uD81B[\\uDE80-\\uDE96]|\\uD834[\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDFCE-\\uDFFF]|\\uD838[\\uDD40-\\uDD49\\uDEF0-\\uDEF9]|\\uD83A[\\uDCC7-\\uDCCF\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]))[\\u1000-\\u109F\\uA9E0-\\uA9FE\\uAA60-\\uAA7F])+|((?!(?:[0-9\\xB2\\xB3\\xB9\\xBC-\\xBE\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u09F4-\\u09F9\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0B72-\\u0B77\\u0BE6-\\u0BF2\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0CE6-\\u0CEF\\u0D58-\\u0D5E\\u0D66-\\u0D78\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F33\\u1040-\\u1049\\u1090-\\u1099\\u1369-\\u137C\\u16EE-\\u16F0\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19DA\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u2182\\u2185-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2CFD\\u3007\\u3021-\\u3029\\u3038-\\u303A\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\uA620-\\uA629\\uA6E6-\\uA6EF\\uA830-\\uA835\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19]|\\uD800[\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDEE1-\\uDEFB\\uDF20-\\uDF23\\uDF41\\uDF4A\\uDFD1-\\uDFD5]|\\uD801[\\uDCA0-\\uDCA9]|\\uD802[\\uDC58-\\uDC5F\\uDC79-\\uDC7F\\uDCA7-\\uDCAF\\uDCFB-\\uDCFF\\uDD16-\\uDD1B\\uDDBC\\uDDBD\\uDDC0-\\uDDCF\\uDDD2-\\uDDFF\\uDE40-\\uDE48\\uDE7D\\uDE7E\\uDE9D-\\uDE9F\\uDEEB-\\uDEEF\\uDF58-\\uDF5F\\uDF78-\\uDF7F\\uDFA9-\\uDFAF]|\\uD803[\\uDCFA-\\uDCFF\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDF1D-\\uDF26\\uDF51-\\uDF54\\uDFC5-\\uDFCB]|\\uD804[\\uDC52-\\uDC6F\\uDCF0-\\uDCF9\\uDD36-\\uDD3F\\uDDD0-\\uDDD9\\uDDE1-\\uDDF4\\uDEF0-\\uDEF9]|\\uD805[\\uDC50-\\uDC59\\uDCD0-\\uDCD9\\uDE50-\\uDE59\\uDEC0-\\uDEC9\\uDF30-\\uDF3B]|\\uD806[\\uDCE0-\\uDCF2\\uDD50-\\uDD59]|\\uD807[\\uDC50-\\uDC6C\\uDD50-\\uDD59\\uDDA0-\\uDDA9\\uDFC0-\\uDFD4]|\\uD809[\\uDC00-\\uDC6E]|\\uD81A[\\uDE60-\\uDE69\\uDF50-\\uDF59\\uDF5B-\\uDF61]|\\uD81B[\\uDE80-\\uDE96]|\\uD834[\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDFCE-\\uDFFF]|\\uD838[\\uDD40-\\uDD49\\uDEF0-\\uDEF9]|\\uD83A[\\uDCC7-\\uDCCF\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]))[\\u1780-\\u17DD\\u17E0-\\u17E9\\u17F0-\\u17F9\\u19E0-\\u19FF])+|((?!(?:[0-9\\xB2\\xB3\\xB9\\xBC-\\xBE\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u09F4-\\u09F9\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0B72-\\u0B77\\u0BE6-\\u0BF2\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0CE6-\\u0CEF\\u0D58-\\u0D5E\\u0D66-\\u0D78\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F33\\u1040-\\u1049\\u1090-\\u1099\\u1369-\\u137C\\u16EE-\\u16F0\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19DA\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u2182\\u2185-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2CFD\\u3007\\u3021-\\u3029\\u3038-\\u303A\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\uA620-\\uA629\\uA6E6-\\uA6EF\\uA830-\\uA835\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19]|\\uD800[\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDEE1-\\uDEFB\\uDF20-\\uDF23\\uDF41\\uDF4A\\uDFD1-\\uDFD5]|\\uD801[\\uDCA0-\\uDCA9]|\\uD802[\\uDC58-\\uDC5F\\uDC79-\\uDC7F\\uDCA7-\\uDCAF\\uDCFB-\\uDCFF\\uDD16-\\uDD1B\\uDDBC\\uDDBD\\uDDC0-\\uDDCF\\uDDD2-\\uDDFF\\uDE40-\\uDE48\\uDE7D\\uDE7E\\uDE9D-\\uDE9F\\uDEEB-\\uDEEF\\uDF58-\\uDF5F\\uDF78-\\uDF7F\\uDFA9-\\uDFAF]|\\uD803[\\uDCFA-\\uDCFF\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDF1D-\\uDF26\\uDF51-\\uDF54\\uDFC5-\\uDFCB]|\\uD804[\\uDC52-\\uDC6F\\uDCF0-\\uDCF9\\uDD36-\\uDD3F\\uDDD0-\\uDDD9\\uDDE1-\\uDDF4\\uDEF0-\\uDEF9]|\\uD805[\\uDC50-\\uDC59\\uDCD0-\\uDCD9\\uDE50-\\uDE59\\uDEC0-\\uDEC9\\uDF30-\\uDF3B]|\\uD806[\\uDCE0-\\uDCF2\\uDD50-\\uDD59]|\\uD807[\\uDC50-\\uDC6C\\uDD50-\\uDD59\\uDDA0-\\uDDA9\\uDFC0-\\uDFD4]|\\uD809[\\uDC00-\\uDC6E]|\\uD81A[\\uDE60-\\uDE69\\uDF50-\\uDF59\\uDF5B-\\uDF61]|\\uD81B[\\uDE80-\\uDE96]|\\uD834[\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDFCE-\\uDFFF]|\\uD838[\\uDD40-\\uDD49\\uDEF0-\\uDEF9]|\\uD83A[\\uDCC7-\\uDCCF\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]))[\\u02EA\\u02EB\\u3105-\\u312F\\u31A0-\\u31BF])+\/g},i=\/(?![\\u0902\\u094D])(?:[\\^`\\xA8\\xAF\\xB4\\xB7\\xB8\\u02B0-\\u034E\\u0350-\\u0357\\u035D-\\u0362\\u0374\\u0375\\u037A\\u0384\\u0385\\u0483-\\u0487\\u0559\\u0591-\\u05A1\\u05A3-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u064B-\\u0652\\u0657\\u0658\\u06DF\\u06E0\\u06E5\\u06E6\\u06EA-\\u06EC\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F5\\u0818\\u0819\\u08E3-\\u08FE\\u093C\\u094D\\u0951-\\u0954\\u0971\\u09BC\\u09CD\\u0A3C\\u0A4D\\u0ABC\\u0ACD\\u0AFD-\\u0AFF\\u0B3C\\u0B4D\\u0B55\\u0BCD\\u0C4D\\u0CBC\\u0CCD\\u0D3B\\u0D3C\\u0D4D\\u0DCA\\u0E47-\\u0E4C\\u0E4E\\u0EBA\\u0EC8-\\u0ECC\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F82-\\u0F84\\u0F86\\u0F87\\u0FC6\\u1037\\u1039\\u103A\\u1063\\u1064\\u1069-\\u106D\\u1087-\\u108D\\u108F\\u109A\\u109B\\u135D-\\u135F\\u17C9-\\u17D3\\u17DD\\u1939-\\u193B\\u1A75-\\u1A7C\\u1A7F\\u1AB0-\\u1ABD\\u1B34\\u1B44\\u1B6B-\\u1B73\\u1BAA\\u1BAB\\u1C36\\u1C37\\u1C78-\\u1C7D\\u1CD0-\\u1CE8\\u1CED\\u1CF4\\u1CF7-\\u1CF9\\u1D2C-\\u1D6A\\u1DC4-\\u1DCF\\u1DF5-\\u1DF9\\u1DFD-\\u1DFF\\u1FBD\\u1FBF-\\u1FC1\\u1FCD-\\u1FCF\\u1FDD-\\u1FDF\\u1FED-\\u1FEF\\u1FFD\\u1FFE\\u2CEF-\\u2CF1\\u2E2F\\u302A-\\u302F\\u3099-\\u309C\\u30FC\\uA66F\\uA67C\\uA67D\\uA67F\\uA69C\\uA69D\\uA6F0\\uA6F1\\uA700-\\uA721\\uA788-\\uA78A\\uA7F8\\uA7F9\\uA8C4\\uA8E0-\\uA8F1\\uA92B-\\uA92E\\uA953\\uA9B3\\uA9C0\\uA9E5\\uAA7B-\\uAA7D\\uAABF-\\uAAC2\\uAAF6\\uAB5B-\\uAB5F\\uAB69-\\uAB6B\\uABEC\\uABED\\uFB1E\\uFE20-\\uFE2F\\uFF3E\\uFF40\\uFF70\\uFF9E\\uFF9F\\uFFE3]|\\uD800\\uDEE0|\\uD802[\\uDEE5\\uDEE6]|\\uD803[\\uDD22-\\uDD27\\uDF46-\\uDF50]|\\uD804[\\uDCB9\\uDCBA\\uDD33\\uDD34\\uDD73\\uDDC0\\uDDCA-\\uDDCC\\uDE35\\uDE36\\uDEE9\\uDEEA\\uDF3C\\uDF4D\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDC42\\uDC46\\uDCC2\\uDCC3\\uDDBF\\uDDC0\\uDE3F\\uDEB6\\uDEB7\\uDF2B]|\\uD806[\\uDC39\\uDC3A\\uDD3D\\uDD3E\\uDD43\\uDDE0\\uDE34\\uDE47\\uDE99]|\\uD807[\\uDC3F\\uDD42\\uDD44\\uDD45\\uDD97]|\\uD81A[\\uDEF0-\\uDEF4\\uDF30-\\uDF36]|\\uD81B[\\uDF8F-\\uDF9F\\uDFF0\\uDFF1]|\\uD834[\\uDD67-\\uDD69\\uDD6D-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD]|\\uD838[\\uDD30-\\uDD36\\uDEEC-\\uDEEF]|\\uD83A[\\uDCD0-\\uDCD6\\uDD44-\\uDD46\\uDD48-\\uDD4A])+\/g,j=\/(?:[!-#%-\\\/:-@\\[-`\\{-~\\xA1\\xA7\\xA8\\xAB\\xAC\\xAF\\xB1\\xB4\\xB6-\\xB8\\xBB\\xBF\\xD7\\xF7\\u02C2-\\u02C5\\u02D2-\\u02DF\\u02E5-\\u02EB\\u02ED\\u02EF-\\u02FF\\u0375\\u037E\\u0384\\u0385\\u0387\\u03F6\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0606-\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u09FD\\u0A76\\u0AF0\\u0C77\\u0C84\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166E\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u1FBD\\u1FBF-\\u1FC1\\u1FCD-\\u1FCF\\u1FDD-\\u1FDF\\u1FED-\\u1FEF\\u1FFD\\u1FFE\\u200D\\u2010-\\u2027\\u2030-\\u205E\\u207A-\\u207E\\u208A-\\u208E\\u2118\\u2140-\\u2144\\u214B\\u2190-\\u2194\\u219A\\u219B\\u21A0\\u21A3\\u21A6\\u21AE\\u21CE\\u21CF\\u21D2\\u21D4\\u21F4-\\u22FF\\u2308-\\u230B\\u2320\\u2321\\u2329\\u232A\\u237C\\u239B-\\u23B3\\u23DC-\\u23E1\\u25B7\\u25C1\\u25F8-\\u25FF\\u266F\\u2768-\\u2775\\u27C0-\\u27FF\\u2900-\\u2AFF\\u2B30-\\u2B44\\u2B47-\\u2B4C\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E4F\\u2E52\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u309B\\u309C\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA700-\\uA716\\uA720\\uA721\\uA789\\uA78A\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA8FC\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uAB5B\\uAB6A\\uAB6B\\uABEB\\uFB29\\uFBB2-\\uFBC1\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE66\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF65\\uFFE2\\uFFE3\\uFFE9-\\uFFEC]|\\uD800[\\uDD00-\\uDD02\\uDF9F\\uDFD0]|\\uD801\\uDD6F|\\uD802[\\uDC57\\uDD1F\\uDD3F\\uDE50-\\uDE58\\uDE7F\\uDEF0-\\uDEF6\\uDF39-\\uDF3F\\uDF99-\\uDF9C]|\\uD803[\\uDEAD\\uDF55-\\uDF59]|\\uD804[\\uDC47-\\uDC4D\\uDCBB\\uDCBC\\uDCBE-\\uDCC1\\uDD40-\\uDD43\\uDD74\\uDD75\\uDDC5-\\uDDC8\\uDDCD\\uDDDB\\uDDDD-\\uDDDF\\uDE38-\\uDE3D\\uDEA9]|\\uD805[\\uDC4B-\\uDC4F\\uDC5A\\uDC5B\\uDC5D\\uDCC6\\uDDC1-\\uDDD7\\uDE41-\\uDE43\\uDE60-\\uDE6C\\uDF3C-\\uDF3E]|\\uD806[\\uDC3B\\uDD44-\\uDD46\\uDDE2\\uDE3F-\\uDE46\\uDE9A-\\uDE9C\\uDE9E-\\uDEA2]|\\uD807[\\uDC41-\\uDC45\\uDC70\\uDC71\\uDEF7\\uDEF8\\uDFFF]|\\uD809[\\uDC70-\\uDC74]|\\uD81A[\\uDE6E\\uDE6F\\uDEF5\\uDF37-\\uDF3B\\uDF44]|\\uD81B[\\uDE97-\\uDE9A\\uDFE2]|\\uD82F\\uDC9F|\\uD835[\\uDEC1\\uDEDB\\uDEFB\\uDF15\\uDF35\\uDF4F\\uDF6F\\uDF89\\uDFA9\\uDFC3]|\\uD836[\\uDE87-\\uDE8B]|\\uD83A[\\uDD5E\\uDD5F]|\\uD83B[\\uDEF0\\uDEF1]|\\uD83C[\\uDFFB-\\uDFFF])\/g,k=\/(^|(?:[\\t\\n\\r -#%-\\*,-\\\/:;\\?@\\[-\\]_\\{\\}\\xA0\\xA1\\xA7\\xAB\\xB6\\xB7\\xBB\\xBF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u09FD\\u0A76\\u0AF0\\u0C77\\u0C84\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166E\\u1680\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2000-\\u200A\\u2010-\\u2029\\u202F-\\u2043\\u2045-\\u2051\\u2053-\\u205F\\u207D\\u207E\\u208D\\u208E\\u2308-\\u230B\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E4F\\u2E52\\u3000-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA8FC\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]|\\uD800[\\uDD00-\\uDD02\\uDF9F\\uDFD0]|\\uD801\\uDD6F|\\uD802[\\uDC57\\uDD1F\\uDD3F\\uDE50-\\uDE58\\uDE7F\\uDEF0-\\uDEF6\\uDF39-\\uDF3F\\uDF99-\\uDF9C]|\\uD803[\\uDEAD\\uDF55-\\uDF59]|\\uD804[\\uDC47-\\uDC4D\\uDCBB\\uDCBC\\uDCBE-\\uDCC1\\uDD40-\\uDD43\\uDD74\\uDD75\\uDDC5-\\uDDC8\\uDDCD\\uDDDB\\uDDDD-\\uDDDF\\uDE38-\\uDE3D\\uDEA9]|\\uD805[\\uDC4B-\\uDC4F\\uDC5A\\uDC5B\\uDC5D\\uDCC6\\uDDC1-\\uDDD7\\uDE41-\\uDE43\\uDE60-\\uDE6C\\uDF3C-\\uDF3E]|\\uD806[\\uDC3B\\uDD44-\\uDD46\\uDDE2\\uDE3F-\\uDE46\\uDE9A-\\uDE9C\\uDE9E-\\uDEA2]|\\uD807[\\uDC41-\\uDC45\\uDC70\\uDC71\\uDEF7\\uDEF8\\uDFFF]|\\uD809[\\uDC70-\\uDC74]|\\uD81A[\\uDE6E\\uDE6F\\uDEF5\\uDF37-\\uDF3B\\uDF44]|\\uD81B[\\uDE97-\\uDE9A\\uDFE2]|\\uD82F\\uDC9F|\\uD836[\\uDE87-\\uDE8B]|\\uD83A[\\uDD5E\\uDD5F]))((?:[0-9A-Z\\^`-z\\xA8\\xAA\\xAF\\xB2-\\xB5\\xB7-\\xBA\\xBC-\\xBE\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u034E\\u0350-\\u0357\\u035D-\\u0362\\u0370-\\u0377\\u037A-\\u037D\\u037F\\u0384-\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0560-\\u0588\\u0591-\\u05A1\\u05A3-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05D0-\\u05EA\\u05EF-\\u05F2\\u0620-\\u0652\\u0657\\u0658\\u0660-\\u0669\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06DF\\u06E0\\u06E5\\u06E6\\u06EA-\\u06EC\\u06EE-\\u06FC\\u06FF\\u0710\\u0712-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u0815\\u0818-\\u081A\\u0824\\u0828\\u0840-\\u0858\\u0860-\\u086A\\u08A0-\\u08B4\\u08B6-\\u08C7\\u08E3-\\u08FE\\u0904-\\u0939\\u093C\\u093D\\u094D\\u0950-\\u0954\\u0958-\\u0961\\u0966-\\u096F\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC\\u09BD\\u09CD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09E6-\\u09F1\\u09F4-\\u09F9\\u09FC\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A4D\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A6F\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC\\u0ABD\\u0ACD\\u0AD0\\u0AE0\\u0AE1\\u0AE6-\\u0AEF\\u0AF9\\u0AFD-\\u0AFF\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C\\u0B3D\\u0B4D\\u0B55\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B66-\\u0B6F\\u0B71-\\u0B77\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BCD\\u0BD0\\u0BE6-\\u0BF2\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C4D\\u0C58-\\u0C5A\\u0C60\\u0C61\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC\\u0CBD\\u0CCD\\u0CDE\\u0CE0\\u0CE1\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D04-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3D\\u0D4D\\u0D4E\\u0D54-\\u0D56\\u0D58-\\u0D61\\u0D66-\\u0D78\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DE6-\\u0DEF\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E4C\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E86-\\u0E8A\\u0E8C-\\u0EA3\\u0EA5\\u0EA7-\\u0EB0\\u0EB2\\u0EB3\\u0EBA\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECC\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F33\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F82-\\u0F84\\u0F86-\\u0F8C\\u0FC6\\u1000-\\u102A\\u1037\\u1039\\u103A\\u103F-\\u1049\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1063-\\u1066\\u1069-\\u1070\\u1075-\\u1081\\u1087-\\u109B\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1369-\\u137C\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17C9-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1820-\\u1878\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1939-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19DA\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1A75-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B05-\\u1B34\\u1B44-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B83-\\u1BA0\\u1BAA\\u1BAB\\u1BAE-\\u1BE5\\u1C00-\\u1C23\\u1C36\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1C80-\\u1C88\\u1C90-\\u1CBA\\u1CBD-\\u1CBF\\u1CD0-\\u1CFA\\u1D00-\\u1DBF\\u1DC4-\\u1DCF\\u1DF5-\\u1DF9\\u1DFD-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FC4\\u1FC6-\\u1FD3\\u1FD6-\\u1FDB\\u1FDD-\\u1FEF\\u1FF2-\\u1FF4\\u1FF6-\\u1FFE\\u2070\\u2071\\u2074-\\u2079\\u207F-\\u2089\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2150-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2CFD\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312F\\u3131-\\u318E\\u3192-\\u3195\\u31A0-\\u31BF\\u31F0-\\u31FF\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\u3400-\\u4DBF\\u4E00-\\u9FFC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA67C\\uA67D\\uA67F-\\uA69D\\uA6A0-\\uA6F1\\uA700-\\uA7BF\\uA7C2-\\uA7CA\\uA7F5-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA830-\\uA835\\uA840-\\uA873\\uA882-\\uA8B3\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA8FD\\uA8FE\\uA900-\\uA925\\uA92B-\\uA92E\\uA930-\\uA946\\uA953\\uA960-\\uA97C\\uA984-\\uA9B3\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAABF-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB6B\\uAB70-\\uABE2\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE20-\\uFE2F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3E\\uFF40-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC\\uFFE3]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDEE0-\\uDEFB\\uDF00-\\uDF23\\uDF2D-\\uDF4A\\uDF50-\\uDF75\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF\\uDFD1-\\uDFD5]|\\uD801[\\uDC00-\\uDC9D\\uDCA0-\\uDCA9\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC58-\\uDC76\\uDC79-\\uDC9E\\uDCA7-\\uDCAF\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDCFB-\\uDD1B\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBC-\\uDDCF\\uDDD2-\\uDE00\\uDE10-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE35\\uDE40-\\uDE48\\uDE60-\\uDE7E\\uDE80-\\uDE9F\\uDEC0-\\uDEC7\\uDEC9-\\uDEE6\\uDEEB-\\uDEEF\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF58-\\uDF72\\uDF78-\\uDF91\\uDFA9-\\uDFAF]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2\\uDCFA-\\uDD27\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDE80-\\uDEA9\\uDEB0\\uDEB1\\uDF00-\\uDF27\\uDF30-\\uDF54\\uDFB0-\\uDFCB\\uDFE0-\\uDFF6]|\\uD804[\\uDC03-\\uDC37\\uDC52-\\uDC6F\\uDC83-\\uDCAF\\uDCB9\\uDCBA\\uDCD0-\\uDCE8\\uDCF0-\\uDCF9\\uDD03-\\uDD26\\uDD33\\uDD34\\uDD36-\\uDD3F\\uDD44\\uDD47\\uDD50-\\uDD73\\uDD76\\uDD83-\\uDDB2\\uDDC0-\\uDDC4\\uDDCA-\\uDDCC\\uDDD0-\\uDDDA\\uDDDC\\uDDE1-\\uDDF4\\uDE00-\\uDE11\\uDE13-\\uDE2B\\uDE35\\uDE36\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEDE\\uDEE9\\uDEEA\\uDEF0-\\uDEF9\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3C\\uDF3D\\uDF4D\\uDF50\\uDF5D-\\uDF61\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDC00-\\uDC34\\uDC42\\uDC46-\\uDC4A\\uDC50-\\uDC59\\uDC5F-\\uDC61\\uDC80-\\uDCAF\\uDCC2-\\uDCC5\\uDCC7\\uDCD0-\\uDCD9\\uDD80-\\uDDAE\\uDDBF\\uDDC0\\uDDD8-\\uDDDB\\uDE00-\\uDE2F\\uDE3F\\uDE44\\uDE50-\\uDE59\\uDE80-\\uDEAA\\uDEB6-\\uDEB8\\uDEC0-\\uDEC9\\uDF00-\\uDF1A\\uDF2B\\uDF30-\\uDF3B]|\\uD806[\\uDC00-\\uDC2B\\uDC39\\uDC3A\\uDCA0-\\uDCF2\\uDCFF-\\uDD06\\uDD09\\uDD0C-\\uDD13\\uDD15\\uDD16\\uDD18-\\uDD2F\\uDD3D-\\uDD3F\\uDD41\\uDD43\\uDD50-\\uDD59\\uDDA0-\\uDDA7\\uDDAA-\\uDDD0\\uDDE0\\uDDE1\\uDDE3\\uDE00\\uDE0B-\\uDE32\\uDE34\\uDE3A\\uDE47\\uDE50\\uDE5C-\\uDE89\\uDE99\\uDE9D\\uDEC0-\\uDEF8]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC2E\\uDC3F\\uDC40\\uDC50-\\uDC6C\\uDC72-\\uDC8F\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD30\\uDD42\\uDD44-\\uDD46\\uDD50-\\uDD59\\uDD60-\\uDD65\\uDD67\\uDD68\\uDD6A-\\uDD89\\uDD97\\uDD98\\uDDA0-\\uDDA9\\uDEE0-\\uDEF2\\uDFB0\\uDFC0-\\uDFD4]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC00-\\uDC6E\\uDC80-\\uDD43]|[\\uD80C\\uD81C-\\uD820\\uD822\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879\\uD880-\\uD883][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2E]|\\uD811[\\uDC00-\\uDE46]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDE60-\\uDE69\\uDED0-\\uDEED\\uDEF0-\\uDEF4\\uDF00-\\uDF36\\uDF40-\\uDF43\\uDF50-\\uDF59\\uDF5B-\\uDF61\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDE40-\\uDE96\\uDF00-\\uDF4A\\uDF50\\uDF8F-\\uDF9F\\uDFE0\\uDFE1\\uDFE3\\uDFF0\\uDFF1]|\\uD821[\\uDC00-\\uDFF7]|\\uD823[\\uDC00-\\uDCD5\\uDD00-\\uDD08]|\\uD82C[\\uDC00-\\uDD1E\\uDD50-\\uDD52\\uDD64-\\uDD67\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99]|\\uD834[\\uDD67-\\uDD69\\uDD6D-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB\\uDFCE-\\uDFFF]|\\uD838[\\uDD00-\\uDD2C\\uDD30-\\uDD3D\\uDD40-\\uDD49\\uDD4E\\uDEC0-\\uDEF9]|\\uD83A[\\uDC00-\\uDCC4\\uDCC7-\\uDCD6\\uDD00-\\uDD46\\uDD48-\\uDD4B\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]|\\uD869[\\uDC00-\\uDEDD\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF34\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]|\\uD884[\\uDC00-\\uDF4A])+)[\\\"\\'\\xAB\\xBB\\u2018-\\u201F\\u2039\\u203A\\u2E42\\u300C-\\u300F\\u301D-\\u301F\\uFE41-\\uFE44\\uFF02\\uFF07\\uFF62\\uFF63]((?:[0-9A-Z\\^`-z\\xA8\\xAA\\xAF\\xB2-\\xB5\\xB7-\\xBA\\xBC-\\xBE\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u034E\\u0350-\\u0357\\u035D-\\u0362\\u0370-\\u0377\\u037A-\\u037D\\u037F\\u0384-\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0560-\\u0588\\u0591-\\u05A1\\u05A3-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05D0-\\u05EA\\u05EF-\\u05F2\\u0620-\\u0652\\u0657\\u0658\\u0660-\\u0669\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06DF\\u06E0\\u06E5\\u06E6\\u06EA-\\u06EC\\u06EE-\\u06FC\\u06FF\\u0710\\u0712-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u0815\\u0818-\\u081A\\u0824\\u0828\\u0840-\\u0858\\u0860-\\u086A\\u08A0-\\u08B4\\u08B6-\\u08C7\\u08E3-\\u08FE\\u0904-\\u0939\\u093C\\u093D\\u094D\\u0950-\\u0954\\u0958-\\u0961\\u0966-\\u096F\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC\\u09BD\\u09CD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09E6-\\u09F1\\u09F4-\\u09F9\\u09FC\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A4D\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A6F\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC\\u0ABD\\u0ACD\\u0AD0\\u0AE0\\u0AE1\\u0AE6-\\u0AEF\\u0AF9\\u0AFD-\\u0AFF\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C\\u0B3D\\u0B4D\\u0B55\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B66-\\u0B6F\\u0B71-\\u0B77\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BCD\\u0BD0\\u0BE6-\\u0BF2\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C4D\\u0C58-\\u0C5A\\u0C60\\u0C61\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC\\u0CBD\\u0CCD\\u0CDE\\u0CE0\\u0CE1\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D04-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3D\\u0D4D\\u0D4E\\u0D54-\\u0D56\\u0D58-\\u0D61\\u0D66-\\u0D78\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DE6-\\u0DEF\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E4C\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E86-\\u0E8A\\u0E8C-\\u0EA3\\u0EA5\\u0EA7-\\u0EB0\\u0EB2\\u0EB3\\u0EBA\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECC\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F33\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F82-\\u0F84\\u0F86-\\u0F8C\\u0FC6\\u1000-\\u102A\\u1037\\u1039\\u103A\\u103F-\\u1049\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1063-\\u1066\\u1069-\\u1070\\u1075-\\u1081\\u1087-\\u109B\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1369-\\u137C\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17C9-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1820-\\u1878\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1939-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19DA\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1A75-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B05-\\u1B34\\u1B44-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B83-\\u1BA0\\u1BAA\\u1BAB\\u1BAE-\\u1BE5\\u1C00-\\u1C23\\u1C36\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1C80-\\u1C88\\u1C90-\\u1CBA\\u1CBD-\\u1CBF\\u1CD0-\\u1CFA\\u1D00-\\u1DBF\\u1DC4-\\u1DCF\\u1DF5-\\u1DF9\\u1DFD-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FC4\\u1FC6-\\u1FD3\\u1FD6-\\u1FDB\\u1FDD-\\u1FEF\\u1FF2-\\u1FF4\\u1FF6-\\u1FFE\\u2070\\u2071\\u2074-\\u2079\\u207F-\\u2089\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2150-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2CFD\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312F\\u3131-\\u318E\\u3192-\\u3195\\u31A0-\\u31BF\\u31F0-\\u31FF\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\u3400-\\u4DBF\\u4E00-\\u9FFC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA67C\\uA67D\\uA67F-\\uA69D\\uA6A0-\\uA6F1\\uA700-\\uA7BF\\uA7C2-\\uA7CA\\uA7F5-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA830-\\uA835\\uA840-\\uA873\\uA882-\\uA8B3\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA8FD\\uA8FE\\uA900-\\uA925\\uA92B-\\uA92E\\uA930-\\uA946\\uA953\\uA960-\\uA97C\\uA984-\\uA9B3\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAABF-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB6B\\uAB70-\\uABE2\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE20-\\uFE2F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3E\\uFF40-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC\\uFFE3]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDEE0-\\uDEFB\\uDF00-\\uDF23\\uDF2D-\\uDF4A\\uDF50-\\uDF75\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF\\uDFD1-\\uDFD5]|\\uD801[\\uDC00-\\uDC9D\\uDCA0-\\uDCA9\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC58-\\uDC76\\uDC79-\\uDC9E\\uDCA7-\\uDCAF\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDCFB-\\uDD1B\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBC-\\uDDCF\\uDDD2-\\uDE00\\uDE10-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE35\\uDE40-\\uDE48\\uDE60-\\uDE7E\\uDE80-\\uDE9F\\uDEC0-\\uDEC7\\uDEC9-\\uDEE6\\uDEEB-\\uDEEF\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF58-\\uDF72\\uDF78-\\uDF91\\uDFA9-\\uDFAF]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2\\uDCFA-\\uDD27\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDE80-\\uDEA9\\uDEB0\\uDEB1\\uDF00-\\uDF27\\uDF30-\\uDF54\\uDFB0-\\uDFCB\\uDFE0-\\uDFF6]|\\uD804[\\uDC03-\\uDC37\\uDC52-\\uDC6F\\uDC83-\\uDCAF\\uDCB9\\uDCBA\\uDCD0-\\uDCE8\\uDCF0-\\uDCF9\\uDD03-\\uDD26\\uDD33\\uDD34\\uDD36-\\uDD3F\\uDD44\\uDD47\\uDD50-\\uDD73\\uDD76\\uDD83-\\uDDB2\\uDDC0-\\uDDC4\\uDDCA-\\uDDCC\\uDDD0-\\uDDDA\\uDDDC\\uDDE1-\\uDDF4\\uDE00-\\uDE11\\uDE13-\\uDE2B\\uDE35\\uDE36\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEDE\\uDEE9\\uDEEA\\uDEF0-\\uDEF9\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3C\\uDF3D\\uDF4D\\uDF50\\uDF5D-\\uDF61\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDC00-\\uDC34\\uDC42\\uDC46-\\uDC4A\\uDC50-\\uDC59\\uDC5F-\\uDC61\\uDC80-\\uDCAF\\uDCC2-\\uDCC5\\uDCC7\\uDCD0-\\uDCD9\\uDD80-\\uDDAE\\uDDBF\\uDDC0\\uDDD8-\\uDDDB\\uDE00-\\uDE2F\\uDE3F\\uDE44\\uDE50-\\uDE59\\uDE80-\\uDEAA\\uDEB6-\\uDEB8\\uDEC0-\\uDEC9\\uDF00-\\uDF1A\\uDF2B\\uDF30-\\uDF3B]|\\uD806[\\uDC00-\\uDC2B\\uDC39\\uDC3A\\uDCA0-\\uDCF2\\uDCFF-\\uDD06\\uDD09\\uDD0C-\\uDD13\\uDD15\\uDD16\\uDD18-\\uDD2F\\uDD3D-\\uDD3F\\uDD41\\uDD43\\uDD50-\\uDD59\\uDDA0-\\uDDA7\\uDDAA-\\uDDD0\\uDDE0\\uDDE1\\uDDE3\\uDE00\\uDE0B-\\uDE32\\uDE34\\uDE3A\\uDE47\\uDE50\\uDE5C-\\uDE89\\uDE99\\uDE9D\\uDEC0-\\uDEF8]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC2E\\uDC3F\\uDC40\\uDC50-\\uDC6C\\uDC72-\\uDC8F\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD30\\uDD42\\uDD44-\\uDD46\\uDD50-\\uDD59\\uDD60-\\uDD65\\uDD67\\uDD68\\uDD6A-\\uDD89\\uDD97\\uDD98\\uDDA0-\\uDDA9\\uDEE0-\\uDEF2\\uDFB0\\uDFC0-\\uDFD4]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC00-\\uDC6E\\uDC80-\\uDD43]|[\\uD80C\\uD81C-\\uD820\\uD822\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879\\uD880-\\uD883][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2E]|\\uD811[\\uDC00-\\uDE46]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDE60-\\uDE69\\uDED0-\\uDEED\\uDEF0-\\uDEF4\\uDF00-\\uDF36\\uDF40-\\uDF43\\uDF50-\\uDF59\\uDF5B-\\uDF61\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDE40-\\uDE96\\uDF00-\\uDF4A\\uDF50\\uDF8F-\\uDF9F\\uDFE0\\uDFE1\\uDFE3\\uDFF0\\uDFF1]|\\uD821[\\uDC00-\\uDFF7]|\\uD823[\\uDC00-\\uDCD5\\uDD00-\\uDD08]|\\uD82C[\\uDC00-\\uDD1E\\uDD50-\\uDD52\\uDD64-\\uDD67\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99]|\\uD834[\\uDD67-\\uDD69\\uDD6D-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB\\uDFCE-\\uDFFF]|\\uD838[\\uDD00-\\uDD2C\\uDD30-\\uDD3D\\uDD40-\\uDD49\\uDD4E\\uDEC0-\\uDEF9]|\\uD83A[\\uDC00-\\uDCC4\\uDCC7-\\uDCD6\\uDD00-\\uDD46\\uDD48-\\uDD4B\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]|\\uD869[\\uDC00-\\uDEDD\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF34\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]|\\uD884[\\uDC00-\\uDF4A])+)($|(?:[\\t\\n\\r -#%-\\*,-\\\/:;\\?@\\[-\\]_\\{\\}\\xA0\\xA1\\xA7\\xAB\\xB6\\xB7\\xBB\\xBF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u09FD\\u0A76\\u0AF0\\u0C77\\u0C84\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166E\\u1680\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2000-\\u200A\\u2010-\\u2029\\u202F-\\u2043\\u2045-\\u2051\\u2053-\\u205F\\u207D\\u207E\\u208D\\u208E\\u2308-\\u230B\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E4F\\u2E52\\u3000-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA8FC\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]|\\uD800[\\uDD00-\\uDD02\\uDF9F\\uDFD0]|\\uD801\\uDD6F|\\uD802[\\uDC57\\uDD1F\\uDD3F\\uDE50-\\uDE58\\uDE7F\\uDEF0-\\uDEF6\\uDF39-\\uDF3F\\uDF99-\\uDF9C]|\\uD803[\\uDEAD\\uDF55-\\uDF59]|\\uD804[\\uDC47-\\uDC4D\\uDCBB\\uDCBC\\uDCBE-\\uDCC1\\uDD40-\\uDD43\\uDD74\\uDD75\\uDDC5-\\uDDC8\\uDDCD\\uDDDB\\uDDDD-\\uDDDF\\uDE38-\\uDE3D\\uDEA9]|\\uD805[\\uDC4B-\\uDC4F\\uDC5A\\uDC5B\\uDC5D\\uDCC6\\uDDC1-\\uDDD7\\uDE41-\\uDE43\\uDE60-\\uDE6C\\uDF3C-\\uDF3E]|\\uD806[\\uDC3B\\uDD44-\\uDD46\\uDDE2\\uDE3F-\\uDE46\\uDE9A-\\uDE9C\\uDE9E-\\uDEA2]|\\uD807[\\uDC41-\\uDC45\\uDC70\\uDC71\\uDEF7\\uDEF8\\uDFFF]|\\uD809[\\uDC70-\\uDC74]|\\uD81A[\\uDE6E\\uDE6F\\uDEF5\\uDF37-\\uDF3B\\uDF44]|\\uD81B[\\uDE97-\\uDE9A\\uDFE2]|\\uD82F\\uDC9F|\\uD836[\\uDE87-\\uDE8B]|\\uD83A[\\uDD5E\\uDD5F]))\/g,l=\/(?:[\\t\\n\\r -#%-\\*,-\\\/:;\\?@\\[-\\]_\\{\\}\\xA0\\xA1\\xA7\\xAB\\xB6\\xB7\\xBB\\xBF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u09FD\\u0A76\\u0AF0\\u0C77\\u0C84\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166E\\u1680\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2000-\\u200A\\u2010-\\u2029\\u202F-\\u2043\\u2045-\\u2051\\u2053-\\u205F\\u207D\\u207E\\u208D\\u208E\\u2308-\\u230B\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E4F\\u2E52\\u3000-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA8FC\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]|\\uD800[\\uDD00-\\uDD02\\uDF9F\\uDFD0]|\\uD801\\uDD6F|\\uD802[\\uDC57\\uDD1F\\uDD3F\\uDE50-\\uDE58\\uDE7F\\uDEF0-\\uDEF6\\uDF39-\\uDF3F\\uDF99-\\uDF9C]|\\uD803[\\uDEAD\\uDF55-\\uDF59]|\\uD804[\\uDC47-\\uDC4D\\uDCBB\\uDCBC\\uDCBE-\\uDCC1\\uDD40-\\uDD43\\uDD74\\uDD75\\uDDC5-\\uDDC8\\uDDCD\\uDDDB\\uDDDD-\\uDDDF\\uDE38-\\uDE3D\\uDEA9]|\\uD805[\\uDC4B-\\uDC4F\\uDC5A\\uDC5B\\uDC5D\\uDCC6\\uDDC1-\\uDDD7\\uDE41-\\uDE43\\uDE60-\\uDE6C\\uDF3C-\\uDF3E]|\\uD806[\\uDC3B\\uDD44-\\uDD46\\uDDE2\\uDE3F-\\uDE46\\uDE9A-\\uDE9C\\uDE9E-\\uDEA2]|\\uD807[\\uDC41-\\uDC45\\uDC70\\uDC71\\uDEF7\\uDEF8\\uDFFF]|\\uD809[\\uDC70-\\uDC74]|\\uD81A[\\uDE6E\\uDE6F\\uDEF5\\uDF37-\\uDF3B\\uDF44]|\\uD81B[\\uDE97-\\uDE9A\\uDFE2]|\\uD82F\\uDC9F|\\uD836[\\uDE87-\\uDE8B]|\\uD83A[\\uDD5E\\uDD5F])+\/g,m=\/(?:[\\$\\xA2-\\xA5\\u058F\\u060B\\u07FE\\u07FF\\u09F2\\u09F3\\u09FB\\u0AF1\\u0BF9\\u0E3F\\u17DB\\u20A0-\\u20BF\\uA838\\uFDFC\\uFE69\\uFF04\\uFFE0\\uFFE1\\uFFE5\\uFFE6]|\\uD807[\\uDFDD-\\uDFE0]|\\uD838\\uDEFF|\\uD83B\\uDCB0)+\/g;function n(a){return a.replace(k,function(a,b,c,d,e){return\" \"+c+d+\" \"+c+\" \"+d+\" \"})}function o(a){return a.split(l)}function p(a){return a.replace(j,\"\")}function q(a){return a.replace(i,\"\")}function r(a){return a.normalize(\"NFC\").replace(h.NFC_CHARACTER,function(a){return\" \"+a+\" \"})}function s(a){return a.normalize(\"NFC\").replace(h.NFC_WORD,function(a){return\" \"+a+\" \"})}function t(a){return a.replace(m,function(a){return\" \"+a+\" \"})}a=function(){function a(){}var b=a.prototype;b.tokenize=function(a){a===void 0&&(a=\"\");a=n(a);a=t(r(s(a)));a=o(a);a=a.map(function(a){a=a;a=p(a);if(!a.length)return a;else a.match(h.NFC_CHARACTER)?a=a.normalize(\"NFC\"):a.match(h.NFC_WORD)?a=a.normalize(\"NFC\"):(a=q(d(\"WAFtsTokenizerNormalizers\").preNFKDNormalizer.normalize(a).normalize(\"NFKD\")),a=a.toLocaleLowerCase(\"en-US\"),a=d(\"WAFtsTokenizerNormalizers\").postLowerCaseNormalizer.normalize(a));return a});return new Set(a.filter(function(a){return!!a&&!!a.trim()&&!a.match(l)}))};return a}();g[\"default\"]=a}),98);\n__d(\"WAFtsSimpleLatinicTokenizer\",[],(function(a,b,c,d,e,f){\"use strict\";var g=\/(?:[\\^`\\xA8\\xAF\\xB4\\xB7\\xB8\\u02B0-\\u034E\\u0350-\\u0357\\u035D-\\u0362\\u0374\\u0375\\u037A\\u0384\\u0385\\u0483-\\u0487\\u0559\\u0591-\\u05A1\\u05A3-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u064B-\\u0652\\u0657\\u0658\\u06DF\\u06E0\\u06E5\\u06E6\\u06EA-\\u06EC\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F5\\u0818\\u0819\\u08E3-\\u08FE\\u093C\\u094D\\u0951-\\u0954\\u0971\\u09BC\\u09CD\\u0A3C\\u0A4D\\u0ABC\\u0ACD\\u0AFD-\\u0AFF\\u0B3C\\u0B4D\\u0B55\\u0BCD\\u0C4D\\u0CBC\\u0CCD\\u0D3B\\u0D3C\\u0D4D\\u0DCA\\u0E47-\\u0E4C\\u0E4E\\u0EBA\\u0EC8-\\u0ECC\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F82-\\u0F84\\u0F86\\u0F87\\u0FC6\\u1037\\u1039\\u103A\\u1063\\u1064\\u1069-\\u106D\\u1087-\\u108D\\u108F\\u109A\\u109B\\u135D-\\u135F\\u17C9-\\u17D3\\u17DD\\u1939-\\u193B\\u1A75-\\u1A7C\\u1A7F\\u1AB0-\\u1ABD\\u1B34\\u1B44\\u1B6B-\\u1B73\\u1BAA\\u1BAB\\u1C36\\u1C37\\u1C78-\\u1C7D\\u1CD0-\\u1CE8\\u1CED\\u1CF4\\u1CF7-\\u1CF9\\u1D2C-\\u1D6A\\u1DC4-\\u1DCF\\u1DF5-\\u1DF9\\u1DFD-\\u1DFF\\u1FBD\\u1FBF-\\u1FC1\\u1FCD-\\u1FCF\\u1FDD-\\u1FDF\\u1FED-\\u1FEF\\u1FFD\\u1FFE\\u2CEF-\\u2CF1\\u2E2F\\u302A-\\u302F\\u3099-\\u309C\\u30FC\\uA66F\\uA67C\\uA67D\\uA67F\\uA69C\\uA69D\\uA6F0\\uA6F1\\uA700-\\uA721\\uA788-\\uA78A\\uA7F8\\uA7F9\\uA8C4\\uA8E0-\\uA8F1\\uA92B-\\uA92E\\uA953\\uA9B3\\uA9C0\\uA9E5\\uAA7B-\\uAA7D\\uAABF-\\uAAC2\\uAAF6\\uAB5B-\\uAB5F\\uAB69-\\uAB6B\\uABEC\\uABED\\uFB1E\\uFE20-\\uFE2F\\uFF3E\\uFF40\\uFF70\\uFF9E\\uFF9F\\uFFE3]|\\uD800\\uDEE0|\\uD802[\\uDEE5\\uDEE6]|\\uD803[\\uDD22-\\uDD27\\uDF46-\\uDF50]|\\uD804[\\uDCB9\\uDCBA\\uDD33\\uDD34\\uDD73\\uDDC0\\uDDCA-\\uDDCC\\uDE35\\uDE36\\uDEE9\\uDEEA\\uDF3C\\uDF4D\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDC42\\uDC46\\uDCC2\\uDCC3\\uDDBF\\uDDC0\\uDE3F\\uDEB6\\uDEB7\\uDF2B]|\\uD806[\\uDC39\\uDC3A\\uDD3D\\uDD3E\\uDD43\\uDDE0\\uDE34\\uDE47\\uDE99]|\\uD807[\\uDC3F\\uDD42\\uDD44\\uDD45\\uDD97]|\\uD81A[\\uDEF0-\\uDEF4\\uDF30-\\uDF36]|\\uD81B[\\uDF8F-\\uDF9F\\uDFF0\\uDFF1]|\\uD834[\\uDD67-\\uDD69\\uDD6D-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD]|\\uD838[\\uDD30-\\uDD36\\uDEEC-\\uDEEF]|\\uD83A[\\uDCD0-\\uDCD6\\uDD44-\\uDD46\\uDD48-\\uDD4A])\/g;a=function(){function a(){}var b=a.prototype;b.tokenize=function(a){a=a.toLowerCase().normalize(\"NFKD\").replace(g,\"\");a=a.split(\/\\b\/gi).map(function(a){return a.trim()}).filter(Boolean).filter(function(a){return a.match(\/[a-z0-9]+\/i)});return new Set(a)};return a}();f[\"default\"]=a}),66);\n__d(\"WAFtsTokenizers\",[\"WAFtsMultiLangTokenizer\",\"WAFtsSimpleLatinicTokenizer\"],(function(a,b,c,d,e,f){\"use strict\";f.SimpleLatinicSentenceTokenizer=importDefault(\"WAFtsSimpleLatinicTokenizer\"),f.MultiLangTokenizer=importDefault(\"WAFtsMultiLangTokenizer\")}),66);\n__d(\"WAArrayChunk\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a,b,c,d){c===void 0&&(c=!1);var e=0,f=[];while(e<a.length){var g=[],h=0;while(e<a.length){var i=a[e],j=d?d(i):1;if(!c&&h===0||h+j<=b)h+=j,g.push(i),e++;else{c&&j>b&&e++;break}}g.length>0&&f.push(g)}return f}f.chunk=a}),66);\n__d(\"WAFtsBaseIndexer\",[\"Promise\",\"WACustomError\",\"WALogger\",\"WANullthrows\",\"WAResolvable\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Finished batch from entry \",\" of \",\". (Took \",\" msec)\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Current message batch is from entry \",\" of \",\"...\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"FTS:Indexer:indexQueuedBatch: Completed\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"FTS:Indexer:indexQueuedBatch: Completed batch\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"FTS:Indexer:indexQueuedBatch: Starting new batch size : \",\"\"]);m=function(){return a};return a}var n=function(){},o=function(){return(h||(h=b(\"Promise\"))).resolve()};a=function(){function a(a,b,c,d){d===void 0&&(d=2e3),this.__progressCallbacks=[],this.__isFullIndexingPending=!1,this.__isProcessingBacklog=!1,this.tokenizer=a,this.messageSource=b,this.tableAdapter=c,this.batchSize=d,this.__currentFullIndexingOp=null,this.__currentQueuedIndexingOp=null,this.__fullIndexingProgress=-1}var e=a.prototype;e.__resetFullIndexingProgress=function(){this.__isFullIndexingPending=!1,this.__fullIndexingProgress=-1};e.__notifyProgress=function(a,b){this.__fullIndexingProgress=a,this.__progressCallbacks.forEach(function(c){try{c(a,b)}catch(a){}}),a===1&&(this.__progressCallbacks=[])};e.__processBatch=function(a){return(h||(h=b(\"Promise\"))).reject(new(d(\"WACustomError\").UnimplementedMethod)(\"BaseIndexer.__processBatch\"))};e.getIndexingProgress=function(){return this.__fullIndexingProgress};e.isFullIndexingPending=function(){return this.__isFullIndexingPending};e.isQueuedIndexingPending=function(){return this.__isProcessingBacklog};e.purge=function(a){return(h||(h=b(\"Promise\"))).reject(new(d(\"WACustomError\").UnimplementedMethod)(\"purge\"))};e.purgeChat=function(a){return(h||(h=b(\"Promise\"))).reject(new(d(\"WACustomError\").UnimplementedMethod)(\"purge\"))};e.purge__DEPRECATED_DO_NOT_USE=function(a,c,e){return(h||(h=b(\"Promise\"))).reject(new(d(\"WACustomError\").UnimplementedMethod)(\"purge\"))};e.search=function(a,b){return this.finder.find(a,b)};e.incremental=function(a){var e=this,f,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:a===void 0&&(a=o);if(!this.isQueuedIndexingPending()){i.next=3;break}return i.abrupt(\"return\",c(\"WANullthrows\")(this.__currentQueuedIndexingOp));case 3:f=new(d(\"WAResolvable\").Resolvable)(),g=!0,i.prev=5,this.__isProcessingBacklog=!0,this.__currentQueuedIndexingOp=f.promise,f.promise[\"finally\"](function(){e.__isProcessingBacklog=!1}),d(\"WALogger\").LOG(m(),this.batchSize);case 10:if(!g){i.next=28;break}if(!(this.signaller!=null&&this.signaller.shouldTerminateAll())){i.next=14;break}g=!1;return i.abrupt(\"break\",28);case 14:i.next=16;return b(\"regeneratorRuntime\").awrap(this.messageSource.getBacklogged({limit:this.batchSize}));case 16:h=i.sent;if(!(h==null)){i.next=20;break}g=!1;return i.abrupt(\"break\",28);case 20:if(!(h.length!==0)){i.next=26;break}i.next=23;return b(\"regeneratorRuntime\").awrap(this.__processBatch(h));case 23:d(\"WALogger\").LOG(l());i.next=26;return b(\"regeneratorRuntime\").awrap(a(h.map(function(a){return a.id})));case 26:i.next=10;break;case 28:d(\"WALogger\").LOG(k());i.next=35;break;case 31:i.prev=31;i.t0=i[\"catch\"](5);f.reject(i.t0);return i.abrupt(\"return\",!1);case 35:f.resolve(!0);return i.abrupt(\"return\",!0);case 37:case\"end\":return i.stop()}},null,this,[[5,31]])};e.full=function(a,e){var f=this,g,h,k,l,m,o,p,q,r,s;return b(\"regeneratorRuntime\").async(function(t){while(1)switch(t.prev=t.next){case 0:a===void 0&&(a=n);this.__progressCallbacks.push(a);if(!this.isFullIndexingPending()){t.next=4;break}return t.abrupt(\"return\",c(\"WANullthrows\")(this.__currentFullIndexingOp));case 4:this.__resetFullIndexingProgress();this.__isFullIndexingPending=!0;g=new(d(\"WAResolvable\").Resolvable)();this.__currentFullIndexingOp=g.promise;g.promise[\"finally\"](function(){return f.__resetFullIndexingProgress()});t.prev=9;h=this.batchSize;k=0;t.next=14;return b(\"regeneratorRuntime\").awrap(this.messageSource.size());case 14:l=t.sent,m=[performance.now()];case 16:if(!(k<=l)){t.next=36;break}o=performance.now();d(\"WALogger\").LOG(j(),k,l);t.next=21;return b(\"regeneratorRuntime\").awrap(e!=null?this.messageSource.getAllAfterId(e,{offset:k,limit:h}):this.messageSource.getAll({offset:k,limit:h}));case 21:p=t.sent;if(!(p==null)){t.next=24;break}return t.abrupt(\"break\",36);case 24:if(!(p.length!==0)){t.next=30;break}q=p[p.length-1];t.next=28;return b(\"regeneratorRuntime\").awrap(this.__processBatch(p));case 28:r=Math.min(1,(k+h)\/l),this.__notifyProgress(r,q.id);case 30:s=performance.now();d(\"WALogger\").LOG(i(),k,l,s-o);m.push(s-o);k+=h;t.next=16;break;case 36:this.__notifyProgress(1);g.resolve(m);return t.abrupt(\"return\",m);case 41:t.prev=41;t.t0=t[\"catch\"](9);this.__resetFullIndexingProgress();g.reject(t.t0);throw t.t0;case 46:case\"end\":return t.stop()}},null,this,[[9,41]])};e.setSignaller=function(a){this.signaller=a};e.getMessageSource=function(){return this.messageSource};e.eraseIndex=function(){return this.tableAdapter.erase()};return a}();g[\"default\"]=a}),98);\n__d(\"WALruCache\",[\"WAErr\",\"WALogger\",\"WAShiftTimer\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Blob size is larger than the limit of the whole store.\"]);h=function(){return a};return a}var i=function(a,b){this.key=a,this.value=b,this.prev=null,this.next=null};a=function(){function a(a){var b=this,e;this.$2=new Map();this.purgeNow=function(){for(var a=b.$6.prev;b.$4>b.$3&&a!==b.$5;a=a?a.prev:null){if(a==null)throw c(\"WAErr\")(\"The linked list is not constructed properly.\");var d=a,e=d.key;d=d.value;if(!b.$9(e,d))continue;b[\"delete\"](e);b.$10&&b.$10(e,d)}b.$8&&b.$8(b.$2)};this.$3=a.sizeLimit;this.$7=a.getSize;this.$8=a.onPurge;this.$9=(e=a.shouldEvict)!=null?e:function(){return!0};this.$10=a.onEvict;this.$11=a.onAdd;this.$12=a.onDelete;this.$4=0;this.$5=new i(\"placeholder-head\",null);this.$6=new i(\"placeholder-tail\",null);this.$5.next=this.$6;this.$6.prev=this.$5;this.$1=new(d(\"WAShiftTimer\").ShiftTimer)(function(){return b.purgeNow()})}var b=a.prototype;b.get=function(a){if(!this.$2.has(a))return null;a=this.$2.get(a);if(a==null)return null;var b=a.prev,d=a.next;b&&(b.next=d);d&&(d.prev=b);d=this.$5.next;if(d==null)throw c(\"WAErr\")(\"The linked list is not constructed properly.\");this.$5.next=a;d.prev=a;a.prev=this.$5;a.next=d;return a.value};b.has=function(a){return this.$2.has(a)};b.touch=function(a){this.get(a)};b.put=function(a,b){if(this.$3===0)return;if(this.$7(b)>this.$3){d(\"WALogger\").WARN(h());return}this[\"delete\"](a);this.$14(a,b);this.schedulePurge()};b.$14=function(a,b){var d=new i(a,b);this.$2.set(a,d);var e=this.$5.next;if(e==null)throw c(\"WAErr\")(\"The linked list is not constructed properly.\");this.$5.next=d;e.prev=d;d.prev=this.$5;d.next=e;this.$4+=this.$7(b);this.$11&&this.$11(a,b)};b[\"delete\"]=function(a){if(!this.$2.has(a))return;var b=this.$2.get(a);if(b==null)return;this.$4-=this.$7(b.value);var c=b.prev,d=b.next;c&&(c.next=d);d&&(d.prev=c);this.$2[\"delete\"](a);this.$12&&this.$12(a,b.value)};b.clear=function(){this.$2.clear(),this.$4=0,this.$5.next=this.$6,this.$6.prev=this.$5,this.$13&&this.$13()};b.schedulePurge=function(){this.$1.onOrBefore(1e3)};b.getCurrentSize=function(){return this.$4};b.getPlaceholderHead=function(){return this.$5};return a}();g.LruCache=a}),98);\n__d(\"WAFtsGenBlindIndex\",[\"WABase64\",\"WACryptoDependencies\",\"WALruCache\",\"WATextEncoding\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=new(d(\"WALruCache\").LruCache)({sizeLimit:5e4,getSize:function(){return 1}}),i=!1;function a(a,c){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:if(!i){f.next=2;break}return f.abrupt(\"return\",a);case 2:f.next=4;return b(\"regeneratorRuntime\").awrap(j(a,c));case 4:e=f.sent;return f.abrupt(\"return\",d(\"WABase64\").encodeB64(e));case 6:case\"end\":return f.stop()}},null,this)}function j(a,c){var e,f,g;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:e=h.get(a);if(!(e!=null)){i.next=3;break}return i.abrupt(\"return\",e);case 3:f=d(\"WATextEncoding\").newTextEncoder().encode(a);i.next=6;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoDependencies\").getCrypto().subtle.sign({name:\"HMAC\",hash:\"SHA-256\"},c,f));case 6:g=i.sent;h.put(a,g);return i.abrupt(\"return\",g);case 9:case\"end\":return i.stop()}},null,this)}g.genBlindIndex=a;g.genBlindIndexBuffer=j}),98);\n__d(\"WAFtsConstants\",[],(function(a,b,c,d,e,f){\"use strict\";a=2;f.FTS_MIN_CHARS=a}),66);\n__d(\"WAFtsWWWCompatibleCompiledRegex\",[],(function(a,b,c,d,e,f){\"use strict\";a=\/(?!(?:[0-9\\xB2\\xB3\\xB9\\xBC-\\xBE\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u09F4-\\u09F9\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0B72-\\u0B77\\u0BE6-\\u0BF2\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0CE6-\\u0CEF\\u0D58-\\u0D5E\\u0D66-\\u0D78\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F33\\u1040-\\u1049\\u1090-\\u1099\\u1369-\\u137C\\u16EE-\\u16F0\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19DA\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u2182\\u2185-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2CFD\\u3007\\u3021-\\u3029\\u3038-\\u303A\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\uA620-\\uA629\\uA6E6-\\uA6EF\\uA830-\\uA835\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19]|\\uD800[\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDEE1-\\uDEFB\\uDF20-\\uDF23\\uDF41\\uDF4A\\uDFD1-\\uDFD5]|\\uD801[\\uDCA0-\\uDCA9]|\\uD802[\\uDC58-\\uDC5F\\uDC79-\\uDC7F\\uDCA7-\\uDCAF\\uDCFB-\\uDCFF\\uDD16-\\uDD1B\\uDDBC\\uDDBD\\uDDC0-\\uDDCF\\uDDD2-\\uDDFF\\uDE40-\\uDE48\\uDE7D\\uDE7E\\uDE9D-\\uDE9F\\uDEEB-\\uDEEF\\uDF58-\\uDF5F\\uDF78-\\uDF7F\\uDFA9-\\uDFAF]|\\uD803[\\uDCFA-\\uDCFF\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDF1D-\\uDF26\\uDF51-\\uDF54\\uDFC5-\\uDFCB]|\\uD804[\\uDC52-\\uDC6F\\uDCF0-\\uDCF9\\uDD36-\\uDD3F\\uDDD0-\\uDDD9\\uDDE1-\\uDDF4\\uDEF0-\\uDEF9]|\\uD805[\\uDC50-\\uDC59\\uDCD0-\\uDCD9\\uDE50-\\uDE59\\uDEC0-\\uDEC9\\uDF30-\\uDF3B]|\\uD806[\\uDCE0-\\uDCF2\\uDD50-\\uDD59]|\\uD807[\\uDC50-\\uDC6C\\uDD50-\\uDD59\\uDDA0-\\uDDA9\\uDFC0-\\uDFD4]|\\uD809[\\uDC00-\\uDC6E]|\\uD81A[\\uDE60-\\uDE69\\uDF50-\\uDF59\\uDF5B-\\uDF61]|\\uD81B[\\uDE80-\\uDE96]|\\uD834[\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDFCE-\\uDFFF]|\\uD838[\\uDD40-\\uDD49\\uDEF0-\\uDEF9]|\\uD83A[\\uDCC7-\\uDCCF\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]))(?:[#\\\\*0-9\\xA9\\xAE\\u203C\\u2049\\u2122\\u2139\\u2194-\\u2199\\u21A9\\u21AA\\u231A\\u231B\\u2328\\u23CF\\u23E9-\\u23F3\\u23F8-\\u23FA\\u24C2\\u25AA\\u25AB\\u25B6\\u25C0\\u25FB-\\u25FE\\u2600-\\u2604\\u260E\\u2611\\u2614\\u2615\\u2618\\u261D\\u2620\\u2622\\u2623\\u2626\\u262A\\u262E\\u262F\\u2638-\\u263A\\u2640\\u2642\\u2648-\\u2653\\u265F\\u2660\\u2663\\u2665\\u2666\\u2668\\u267B\\u267E\\u267F\\u2692-\\u2697\\u2699\\u269B\\u269C\\u26A0\\u26A1\\u26A7\\u26AA\\u26AB\\u26B0\\u26B1\\u26BD\\u26BE\\u26C4\\u26C5\\u26C8\\u26CE\\u26CF\\u26D1\\u26D3\\u26D4\\u26E9\\u26EA\\u26F0-\\u26F5\\u26F7-\\u26FA\\u26FD\\u2702\\u2705\\u2708-\\u270D\\u270F\\u2712\\u2714\\u2716\\u271D\\u2721\\u2728\\u2733\\u2734\\u2744\\u2747\\u274C\\u274E\\u2753-\\u2755\\u2757\\u2763\\u2764\\u2795-\\u2797\\u27A1\\u27B0\\u27BF\\u2934\\u2935\\u2B05-\\u2B07\\u2B1B\\u2B1C\\u2B50\\u2B55\\u3030\\u303D\\u3297\\u3299\\uFE0E\\uFE0F]|\\uD83C[\\uDC04\\uDCCF\\uDD70\\uDD71\\uDD7E\\uDD7F\\uDD8E\\uDD91-\\uDD9A\\uDDE6-\\uDDFF\\uDE01\\uDE02\\uDE1A\\uDE2F\\uDE32-\\uDE3A\\uDE50\\uDE51\\uDF00-\\uDF21\\uDF24-\\uDF93\\uDF96\\uDF97\\uDF99-\\uDF9B\\uDF9E-\\uDFF0\\uDFF3-\\uDFF5\\uDFF7-\\uDFFF]|\\uD83D[\\uDC00-\\uDCFD\\uDCFF-\\uDD3D\\uDD49-\\uDD4E\\uDD50-\\uDD67\\uDD6F\\uDD70\\uDD73-\\uDD7A\\uDD87\\uDD8A-\\uDD8D\\uDD90\\uDD95\\uDD96\\uDDA4\\uDDA5\\uDDA8\\uDDB1\\uDDB2\\uDDBC\\uDDC2-\\uDDC4\\uDDD1-\\uDDD3\\uDDDC-\\uDDDE\\uDDE1\\uDDE3\\uDDE8\\uDDEF\\uDDF3\\uDDFA-\\uDE4F\\uDE80-\\uDEC5\\uDECB-\\uDED2\\uDED5-\\uDED7\\uDEE0-\\uDEE5\\uDEE9\\uDEEB\\uDEEC\\uDEF0\\uDEF3-\\uDEFC\\uDFE0-\\uDFEB]|\\uD83E[\\uDD0C-\\uDD3A\\uDD3C-\\uDD45\\uDD47-\\uDD78\\uDD7A-\\uDDCB\\uDDCD-\\uDDFF\\uDE70-\\uDE74\\uDE78-\\uDE7A\\uDE80-\\uDE86\\uDE90-\\uDEA8\\uDEB0-\\uDEB6\\uDEC0-\\uDEC2\\uDED0-\\uDED6])\/;b=\/(?:[\\u2E80-\\u2E99\\u2E9B-\\u2EF3\\u2F00-\\u2FD5\\u3005\\u3007\\u3021-\\u3029\\u3038-\\u303B\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FD-\\u30FF\\u31F0-\\u31FF\\u32D0-\\u32FE\\u3300-\\u3357\\u3400-\\u4DBF\\u4E00-\\u9FFC\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFF66-\\uFF6F\\uFF71-\\uFF9D]|\\uD81B[\\uDFF0\\uDFF1]|\\uD82C[\\uDC00-\\uDD1E\\uDD50-\\uDD52\\uDD64-\\uDD67]|\\uD83C\\uDE00|[\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879\\uD880-\\uD883][\\uDC00-\\uDFFF]|\\uD869[\\uDC00-\\uDEDD\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF34\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]|\\uD884[\\uDC00-\\uDF4A])\/;f.CONTAINS_EMOJI_REGEX=a;f.CONTAINS_HAN_OR_KANA_SCRIPT_REGEX=b}),66);\n__d(\"WAStringz\",[],(function(a,b,c,d,e,f){\"use strict\";var g=\/\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|(?:[^\\ud800-\\udfff][\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]?|[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\ud800-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?(?:\\u200d(?:[^\\ud800-\\udfff]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?)*\/g;function a(a){a=a.match(g);return a?a.length:0}function b(a,b,c){b===void 0&&(b=0);a=a.match(g);return!a?\"\":a.slice(Math.max(0,b),Math.max(0,c)).join(\"\")}function c(a){return a.match(g)||[]}f.astralRange=g;f.length=a;f.substring=b;f.toArray=c}),66);\n__d(\"WAUnicodeUtils\",[\"WAStringz\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=5e3,i=.5;function a(a,b){return j(a||\"\",0,b)}function b(a){return d(\"WAStringz\").length(a||\"\")}function j(a,b,c){if(a==null||a===\"\")return\"\";b=b||0;c=c==null?Infinity:c;if(b===0&&c===Infinity)return a;return a.length>=h&&c\/a.length<=i?l(a,b,c):d(\"WAStringz\").substring(a,b,c)}function k(a,b,c){a=a||\"\";b=b||0;c=c==null?Infinity:c;return a.length>=h&&c\/a.length<=i?m(a,b,c):d(\"WAStringz\").toArray(a).slice(b,c)}function c(a,b){b===void 0&&(b=0);if(a.codePointAt)return a.codePointAt(b);var c=a.charCodeAt(b);if(c>=55296&&c<=56319){a=a.charCodeAt(b+1);a>=56320&&a<=57343&&(c=65536+(c-55296<<10)+(a-56320))}return c}function e(a,b){if(b==null)return a;if(encodeURI(a).length<=b)return a;var c=0,d=k(a),e=d.length;for(var f=0;f<e;f++){var g=d[f];g=encodeURI(g).length;if(c+g>b)return j(a,0,f);c+=g}return a}function l(a,b,c){b=new RegExp(d(\"WAStringz\").astralRange);var e=\"\",f,g=0;do f=b.exec(a),f&&(e+=f[0]),g++;while(f&&g<c);return e}function m(a,b,c){b=new RegExp(d(\"WAStringz\").astralRange);var e=[],f;do f=b.exec(a),f&&e.push(f[0]);while(f&&e.length<c);return e}g.firstNCodepoints=a;g.numCodepoints=b;g.substring=j;g.toArray=k;g.codePointAt=c;g.firstNEncodedBytes=e}),98);\n__d(\"WAFtsIsSearchQueryEligibleForMessageSearch\",[\"WAFtsConstants\",\"WAFtsWWWCompatibleCompiledRegex\",\"WAUnicodeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){a=a.trim().normalize(\"NFKD\");if(d(\"WAUnicodeUtils\").numCodepoints(a)>=d(\"WAFtsConstants\").FTS_MIN_CHARS)return!0;if(d(\"WAFtsWWWCompatibleCompiledRegex\").CONTAINS_EMOJI_REGEX.test(a))return!0;return d(\"WAFtsWWWCompatibleCompiledRegex\").CONTAINS_HAN_OR_KANA_SCRIPT_REGEX.test(a)?!0:!1}g[\"default\"]=a}),98);\n__d(\"WAFtsV3BlindIndexGenerator\",[\"Promise\",\"WAArrayBufferUtils\",\"WACryptoDependencies\",\"WAFtsGenBlindIndex\",\"WAFtsIsSearchQueryEligibleForMessageSearch\",\"WALruCache\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=256\/8,j=3;a=function(){function a(a,b,c){b===void 0&&(b=i),c===void 0&&(c=j),this.$1=new(d(\"WALruCache\").LruCache)({sizeLimit:5e4,getSize:function(a){return a.length}}),this.$2=new(d(\"WALruCache\").LruCache)({sizeLimit:1e3,getSize:function(){return 1}}),this.keyGenFn=a,this.blindIndexByteLength=b,this.$3=c}var e=a.prototype;e.generateForToken=function(a,c){var d;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b(\"regeneratorRuntime\").awrap(this.$4(a));case 2:d=e.sent;return e.abrupt(\"return\",this.$5(d,c));case 4:case\"end\":return e.stop()}},null,this)};e.generatePrefixes=function(a,e){var f=this,g,i,j,k;return b(\"regeneratorRuntime\").async(function(l){while(1)switch(l.prev=l.next){case 0:g=[];i=this.$1.get(a);if(!(i!=null)){l.next=6;break}g=i;l.next=22;break;case 6:j=0;case 7:if(!(j<a.length)){l.next=21;break}k=a.slice(0,j+1);if(!(j===0&&!c(\"WAFtsIsSearchQueryEligibleForMessageSearch\")(k))){l.next=13;break}return l.abrupt(\"continue\",18);case 13:l.t0=g;l.next=16;return b(\"regeneratorRuntime\").awrap(d(\"WAFtsGenBlindIndex\").genBlindIndexBuffer(k,this.keyGenFn()));case 16:l.t1=l.sent,l.t0.push.call(l.t0,l.t1);case 18:++j;l.next=7;break;case 21:this.$1.put(a,g);case 22:return l.abrupt(\"return\",(h||(h=b(\"Promise\"))).all(g.map(function(a){return f.$5(a,e)})));case 23:case\"end\":return l.stop()}},null,this)};e.generateBoundsForToken=function(a){var c,d,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b(\"regeneratorRuntime\").awrap(this.$4(a));case 2:c=f.sent;d=new Uint8Array(this.blindIndexByteLength).fill(0);e=new Uint8Array(this.blindIndexByteLength).fill(255);return f.abrupt(\"return\",(h||(h=b(\"Promise\"))).all([this.$5(c,d),this.$5(c,e)]));case 6:case\"end\":return f.stop()}},null,this)};e.$4=function(a){var c,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:c=this.$1.get(a);if(!(c!=null)){f.next=5;break}e=c[c.length-1];f.next=8;break;case 5:f.next=7;return b(\"regeneratorRuntime\").awrap(d(\"WAFtsGenBlindIndex\").genBlindIndexBuffer(a,this.keyGenFn()));case 7:e=f.sent;case 8:return f.abrupt(\"return\",e);case 9:case\"end\":return f.stop()}},null,this)};e.$5=function(a,c){var e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:e=a.slice(0,this.blindIndexByteLength);if(!(c==null)){g.next=3;break}return g.abrupt(\"return\",e);case 3:if(!(typeof c===\"string\")){g.next=11;break}g.t0=Uint8Array;g.next=7;return b(\"regeneratorRuntime\").awrap(this.$6(c));case 7:g.t1=g.sent;f=new g.t0(g.t1);g.next=12;break;case 11:f=c;case 12:return g.abrupt(\"return\",d(\"WAArrayBufferUtils\").concatBuffers([e.slice(0,this.blindIndexByteLength),f.slice(0,this.$3).buffer]));case 13:case\"end\":return g.stop()}},null,this)};e.$6=function(a){var c,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:c=this.$2.get(a);if(!(c!=null)){f.next=3;break}return f.abrupt(\"return\",c);case 3:f.next=5;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoDependencies\").getCrypto().subtle.digest(\"SHA-1\",d(\"WAArrayBufferUtils\").stringToArrayBuffer(a)));case 5:e=f.sent;this.$2.put(a,e);return f.abrupt(\"return\",e);case 8:case\"end\":return f.stop()}},null,this)};return a}();g[\"default\"]=a}),98);\n__d(\"WAFtsBaseFinder\",[\"Promise\",\"WACustomError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;a=function(){function a(a,b,c,d){d===void 0&&(d=2e3),this.tokenizer=a,this.messageSource=b,this.tableAdapter=c,this.$1=d}var c=a.prototype;c.find=function(a,c){return(h||(h=b(\"Promise\"))).reject(new(d(\"WACustomError\").UnimplementedMethod)(\"purge\"))};c.invalidateCache=function(a){throw new(d(\"WACustomError\").UnimplementedMethod)(\"purge\")};c.invalidateAllCaches=function(){throw new(d(\"WACustomError\").UnimplementedMethod)(\"purge\")};return a}();g[\"default\"]=a}),98);\n__d(\"WAFtsSearchResultComparator\",[],(function(a,b,c,d,e,f){\"use strict\";a=function(a,b){a=a.timestamp;b=b.timestamp;return b-a};b=a;f[\"default\"]=b}),66);\n__d(\"WAFtsV3Finder\",[\"WAArrayBufferUtils\",\"WAFtsBaseFinder\",\"WAFtsIsSearchQueryEligibleForMessageSearch\",\"WAFtsSearchResultComparator\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=200,i=function(){return{eof:!0,messages:[],status:404}};a=function(a){babelHelpers.inheritsLoose(e,a);function e(b,c,d,e,f){f===void 0&&(f=2e3);b=a.call(this,b,c,d,f)||this;b.blindIndexGenerator=e;return b}var f=e.prototype;f.find=function(a,d){var e,f,g,h,j,k,l,m,n,o,p;return b(\"regeneratorRuntime\").async(function(q){while(1)switch(q.prev=q.next){case 0:d===void 0&&(d={});e=Array.from(this.tokenizer.tokenize(a)).filter(function(a){return a.length>1||c(\"WAFtsIsSearchQueryEligibleForMessageSearch\")(a)}).sort(function(a,b){return b.length-a.length});f=!1;g=d.remote;h=[];if(!(e.length===0)){q.next=9;break}f=!0;q.next=57;break;case 9:j=e[0];if(!(g!=null)){q.next=25;break}q.t0=b(\"regeneratorRuntime\");q.t1=this.tableAdapter;q.t2=[\"prefixes\"];q.next=16;return b(\"regeneratorRuntime\").awrap(this.blindIndexGenerator.generateForToken(j,g));case 16:q.t3=q.sent;q.t4=[q.t3];q.t5=q.t1.bulkGetAnyOf.call(q.t1,q.t2,q.t4);q.next=21;return q.t0.awrap.call(q.t0,q.t5);case 21:h=q.sent;h=h.filter(function(a){return a.chatId===g});q.next=33;break;case 25:q.next=27;return b(\"regeneratorRuntime\").awrap(this.blindIndexGenerator.generateBoundsForToken(j));case 27:k=q.sent;l=k[0];m=k[1];q.next=32;return b(\"regeneratorRuntime\").awrap(this.tableAdapter.between([\"prefixes\"],l,m,{lowerInclusive:!0,upperInclusive:!0}));case 32:h=q.sent;case 33:n=1;case 34:if(!(n<e.length)){q.next=44;break}q.next=37;return b(\"regeneratorRuntime\").awrap(this.$FtsMessageFinder1(e[n],h,g));case 37:h=q.sent;if(!(h.length===0)){q.next=41;break}f=!0;return q.abrupt(\"break\",44);case 41:n++;q.next=34;break;case 44:if(f){q.next=57;break}o=0;case 46:if(!(o<e.length)){q.next=57;break}if(!(e[o].length>2)){q.next=54;break}q.next=50;return b(\"regeneratorRuntime\").awrap(this.$FtsMessageFinder1(e[o].slice(0,e[o].length-1),h,g));case 50:h=q.sent;if(!(h.length===0)){q.next=54;break}f=!0;return q.abrupt(\"break\",57);case 54:o++;q.next=46;break;case 57:if(!f){q.next=59;break}return q.abrupt(\"return\",i());case 59:p=h.map(function(b){var c=b.id,a=b.chatId;b=b.timestamp;return{id:c,chatId:a,timestamp:b}}).sort(c(\"WAFtsSearchResultComparator\"));return q.abrupt(\"return\",this.$FtsMessageFinder2(p,d));case 61:case\"end\":return q.stop()}},null,this)};f.$FtsMessageFinder1=function(a,c,e){var f=this,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!(e!=null)){i.next=7;break}i.next=3;return b(\"regeneratorRuntime\").awrap(this.blindIndexGenerator.generateForToken(a,e));case 3:g=i.sent;return i.abrupt(\"return\",c.filter(function(a){return a.prefixes.some(function(a){return d(\"WAArrayBufferUtils\").arrayBuffersEqualUNSAFE(a,g)})}));case 7:i.next=9;return b(\"regeneratorRuntime\").awrap(this.blindIndexGenerator.generateForToken(a));case 9:h=i.sent;return i.abrupt(\"return\",c.filter(function(a){return a.prefixes.some(function(a){return d(\"WAArrayBufferUtils\").arrayBuffersEqualUNSAFE(a.slice(0,f.blindIndexGenerator.blindIndexByteLength),h)})}));case 11:case\"end\":return i.stop()}},null,this)};f.$FtsMessageFinder2=function(a,b){var c=b.page;c=c===void 0?1:c;b=b.limit;b=b===void 0?h:b;c=(c-1)*b||0;b=c+b;var d=b>=a.length;a=a.slice(c,b);return{messages:a,eof:d,status:200}};return e}(c(\"WAFtsBaseFinder\"));g[\"default\"]=a}),98);\n__d(\"WAFtsV3IndexEntry\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a,b,c,d){return{id:a,chatId:b,timestamp:c,prefixes:d}}function b(a,b,c,d,e){return{ftsRowId:a,id:b,chatId:c,timestamp:d,prefixes:e}}f.buildEntry=a;f.buildDBEntry=b}),66);\n__d(\"WAFtsV3Indexer\",[\"Promise\",\"WAArrayChunk\",\"WAFtsBaseIndexer\",\"WAFtsV3BlindIndexGenerator\",\"WAFtsV3Finder\",\"WAFtsV3IndexEntry\",\"WALogger\",\"WAPromiseDelays\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to write message with id \",\" to FTS index\"]);i=function(){return a};return a}var j=1e3,k=1e3,l=8;a=function(a){babelHelpers.inheritsLoose(e,a);function e(b,d,e,f,g,h){var i;f===void 0&&(f=l);g===void 0&&(g=k);h===void 0&&(h=j);i=a.call(this,b,d,e,g)||this;i.$BlindIndicesBasedIndexer2=0;i.$BlindIndicesBasedIndexer3=h;i.$BlindIndicesBasedIndexer1=new(c(\"WAFtsV3BlindIndexGenerator\"))(function(){return i.tableAdapter.getKey()},f);i.finder=new(c(\"WAFtsV3Finder\"))(b,d,e,i.$BlindIndicesBasedIndexer1);return i}var f=e.prototype;f.$BlindIndicesBasedIndexer4=function(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.prev=0;c.next=3;return b(\"regeneratorRuntime\").awrap(this.tableAdapter.bulkPut(a));case 3:this.$BlindIndicesBasedIndexer2++;c.next=10;break;case 6:c.prev=6;c.t0=c[\"catch\"](0);d(\"WALogger\").ERROR(i(),a[0].id);throw c.t0;case 10:c.prev=10;if(!(this.$BlindIndicesBasedIndexer2>0&&this.$BlindIndicesBasedIndexer2%20===0)){c.next=14;break}c.next=14;return b(\"regeneratorRuntime\").awrap(d(\"WAPromiseDelays\").delayMs(1e3));case 14:return c.finish(10);case 15:case\"end\":return c.stop()}},null,this,[[0,6,10,15]])};f.__processBatch=function(a){var c=this,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:e=function(){var e,g,i,j,k,l,m,n,o;return b(\"regeneratorRuntime\").async(function(p){while(1)switch(p.prev=p.next){case 0:e=a[f];g=e.id;i=e.textFragments;j=e.chatId;k=e.timestamp;l=Array.from(c.tokenizer.tokenize(i.join(\" \")));p.next=8;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(l.map(function(a){return c.$BlindIndicesBasedIndexer1.generatePrefixes(a,j)})));case 8:m=p.sent;n=d(\"WAArrayChunk\").chunk(m.flat(),c.$BlindIndicesBasedIndexer3);o=n.map(function(a){return d(\"WAFtsV3IndexEntry\").buildEntry(g,j,k,a)});p.next=13;return b(\"regeneratorRuntime\").awrap(c.$BlindIndicesBasedIndexer4(o));case 13:case\"end\":return p.stop()}},null,this)},f=0;case 2:if(!(f<a.length)){g.next=8;break}g.next=5;return b(\"regeneratorRuntime\").awrap(e());case 5:f++;g.next=2;break;case 8:case\"end\":return g.stop()}},null,this)};f.purge=function(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b(\"regeneratorRuntime\").awrap(this.tableAdapter.bulkRemoveByIndex([\"id\"],a));case 2:return c.abrupt(\"return\",!0);case 3:case\"end\":return c.stop()}},null,this)};f.purgeChat=function(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b(\"regeneratorRuntime\").awrap(this.tableAdapter.bulkRemoveByIndex([\"chatId\"],[a]));case 2:return c.abrupt(\"return\",!0);case 3:case\"end\":return c.stop()}},null,this)};f.purge__DEPRECATED_DO_NOT_USE=function(a,c,d){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b(\"regeneratorRuntime\").awrap(this.tableAdapter.bulkRemoveByIndex([\"chatId\"],[a]));case 2:return c.abrupt(\"return\",!0);case 3:case\"end\":return c.stop()}},null,this)};return e}(c(\"WAFtsBaseIndexer\"));g[\"default\"]=a}),98);\n__d(\"MAWFTSVersionsInformation\",[\"MAWMessageIndexerFtsIndexTableAdapter\",\"MAWMessageIndexerMessageSource\",\"MAWMessageSearchFTSKeyUtil\",\"MAWMessageSearchSignaller\",\"Promise\",\"WAFtsTokenizers\",\"WAFtsV3Indexer\",\"nullthrows\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=new(c(\"MAWMessageIndexerMessageSource\"))();a={indexers:{3.1:function(a){return d(\"MAWMessageSearchFTSKeyUtil\").fetchOrGenerateFTSCryptoKey().then(function(b){b=new(c(\"WAFtsV3Indexer\"))(a,c(\"nullthrows\")(i),new(c(\"MAWMessageIndexerFtsIndexTableAdapter\"))(b),6);b.setSignaller(new(c(\"MAWMessageSearchSignaller\"))());return b})}},tokenizers:{1:function(){return(h||(h=b(\"Promise\"))).resolve(new(d(\"WAFtsTokenizers\").MultiLangTokenizer)())}}};e=\"3.1\";f=\"1\";g.VERSIONS_INFO=a;g.LATEST_INDEXER_VERSION=e;g.LATEST_TOKENIZER_VERSION=f}),98);\n__d(\"MAWDbFTSManifest\",[],(function(a,b,c,d,e,f){\"use strict\";a=Object.freeze({CURR_VERSION:\"curr.version\",NEXT_VERSION:\"next.version\",PREV_VERSION:\"prev.version\"});f.ManifestKeys=a}),66);\n__d(\"MAWMessageSearchManifestReader\",[\"FBLogger\",\"MAWDbFTSManifest\",\"MAWFTSIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){function a(){}var b=a.prototype;b.versions=function(){return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsManifest:d(\"MAWTransactionMode\").READONLY},function(a){return function(){return a.ftsManifest.toArray().then(function(a){var b=new Map();for(var a=a,e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;var h={isCurrent:g.key===d(\"MAWDbFTSManifest\").ManifestKeys.CURR_VERSION,isFullIndexingComplete:g.isFullIndexingComplete,lastMsgKeyViaFullIndexer:g.lastMsgKeyViaFullIndexer,schemaVersion:g.schemaVersion,tokenizerVersion:g.tokenizerVersion};b.set(g.key,h)}g=b.get(d(\"MAWDbFTSManifest\").ManifestKeys.CURR_VERSION);if(g==null)throw c(\"FBLogger\")(\"messenger_search_fts\").mustfixThrow(\"current version is missing from manifest table\");return{current:g,next:b.get(d(\"MAWDbFTSManifest\").ManifestKeys.NEXT_VERSION),previous:b.get(d(\"MAWDbFTSManifest\").ManifestKeys.PREV_VERSION)}})}})()};return a}();g[\"default\"]=a}),98);\n__d(\"MAWMessageSearchManifestWriter\",[\"FBLogger\",\"MAWDbFTSManifest\",\"MAWFTSIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";var h={3.1:[\"3\"]},i=\"-1\";function j(a,b,c,d){return a!==c&&!((c=h[c])==null?void 0:c.includes(a))||b!==d}var k=function(a,b){return a.ftsManifest.get(b).then(function(c){return c==null?a.ftsManifest.put({isCurrent:b===d(\"MAWDbFTSManifest\").ManifestKeys.CURR_VERSION,isFullIndexingComplete:!0,key:b,lastMsgKeyViaFullIndexer:i,schemaVersion:\"\",tokenizerVersion:\"\"}).then(function(){}):a.ftsManifest.update(b,{isCurrent:b===d(\"MAWDbFTSManifest\").ManifestKeys.CURR_VERSION,isFullIndexingComplete:!0}).then(function(){})})},l=function(a){return a.ftsManifest.bulkGet([d(\"MAWDbFTSManifest\").ManifestKeys.CURR_VERSION,d(\"MAWDbFTSManifest\").ManifestKeys.NEXT_VERSION]).then(function(b){var e=b[0];b=b[1];var f=[];e!=null&&f.push(babelHelpers[\"extends\"]({},e,{isCurrent:!1,key:d(\"MAWDbFTSManifest\").ManifestKeys.PREV_VERSION}));b!=null&&f.push(babelHelpers[\"extends\"]({},b,{isCurrent:!0,key:d(\"MAWDbFTSManifest\").ManifestKeys.CURR_VERSION}));c(\"FBLogger\")(\"fts_manifest_writer\").info(\"Upgraded schema version from [%s, %s] to [%s, %s]\",e==null?void 0:e.schemaVersion,e==null?void 0:e.tokenizerVersion,b==null?void 0:b.schemaVersion,b==null?void 0:b.tokenizerVersion);return a.ftsManifest.bulkPut(f)}).then(function(){a.ftsManifest[\"delete\"](d(\"MAWDbFTSManifest\").ManifestKeys.NEXT_VERSION)})},m=function(a,b,c){return a.ftsManifest.get(b).then(function(e){return e==null?a.ftsManifest.put({isCurrent:b===d(\"MAWDbFTSManifest\").ManifestKeys.CURR_VERSION,isFullIndexingComplete:!0,key:b,lastMsgKeyViaFullIndexer:c,schemaVersion:\"\",tokenizerVersion:\"\"}).then(function(){}):a.ftsManifest.update(b,{isCurrent:b===d(\"MAWDbFTSManifest\").ManifestKeys.CURR_VERSION,lastMsgKeyViaFullIndexer:c}).then(function(){})})},n=function(a,b,e){return a.ftsManifest.get(d(\"MAWDbFTSManifest\").ManifestKeys.CURR_VERSION).then(function(f){if(f==null)return a.ftsManifest.put({isCurrent:!0,isFullIndexingComplete:!1,key:d(\"MAWDbFTSManifest\").ManifestKeys.CURR_VERSION,lastMsgKeyViaFullIndexer:i,schemaVersion:b,tokenizerVersion:e}).then(function(){c(\"FBLogger\")(\"fts_manifest_writer\").info(\"Set current version to [%s, %s]\",b,e)});else if(j(f.schemaVersion,f.tokenizerVersion,b,e))return a.ftsManifest.get(d(\"MAWDbFTSManifest\").ManifestKeys.NEXT_VERSION).then(function(f){if(f==null||f.schemaVersion!==b||f.tokenizerVersion!==e)return a.ftsManifest.put({isCurrent:!1,isFullIndexingComplete:!1,key:d(\"MAWDbFTSManifest\").ManifestKeys.NEXT_VERSION,lastMsgKeyViaFullIndexer:i,schemaVersion:b,tokenizerVersion:e}).then(function(){c(\"FBLogger\")(\"fts_manifest_writer\").info(\"Next version set to [%s, %s]\",b,e)});else c(\"FBLogger\")(\"fts_manifest_writer\").info(\"No changes made as next version is already set to [%s, %s]\",b,e)});else c(\"FBLogger\")(\"fts_manifest_writer\").info(\"FTS:Manifest Writer: No changes made, current:[%s, %s], latest:[%s, %s]\",f.schemaVersion,f.tokenizerVersion,b,e)})};a=function(){function a(){}var b=a.prototype;b.setLatestVersion=function(a,b){return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsManifest:d(\"MAWTransactionMode\").READWRITE},function(c){return function(){return n(c,a,b)}})()};b.upgradeVersion=function(){return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsManifest:d(\"MAWTransactionMode\").READWRITE},function(a){return function(){return l(a)}})()};b.markFullIndexingComplete=function(a){return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsManifest:d(\"MAWTransactionMode\").READWRITE},function(b){return function(){return k(b,a?d(\"MAWDbFTSManifest\").ManifestKeys.CURR_VERSION:d(\"MAWDbFTSManifest\").ManifestKeys.NEXT_VERSION)}})()};b.updateLastFullIndexBatch=function(a,b){return d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsManifest:d(\"MAWTransactionMode\").READWRITE},function(c){return function(){return m(c,a?d(\"MAWDbFTSManifest\").ManifestKeys.CURR_VERSION:d(\"MAWDbFTSManifest\").ManifestKeys.NEXT_VERSION,b)}})()};return a}();g[\"default\"]=a}),98);\n__d(\"WAFtsIndexerSelector\",[\"Promise\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f){\"use strict\";var g;a=function(){function a(a){this.$1=new Map(),this.versionsInfo=a}var c=a.prototype;c.$2=function(a,b,c){var d;d=(d=this.$1.get(a))!=null?d:new Map();this.$1.get(a)==null&&this.$1.set(a,d);d.set(b,c)};c.$3=function(a,b){return(a=this.$1.get(a))==null?void 0:a.get(b)};c.select=function(a){var c,d,e,f,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!(a==null)){i.next=2;break}return i.abrupt(\"return\",(g||(g=b(\"Promise\"))).resolve(null));case 2:c=this.$3(a.schemaVersion,a.tokenizerVersion);d=this.versionsInfo,e=d.indexers,f=d.tokenizers;if(!(c==null&&f[a.tokenizerVersion]&&e[a.schemaVersion])){i.next=12;break}i.next=7;return b(\"regeneratorRuntime\").awrap(f[a.tokenizerVersion]());case 7:h=i.sent;i.next=10;return b(\"regeneratorRuntime\").awrap(e[a.schemaVersion](h));case 10:c=i.sent,c!=null&&this.$2(a.schemaVersion,a.tokenizerVersion,c);case 12:return i.abrupt(\"return\",(g||(g=b(\"Promise\"))).resolve(c));case 13:case\"end\":return i.stop()}},null,this)};return a}();f[\"default\"]=a}),66);\n__d(\"WAFtsBaseOrchestrator\",[\"Promise\",\"WACustomError\",\"WAFtsIndexerSelector\",\"WANullthrows\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;a=function(){function a(a,b,d){this.$3=new(c(\"WAFtsIndexerSelector\"))(d),this.$2=a,this.$1=b}var e=a.prototype;e.__initVersions=function(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:a===void 0&&(a=!1);if(!(this.$4==null||a)){c.next=5;break}c.next=4;return b(\"regeneratorRuntime\").awrap(this.$2.versions());case 4:this.$4=c.sent;case 5:return c.abrupt(\"return\",this.$4);case 6:case\"end\":return c.stop()}},null,this)};e.__handleFullIndexerProgress=function(a,d,e,f){var g;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:if(!(e!=null)){h.next=3;break}h.next=3;return b(\"regeneratorRuntime\").awrap(this.$1.updateLastFullIndexBatch(a,e));case 3:if(!(d===1)){h.next=16;break}h.next=6;return b(\"regeneratorRuntime\").awrap(this.$1.markFullIndexingComplete(a));case 6:if(a){h.next=16;break}h.next=9;return b(\"regeneratorRuntime\").awrap(this.$1.upgradeVersion());case 9:h.next=11;return b(\"regeneratorRuntime\").awrap(this.__initVersions(!0));case 11:h.next=13;return b(\"regeneratorRuntime\").awrap(this.$3.select(c(\"WANullthrows\")(this.$4).previous));case 13:g=h.sent;h.next=16;return b(\"regeneratorRuntime\").awrap(c(\"WANullthrows\")(g).eraseIndex());case 16:if(!f){h.next=19;break}h.next=19;return b(\"regeneratorRuntime\").awrap(f(d,e));case 19:case\"end\":return h.stop()}},null,this)};e.__startFullIndexingForVersion=function(a,c){var d=this,e,f,g,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:if(!(a==null)){j.next=2;break}return j.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve([]));case 2:e=a.isCurrent,f=a.lastMsgKeyViaFullIndexer,g=a.isFullIndexingComplete;if(g){j.next=11;break}j.next=6;return b(\"regeneratorRuntime\").awrap(this.__getIndexer(e));case 6:i=j.sent;if(!i){j.next=9;break}return j.abrupt(\"return\",i.full(function(a,b){return d.__handleFullIndexerProgress(e,a,b,c)},f));case 9:j.next=12;break;case 11:e||this.__handleFullIndexerProgress(!1,1,null,null);case 12:return j.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve([]));case 13:case\"end\":return j.stop()}},null,this)};e.__getIndexer=function(a){return b(\"regeneratorRuntime\").async(function(d){while(1)switch(d.prev=d.next){case 0:a===void 0&&(a=!0);d.next=3;return b(\"regeneratorRuntime\").awrap(this.__initVersions());case 3:return d.abrupt(\"return\",a?this.$3.select(c(\"WANullthrows\")(this.$4).current):this.$3.select(c(\"WANullthrows\")(this.$4).next));case 4:case\"end\":return d.stop()}},null,this)};e.purge=function(a){return(h||(h=b(\"Promise\"))).reject(new(d(\"WACustomError\").UnimplementedMethod)(\"purge\"))};e.purge__DEPRECATED_DO_NOT_USE=function(a,c,e){return(h||(h=b(\"Promise\"))).reject(new(d(\"WACustomError\").UnimplementedMethod)(\"purge\"))};e.purgeChat=function(a){return(h||(h=b(\"Promise\"))).reject(new(d(\"WACustomError\").UnimplementedMethod)(\"purge\"))};e.search=function(a,c){return(h||(h=b(\"Promise\"))).reject(new(d(\"WACustomError\").UnimplementedMethod)(\"search\"))};e.incremental=function(a){return(h||(h=b(\"Promise\"))).reject(new(d(\"WACustomError\").UnimplementedMethod)(\"incremental\"))};e.full=function(a,c){return(h||(h=b(\"Promise\"))).reject(new(d(\"WACustomError\").UnimplementedMethod)(\"full\"))};return a}();g[\"default\"]=a}),98);\n__d(\"WAFtsQuickSwitchOrchestrator\",[\"Promise\",\"WAFtsBaseOrchestrator\",\"WAFtsSearchResultComparator\",\"WANullthrows\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=function(){return{eof:!0,messages:[],status:200}};function j(a,b){return function(c){return a.getMessageSource().removeFromBacklog(c).then(function(){if(b)return b(c)})}}a=function(a){babelHelpers.inheritsLoose(d,a);function d(){return a.apply(this,arguments)||this}var e=d.prototype;e.purge=function(a){var c,d,e,f,g;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all([this.__getIndexer(!0),this.__getIndexer(!1)]));case 2:e=i.sent;f=e[0];g=e[1];return i.abrupt(\"return\",(h||(h=b(\"Promise\"))).all([(c=f==null?void 0:f.purge(a))!=null?c:!1,(d=g==null?void 0:g.purge(a))!=null?d:!0]).then(function(a){var b=a[0];a=a[1];return Boolean(b)&&a}));case 6:case\"end\":return i.stop()}},null,this)};e.purge__DEPRECATED_DO_NOT_USE=function(a,c,d){var e,f,g,i,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all([this.__getIndexer(!0),this.__getIndexer(!1)]));case 2:g=k.sent;i=g[0];j=g[1];return k.abrupt(\"return\",(h||(h=b(\"Promise\"))).all([(e=i==null?void 0:i.purge__DEPRECATED_DO_NOT_USE(a,c,d))!=null?e:!1,(f=j==null?void 0:j.purge__DEPRECATED_DO_NOT_USE(a,c,d))!=null?f:!0]).then(function(a){var b=a[0];a=a[1];return Boolean(b)&&a}));case 6:case\"end\":return k.stop()}},null,this)};e.purgeChat=function(a){var c,d,e,f,g;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all([this.__getIndexer(!0),this.__getIndexer(!1)]));case 2:e=i.sent;f=e[0];g=e[1];return i.abrupt(\"return\",(h||(h=b(\"Promise\"))).all([(c=f==null?void 0:f.purgeChat(a))!=null?c:!1,(d=g==null?void 0:g.purgeChat(a))!=null?d:!0]).then(function(a){var b=a[0];a=a[1];return Boolean(b)&&a}));case 6:case\"end\":return i.stop()}},null,this)};e.search=function(a,d){var e,f,g,j,k,l,m,n,o,p,q,r;return b(\"regeneratorRuntime\").async(function(s){while(1)switch(s.prev=s.next){case 0:s.next=2;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all([this.__getIndexer(!0),this.__getIndexer(!1)]));case 2:g=s.sent;j=g[0];k=g[1];s.next=7;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all([(e=j==null?void 0:j.search(a,d))!=null?e:i(),(f=k==null?void 0:k.search(a,d))!=null?f:i()]));case 7:l=s.sent;m=l[0];n=l[1];o=[].concat(m.messages,n.messages);p=new Set();if(!(o.length>0)){s.next=17;break}q=[];o.forEach(function(a){var b=a.id,c=a.chatId;b=b+\",\"+c;p.has(b)||(q.push(a),p.add(b))});r=q.sort(c(\"WAFtsSearchResultComparator\"));return s.abrupt(\"return\",{eof:m.eof&&n.eof,messages:r,status:200});case 17:return s.abrupt(\"return\",i());case 18:case\"end\":return s.stop()}},null,this)};e.incremental=function(a){var d,e,f,g,i,k;return b(\"regeneratorRuntime\").async(function(l){while(1)switch(l.prev=l.next){case 0:l.next=2;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all([this.__getIndexer(!0),this.__getIndexer(!1)]));case 2:e=l.sent;f=e[0];g=e[1];i=c(\"WANullthrows\")((d=g)!=null?d:f);k=j(i,a);return l.abrupt(\"return\",i.incremental(k));case 8:case\"end\":return l.stop()}},null,this)};e.full=function(a,c){var d;return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b(\"regeneratorRuntime\").awrap(this.__initVersions());case 2:d=c.sent;if(!(d.next!=null)){c.next=7;break}return c.abrupt(\"return\",this.__startFullIndexingForVersion(d.next,a));case 7:return c.abrupt(\"return\",this.__startFullIndexingForVersion(d.current,a));case 8:case\"end\":return c.stop()}},null,this)};return d}(c(\"WAFtsBaseOrchestrator\"));g[\"default\"]=a}),98);\n__d(\"isContentSearchEnabled\",[\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){return c(\"gkx\")(\"24161\")}g[\"default\"]=a}),98);\n__d(\"isWAFTSContentSearchEnabled\",[\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){return c(\"gkx\")(\"24164\")}g[\"default\"]=a}),98);\n__d(\"MAWFTSWorker\",[\"FBLogger\",\"MAWFTSVersionsInformation\",\"MAWMessageSearchManifestReader\",\"MAWMessageSearchManifestWriter\",\"MAWTransactionMode\",\"MAWTransactor\",\"WAFtsQuickSwitchOrchestrator\",\"asyncToGeneratorRuntime\",\"isContentSearchEnabled\",\"isWAFTSContentSearchEnabled\",\"nullthrows\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=c(\"isContentSearchEnabled\")()&&c(\"isWAFTSContentSearchEnabled\")(),i=function(){a.getInstance=function(){var b=a.instance;if(b!=null)return b;b=new a();a.instance=b;return b};a.resetInstance=function(){a.instance=null};function a(){this.$1=!1,this.$2=!1,this.$3=null,this.$4=null,this.$5=null,this.$6=!1,this.$7=[],this.$8=[],c(\"FBLogger\")(\"fts_worker\").info(\"New MAWFTSWorker instance\")}var e=a.prototype;e.shouldTerminateAll=function(){return this.$6};e.forceTerminate=function(){this.$6=!0};e.registerIncrementalIndexCallback=function(a){this.$7.push(a)};e.registerFullIndexCallback=function(a){this.$8.push(a)};e.performInit=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){if(!h||this.$1||this.$2)return;this.$2=!0;try{yield this.$9(),this.$1=!0}catch(a){c(\"FBLogger\")(\"fts_worker\").catching(a).mustfix(\"Failed to initialize FTS worker\")}finally{this.$2=!1}});function d(){return a.apply(this,arguments)}return d}();e.$9=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=new(c(\"MAWMessageSearchManifestWriter\"))(),b=new(c(\"MAWMessageSearchManifestReader\"))();this.$4=a;this.$5=b;yield a.setLatestVersion(d(\"MAWFTSVersionsInformation\").LATEST_INDEXER_VERSION,d(\"MAWFTSVersionsInformation\").LATEST_TOKENIZER_VERSION);this.$3=new(c(\"WAFtsQuickSwitchOrchestrator\"))(b,a,d(\"MAWFTSVersionsInformation\").VERSIONS_INFO)});function e(){return a.apply(this,arguments)}return e}();e.index=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=this;if(!h)return;var d=c(\"nullthrows\")(this.$3),e=function(){var c=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(b){for(var c of a.$7)yield c(b)});return function(a){return c.apply(this,arguments)}}();yield d.incremental(e)});function d(){return a.apply(this,arguments)}return d}();e.indexFull=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=this;if(!h)return;var d=c(\"nullthrows\")(this.$3),e=function(){var c=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(b,c){for(var d of a.$8)yield d(b,c)});return function(a,b){return c.apply(this,arguments)}}();yield d.full(e)});function d(){return a.apply(this,arguments)}return d}();e.search=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){var e=c(\"nullthrows\")(this.$3);e=(yield e.search(a,b));if(e.status!==200){c(\"FBLogger\")(\"maw_fts_worker\").mustfix(\"WA FTS returns with bad status code\");return[]}var f=e.messages.map(function(a){return Number(a.id)});a=(yield d(\"MAWTransactor\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"search\",function(a){return function(){return a.messages.bulkGet(f)}})());return a.filter(Boolean)});function e(b,c){return a.apply(this,arguments)}return e}();return a}();i.instance=null;function a(){return i.getInstance()}function e(){i.resetInstance()}g.getFTSWorker=a;g.resetFTSWorker=e}),98);\n__d(\"MAWMessageSearchSignaller\",[\"MAWFTSWorker\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){function a(){}var b=a.prototype;b.shouldTerminateAll=function(){var a=d(\"MAWFTSWorker\").getFTSWorker();return a.shouldTerminateAll()};return a}();g[\"default\"]=a}),98);\n__d(\"isSearchEnabled\",[\"qex\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){return c(\"qex\")._(\"729\")===!0}g[\"default\"]=a}),98);\n__d(\"MAWFTSDataSync\",[\"FBLogger\",\"MAWBridgeParticipants\",\"MAWBridgeSearchMsg\",\"MAWBridgeTypesCreators\",\"MAWDataSyncQueue\",\"MAWDexieTable\",\"MAWFTSIndexedDb\",\"MAWFTSWorker\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"MAWVault\",\"WAMsgType\",\"asyncToGeneratorRuntime\",\"gkx\",\"isContentSearchEnabled\",\"isSearchEnabled\",\"isWAFTSContentSearchEnabled\",\"minisearch\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=1e4;f=c(\"gkx\")(\"23913\");f=f?{fuzzy:.125,prefix:!0}:{fuzzy:.2,prefix:!0};var i=new(c(\"minisearch\"))({fields:[\"content\"],searchOptions:f}),j=new Set([\"groupInfo\",\"messages\",\"participants\"]),k=new Map();function l(a,b){return a+\":\"+b}function m(a,b){b.forEach(function(b){b=l(a,b);var c=k.get(b);c&&(i.remove(c),k[\"delete\"](b))})}function n(a){var b=k.get(a.id);b!=null&&(i.remove(b),k[\"delete\"](a.id));k.set(a.id,a);i.add(a)}function o(a){if(a==null)return;var b=a.name;if(b==null)return;b={content:b,id:l(\"groupInfo\",a.groupJid),raw:a,type:\"DbGroupInfo\"};n(b)}var p=function(a){return a.threads.get({jid:d(\"MAWGlobals\").getMyUserJid()}).then(function(b){if(b==null)return;a.participants.get({threadId:b.chatId,userJid:d(\"MAWGlobals\").getMyUserJid()}).then(function(a){if(a==null)return})[\"catch\"](function(){c(\"FBLogger\")(\"mpf_web_foundations\").mustfix(\"Failed to fetch participant details for e2ee self thread\")})})[\"catch\"](function(){c(\"FBLogger\")(\"mpf_web_foundations\").mustfix(\"Failed to fetch self e2ee thread from DB\")})};function q(a,b){b===void 0&&(b=!1);if(a==null)return;if(a.userJid===d(\"MAWGlobals\").getMyUserJid()&&!b)return;b={content:\"\",id:l(\"participants\",a.id),raw:a,type:\"DbParticipant\"};n(b)}function r(a){if(a==null)return;switch(a.type){case d(\"WAMsgType\").TEXT:a={content:d(\"MAWVault\").unvault(a.msgContent.content),id:l(\"messages\",a.rowId),raw:a,type:\"DbMsg\"};n(a);return;default:return}}var s=d(\"MAWFTSIndexedDb\").makeMsgrFTSTransactor({ftsBackloggedMessages:d(\"MAWTransactionMode\").READWRITE},function(a){return function(b){return d(\"MAWDexieTable\").dexieAll(b.map(function(b){var c=b.value.tableName;if(c!==\"messages\")return null;c=b.value.key;if(c==null||typeof c!==\"number\")return null;if(b.type===\"delete\")return a.ftsBackloggedMessages[\"delete\"](c);else if(b.type===\"add\"||b.type===\"put\")return a.ftsBackloggedMessages.put({rowId:c});return null}).filter(Boolean))}}),t=function(a,b){return b.filter(function(b){return b.value.tableName===a}).map(function(a){return a.value.key})},u=d(\"MAWIndexedDb\").makeMsgrTransactor({groupInfo:d(\"MAWTransactionMode\").READONLY,messages:d(\"MAWTransactionMode\").READONLY,participants:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"FTS\",function(a){return function(b){var e=t(\"groupInfo\",b),f=t(\"messages\",b),g=t(\"participants\",b);return d(\"MAWDexieTable\").dexieAll([e.length>0&&a.groupInfo.bulkGet(e).then(function(a){m(\"groupInfo\",e),a.forEach(o)}),c(\"isContentSearchEnabled\")()&&!c(\"isWAFTSContentSearchEnabled\")()&&f.length>0&&a.messages.bulkGet(f).then(function(a){m(\"messages\",f),a.forEach(r)}),g.length>0&&a.participants.bulkGet(g).then(function(a){m(\"participants\",g),a.forEach(function(a){q(a)})})].filter(Boolean))}}),v=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(!c(\"isContentSearchEnabled\")()||!c(\"isWAFTSContentSearchEnabled\")())return;a=a.filter(function(a){return a.value.tableName===\"messages\"});if(a.length===0)return;yield s(a);a=(yield d(\"MAWFTSWorker\").getFTSWorker());yield a.index()});return function(b){return a.apply(this,arguments)}}(),w=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=a.filter(function(a){a=a.value;return j.has(a.tableName)});a.length>0&&(yield u(a),yield v(a))});return function(b){return a.apply(this,arguments)}}(),x=d(\"MAWIndexedDb\").makeMsgrTransactor({groupInfo:d(\"MAWTransactionMode\").READONLY,messages:d(\"MAWTransactionMode\").READONLY,participants:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"FTS\",function(a){return function(){var b=[a.groupInfo.toCollection().reverse().each(o),c(\"isContentSearchEnabled\")()&&!c(\"isWAFTSContentSearchEnabled\")()?a.messages.toCollection().reverse().limit(h).each(r):null,a.participants.toCollection().each(function(a){if(a==null)return;q(a)}),p(a)].filter(Boolean);return d(\"MAWDexieTable\").dexieAll(b).then(function(){})}});function a(){return y.apply(this,arguments)}function y(){y=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){if(!c(\"isSearchEnabled\")())return!1;var a=c(\"isContentSearchEnabled\")()&&c(\"isWAFTSContentSearchEnabled\")();try{if(a){a=d(\"MAWFTSWorker\").getFTSWorker();yield a.performInit();yield a.indexFull()}d(\"MAWDataSyncQueue\").registerDataSyncCallback(w);yield x();return!0}catch(a){c(\"FBLogger\")(\"mpf_web_foundations\").catching(a).mustfix(\"Error paging results from MAWDB for FTS, searching messages will not work this session\");return!1}});return y.apply(this,arguments)}function z(a){return A.apply(this,arguments)}function A(){A=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b=a.query;a=a.searchMode;if(a!==d(\"MAWBridgeSearchMsg\").MESSAGE_CONTENT_SEARCH)return[];a=c(\"isContentSearchEnabled\")()&&c(\"isWAFTSContentSearchEnabled\")();if(!a)return[];a=d(\"MAWFTSWorker\").getFTSWorker();a=(yield a.search(b));var e=[];return a.map(function(a){return babelHelpers[\"extends\"]({matchedTerms:e,recordType:\"msg\"},d(\"MAWBridgeSearchMsg\").createBridgeSearchMsg(a))})});return A.apply(this,arguments)}function B(a){var b=a.query;a=a.searchMode;var e=c(\"isContentSearchEnabled\")()&&!c(\"isWAFTSContentSearchEnabled\")();if(a===d(\"MAWBridgeSearchMsg\").MESSAGE_CONTENT_SEARCH&&!e)return[];a=i.search(b);return a.map(function(a){var b=a.id;a=a.terms;b=k.get(b);if(b==null)return;switch(b.type){case\"DbGroupInfo\":return babelHelpers[\"extends\"]({matchedTerms:a,recordType:\"groupInfo\"},d(\"MAWBridgeTypesCreators\").createBridgeGroupInfo(b.raw));case\"DbMsg\":if(!e)return;return babelHelpers[\"extends\"]({matchedTerms:a,recordType:\"msg\"},d(\"MAWBridgeSearchMsg\").createBridgeSearchMsg(b.raw));case\"DbParticipant\":return babelHelpers[\"extends\"]({matchedTerms:a,recordType:\"participant\"},d(\"MAWBridgeParticipants\").createBridgeParticipant(b.raw));default:return}}).filter(Boolean)}function e(a){return C.apply(this,arguments)}function C(){C=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(!c(\"isSearchEnabled\")())return[];var b=B(a);a=(yield z(a));b=b.concat(a);return b});return C.apply(this,arguments)}g.initFTS=a;g.search=e}),98);\n__d(\"MAWRetryUploads\",[\"MAWEBSwitch\",\"MAWEBUploadTrackingUtils\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWJobDefinitions\",\"MAWQplProxy\",\"MAWTransactionMode\",\"MAWUploadRetryStatusUtil\",\"Promise\",\"WAJobOrchestratorTypes\",\"WALogger\",\"WAShiftTimer\",\"WATimeUtils\",\"asyncToGeneratorRuntime\",\"gkx\",\"promiseDone\",\"qex\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Encrypted backups are not enabled for the upload flow\"]);i=function(){return a};return a}function j(){return k.apply(this,arguments)}function k(){k=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){if(!(c(\"gkx\")(\"23947\")||c(\"qex\")._(\"229\")===!0))return;if(!c(\"MAWEBSwitch\").isEnabled()){d(\"WALogger\").LOG(i());q=Math.max(q*2,d(\"WATimeUtils\").FIVE_MINUTES);o.onOrAfter(q);return}if(c(\"MAWEBSwitch\").isEnabled()&&c(\"gkx\")(\"23914\")){var a=(yield d(\"MAWUploadRetryStatusUtil\").checkRetroactiveBackupsStateStore());a&&c(\"promiseDone\")(d(\"MAWGlobals\").getJobManager().waitUntilPersisted(d(\"MAWJobDefinitions\").jobSerializers.uploadRetroactiveThreadsAndMessages({priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW})))}a=(yield l());if(a.length>0){var e=d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(521479578,\"1403\"),{\"int\":{messages:a.length}}),f=(yield m(a.map(function(a){return a.externalId}))),g=new Map(),j=new Map();a.forEach(function(a){g.set(a.externalId,a.traceId);var b=d(\"MAWEBUploadTrackingUtils\").genInstanceKeyOnly();j.set(a.externalId,b);d(\"MAWEBUploadTrackingUtils\").startUploadTracking(a.externalId,void 0,\"uploadretry\",b)});yield n(a.map(function(a){return[a.externalId,a.lastRetryTs]}));yield d(\"MAWGlobals\").getJobManager().waitUntilPersisted(d(\"MAWJobDefinitions\").jobSerializers.uploadMessagesBackup(f,[],[],[],[],g,j,void 0,{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW}));e.endSuccess()}o.onOrAfter(r);return(h||(h=b(\"Promise\"))).resolve()});return k.apply(this,arguments)}var l=d(\"MAWIndexedDb\").makeMsgrTransactor({uploadRetryStatus:d(\"MAWTransactionMode\").READONLY},\"getRetryItems\",function(a){return function(){return a.uploadRetryStatus.filter(function(a){return a.lastRetryTs+r<d(\"WATimeUtils\").millisTime()}).toArray()}}),m=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"getMsgsEB\",function(a){return function(b){return a.messages.where(\"externalId\").anyOf(b).primaryKeys()}}),n=d(\"MAWIndexedDb\").makeMsgrTransactor({uploadRetryStatus:d(\"MAWTransactionMode\").READWRITE},\"housekeepUploadRetryTable\",function(a){return function(b){return a.uploadRetryStatus.bulkDelete(b)}}),o=new(d(\"WAShiftTimer\").ShiftTimer)(function(){c(\"promiseDone\")(j())}),p=5e3,q=p,r=6e4;function a(){o.onOrAfter(p)}g.retryUploads=j;g.init=a}),98);\n__d(\"WASyncdCryptoUtils\",[\"WACryptoUtils\",\"WAErr\",\"WASyncdKeyTypes\",\"WATextEncoding\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){if(a.length===0)throw c(\"WAErr\")(\"buffers length is zero\");if(a.length===1)return a[0];var b=a.map(function(a){return a.byteLength});b=b.reduce(function(a,b){return a+b});b=new Uint8Array(b);var d=0,e;for(e=0;e<a.length;e++)b.set(new Uint8Array(a[e]),d),d+=a[e].byteLength;return b.buffer}function b(a,b,d){if(b<0||d<0)throw c(\"WAErr\")(\"buffers length is zero\");var e=new Array(3);a=new Uint8Array(a);e[0]=a.slice(0,b).buffer;e[1]=a.slice(b,b+d).buffer;e[2]=a.slice(b+d).buffer;return e}function e(a){return Uint8Array.from(a.split(\" \").map(function(a){return parseInt(a,16)}))}function f(a){return Array.from(new Uint8Array(d(\"WASyncdKeyTypes\").fromSyncKeyId(a))).map(function(a){return a.toString(16)}).toString().replace(\/,\/g,\" \")}function h(a){return Array.from(new Uint8Array(a)).map(function(a){return a.toString(16).padStart(2,\"0\")}).join(\"\")}function i(a){var b=new ArrayBuffer(8);new DataView(b).setUint32(4,a,!1);return b}var j=d(\"WATextEncoding\").newTextEncoder();function k(a){return j.encode(a)}function l(a,b){return d(\"WACryptoUtils\").arrayBuffersEqual(d(\"WASyncdKeyTypes\").fromSyncKeyId(a),d(\"WASyncdKeyTypes\").fromSyncKeyId(b))}g.combine=a;g.split=b;g.hexToUint8Array=e;g.syncKeyIdToHex=f;g.arrayBufferToHexPadded=h;g.to64BitNetworkOrder=i;g.toUtf8=k;g.syncKeyIdsEqual=l}),98);\n__d(\"MAWMailboxUploadDataSync\",[\"MAWDataSyncQueue\",\"MAWEBSwitch\",\"MAWEBUploadTrackingUtils\",\"MAWGlobals\",\"MAWJobDefinitions\",\"MAWRetryUploads\",\"WACryptoHmac\",\"WAGlobals\",\"WAHex\",\"WAJobOrchestratorTypes\",\"WALogger\",\"WASyncdCryptoUtils\",\"asyncToGeneratorRuntime\",\"gkx\",\"justknobx\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Encrypted backups are not enabled for the upload flow\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] Error handling backup batch: \",\"\"]);i=function(){return a};return a}var j=new Set([\"messages\",\"pendingStanzas\",\"reactions\",\"xma\"]),k=function(a,b){return Array.from(new Set(b.filter(function(b){return b.value.tableName===a}).map(function(a){return a.value.key})))},l=d(\"WAHex\").randomHex(32);function m(a){a=d(\"WASyncdCryptoUtils\").toUtf8(JSON.stringify(a));return d(\"WACryptoHmac\").hmacSha256(l,a).then(function(a){return d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(a)})}function n(a,b){return o.apply(this,arguments)}function o(){o=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){if(d(\"WAGlobals\").getConfig().useEbUploadQueue())return;var e=d(\"MAWEBUploadTrackingUtils\").cloneAndClearInstanceMap();if(!c(\"MAWEBSwitch\").isEnabled()){d(\"WALogger\").LOG(h());e.forEach(function(a,b){d(\"MAWEBUploadTrackingUtils\").endSuccess(a,\"upload_tracking_cancelled_eb_turned_off_middleware\",{string:{externalId:b,from:\"backup state turned off\"}})});return}e.forEach(function(a,b){d(\"MAWEBUploadTrackingUtils\").addPoint(a,\"upload_tracking_middleware_pickup\")});b=(b=b==null?void 0:b.isUnloading)!=null?b:!1;var f=k(\"messages\",a),g=k(\"pendingStanzas\",a),i=[],j=k(\"reactions\",a);a=k(\"xma\",a);if(f.length+g.length+j.length+a.length===0)return;b=b?void 0:yield m({messageIds:f,pendingStanzaIds:g,reactionIds:j,threadIds:i,xmaIds:a});return d(\"MAWGlobals\").getJobManager().waitUntilPersisted(d(\"MAWJobDefinitions\").jobSerializers.uploadMessagesBackup(f,i,g,j,a,void 0,e,b,{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW}))});return o.apply(this,arguments)}var p=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){try{a=a.filter(function(a){return j.has(a.value.tableName)});if(a.length===0)return;yield n(a,b)}catch(a){d(\"WALogger\").ERROR(i(),a)}});return function(b,c){return a.apply(this,arguments)}}();a=function(){if(d(\"WAGlobals\").getConfig().useEbUploadQueue())return;if(!c(\"gkx\")(\"23914\")||!c(\"justknobx\")._(\"1071\"))return;d(\"MAWDataSyncQueue\").registerDataSyncCallback(p);d(\"MAWRetryUploads\").init();d(\"MAWEBUploadTrackingUtils\").setMiddlewareInitRan()};g.processUploadQueue=n;g.initMailboxUpload=a}),98);\n__d(\"MAWDbDeviceChangeAlerts\",[],(function(a,b,c,d,e,f){\"use strict\";b=\"add\";c=\"keyChange\";d=\"remove\";function a(a){return a}f.ADD=b;f.KEY_CHANGE=c;f.REMOVE=d;f.unsafeCoerceToDeviceChangeAlertsID=a}),66);\n__d(\"MAWDbHistorySyncQRCodeData\",[],(function(a,b,c,d,e,f){\"use strict\";a=\"qrCodeRowId\";f.qrCodeRowId=a}),66);\n__d(\"MAWDbStaleQueue\",[\"MAWCurrentUser\",\"MAWDbVersion\",\"MAWIndexedDbMetadata\",\"MAWODSProxy\",\"MAWPersistedQueueApi\",\"WAOdsEnums\",\"WAPersistedQueue\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=\"staleQueue\",i=null;function j(){if(i)return i;var a=d(\"WAPersistedQueue\").initPersistedQueue(h,d(\"MAWPersistedQueueApi\").dexieApiForPersistedQueue());i=a;return a}function a(a,b){return k.apply(this,arguments)}function k(){k=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,c){a.forEach(function(a){d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.POISON_QUEUE_ENTTITY,key:\"\"+a.type})});var e=j(),f=d(\"MAWCurrentUser\").getID(),g=(f=(yield d(\"MAWDbVersion\").getDexieDbVersion(d(\"MAWIndexedDbMetadata\").dbName(f),!1)))!=null?f:0;a.forEach(function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){yield e.write({dbVersion:g,exception:c,stanza:a})});return function(b){return a.apply(this,arguments)}}());return e.flush()});return k.apply(this,arguments)}c=function(){return j().read(1).then(function(a){return a.length===0})};e=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a===void 0&&(a=500);a=j().read(a);a=(yield a.then(function(a){return a.flatMap(function(a){return a})}));return a});return function(b){return a.apply(this,arguments)}}();g.add=a;g.isEmpty=c;g.read=e}),98);\n__d(\"MAWDbTasks\",[],(function(a,b,c,d,e,f){\"use strict\";a={cleanupErroneousEphemeralSettingsS401595:\"cleanupErroneousEphemeralSettingsS401595\",cleanupExcessiveLogs:\"cleanupExcessiveLogs\",deleteExpiredKeys:\"deleteExpiredKeys\",generatePrekeys:\"generatePrekeys\",notifyDeviceRegistration:\"notifyDeviceRegistration\",queryGroups:\"queryGroups\",reprocessRevokeStanzasS397680:\"reprocessRevokeStanzasS397680\",requestAllSyncdMissingKeys:\"requestAllSyncdMissingKeys\",rotateCAT:\"rotateCAT\",rotateKey:\"rotateKey\",syncAbProps:\"syncAbProps\",syncdSyncAllCollections:\"syncdSyncAllCollections\"};f.Tasks=a}),66);\n__d(\"MAWWriteMetaSyncsTxns\",[\"MAWDbDeletedMessages\",\"MAWDbPendingStanza\",\"MAWDbPendingStanzaTxns\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWThreadManagementTxns\",\"MAWWriteDeleteMessageTxns\",\"WAAssertUnreachable\",\"WALogger\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received action: \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received chatRead: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[MAWWriteMetaSyncsTxns] Thread delete stanza was processed before thread insertion \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received chatDelete: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received chatArchive: \",\"\"]);l=function(){return a};return a}var m=30*d(\"WATimeUtils\").DAY_SECONDS;function n(a,b){d(\"WALogger\").LOG(l(),b);return d(\"MAWDexieTable\").dexieResolve()}function o(a,b){d(\"WALogger\").LOG(k(),b);var c=b.messageRange;c=c!=null?d(\"MAWDbPendingStanzaTxns\").putPendingStanza(a,{content:{metaSyncMessageRange:c},type:d(\"MAWDbPendingStanza\").PENDING_TYPE.DELETE_THREAD},m,b.chatJid,d(\"MAWDbPendingStanza\").PENDING_TYPE.DELETE_THREAD):d(\"MAWDexieTable\").dexieResolve();return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbThreadTxns\").getThreadByJid(a,b.chatJid),c]).then(function(c){c=c[0];if(c.success)return d(\"MAWThreadManagementTxns\").metaSyncChatDeleteThread(a,c.value,b.messageRange,d(\"MAWDbDeletedMessages\").DbDeletedMsgReasonEnum.cast(b.type));else d(\"WALogger\").LOG(j(),b.chatJid)})}function p(a,b){d(\"WALogger\").LOG(i(),b);return d(\"MAWDexieTable\").dexieResolve()}function a(a,b){if(b.chatAction)return q(a,b.chatAction);else if(b.messageAction)return r(a,b.messageAction);return d(\"MAWDexieTable\").dexieResolve()}function q(a,b){d(\"WALogger\").LOG(h(),b);switch(b.type){case\"chat_archive\":return n(a,b);case\"chat_delete\":return o(a,b);default:b.type;return p(a,b)}}function r(a,b){switch(b.type){case\"delete_for_me\":return d(\"MAWWriteDeleteMessageTxns\").handleDeleteForMe(a,b).then(function(){});default:return c(\"WAAssertUnreachable\")(b.type)}}g.PENDING_DELETE_THREAD_EXPIRATION_IN_SEC=m;g.handleChatDelete=o;g.handleMetaSyncAction=a}),98);\n__d(\"MAWWriteThreadHotlikeCustomizationAdminMsgTxns\",[\"MAWCurrentUser\",\"MAWLocalizationType\",\"MAWLocalizationUtils\",\"MAWWriteMsgTxns\",\"WATimeUtils\",\"emptyFunction\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,e,f,g){return a.threads.get(f).then(function(h){if(h==null)throw c(\"err\")(\"Invalid chat Id when try to write admin message for thread hotlike customization\");var i=b===d(\"MAWCurrentUser\").getID();i=i?d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_HOTLIKE:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_HOTLIKE;var j=[];i===d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_HOTLIKE?j.push(e):j.push(b,e);j=d(\"MAWLocalizationUtils\").buildUnstoredDbAdminMsg({adminMsgContent:j,adminType:i,version:1},f,h.jid,d(\"WATimeUtils\").castMillisTimeToUnixTime(g));return d(\"MAWWriteMsgTxns\").writeMsg(a,j,h).then(c(\"emptyFunction\"))})}g.writeThreadHotlikeCustomizationAdminMsg=a}),98);\n__d(\"MAWWriteThreadNicknameCustomizationAdminMsgTxns\",[\"MAWCurrentUser\",\"MAWLocalizationType\",\"MAWLocalizationUtils\",\"MAWWriteMsgTxns\",\"WATimeUtils\",\"emptyFunction\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,e,f,g,h){return a.threads.get(e).then(function(i){if(i==null)throw c(\"err\")(\"Invalid chat Id when try to write admin message for thread nickname customization\");var j=d(\"MAWCurrentUser\").getID(),k=b===j&&b!==g,l=g===j&&g!==b,m=g===b&&j===g;j=g===b&&j!==g;var n;m&&f.length>0?n=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_SET_OWN_NICKNAME:m&&f.length===0?n=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_OWN_NICKNAME:j&&f.length>0?n=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_SET_OWN_NICKNAME:j&&f.length===0?n=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME:k&&f.length>0?n=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME:k&&f.length===0?n=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME:l&&f.length>0?n=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME:l&&f.length===0?n=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_CURRENT_USER_NICKNAME:f.length>0?n=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME:n=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME;m=[];switch(n){case d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME:m.push(g,f);break;case d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME:case d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_SET_OWN_NICKNAME:m.push(b,f);break;case d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_SET_OWN_NICKNAME:m.push(f);break;case d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME:case d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME:m.push(g);break;case d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_CURRENT_USER_NICKNAME:m.push(b);break;case d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME:case d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME:m.push(b,g,f);break;default:break}j=d(\"MAWLocalizationUtils\").buildUnstoredDbAdminMsg({adminMsgContent:m,adminType:n,version:1},e,i.jid,d(\"WATimeUtils\").castMillisTimeToUnixTime(h));return d(\"MAWWriteMsgTxns\").writeMsg(a,j,i).then(c(\"emptyFunction\"))})}g.writeThreadNicknameCustomizationAdminMsg=a}),98);\n__d(\"MAWWriteThreadPhotoCustomizationAdminMsgTxns\",[\"MAWCurrentUser\",\"MAWLocalizationType\",\"MAWLocalizationUtils\",\"MAWWriteMsgTxns\",\"WATimeUtils\",\"emptyFunction\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,e,f){return a.threads.get(e).then(function(g){if(g==null)throw c(\"err\")(\"Invalid chat Id when try to write admin message for thread photo customization\");var h=b===d(\"MAWCurrentUser\").getID()?d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_PHOTO:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PHOTO,i=h===d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PHOTO?[b]:[];i=d(\"MAWLocalizationUtils\").buildUnstoredDbAdminMsg({adminMsgContent:i,adminType:h,version:1},e,g.jid,d(\"WATimeUtils\").castMillisTimeToUnixTime(f));return d(\"MAWWriteMsgTxns\").writeMsg(a,i,g).then(c(\"emptyFunction\"))})}g.writeThreadPhotoCustomizationAdminMsg=a}),98);\n__d(\"MAWWriteThreadThemeCustomizationAdminMsgTxns\",[\"MAWCurrentUser\",\"MAWLocalizationType\",\"MAWLocalizationUtils\",\"MAWWriteMsgTxns\",\"WATimeUtils\",\"emptyFunction\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,e,f,g,h){return a.threads.get(g).then(function(i){if(i==null)throw c(\"err\")(\"Invalid chat Id when try to write admin message for thread theme customization\");var j=b===d(\"MAWCurrentUser\").getID();j=j?d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_THEME:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_THEME;var k=[];j===d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_THEME?k.push(f):k.push(b,f);e!=null&&k.push(e);k=d(\"MAWLocalizationUtils\").buildUnstoredDbAdminMsg({adminMsgContent:k,adminType:j,version:1},g,i.jid,d(\"WATimeUtils\").castMillisTimeToUnixTime(h));return d(\"MAWWriteMsgTxns\").writeMsg(a,k,i).then(c(\"emptyFunction\"))})}g.writeThreadThemeCustomizationAdminMsg=a}),98);\n__d(\"MAWXMAExpirationTxns\",[\"MAWAuthor\",\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWXMAUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){return d(\"MAWDbMsgTxns\").getMsgsByMsgIds(a,b).then(function(b){var c=b.map(function(a){if(a.quote!=null&&d(\"MAWXMAUtils\").isXMAStoryReply(a.quote.content.xmaMessageType)){var b=babelHelpers[\"extends\"]({},a.quote.content,{mediaId:void 0});b={content:b,remoteJid:a.quote.remoteJid};return babelHelpers[\"extends\"]({},a,{quote:b})}}).filter(Boolean);return a.messages.bulkPut(c).then(function(){return c})})}function b(a,b){b=b.map(function(b){return h(a,b)});return d(\"MAWDexieTable\").dexieAll(b).then(function(a){return a.flat()})}function h(a,b){var c=d(\"MAWAuthor\").getAuthorUserJid(b.author);return a.messages.where(\"quoteExternalId\").equals(b.externalId).toArray().then(function(a){return a.length===0?[]:a.filter(function(a){var e=a.quote;a=a.threadJid;return d(\"MAWAuthor\").getAuthorUserJid(e==null?void 0:e.content.author)===c&&a===b.chat})})}g.updateExpiredStoryReplyMsg=a;g.getXMAShareReplyMsgsToUpdate=b}),98);\n__d(\"MAWAdminAddParticipantMsg\",[\"MAWGlobals\",\"MAWLocalizationType\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=1;function i(a,b,c){switch(a){case 1:return{adminMsgContent:[b],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU};case 2:return{adminMsgContent:[b,c],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER};default:return{adminMsgContent:[b,(a-1).toString()],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS}}}function j(a,b,c){switch(a){case 1:return{adminMsgContent:[b],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT};case 2:return{adminMsgContent:[b,c],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS};default:return{adminMsgContent:[b,(a-1).toString()],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS}}}function k(a,b,c,e){switch(a){case 1:return{adminMsgContent:[b,c],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER};case 2:return{adminMsgContent:[b,c,e],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER}}return{adminMsgContent:[b,c,(a-1).toString()],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER}}function l(a,b){switch(a){case 1:return{adminMsgContent:[],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU};case 2:return{adminMsgContent:[b],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU_AND_ONE_USER}}return{adminMsgContent:[(a-1).toString()],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU_AND_MORE_THAN_ONE_USER}}function m(a,b,c){switch(a){case 1:return{adminMsgContent:[b],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_ONE_USER};case 2:return{adminMsgContent:[b,c],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_TWO_USER}}return{adminMsgContent:[b,(a-1).toString()],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_MORE_THAN_TWO_USER}}function n(a,b){var c=d(\"MAWGlobals\").getMyUserJid(),e=b[0],f=b[1],g=d(\"WAJids\").userIdFromJid(e);f=f!=null?d(\"WAJids\").userIdFromJid(f):\"\";if(a==null)return b.includes(c)?l(b.length,e===c?f:g):m(b.length,g,f);if(a===c)return j(b.length,g,f);a=d(\"WAJids\").userIdFromJid(a);return b.includes(c)?i(b.length,a,e===c?f:g):k(b.length,a,g,f)}function a(a,b){return babelHelpers[\"extends\"]({},n(a,b),{version:h})}g.createAddParticipantsAdminMessage=a}),98);\n__d(\"MAWAdminRemoveParticipantMsg\",[\"MAWGlobals\",\"MAWLocalizationType\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=1;function i(a,b,c){switch(a){case 1:return{adminMsgContent:[b],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU};case 2:return{adminMsgContent:[b,c],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_ONE_USER};default:return{adminMsgContent:[b,(a-1).toString()],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_MORE_THAN_ONE_USERS}}}function j(a,b,c,e){switch(a){case 1:return e?{adminMsgContent:[],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_LEFT_GROUP}:{adminMsgContent:[b],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT};case 2:return{adminMsgContent:[b,c],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_TWO_PARTICIPANTS};default:return{adminMsgContent:[b,(a-1).toString()],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_MORE_THAN_TWO_PARTICIPANTS}}}function k(a,b,c,e,f){switch(a){case 1:return f?{adminMsgContent:[b],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP}:{adminMsgContent:[b,c],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER};case 2:return{adminMsgContent:[b,c,e],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_TWO_USER}}return{adminMsgContent:[b,c,(a-1).toString()],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_MORE_THAN_TWO_USER}}function l(a,b){var c=d(\"MAWGlobals\").getMyUserJid(),e=b[0],f=b[1],g=d(\"WAJids\").userIdFromJid(e);f=f!=null?d(\"WAJids\").userIdFromJid(f):\"\";if(a==null)return b.includes(c)?{adminMsgContent:[],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_YOU}:{adminMsgContent:[g],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_ONE_USER};if(a===c)return j(b.length,g,f,e===c);var h=d(\"WAJids\").userIdFromJid(a);return b.includes(c)?i(b.length,h,e===c?f:g):k(b.length,h,g,f,e===a)}function a(a,b){return babelHelpers[\"extends\"]({},l(a,b),{version:h})}g.createRemoveParticipantsAdminMessage=a}),98);\n__d(\"MAWAdminWriteChangeParticipantsAdminMsgTxn\",[\"MAWAdminAddParticipantMsg\",\"MAWAdminRemoveParticipantMsg\",\"MAWDbThreadTxns\",\"MAWGlobals\",\"MAWLocalizationUtils\",\"MAWWriteMsgTxns\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){return h(a,b,d(\"MAWAdminAddParticipantMsg\").createAddParticipantsAdminMessage)}function b(a,b){return h(a,b,d(\"MAWAdminRemoveParticipantMsg\").createRemoveParticipantsAdminMessage)}function h(a,b,e){var f=b.admin,g=b.chatId,h=b.participants,i=b.serverTs;if(h.length===0)throw c(\"err\")(\"invalid number of participants when writing participants change admin msg\");return d(\"MAWDbThreadTxns\").getThread(a,g).then(function(b){if(!b.success)throw c(\"err\")(\"no thread when writing participants change admin msg\");b=b.value;var g=d(\"MAWGlobals\").getMyUserJid();g=f===\"@me\"?g:f;if(g==null)return;g=d(\"MAWLocalizationUtils\").buildUnstoredDbAdminMsg(e(g,h),b.chatId,b.jid,i);return d(\"MAWWriteMsgTxns\").writeMsg(a,g,b).then(function(){})})}g.writeAddParticipantAdminMsg=a;g.writeRemoveParticipantAdminMsg=b}),98);\n__d(\"MessagingArmadilloThreadCutoverNonTALClientDomain\",[],(function(a,b,c,d,e,f){a=Object.freeze({ARMADILLO_CUTOVER_CLIENT_DOMAIN_MESSENGER_CUTOVER_DASM_NATIVE_OPERATIONS:\"MessengerCutoverDasmNativeOperations\"});f[\"default\"]=a}),66);\n__d(\"MessagingArmadilloThreadCutoverNonTALClientEvent\",[],(function(a,b,c,d,e,f){a=Object.freeze({ARMADILLO_CUTOVER_CLIENT_EVENT_COMPLETE_CUTOVER:\"CompleteCutover\",ARMADILLO_CUTOVER_CLIENT_EVENT_THREAD_FETCH:\"ThreadFetch\"});f[\"default\"]=a}),66);\n__d(\"MessagingArmadilloThreadCutoverNonTALClientEventDetails\",[],(function(a,b,c,d,e,f){a=Object.freeze({ARMADILLO_CUTOVER_CLIENT_EVENT_DETAILS_SUCCESS:\"Success\",ARMADILLO_CUTOVER_CLIENT_EVENT_DETAILS_APPEND_ADMIN_MESSAGES:\"AppendAdminMessages\",ARMADILLO_CUTOVER_CLIENT_EVENT_DETAILS_GENERIC_ERROR:\"GenericError\",ARMADILLO_CUTOVER_CLIENT_EVENT_DETAILS_MISSING_ACT_THREAD:\"MissingActThread\",ARMADILLO_CUTOVER_CLIENT_EVENT_DETAILS_THREAD_ALREADY_MIGRATED:\"ThreadAlreadyMigrated\"});f[\"default\"]=a}),66);\n__d(\"MAWAdminWriteCutoverThreadMsgTxn\",[\"CurrentEnvironment\",\"MAWBridge\",\"MAWBridgeMsg\",\"MAWBridgeTypesCreators\",\"MAWDbMsg\",\"MAWDbThreadTxns\",\"MAWIndexedDb\",\"MAWLocalizationType\",\"MAWLocalizationUtils\",\"MAWMsgType\",\"MAWThreadSnippetBuildTxns\",\"MAWWriteBulkWriteIncomingAdminMsgTxns\",\"MAWWriteMsgTxns\",\"MessagingArmadilloThreadCutoverNonTALClientDomain\",\"MessagingArmadilloThreadCutoverNonTALClientEvent\",\"MessagingArmadilloThreadCutoverNonTALClientEventDetails\",\"WAJids\",\"WALogger\",\"WATimeUtils\",\"emptyFunction\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"cutoverThreadAdminMessage failed to get the thread\"]);h=function(){return a};return a}function i(a,b,e,f,g){a=d(\"WAJids\").switchOnMsgrChatJidType(a,{group:function(a){return d(\"WAJids\").groupIdFromJid(a)},user:function(a){return d(\"WAJids\").userIdFromJid(a)}});d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"logCutoverEvent\",{armadilloThreadId:a,domain:c(\"MessagingArmadilloThreadCutoverNonTALClientDomain\").ARMADILLO_CUTOVER_CLIENT_DOMAIN_MESSENGER_CUTOVER_DASM_NATIVE_OPERATIONS,event:c(\"MessagingArmadilloThreadCutoverNonTALClientEvent\").ARMADILLO_CUTOVER_CLIENT_EVENT_COMPLETE_CUTOVER,eventDetails:f,openThreadId:b,success:g,traceId:e})}function a(a,b,e,f){return d(\"MAWDbThreadTxns\").getThreadByJid(a,b).then(function(g){var j=function(a,c){i(b,e,f,a,c)};if(!g.success){d(\"WALogger\").WARN(h());j(c(\"MessagingArmadilloThreadCutoverNonTALClientEventDetails\").ARMADILLO_CUTOVER_CLIENT_EVENT_DETAILS_MISSING_ACT_THREAD,!1);return{needsMarkThreadAsMigrated:!1}}var k=g.value;if(k.isMigratedLocally===!0){j(c(\"MessagingArmadilloThreadCutoverNonTALClientEventDetails\").ARMADILLO_CUTOVER_CLIENT_EVENT_DETAILS_THREAD_ALREADY_MIGRATED,!0);return{needsMarkThreadAsMigrated:!1}}g=d(\"MAWDbMsg\").craftE2eeAdminMsgAltIndex(k.chatId);var l=d(\"MAWDbMsg\").craftCutoverAdminMsgAltIndex(k.chatId);return a.messages.where(\"altIndex\").equals(g).first().then(function(b){var e=c(\"CurrentEnvironment\").instagramdotcom?d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CUTOVER_IGD_THREAD_ADMIN_MESSAGE:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE;if(!b){var f=d(\"MAWLocalizationUtils\").buildUnstoredDbAdminMsg({adminMsgContent:[],adminType:e,version:1},k.chatId,k.jid,d(\"WATimeUtils\").castToUnixTime(0),l);return d(\"MAWWriteMsgTxns\").writeMsg(a,f,k,{sortOrderMs:0}).then(function(){j(c(\"MessagingArmadilloThreadCutoverNonTALClientEventDetails\").ARMADILLO_CUTOVER_CLIENT_EVENT_DETAILS_APPEND_ADMIN_MESSAGES,!0);return{needsMarkThreadAsMigrated:!0}})}var g=babelHelpers[\"extends\"]({},b,{altIndex:l,author:d(\"WAJids\").AUTHOR_SYSTEM,msgContent:{adminMsgContent:[],adminType:e},type:d(\"MAWMsgType\").MSG_TYPE.ADMIN});return a.messages.put(g).then(function(){d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgUpdated\",value:d(\"MAWBridgeMsg\").createBridgeMsg(g)});j(c(\"MessagingArmadilloThreadCutoverNonTALClientEventDetails\").ARMADILLO_CUTOVER_CLIENT_EVENT_DETAILS_APPEND_ADMIN_MESSAGES,!0);return{needsMarkThreadAsMigrated:!0}})})})}function b(a,b){var e=d(\"MAWLocalizationUtils\").buildUnstoredDbAdminMsg({adminMsgContent:[],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CUTOVER_ROLLBACK_ADMIN_MESSAGE},b.chatId,b.jid),f=babelHelpers[\"extends\"]({},b,{didInsertDualThreadCutoverAdminMsg:!1});return a.threads.put(f).then(function(){return d(\"MAWWriteMsgTxns\").writeMsg(a,e,f).then(c(\"emptyFunction\"))})}function e(a,b){var c=d(\"MAWDbMsg\").craftCutoverAdminMsgAltIndex(b.chatId),e=d(\"MAWDbMsg\").craftE2eeAdminMsgAltIndex(b.chatId);return a.messages.where(\"altIndex\").equals(e).first().then(function(f){if(f!=null)return;return a.messages.where(\"altIndex\").equals(c).first().then(function(c){if(!c)return d(\"MAWWriteBulkWriteIncomingAdminMsgTxns\").writeE2EEAdminMsgsForIncomingCreatedThreads(a,[b]).then(function(){});var f=babelHelpers[\"extends\"]({},c,{altIndex:e,author:d(\"WAJids\").AUTHOR_SYSTEM,msgContent:{adminMsgContent:[],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION},type:d(\"MAWMsgType\").MSG_TYPE.ADMIN});return a.messages.put(f).then(function(){d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgUpdated\",value:d(\"MAWBridgeMsg\").createBridgeMsg(f)});return d(\"MAWThreadSnippetBuildTxns\").buildThreadSnippet(a,f,b).then(function(a){var c=a.snippetParams,e=a.snippetSenderContactId;a=a.snippetType;d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadUpdated\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdatedThread({snippetParams:c,snippetSenderContactId:e,snippetType:a,threadId:b.chatId,threadJid:b.jid})});return})})})})}g.writeCutoverThreadAdminMsg=a;g.writeRollbackCutoverAdminMsg=b;g.revertCutoverThreadAdminMsg=e}),98);\n__d(\"MAWAdminWriteGroupNameChangeTxn\",[\"MAWDexieTable\",\"MAWGlobals\",\"MAWLocalizationType\",\"MAWLocalizationUtils\",\"MAWWriteMsgTxns\",\"WAJids\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,c){var e=b.name;if(e==null)return d(\"MAWDexieTable\").dexieResolve();var f=d(\"MAWGlobals\").getMyUserJid(),g=[];b.nameOwner===f?(f=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.CURRENT_USER_NAMED_GROUP,g.push(e)):b.nameOwner==null?(f=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.UNKNOWN_USER_NAMED_GROUP,g.push(e)):(f=d(\"MAWLocalizationType\").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP,g.push(d(\"WAJids\").userIdFromJid(b.nameOwner),e));b=d(\"MAWLocalizationUtils\").buildUnstoredDbAdminMsg({adminMsgContent:g,adminType:f,version:1},c.chatId,c.jid,d(\"WATimeUtils\").castMillisTimeToUnixTime(c.lastReadMsgTs));return d(\"MAWWriteMsgTxns\").writeMsg(a,b,c).then(function(){})}g.writeGroupNameChangeInfo=a}),98);\n__d(\"MAWAdminWriteUsersConnectedMsgTxn\",[\"MAWDbThreadTxns\",\"MAWLocalizationType\",\"MAWLocalizationUtils\",\"MAWWriteMsgTxns\",\"MessengerMSplitFlag\",\"WALogger\",\"WATimeUtils\",\"emptyFunction\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"writeUsersConnectedAdminMsg found an empty thread, which we'll not append to.\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"writeUsersConnectedAdminMsg failed to create or get 1:1 thread\"]);i=function(){return a};return a}function a(a,b,e){return d(\"MAWDbThreadTxns\").getThreadByJid(a,b).then(function(b){if(!b.success){d(\"WALogger\").WARN(i());return}else if(b.value.newestMsg==null){d(\"WALogger\").WARN(h());return}b=b.value;var f=d(\"MAWLocalizationUtils\").buildUnstoredDbAdminMsg({adminMsgContent:[],adminType:c(\"MessengerMSplitFlag\").is_msplit_account||e?d(\"MAWLocalizationType\").LOCALIZATION_TYPE.TWO_USERS_CONNECTED_ONE_MSPLIT:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.TWO_USERS_CONNECTED,version:1},b.chatId,b.jid,d(\"WATimeUtils\").castMillisTimeToUnixTime(b.lastReadMsgTs));return d(\"MAWWriteMsgTxns\").writeMsg(a,f,b).then(c(\"emptyFunction\"))})}g.writeUsersConnectedAdminMsg=a}),98);\n__d(\"mawAdminWriteDualThreadCutoverMsgTxns\",[\"MAWDbThreadTxns\",\"MAWLocalizationType\",\"MAWLocalizationUtils\",\"MAWWriteMsgTxns\",\"WALogger\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"dualThreadCutover failed to get the thread\"]);h=function(){return a};return a}function a(a,b,c){return d(\"MAWDbThreadTxns\").getThreadByJid(a,b).then(function(b){if(!b.success){d(\"WALogger\").WARN(h());return{needsMarkThreadAsMigrated:!1}}b=b.value;if(b.didInsertDualThreadCutoverAdminMsg===!0)return{needsMarkThreadAsMigrated:!1};var e=d(\"MAWLocalizationUtils\").buildUnstoredDbAdminMsg({adminMsgContent:[],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.DUAL_THREAD_CUTOVER_ADMIN_MESSAGE,version:1},b.chatId,b.jid,d(\"WATimeUtils\").castMillisTimeToUnixTime(c)),f=babelHelpers[\"extends\"]({},b,{didInsertDualThreadCutoverAdminMsg:!0});return a.threads.put(f).then(function(){return d(\"MAWWriteMsgTxns\").writeMsg(a,e,f).then(function(){return{needsMarkThreadAsMigrated:!0}})})})}g[\"default\"]=a}),98);\n__d(\"MAWParticipantManagementTxns\",[\"MAWDbParticipantTxns\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,c,e){return d(\"MAWDbParticipantTxns\").getParticipantsInThread(a,c).then(function(f){if(e.length===0&&f.length===0)return{addedJids:[],participants:f,removedJids:[],typeUpdateJids:[]};var g=new Map();f.forEach(function(a){g.set(a.userJid,a)});var h=new Set(e.map(function(a){return a.userJid})),i=[],j=[],k=[],l=[];g.forEach(function(a,b){h.has(b)||(a.type!==\"invitedParticipant\"?i.push(b):(l.push({type:a.type,userJid:a.userJid}),k.push(babelHelpers[\"extends\"]({},a))))});e.forEach(function(a){var b=g.get(a.userJid);b==null?(j.push(a),a.type===\"admin\"&&l.push({type:a.type,userJid:a.userJid})):(b.type!==a.type&&l.push({type:a.type,userJid:a.userJid}),k.push(babelHelpers[\"extends\"]({},b,a)))});var m=i.indexOf(d(\"MAWGlobals\").getMyUserJid())>=0;f=function(){return[d(\"MAWDbParticipantTxns\").bulkAddParticipants(a,b,c,j),d(\"MAWDbParticipantTxns\").bulkUpdateParticipants(a,k),d(\"MAWDbParticipantTxns\").bulkDeleteParticipantsInThread(a,c,i),m?d(\"MAWDbThreadTxns\").archiveThreads(a,[b],!0):d(\"MAWDexieTable\").dexieResolve()]};return d(\"MAWDexieTable\").dexieAll(f()).then(function(a){var b=a[0];a=a[1];return{addedJids:j.map(function(a){return a.userJid}),participants:[].concat(b,a),removedJids:i,typeUpdateJids:l}})})}g.syncParticipantList=a}),98);\n__d(\"MAWGroupManagementTxns\",[\"MAWAdminWriteChangeParticipantsAdminMsgTxn\",\"MAWAdminWriteGroupNameChangeTxn\",\"MAWDbGroupInfoTxns\",\"MAWDbParticipantTxns\",\"MAWDbPersonalSenderKeyStatusTxns\",\"MAWDbSenderKeySessionTxns\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWFolderTypes\",\"MAWGetOrCreateThreadTxns\",\"MAWGlobals\",\"MAWLoadMsgsTxns\",\"MAWParticipantManagementTxns\",\"MAWThreadManagementTxns\",\"WATimeUtils\",\"isGroupInvitesEnabled\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b,c){return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbSenderKeySessionTxns\").deleteSenderKeysByGroupJid(a,b),d(\"MAWThreadManagementTxns\").deleteAllThreadData(a,c),d(\"MAWDbGroupInfoTxns\").deleteGroupInfo(a,b),d(\"MAWDbPersonalSenderKeyStatusTxns\").bulkDeletePersonalSenderKeyStatus(a,[b])]).then(function(){})}b=function(a,b){var e=b.authoritativeThreadKey,f=b.deduplicationKey,g=b.extras,h=b.folder,i=b.groupStatus,j=b.groupToCreate,k=b.serverTs;b=i===\"added\"?d(\"WATimeUtils\").unixTime():j.creationTs;return d(\"MAWGetOrCreateThreadTxns\").getOrCreateThread(a,{authoritativeThreadKey:e,clientThreadKey:g==null?void 0:g.clientThreadKey,createTs:d(\"WATimeUtils\").castUnixTimeToMillisTime(b),deduplicationKey:f,description:\"createGroup\",folder:h==null?d(\"MAWFolderTypes\").FOLDER_ID.INBOX:h,jid:j.jid}).then(function(b){var e=b.created,f=b.thread;b=j.participants.map(function(a){return a.error?c(\"isGroupInvitesEnabled\")()&&a.error.errorCode===403?{addressable:!0,type:\"invitedParticipant\",userJid:a.error.user}:null:{addressable:a.value.addressable,type:a.value.type,userJid:a.value.user}}).filter(Boolean);var g=e?d(\"MAWDbParticipantTxns\").bulkAddParticipants:d(\"MAWParticipantManagementTxns\").syncParticipantList;g=g(a,f.chatId,f.jid,b);b=d(\"MAWGlobals\").getMyUserJid();b=i===\"added\"&&!e&&j.creator!==b?d(\"MAWAdminWriteChangeParticipantsAdminMsgTxn\").writeAddParticipantAdminMsg(a,{admin:j.inviter,chatId:f.chatId,participants:[b],serverTs:k}):d(\"MAWDexieTable\").dexieResolve();j.description;j.participants;var h=babelHelpers.objectWithoutPropertiesLoose(j,[\"description\",\"participants\"]);return d(\"MAWDexieTable\").dexieAll([g,d(\"MAWDbGroupInfoTxns\").putGroupInfo(a,f.chatId,h),d(\"MAWDbPersonalSenderKeyStatusTxns\").putNewPersonalSenderKeyStatus(a,j.jid),f.newestMsg!=null?d(\"MAWLoadMsgsTxns\").loadMsgsAndMediaFromOffset(a,f.chatId,f.jid,f.newestMsg,10,!0):d(\"MAWDexieTable\").dexieResolve(),b]).then(function(b){b[0];b=b[1];return e&&i===\"added\"?d(\"MAWAdminWriteGroupNameChangeTxn\").writeGroupNameChangeInfo(a,b,f):d(\"MAWDexieTable\").dexieResolve()}).then(function(){return f.archived===!0?d(\"MAWDbThreadTxns\").unarchiveThreads(a,[f.chatId]):d(\"MAWDbThreadTxns\").subscribeToThreads(a,[f.chatId])}).then(function(a){return f.jid})})};g.deleteGroup=a;g.createGroupInternal=b}),98);\n__d(\"MAWIncomingReceiptDataFormatTxns\",[\"MAWDbMsgTxns\",\"MAWDbUnrenderedMsgTxns\",\"MAWDexieTable\",\"MAWMsgType\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to map the threadId of a message to its threadJid during receipt-writing\"]);h=function(){return a};return a}function i(a){var b=a.author,c=a.chat;a=a.externalId;return c+\"_\"+a+\"_\"+b}function a(a,b){if(b.length===0)return d(\"MAWDexieTable\").dexieResolve();var c=new Map(),e=new Set();b.forEach(function(a){a=a.msgs;a.forEach(function(a){return e.add(babelHelpers[\"extends\"]({},a))})});a=d(\"MAWDexieTable\").dexieAll([d(\"MAWDbMsgTxns\").getMsgsByProtocolMsgId(a,Array.from(e)),d(\"MAWDbUnrenderedMsgTxns\").getUnrenderedMsgsByProtocolMsgId(a,Array.from(e))]).then(function(a){var b=a[0];a=a[1];var c=[];b.forEach(function(a){return c.push({msg:a,renderType:\"regular\"})});a.msgs.forEach(function(a){return c.push({msg:a,renderType:\"unrendered\"})});return{msgs:c}});return a.then(function(a){a=a.msgs;b.forEach(function(a){var b=a.msgs,d=a.receivers,e=a.type;b.forEach(function(a){var b=i(a),f=c.get(b)||{deliveryReceipts:[],protocolMsgId:a,readReceipts:[],senderReceipts:[]};d.forEach(function(a){if(e===\"read\"||e===\"read-self\"){f.readReceipts.push(a);return}else if(e===\"delivered\"){f.deliveryReceipts.push(a);return}else if(e===\"sender\"){f.senderReceipts.push(a);return}else if(e===\"inactive\"){f.deliveryReceipts.push(a);return}e});c.set(b,f)})});var e=new Map(),f=new Map(),g=[];a.forEach(function(a){var b=a.msg,g=b.author,j=b.externalId,k=b.msgId,l=b.threadJid;b=b.type;if(l==null){d(\"WALogger\").ERROR(h());return}if(b!==d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT){b=i({author:g,chat:l,externalId:j});g=c.get(b);if(g!=null){g.protocolMsgId;l=babelHelpers.objectWithoutPropertiesLoose(g,[\"protocolMsgId\"]);j=babelHelpers[\"extends\"]({msgId:k},l);f.set(k,j);c[\"delete\"](b)}}e.set(k,a)});c.forEach(function(a){var b=a.deliveryReceipts,c=a.protocolMsgId;a=a.readReceipts;if(b.length===0&&a.length===0)return;var d=c.author,e=c.chat;c=c.externalId;g.push({author:d,deliveryReceipts:b,externalId:c,readReceipts:a,thread:e})});return{msgIdToDbMsgMap:e,pendingReceiptsToWrite:g,receiptsToWriteMap:f}})}g.prepareDataForReceiptsToWrite=a}),98);\n__d(\"MAWThreadTypes\",[\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";b={chunk:(a=d(\"MAWTransactionMode\")).READWRITE,deletedMessages:a.READWRITE,editMsgHistory:a.READWRITE,groupInfo:a.READWRITE,groupInvites:a.READWRITE,media:a.READWRITE,messages:a.READWRITE,participants:a.READWRITE,pendingStanzas:a.READWRITE,personalSenderKeyStatuses:a.READWRITE,reactions:a.READWRITE,receipts:a.READWRITE,senderKeySessions:a.READWRITE,threads:a.READWRITE,unrenderedMessages:a.READWRITE,xma:a.READWRITE};g.ThreadRelatedTablesPermissions=b}),98);\n__d(\"MAWAsArmadilloApplication\",[\"MAWMsgType\",\"MAWXMAEncodeUtils\",\"WAArmadilloApplication.pb\",\"WATimeUtils\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){switch(a.type){case d(\"MAWMsgType\").MSG_TYPE.XMA:if((b==null?void 0:b.xma)==null)throw c(\"err\")(\"XMA content should have XMA payload\");return d(\"MAWXMAEncodeUtils\").encodeXMA(a,b);case d(\"MAWMsgType\").MSG_TYPE.RAVEN_ACTION:return h(a);default:throw c(\"err\")(a.type+\" should not be handled as ArmadilloApplication\")}}function h(a){var b=a.ravenActionToMsgExternalId;if(b==null)throw c(\"err\")(\"msg ravenActionToMsgExternalId is null in encodeRavenActionMessage\");var e=Number(a.actionType),f;if(e===0)f=d(\"WAArmadilloApplication.pb\").ARMADILLO_CONTENT_RAVEN_ACTION_NOTIF_MESSAGE_ACTION_TYPE.PLAYED;else if(e===1)f=d(\"WAArmadilloApplication.pb\").ARMADILLO_CONTENT_RAVEN_ACTION_NOTIF_MESSAGE_ACTION_TYPE.SCREENSHOT;else if(e===2)f=d(\"WAArmadilloApplication.pb\").ARMADILLO_CONTENT_RAVEN_ACTION_NOTIF_MESSAGE_ACTION_TYPE.FORCE_DISABLE;else throw c(\"err\")(\"msg actionType is not in enum in encodeRavenActionMessage\");e=a.actionTimestamp;e==null&&(e=d(\"WATimeUtils\").castMilliSecondsToUnixTime(Date.now()));a={actionTimestamp:e,actionType:f,key:{id:b}};return{payload:{content:{ravenActionNotifMessage:a}}}}g.asArmadilloApplication=a}),98);\n__d(\"MAWAsMessageApplication\",[\"I64\",\"LSIntEnum\",\"LSMessageReplySourceTypeV2\",\"MAWAsArmadilloApplication\",\"MAWAsConsumerApplication\",\"MAWGlobals\",\"MAWJids\",\"MAWMsgType\",\"WAArmadilloApplication.pb\",\"WAConsumerApplication.pb\",\"WAFranking\",\"WAJids\",\"encodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i;function a(a,b,c,e){var f,g;switch(a.type){case d(\"MAWMsgType\").MSG_TYPE.RAVEN_ACTION:f=d(\"MAWAsArmadilloApplication\").asArmadilloApplication(a);break;case d(\"MAWMsgType\").MSG_TYPE.XMA:f=d(\"MAWAsArmadilloApplication\").asArmadilloApplication(a,e);break;default:g=d(\"MAWAsConsumerApplication\").asConsumerApplication(a,b,c)}var h,i;e=a.forwardingScore!=null?a.forwardingScore:0;b=a.isForwarded!=null?a.isForwarded:!1;if(a.quote!=null){c=a.quote;h={participant:c.content.author===d(\"WAJids\").AUTHOR_ME?d(\"MAWGlobals\").getMyDeviceJid():c.content.author,stanzaId:c.content.externalId}}if(a.ephemeralSetting){c=a.ephemeralSetting;a.type===d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE?i={ephemeralExpiration:c.ephemeralExpirationInSec,isEphemeralSettingReset:a.isEphemeralSettingReset}:i={ephemeralExpiration:c.ephemeralExpirationInSec,ephemeralSettingTimestamp:c.ephemeralLastUpdatedOrSetTimestamp*1e3}}c={metadata:{chatEphemeralSetting:i,forwardingScore:e,frankingKey:k(a.reportingMeta),frankingVersion:d(\"WAFranking\").getFrankingVersion(),isForwarded:b,quotedMessage:h}};if(g!=null){e=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAConsumerApplication.pb\").ConsumerApplicationSpec,g);c.payload={subProtocol:{consumerMessage:{payload:e.readBuffer(),version:1}}}}else if(f!=null){a=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAArmadilloApplication.pb\").ArmadilloSpec,f);c.payload={subProtocol:{armadillo:{payload:a.readBuffer(),version:1}}}}return c}function b(a){var b=d(\"MAWAsConsumerApplication\").asConsumerApplicationLSDb(a),e,f,g=a.isForwarded!=null?a.isForwarded:!1,j=g?1:0;a.replySourceTypeV2&&!(h||(h=d(\"I64\"))).equal(a.replySourceTypeV2,(i||(i=d(\"LSIntEnum\"))).ofNumber(c(\"LSMessageReplySourceTypeV2\").NONE))&&a.replyToUserId!=null&&(e={participant:a.replyToUserId===d(\"WAJids\").AUTHOR_ME?d(\"MAWGlobals\").getMyDeviceJid():d(\"MAWJids\").toUserJid((h||(h=d(\"I64\"))).to_string(a.replyToUserId)),stanzaId:a.messageId});a={metadata:{chatEphemeralSetting:f,forwardingScore:j,frankingKey:d(\"WAFranking\").createFrankingKey(),frankingVersion:d(\"WAFranking\").getFrankingVersion(),isForwarded:g,quotedMessage:e}};if(b!=null){j=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAConsumerApplication.pb\").ConsumerApplicationSpec,b);a.payload={subProtocol:{consumerMessage:{payload:j.readBuffer(),version:1}}}}return a}function e(a){a=d(\"MAWAsConsumerApplication\").encodeReactionMessage(a);a=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAConsumerApplication.pb\").ConsumerApplicationSpec,a);return{metadata:{frankingKey:d(\"WAFranking\").createFrankingKey(),frankingVersion:d(\"WAFranking\").getFrankingVersion()},payload:{subProtocol:{consumerMessage:{payload:a.readBuffer(),version:1}}}}}function f(a){a=d(\"MAWAsConsumerApplication\").encodeEditMessage(a);a=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAConsumerApplication.pb\").ConsumerApplicationSpec,a);return{metadata:{frankingKey:d(\"WAFranking\").createFrankingKey(),frankingVersion:d(\"WAFranking\").getFrankingVersion()},payload:{subProtocol:{consumerMessage:{payload:a.readBuffer(),version:1}}}}}function j(a,b){var c;b=d(\"MAWAsConsumerApplication\").deletedMsgAsConsumerApplicationForSpamReporting(a,b);if(b==null)return null;b=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAConsumerApplication.pb\").ConsumerApplicationSpec,b);return{metadata:{frankingKey:k(a.reportingMeta),frankingVersion:((c=a.reportingMeta)==null?void 0:c.frankingVersion)!=null?(c=a.reportingMeta)==null?void 0:c.frankingVersion:d(\"WAFranking\").getFrankingVersion()},payload:{subProtocol:{consumerMessage:{payload:b.readBuffer(),version:1}}}}}function k(a){if((a==null?void 0:a.frankingKey)!=null)return a.frankingKey;else return d(\"WAFranking\").createFrankingKey()}g.asMessageApplication=a;g.asMessageApplicationLSDb=b;g.asReactionMessageApplication=e;g.asEditMessageApplication=f;g.deletedMsgAsMessageApplicationForSpamReporting=j}),98);\n__d(\"MAWXMAEncodeUtils\",[\"MAWAsConsumerApplication\",\"MAWAsMessageApplication\",\"MAWMsgType\",\"MAWParseSubprotocolVersionConsts\",\"MAWVault\",\"WALogger\",\"WAMsgApplication.pb\",\"encodeProtobuf\",\"validateMAWMediaAndComposeEntryForProtoMsg\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Non-text associated message for the XMA content is not supported\"]);h=function(){return a};return a}function i(a,b,e){a=c(\"validateMAWMediaAndComposeEntryForProtoMsg\")(a,b);b=a[0];a=a[1];return{payload:d(\"MAWAsConsumerApplication\").encodeValidatedMediaToImageTransport(b,a),version:e}}function a(a,b){var c,e,f=b.associatedMessage,g=b.favicon,j=b.header,k=b.previews;b=b.xma;var l=null;if(f!=null)if(f.type!==d(\"MAWMsgType\").MSG_TYPE.TEXT)d(\"WALogger\").ERROR(h());else{f=d(\"MAWAsMessageApplication\").asMessageApplication(f);f=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAMsgApplication.pb\").MessageApplicationSpec,f);l={payload:f.readBuffer(),version:d(\"MAWParseSubprotocolVersionConsts\").ASSOCIATED_MESSAGE_SUBPROTOCOL_VERSION}}f=j!=null?i(a.msgId,j,d(\"MAWParseSubprotocolVersionConsts\").XMA_HEADER_SUBPROTOCOL_VERSION):null;j=g!=null?i(a.msgId,g,d(\"MAWParseSubprotocolVersionConsts\").XMA_FAVICON_SUBPROTOCOL_VERSION):null;g=k!=null?k.map(function(b){return i(a.msgId,b,d(\"MAWParseSubprotocolVersionConsts\").XMA_PREVIEW_SUBPROTOCOL_VERSION)}):null;k=b.defaultCTA==null?void 0:[b.defaultCTA].concat(b.ctas).filter(Boolean);c=(c=a.msgContent)==null?void 0:c.content;return{payload:{content:{extendedContentMessage:{associatedMessage:(e=l)!=null?e:void 0,ctas:k,favicon:(e=j)!=null?e:void 0,headerImage:(k=f)!=null?k:void 0,headerTitle:b.headerTitle,maxSubtitleNumOfLines:b.maxSubtitleNumOfLines,maxTitleNumOfLines:b.maxTitleNumOfLines,messageText:c==null?void 0:d(\"MAWVault\").unvault(c),overlayDescription:b.overlayDescription,overlayIconGlyph:b.overlayIconGlyph,overlayTitle:b.overlayTitle,previews:(j=g)!=null?j:[],sentWithMessageId:l?a.externalId:void 0,subtitleText:b.subtitleText,targetExpiringAtSec:b.targetExpiringAtSec,targetId:b.targetId,targetType:b.targetType,targetUsername:b.targetUsername,titleText:b.titleText,xmaLayoutType:b.xmaLayoutType}}}}}g.encodeXMA=a}),98);\n__d(\"MAWParseBumpExistingMessageMsg\",[\"WAMessageKey\",\"WAParseConsumerMessageProtocol\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b=a.chat,e=a.content;a=a.meta;e=e.bumpExistingMessage;if(e==null)throw c(\"err\")(\"bumpExistingMessage has no content\");e=e.key;if(e==null)throw c(\"err\")(\"bumpExistingMessage has no message key\");var f=d(\"WAParseConsumerMessageProtocol\").interpretAsNonSystemAuthor(a.id.author);f=d(\"WAMessageKey\").extractProtocolMessageId(b,f,e);e=f.author;f=f.externalId;e={ack:a.ack,id:{author:a.id.author,chat:a.id.chat,externalId:a.id.externalId},quote:{content:{author:e,externalId:f,ts:null,type:\"Unavailable\"},remoteJid:b},ts:a.serverTs,type:\"BumpExistingMessage\"};return{unstoredMedia:null,unstoredMsg:e,unstoredQuotedMedia:null,unstoredXMA:null}}g[\"default\"]=a}),98);\n__d(\"MAWParseNoteReplyMsg\",[\"MAWMsgType\",\"WAMsgType\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b,e=a.content;a=a.meta;e=e.noteReplyMessage;if(e==null)throw c(\"err\")(\"noteReplyMessage has no content\");b=(b=e.textContent)==null?void 0:b.text;if(b==null)throw c(\"err\")(\"noteReplyMessage has no text content\");e=(e=e.noteText)==null?void 0:e.text;if(e==null)throw c(\"err\")(\"noteReplyMessage has no note text\");b={ack:a.ack,forwardingScore:a.forwardingScore,id:{author:a.id.author,chat:a.id.chat,externalId:a.id.externalId},msgContent:{content:b},quote:{content:{author:a.id.author,externalId:a.id.externalId,msgContent:{content:e},ts:a.serverTs,type:d(\"WAMsgType\").NOTE_REPLY},remoteJid:a.id.chat},ts:a.serverTs,type:d(\"MAWMsgType\").MSG_TYPE.TEXT};return{unstoredMedia:null,unstoredMsg:b,unstoredQuotedMedia:null,unstoredXMA:null}}g[\"default\"]=a}),98);\n__d(\"MAWParseRavenActionNotificationMsg\",[\"MAWGlobals\",\"MAWMsg\",\"WAStanzaUtils\",\"WATimeUtils\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b,e,f=a.content;a=a.meta;if(!d(\"MAWGlobals\").getConfig().isRavenMessagesEnabled())return{unstoredMedia:null,unstoredMsg:null,unstoredQuotedMedia:null,unstoredXMA:null};b=(b=f.ravenActionNotifMessage)==null?void 0:b.actionType;b=d(\"MAWMsg\").MAWRavenActionNotifType.cast(b);e=(e=f.ravenActionNotifMessage)==null?void 0:e.actionTimestamp;var g;if(e!=null){e=Number(e);e>d(\"WATimeUtils\").MAX_INT?g=d(\"WATimeUtils\").castMilliSecondsToUnixTime(e):g=d(\"WATimeUtils\").castToUnixTime(e)}e=((e=f.ravenActionNotifMessage)==null?void 0:(e=e.key)==null?void 0:e.id)!=null?d(\"WAStanzaUtils\").toStanzaId((e=f.ravenActionNotifMessage)==null?void 0:(f=e.key)==null?void 0:f.id):null;if(b==null)throw c(\"err\")(\"Error when getting actionType for RavenNotificationMessage \"+a.id.externalId);if(g==null)throw c(\"err\")(\"Error when getting actionTimestamp for RavenNotificationMessage \"+a.id.externalId);if(e==null)throw c(\"err\")(\"Error when getting ravenActionToMsgExternalId for RavenNotificationMessage \"+a.id.externalId);f={ack:a.ack,actionTimestamp:g,actionType:b,id:a.id,ravenActionToMsgExternalId:e,sentTs:a.sentTs,serverTs:a.serverTs,ts:a.serverTs,type:\"RavenAction\"};return{unstoredMedia:null,unstoredMsg:f,unstoredQuotedMedia:null,unstoredXMA:null}}g.parseRavenActionNotificationMessage=a}),98);\n__d(\"MAWParseRavenMsg\",[\"MAWGlobals\",\"MAWMsg\",\"MAWMsgType\",\"MAWParseSubprotocolVersionConsts\",\"WALogger\",\"WAMediaTransport.pb\",\"WAParseMediaTransportProtocol\",\"decodeProtobuf\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\\n        received video messsage version is older than expected \",\". \"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\\n        received image messsage version is older than expected \",\". \"]);i=function(){return a};return a}function a(a){var b=a.content;a=a.meta;if(!d(\"MAWGlobals\").getConfig().isRavenMessagesEnabled())return{unstoredMedia:null,unstoredMsg:null,unstoredQuotedMedia:null,unstoredXMA:null};b=b.ravenMessage;if(b==null)throw c(\"err\")(\"Raven message payload has no content\");var e=d(\"MAWMsg\").MAWRavenMsgEphemeralType.cast(b.ephemeralType);if(e==null)throw c(\"err\")(\"Error when casting ephemeralType for Raven message\");var f=void 0;if(b.imageMessage)(b.imageMessage.version==null||b.imageMessage.version<d(\"MAWParseSubprotocolVersionConsts\").RAVEN_IMAGE_MESSAGE_SUBPROTOCOL_VERSION)&&d(\"WALogger\").WARN(i(),d(\"MAWParseSubprotocolVersionConsts\").RAVEN_IMAGE_MESSAGE_SUBPROTOCOL_VERSION),f=d(\"WAParseMediaTransportProtocol\").decodeImageTransport(b.imageMessage.payload,a.ts);else if(b.videoMessage){(b.videoMessage.version==null||b.videoMessage.version<d(\"MAWParseSubprotocolVersionConsts\").RAVEN_VIDEO_MESSAGE_SUBPROTOCOL_VERSION)&&d(\"WALogger\").WARN(h(),d(\"MAWParseSubprotocolVersionConsts\").RAVEN_VIDEO_MESSAGE_SUBPROTOCOL_VERSION);b=d(\"decodeProtobuf\").decodeProtobufWithUnknowns(d(\"WAMediaTransport.pb\").VideoTransportSpec,b.videoMessage.payload);f=d(\"WAParseMediaTransportProtocol\").parseVideoMsg(b,a.ts,!1)}else throw c(\"err\")(\"Error unsupported Raven message type\");if(f==null)throw c(\"err\")(\"Error Raven message has no associated image or video\");b={ack:a.ack,id:a.id,mediaId:f.plaintextHash,ravenEphemeralMediaState:e===d(\"MAWMsg\").MAWRavenMsgEphemeralType.KEEP_IN_CHAT?d(\"MAWMsg\").MAWRavenMsgEphemeralMediaState.PERMANENT:d(\"MAWMsg\").MAWRavenMsgEphemeralMediaState.UNSEEN,ravenEphemeralType:e,reportingMeta:a.reportingMeta,sentTs:a.sentTs,serverTs:a.serverTs,ts:a.ts,type:d(\"MAWMsgType\").MSG_TYPE.RAVEN};return{unstoredMedia:f,unstoredMsg:b,unstoredQuotedMedia:null,unstoredXMA:null}}g.parseRavenMessage=a}),98);\n__d(\"MAWParseScreenshotActionMsg\",[\"MAWExternalId\",\"MAWMsgType\",\"WAAckLevel\",\"WAArmadilloApplication.pb\",\"WAJids\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b=a.content;a=a.meta;b=b.screenshotAction;if(b==null)throw c(\"err\")(\"screenshotAction has no content\");b=b.screenshotType;if(b==null)throw c(\"err\")(\"Missing screenshot type in payload\");if(![d(\"WAArmadilloApplication.pb\").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREENSHOT_IMAGE,d(\"WAArmadilloApplication.pb\").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREEN_RECORDING].includes(b))throw c(\"err\")(\"Received unexpected screenshot action type\");b={ack:d(\"WAAckLevel\").ACK.SENT,id:{author:d(\"WAJids\").AUTHOR_SYSTEM,chat:a.id.chat,externalId:d(\"MAWExternalId\").generateExternalId()},msgContent:{adminMsgContent:[],adminType:\"youEphemeralTakeScreenshot\",screenshotActionType:b},ts:a.serverTs,type:d(\"MAWMsgType\").EPHEMERAL_SCREENSHOT_ACTION};return{unstoredMedia:null,unstoredMsg:b,unstoredQuotedMedia:null,unstoredXMA:null}}g.parseEphemeralScreenshotActionProtocol=a}),98);\n__d(\"MAWParseArmadilloProtocol\",[\"MAWMsgType\",\"MAWParseBumpExistingMessageMsg\",\"MAWParseNoteReplyMsg\",\"MAWParseRavenActionNotificationMsg\",\"MAWParseRavenMsg\",\"MAWParseScreenshotActionMsg\",\"MAWParseXMAProtocol\",\"WAArmadilloApplication.pb\",\"WAHex\",\"WALogger\",\"decodeProtobuf\",\"err\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAWParseArmadilloProtocol - Dropping message. contentType: \",\", reason: \",\"\"]);h=function(){return a};return a}var i={unstoredMedia:null,unstoredMsg:null,unstoredQuotedMedia:null,unstoredXMA:null},j=new Map([[\"screenshotAction\",d(\"MAWParseScreenshotActionMsg\").parseEphemeralScreenshotActionProtocol],[\"extendedContentMessage\",d(\"MAWParseXMAProtocol\").parseXMAProtocol],[\"ravenActionNotifMessage\",d(\"MAWParseRavenActionNotificationMsg\").parseRavenActionNotificationMessage],[\"ravenMessage\",d(\"MAWParseRavenMsg\").parseRavenMessage],[\"noteReplyMessage\",c(\"MAWParseNoteReplyMsg\")],[\"bumpExistingMessage\",c(\"gkx\")(\"1553\")?c(\"MAWParseBumpExistingMessageMsg\"):null]]);function a(a,b,c,e,f){b=d(\"decodeProtobuf\").decodeProtobufWithUnknowns(d(\"WAArmadilloApplication.pb\").ArmadilloSpec,b);b=(b=b.payload)==null?void 0:b.content;if(!b)return i;var g=k(b);try{var l=j.get(g);return l!=null?l({chat:a,content:b,meta:c,metadata:f,protobuf:e}):{contentTypeForLogging:g,unstoredMedia:null,unstoredMsg:{ack:c.ack,id:c.id,msgContent:{protobuf:d(\"WAHex\").bytesToBuffer(e),subtype:null},reportingMeta:c.reportingMeta,sentTs:c.sentTs,serverTs:c.serverTs,ts:c.ts,type:d(\"MAWMsgType\").MSG_TYPE.FUTUREPROOF},unstoredQuotedMedia:null,unstoredXMA:null}}catch(a){d(\"WALogger\").ERROR(h(),g,a);return i}}function k(a){var b=Object.keys(a).filter(function(a){return a!==\"$$unknownFieldCount\"});if(b.length!==1)throw c(\"err\")(JSON.stringify(a)+\" armadillo payload content should only have one field\");a=b[0];return a}g.parseArmadilloProtocol=a}),98);\n__d(\"MAWUnstoredQuotedMsgUtils\",[\"MAWMsgType\",\"WAErr\",\"WAJids\",\"WAMsgType\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a){if(a==null)return;var b=a.content;a=a.remoteJid;var e;switch(b.type){case d(\"MAWMsgType\").MSG_TYPE.TEXT:e=j(b);break;case d(\"MAWMsgType\").MSG_TYPE.IMAGE:e=k(b);break;case d(\"MAWMsgType\").MSG_TYPE.VIDEO:e=l(b);break;case d(\"MAWMsgType\").MSG_TYPE.PTT:e=m(b);break;case d(\"MAWMsgType\").MSG_TYPE.GIF:e=n(b);break;case d(\"MAWMsgType\").MSG_TYPE.STICKER:e=o(b);break;case d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE:e=q(b);break;case d(\"MAWMsgType\").MSG_TYPE.UNAVAILABLE:e=r(b);break;case d(\"MAWMsgType\").MSG_TYPE.EXPIRED_EPHEMERAL:e=s(b);break;case d(\"WAMsgType\").NOTE_REPLY:e=p(b);break;default:b.type;throw c(\"WAErr\")(\"For flow\")}return{content:e,remoteJid:a}}function i(a){if(d(\"WAJids\").isAuthorSystem(a.author))throw c(\"WAErr\")(\"A system message cannot be quoted\");return{author:a.author,externalId:a.externalId,ts:a.ts}}function j(a){return babelHelpers[\"extends\"]({},i(a),{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.TEXT})}function k(a){return babelHelpers[\"extends\"]({},i(a),{type:d(\"MAWMsgType\").MSG_TYPE.IMAGE})}function l(a){return babelHelpers[\"extends\"]({},i(a),{type:d(\"MAWMsgType\").MSG_TYPE.VIDEO})}function m(a){return babelHelpers[\"extends\"]({},i(a),{type:d(\"MAWMsgType\").MSG_TYPE.PTT})}function n(a){return babelHelpers[\"extends\"]({},i(a),{type:d(\"MAWMsgType\").MSG_TYPE.GIF})}function o(a){return babelHelpers[\"extends\"]({},i(a),{type:d(\"MAWMsgType\").MSG_TYPE.STICKER})}function p(a){return babelHelpers[\"extends\"]({},i(a),{msgContent:a.msgContent,type:d(\"WAMsgType\").NOTE_REPLY})}function q(a){return babelHelpers[\"extends\"]({},i(a),{type:d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE})}function r(a){return babelHelpers[\"extends\"]({},i(a),{type:d(\"MAWMsgType\").MSG_TYPE.UNAVAILABLE})}function s(a){return babelHelpers[\"extends\"]({},i(a),{type:d(\"MAWMsgType\").MSG_TYPE.EXPIRED_EPHEMERAL})}function a(a){return{quote:h(a.quote)}}g.getWithQuoteMsg=a}),98);\n__d(\"MAWUnstoredTypedMsgUtils\",[\"MAWDbMsg\",\"MAWMsgType\",\"MAWRavenUtils\",\"MAWUnstoredQuotedMsgUtils\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a){return{ack:a.ack,author:a.id.author,externalId:a.id.externalId,reportingMeta:a.reportingMeta,serverTs:a.serverTs,ts:a.ts}}function i(a){return{forwardingScore:a.forwardingScore,isForwarded:a.isForwarded}}function j(a){return{ephemeralSetting:k(a.ephemeralSetting),messageDeleteTs:a.deleteTs,messageExpirationTs:a.expirationTs}}function k(a){if(a==null)return;return{ephemeralExpirationInSec:a.expirationTs,ephemeralLastUpdatedOrSetTimestamp:a.updatedTs}}function a(a,b){return babelHelpers[\"extends\"]({},h(a),i(a),d(\"MAWUnstoredQuotedMsgUtils\").getWithQuoteMsg(a),j(a),{altIndex:void 0,msgContent:{content:(a=b.sentWithMessage)!=null?a:\"\",mentionedJids:void 0},type:d(\"MAWMsgType\").MSG_TYPE.XMA,xmaMessageType:b.targetType})}function b(a){return babelHelpers[\"extends\"]({},h(a),i(a),d(\"MAWUnstoredQuotedMsgUtils\").getWithQuoteMsg(a),j(a),{altIndex:void 0,editCount:0,msgContent:a.msgContent,specialTextSize:a.specialTextSize,type:d(\"MAWMsgType\").MSG_TYPE.TEXT})}function c(a){return babelHelpers[\"extends\"]({},h(a),i(a),d(\"MAWUnstoredQuotedMsgUtils\").getWithQuoteMsg(a),j(a),{altIndex:void 0,type:d(\"MAWMsgType\").MSG_TYPE.IMAGE})}function e(a){return babelHelpers[\"extends\"]({},h(a),d(\"MAWUnstoredQuotedMsgUtils\").getWithQuoteMsg(a),j(a),{altIndex:void 0,ravenEphemeralMediaState:d(\"MAWRavenUtils\").getEphemeralMediaState(a.ravenEphemeralMediaState),ravenEphemeralType:a.ravenEphemeralType,type:d(\"MAWMsgType\").MSG_TYPE.RAVEN})}function f(a){return babelHelpers[\"extends\"]({},h(a),i(a),d(\"MAWUnstoredQuotedMsgUtils\").getWithQuoteMsg(a),j(a),{altIndex:void 0,type:d(\"MAWMsgType\").MSG_TYPE.VIDEO})}function l(a){return babelHelpers[\"extends\"]({},h(a),i(a),d(\"MAWUnstoredQuotedMsgUtils\").getWithQuoteMsg(a),j(a),{altIndex:void 0,type:d(\"MAWMsgType\").MSG_TYPE.PTT})}function m(a){return{adminMsgContent:a.adminMsgContent,adminType:a.adminType}}function n(a){return babelHelpers[\"extends\"]({},h(a),{altIndex:void 0,author:d(\"WAJids\").AUTHOR_SYSTEM,msgContent:m(a.msgContent),type:d(\"MAWMsgType\").MSG_TYPE.ADMIN})}function o(a){return babelHelpers[\"extends\"]({},h(a),i(a),d(\"MAWUnstoredQuotedMsgUtils\").getWithQuoteMsg(a),j(a),{altIndex:void 0,type:d(\"MAWMsgType\").MSG_TYPE.GIF})}function p(a){return babelHelpers[\"extends\"]({},h(a),i(a),d(\"MAWUnstoredQuotedMsgUtils\").getWithQuoteMsg(a),j(a),{altIndex:void 0,type:d(\"MAWMsgType\").MSG_TYPE.STICKER})}function q(a){return babelHelpers[\"extends\"]({},h(a),i(a),d(\"MAWUnstoredQuotedMsgUtils\").getWithQuoteMsg(a),j(a),{altIndex:void 0,type:d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE})}function r(a){return babelHelpers[\"extends\"]({},h(a),{altIndex:d(\"MAWDbMsg\").FUTUREPROOF_ALT_INDEX,msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.FUTUREPROOF})}function s(a){return babelHelpers[\"extends\"]({},h(a),{altIndex:void 0,revokedExternalId:a.revokedExternalId,type:d(\"MAWMsgType\").MSG_TYPE.REVOKED})}function t(a){return{adminMsgContent:a.adminMsgContent,adminType:a.adminType}}function u(a){return babelHelpers[\"extends\"]({},h(a),{altIndex:void 0,msgContent:t(a.msgContent),type:d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SETTING_ADMIN})}function v(a){return{adminMsgContent:a.adminMsgContent,adminType:a.adminType,screenshotActionType:a.screenshotActionType,version:a.version}}function w(a){return babelHelpers[\"extends\"]({},h(a),{altIndex:void 0,msgContent:v(a.msgContent),type:d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION})}function x(a){return{adminType:a.adminType,authorName:a.authorName}}function y(a){return babelHelpers[\"extends\"]({},h(a),{altIndex:void 0,msgContent:x(a.msgContent),type:d(\"MAWMsgType\").MSG_TYPE.ICDC_ALERT})}function z(a){return babelHelpers[\"extends\"]({},h(a),d(\"MAWUnstoredQuotedMsgUtils\").getWithQuoteMsg(a),{altIndex:void 0,type:d(\"MAWMsgType\").MSG_TYPE.BUMP_EXISTING_MESSAGE})}g.getXMAMsg=a;g.getTextMsg=b;g.getImageMsg=c;g.getRavenMsg=e;g.getVideoMsg=f;g.getPttMsg=l;g.getAdminMsg=n;g.getGifMsg=o;g.getStickerMsg=p;g.getDocumentFileMsg=q;g.getFutureproofMsg=r;g.getRevokedMsg=s;g.getEphemeralSettingAdminMsg=u;g.getEphemeralScreenshotActionMsg=w;g.getICDCAlertMsg=y;g.getBumpExistingMessageMsg=z}),98);\n__d(\"MAWUnstoredMsgUtils\",[\"MAWMsgType\",\"MAWUnstoredTypedMsgUtils\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b=a.unstoredMsg;a=a.unstoredXMA;if(b==null)return null;switch(b.type){case d(\"MAWMsgType\").MSG_TYPE.TEXT:return d(\"MAWUnstoredTypedMsgUtils\").getTextMsg(b);case d(\"MAWMsgType\").MSG_TYPE.IMAGE:return d(\"MAWUnstoredTypedMsgUtils\").getImageMsg(b);case d(\"MAWMsgType\").MSG_TYPE.VIDEO:return d(\"MAWUnstoredTypedMsgUtils\").getVideoMsg(b);case d(\"MAWMsgType\").MSG_TYPE.PTT:return d(\"MAWUnstoredTypedMsgUtils\").getPttMsg(b);case d(\"MAWMsgType\").MSG_TYPE.ADMIN:return d(\"MAWUnstoredTypedMsgUtils\").getAdminMsg(b);case d(\"MAWMsgType\").MSG_TYPE.FUTUREPROOF:return d(\"MAWUnstoredTypedMsgUtils\").getFutureproofMsg(b);case d(\"MAWMsgType\").MSG_TYPE.REVOKED:return d(\"MAWUnstoredTypedMsgUtils\").getRevokedMsg(b);case d(\"MAWMsgType\").MSG_TYPE.GIF:return d(\"MAWUnstoredTypedMsgUtils\").getGifMsg(b);case d(\"MAWMsgType\").MSG_TYPE.STICKER:return d(\"MAWUnstoredTypedMsgUtils\").getStickerMsg(b);case d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE:return d(\"MAWUnstoredTypedMsgUtils\").getDocumentFileMsg(b);case d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:return d(\"MAWUnstoredTypedMsgUtils\").getEphemeralSettingAdminMsg(b);case d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:return d(\"MAWUnstoredTypedMsgUtils\").getEphemeralScreenshotActionMsg(b);case d(\"MAWMsgType\").MSG_TYPE.ICDC_ALERT:return d(\"MAWUnstoredTypedMsgUtils\").getICDCAlertMsg(b);case d(\"MAWMsgType\").MSG_TYPE.XMA:if((a==null?void 0:a.xma)==null)throw c(\"err\")(\"XMA content cannot be parsed without XMA payload\");return d(\"MAWUnstoredTypedMsgUtils\").getXMAMsg(b,a==null?void 0:a.xma);case d(\"MAWMsgType\").MSG_TYPE.RAVEN:return d(\"MAWUnstoredTypedMsgUtils\").getRavenMsg(b);case d(\"MAWMsgType\").MSG_TYPE.RAVEN_ACTION:case d(\"MAWMsgType\").MSG_TYPE.REACTION:case d(\"MAWMsgType\").MSG_TYPE.EDIT_ACTION:return null;case d(\"MAWMsgType\").MSG_TYPE.BUMP_EXISTING_MESSAGE:return d(\"MAWUnstoredTypedMsgUtils\").getBumpExistingMessageMsg(b);default:b.type;return null}}function b(a){return a==null?null:d(\"MAWUnstoredTypedMsgUtils\").getTextMsg(a)}function e(a){a=a.unstoredMsg;if(!a||a.type!==d(\"MAWMsgType\").MSG_TYPE.REACTION)return null;a=a;return{ack:a.ack,author:a.id.author,externalId:a.id.externalId,groupingKey:a.groupingKey,reaction:a.reaction,reactToAuthor:a.reactToAuthor,reactToExternalId:a.reactToExternalId,threadJid:a.id.chat,ts:a.ts}}function f(a){a=a.unstoredMsg;if(!a||a.type!==d(\"MAWMsgType\").MSG_TYPE.RAVEN_ACTION)return null;a=a;return{ack:a.ack,actionTimestamp:a.actionTimestamp,actionType:a.actionType,author:a.id.author,externalId:a.id.externalId,ravenActionToMsgExternalId:a.ravenActionToMsgExternalId,ts:a.ts,type:a.type}}function h(a){a=a.unstoredIncomingGroupInvite;return!a?null:babelHelpers[\"extends\"]({},a)}function i(a){return a==null?null:{ack:a.ack,author:a.id.author,editMsgContent:a.editMsgContent,externalId:a.id.externalId,originalMsgExternalId:a.originalMsgExternalId,reportingMeta:a.reportingMeta,serverTs:a.serverTs,specialTextSize:a.specialTextSize,ts:a.ts,type:a.type}}g.getUnstoredMsg=a;g.getUnstoredAssociatedMsg=b;g.getUnstoredReaction=e;g.getUnstoredRavenActionMsg=f;g.getGroupInvite=h;g.getUnstoredEditActionMsg=i}),98);\n__d(\"MAWUnstoredMediaUtils\",[\"MAWUnstoredMsgUtils\",\"WASortedLists\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a){return a==null?null:{mediaEntry:a.mediaEntry,mediaType:a.mediaType,msgIds:d(\"WASortedLists\").emptySet(),plaintextHash:a.plaintextHash,size:a.size,ts:a.ts,validatedAudioInfo:a.validatedAudioInfo,validatedDocumentFileInfo:a.validatedDocumentFileInfo,validatedImageInfo:a.validatedImageInfo,validatedVideoInfo:a.validatedVideoInfo}}function a(a){a=a.unstoredXMA;if(a==null)return;var b=a.unstoredAssociatedMsg,c=a.unstoredFavicon,e=a.unstoredHeaderMedia,f=a.unstoredPreviews;a=a.xma;return{unstoredAssociatedMsg:(b=d(\"MAWUnstoredMsgUtils\").getUnstoredAssociatedMsg(b))!=null?b:void 0,unstoredDbXMA:{author:a.author,contentRef:a.contentRef,ctas:a.ctas,defaultCTA:a.defaultCTA,externalId:a.externalId,headerTitle:a.headerTitle,isTombstoned:a.isTombstoned,maxSubtitleNumOfLines:a.maxSubtitleNumOfLines,maxTitleNumOfLines:a.maxTitleNumOfLines,overlayDescription:a.overlayDescription,overlayIconGlyph:a.overlayIconGlyph,overlayTitle:a.overlayTitle,subtitleText:a.subtitleText,targetExpiringAtSec:a.targetExpiringAtSec,targetId:a.targetId,targetType:a.targetType,targetUsername:a.targetUsername,threadJid:a.threadJid,titleText:a.titleText,xmaLayoutType:a.xmaLayoutType},unstoredFavicon:(b=h(c))!=null?b:void 0,unstoredHeaderMedia:(a=h(e))!=null?a:void 0,unstoredPreviews:f?f.map(function(a){return h(a)}).filter(Boolean):void 0}}g.getUnstoredMedia=h;g.getUnstoredXMA=a}),98);\n__d(\"MAWUnstoredContentToUnstoredDbContentUtils\",[\"MAWUnstoredMediaUtils\",\"MAWUnstoredMsgUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b,c=(b=d(\"MAWUnstoredMsgUtils\")).getUnstoredMsg(a),e=d(\"MAWUnstoredMediaUtils\").getUnstoredMedia(a.unstoredMedia),f=b.getUnstoredReaction(a),g=b.getUnstoredRavenActionMsg(a),h=d(\"MAWUnstoredMediaUtils\").getUnstoredXMA(a),i=b.getGroupInvite(a);b=b.getUnstoredEditActionMsg(a.unstoredEditMsg);if(i==null)return{contentTypeForLogging:a.contentTypeForLogging,unstoredDbEditActionMsg:b,unstoredDbMedia:e,unstoredDbMsg:c,unstoredDbRavenActionMsg:g,unstoredDbReaction:f,unstoredXMA:h,xmaTargetTypeForLogging:a.xmaTargetTypeForLogging};else return{contentTypeForLogging:a.contentTypeForLogging,unstoredDbEditActionMsg:b,unstoredDbMedia:e,unstoredDbMsg:c,unstoredDbRavenActionMsg:g,unstoredDbReaction:f,unstoredIncomingDbGroupInvite:i,unstoredXMA:h,xmaTargetTypeForLogging:a.xmaTargetTypeForLogging}}g.unstoredContentToUnstoredDbContent=a}),98);\n__d(\"MAWCryptoAuthTokenWrapper\",[\"MessengerWebInitData\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){return d(\"MessengerWebInitData\").cryptoAuthToken}g.getCryptoAuthToken=a}),98);\n__d(\"MAWDeviceRegistrationActions\",[\"MAWCompareIdentity\",\"MAWCurrentUser\",\"MAWDexieTable\",\"MAWLoggerUtils\",\"MessengerWebInitData\",\"SignalDbTypes\",\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": signedPrekey}\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[Device Registration Meta Check] Device Id should be a number\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAWDeviceRegistrationActions: sessionId is null\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": \",\"\"]);o=function(){return a};return a}var p=\"Device registration meta is incomplete: \",q=d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.DeviceRegistration]);function r(a,b,c,e,f){(a!=null||b!=null||c!=null||e!=null||f!=null)&&(a==null&&q.TAGS([d(\"MAWLoggerUtils\").Tag.SignedPrekey]).ERROR(o(),p,d(\"SignalDbTypes\").MetaKeysEnum.lastSignedPrekeyId),b==null&&q.ERROR(n(),p,d(\"SignalDbTypes\").MetaKeysEnum.deviceUUID),c==null&&q.ERROR(m(),p,d(\"SignalDbTypes\").MetaKeysEnum.regId),e==null&&q.ERROR(l(),p,d(\"SignalDbTypes\").MetaKeysEnum.identityKeyPair),f==null&&q.ERROR(k(),p,d(\"SignalDbTypes\").MetaKeysEnum.fbid))}function a(a){var b;return d(\"MAWDexieTable\").dexieAll([a.meta.bulkGet([(b=d(\"SignalDbTypes\")).MetaKeysEnum.lastSignedPrekeyId,b.MetaKeysEnum.deviceUUID,b.MetaKeysEnum.lastSessionDeviceWasLinkedTo,b.MetaKeysEnum.regId,b.MetaKeysEnum.identityKeyPair,b.MetaKeysEnum.fbid,b.MetaKeysEnum.deviceId,b.MetaKeysEnum.registrationVersion]),d(\"MAWCompareIdentity\").compareIdentityDexie(a)]).then(function(b){var e=b[0],f=e[0],g=e[1],k=e[2],l=e[3],m=e[4],n=e[5],o=e[6];e=e[7];var s=b[1],t=f==null?void 0:(b=f.value)==null?void 0:b.lastSignedPrekeyId,u=g==null?void 0:(f=g.value)==null?void 0:f.deviceUUID,v=k==null?void 0:(b=k.value)==null?void 0:b.lastSessionDeviceWasLinkedTo,w=l==null?void 0:(g=l.value)==null?void 0:g.regId,x=m==null?void 0:(f=m.value)==null?void 0:f.identityKeyPair;b=n==null?void 0:(k=n.value)==null?void 0:k.fbid;var y=o==null?void 0:(l=o.value)==null?void 0:l.deviceId,z=e==null?void 0:e.value.registrationVersion;if(t==null||u==null||w==null||x==null||b==null){r(t,u,w,x,b);return null}c(\"MessengerWebInitData\").sessionId==null&&q.ERROR(j());if(y!=null&&typeof y!==\"number\"){q.ERROR(i());return null}return a.signedPrekey.get(t).then(function(a){if(a==null){q.TAGS([d(\"MAWLoggerUtils\").Tag.SignedPrekey]).ERROR(h(),p);return null}return{deviceId:y,deviceUUID:u,identityCompareResult:s,lastSessionDeviceWasLinkedTo:v,lastSignedPrekeyId:t,registrationVersion:z,signalRegInfo:{identityKeyPair:x,regId:w,signedPreKey:a}}})})}function b(a,b){var c;return d(\"MAWDexieTable\").dexieAll([a.meta.bulkPut([{key:(c=d(\"SignalDbTypes\")).MetaKeysEnum.deviceUUID,value:{deviceUUID:b.deviceUUID}},{key:c.MetaKeysEnum.fbid,value:{fbid:d(\"MAWCurrentUser\").getID()}},{key:c.MetaKeysEnum.regId,value:{regId:b.signalRegInfo.regId}},{key:c.MetaKeysEnum.identityKeyPair,value:{identityKeyPair:b.signalRegInfo.identityKeyPair}},{key:c.MetaKeysEnum.lastSignedPrekeyId,value:{lastSignedPrekeyId:b.signalRegInfo.signedPreKey.keyId}},{key:c.MetaKeysEnum.registrationVersion,value:{registrationVersion:b.registrationVersion}},{key:c.MetaKeysEnum.authKeyPair,value:{authKeyPair:b.signalRegInfo.authKeyPair}}]),a.signedPrekey.put(b.signalRegInfo.signedPreKey)])}function e(a,b){return a.meta.put({key:d(\"SignalDbTypes\").MetaKeysEnum.deviceId,value:{deviceId:b}})}function f(a,b){return a.meta.put({key:d(\"SignalDbTypes\").MetaKeysEnum.lastSessionDeviceWasLinkedTo,value:{lastSessionDeviceWasLinkedTo:b}})}function s(a,b,c){return a.contacts.get(b).then(function(d){if(d!=null)return a.contacts.put(babelHelpers[\"extends\"]({},d,{icdcInfo:c}));else return a.contacts.put({contactJid:b,dhash:null,icdcInfo:c})}).then(function(){})}g.getRegistrationMetaDexie=a;g.saveUnsentRegistrationMeta=b;g.saveDeviceId=e;g.saveLastSessionDeviceWasLinkedTo=f;g.saveICDC=s}),98);\n__d(\"MAWClearSignalAndTempStores\",[\"MAWDeleteOldLogsFromDisk\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWJobActionsV2\",\"MAWLoggingSwitches\",\"MAWSignalIndexedDb\",\"MAWTransactionMode\",\"Promise\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=d(\"MAWIndexedDb\").makeSignalTransactor({meta:(a=d(\"MAWTransactionMode\")).READWRITE,personalSenderKeyStatuses:a.READWRITE,prekey:a.READWRITE,prekeyGeneration:a.READWRITE,senderKeySessions:a.READWRITE,session:a.READWRITE,signedPrekey:a.READWRITE,tasks:a.READWRITE},\"clearSignalAndTempStores\",function(a){return function(){return d(\"MAWDexieTable\").dexieAll([a.meta.clear(),a.prekey.clear(),a.prekeyGeneration.clear(),a.session.clear(),a.signedPrekey.clear(),a.tasks.clear(),a.senderKeySessions.clear(),a.personalSenderKeyStatuses.clear()]).then(function(){})}}),j=d(\"MAWSignalIndexedDb\").makeSignalMsgrTransactor(\"jobs\",a.READWRITE,\"clearJob\")(d(\"MAWJobActionsV2\").clearJobs);c=function(){return(h||(h=b(\"Promise\"))).all([d(\"MAWLoggingSwitches\").removeLoggingFromBridge&&d(\"MAWDeleteOldLogsFromDisk\").clearLogs(),i(),j()]).then(function(){})};g.clearSignalAndTempStores=c}),98);\n__d(\"XArmadilloWebLinkDeviceToSessionControllerRouteBuilder\",[\"jsRouteBuilder\"],(function(a,b,c,d,e,f,g){a=c(\"jsRouteBuilder\")(\"\/messenger\/armadillo\/link_device\/\",Object.freeze({}),void 0);b=a;g[\"default\"]=b}),98);\n__d(\"MAWDeviceRegistrationSessionUtil\",[\"CSRFGuard\",\"DTSG\",\"DTSGUtils\",\"MAWDeviceRegistrationActions\",\"MAWIndexedDb\",\"MAWLoggerUtils\",\"MAWTransactionMode\",\"PHPQuerySerializer\",\"SprinkleConfig\",\"WATagsLogger\",\"WAWorkerGlobalScope\",\"XArmadilloWebLinkDeviceToSessionControllerRouteBuilder\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[LinkDeviceToTheSession] fetch result is not succesful\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[LinkDeviceToTheSession] success\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[LinkDeviceToTheSession] parse response error \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[LinkDeviceToTheSession] fetch is not 200: \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[LinkDeviceToTheSession] fetch error \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[LinkDeviceToTheSession] deviceUUID is null\"]);n=function(){return a};return a}var o=d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.DeviceRegistration]),p=d(\"MAWIndexedDb\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READWRITE},\"saveLastSessionDeviceWasLinkedTo\",function(a){return function(b){return d(\"MAWDeviceRegistrationActions\").saveLastSessionDeviceWasLinkedTo(a,b)}});function a(a,b){return q.apply(this,arguments)}function q(){q=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){var e;e=(e=d(\"WAWorkerGlobalScope\").workerGlobalScope.location)==null?void 0:e.origin;if(e==null||e===\"\")return;if(a==null){o.ERROR(n());return}e=new URL(e).hostname;e=(e=c(\"XArmadilloWebLinkDeviceToSessionControllerRouteBuilder\").buildUri({}).setDomain(e))==null?void 0:(e=e.setProtocol(\"https\"))==null?void 0:e.toString();if(e==null)return;var f=d(\"DTSG\").getToken();if(f==null)return;a={device_id:a,fb_dtsg:f};c(\"SprinkleConfig\").param_name&&(a[c(\"SprinkleConfig\").param_name]=c(\"DTSGUtils\").getNumericValue(f));f=d(\"WAWorkerGlobalScope\").workerGlobalScope.fetch;var g;try{g=(yield f(e,{body:(h||(h=c(\"PHPQuerySerializer\"))).serialize(a),headers:{\"Content-Type\":\"application\/x-www-form-urlencoded\"},method:\"POST\",redirect:\"error\"}))}catch(a){o.ERROR(m(),a);return}if(!g.ok){o.ERROR(l(),g.status);return}f=(yield g.text());d(\"CSRFGuard\").exists(f)&&(f=d(\"CSRFGuard\").clean(f));var q;try{q=JSON.parse(f)}catch(a){o.ERROR(k(),a);return}((e=q)==null?void 0:e.success)===!0?(o.LOG(j()),yield p(b)):o.WARN(i())});return q.apply(this,arguments)}g.linkDeviceToTheSession=a}),98);\n__d(\"WAPreRegistrationCrypto\",[\"WACryptoManager\",\"WAErr\",\"WASignalSignatures\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){var a,c,e,f,g,h,i,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoManager\").generateRegistrationInfo());case 2:a=k.sent;c=a.regId;e=a.staticKeyPair;f=a.authKeyPair;g=Date.now();k.next=9;return b(\"regeneratorRuntime\").awrap(d(\"WASignalSignatures\").generateSignedPreKey(1,g,e));case 9:h=k.sent;i=h.plainObject;j=h.record;return k.abrupt(\"return\",{regId:c,identityKeyPair:e,authKeyPair:f,signedPreKey:{keyId:i.id,encoded:j}});case 13:case\"end\":return k.stop()}},null,this)}function e(a){var b=d(\"WASignalSignatures\").deserializeSignedPreKey(a.signedPreKey.encoded);if(b==null||b.id!==a.signedPreKey.keyId)throw c(\"WAErr\")(\"Badly formatted signed prekey\");return{regId:a.regId,identityPubKeyType:5,identityPubKey:a.identityKeyPair.publicKey,signedPreKey:b}}g.makeRegistrationData=a;g.serializeRegistrationData=e}),98);\n__d(\"MAWDeviceRegistrationUtilWorker\",[\"MAWConstants\",\"MAWCurrentUser\",\"MAWDeviceRegistrationTypes\",\"MAWLoggerUtils\",\"URI\",\"WABase64\",\"WAPreRegistrationCrypto\",\"WATagsLogger\",\"WAWorkerGlobalScope\",\"asyncToGeneratorRuntime\",\"err\",\"uuidv4\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"ICDC failed to fetch url:\",\". error: \",\"\"]);i=function(){return a};return a}function j(a,b){var c=new Uint8Array(b);a=a;for(b=b-1|0;b>=0;--b)c[b]=a&255,a=a>>>8;return c}function k(a,b,c,e,f,g,h,i,k){var l;f=(l=d(\"WABase64\")).encodeB64(j(f,4));g=l.encodeB64(j(g,1));h=l.encodeB64(h);var m=l.encodeB64(j(i.id,3)),n=l.encodeB64(i.keyPair.publicKey);l=l.encodeB64(i.signature);i=new Map().set(\"fbid\",a).set(\"fb_cat\",b).set(\"app_id\",c).set(\"device_id\",e).set(\"e_regid\",f).set(\"e_keytype\",g).set(\"e_ident\",h).set(\"e_skey_id\",m).set(\"e_skey_val\",n).set(\"e_skey_sig\",l);if(k){a=d(\"WABase64\").encodeB64(k.signedICDCIdentityList);b=d(\"WABase64\").encodeB64(k.ihash);i.set(\"icdc_list\",a).set(\"icdc_ts\",k.ts).set(\"icdc_seq\",k.seq).set(\"ihash\",b)}return i}function l(a){var b=[];a.forEach(function(a,c,d){b.push(encodeURIComponent(c)+(\"=\"+encodeURIComponent(a.toString())))});return b.join(\"&\")}function m(a,b){return n.apply(this,arguments)}function n(){n=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){try{a=(yield d(\"WAWorkerGlobalScope\").workerGlobalScope.fetch(b,{body:a,headers:{\"Content-Type\":\"application\/x-www-form-urlencoded; charset=UTF-8\"},method:\"POST\"}));return yield a.json()}catch(c){a=c.message||c.description||c;d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.DeviceRegistration]).ERROR(i(),b,a);throw c}});return n.apply(this,arguments)}function o(a,b){return p.apply(this,arguments)}function p(){p=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){b=(yield d(\"WAWorkerGlobalScope\").workerGlobalScope.fetch(b,{body:a,headers:{\"Content-Type\":\"application\/x-www-form-urlencoded; charset=UTF-8\"},method:\"POST\"}));return b.json()});return p.apply(this,arguments)}function q(){var a=new(h||(h=c(\"URI\")))(t()+d(\"MAWDeviceRegistrationTypes\").ICDC_ENDPOINT);return a.toString()}function r(a){return s.apply(this,arguments)}function s(){s=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b=q();a=(yield m(a,b));if(a==null)throw c(\"err\")(d(\"MAWDeviceRegistrationTypes\").NULL_RESPONSE_FROM_SERVER);if(a.status!==200)throw c(\"err\")(\"WA Server returned status code \"+a.status+\" while attempting device registration\");return a});return s.apply(this,arguments)}function t(){var a=Number(d(\"MAWCurrentUser\").getAppID()),b=d(\"MAWDeviceRegistrationTypes\").REG_FB_DOMAIN;switch(a){case 1217981644879628:case 936619743392459:case 487152425211411:case 1035956773910536:b=d(\"MAWDeviceRegistrationTypes\").REG_IGD_DOMAIN;break;case 772021112871879:b=d(\"MAWDeviceRegistrationTypes\").REG_MSGR_DOMAIN;break;default:b=d(\"MAWDeviceRegistrationTypes\").REG_FB_DOMAIN}return b}function u(){var a=new(h||(h=c(\"URI\")))(t()+d(\"MAWDeviceRegistrationTypes\").REGISTRATION_ENDPOINT);return a.toString()}function v(a){return w.apply(this,arguments)}function w(){w=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b=u(),e;try{e=(yield o(a,b))}catch(a){throw c(\"err\")(\"Post request failed: \"+(a==null?void 0:a.message)+\" url:\"+b)}if(e==null)throw c(\"err\")(d(\"MAWDeviceRegistrationTypes\").NULL_RESPONSE_FROM_SERVER);if(e.wa_device_id==null||e.status!==200){a=e.message!=null?': \"'+e.message+'\"':\"\";b=\"WA Server returned status code \"+e.status+a+\" while attempting device registration\";throw c(\"err\")(b)}if(typeof e.wa_device_id!==\"number\")throw c(\"err\")(\"Device ID from WA Server was not a number\");return{deviceId:e.wa_device_id,icdcSuccess:(a=e.icdc_success)!=null?a:!1,type:e.type}});return w.apply(this,arguments)}function a(a,b,c,d){a=new Map().set(\"fbid\",a).set(\"fb_cat\",b).set(\"app_id\",c).set(\"device_id\",d);b=l(a);return r(b)}function e(a,b,c,d,e,f,g,h,i){a=k(a,b,c,d,e,f,g,h,i);b=l(a);return v(b)}function f(){return x.apply(this,arguments)}function x(){x=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=(yield d(\"WAPreRegistrationCrypto\").makeRegistrationData());return{deviceUUID:c(\"uuidv4\")(),lastSignedPrekeyId:a.signedPreKey.keyId,registrationVersion:d(\"MAWConstants\").CURRENT_REGISTRATION_VERSION,signalRegInfo:a}});return x.apply(this,arguments)}g.getRegistrationEndpoint=u;g.fetchICDC=a;g.register=e;g.createNewRegistrationMeta=f}),98);\n__d(\"MAWMockServerShell\",[\"cr:8600\"],(function(a,b,c,d,e,f,g){\"use strict\";a=b(\"cr:8600\")!=null;g.isMockServerMode=a;g.getMockServer=b(\"cr:8600\")}),98);\n__d(\"MAWDeviceRegistrationWorker\",[\"IGDWebUtils\",\"MAWClearSignalAndTempStores\",\"MAWCryptoAuthTokenWrapper\",\"MAWCurrentUser\",\"MAWDbMetaTxns\",\"MAWDeviceRegistrationActions\",\"MAWDeviceRegistrationSessionUtil\",\"MAWDeviceRegistrationTypes\",\"MAWDeviceRegistrationUtilWorker\",\"MAWIndexedDb\",\"MAWJids\",\"MAWLoggerUtils\",\"MAWMockServerShell\",\"MAWODSProxy\",\"MAWQplProxy\",\"MAWTransactionMode\",\"MessengerWebInitData\",\"Promise\",\"WAICDCUtils\",\"WAIdentityUtils\",\"WAJids\",\"WAOdsEnums\",\"WAPreRegistrationCrypto\",\"WASignalKeys\",\"WATagsLogger\",\"WATimeUtils\",\"asyncToGeneratorRuntime\",\"cr:2025\",\"gkx\",\"promiseDone\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Skipping device registration\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Crypto Auth Token was null or incomplete\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Cannot process ICDC payload during registration: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Beginning device registration\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Device registration failure - \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\"\"]);n=function(){return a};return a}var o=typeof window!==\"undefined\"?window:self,p=d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.DeviceRegistration]),q=!1,r,s=function(){return d(\"IGDWebUtils\").isInstagramWebSupportedApp(Number(d(\"MAWCurrentUser\").getAppID()))};function t(a){var b;b=(b=o.location.origin)!=null?b:\"unknown\";q||(r=d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(25302457,\"311\"),{bool:{identityCompareResult:a.identityCompareResult,isDeviceRegistrationDomainUniquenessEnabled:c(\"gkx\")(\"23930\")},\"int\":{registrationVersion:a.registrationVersion},string:{hostname:b}}),q=!0)}function u(){if(q){var a;(a=r)==null?void 0:a.endFail(\"failure_during_device_registration\");r=null}}function a(){if(q){var a;(a=r)==null?void 0:a.endSuccess();r=null}}function v(a){var b;(b=r)==null?void 0:b.addPoint(\"wa_registration_response\",{string:{registrationType:a}})}function w(a){return{message:a,registrationState:d(\"MAWDeviceRegistrationTypes\").RegistrationStatesEnum.failed}}var x=function(a){return d(\"MAWIndexedDb\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READWRITE,signedPrekey:d(\"MAWTransactionMode\").READWRITE},\"inMetaStoreAndSignedPreKey\",function(b){return function(c){return a(b,c)}})},y=function(a){return d(\"MAWIndexedDb\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READWRITE},\"saveDeviceId\",function(b){return function(c){return a(b,c)}})};function z(a){return A.apply(this,arguments)}function A(){A=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){p.LOG(l());var b=(yield d(\"MAWDeviceRegistrationUtilWorker\").createNewRegistrationMeta());yield x(d(\"MAWDeviceRegistrationActions\").saveUnsentRegistrationMeta)(b);var e=d(\"MAWCurrentUser\").getID(),f=b.deviceUUID,g=d(\"WAPreRegistrationCrypto\").serializeRegistrationData(b.signalRegInfo),h=null,i=!1;i=(i=i?1019394685547802:d(\"MAWCurrentUser\").getAppID())==null?void 0:i.toString();if(i==null)return w(\"appId is null, cannot register to WhatsApp\");if(e===\"0\")return w(d(\"MAWDeviceRegistrationTypes\").DEVICE_REGISTER_ERROR_ZERO_AS_USER_ID);var j=null,m=null;try{var n=(yield d(\"MAWDeviceRegistrationUtilWorker\").fetchICDC(e,a.encrypted_serialized_cat,i,f)),o=[].concat(d(\"WAICDCUtils\").base64DeviceIdentitiesToSerializedPubKeys(n.device_identities));if(n.curr_identity_idx!=null){var q=n.curr_identity_idx;o[q]=d(\"WASignalKeys\").serializeIdentity(g.identityPubKey)}else o.push(d(\"WASignalKeys\").serializeIdentity(g.identityPubKey));j=d(\"WAICDCUtils\").computeICDCInfoForUpload(b.signalRegInfo.identityKeyPair,n.icdc_seq,o,\"registration\",\"registration\");m=(yield d(\"WAIdentityUtils\").computeIdentitiesHash(o))}catch(a){p.ERROR(k(),a)}q=!1;try{b=(yield d(\"MAWDeviceRegistrationUtilWorker\").register(e,a.encrypted_serialized_cat,i,f,g.regId,g.identityPubKeyType,g.identityPubKey,g.signedPreKey,j&&m?{ihash:m,seq:j.icdcInfo.seq,signedICDCIdentityList:j.encodedSignedICDC,ts:j.icdcInfo.timestamp}:null));n=b==null?void 0:b.type;n!=null&&d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.REGISTRATION_TYPE,key:n});h=b==null?void 0:b.deviceId;q=(o=b==null?void 0:b.icdcSuccess)!=null?o:!1;v(b==null?void 0:b.type)}catch(a){return w(a)}if(h==null)return w(d(\"MAWDeviceRegistrationTypes\").NULL_RESPONSE_FROM_SERVER);a=d(\"MAWJids\").toUserJid(e);if(!s()){i=c(\"MessengerWebInitData\").sessionId;i!=null&&c(\"promiseDone\")(d(\"MAWDeviceRegistrationSessionUtil\").linkDeviceToTheSession(f,i))}if(j!=null&&q){g=j.icdcInfo;m=function(a){return d(\"MAWIndexedDb\").makeSignalTransactor({contacts:d(\"MAWTransactionMode\").READWRITE},\"saveICDC\",function(b){return function(c,d){return a(b,c,d)}})};yield m(d(\"MAWDeviceRegistrationActions\").saveICDC)(a,{devices:g.devices,dirty:!0,sequence:g.seq,signingDeviceIndex:g.signingDeviceIndex,timestamp:g.timestamp})}yield y(d(\"MAWDeviceRegistrationActions\").saveDeviceId)(h);return{message:d(\"MAWDeviceRegistrationTypes\").DEVICE_SUCCESSFULLY_REGISTERED,registrationState:d(\"MAWDeviceRegistrationTypes\").RegistrationStatesEnum.finished}});return A.apply(this,arguments)}var B=function(a){return d(\"MAWIndexedDb\").makeSignalTransactor({identity:d(\"MAWTransactionMode\").READONLY,meta:d(\"MAWTransactionMode\").READONLY,signedPrekey:d(\"MAWTransactionMode\").READONLY},\"checkExistingRegistration\",function(b){return function(){return a(b)}})()};function e(a,b){return C.apply(this,arguments)}function C(){C=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,e){e=(e=e)!=null?e:d(\"MAWCryptoAuthTokenWrapper\").getCryptoAuthToken();if(e==null||e.encrypted_serialized_cat===\"\"){p.WARN(j());return w(d(\"MAWDeviceRegistrationTypes\").DEVICE_REGISTER_ERROR_EMPTY_CAT_TOKEN)}if(!d(\"WATimeUtils\").isInFuture(d(\"WATimeUtils\").castToUnixTime(e.expiration_time_in_seconds)))return w(d(\"MAWDeviceRegistrationTypes\").DEVICE_REGISTER_ERROR_EXPIRED_CAT_TOKEN);if(d(\"MAWMockServerShell\").isMockServerMode){var f=(yield d(\"MAWDeviceRegistrationUtilWorker\").createNewRegistrationMeta());yield (h||(h=b(\"Promise\"))).all([x(d(\"MAWDeviceRegistrationActions\").saveUnsentRegistrationMeta)(f),y(d(\"MAWDeviceRegistrationActions\").saveDeviceId)(d(\"WAJids\").interpretAsDeviceId(1)),d(\"MAWDbMetaTxns\").saveCAT(e)]);return{message:\"Skipping registration because of Mock Server\",registrationState:d(\"MAWDeviceRegistrationTypes\").RegistrationStatesEnum.finished}}f=b(\"cr:2025\")?yield b(\"cr:2025\").getRegistrationMetaRestore():yield B(d(\"MAWDeviceRegistrationActions\").getRegistrationMetaDexie);a!=null&&d(\"MAWQplProxy\").sendQplPointThroughBridge(a,\"device_registration_check\",{annotations:{bool:{identityCompareResult:f==null?void 0:f.identityCompareResult,isDeviceRegistrationDomainUniquenessEnabled:c(\"gkx\")(\"23930\")},\"int\":{registrationVersion:f==null?void 0:f.registrationVersion}}});a=(f==null?void 0:f.identityCompareResult)===!1;if(f==null||f.deviceId==null||a){try{yield d(\"MAWClearSignalAndTempStores\").clearSignalAndTempStores(),yield d(\"MAWDbMetaTxns\").saveCAT(e)}catch(a){return w(a)}t({identityCompareResult:f==null?void 0:f.identityCompareResult,registrationVersion:f==null?void 0:f.registrationVersion});return z(e)}else{yield d(\"MAWDbMetaTxns\").saveCAT(e);a=c(\"MessengerWebInitData\").sessionId;e=f.lastSessionDeviceWasLinkedTo==null||f.lastSessionDeviceWasLinkedTo!==a;a!=null&&!(f.deviceUUID===a||f.deviceUUID.startsWith(a+\"-\"))&&e&&!s()&&c(\"promiseDone\")(d(\"MAWDeviceRegistrationSessionUtil\").linkDeviceToTheSession(f.deviceUUID,a))}p.LOG(i());return{message:d(\"MAWDeviceRegistrationTypes\").DEVICE_ALREADY_REGISTERED,registrationState:d(\"MAWDeviceRegistrationTypes\").RegistrationStatesEnum.finished}});return C.apply(this,arguments)}function f(a){d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.DEVICE_REGISTRATION,key:\"fail\"});d(\"MAWCurrentUser\").isEmployee()||d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.DEVICE_REGISTRATION_NON_EMPLOYEE,key:\"fail\"});p.ERROR(n(),d(\"MAWDeviceRegistrationTypes\").FAILED_REGISTRATION_RETRIES);for(a of a)p.ERROR(m(),a);u()}g.endRegistrationTimerSuccess=a;g.handleRegistrationError=w;g.setupDeviceRegistration=e;g.logDeviceRegistrationRetryFailure=f}),98);\n__d(\"MAWDeviceRegistrationInitWorker\",[\"MAWCurrentUser\",\"MAWDeviceRegistrationTypes\",\"MAWDeviceRegistrationWorker\",\"MAWLoggerUtils\",\"MAWODSProxy\",\"MAWQplProxy\",\"MAWRotateCAT\",\"WALogger\",\"WAOdsEnums\",\"WAPromiseRetryLoop\",\"WARetryUtils\",\"WATagsLogger\",\"asyncToGeneratorRuntime\",\"gkx\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Registration finished, ending device registration promise retry loop\"]);i=function(){return a};return a}function a(){var a=1,e=new Set(),f=new(d(\"WAPromiseRetryLoop\").PromiseRetryLoop)({code:function(){var f=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(b){if(a===d(\"MAWDeviceRegistrationTypes\").MAX_DEVICE_REGISTRATION_RETRIES){d(\"MAWDeviceRegistrationWorker\").logDeviceRegistrationRetryFailure(e);var f=d(\"MAWDeviceRegistrationWorker\").handleRegistrationError(d(\"MAWDeviceRegistrationTypes\").FAILED_REGISTRATION_RETRIES);b(f);return}try{f=a===1?c(\"qpl\")._(25310776,\"6155\"):null;var g=null;a>1&&c(\"gkx\")(\"1312\")&&(g=(yield d(\"MAWRotateCAT\").rotateCAT()));f=(yield d(\"MAWDeviceRegistrationWorker\").setupDeviceRegistration(f,g));f.registrationState===d(\"MAWDeviceRegistrationTypes\").RegistrationStatesEnum.finished&&(f.message===d(\"MAWDeviceRegistrationTypes\").DEVICE_SUCCESSFULLY_REGISTERED&&(d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.DEVICE_REGISTRATION,key:\"success\"}),d(\"MAWCurrentUser\").isEmployee()||d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.DEVICE_REGISTRATION_NON_EMPLOYEE,key:\"success\"}),d(\"MAWDeviceRegistrationWorker\").endRegistrationTimerSuccess()),d(\"WALogger\").LOG(i()),b(f));e.add(f.message)}catch(a){g=\"Uncaught device registration error - \"+a;d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.DeviceRegistration]).WARN(h(),g);e.add(\"\"+g)}a++});function g(a){return f.apply(this,arguments)}return g}(),name:\"deviceRegistration\",timer:d(\"WARetryUtils\").FIBONACCI_BACKOFF});d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(25310776,\"6155\"),\"device_registration_start\");f.start();return f.promise()}g.initDeviceRegistration=a}),98);\n__d(\"WAGetSyncKey\",[\"WABaseGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return d(\"WABaseGlobals\").runInTransaction({SyncKeyStore:!0},function(b){b=b.SyncKeyStore;return b.get(a)})}function b(){return d(\"WABaseGlobals\").runInTransaction({SyncKeyStore:!0},function(a){a=a.SyncKeyStore;return a.getAll()})}function c(a){return d(\"WABaseGlobals\").runInTransaction({SyncKeyStore:!0},function(b){b=b.SyncKeyStore;return b.set(a)})}function e(a){return d(\"WABaseGlobals\").runInTransaction({SyncKeyStore:!0},function(b){b=b.SyncKeyStore;return b.expire(a)})}g.getSyncKeyInTransaction_DO_NOT_USE=a;g.getAllSyncKeysInTransaction=b;g.setSyncKeyInTransaction=c;g.expireSyncKeyInTransaction=e}),98);\n__d(\"WASyncdConst\",[\"$InternalEnum\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=1e3;c=1e3*60*60;e=2;f=d(\"WATimeUtils\").DAY_MILLISECONDS*2;d=100;var h=2e3,i=10,j=100,k=0,l=3,m=7,n=(b=b(\"$InternalEnum\"))({Star:\"star\",Contact:\"contact\",Mute:\"mute\",PinDEPRECATED:\"pin\",Pin:\"pin_v1\",SettingPushName:\"setting_pushName\",LabelEdit:\"label_edit\",LabelMessage:\"label_message\",LabelJid:\"label_jid\",QuickReply:\"quick_reply\",LocaleSetting:\"setting_locale\",Archive:\"archive\",MarkChatAsRead:\"markChatAsRead\",ClearChat:\"clearChat\",DeleteMessageForMe:\"deleteMessageForMe\",Sentinel:\"sentinel\",UnarchiveChatsSetting:\"setting_unarchiveChats\",DeleteChat:\"deleteChat\",AndroidUnsupportedActions:\"android_unsupported_actions\",PrimaryFeature:\"primary_feature\",Subscription:\"subscription\",Nux:\"nux\",Agent:\"deviceAgent\",TimeFormat:\"time_format\",UserStatusMute:\"userStatusMute\",PrimaryVersion:\"primary_version\",RemoveRecentSticker:\"removeRecentSticker\",ChatAssignment:\"agentChatAssignment\",ChatAssignmentOpenedStatus:\"agentChatAssignmentOpenedStatus\",FavoriteSticker:\"favoriteSticker\",PnForLidChat:\"pnForLidChat\",ShareOwnPn:\"shareOwnPn\",ExternalWebBeta:\"external_web_beta\",MarketingMessage:\"marketingMessage\",MarketingMessageBroadcast:\"marketingMessageBroadcast\",StatusPrivacy:\"status_privacy\",BotWelcomeRequest:\"bot_welcome_request\",LabelReordering:\"label_reordering\",PaymentInfo:\"payment_info\",CustomPaymentMethods:\"custom_payment_methods\",LockChat:\"lock\",ChatLockSettings:\"setting_chatLock\",DeviceCapabilities:\"device_capabilities\",DisableLinkPreviews:\"setting_disableLinkPreviews\"}),o=b({Regular:\"regular\",RegularLow:\"regular_low\",RegularHigh:\"regular_high\",CriticalBlock:\"critical_block\",CriticalUnblockLow:\"critical_unblock_low\"}),p=b.Mirrored([\"Success\",\"SuccessHasMore\",\"Conflict\",\"ConflictHasMore\",\"ErrorRetry\",\"ErrorFatal\",\"Blocked\"]),q=b.Mirrored([\"UpToDate\",\"Dirty\",\"FailingFiniteRetry\",\"Fatal\",\"Blocked\"]),r=b.Mirrored([\"Success\",\"Malformed\",\"Orphan\",\"Unsupported\",\"Skipped\",\"Failed\"]),s=b.Mirrored([\"Msg\",\"Chat\",\"Agent\",\"ChatAssignment\",\"UserStatusMute\"]),t=b.Mirrored([\"ApplyRemoteAndDropLocal\",\"SkipRemote\",\"SkipRemoteAndDropLocal\"]);b=b.Mirrored([\"Patch\",\"Snapshot\",\"Local\"]);g.BACKOFF_MIN_TIMEOUT=a;g.BACKOFF_MAX_TIMEOUT=c;g.BACKOFF_BASE=e;g.FINITE_FAILURE_EXPIRY_DURATION=f;g.MIN_INLINE_MUTATIONS=d;g.MAX_INLINE_MUTATIONS=h;g.MIN_PATCH_SIZE=i;g.MAX_PATCH_SIZE=j;g.DEFAULT_COLLECTION_VERSION=k;g.LABEL_ASSOCIATION_SYNC_VERSION=l;g.CHAT_ASSIGNMENT_SYNC_VERSION=m;g.Actions=n;g.CollectionName=o;g.CollectionState=p;g.CollectionSyncState=q;g.SyncActionState=r;g.SyncModelType=s;g.ConflictResolutionState=t;g.SyncDataType=b}),98);\n__d(\"WASyncdAction\",[\"Promise\",\"WASyncdConst\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;a=function(){function a(){}var c=a.prototype;c.getChatJidAndMessageKey=function(a){return};c.resolveConflicts=function(a,c){c=c.timestamp;return c>=a.timestamp?(h||(h=b(\"Promise\"))).resolve(d(\"WASyncdConst\").ConflictResolutionState.ApplyRemoteAndDropLocal):(h||(h=b(\"Promise\"))).resolve(d(\"WASyncdConst\").ConflictResolutionState.SkipRemote)};c.dropMutationDueToCrossIndexConflict=function(a,c){return(h||(h=b(\"Promise\"))).resolve(!1)};return a}();g.SyncActionBase=a}),98);\n__d(\"WAProtobufsUserPassword.pb\",[\"$InternalEnum\",\"WAProtoConst\"],(function(a,b,c,d,e,f,g){a=b(\"$InternalEnum\")({NONE:0,PBKDF2_HMAC_SHA512:1,PBKDF2_HMAC_SHA384:2});c=b(\"$InternalEnum\")({UTF8:0});e={};f={};b={};e.internalSpec={encoding:[1,(d=d(\"WAProtoConst\")).TYPES.ENUM,c],transformer:[2,d.TYPES.ENUM,a],transformerArg:[3,d.FLAGS.REPEATED|d.TYPES.MESSAGE,f],transformedData:[4,d.TYPES.BYTES]};f.internalSpec={key:[1,d.TYPES.STRING],value:[2,d.TYPES.MESSAGE,b]};b.internalSpec={asBlob:[1,d.TYPES.BYTES],asUnsignedInteger:[2,d.TYPES.UINT32],__oneofs__:{value:[\"asBlob\",\"asUnsignedInteger\"]}};g.UserPassword$Transformer=a;g.UserPassword$Encoding=c;g.UserPasswordSpec=e;g.UserPassword$TransformerArgSpec=f;g.UserPassword$TransformerArg$ValueSpec=b}),98);\n__d(\"WAProtobufsChatLockSettings.pb\",[\"WAProtoConst\",\"WAProtobufsUserPassword.pb\"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={hideLockedChats:[1,d(\"WAProtoConst\").TYPES.BOOL],secretCode:[2,d(\"WAProtoConst\").TYPES.MESSAGE,d(\"WAProtobufsUserPassword.pb\").UserPasswordSpec]};g.ChatLockSettingsSpec=a}),98);\n__d(\"WAProtobufsDeviceCapabilities.pb\",[\"$InternalEnum\",\"WAProtoConst\"],(function(a,b,c,d,e,f,g){a=b(\"$InternalEnum\")({NONE:0,MINIMAL:1,FULL:2});c={};c.internalSpec={chatLockSupportLevel:[1,d(\"WAProtoConst\").TYPES.ENUM,a]};g.DeviceCapabilities$ChatLockSupportLevel=a;g.DeviceCapabilitiesSpec=c}),98);\n__d(\"WAProtocol.pb\",[\"WAProtoConst\"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={remoteJid:[1,(b=d(\"WAProtoConst\")).TYPES.STRING],fromMe:[2,b.TYPES.BOOL],id:[3,b.TYPES.STRING],participant:[4,b.TYPES.STRING]};g.MessageKeySpec=a}),98);\n__d(\"WASyncAction.pb\",[\"$InternalEnum\",\"WAProtoConst\",\"WAProtobufsChatLockSettings.pb\",\"WAProtobufsDeviceCapabilities.pb\",\"WAProtocol.pb\"],(function(a,b,c,d,e,f,g){var h;c=(a=b(\"$InternalEnum\"))({REGULAR:0,SCHEDULED_CALL:1,VOICE_CHAT:2});e=a({NONE:0,SCHEDULED:1,PRIVACY:2,LIGHTWEIGHT:3});f=a({CONNECTED:0,REJECTED:1,CANCELLED:2,ACCEPTEDELSEWHERE:3,MISSED:4,INVALID:5,UNAVAILABLE:6,UPCOMING:7,FAILED:8,ABANDONED:9,ONGOING:10});b=a({UNSTRUCTURED:1,STRUCTURED:2});var aa=a({ALLOW_LIST:0,DENY_LIST:1,CONTACTS:2}),ba=a({PERSONALIZED:0});a=a({ANDROID:0,SMBA:1,IPHONE:2,SMBI:3,WEB:4,UWP:5,DARWIN:6});var i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={},K={},L={},M={},N={},O={},P={},Q={},R={},S={},T={},U={},V={},W={},X={},Y={},Z={},$={},ca={},da={},ea={},fa={},ga={},ha={},ia={},ja={},ka={},la={},ma={};i.internalSpec={emoji:[1,(h=d(\"WAProtoConst\")).TYPES.STRING],weight:[2,h.TYPES.FLOAT]};j.internalSpec={callResult:[1,h.TYPES.ENUM,f],isDndMode:[2,h.TYPES.BOOL],silenceReason:[3,h.TYPES.ENUM,e],duration:[4,h.TYPES.INT64],startTime:[5,h.TYPES.INT64],isIncoming:[6,h.TYPES.BOOL],isVideo:[7,h.TYPES.BOOL],isCallLink:[8,h.TYPES.BOOL],callLinkToken:[9,h.TYPES.STRING],scheduledCallId:[10,h.TYPES.STRING],callId:[11,h.TYPES.STRING],callCreatorJid:[12,h.TYPES.STRING],groupJid:[13,h.TYPES.STRING],participants:[14,h.FLAGS.REPEATED|h.TYPES.MESSAGE,k],callType:[15,h.TYPES.ENUM,c]};k.internalSpec={userJid:[1,h.TYPES.STRING],callResult:[2,h.TYPES.ENUM,f]};l.internalSpec={timestamp:[1,h.TYPES.INT64],starAction:[2,h.TYPES.MESSAGE,ka],contactAction:[3,h.TYPES.MESSAGE,ja],muteAction:[4,h.TYPES.MESSAGE,ia],pinAction:[5,h.TYPES.MESSAGE,ha],securityNotificationSetting:[6,h.TYPES.MESSAGE,ga],pushNameSetting:[7,h.TYPES.MESSAGE,fa],quickReplyAction:[8,h.TYPES.MESSAGE,da],recentEmojiWeightsAction:[11,h.TYPES.MESSAGE,Z],labelEditAction:[14,h.TYPES.MESSAGE,$],labelAssociationAction:[15,h.TYPES.MESSAGE,ca],localeSetting:[16,h.TYPES.MESSAGE,ea],archiveChatAction:[17,h.TYPES.MESSAGE,Y],deleteMessageForMeAction:[18,h.TYPES.MESSAGE,X],keyExpiration:[19,h.TYPES.MESSAGE,Q],markChatAsReadAction:[20,h.TYPES.MESSAGE,W],clearChatAction:[21,h.TYPES.MESSAGE,V],deleteChatAction:[22,h.TYPES.MESSAGE,U],unarchiveChatsSetting:[23,h.TYPES.MESSAGE,T],primaryFeature:[24,h.TYPES.MESSAGE,P],androidUnsupportedActions:[26,h.TYPES.MESSAGE,O],agentAction:[27,h.TYPES.MESSAGE,N],subscriptionAction:[28,h.TYPES.MESSAGE,M],userStatusMuteAction:[29,h.TYPES.MESSAGE,L],timeFormatAction:[30,h.TYPES.MESSAGE,K],nuxAction:[31,h.TYPES.MESSAGE,J],primaryVersionAction:[32,h.TYPES.MESSAGE,I],stickerAction:[33,h.TYPES.MESSAGE,G],removeRecentStickerAction:[34,h.TYPES.MESSAGE,H],chatAssignment:[35,h.TYPES.MESSAGE,F],chatAssignmentOpenedStatus:[36,h.TYPES.MESSAGE,E],pnForLidChatAction:[37,h.TYPES.MESSAGE,D],marketingMessageAction:[38,h.TYPES.MESSAGE,C],marketingMessageBroadcastAction:[39,h.TYPES.MESSAGE,B],externalWebBetaAction:[40,h.TYPES.MESSAGE,A],privacySettingRelayAllCalls:[41,h.TYPES.MESSAGE,z],callLogAction:[42,h.TYPES.MESSAGE,y],statusPrivacy:[44,h.TYPES.MESSAGE,x],botWelcomeRequestAction:[45,h.TYPES.MESSAGE,w],deleteIndividualCallLog:[46,h.TYPES.MESSAGE,v],labelReorderingAction:[47,h.TYPES.MESSAGE,u],paymentInfoAction:[48,h.TYPES.MESSAGE,t],customPaymentMethodsAction:[49,h.TYPES.MESSAGE,q],lockChatAction:[50,h.TYPES.MESSAGE,p],chatLockSettings:[51,h.TYPES.MESSAGE,d(\"WAProtobufsChatLockSettings.pb\").ChatLockSettingsSpec],wamoUserIdentifierAction:[52,h.TYPES.MESSAGE,o],privacySettingDisableLinkPreviewsAction:[53,h.TYPES.MESSAGE,n],deviceCapabilities:[54,h.TYPES.MESSAGE,d(\"WAProtobufsDeviceCapabilities.pb\").DeviceCapabilitiesSpec],noteEditAction:[55,h.TYPES.MESSAGE,m]};m.internalSpec={type:[1,h.TYPES.ENUM,b],chatJid:[2,h.TYPES.STRING],createdAt:[3,h.TYPES.INT64],deleted:[4,h.TYPES.BOOL],unstructuredContent:[5,h.TYPES.STRING]};n.internalSpec={isPreviewsDisabled:[1,h.TYPES.BOOL]};o.internalSpec={identifier:[1,h.TYPES.STRING]};p.internalSpec={locked:[1,h.TYPES.BOOL]};q.internalSpec={customPaymentMethods:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,r]};r.internalSpec={credentialId:[1,h.FLAGS.REQUIRED|h.TYPES.STRING],country:[2,h.FLAGS.REQUIRED|h.TYPES.STRING],type:[3,h.FLAGS.REQUIRED|h.TYPES.STRING],metadata:[4,h.FLAGS.REPEATED|h.TYPES.MESSAGE,s]};s.internalSpec={key:[1,h.FLAGS.REQUIRED|h.TYPES.STRING],value:[2,h.FLAGS.REQUIRED|h.TYPES.STRING]};t.internalSpec={cpi:[1,h.TYPES.STRING]};u.internalSpec={sortedLabelIds:[1,h.FLAGS.REPEATED|h.TYPES.INT32]};v.internalSpec={peerJid:[1,h.TYPES.STRING],isIncoming:[2,h.TYPES.BOOL]};w.internalSpec={isSent:[1,h.TYPES.BOOL]};x.internalSpec={mode:[1,h.TYPES.ENUM,aa],userJid:[2,h.FLAGS.REPEATED|h.TYPES.STRING]};y.internalSpec={callLogRecord:[1,h.TYPES.MESSAGE,j]};z.internalSpec={isEnabled:[1,h.TYPES.BOOL]};A.internalSpec={isOptIn:[1,h.TYPES.BOOL]};B.internalSpec={repliedCount:[1,h.TYPES.INT32]};C.internalSpec={name:[1,h.TYPES.STRING],message:[2,h.TYPES.STRING],type:[3,h.TYPES.ENUM,ba],createdAt:[4,h.TYPES.INT64],lastSentAt:[5,h.TYPES.INT64],isDeleted:[6,h.TYPES.BOOL],mediaId:[7,h.TYPES.STRING]};D.internalSpec={pnJid:[1,h.TYPES.STRING]};E.internalSpec={chatOpened:[1,h.TYPES.BOOL]};F.internalSpec={deviceAgentID:[1,h.TYPES.STRING]};G.internalSpec={url:[1,h.TYPES.STRING],fileEncSha256:[2,h.TYPES.BYTES],mediaKey:[3,h.TYPES.BYTES],mimetype:[4,h.TYPES.STRING],height:[5,h.TYPES.UINT32],width:[6,h.TYPES.UINT32],directPath:[7,h.TYPES.STRING],fileLength:[8,h.TYPES.UINT64],isFavorite:[9,h.TYPES.BOOL],deviceIdHint:[10,h.TYPES.UINT32],isLottie:[11,h.TYPES.BOOL]};H.internalSpec={lastStickerSentTs:[1,h.TYPES.INT64]};I.internalSpec={version:[1,h.TYPES.STRING]};J.internalSpec={acknowledged:[1,h.TYPES.BOOL]};K.internalSpec={isTwentyFourHourFormatEnabled:[1,h.TYPES.BOOL]};L.internalSpec={muted:[1,h.TYPES.BOOL]};M.internalSpec={isDeactivated:[1,h.TYPES.BOOL],isAutoRenewing:[2,h.TYPES.BOOL],expirationDate:[3,h.TYPES.INT64]};N.internalSpec={name:[1,h.TYPES.STRING],deviceID:[2,h.TYPES.INT32],isDeleted:[3,h.TYPES.BOOL]};O.internalSpec={allowed:[1,h.TYPES.BOOL]};P.internalSpec={flags:[1,h.FLAGS.REPEATED|h.TYPES.STRING]};Q.internalSpec={expiredKeyEpoch:[1,h.TYPES.INT32]};R.internalSpec={key:[1,h.TYPES.MESSAGE,d(\"WAProtocol.pb\").MessageKeySpec],timestamp:[2,h.TYPES.INT64]};S.internalSpec={lastMessageTimestamp:[1,h.TYPES.INT64],lastSystemMessageTimestamp:[2,h.TYPES.INT64],messages:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,R]};T.internalSpec={unarchiveChats:[1,h.TYPES.BOOL]};U.internalSpec={messageRange:[1,h.TYPES.MESSAGE,S]};V.internalSpec={messageRange:[1,h.TYPES.MESSAGE,S]};W.internalSpec={read:[1,h.TYPES.BOOL],messageRange:[2,h.TYPES.MESSAGE,S]};X.internalSpec={deleteMedia:[1,h.TYPES.BOOL],messageTimestamp:[2,h.TYPES.INT64]};Y.internalSpec={archived:[1,h.TYPES.BOOL],messageRange:[2,h.TYPES.MESSAGE,S]};Z.internalSpec={weights:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,i]};$.internalSpec={name:[1,h.TYPES.STRING],color:[2,h.TYPES.INT32],predefinedId:[3,h.TYPES.INT32],deleted:[4,h.TYPES.BOOL],orderIndex:[5,h.TYPES.INT32]};ca.internalSpec={labeled:[1,h.TYPES.BOOL]};da.internalSpec={shortcut:[1,h.TYPES.STRING],message:[2,h.TYPES.STRING],keywords:[3,h.FLAGS.REPEATED|h.TYPES.STRING],count:[4,h.TYPES.INT32],deleted:[5,h.TYPES.BOOL]};ea.internalSpec={locale:[1,h.TYPES.STRING]};fa.internalSpec={name:[1,h.TYPES.STRING]};ga.internalSpec={showNotification:[1,h.TYPES.BOOL]};ha.internalSpec={pinned:[1,h.TYPES.BOOL]};ia.internalSpec={muted:[1,h.TYPES.BOOL],muteEndTimestamp:[2,h.TYPES.INT64],autoMuted:[3,h.TYPES.BOOL]};ja.internalSpec={fullName:[1,h.TYPES.STRING],firstName:[2,h.TYPES.STRING],lidJid:[3,h.TYPES.STRING],saveOnPrimaryAddressbook:[4,h.TYPES.BOOL]};ka.internalSpec={starred:[1,h.TYPES.BOOL]};la.internalSpec={index:[1,h.TYPES.BYTES],value:[2,h.TYPES.MESSAGE,l],padding:[3,h.TYPES.BYTES],version:[4,h.TYPES.INT32]};ma.internalSpec={currentLthash:[1,h.TYPES.BYTES],newLthash:[2,h.TYPES.BYTES],patchVersion:[3,h.TYPES.BYTES],collectionName:[4,h.TYPES.BYTES],firstFourBytesFromAHashOfSnapshotMacKey:[5,h.TYPES.BYTES],newLthashSubtract:[6,h.TYPES.BYTES],numberAdd:[7,h.TYPES.INT32],numberRemove:[8,h.TYPES.INT32],numberOverride:[9,h.TYPES.INT32],senderPlatform:[10,h.TYPES.ENUM,a],isSenderPrimary:[11,h.TYPES.BOOL]};g.CallLogRecord$CallType=c;g.CallLogRecord$SilenceReason=e;g.CallLogRecord$CallResult=f;g.SyncActionValue$NoteEditAction$NoteType=b;g.SyncActionValue$StatusPrivacyAction$StatusDistributionMode=aa;g.SyncActionValue$MarketingMessageAction$MarketingMessagePrototypeType=ba;g.PatchDebugData$Platform=a;g.RecentEmojiWeightSpec=i;g.CallLogRecordSpec=j;g.CallLogRecord$ParticipantInfoSpec=k;g.SyncActionValueSpec=l;g.SyncActionValue$NoteEditActionSpec=m;g.SyncActionValue$PrivacySettingDisableLinkPreviewsActionSpec=n;g.SyncActionValue$WamoUserIdentifierActionSpec=o;g.SyncActionValue$LockChatActionSpec=p;g.SyncActionValue$CustomPaymentMethodsActionSpec=q;g.SyncActionValue$CustomPaymentMethodSpec=r;g.SyncActionValue$CustomPaymentMethodMetadataSpec=s;g.SyncActionValue$PaymentInfoActionSpec=t;g.SyncActionValue$LabelReorderingActionSpec=u;g.SyncActionValue$DeleteIndividualCallLogActionSpec=v;g.SyncActionValue$BotWelcomeRequestActionSpec=w;g.SyncActionValue$StatusPrivacyActionSpec=x;g.SyncActionValue$CallLogActionSpec=y;g.SyncActionValue$PrivacySettingRelayAllCallsSpec=z;g.SyncActionValue$ExternalWebBetaActionSpec=A;g.SyncActionValue$MarketingMessageBroadcastActionSpec=B;g.SyncActionValue$MarketingMessageActionSpec=C;g.SyncActionValue$PnForLidChatActionSpec=D;g.SyncActionValue$ChatAssignmentOpenedStatusActionSpec=E;g.SyncActionValue$ChatAssignmentActionSpec=F;g.SyncActionValue$StickerActionSpec=G;g.SyncActionValue$RemoveRecentStickerActionSpec=H;g.SyncActionValue$PrimaryVersionActionSpec=I;g.SyncActionValue$NuxActionSpec=J;g.SyncActionValue$TimeFormatActionSpec=K;g.SyncActionValue$UserStatusMuteActionSpec=L;g.SyncActionValue$SubscriptionActionSpec=M;g.SyncActionValue$AgentActionSpec=N;g.SyncActionValue$AndroidUnsupportedActionsSpec=O;g.SyncActionValue$PrimaryFeatureSpec=P;g.SyncActionValue$KeyExpirationSpec=Q;g.SyncActionValue$SyncActionMessageSpec=R;g.SyncActionValue$SyncActionMessageRangeSpec=S;g.SyncActionValue$UnarchiveChatsSettingSpec=T;g.SyncActionValue$DeleteChatActionSpec=U;g.SyncActionValue$ClearChatActionSpec=V;g.SyncActionValue$MarkChatAsReadActionSpec=W;g.SyncActionValue$DeleteMessageForMeActionSpec=X;g.SyncActionValue$ArchiveChatActionSpec=Y;g.SyncActionValue$RecentEmojiWeightsActionSpec=Z;g.SyncActionValue$LabelEditActionSpec=$;g.SyncActionValue$LabelAssociationActionSpec=ca;g.SyncActionValue$QuickReplyActionSpec=da;g.SyncActionValue$LocaleSettingSpec=ea;g.SyncActionValue$PushNameSettingSpec=fa;g.SyncActionValue$SecurityNotificationSettingSpec=ga;g.SyncActionValue$PinActionSpec=ha;g.SyncActionValue$MuteActionSpec=ia;g.SyncActionValue$ContactActionSpec=ja;g.SyncActionValue$StarActionSpec=ka;g.SyncActionDataSpec=la;g.PatchDebugDataSpec=ma}),98);\n__d(\"WASyncdActionUtils\",[\"WASyncAction.pb\",\"encodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a,b){return JSON.stringify([a].concat(b))}function a(a){var b=a.action,c=a.indexArgs,e=a.collection,f=a.value,g=a.version,i=a.operation;a=a.timestamp;return{collection:e,index:h(b,c),binarySyncAction:d(\"encodeProtobuf\").encodeProtobuf(d(\"WASyncAction.pb\").SyncActionValueSpec,babelHelpers[\"extends\"]({},f,{timestamp:a})).readBuffer(),version:g,operation:i,timestamp:a,action:b}}function b(a){var b=a.remoteJid,c=a.id,d=a.fromMe;a=a.participant;return[b,c,d?\"1\":\"0\",a!=null&&!d?a:\"0\"]}g.buildIndex=h;g.buildPendingMutation=a;g.buildMessageKey=b}),98);\n__d(\"WASyncdKeyManagementUtils\",[\"WASyncdKeyTypes\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return new DataView(d(\"WASyncdKeyTypes\").fromSyncKeyId(a)).getUint16(0)}function h(a){return new DataView(d(\"WASyncdKeyTypes\").fromSyncKeyId(a)).getUint32(2)}function b(a){return h(a)+1}g.getKeyDeviceId=a;g.getKeyEpoch=h;g.generateNewKeyEpoch=b}),98);\n__d(\"WASyncdMetrics\",[\"$InternalEnum\",\"WALogger\",\"WAPREList\",\"WAPREMetrics\",\"WASyncdConst\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: unknown error code: \",\" for key rotation event\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing error code for key rotation event\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: unknown error code: \",\" for critical event\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing error code for critical event\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: unknown collection \",\" for bootstrap data applied event\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing durationMs for bootstrap data applied event\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing snapshotUsed for bootstrap data applied event\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing collection for bootstrap data applied event\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: unknown collection \",\" for bootstrap app state download metric\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing isSuccess for bootstrap app state download metric\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing downloadStartTs for bootstrap app state download metric\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing collection for bootstrap app state download metric\"]);s=function(){return a};return a}var t=b(\"$InternalEnum\").Mirrored([\"MISSING_MUTATION_TO_REMOVE\"]),u=b(\"$InternalEnum\").Mirrored([\"SNAPSHOT_USED\",\"SNAPSHOT_NOT_USED\"]),v=b(\"$InternalEnum\").Mirrored([\"APP_STATE_SYNC_KEY_EXPIRY\",\"DEVICE_DEREGISTERATION\",\"NO_KEYS\"]);function a(a){var b=d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.SYNCD_BOOTSTRAP_APP_STATE_DOWNLOAD);a.isSuccess!==\"success\"?b.endFail(\"syncd error: Error downloading snapshot or patches\",w(a)):b.endSuccess(w(a))}function c(a,b,c){d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.SYNCD_BOOTSTRAP_DATA_APPLIED).endSuccess(x({collection:a,snapshotUsed:b,durationMs:c}))}function e(a,b){d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.SYNCD_CRITICAL_EVENT).endFail(\"syncd critical event: \"+a,y({type:a,collection:b}))}function f(a){d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.SYNCD_KEY_ROTATION).endSuccess(z({type:a}))}function w(a){var b=a.collection,c=a.downloadSize,d=a.downloadStartTs;a=a.isSuccess;return{string:{collection:b},\"int\":{downloadSize:c,downloadStartTs:d},bool:{isSuccess:a===\"success\"}}}function x(a){return{string:{collection:a.collection},bool:{snapshot:a.snapshotUsed===u.SNAPSHOT_USED},\"int\":{durationMs:a.durationMs}}}function y(a){return{string:{criticalEventCode:a.type,collection:a.collection==null?null:a.collection}}}function z(a){return{string:{keyRotationEventCode:a.type}}}function A(a){var b,c,e;b=a==null?void 0:(b=a.string)==null?void 0:b.collection;c=a==null?void 0:(c=a[\"int\"])==null?void 0:c.downloadSize;e=a==null?void 0:(e=a[\"int\"])==null?void 0:e.downloadStartTs;a=a==null?void 0:(a=a.bool)==null?void 0:a.isSuccess;if(b==null){d(\"WALogger\").ERROR(s());return null}if(e==null){d(\"WALogger\").ERROR(r());return null}if(a==null){d(\"WALogger\").ERROR(q());return null}var f=d(\"WASyncdConst\").CollectionName.cast(b);if(f==null){d(\"WALogger\").ERROR(p(),b);return null}b=a?\"success\":\"failure\";return{collection:f,downloadStartTs:e,downloadSize:c,isSuccess:b}}function B(a){var b,c;b=a==null?void 0:(b=a.string)==null?void 0:b.collection;c=a==null?void 0:(c=a.bool)==null?void 0:c.snapshot;a=a==null?void 0:(a=a[\"int\"])==null?void 0:a.durationMs;if(b==null){d(\"WALogger\").ERROR(o());return null}if(c==null){d(\"WALogger\").ERROR(n());return null}if(a==null){d(\"WALogger\").ERROR(m());return null}var e=d(\"WASyncdConst\").CollectionName.cast(b);if(e==null){d(\"WALogger\").ERROR(l(),b);return null}b=c?u.SNAPSHOT_USED:u.SNAPSHOT_NOT_USED;return{collection:e,snapshotUsed:b,durationMs:a}}function C(a){var b;b=a==null?void 0:(b=a.string)==null?void 0:b.criticalEventCode;if(b==null){d(\"WALogger\").ERROR(k());return null}var c=t.cast(b);if(c==null){d(\"WALogger\").ERROR(j(),b);return null}return{type:c,collection:d(\"WASyncdConst\").CollectionName.cast(a==null?void 0:(b=a.string)==null?void 0:b.collection)}}function D(a){a=a==null?void 0:(a=a.string)==null?void 0:a.keyRotationEventCode;if(a==null){d(\"WALogger\").ERROR(i());return null}var b=v.cast(a);if(b==null){d(\"WALogger\").ERROR(h(),a);return null}return{type:b}}function E(a){var b={};Object.keys(a).forEach(function(c){typeof a[c]===\"number\"?(b[\"int\"]==null&&(b[\"int\"]={}),b[\"int\"][c]=a[c]):typeof a[c]===\"string\"&&(b.string==null&&(b.string={}),b.string[c]=a[c])});return Object.keys(b).length>0?b:void 0}b=function(){function a(){this.event=d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.SYNCD)}var b=a.prototype;b.end=function(a){a===void 0&&(a=!1),a?this.event.endFail(\"syncd failed\"):this.event.endSuccess()};b.mark=function(a,b){this.event.addPoint(a,E(b))};return a}();g.SyncdCriticalEventType=t;g.SyncdBootstrapDataAppliedSnapshotUsed=u;g.SyncdKeyRotationEventType=v;g.reportSyncdBootstrapAppStateDownloadMetric=a;g.reportSyncdBootstrapDataApplied=c;g.reportSyncdCriticalEvent=e;g.reportSyncdKeyRotationEvent=f;g.convertSyncdBootstrapAppStateDownloadFromAnnotations=A;g.convertSyncdBootstrapDataAppliedFromAnnotations=B;g.convertSyncdCriticalEventFromAnnotations=C;g.convertSyncdKeyRotationEventFromAnnotations=D;g.constructAnnotationsFromContext=E;g.SyncdEventFlow=b}),98);\n__d(\"WAArrayBuffersConcat\",[],(function(a,b,c,d,e,f){\"use strict\";function a(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];var d=b.reduce(function(a,b){return a+b.byteLength},0),e=new Uint8Array(d),f=0;b.forEach(function(a){e.set(new Uint8Array(a),f),f+=a.byteLength});return e.buffer}f.concatArrayBuffers=a}),66);\n__d(\"WASyncdRotateKey\",[\"WAArrayBuffersConcat\",\"WABaseGlobals\",\"WAByteArray\",\"WACryptoDependencies\",\"WAJids\",\"WASyncdKeyManagementUtils\",\"WASyncdKeyTypes\",\"WATimeUtils\",\"equalsSet\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=1,i=90;function a(a){a=a.timestamp;var b=Math.min(i,Math.max(h,d(\"WABaseGlobals\").getConfig().syncdKeyMaxUseDays()));b=b*d(\"WATimeUtils\").DAY_MILLISECONDS;a=d(\"WATimeUtils\").unixTimeMs()-a;return a>b}function b(a,b){a=a.fingerprint;var d=b.rawId,e=b.currentIndex;b=b.deviceIndexes;var f=new Set(a.deviceIndexes);for(var g=a.currentIndex+1;g<=e;g++)f.add(g);return a.rawId!==d||!c(\"equalsSet\")(f,new Set(b))}function e(a,b){b=j(b);var c=b.keyId;b=b.keyEpoch;var e=k(),f=d(\"WATimeUtils\").unixTimeMs();return{keyId:c,keyEpoch:b,keyData:e,fingerprint:a,timestamp:f}}function j(a){if(a==null){var b=new Uint8Array(16);d(\"WACryptoDependencies\").getCrypto().getRandomValues(b);b=d(\"WASyncdKeyManagementUtils\").generateNewKeyEpoch(d(\"WASyncdKeyTypes\").toSyncKeyId(b.buffer))}else b=d(\"WASyncdKeyManagementUtils\").generateNewKeyEpoch(a.keyId);a=d(\"WAJids\").interpretAsNumber(d(\"WAJids\").extractDeviceId(d(\"WABaseGlobals\").getMyDeviceJid()));return{keyId:d(\"WASyncdKeyTypes\").toSyncKeyId(new Uint8Array(d(\"WAArrayBuffersConcat\").concatArrayBuffers(d(\"WAByteArray\").intToBytes(2,a).buffer,d(\"WAByteArray\").intToBytes(4,b).buffer)).buffer),keyEpoch:b}}function k(){return d(\"WASyncdKeyTypes\").toSyncKeyData(d(\"WACryptoDependencies\").getCrypto().getRandomValues(new Uint8Array(32)).buffer)}g.hasKeyExpired=a;g.hasADeviceBeenRemoved=b;g.rotateKey=e}),98);\n__d(\"WASyncdKeyManagement\",[\"WABaseGlobals\",\"WAErr\",\"WAGetSyncKey\",\"WALogger\",\"WAPromiseQueue\",\"WASyncdCryptoUtils\",\"WASyncdKeyManagementUtils\",\"WASyncdMetrics\",\"WASyncdRotateKey\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: key rotation due to no key present\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: key rotation due to device removal\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: key rotation due to key expiry\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: stored key rotation key id \",\"\"]);k=function(){return a};return a}var l=new(d(\"WAPromiseQueue\").PromiseQueue)();function a(a){a===void 0&&(a=!0);return l.enqueue(function(){return m(a)})}function m(a){var e,f,g,l,o;return b(\"regeneratorRuntime\").async(function(p){while(1)switch(p.prev=p.next){case 0:a===void 0&&(a=!0);p.next=3;return b(\"regeneratorRuntime\").awrap(n());case 3:e=p.sent;p.next=6;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().getDeviceFingerprint());case 6:f=p.sent;g=!1;l=!1;if(!(e!=null)){p.next=16;break}g=d(\"WASyncdRotateKey\").hasKeyExpired(e);l=d(\"WASyncdRotateKey\").hasADeviceBeenRemoved(e,f);if(!(!a||!g&&!l)){p.next=14;break}return p.abrupt(\"return\",{keyId:e.keyId,keyData:e.keyData});case 14:p.next=18;break;case 16:if(!(!a||d(\"WABaseGlobals\").getConfig().isCompanion())){p.next=18;break}throw c(\"WAErr\")(\"syncd: No sync key available\");case 18:o=d(\"WASyncdRotateKey\").rotateKey(f,e);d(\"WALogger\").LOG(k(),d(\"WASyncdCryptoUtils\").syncKeyIdToHex(o.keyId));p.next=22;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncKey\").setSyncKeyInTransaction(o));case 22:p.next=24;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().sendSyncdKeyRotation([o]));case 24:g&&(d(\"WALogger\").LOG(j()),d(\"WASyncdMetrics\").reportSyncdKeyRotationEvent(d(\"WASyncdMetrics\").SyncdKeyRotationEventType.APP_STATE_SYNC_KEY_EXPIRY));l&&(d(\"WALogger\").LOG(i()),d(\"WASyncdMetrics\").reportSyncdKeyRotationEvent(d(\"WASyncdMetrics\").SyncdKeyRotationEventType.DEVICE_DEREGISTERATION));e==null&&(d(\"WALogger\").LOG(h()),d(\"WASyncdMetrics\").reportSyncdKeyRotationEvent(d(\"WASyncdMetrics\").SyncdKeyRotationEventType.NO_KEYS));return p.abrupt(\"return\",m(a));case 28:case\"end\":return p.stop()}},null,this)}function n(){var a,c,e,f,g,h,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncKey\").getAllSyncKeysInTransaction());case 2:a=j.sent;if(!(a.length===0)){j.next=5;break}return j.abrupt(\"return\",null);case 5:c=a.map(function(a){return d(\"WASyncdKeyManagementUtils\").getKeyEpoch(a.keyId)});e=Math.max.apply(Math,c);f=a.filter(function(a){return d(\"WASyncdKeyManagementUtils\").getKeyEpoch(a.keyId)===e});g=f.map(function(a){return d(\"WASyncdKeyManagementUtils\").getKeyDeviceId(a.keyId)});h=Math.min.apply(Math,g);i=g.indexOf(h);return j.abrupt(\"return\",f[i]);case 12:case\"end\":return j.stop()}},null,this)}g.getActiveKey=a;g.getNewestKeyPair=n}),98);\n__d(\"WASentinelMutationSync\",[\"Promise\",\"WAGetSyncKey\",\"WALogger\",\"WAServerSync.pb\",\"WASyncdAction\",\"WASyncdActionUtils\",\"WASyncdConst\",\"WASyncdKeyManagement\",\"WATagsLogger\",\"WATimeUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"sentinel mutation sync: no key pairs\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"preparing mutations...\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"sentinel mutation sync: operation not supported\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"sentinel mutation sync: malformed mutation\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"applying mutations...\"]);m=function(){return a};return a}var n=d(\"WATagsLogger\").TAGS([\"syncd\",\"SentinelMutationSync\"]);a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var e=c.prototype;e.getVersion=function(){return 3};e.getAction=function(){return d(\"WASyncdConst\").Actions.Sentinel};e.applyMutations=function(a){n.LOG(m());return(h||(h=b(\"Promise\"))).all(a.map(function(a){var c,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:f.prev=0;if(!(a.operation===\"set\")){f.next=9;break}e=(c=a.value.keyExpiration)==null?void 0:c.expiredKeyEpoch;if(!(e==null)){f.next=6;break}d(\"WALogger\").ERROR(l());return f.abrupt(\"return\",{actionState:d(\"WASyncdConst\").SyncActionState.Malformed});case 6:f.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncKey\").expireSyncKeyInTransaction(e));case 8:return f.abrupt(\"return\",{actionState:d(\"WASyncdConst\").SyncActionState.Success});case 9:d(\"WALogger\").WARN(k());return f.abrupt(\"return\",{actionState:d(\"WASyncdConst\").SyncActionState.Unsupported});case 13:f.prev=13;f.t0=f[\"catch\"](0);return f.abrupt(\"return\",{actionState:d(\"WASyncdConst\").SyncActionState.Failed});case 16:case\"end\":return f.stop()}},null,this,[[0,13]])}))};e.getSentinelMutations=function(){var a=this,c,e,f,g,h;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:n.LOG(j());c=d(\"WATimeUtils\").unixTimeMs();e=Array.from(d(\"WASyncdConst\").CollectionName.members());k.next=5;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdKeyManagement\").getNewestKeyPair());case 5:f=k.sent;if(!(f==null)){k.next=9;break}d(\"WALogger\").ERROR(i());return k.abrupt(\"return\",[]);case 9:g=f.keyEpoch;h={keyExpiration:{expiredKeyEpoch:g}};return k.abrupt(\"return\",e.map(function(b){return d(\"WASyncdActionUtils\").buildPendingMutation({collection:b,indexArgs:[b],operation:d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET,version:a.getVersion(),value:h,timestamp:c,action:a.getAction()})}));case 12:case\"end\":return k.stop()}},null,this)};return c}(d(\"WASyncdAction\").SyncActionBase);c=new a();Object.freeze(c);e=c;g[\"default\"]=e}),98);\n__d(\"WABaseConfigValues\",[\"Promise\",\"WAErr\",\"WASentinelMutationSync\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;a={isCompanion:function(){return!1},logoutInProgress:function(){return!1},mediaImagePreviewHkdfInfo:function(){throw c(\"WAErr\")(\"config: No config for mediaImagePreviewHkdfInfo\")},mediaVideoPreviewHkdfInfo:function(){throw c(\"WAErr\")(\"config: No config for mediaVideoPreviewHkdfInfo\")},offlineProcessingState:function(){return\"idle\"},orchestratorVersion:function(){return\"default\"},primaryPlatform:function(){return void 0},syncdAdditionalMutations:function(){return 1},syncdActionHandlers:function(){return[c(\"WASentinelMutationSync\")]},syncdDisabled:function(){return!0},syncdInlineMutationsMaxCount:function(){return 1e3},syncdKeyMaxUseDays:function(){return 30},syncdMaxMutationsToProcessDuringResume:function(){return 1e3},syncdPatchDeviceIndexIncluded:function(){return!1},syncdPatchProtobufMaxSize:function(){return 100},syncdQPLLoggingEnabled:function(){return!1},syncdShouldFatalOnMissingPatch:function(){return!0},syncdShouldNotFatalOnSnapshotMacMismatchInPatches:function(){return!1},syncdShouldParsePatchDebugData:function(){return!1},syncdWaitForKeyTimeoutDays:function(){return 2},syncShouldCalculateLtHashFromScratch:function(){return!1},maxPrekeysToUpload:function(){return 812},getAreThereMoreCompanions:function(){return(h||(h=b(\"Promise\"))).resolve(!1)},ignoreForceNonPersistedJobList:function(){return[]},orchestratorConfig:function(){return void 0},isUseridAnnotationEnabled:function(){return!1},isEmployee:function(){return!1},useUpdatedSenderKeySession:function(){return!1},useEbRestoreQueue:function(){return!1},useEbUploadQueue:function(){return!1},getSignalFutureMessagesMax:function(){return 2e3}};a;d=a;g[\"default\"]=d}),98);\n__d(\"MAWBaseConfig\",[\"WABaseConfigValues\",\"WAGlobals\",\"WAJobOrchestratorTypes\",\"WAOfflineUtils\",\"WASentinelMutationSync\",\"gkx\",\"justknobx\"],(function(a,b,c,d,e,f,g){\"use strict\";a=babelHelpers[\"extends\"]({},c(\"WABaseConfigValues\"),{isIdleOQM1:function(){return c(\"gkx\")(\"1559\")},ignoreForceNonPersistedJobList:function(){return[\"sendMsg\",\"sendReactionMsg\",\"sendMediaMsg\",\"sendWrittenMsg\",\"linkReactionsToMsgs\",\"downloadAndHandleMedia\"]},isSaveThumbnailAsChunkEnabled:function(){return c(\"gkx\")(\"9641\")},mawBackgroundCop:function(){return c(\"gkx\")(\"316\")},maxPrekeysToUpload:function(){return 200},offlineProcessingState:function(){var a;a=(a=d(\"WAGlobals\").getWaOneQueue())==null?void 0:a.getMode();if(a==null)return\"idle\";switch(a){case d(\"WAOfflineUtils\").ServerRPCMode.OFFLINE_RESUME:return\"processing\";case d(\"WAOfflineUtils\").ServerRPCMode.ONLINE:case d(\"WAOfflineUtils\").ServerRPCMode.INIT:return\"idle\"}},orchestratorConfig:function(){return h()},syncdActionHandlers:function(){return[c(\"WASentinelMutationSync\")]},useEbRestoreQueue:function(){return c(\"gkx\")(\"23935\")},useUpdatedSenderKeySession:function(){return c(\"gkx\")(\"23937\")},waDanglingQueue:function(){return c(\"justknobx\")._(\"1921\")}});a;b=a;function h(){var a={jobPrioritiesQuota:new Map([[d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH,5],[d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW,1]]),maxConcurrency:5,maxConcurrencyPerJob:{}};return a}g[\"default\"]=b}),98);\n__d(\"MAWDeviceInfo\",[\"UserAgentData\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){function a(){}var b=a.prototype;b.get=function(){var a;return{device:[c(\"UserAgentData\").browserName].join(\" \"),hardware:c(\"UserAgentData\").platformName,lc:\"en\",lg:\"en\",manufacturer:c(\"UserAgentData\").platformName,mcc:\"000\",mnc:\"000\",osBuild:(a=c(\"UserAgentData\").platformVersion)!=null?a:\"\",osVersion:(a=c(\"UserAgentData\").platformVersion)!=null?a:\"\",sim_mcc:\"000\",sim_mnc:\"000\"}};return a}();b=new a();g.deviceInfo=b}),98);\n__d(\"WADanglingQueue\",[\"WAErr\",\"WALogger\",\"WAPersistedQueue\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Passive DQ: clear\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Passive DQ: flush\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Passive DQ: write\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Passive DQ: read\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"DanglingQueue is already initialized\"]);l=function(){return a};return a}var m=null;function a(a){if(m!=null){d(\"WALogger\").WARN(l());return m}a=d(\"WAPersistedQueue\").initPersistedQueue(\"danglingQueue\",a);m=a;return m}function n(){if(!m)throw c(\"WAErr\")(\"Dangling queue not initialized\");return m}function b(){return n().read(1).then(function(a){return a.length===0})}function e(){d(\"WALogger\").LOG(k());return n().read()}function f(a){d(\"WALogger\").LOG(j()),void n().write(a)}function o(){d(\"WALogger\").LOG(i());return n().flush()}function p(){d(\"WALogger\").LOG(h());return n().clear()}g.initDanglingQueue=a;g.isDanglingQueueEmpty=b;g.danglingQueueRead=e;g.danglingQueueWrite=f;g.danglingQueueFlush=o;g.danglingQueueClear=p}),98);\n__d(\"WAWa5.pb\",[\"$InternalEnum\",\"WAProtoConst\"],(function(a,b,c,d,e,f,g){c=(a=b(\"$InternalEnum\"))({WHATSAPP:0,MESSENGER:1});e=a({SYSTEM:0,GOOGLE:1,HARDCODED:2,OVERRIDE:3,FALLBACK:4});f=a({CELLULAR_UNKNOWN:0,WIFI_UNKNOWN:1,CELLULAR_EDGE:100,CELLULAR_IDEN:101,CELLULAR_UMTS:102,CELLULAR_EVDO:103,CELLULAR_GPRS:104,CELLULAR_HSDPA:105,CELLULAR_HSUPA:106,CELLULAR_HSPA:107,CELLULAR_CDMA:108,CELLULAR_1XRTT:109,CELLULAR_EHRPD:110,CELLULAR_LTE:111,CELLULAR_HSPAP:112});b=a({PUSH:0,USER_ACTIVATED:1,SCHEDULED:2,ERROR_RECONNECT:3,NETWORK_SWITCH:4,PING_RECONNECT:5,UNKNOWN:6});var h=a({SHARE_EXTENSION:0,SERVICE_EXTENSION:1,INTENTS_EXTENSION:2}),i=a({WEB_BROWSER:0,APP_STORE:1,WIN_STORE:2,DARWIN:3,WIN32:4}),j=a({PHONE:0,TABLET:1,DESKTOP:2,WEARABLE:3,VR:4}),k=a({RELEASE:0,BETA:1,ALPHA:2,DEBUG:3});a=a({ANDROID:0,IOS:1,WINDOWS_PHONE:2,BLACKBERRY:3,BLACKBERRYX:4,S40:5,S60:6,PYTHON_CLIENT:7,TIZEN:8,ENTERPRISE:9,SMB_ANDROID:10,KAIOS:11,SMB_IOS:12,WINDOWS:13,WEB:14,PORTAL:15,GREEN_ANDROID:16,GREEN_IPHONE:17,BLUE_ANDROID:18,BLUE_IPHONE:19,FBLITE_ANDROID:20,MLITE_ANDROID:21,IGLITE_ANDROID:22,PAGE:23,MACOS:24,OCULUS_MSG:25,OCULUS_CALL:26,MILAN:27,CAPI:28,WEAROS:29,ARDEVICE:30,VRDEVICE:31,BLUE_WEB:32,IPAD:33,TEST:34,SMART_GLASSES:35});var l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={};l.internalSpec={clientHello:[2,(d=d(\"WAProtoConst\")).TYPES.MESSAGE,o],serverHello:[3,d.TYPES.MESSAGE,n],clientFinish:[4,d.TYPES.MESSAGE,m]};m.internalSpec={\"static\":[1,d.TYPES.BYTES],payload:[2,d.TYPES.BYTES]};n.internalSpec={ephemeral:[1,d.TYPES.BYTES],\"static\":[2,d.TYPES.BYTES],payload:[3,d.TYPES.BYTES]};o.internalSpec={ephemeral:[1,d.TYPES.BYTES],\"static\":[2,d.TYPES.BYTES],payload:[3,d.TYPES.BYTES]};p.internalSpec={username:[1,d.TYPES.UINT64],passive:[3,d.TYPES.BOOL],userAgent:[5,d.TYPES.MESSAGE,u],webInfo:[6,d.TYPES.MESSAGE,s],pushName:[7,d.TYPES.STRING],sessionId:[9,d.TYPES.SFIXED32],shortConnect:[10,d.TYPES.BOOL],connectType:[12,d.TYPES.ENUM,f],connectReason:[13,d.TYPES.ENUM,b],shards:[14,d.FLAGS.REPEATED|d.TYPES.INT32],dnsSource:[15,d.TYPES.MESSAGE,r],connectAttemptCount:[16,d.TYPES.UINT32],device:[18,d.TYPES.UINT32],devicePairingData:[19,d.TYPES.MESSAGE,q],product:[20,d.TYPES.ENUM,c],fbCat:[21,d.TYPES.BYTES],fbUserAgent:[22,d.TYPES.BYTES],oc:[23,d.TYPES.BOOL],lc:[24,d.TYPES.INT32],iosAppExtension:[30,d.TYPES.ENUM,h],fbAppId:[31,d.TYPES.UINT64],fbDeviceId:[32,d.TYPES.BYTES],pull:[33,d.TYPES.BOOL],paddingBytes:[34,d.TYPES.BYTES],yearClass:[36,d.TYPES.INT32],memClass:[37,d.TYPES.INT32]};q.internalSpec={eRegid:[1,d.TYPES.BYTES],eKeytype:[2,d.TYPES.BYTES],eIdent:[3,d.TYPES.BYTES],eSkeyId:[4,d.TYPES.BYTES],eSkeyVal:[5,d.TYPES.BYTES],eSkeySig:[6,d.TYPES.BYTES],buildHash:[7,d.TYPES.BYTES],deviceProps:[8,d.TYPES.BYTES]};r.internalSpec={dnsMethod:[15,d.TYPES.ENUM,e],appCached:[16,d.TYPES.BOOL]};s.internalSpec={refToken:[1,d.TYPES.STRING],version:[2,d.TYPES.STRING],webdPayload:[3,d.TYPES.MESSAGE,t],webSubPlatform:[4,d.TYPES.ENUM,i]};t.internalSpec={usesParticipantInKey:[1,d.TYPES.BOOL],supportsStarredMessages:[2,d.TYPES.BOOL],supportsDocumentMessages:[3,d.TYPES.BOOL],supportsUrlMessages:[4,d.TYPES.BOOL],supportsMediaRetry:[5,d.TYPES.BOOL],supportsE2EImage:[6,d.TYPES.BOOL],supportsE2EVideo:[7,d.TYPES.BOOL],supportsE2EAudio:[8,d.TYPES.BOOL],supportsE2EDocument:[9,d.TYPES.BOOL],documentTypes:[10,d.TYPES.STRING],features:[11,d.TYPES.BYTES]};u.internalSpec={platform:[1,d.TYPES.ENUM,a],appVersion:[2,d.TYPES.MESSAGE,v],mcc:[3,d.TYPES.STRING],mnc:[4,d.TYPES.STRING],osVersion:[5,d.TYPES.STRING],manufacturer:[6,d.TYPES.STRING],device:[7,d.TYPES.STRING],osBuildNumber:[8,d.TYPES.STRING],phoneId:[9,d.TYPES.STRING],releaseChannel:[10,d.TYPES.ENUM,k],localeLanguageIso6391:[11,d.TYPES.STRING],localeCountryIso31661Alpha2:[12,d.TYPES.STRING],deviceBoard:[13,d.TYPES.STRING],deviceExpId:[14,d.TYPES.STRING],deviceType:[15,d.TYPES.ENUM,j]};v.internalSpec={primary:[1,d.TYPES.UINT32],secondary:[2,d.TYPES.UINT32],tertiary:[3,d.TYPES.UINT32],quaternary:[4,d.TYPES.UINT32],quinary:[5,d.TYPES.UINT32]};g.ClientPayload$Product=c;g.ClientPayload$DNSSource$DNSResolutionMethod=e;g.ClientPayload$ConnectType=f;g.ClientPayload$ConnectReason=b;g.ClientPayload$IOSAppExtension=h;g.ClientPayload$WebInfo$WebSubPlatform=i;g.ClientPayload$UserAgent$DeviceType=j;g.ClientPayload$UserAgent$ReleaseChannel=k;g.ClientPayload$UserAgent$Platform=a;g.HandshakeMessageSpec=l;g.HandshakeMessage$ClientFinishSpec=m;g.HandshakeMessage$ServerHelloSpec=n;g.HandshakeMessage$ClientHelloSpec=o;g.ClientPayloadSpec=p;g.ClientPayload$DevicePairingRegistrationDataSpec=q;g.ClientPayload$DNSSourceSpec=r;g.ClientPayload$WebInfoSpec=s;g.ClientPayload$WebInfo$WebdPayloadSpec=t;g.ClientPayload$UserAgentSpec=u;g.ClientPayload$UserAgent$AppVersionSpec=v}),98);\n__d(\"MAWClientPayload\",[\"CurrentMessengerUser\",\"MAWAppVersion\",\"MAWDeviceInfo\",\"MAWGlobals\",\"MqttWebDeviceID\",\"WAArrayBufferUtils\",\"WADanglingQueue\",\"WAGlobals\",\"WAJids\",\"WALogger\",\"WALongInt\",\"WAWa5.pb\",\"asyncToGeneratorRuntime\",\"encodeProtobuf\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Passive mode is not active\"]);h=function(){return a};return a}function a(){return i.apply(this,arguments)}function i(){i=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=d(\"MAWGlobals\").getMyDeviceJid();a=d(\"WAJids\").extractDeviceIDParts(a);var b=a.deviceID;a=a.userId;b=babelHelpers[\"extends\"]({},yield l(),n(),{device:b,fbCat:d(\"MAWGlobals\").getFbCat(),fbUserAgent:d(\"WAArrayBufferUtils\").stringToArrayBuffer(navigator.userAgent),product:d(\"WAWa5.pb\").ClientPayload$Product.MESSENGER,username:d(\"WALongInt\").decimalStringToLongInt(a)});return d(\"encodeProtobuf\").encodeProtobuf(d(\"WAWa5.pb\").ClientPayloadSpec,b).readByteArray()});return i.apply(this,arguments)}function j(){return k.apply(this,arguments)}function k(){k=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){if(!d(\"WAGlobals\").getConfig().waDanglingQueue()){d(\"WALogger\").LOG(h());return!1}var a=d(\"WAGlobals\").getWaOneQueue();if(a&&!a.isPendingAcksEmpty())return!0;a=(yield d(\"WADanglingQueue\").isDanglingQueueEmpty());return!a});return k.apply(this,arguments)}function l(){return m.apply(this,arguments)}function m(){m=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){return{connectReason:d(\"WAWa5.pb\").ClientPayload$ConnectReason.USER_ACTIVATED,connectType:d(\"WAWa5.pb\").ClientPayload$ConnectType.WIFI_UNKNOWN,passive:yield j(),pull:!0,userAgent:o()}});return m.apply(this,arguments)}function n(){if(!c(\"gkx\")(\"8923\"))return{};var a=d(\"CurrentMessengerUser\").getAppID(),b=c(\"MqttWebDeviceID\").clientID;return a==null?{fbDeviceId:d(\"WAArrayBufferUtils\").stringToArrayBuffer(b)}:{fbAppId:d(\"WALongInt\").decimalStringToLongInt(a),fbDeviceId:d(\"WAArrayBufferUtils\").stringToArrayBuffer(b)}}function o(){var a=d(\"MAWDeviceInfo\").deviceInfo.get(),b=d(\"MAWAppVersion\").getAppVersionParts();return{appVersion:b,device:a.device,localeCountryIso31661Alpha2:a.lc,localeLanguageIso6391:a.lg,manufacturer:a.manufacturer,mcc:a.mcc,mnc:a.mnc,osBuildNumber:a.osBuild,osVersion:a.osVersion,platform:c(\"gkx\")(\"23941\")?d(\"WAWa5.pb\").ClientPayload$UserAgent$Platform.WEB:d(\"WAWa5.pb\").ClientPayload$UserAgent$Platform.BLUE_WEB,releaseChannel:d(\"WAWa5.pb\").ClientPayload$UserAgent$ReleaseChannel.DEBUG}}g.getClientPayload=a}),98);\n__d(\"WACryptoCurve25519\",[\"Promise\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Curve25519.generateSharedSecret pubkey:\",\"\"]);i=function(){return a};return a}a=function(){function a(a,c){this.signalDependencies=a,this.keyPair=c?(h||(h=b(\"Promise\"))).resolve(c):this.signalDependencies.generateIdentityKeyPair()}var c=a.prototype;c.generatePublicKey=function(){return this.keyPair.then(function(a){return a.publicKey})};c.generateSharedSecret=function(a){var b=this;return this.keyPair.then(function(c){c=c.privateKey;d(\"WALogger\").LOG(i(),a).devConsole(c);return b.signalDependencies.calculateAgreement(new Uint8Array(a),c)})};return a}();g.Curve25519=a}),98);\n__d(\"WAGetInitialChatSocketDetails\",[\"WAGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){return d(\"WAGlobals\").getDbImpls().getMeta().then(function(a){var b=a.edgeInfo;a=a.certificateChain;return{edgeInfo:b,certificateChain:a}})};g.getInitialChatSocketDetails=a}),98);\n__d(\"WAGetRoutingInfoApi\",[\"WAGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){return d(\"WAGlobals\").getDbImpls().getMeta().then(function(a){return{edgeInfo:(a=a.edgeInfo)!=null?a:null}})};g.getRoutingInfo=a}),98);\n__d(\"WASetCertificateChain\",[\"WAGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){return d(\"WAGlobals\").getDbImpls().setMeta({certificateChain:a})};g.setCertificateChain=a}),98);\n__d(\"WAConnectivityReports\",[\"WALogger\",\"WAPREList\",\"WAPREMetrics\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[Connectivity]: \",\". Reason: \",\", clean: \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[Connectivity]: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[Connectivity]: \",\"\"]);j=function(){return a};return a}function a(a,b){d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.WA_DISCONNECT).endSuccess({string:{key:\"code\"+b.code}});a=a!=null?\"WebSocket \"+a+\" closed. code: \"+b.code:\"WebSocket closed connection during initialization. Code: \"+b.code;switch(b.code){case 1e3:case 1001:case 1006:d(\"WALogger\").LOG(j(),a);break;case 1002:case 1003:case 1007:case 1008:case 1009:case 1010:case 1011:case 1015:d(\"WALogger\").ERROR(i(),a);break;default:d(\"WALogger\").ERROR(h(),a,b.reason,b.wasClean);break}}g.onWebSocketCloseEvent=a}),98);\n__d(\"WASocketTransport\",[\"Promise\",\"WABinary\",\"WAConnectivityReports\",\"WAErr\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"WebSocket #\",\" not opened\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"WebSocket #\",\" errored: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"WebSocket #\",\" dropped \",\" bytes\"]);k=function(){return a};return a}var l=1,m=function(){function a(a){var b=this;this.$2=!1;this.onData=null;this.onClose=null;this.onError=null;this.dataToSend=new(d(\"WABinary\").Binary)();this.$3=function(a){if(b.$2)return;a=new Uint8Array(a.data);b.onData?b.onData(a):d(\"WALogger\").ERROR(k(),b.id,a.length)};this.$4=function(a){d(\"WAConnectivityReports\").onWebSocketCloseEvent(b.id,a);if(b.$2)return;b.$6()};this.$5=function(a){d(\"WALogger\").DEV(j(),b.id,a);if(b.$2)return;var c=b.onError;c&&c(String(a))};var c=l++;this.id=c;this.$1=a;a.onmessage=this.$3;a.onclose=this.$4;a.onerror=this.$5}var b=a.prototype;b.close=function(){if(this.$2)return;this.$1.close();this.$6()};b.requestSend=function(){if(this.$2){d(\"WALogger\").ERROR(i(),this.id);return}if(!this.dataToSend.size())return;this.$1.send(this.dataToSend.readBuffer())};b.$6=function(){this.$2=!0,this.onClose&&this.onClose()};return a}();function a(a){var e=new WebSocket(a);e.binaryType=\"arraybuffer\";return new(h||(h=b(\"Promise\")))(function(a,b){e.onopen=a,e.onclose=function(a){d(\"WAConnectivityReports\").onWebSocketCloseEvent(null,a),b(c(\"WAErr\")(\"WebSocket closed immediately: \"+a.reason+\" \"+a.code))}}).then(function(){return new m(e)})}g.openWebSocket=a}),98);\n__d(\"WATreasureHunt\",[\"Promise\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=new(h||(h=b(\"Promise\")))(function(){});function a(a,c,e,f){var g=0,j=0,k=!1,l=null,m=null;function n(a){if(!k){k=!0;l!=null&&(clearTimeout(l),l=null);return d(\"WAResultOrError\").makeResult(a)}else{f==null?void 0:f(a);return i}}function o(){if(k)return i;j++;if(j===c)return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeError(\"max-hunters\"));var a=m;a!=null&&j===g&&(l!=null&&(clearTimeout(l),l=null),a());return i}function p(){var d=g++;d=a(d).then(n,o);if(g<c){var f=new(h||(h=b(\"Promise\")))(function(a){l=setTimeout(a,e),m=a}).then(p);return h.race([d,f])}else return d}return p()}g.treasureHunt=a}),98);\n__d(\"WACert.pb\",[\"WAProtoConst\"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};a.internalSpec={details:[1,(d=d(\"WAProtoConst\")).TYPES.BYTES],signature:[2,d.TYPES.BYTES]};b.internalSpec={serial:[1,d.TYPES.UINT32],issuer:[2,d.TYPES.STRING],expires:[3,d.TYPES.UINT64],subject:[4,d.TYPES.STRING],key:[5,d.TYPES.BYTES]};c.internalSpec={leaf:[1,d.TYPES.MESSAGE,e],intermediate:[2,d.TYPES.MESSAGE,e]};e.internalSpec={details:[1,d.TYPES.BYTES],signature:[2,d.TYPES.BYTES]};f.internalSpec={serial:[1,d.TYPES.UINT32],issuerSerial:[2,d.TYPES.UINT32],key:[3,d.TYPES.BYTES],notBefore:[4,d.TYPES.UINT64],notAfter:[5,d.TYPES.UINT64]};g.NoiseCertificateSpec=a;g.NoiseCertificate$DetailsSpec=b;g.CertChainSpec=c;g.CertChain$NoiseCertificateSpec=e;g.CertChain$NoiseCertificate$DetailsSpec=f}),98);\n__d(\"WAVerifyChainCertificateWA6\",[\"WACert.pb\",\"WACryptoUtils\",\"WAHex\",\"WALogger\",\"WAResultOrError\",\"WASignalKeys\",\"WASignalOther\",\"WASignalSignatures\",\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing \"key\"']);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing \"serial\"']);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing \"issuer_serial\"']);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing \"signature\"']);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing \"details\"']);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"verifyChainCertificateWA6 leafCert.key does not match handshake server.hello.static\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"verifyChainCertificateWA6: leaf certificate is poorly signed\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"verifyChainCertificateWA6 leaf certificate was not issued by RootCA\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"verifyChainCertificateWA6: invalid leaf certificate\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"verifying leaf certificate\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"verifyChainCertificateWA6: intermediate certificate is poorly signed\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"verifyChainCertificateWA6 intermediate certificate was not issued by RootCA\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"verifyChainCertificateWA6: invalid intermediate certificate\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"verifying intermediate certificate\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"verifyChainCertificateWA6: missing leaf and\/or intermediate certificate\"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose([\"verifyChainCertificateWA6: extract leaf and intermediate certificate\"]);w=function(){return a};return a}b=\"142375574d0a587166aae71ebe516437c4a28b73e3695c6ce1f7f9545da8ee6b\";var x={SERIAL:0,ISSUER:\"WhatsAppLongTerm1\",PUBLIC_KEY:d(\"WASignalKeys\").serializeIdentity(new Uint8Array(d(\"WAHex\").parseHex(b)))};function a(a,b){d(\"WALogger\").LOG(w());a=d(\"decodeProtobuf\").decodeProtobuf(d(\"WACert.pb\").CertChainSpec,a);var c=a.intermediate;a=a.leaf;if(c==null||a==null){d(\"WALogger\").ERROR(v());return d(\"WAResultOrError\").makeError(\"missing-certificate\")}d(\"WALogger\").LOG(u());c=y(c);if(!c.success){d(\"WALogger\").ERROR(t());return d(\"WAResultOrError\").makeError(\"invalid-certificate\")}if(c.value.issuerSerial!==x.SERIAL){d(\"WALogger\").ERROR(s());return d(\"WAResultOrError\").makeError(\"invalid-certificate\")}if(!z(c.value,x.PUBLIC_KEY)){d(\"WALogger\").ERROR(r());return d(\"WAResultOrError\").makeError(\"invalid-certificate\")}d(\"WALogger\").LOG(q());a=y(a);if(!a.success){d(\"WALogger\").ERROR(p());return d(\"WAResultOrError\").makeError(\"invalid-certificate\")}if(a.value.issuerSerial!==c.value.serial){d(\"WALogger\").ERROR(o());return d(\"WAResultOrError\").makeError(\"invalid-certificate\")}var e=d(\"WASignalKeys\").serializeIdentity(new Uint8Array(c.value.key));if(!z(a.value,e)){d(\"WALogger\").ERROR(n());return d(\"WAResultOrError\").makeError(\"invalid-certificate\")}if(!d(\"WACryptoUtils\").arrayBuffersEqual(a.value.key,b)){d(\"WALogger\").ERROR(m());return d(\"WAResultOrError\").makeError(\"invalid-certificate\")}return d(\"WAResultOrError\").makeResult({leaf:a.value,intermediate:c.value})}function y(a){var b=a.details;a=a.signature;if(!b){d(\"WALogger\").ERROR(l());return d(\"WAResultOrError\").makeError(\"invalid-certificate\")}if(!a){d(\"WALogger\").ERROR(k());return d(\"WAResultOrError\").makeError(\"invalid-certificate\")}var c=d(\"decodeProtobuf\").decodeProtobuf(d(\"WACert.pb\").CertChain$NoiseCertificate$DetailsSpec,b),e=c.issuerSerial,f=c.serial,g=c.key,m=c.notAfter;c=c.notBefore;if(e==null){d(\"WALogger\").ERROR(j());return d(\"WAResultOrError\").makeError(\"invalid-certificate\")}if(f==null){d(\"WALogger\").ERROR(i());return d(\"WAResultOrError\").makeError(\"invalid-certificate\")}if(g==null){d(\"WALogger\").ERROR(h());return d(\"WAResultOrError\").makeError(\"invalid-certificate\")}a=d(\"WASignalOther\").ensureSize(new Uint8Array(a),64);return d(\"WAResultOrError\").makeResult({serial:f,issuerSerial:e,key:g,notBefore:c,notAfter:m,details:b,signature:a})}function z(a,b){return d(\"WASignalSignatures\").verifyMsgSignalVariant(b,new Uint8Array(a.details),a.signature)}g.ROOT_CA=x;g.verifyChainCertificateWA6=a;g.parseCertificateWA6=y}),98);\n__d(\"MAWChatSocketPlatformDetails\",[\"FBLogger\",\"MAWClientPayload\",\"MAWQplProxy\",\"Promise\",\"URI\",\"WABase64\",\"WACryptoCurve25519\",\"WACryptoCurve25519Dependencies\",\"WAErrors\",\"WAGetInitialChatSocketDetails\",\"WAGetRoutingInfoApi\",\"WAHex\",\"WALogger\",\"WASetCertificateChain\",\"WASocketTransport\",\"WATreasureHunt\",\"WAVerifyChainCertificateWA6\",\"WAWa5.pb\",\"WAWapDict\",\"asyncToGeneratorRuntime\",\"decodeProtobuf\",\"encodeProtobuf\",\"err\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"openSocketWithLoop (round \",\") failed: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"openSocketWithLoop (round \",\") to \",\" succeeded\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"openSocketWithLoop (round \",\") connecting to \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"openSocketWithLoop\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"processCertificate start\"]);n=function(){return a};return a}var o=\"wss:\/\/web-chat-e2ee.facebook.com\/ws\/chat\",p=c(\"qpl\")._(1056839232,\"112\");function q(a){return d(\"encodeProtobuf\").encodeProtobuf(d(\"WAWa5.pb\").HandshakeMessageSpec,{clientHello:a}).readByteArray()}function r(a){return d(\"encodeProtobuf\").encodeProtobuf(d(\"WAWa5.pb\").HandshakeMessageSpec,{clientFinish:a}).readByteArray()}function s(a){return d(\"decodeProtobuf\").decodeProtobuf(d(\"WAWa5.pb\").HandshakeMessageSpec,a).serverHello}function t(a){var e=a.certificate;a=a.serverStatic;d(\"WALogger\").LOG(n());e=d(\"WAVerifyChainCertificateWA6\").verifyChainCertificateWA6(e,a);if(!e.success)throw c(\"err\")(\"processCertificate error: \"+e.error);a=e.value;e=a.intermediate;a=a.leaf;a&&e&&d(\"WASetCertificateChain\").setCertificateChain({intermediate:{key:e.key,notAfter:Number(e.notAfter),notBefore:Number(e.notBefore)},leaf:{key:a.key,notAfter:Number(a.notAfter),notBefore:Number(a.notBefore)}})[\"catch\"](function(a){c(\"FBLogger\")(\"messenger_e2ee_web\").catching(a).warn(\"Error storing certificate chain\")});return(i||(i=b(\"Promise\"))).resolve()}function u(a){a=(a=a)!=null?a:{};var b=a.intermediate,c=a.leaf;return function(){if(c&&b){d(\"MAWQplProxy\").sendQPLStringAnnotationThroughBridge(p,\"expectedHandshakeType\",\"resume\");return c.key}d(\"MAWQplProxy\").sendQPLStringAnnotationThroughBridge(p,\"expectedHandshakeType\",\"full\");return null}}function v(){d(\"WALogger\").DEV(m());function a(a){var e=new(h||(h=c(\"URI\")))(o).toString(),f=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=(yield d(\"WAGetRoutingInfoApi\").getRoutingInfo());a=a.edgeInfo;var b=void 0;a&&(b=\"?ED=\"+d(\"WABase64\").encodeB64UrlSafe(a));a=\"\"+e+(b!=null?b:\"\");return d(\"WASocketTransport\").openWebSocket(a)});return function(){return a.apply(this,arguments)}}();d(\"WALogger\").LOG(l(),a,e);return f().then(function(b){d(\"WALogger\").LOG(k(),a,e);return b})[\"catch\"](function(b){d(\"WALogger\").WARN(j(),a,b).devConsole(b);throw b})}return d(\"WATreasureHunt\").treasureHunt(a,3,15e3,function(a){return void a.close()})[\"catch\"](function(a){if(!navigator.onLine)throw new(d(\"WAErrors\").Offline)(\"offline when openSocketWithLoop treasureHunt failed\");throw a})}function a(a){return w.apply(this,arguments)}function w(){w=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b=(yield d(\"WAGetInitialChatSocketDetails\").getInitialChatSocketDetails()),c=b.edgeInfo==null?null:d(\"WAHex\").bytesToBuffer(b.edgeInfo),e=new Uint8Array([87,65,6,d(\"WAWapDict\").DICT_VERSION]);return{curveSignalDependencies:d(\"WACryptoCurve25519Dependencies\").CURVE25519_SIGNAL_DEPENDENCIES,decodeServerHello:s,edgeInfo:c,encodeHandshakeFinish:r,encodeHandshakeHello:q,getClientPayload:d(\"MAWClientPayload\").getClientPayload,openSocket:v,processCertificate:t,protoHeader:e,serverStaticKeyIfKnown:u(b.certificateChain),staticKeyPair:new(d(\"WACryptoCurve25519\").Curve25519)(d(\"WACryptoCurve25519Dependencies\").CURVE25519_SIGNAL_DEPENDENCIES,a)}});return w.apply(this,arguments)}g.getChatSocketPlatformDetails=a}),98);\n__d(\"WADevToolsStanzaViewer\",[\"WADevToolsBridge\",\"WASmaxParseUtils\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){var c=d(\"WASmaxParseUtils\").attrInt(a,\"t\");c=c.success?d(\"WATimeUtils\").castToUnixTime(c.value):d(\"WATimeUtils\").unixTime();d(\"WADevToolsBridge\").getDevToolBridge().fireAndForget(\"devtool\",\"newStanza\",{ts:c,type:a.tag,isOutgoing:b,stanza:a.toString()},!0)}g.sendNewStanzaToDevTool=a}),98);\n__d(\"WAFrameSocket\",[\"WABinary\",\"WAErrors\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"FrameSocket: queueing partial frame of \",\" bytes\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Buffer to send: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"FrameSocket closed\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"FrameSocket error\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"FrameSocket closed, waiting for pending processing\"]);l=function(){return a};return a}var m=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c=\"SocketClosed\";a=b.call(this,(a=a)!=null?a:c)||this;a.name=c;return a}return a}(babelHelpers.wrapNativeSuper(Error));a=function(){function a(a,b){var c=this;this.$3=new(d(\"WABinary\").Binary)();this.closed=!1;this.$4=!1;this.onFrame=null;this.onClose=null;this.$5=function(a){c.$3.writeByteArray(a),c.convertBufferedToFrames()};this.$6=function(){if(c.$3.peek(n)){d(\"WALogger\").LOG(l());c.$4=!0;return}c.$9()};this.$7=function(a){d(\"WALogger\").DEV(k()).devConsole(a)};this.$2=b;this.$1=a;a.onData=this.$5;a.onClose=this.$6;a.onError=this.$7}var b=a.prototype;b.sendFrame=function(a){if(this.$4)return;this.throwIfClosed();var b=this.$2,c=a.byteLength,d=this.$1.dataToSend;b?(this.$2=null,d.ensureAdditionalCapacity(b.length+3+c),d.writeByteArray(b)):d.ensureAdditionalCapacity(3+c);this.$8(c);d.writeUint8(c>>16);d.writeUint16(c&65535);d.write(a);this.$1.requestSend()};b.$9=function(){if(this.closed)return;d(\"WALogger\").LOG(j());this.$4=!1;this.closed=!0;var a=this.onClose;a&&a()};b.$8=function(a){if(a>=1<<24){d(\"WALogger\").WARN(i(),a);throw new(d(\"WAErrors\").BufferTooLargeError)(\"Buffer too large: \"+a)}};b.convertBufferedToFrames=function(){var a=this.$3,b=this.onFrame;while(b&&a.peek(n)){var c=o(a);c=a.readByteArray(c);b(c);b=this.onFrame}this.$4&&!a.peek(n)&&this.$9();b&&a.size()&&d(\"WALogger\").LOG(h(),a.size())};b.throwIfClosed=function(){if(this.closed)throw new m()};b.close=function(){this.$1.close()};return a}();function n(a){if(a.size()<3)return!1;var b=o(a);return b<=a.size()}function o(a){return a.readUint8()<<16|a.readUint16()}g.SocketClosed=m;g.FrameSocket=a}),98);\n__d(\"WANoiseSocket\",[\"Promise\",\"WACryptoDependencies\",\"WALogger\",\"WAPromiseQueue\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"sendFrame adding to queue with frame size: \",\" bytes\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"NoiseSocket socket closed while encrypting frame\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Sending encrypted frame to web socket\"]);k=function(){return a};return a}a=(h||(h=b(\"Promise\"))).reject(\"UNINITIALIZED HANDSHAKE\");var l=new Uint8Array(0);a[\"catch\"](function(){});c=function(){function a(a,b,c){var e=this;this.$4=[];this.$5=new(d(\"WAPromiseQueue\").PromiseQueue)();this.$6=new(d(\"WAPromiseQueue\").PromiseQueue)();this.$7=0;this.$8=0;this.$9=!1;this.$14=function(a){!e.$1.closed?(d(\"WALogger\").DEV(k()).tags(\"WANoiseSocket\"),e.$1.sendFrame(a)):d(\"WALogger\").LOG(j())};this.$12=function(a){var b=e.$7++;e.$5.enqueueHandlers(o(e.$2,b,void 0,a),e.$15)};this.$13=function(){e.$9=!0,e.$5.wait().then(function(){e.$9=!1;var a=e.$11;a&&a()})};this.$15=function(a){e.$10?e.$10(a):e.$4.push(a)};this.$1=a;this.$3=b;this.$2=c;a.onFrame=this.$12;this.$1.onClose=this.$13;a.convertBufferedToFrames()}var c=a.prototype;c.sendFrameAsync=function(a){var c;return b(\"regeneratorRuntime\").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b(\"regeneratorRuntime\").awrap(this.sendFrame(a));case 2:c=d.sent;return d.abrupt(\"return\",c);case 4:case\"end\":return d.stop()}},null,this)};c.sendFrame=function(a){if(this.$9)return(h||(h=b(\"Promise\"))).resolve();this.$1.throwIfClosed();var c=this.$8++;d(\"WALogger\").DEV(i(),a.length).tags(\"WANoiseSocket\");return this.$6.enqueueHandlers(n(this.$3,c,void 0,a),this.$14)};c.setOnFrame=function(a){this.$10=a};c.setOnClose=function(a){this.$11=a};c.close=function(){this.$1.close()};return a}();function m(a){var b=new ArrayBuffer(12),c=new DataView(b);c.setUint32(8,a);return new Uint8Array(b)}function n(a,b,c,e){return d(\"WACryptoDependencies\").getCrypto().subtle.encrypt({name:\"AES-GCM\",iv:m(b),additionalData:c?new Uint8Array(c):l},a,e)}function o(a,b,c,e){return d(\"WACryptoDependencies\").getCrypto().subtle.decrypt({name:\"AES-GCM\",iv:m(b),additionalData:c?new Uint8Array(c):l},a,e)}g.NoiseSocket=c}),98);\n__d(\"WANoiseHandshake\",[\"Promise\",\"WABinary\",\"WACryptoDependencies\",\"WACryptoHkdf\",\"WACryptoSha256\",\"WAErrors\",\"WANoiseSocket\",\"WAResolvable\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=(h||(h=b(\"Promise\"))).reject(\"UNINITIALIZED HANDSHAKE\"),j=new Uint8Array(0);i[\"catch\"](function(){});a=function(){function a(a){var b=this;this.$2=i;this.$3=i;this.$4=i;this.$5=0;this.$1=a;this.$6=new(d(\"WAResolvable\").Resolvable)();a.onClose=function(){b.$6.reject(new(d(\"WAErrors\").Disconnected)(\"NoiseHandshake: SocketClosed\"))};p(this.$6.promise)}var c=a.prototype;c.start=function(a,c){a=d(\"WABinary\").Binary.build(a).readBuffer();a=a.byteLength===32?(h||(h=b(\"Promise\"))).resolve(a):d(\"WACryptoSha256\").sha256(a);this.$2=a;this.$3=a;this.$4=a.then(l);this.authenticate(c)};c.sendAndReceive=function(a){var c=this.$1,d=new(h||(h=b(\"Promise\")))(function(b){c.onFrame=function(a){c.onFrame=null,b(a)},c.sendFrame(a)});return this.$7(d)};c.send=function(a){this.$1.sendFrame(a)};c.authenticate=function(a){this.$2=(h||(h=b(\"Promise\"))).all([this.$2,a]).then(function(a){var b=a[0];a=a[1];b=d(\"WABinary\").Binary.build(b,a).readByteArray();return d(\"WACryptoSha256\").sha256(b)})};c.encrypt=function(a){var c=this.$5++;a=(h||(h=b(\"Promise\"))).all([this.$4,this.$2,a]).then(function(a){var b=a[0],d=a[1];a=a[2];return m(b,c,d,a)});this.authenticate(a);return this.$7(a)};c.decrypt=function(a){var c=this.$5++,d=(h||(h=b(\"Promise\"))).all([this.$4,this.$2]).then(function(b){var d=b[0];b=b[1];return n(d,c,b,a)});this.authenticate(a);return this.$7(d)};c.finish=function(){var a=this,c=this.$3.then(function(a){return o(a,new Uint8Array(0))}).then(function(a){var c=a[0];a=a[1];return(h||(h=b(\"Promise\"))).all([l(c,[\"encrypt\"]),l(a,[\"decrypt\"])])}).then(function(b){var c=b[0];b=b[1];return new(d(\"WANoiseSocket\").NoiseSocket)(a.$1,c,b)});return this.$7(c)};c.mixIntoKey=function(a){this.$5=0;a=(h||(h=b(\"Promise\"))).all([this.$3,a]).then(function(a){var b=a[0];a=a[1];return o(b,new Uint8Array(a))});this.$3=a.then(function(a){return a[0]});this.$4=a.then(function(a){return l(a[1])});p(this.$3);p(this.$4)};c.$7=function(a){var c=this;return(h||(h=b(\"Promise\"))).race([a,this.$6.promise]).then(function(a){return c.$6.resolveWasCalled()?c.$6.promise:a})};return a}();function k(a){var b=new ArrayBuffer(12),c=new DataView(b);c.setUint32(8,a);return new Uint8Array(b)}function l(a,b){b===void 0&&(b=[\"encrypt\",\"decrypt\"]);return d(\"WACryptoDependencies\").getCrypto().subtle.importKey(\"raw\",new Uint8Array(a),\"AES-GCM\",!1,b)}function m(a,b,c,e){return d(\"WACryptoDependencies\").getCrypto().subtle.encrypt({name:\"AES-GCM\",iv:k(b),additionalData:c?new Uint8Array(c):j},a,e)}function n(a,b,c,e){return d(\"WACryptoDependencies\").getCrypto().subtle.decrypt({name:\"AES-GCM\",iv:k(b),additionalData:c?new Uint8Array(c):j},a,e)}function o(a,b){return d(\"WACryptoHkdf\").extractWithSaltAndExpand(b,new Uint8Array(a),\"\",64).then(function(a){return[a.slice(0,32),a.slice(32)]})}function p(a){a[\"catch\"](function(){})}g.NoiseHandshake=a}),98);\n__d(\"WAOpenChatSocket\",[\"Promise\",\"WABinary\",\"WACryptoCurve25519\",\"WAErr\",\"WAFrameSocket\",\"WALogger\",\"WANoiseHandshake\",\"WAResultOrError\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"openChatSocket performing full handshake\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"openChatSocket performing resume handshake\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"openChatSocket preIntro \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"doFallbackHandshake continuing handshake with given server hello\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"resumeNoiseHandshake performing fallback handshake\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"resumeNoiseHandshake deriving secrets\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"resumeNoiseHandshake continuing resume handshake\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"resumeNoiseHandshake rcv hello\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"resumeNoiseHandshake send hello\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"fullNoiseHandshake rcv hello\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"fullNoiseHandshake send hello\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"doFullHandshakeCore client finish and deriving secrets\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"doFullHandshakeCore parsing and verifying server certificate\"]);u=function(){return a};return a}var v=\"Noise_XX_25519_AESGCM_SHA256\\0\\0\\0\\0\",w=\"Noise_IK_25519_AESGCM_SHA256\\0\\0\\0\\0\",x=\"Noise_XXfallback_25519_AESGCM_SHA256\";function y(a,e,f,g,i){e=e||{};var j=e.ephemeral,k=e[\"static\"];e=e.payload;if(j==null||k==null||e==null)return(h||(h=b(\"Promise\"))).reject(c(\"WAErr\")(\"doFullHandshakeCore server hello invalid proto\"));a.authenticate(j);a.mixIntoKey(g.generateSharedSecret(j));k=a.decrypt(k);a.mixIntoKey(k.then(function(a){return g.generateSharedSecret(a)}));e=a.decrypt(e);return(h||(h=b(\"Promise\"))).all([k,e]).then(function(a){var b=a[0];a=a[1];d(\"WALogger\").LOG(u());return i.processCertificate({certificate:a,serverStatic:b})}).then(function(){var c=a.encrypt(i.staticKeyPair.generatePublicKey());a.mixIntoKey(i.staticKeyPair.generateSharedSecret(j));var d=a.encrypt((h||(h=b(\"Promise\"))).resolve(f));return h.all([c,d])}).then(function(b){var c=b[0];b=b[1];d(\"WALogger\").LOG(t());a.send(i.encodeHandshakeFinish({\"static\":c,payload:b}));return a.finish()})}function z(a,b,c,e){var f=new(d(\"WANoiseHandshake\").NoiseHandshake)(a);f.start(v,e.protoHeader);a=c.generatePublicKey();f.authenticate(a);return a.then(function(a){d(\"WALogger\").LOG(s());return f.sendAndReceive(e.encodeHandshakeHello({ephemeral:a}))}).then(function(a){d(\"WALogger\").LOG(r());a=e.decodeServerHello(a);return y(f,a,b,c,e)})}function A(a,e,f,g,i){var j=new(d(\"WANoiseHandshake\").NoiseHandshake)(a);j.start(w,i.protoHeader);var k=g.generatePublicKey();j.authenticate(f);j.authenticate(k);j.mixIntoKey(g.generateSharedSecret(f));var l=j.encrypt(i.staticKeyPair.generatePublicKey());j.mixIntoKey(i.staticKeyPair.generateSharedSecret(f));f=j.encrypt((h||(h=b(\"Promise\"))).resolve(e));return h.all([k,f,l]).then(function(b){var a=b[0],c=b[1];b=b[2];d(\"WALogger\").LOG(q());return j.sendAndReceive(i.encodeHandshakeHello({ephemeral:a,payload:c,\"static\":b}))}).then(function(b){d(\"WALogger\").LOG(p());b=i.decodeServerHello(b);var f=b||{},h=f.ephemeral,k=f[\"static\"];f=f.payload;if(k==null){d(\"WALogger\").LOG(o());if(!h)throw c(\"WAErr\")(\"serverHello missing serverEphemeral\");if(!f)throw c(\"WAErr\")(\"serverHello missing certificateCiphertext\");j.authenticate(h);j.mixIntoKey(g.generateSharedSecret(h));j.mixIntoKey(i.staticKeyPair.generateSharedSecret(h));return j.decrypt(f).then(function(){d(\"WALogger\").LOG(n());return j.finish()})}else{d(\"WALogger\").LOG(m());return B(a,b,e,g,i)}})}function B(a,b,c,e,f){a=new(d(\"WANoiseHandshake\").NoiseHandshake)(a);a.start(x,f.protoHeader);var g=e.generatePublicKey();a.authenticate(g);d(\"WALogger\").LOG(l());return y(a,b,c,e,f)}function a(a,c,e){return a.openSocket(e).then(d(\"WAResultOrError\").onResult(function(e){var f,g,l,m,n,o,p,q,r,s;return b(\"regeneratorRuntime\").async(function(t){while(1)switch(t.prev=t.next){case 0:(h||(h=b(\"Promise\"))).resolve().then(c);f=void 0;g=a.edgeInfo;g&&(l=new(d(\"WABinary\").Binary)(),l.write(\"ED\",0,1),l.writeUint8(g.byteLength>>16),l.writeUint16(g.byteLength&65535),l.writeBuffer(g),f=l.readByteArray(),d(\"WALogger\").LOG(k(),f));m=f?d(\"WABinary\").Binary.build(f,a.protoHeader).readByteArray():a.protoHeader;n=new(d(\"WAFrameSocket\").FrameSocket)(e,m);t.next=8;return b(\"regeneratorRuntime\").awrap(a.getClientPayload());case 8:o=t.sent;p=new(d(\"WACryptoCurve25519\").Curve25519)(a.curveSignalDependencies);q=a.serverStaticKeyIfKnown();if(!q){t.next=17;break}d(\"WALogger\").LOG(j());(r=a.preLogging)==null?void 0:r.onBeforeResumeHandshakeStarted==null?void 0:r.onBeforeResumeHandshakeStarted();return t.abrupt(\"return\",A(n,o,q,p,a).then(function(b){var c;(c=a.preLogging)==null?void 0:c.onAfterResumeHandshakeCompleted==null?void 0:c.onAfterResumeHandshakeCompleted();return b})[\"catch\"](function(c){var d;(d=a.preLogging)==null?void 0:d.onHandshakeError==null?void 0:d.onHandshakeError();return(h||(h=b(\"Promise\"))).reject(c)}));case 17:d(\"WALogger\").LOG(i());(s=a.preLogging)==null?void 0:s.onBeforeFullHandshakeStarted==null?void 0:s.onBeforeFullHandshakeStarted();return t.abrupt(\"return\",z(n,o,p,a).then(function(b){var c;(c=a.preLogging)==null?void 0:c.onAfterFullHandshakeCompleted==null?void 0:c.onAfterFullHandshakeCompleted();return b})[\"catch\"](function(c){var d;(d=a.preLogging)==null?void 0:d.onHandshakeError==null?void 0:d.onHandshakeError();return(h||(h=b(\"Promise\"))).reject(c)}));case 20:case\"end\":return t.stop()}},null,this)}))}g.doFullHandshake=z;g.openChatSocket=a}),98);\n__d(\"WASetClockSkewApi\",[\"WAGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){a=a.clockSkew;return d(\"WAGlobals\").getDbImpls().setMeta({clockSkew:a})};g.setClockSkew=a}),98);\n__d(\"WASendPing\",[\"WAComms\",\"WALogger\",\"WASetClockSkewApi\",\"WATimeUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"sendPing: sending\"]);h=function(){return a};return a}function a(){d(\"WALogger\").LOG(h()),d(\"WAComms\").sendPing()}function c(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:d(\"WATimeUtils\").setClockSkew(a);c.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WASetClockSkewApi\").setClockSkew({clockSkew:a}));case 3:case\"end\":return c.stop()}},null,this)}g.sendPing=a;g.updateClockSkew=c}),98);\n__d(\"WASmaxInMultiwaydServerNotificationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"offline\",0,1024);return!a.success?a:d(\"WAResultOrError\").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);\n__d(\"WASmaxInMultiwaydMultiwayNotificationRequest\",[\"WAResultOrError\",\"WASmaxInMultiwaydServerNotificationMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"multiway\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"fb:multiway\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,b.value,\"transaction_id\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").attrInt(b.value,\"binary_version\");if(!g.success)return g;b=d(\"WASmaxParseUtils\").contentBytesRange(b.value,1,void 0);if(!b.success)return b;a=d(\"WASmaxInMultiwaydServerNotificationMixin\").parseServerNotificationMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:c.value,type:e.value,multiwayTransactionId:f.value,multiwayBinaryVersion:g.value,multiwayElementValue:b.value},a.value))}g.parseMultiwayNotificationRequest=a}),98);\n__d(\"WASmaxOutMultiwaydNotificationClientAckMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrDomainJid,a,[\"from\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").DOMAIN_JID(c.value),\"class\":\"notification\",type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);\n__d(\"WASmaxOutMultiwaydMultiwayNotificationResponseAck\",[\"WASmaxJsx\",\"WASmaxOutMultiwaydNotificationClientAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutMultiwaydNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a);return a}g.makeMultiwayNotificationResponseAck=a}),98);\n__d(\"WASmaxMultiwaydMultiwayNotificationRPC\",[\"WASmaxInMultiwaydMultiwayNotificationRequest\",\"WASmaxOutMultiwaydMultiwayNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMultiwaydMultiwayNotificationRequest\").parseMultiwayNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"MultiwayNotification\",{Request:b}));return{parsedRequest:b.value,makeMultiwayNotificationResponseAck:function(){return d(\"WASmaxOutMultiwaydMultiwayNotificationResponseAck\").makeMultiwayNotificationResponseAck(a)}}}g.receiveMultiwayNotificationRPC=a}),98);\n__d(\"MAWCommsConfig\",[\"BroadcastChannelClientServerHandshake\",\"MAWChatSocketPlatformDetails\",\"MAWGetWorkerStatusApi\",\"MAWODSProxy\",\"MWBroadcastChannel\",\"WAComms\",\"WADevToolsStanzaViewer\",\"WALogger\",\"WAOdsEnums\",\"WAOpenChatSocket\",\"WASendPing\",\"WASmaxMultiwaydMultiwayNotificationRPC\",\"WATimeUtils\",\"asyncToGeneratorRuntime\",\"gkx\",\"promiseDone\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"comms change: \",\"\"]);h=function(){return a};return a}var i=12*60*60;function j(a){d(\"WALogger\").LOG(h(),a),a===\"connected\"&&c(\"promiseDone\")(d(\"WAComms\").startHandlingRequests())}function a(a){return k.apply(this,arguments)}function k(){k=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b=a.authKeyPair,e=a.handleConnectionChange,f=a.handleOptimisticConnectionChange,g=(yield d(\"MAWChatSocketPlatformDetails\").getChatSocketPlatformDetails(b)),h=!1;return{deadSocketTime:2e4,handlers:{onCastStanza:function(a){c(\"gkx\")(\"3282\")&&d(\"WADevToolsStanzaViewer\").sendNewStanzaToDevTool(a,!0)},onClockSkewUpdate:function(a){var b=d(\"WATimeUtils\").getClockSkew();if(Math.abs(b-a)<=10)return;if(Math.abs(a)>i){d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.CLOCK_SKEW_UPDATE,key:\"exceeds_max_val\"});h||(h=!0,d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.CLOCK_SKEW_UPDATE,key:\"exceeds_max_val_alert\"}));return}c(\"promiseDone\")(d(\"WASendPing\").updateClockSkew(a))},onConnectionChange:function(a){e==null?void 0:e(a),d(\"MAWGetWorkerStatusApi\").setCommsStatus(a),j(a)},onHandleStanza:function(a){c(\"gkx\")(\"3282\")&&d(\"WADevToolsStanzaViewer\").sendNewStanzaToDevTool(a,!1);if(c(\"gkx\")(\"8923\")&&a.tag===\"notification\"&&a.attrs.type===\"fb:multiway\"){var b=d(\"MWBroadcastChannel\").MWBroadcastChannel(\"maw-shared-worker-to-zenon\");a=d(\"WASmaxMultiwaydMultiwayNotificationRPC\").receiveMultiwayNotificationRPC(a);var e=a.parsedRequest.multiwayElementValue;c(\"promiseDone\")(d(\"BroadcastChannelClientServerHandshake\").checkAlive(b).then(function(){b.postMessage({type:\"ZENON_ON_STANZA_RECEIVED\",value:e})}))}},onOptimisticConnectionChange:function(a){f==null?void 0:f(a)}},healthCheckInterval:20,maxRetries:Number.MAX_SAFE_INTEGER,maxSocketLoopWaitTime:6e4,openChatSocket:function(a,b){return d(\"WAOpenChatSocket\").openChatSocket(g,a,b)},shouldBlockReceivingUntilSuccess:!1,shouldCloseStaleSocket:!0}});return k.apply(this,arguments)}g.baseOnConnectionChange=j;g.getCommsConfig=a}),98);\n__d(\"MAWMediaType\",[\"WAServerMediaType\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){switch(a){case\"XMA\":return\"xma-image\";case\"EphemeralScreenshotAction\":case\"Raven\":case\"RavenAction\":case\"EditAction\":case\"BumpExistingMessage\":return null;default:return d(\"WAServerMediaType\").getMediaType(a)}}g.getMediaType=a}),98);\n__d(\"MAWSendMsgUtil\",[\"MAWMediaType\",\"WASendMsgUtil\"],(function(a,b,c,d,e,f,g){\"use strict\";var h={};function a(a){var b=d(\"MAWMediaType\").getMediaType(a);if(b!=null)return{mediaType:b,type:\"media\"};switch(a){case\"XMA\":case\"Raven\":case\"RavenAction\":case\"EphemeralScreenshotAction\":case\"EditAction\":case\"BumpExistingMessage\":return{isRevoked:!1,type:\"text\"};default:return d(\"WASendMsgUtil\").getMessageTypeFromMsg(a)}}function b(a){return h[a]}function c(a){h[a]=!0}function e(a){delete h[a]}g.getMessageTypeFromMsg=a;g.checkS2SInstanceKeyExist=b;g.addS2SInstanceKey=c;g.removeS2SInstanceKey=e}),98);\n__d(\"WAMapWithDefault\",[],(function(a,b,c,d,e,f){\"use strict\";a=function(){function a(a,b){this.$1=a,b!=null?this.$2=new Map(b):this.$2=new Map()}var b=a.prototype;b.size=function(){return this.$2.size};b.get=function(a){var b=this.$2.get(a);if(b!=null)return b;else{b=this.$1(a);this.$2.set(a,b);return b}};b.keys=function(){return this.$2.keys()};b.entries=function(){return this.$2.entries()};b.update=function(b,c){c=new Map(this.$2).set(b,c(this.get(b)));return new a(this.$1,c)};return a}();f.MapWithDefault=a}),66);\n__d(\"MAWPREListeners\",[\"MAWODSProxy\",\"MAWQplProxy\",\"MAWSendMsgUtil\",\"WALogger\",\"WAMapWithDefault\",\"WAOdsEnums\",\"WAPREList\",\"WAPREMetrics\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received unreachable stage value for the event\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"The QPL event of \",\" was processed already\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"The QPL event of \",\" was processed already\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"The QPL event of \",\" was completed or failed already\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Cannot RESUME without instanceKey\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"The QPL event of \",\" was completed or failed already\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received unreachable stage value for the ODS event\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Event \",\" not implemented\"]);o=function(){return a};return a}function a(){d(\"WAPREMetrics\").subscribe(q)}var p=new(d(\"WAMapWithDefault\").MapWithDefault)(function(){return new Map()});function b(a){return q(a)}function q(a){switch(a.name){case d(\"WAPREList\").PRE_METRIC.DELETE_THREAD:s(c(\"qpl\")._(1056845732,\"691\"),a);break;case d(\"WAPREList\").PRE_METRIC.FRANKING_VALIDATION:s(c(\"qpl\")._(25299246,\"150\"),a);break;case d(\"WAPREList\").PRE_METRIC.RETRY_RECEIPTS_SENT:s(c(\"qpl\")._(25301644,\"165\"),a);break;case d(\"WAPREList\").PRE_METRIC.QUERY_GROUPS:s(c(\"qpl\")._(741087294,\"2028\"),a);break;case d(\"WAPREList\").PRE_METRIC.QUERY_GROUP:r(d(\"WAOdsEnums\").Entity.WA_QUERY_GROUP,a);break;case d(\"WAPREList\").PRE_METRIC.OFFLINE_RETRY:s(c(\"qpl\")._(25309990,\"124\"),a);break;case d(\"WAPREList\").PRE_METRIC.MEDIA_DOWNLOAD:s(c(\"qpl\")._(25312150,\"83\"),a);break;case d(\"WAPREList\").PRE_METRIC.MEDIA_UPLOAD:s(c(\"qpl\")._(25313100,\"131\"),a);break;case d(\"WAPREList\").PRE_METRIC.GET_DEVICES:r(d(\"WAOdsEnums\").Entity.GET_DEVICES,a);break;case d(\"WAPREList\").PRE_METRIC.MESSAGE_DECRYPTION:s(c(\"qpl\")._(25306682,\"11176\"),a);r(d(\"WAOdsEnums\").Entity.DECRYPTION,a);break;case d(\"WAPREList\").PRE_METRIC.DECRYPT_MESSAGE_FINAL:s(c(\"qpl\")._(741087294,\"2028\"),a);break;case d(\"WAPREList\").PRE_METRIC.PROTOCOL_QUEUE_CONSUMER:s(c(\"qpl\")._(1056845300,\"1338\"),a);break;case d(\"WAPREList\").PRE_METRIC.MESSAGE_ENCRYPTION:s(c(\"qpl\")._(25299294,\"12933\"),a);s(c(\"qpl\")._(741087294,\"2028\"),a);break;case d(\"WAPREList\").PRE_METRIC.OFFLINE_QUEUE:s(c(\"qpl\")._(25306361,\"5664\"),a);break;case d(\"WAPREList\").PRE_METRIC.SYNCD_FATAL_ERROR:s(c(\"qpl\")._(25310891,\"540\"),a);break;case d(\"WAPREList\").PRE_METRIC.SEND_MESSAGE:d(\"MAWSendMsgUtil\").checkS2SInstanceKeyExist(a.instanceKey)?(s(c(\"qpl\")._(25313175,\"1551\"),a),(a.stage===\"SUCCESS\"||a.stage===\"FAIL\")&&d(\"MAWSendMsgUtil\").removeS2SInstanceKey(a.instanceKey)):r(d(\"WAOdsEnums\").Entity.S2S_QPL_MISSING_INSTANCE_KEY,a);break;case d(\"WAPREList\").PRE_METRIC.CREATE_GROUP:s(c(\"qpl\")._(25307987,\"970\"),a);break;case d(\"WAPREList\").PRE_METRIC.REMOVE_PARTICIPANTS:s(c(\"qpl\")._(25312342,\"971\"),a);break;case d(\"WAPREList\").PRE_METRIC.RECEIVE_MESSAGE:s(c(\"qpl\")._(1056840931,\"814\"),a);break;case d(\"WAPREList\").PRE_METRIC.SYNCD_CRITICAL_EVENT:s(c(\"qpl\")._(25311142,\"804\"),a);break;case d(\"WAPREList\").PRE_METRIC.SYNCD_CRITICAL_BOOTSTRAP_STAGE:s(c(\"qpl\")._(741087294,\"2028\"),a);break;case d(\"WAPREList\").PRE_METRIC.SYNCD_BOOTSTRAP_APP_STATE_DOWNLOAD:s(c(\"qpl\")._(741087294,\"2028\"),a);break;case d(\"WAPREList\").PRE_METRIC.SYNCD_DECRYPT_MUTATIONS:s(c(\"qpl\")._(741087294,\"2028\"),a);break;case d(\"WAPREList\").PRE_METRIC.SYNCD_BOOTSTRAP_DATA_APPLIED:s(c(\"qpl\")._(741087294,\"2028\"),a);break;case d(\"WAPREList\").PRE_METRIC.SYNCD:s(c(\"qpl\")._(741087294,\"2028\"),a);break;case d(\"WAPREList\").PRE_METRIC.APP_STATE_SYNC_DAILY:s(c(\"qpl\")._(25306941,\"813\"),a);break;case d(\"WAPREList\").PRE_METRIC.ICDC_ERROR:s(c(\"qpl\")._(25313187,\"948\"),a);break;case d(\"WAPREList\").PRE_METRIC.WA_DISCONNECT:r(d(\"WAOdsEnums\").Entity.WA_DISCONNECT,a);break;case d(\"WAPREList\").PRE_METRIC.WA_FAIL_STANZA_QUEUE_ITEM:r(d(\"WAOdsEnums\").Entity.WA_FAIL_STANZA_QUEUE_ITEM,a);break;case d(\"WAPREList\").PRE_METRIC.WA_JOBS_ORCHESTRATOR:s(c(\"qpl\")._(25311870,\"1004\"),a);break;case d(\"WAPREList\").PRE_METRIC.WA_JOB_MANAGER:s(c(\"qpl\")._(25308825,\"136\"),a);break;case d(\"WAPREList\").PRE_METRIC.SYNCD_KEY_ROTATION:s(c(\"qpl\")._(25304909,\"1204\"),a);break;case d(\"WAPREList\").PRE_METRIC.STANZA_QUEUE_MESSAGE_CONSUMER:break;case d(\"WAPREList\").PRE_METRIC.DOWNLOAD_AND_DECRYPT:d(\"WALogger\").ERROR(o(),a.name);break;case d(\"WAPREList\").PRE_METRIC.ONE_QUEUE:s(c(\"qpl\")._(25308201,\"2007\"),a);break}}function r(a,b){var c;switch(b.stage){case\"START\":break;case\"RESUME\":case\"POINT\":break;case\"SUCCESS\":d(\"MAWODSProxy\").odsBumpEntityKey({entity:a,key:(c=(c=b.annotations)==null?void 0:(c=c.string)==null?void 0:c.key)!=null?c:\"success\"},!0);break;case\"FAIL\":d(\"MAWODSProxy\").odsBumpEntityKey({entity:a,key:b.reason},!0);break;default:d(\"WALogger\").ERROR(n());break}}function s(a,b){var c=babelHelpers[\"extends\"]({},b.annotations);switch(b.stage){case\"START\":if(p.get(a).has(b.instanceKey))return;var e=d(\"MAWQplProxy\").startQplUserFlow(a,c);p.get(a).set(b.instanceKey,e);break;case\"ANNOTATE\":e=p.get(a).get(b.instanceKey);if(e==null){d(\"WALogger\").WARN(m(),b.name);return}e.addAnnotations(c);break;case\"RESUME\":if(b.instanceKey==null){d(\"WALogger\").ERROR(l());return}if(p.get(a).has(b.instanceKey))return;e=d(\"MAWQplProxy\").startQplUserFlow(a,c,b.instanceKey);p.get(a).set(b.instanceKey,e);break;case\"POINT\":e=p.get(a).get(b.instanceKey);if(e==null){d(\"WALogger\").WARN(k(),b.name);return}e.addPoint(b.reason,c);break;case\"SUCCESS\":e=p.get(a).get(b.instanceKey);if(e==null){d(\"WALogger\").WARN(j(),b.name);return}e.endSuccess(c);p.get(a)[\"delete\"](b.instanceKey);break;case\"FAIL\":e=p.get(a).get(b.instanceKey);if(e==null){d(\"WALogger\").WARN(i(),b.name);return}e.endFail(b.reason,c);p.get(a)[\"delete\"](b.instanceKey);break;default:d(\"WALogger\").ERROR(h());break}}g.initializeWAPREMetrics=a;g.testOnly_logger=b}),98);\n__d(\"createReStoreColdEBTablesPersistence\",[\"MAWExceededStorageQuota\",\"MAWLSDBEncryption\",\"MAWQplProxy\",\"Promise\",\"asyncToGeneratorRuntime\",\"err\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(a){return a!=null&&typeof a===\"object\"&&Object.prototype.hasOwnProperty.call(a,\"SENTINEL_DELETED\")?!0:!1}function j(a){return new window.Promise(function(b,c){a.onsuccess=function(a){b(a.target.result)},a.onerror=function(a){c(a)}})}function a(a){var e=!0;return{clearCache:function(){},close:function(){a.close(),e=!1},flush:function(){var f=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(f){if(!e||f.size===0)return;var g=Array.from(f.keys()),k=d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(521485383,\"2200\"),{bool:{ebsmv2:!1},string_array:{tables:g}}),l=a.transaction(a.objectStoreNames,\"readwrite\",{durability:\"relaxed\"});d(\"MAWExceededStorageQuota\").listenToQuotaExceededError(l);g=new window.Promise(function(a,b){l.oncomplete=function(b){k.endSuccess(),a(b.target.result)},l.onerror=function(a){var c;k.endFail((c=a==null?void 0:(c=a.target)==null?void 0:c.error)!=null?c:\"flush_failure\");b(a)}});yield (h||(h=b(\"Promise\"))).all(Array.from(f).map(function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var c=a[0];a=a[1];var e=l.objectStore(c);yield (h||(h=b(\"Promise\"))).all(Array.from(a).map(function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b=a[0];a=a[1];if(i(a))yield j(e[\"delete\"](b));else{a=d(\"MAWLSDBEncryption\").encryptLSDBObj(a,c);yield j(e.put(a,b))}});return function(b){return a.apply(this,arguments)}}()))});return function(b){return a.apply(this,arguments)}}()));yield g});function g(a){return f.apply(this,arguments)}return g}(),get:function(a,b,d,e){throw c(\"err\")(\"Unsupported operation\")},queueCommitWork:void 0,runExclusively:function(a){throw c(\"err\")(\"Unsupported operation\")},shouldApplySync:function(){throw c(\"err\")(\"Unsupported operation\")},shouldInline:function(a,b){return!1},shouldSync:function(){throw c(\"err\")(\"Unsupported operation\")},types:[\"indexeddb\"],uniqueId:\"\"}}g[\"default\"]=a}),98);\n__d(\"MAWPersistedEBLSDB\",[\"EBSMProperties\",\"LSMetadata\",\"MAWCurrentUser\",\"MAWIndexedDbMetadata\",\"Promise\",\"createReStoreColdEBTablesPersistence\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i;function a(){var a=d(\"MAWCurrentUser\").getID();return new(h||(h=b(\"Promise\")))(function(b,e){var f=indexedDB.open(d(\"MAWIndexedDbMetadata\").ebLSDBName(a),c(\"EBSMProperties\").dbVersion);f.onerror=function(a){return e(a)};f.onsuccess=function(a){var c=a.target.result;b(c);c.onversionchange=function(a){a.newVersion==null&&c.close()}};f.onupgradeneeded=function(a){a=a.target.result;var b=Object.keys(d(\"LSMetadata\").metadata.tableIds);for(var e=0;e<b.length;e++){var f=b[e],g=d(\"LSMetadata\").metadata.tableIds[Number(f)].name;c(\"EBSMProperties\").persistedTables.has(g)&&!a.objectStoreNames.contains(g)&&a.createObjectStore(d(\"LSMetadata\").metadata.tableIds[Number(f)].name,{autoIncrement:!0})}}}).then(function(a){return c(\"createReStoreColdEBTablesPersistence\")(a)}).then(function(a){return i=a}).then(function(a){})}function e(){if(i==null)throw c(\"err\")(\"EBLSDB initialization error\");return i}g.makeEBLSDB=a;g.getEBLSDB=e}),98);\n__d(\"WAHandleServerNotification\",[\"WAJobDefinitions\",\"WAJobs\",\"WALogger\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleServerNotification with id=\",\", ts=\",\"\"]);h=function(){return a};return a}function a(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:d(\"WALogger\").LOG(h(),a.stanzaId,a.ts);c.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAJobs\").getJobManager().waitUntilCompleted(d(\"WAJobDefinitions\").createStartJobInfo(\"syncAbProps\",{sendHash:!1})));case 3:case\"end\":return c.stop()}},null,this)}g.handleServerNotification=a}),98);\n__d(\"WACryptoLtHash\",[\"Promise\",\"WACryptoHkdf\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=2,j=128;a=new ArrayBuffer(j);c=function(){function a(a){this.salt=a}var c=a.prototype;c.add=function(a,c){var d=this;return c.reduce(function(a,c){return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:e.t0=d;e.next=3;return b(\"regeneratorRuntime\").awrap(a);case 3:e.t1=e.sent;e.t2=c;return e.abrupt(\"return\",e.t0.$1.call(e.t0,e.t1,e.t2));case 6:case\"end\":return e.stop()}},null,this)},(h||(h=b(\"Promise\"))).resolve(a))};c.subtract=function(a,c){var d=this;return c.reduce(function(a,c){return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:e.t0=d;e.next=3;return b(\"regeneratorRuntime\").awrap(a);case 3:e.t1=e.sent;e.t2=c;return e.abrupt(\"return\",e.t0.$2.call(e.t0,e.t1,e.t2));case 6:case\"end\":return e.stop()}},null,this)},(h||(h=b(\"Promise\"))).resolve(a))};c.subtractThenAdd=function(a,c,d){var e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b(\"regeneratorRuntime\").awrap(this.subtract(a,d));case 2:e=g.sent;g.next=5;return b(\"regeneratorRuntime\").awrap(this.add(e,c));case 5:f=g.sent;return g.abrupt(\"return\",{ltHash:f,subtractResult:e});case 7:case\"end\":return g.stop()}},null,this)};c.$1=function(a,c){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoHkdf\").extractAndExpand(c,this.salt,j));case 2:e=f.sent;return f.abrupt(\"return\",this.performPointwiseWithOverflow(a,e,function(a,b){return a+b}));case 4:case\"end\":return f.stop()}},null,this)};c.$2=function(a,c){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoHkdf\").extractAndExpand(c,this.salt,j));case 2:e=f.sent;return f.abrupt(\"return\",this.performPointwiseWithOverflow(a,e,function(a,b){return a-b}));case 4:case\"end\":return f.stop()}},null,this)};c.performPointwiseWithOverflow=function(a,b,c){a=new DataView(a);b=new DataView(b);var d=new ArrayBuffer(a.byteLength),e=new DataView(d);for(var f=0;f<a.byteLength;f+=i)e.setUint16(f,c(a.getUint16(f,!0),b.getUint16(f,!0)),!0);return d};return a}();e=new c(\"WhatsApp Patch Integrity\");g.KEY_LENGTH_BYTES=j;g.EMPTY_LT_HASH=a;g.LtHash16=c;g.LT_HASH_ANTI_TAMPERING=e}),98);\n__d(\"WAGetCollectionVersion\",[\"Promise\",\"WABaseGlobals\",\"WACryptoLtHash\",\"WATimeUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){return d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.get(a)})}function i(a,b){a=a.CollectionVersionStore;return a.get(b).then(function(a){return(a=a==null?void 0:a.ltHash)!=null?a:new ArrayBuffer(d(\"WACryptoLtHash\").KEY_LENGTH_BYTES)})}function c(a){return d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return i({CollectionVersionStore:b},a)})}function e(a){return d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.bulkGet(a)})}function f(){return d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(a){a=a.CollectionVersionStore;return a.getAll()})}function j(a,b,c){return d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(d){d=d.CollectionVersionStore;return d.update(a,{version:b,ltHash:c})})}function k(a){return d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.bulkUpdate(a)})}function l(a){return d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.get(a).then(function(a){return a==null?void 0:a.isCollectionInMacMismatchFatal})})}function m(a){return d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.update(a,{isCollectionInMacMismatchFatal:!0})})}function n(a){return d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.get(a).then(function(a){return a==null?void 0:a.isCollectionLthashInconsistent})})}function o(a){return d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.update(a,{isCollectionLthashInconsistent:!0})})}function p(a){var c=function(b){return a.map(function(a){return b.update(a.collection,{lastSyncAttemptStartTimes:a.lastSyncAttemptStartTimes})})};return d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(a){var d;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:d=a.CollectionVersionStore;e.next=3;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(c(d)));case 3:case\"end\":return e.stop()}},null,this)})}function q(a){return d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.update(a,{lastSuccessfulSyncEndTime:d(\"WATimeUtils\").unixTimeMs()})})}g.getCollectionVersionInTransaction=a;g.getCollectionVersionLtHash=i;g.getCollectionVersionLtHashInTransaction=c;g.bulkGetCollectionVersionsInTransaction=e;g.getAllCollectionVersionsInTransaction=f;g.updateCollectionVersionAndLtHashInTransaction=j;g.bulkUpdateCollectionVersionInTransaction=k;g.getIsCollectionInMacMismatchFatalInTransaction=l;g.updateIsCollectionInMacMismatchFatalInTransaction=m;g.getIsCollectionLthashInconsistentInTransaction=n;g.updateIsCollectionLthashInconsistentInTransaction=o;g.bulkSetCollectionSyncAttemptStartTimesInTransaction=p;g.updateLastSuccessfulSyncEndTimeInTransaction=q}),98);\n__d(\"WAGetMissingKey\",[\"WABaseGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){return d(\"WABaseGlobals\").runInTransaction({MissingKeyStore:!0},function(a){a=a.MissingKeyStore;return a.getAll()})}function b(a){return d(\"WABaseGlobals\").runInTransaction({MissingKeyStore:!0},function(b){b=b.MissingKeyStore;return b.bulkGet(a)})}function c(){return d(\"WABaseGlobals\").runInTransaction({MissingKeyStore:!0},function(a){a=a.MissingKeyStore;return a.count()})}function e(a){return d(\"WABaseGlobals\").runInTransaction({MissingKeyStore:!0},function(b){b=b.MissingKeyStore;return b.bulkUpdate(a)})}g.getAllMissingKeysInTransaction=a;g.bulkGetMissingKeysInTransaction=b;g.getMissingKeyCountTransaction=c;g.bulkUpdateMissingKeysInTransaction=e}),98);\n__d(\"WAGetPendingMutation\",[\"WABaseGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return d(\"WABaseGlobals\").runInTransaction({PendingMutationStore:!0},function(b){b=b.PendingMutationStore;return b.getByCollection(a)})}function b(){return d(\"WABaseGlobals\").runInTransaction({PendingMutationStore:!0},function(a){a=a.PendingMutationStore;return a.getAll()})}function c(a){return d(\"WABaseGlobals\").runInTransaction({PendingMutationStore:!0},function(b){b=b.PendingMutationStore;return b.bulkCreate(a)})}g.getSyncPendingMutationsByCollectionInTransaction=a;g.getAllSyncPendingMutationsInTransaction=b;g.bulkCreateSyncPendingMutationsInTransaction=c}),98);\n__d(\"WAGetSyncAction\",[\"WABaseGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){return d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0},function(a){a=a.SyncActionStore;return a.count()})}function b(a){return d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.get(a)})}function c(a){return d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByCollections(a)})}function e(a){return d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByIndexMacs(a)})}function f(a){return d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByActionStates(a)})}function h(a){return d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByModelInfos(a)})}function i(){return d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0},function(a){a=a.SyncActionStore;return a.getAll()})}function j(a){return d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.bulkUpdate(a)})}g.countSyncActionsInTransaction=a;g.getSyncActionInTransaction=b;g.getSyncActionsByCollectionsInTransaction=c;g.getSyncActionsByIndexMacsInTransaction=e;g.getSyncActionsByActionStatesInTransaction=f;g.getSyncActionsByModelInfosInTransaction=h;g.getAllSyncActions=i;g.bulkUpdateSyncActionsInTransaction=j}),98);\n__d(\"WASyncdCollectionsStateMachine\",[\"WAGetCollectionVersion\",\"WALogger\",\"WASyncdConst\",\"WATimeUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Collection \",\" is in finite retry state with no failure start time\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: \",\": \",\" \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: state machine persistToDb. states:\"]);j=function(){return a};return a}a=function(){function a(){}a.loadStatesFromDb=function(){var a=this,c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").getAllCollectionVersionsInTransaction());case 2:c=e.sent,c.forEach(function(b){return a.collectionStates.set(b.collection,{collection:b.collection,state:b.state,finiteFailureStartTime:b.finiteFailureStartTime})});case 4:case\"end\":return e.stop()}},null,this)};a.persistToDb=function(){var a=[];this.collectionStates.forEach(function(b){return a.push(b)});d(\"WALogger\").LOG(j());a.forEach(function(a){var b=a.finiteFailureStartTime==null?\"\":\"(failure start: \"+a.finiteFailureStartTime+\")\";d(\"WALogger\").LOG(i(),a.collection,a.state,b)});return d(\"WAGetCollectionVersion\").bulkUpdateCollectionVersionInTransaction(a)};a.clean=function(){this.collectionStates=new Map()};a.getCollectionState=function(a){var b=this.collectionStates.get(a);if(b)return b.state;this.moveCollectionsToUpToDate([a]);return d(\"WASyncdConst\").CollectionSyncState.UpToDate};a.getCollectionsInStateDirty=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d(\"WASyncdConst\").CollectionSyncState.Dirty&&a.push(b.collection)});return a};a.getCollectionsInStateRetry=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d(\"WASyncdConst\").CollectionSyncState.FailingFiniteRetry&&a.push(b.collection)});return a};a.getCollectionsInStateFatal=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d(\"WASyncdConst\").CollectionSyncState.Fatal&&a.push(b.collection)});return a};a.getCollectionsInStateBlocked=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d(\"WASyncdConst\").CollectionSyncState.Blocked&&a.push(b.collection)});return a};a.moveCollectionsToUpToDate=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d(\"WASyncdConst\").CollectionSyncState.UpToDate,finiteFailureStartTime:void 0})})};a.moveCollectionsToDirty=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d(\"WASyncdConst\").CollectionSyncState.Dirty,finiteFailureStartTime:(a=b.collectionStates.get(a))==null?void 0:a.finiteFailureStartTime})})};a.moveCollectionsToFiniteRetry=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d(\"WASyncdConst\").CollectionSyncState.FailingFiniteRetry,finiteFailureStartTime:(a=(a=b.collectionStates.get(a))==null?void 0:a.finiteFailureStartTime)!=null?a:d(\"WATimeUtils\").unixTimeMs()})})};a.moveCollectionsToFatal=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d(\"WASyncdConst\").CollectionSyncState.Fatal})})};a.moveCollectionsToBlocked=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d(\"WASyncdConst\").CollectionSyncState.Blocked,finiteFailureStartTime:(a=b.collectionStates.get(a))==null?void 0:a.finiteFailureStartTime})})};a.getExpiredCollections=function(){var a=[];this.collectionStates.forEach(function(b){if(b.state===d(\"WASyncdConst\").CollectionSyncState.FailingFiniteRetry){var c;b.finiteFailureStartTime==null?(c=Infinity,d(\"WALogger\").WARN(h(),b.collection)):c=b.finiteFailureStartTime;c=c+d(\"WASyncdConst\").FINITE_FAILURE_EXPIRY_DURATION;c<d(\"WATimeUtils\").unixTimeMs()&&a.push(b.collection)}});return a};a.getCollectionMinFailureTime=function(){var a=Array.from(this.collectionStates.values()).filter(function(a){return a.state===d(\"WASyncdConst\").CollectionSyncState.FailingFiniteRetry}).map(function(a){return a.finiteFailureStartTime}).filter(Boolean);return a.length===0?null:Math.min.apply(Math,a)};return a}();a.collectionStates=new Map();g[\"default\"]=a}),98);\n__d(\"WASyncdDisabled\",[\"WABaseGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){return d(\"WABaseGlobals\").getConfig().syncdDisabled()}g.isSyncdDisabled=a}),98);\n__d(\"WASyncdKeyCache\",[\"WABase64\",\"WAGetSyncKey\",\"WASyncdKeyTypes\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=new Map();function a(a){var c,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:e=d(\"WABase64\").encodeB64(d(\"WASyncdKeyTypes\").fromSyncKeyId(a));f=h.get(e);if(!f){g.next=4;break}return g.abrupt(\"return\",f.keyData);case 4:g.next=6;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncKey\").getSyncKeyInTransaction_DO_NOT_USE(a));case 6:f=g.sent;f&&h.set(e,f);return g.abrupt(\"return\",(c=f)==null?void 0:c.keyData);case 9:case\"end\":return g.stop()}},null,this)}function c(){h=new Map()}g.getKeyData=a;g.clearSyncKeysCache=c}),98);\n__d(\"WASyncdMetricCriticalBootstrapStage\",[\"$InternalEnum\",\"WALogger\",\"WAPREList\",\"WAPREMetrics\",\"WASyncAction.pb\",\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: unknown SyncdDecryptMutationsType for DecryptMutations\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing decryptedMutationMessageRangeCountArray for DecryptMutations\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing totalAdditionalMessagesCount for DecryptMutations\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing count for DecryptMutations\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing type for DecryptMutations\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: unknown bootstrap stage: \",\" for critical bootstrap stage\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing bootstrap stage for critical bootstrap stage\"]);n=function(){return a};return a}var o=b(\"$InternalEnum\").Mirrored([\"ABOUT_TO_APPLY_MUTATIONS\",\"APPLIED_MUTATIONS\",\"MUTATIONS_DECRYPTED\",\"REQUEST_BUILT\",\"RESPONSE_RECEIVED\",\"RESPONSE_PARSED_VALID\",\"ENTERED_RETRY_MODE\",\"MISSING_KEYS_RECEIVED\"]),p=b(\"$InternalEnum\").Mirrored([\"PATCH_MUTATIONS\",\"SNAPSHOT_MUTATIONS\"]);function q(a){d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.SYNCD_CRITICAL_BOOTSTRAP_STAGE).endSuccess(r({type:a}))}function a(a,b){q(o.MUTATIONS_DECRYPTED),d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.SYNCD_DECRYPT_MUTATIONS).endSuccess(s({type:a,mutations:b}))}function r(a){return{string:{criticalBootstrapStage:a.type}}}function s(a){var b=a.type;a=a.mutations;var c,e=0,f=[];a.forEach(function(a){a=a.binarySyncData;a=d(\"decodeProtobuf\").decodeProtobuf(d(\"WASyncAction.pb\").SyncActionDataSpec,a);a=a.value;if(a==null)return;a.archiveChatAction?c=a.archiveChatAction.messageRange:a.markChatAsReadAction?c=a.markChatAsReadAction.messageRange:a.clearChatAction?c=a.clearChatAction.messageRange:a.deleteChatAction&&(c=a.deleteChatAction.messageRange);c!=null&&(e+=c.messages.length,f.push(c.messages.length))});return{string:{mutationType:b},\"int\":{count:a.length,totalAdditionalMessagesCount:e},int_array:{messageRangeLengths:f}}}function c(a){a=a==null?void 0:(a=a.string)==null?void 0:a.criticalBootstrapStage;if(a==null){d(\"WALogger\").ERROR(n());return null}var b=o.cast(a);if(b==null){d(\"WALogger\").ERROR(m(),a);return null}return{type:b}}function e(a){var b,c,e;b=a==null?void 0:(b=a.string)==null?void 0:b.mutationType;c=a==null?void 0:(c=a[\"int\"])==null?void 0:c.count;e=a==null?void 0:(e=a[\"int\"])==null?void 0:e.totalAdditionalMessagesCount;a=a==null?void 0:(a=a.int_array)==null?void 0:a.messageRangeLengths;if(b==null){d(\"WALogger\").ERROR(l());return null}if(c==null){d(\"WALogger\").ERROR(k());return null}if(e==null){d(\"WALogger\").ERROR(j());return null}if(a==null){d(\"WALogger\").ERROR(i());return null}b=p.cast(b);if(b==null){d(\"WALogger\").ERROR(h());return null}return{type:b,count:c,totalAdditionalMessagesCount:e,decryptedMutationMessageRangeCountArray:a}}g.SyncdCriticalBootstrapStageType=o;g.SyncdDecryptMutationsType=p;g.reportSyncdCriticalBootstrapStage=q;g.reportSyncdDecryptedMutations=a;g.convertSyncdCriticalBootstrapStageFromAnnotations=c;g.convertSyncdDecryptMutationsMetricsFromAnnotations=e}),98);\n__d(\"WASyncdMetricFatalError\",[\"$InternalEnum\",\"WALogger\",\"WAPREList\",\"WAPREMetrics\",\"WASyncdConst\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: unknown error code: \",\" for syncd fatal error\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing error code for syncd fatal error\"]);i=function(){return a};return a}var j=b(\"$InternalEnum\").Mirrored([\"PATCH_PROTOBUF_SERIALIZATION_FAILED\",\"MUTATIONS_PROTOBUF_SERIALIZATION_FAILED\",\"ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED\",\"ENCRYPTION_FAILED\",\"MISSING_SNAPSHOT_VERSION\",\"MISSING_SNAPSHOT_MAC\",\"MISSING_SNAPSHOT_KEY_ID\",\"MISSING_PATCH_VERSION\",\"PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS\",\"MISSING_PATCH_SNAPSHOT_MAC\",\"MISSING_PATCH_MAC\",\"MISSING_PATCH_KEY_ID\",\"MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY\",\"MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH\",\"MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256\",\"MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256\",\"MISSING_MUTATION_OPERATION\",\"MISSING_MUTATION_RECORD\",\"MISSING_MUTATION_INDEX\",\"MISSING_MUTATION_VALUE\",\"MISSING_MUTATION_KEY_ID\",\"EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED\",\"SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED\",\"PATCH_PROTOBUF_DESERIALIZATION_FAILED\",\"MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED\",\"ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED\",\"MISSING_ACTION_INDEX\",\"MISSING_ACTION_VERSION\",\"SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT\",\"SNAPSHOT_MAC_MISMATCH_IN_PATCH\",\"MAC_MISMATCH_PATCH\",\"DECRYPTION_FAILED\",\"DUPLICATE_PATCH_VERSION_IN_COLLECTION\",\"SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH\",\"SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT\",\"MISSING_ACTION_VALUE\",\"MISSING_ACTION_TIMESTAMP\",\"XMPP_BAD_REQUEST_FOR_COLLECTION\",\"XMPP_NOT_FOUND_FOR_COLLECTION\",\"CYCLIC_MUTATION_DEPENDENCY_IN_PATCH\",\"SERVER_DID_NOT_SEND_ALL_PATCHES\",\"TERMINAL_PATCH_MISSING_DATA\",\"TERMINAL_PATCH_DESERIALIZATION_ERROR\",\"TERMINAL_PATCH_UNKNOWN\",\"INVALID_ACTION_INDEX\",\"XMPP_BAD_REQUEST_GLOBAL_ERROR\",\"XMPP_NOT_FOUND_GLOBAL_ERROR\",\"XMPP_BAD_METHOD_GLOBAL_ERROR\",\"XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR\",\"TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D\",\"TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY\",\"MISSING_KEY_ON_ALL_CLIENTS\"]);function a(a,b,c,e,f,g,h,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C){d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.SYNCD_FATAL_ERROR).endFail(\"syncd fatal error: \"+a,k({type:a,collection:b,patchSnapshotMutationCount:c,patchVersion:e,isFatal:f,isLtHashConsistent:g,macFatalCollectionNameMismatch:h,macFatalCurrentLthashMismatch:i,macFatalNewLthashMismatch:j,macFatalPatchVersionMismatch:l,macFatalNewLthashSubtractMismatch:m,macFatalNumberHasOverrideMutation:n,macFatalNumberNumAddMutation:o,macFatalNumberNumRemoveMutation:p,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:q,isPatchSenderPrimary:r,macFatalDidUseMacFetchFallback:s,macFatalHasMissingRemove:t,macFatalNumberAddMismatch:u,macFatalNumberRemoveMismatch:v,macFatalDidPreviousPatchFailPostSaveValidation:w,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:x,isPreviousPatchAnIncomingPatch:y,isLastPatchSenderAPrimaryDevice:z,isSenderIndexSameAsPreviousSenderIndex:A,didBootstrapFromSnapshot:B,isThereAnotherSyncdCompanion:C}))}function k(a){var b=a.type,c=a.collection,d=a.patchSnapshotMutationCount,e=a.patchVersion,f=a.isFatal,g=a.isLtHashConsistent,h=a.macFatalCollectionNameMismatch,i=a.macFatalCurrentLthashMismatch,j=a.macFatalNewLthashMismatch,k=a.macFatalPatchVersionMismatch,l=a.macFatalNewLthashSubtractMismatch,m=a.macFatalNumberHasOverrideMutation,n=a.macFatalNumberNumAddMutation,o=a.macFatalNumberNumRemoveMutation,p=a.macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch,q=a.isPatchSenderPrimary,r=a.macFatalDidUseMacFetchFallback,s=a.macFatalHasMissingRemove,t=a.macFatalNumberAddMismatch,u=a.macFatalNumberRemoveMismatch,v=a.macFatalDidPreviousPatchFailPostSaveValidation,w=a.macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash,x=a.isPreviousPatchAnIncomingPatch,y=a.isLastPatchSenderAPrimaryDevice,z=a.isSenderIndexSameAsPreviousSenderIndex,A=a.didBootstrapFromSnapshot;a=a.isThereAnotherSyncdCompanion;return{string:{errorCode:b,collection:c==null?null:c},\"int\":{patchSnapshotMutationCount:d,patchVersion:e,macFatalNumberNumAddMutation:n,macFatalNumberNumRemoveMutation:o},bool:{isFatal:f,isLtHashConsistent:g,macFatalCollectionNameMismatch:h,macFatalCurrentLthashMismatch:i,macFatalNewLthashMismatch:j,macFatalPatchVersionMismatch:k,macFatalNewLthashSubtractMismatch:l,macFatalNumberHasOverrideMutation:m,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:p,isPatchSenderPrimary:q,macFatalDidUseMacFetchFallback:r,macFatalHasMissingRemove:s,macFatalNumberAddMismatch:t,macFatalNumberRemoveMismatch:u,macFatalDidPreviousPatchFailPostSaveValidation:v,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:w,isPreviousPatchAnIncomingPatch:x,isLastPatchSenderAPrimaryDevice:y,isSenderIndexSameAsPreviousSenderIndex:z,didBootstrapFromSnapshot:A,isThereAnotherSyncdCompanion:a}}}function c(a){var b;b=a==null?void 0:(b=a.string)==null?void 0:b.errorCode;if(b==null){d(\"WALogger\").ERROR(i());return null}var c=j.cast(b);if(c==null){d(\"WALogger\").ERROR(h(),b);return null}return{type:c,collection:d(\"WASyncdConst\").CollectionName.cast(a==null?void 0:(b=a.string)==null?void 0:b.collection),patchSnapshotMutationCount:a==null?void 0:(c=a[\"int\"])==null?void 0:c.patchSnapshotMutationCount,patchVersion:a==null?void 0:(b=a[\"int\"])==null?void 0:b.patchVersion,isFatal:a==null?void 0:(c=a.bool)==null?void 0:c.isFatal,isLtHashConsistent:a==null?void 0:(b=a.bool)==null?void 0:b.isLtHashConsistent,macFatalCollectionNameMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalCollectionNameMismatch,macFatalCurrentLthashMismatch:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalCurrentLthashMismatch,macFatalNewLthashMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalNewLthashMismatch,macFatalPatchVersionMismatch:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalPatchVersionMismatch,macFatalNewLthashSubtractMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalNewLthashSubtractMismatch,macFatalNumberHasOverrideMutation:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalNumberHasOverrideMutation,macFatalNumberNumAddMutation:a==null?void 0:(c=a[\"int\"])==null?void 0:c.macFatalNumberNumAddMutation,macFatalNumberNumRemoveMutation:a==null?void 0:(b=a[\"int\"])==null?void 0:b.macFatalNumberNumRemoveMutation,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch,isPatchSenderPrimary:a==null?void 0:(b=a.bool)==null?void 0:b.isPatchSenderPrimary,macFatalDidUseMacFetchFallback:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalDidUseMacFetchFallback,macFatalHasMissingRemove:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalHasMissingRemove,macFatalNumberAddMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalNumberAddMismatch,macFatalNumberRemoveMismatch:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalNumberRemoveMismatch,macFatalDidPreviousPatchFailPostSaveValidation:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalDidPreviousPatchFailPostSaveValidation,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash,isPreviousPatchAnIncomingPatch:a==null?void 0:(c=a.bool)==null?void 0:c.isPreviousPatchAnIncomingPatch,isLastPatchSenderAPrimaryDevice:a==null?void 0:(b=a.bool)==null?void 0:b.isLastPatchSenderAPrimaryDevice,isSenderIndexSameAsPreviousSenderIndex:a==null?void 0:(c=a.bool)==null?void 0:c.isSenderIndexSameAsPreviousSenderIndex,didBootstrapFromSnapshot:a==null?void 0:(b=a.bool)==null?void 0:b.didBootstrapFromSnapshot,isThereAnotherSyncdCompanion:a==null?void 0:(c=a.bool)==null?void 0:c.isThereAnotherSyncdCompanion}}g.SyncdFatalErrorType=j;g.reportSyncdFatalError=a;g.convertSyncdFatalErrorFromAnnotations=c}),98);\n__d(\"WAPromiseEach\",[\"regeneratorRuntime\"],(function(a,b,c,d,e,f){\"use strict\";a=function(a,c){var d,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:d=[],e=0;case 2:if(!(e<a.length)){f.next=11;break}f.t0=d;f.next=6;return b(\"regeneratorRuntime\").awrap(c(a[e]));case 6:f.t1=f.sent,f.t0.push.call(f.t0,f.t1);case 8:e++;f.next=2;break;case 11:return f.abrupt(\"return\",d);case 12:case\"end\":return f.stop()}},null,this)};f.promiseEach=a}),66);\n__d(\"WASyncdCryptoConst\",[],(function(a,b,c,d,e,f){\"use strict\";a=\"WhatsApp Mutation Keys\";b=160;c=32;d=32;e=32;var g=32,h=32,i=c,j=i+d,k=j+e,l=k+g,m=l+h,n=\"0x01\",o=\"0x02\",p=0,q=32,r=8,s=16,t=new ArrayBuffer(q);f.HKDF_INFO=a;f.DERIVED_KEY_LENGTH=b;f.INDEX_KEY_LENGTH=c;f.VALUE_ENCRYPTION_KEY_LENGTH=d;f.VALUE_MAC_KEY_LENGTH=e;f.SNAPSHOT_MAC_KEY_LENGTH=g;f.PATCH_MAC_KEY_LENGTH=h;f.INDEX_KEY_END=i;f.VALUE_ENCRYPTION_KEY_END=j;f.VALUE_MAC_KEY_END=k;f.SNAPSHOT_MAC_KEY_END=l;f.PATCH_MAC_KEY_END=m;f.OPERATION_SET_HEX=n;f.OPERATION_REMOVE_HEX=o;f.MAX_OF_MIN_DATA_LENGTH=p;f.MAC_LENGTH=q;f.OCTET_LENGTH=r;f.IV_LENGTH=s;f.EMPTY_MUTATION_MAC=t}),66);\n__d(\"WASyncdCryptoHelper\",[\"WACryptoHkdf\",\"WASyncdCryptoConst\",\"WASyncdKeyTypes\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b(\"regeneratorRuntime\").awrap(h(a));case 2:c=e.sent;return e.abrupt(\"return\",{indexKey:c.slice(0,d(\"WASyncdCryptoConst\").INDEX_KEY_END),valueEncryptionKey:c.slice(d(\"WASyncdCryptoConst\").INDEX_KEY_END,d(\"WASyncdCryptoConst\").VALUE_ENCRYPTION_KEY_END),valueMacKey:c.slice(d(\"WASyncdCryptoConst\").VALUE_ENCRYPTION_KEY_END,d(\"WASyncdCryptoConst\").VALUE_MAC_KEY_END),snapshotMacKey:c.slice(d(\"WASyncdCryptoConst\").VALUE_MAC_KEY_END,d(\"WASyncdCryptoConst\").SNAPSHOT_MAC_KEY_END),patchMacKey:c.slice(d(\"WASyncdCryptoConst\").SNAPSHOT_MAC_KEY_END,d(\"WASyncdCryptoConst\").PATCH_MAC_KEY_END)});case 4:case\"end\":return e.stop()}},null,this)}function h(a){return d(\"WACryptoHkdf\").extractAndExpand(d(\"WASyncdKeyTypes\").fromSyncKeyData(a),d(\"WASyncdCryptoConst\").HKDF_INFO,d(\"WASyncdCryptoConst\").DERIVED_KEY_LENGTH)}g.generateEncryptionKeysUnmemoized=a}),98);\n__d(\"WASyncdCrypto\",[\"WABase64\",\"WACryptoAesCbc\",\"WACryptoDependencies\",\"WACryptoHmac\",\"WAErr\",\"WAMemoizeCache\",\"WAServerSync.pb\",\"WASyncdCryptoConst\",\"WASyncdCryptoHelper\",\"WASyncdCryptoUtils\",\"WASyncdKeyTypes\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=d(\"WAMemoizeCache\").memoizeWithArgs(d(\"WASyncdCryptoHelper\").generateEncryptionKeysUnmemoized,function(a){return d(\"WABase64\").encodeB64(d(\"WASyncdKeyTypes\").fromSyncKeyData(a))});function a(a,b){return d(\"WACryptoHmac\").hmacSha256(new Uint8Array(a),new Uint8Array(b))}function b(a,b){b=d(\"WASyncdKeyTypes\").fromSyncKeyId(b);var e;switch(a){case d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET:e=d(\"WASyncdCryptoConst\").OPERATION_SET_HEX;break;case d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.REMOVE:e=d(\"WASyncdCryptoConst\").OPERATION_REMOVE_HEX;break}if(e){a=new Uint8Array([parseInt(e,16)]).buffer;var f=new Uint8Array(a.byteLength+b.byteLength);f.set(new Uint8Array(a));f.set(new Uint8Array(b),a.byteLength);return f.buffer}else throw c(\"WAErr\")(\"invalid mutation operation value\")}function e(a,b){a=Math.max(0,d(\"WASyncdCryptoConst\").MAX_OF_MIN_DATA_LENGTH-a-b);b=new Uint8Array(a);d(\"WACryptoDependencies\").getCrypto().getRandomValues(b);return b.buffer}function f(a,b,c){return d(\"WACryptoAesCbc\").aesCbcEncrypt(b,c,a)}function i(a,b,c){var e=new Uint8Array(d(\"WASyncdCryptoConst\").OCTET_LENGTH);e.set([a.byteLength],e.byteLength-1);a=d(\"WASyncdCryptoUtils\").combine([a,b,e.buffer]);return d(\"WACryptoHmac\").hmacSha512(c,a,d(\"WASyncdCryptoConst\").MAC_LENGTH)}function j(a,b,c){return d(\"WACryptoAesCbc\").aesCbcDecrypt(b,a,c)}function k(a,b,c,e){return d(\"WACryptoHmac\").hmacSha256(a,d(\"WASyncdCryptoUtils\").combine([b,c,e]))}function l(a,b,c,e,f){return d(\"WACryptoHmac\").hmacSha256(a,d(\"WASyncdCryptoUtils\").combine([b].concat(c,[e,f])))}function m(a){var b=a.byteLength;return new Uint8Array(a).slice(b-d(\"WASyncdCryptoConst\").MAC_LENGTH).buffer}g.generateEncryptionKeys=h;g.generateIndexMac=a;g.generateAssociatedData=b;g.generatePadding=e;g.generateCipherText=f;g.generateMac=i;g.decryptCipherText=j;g.generateSnapshotMac=k;g.generatePatchMac=l;g.valueMacFromIndexAndValueCipherText=m}),98);\n__d(\"WASyncdError\",[],(function(a,b,c,d,e,f){\"use strict\";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name=\"SyncdMissingKeyError\",b)||babelHelpers.assertThisInitialized(c)}return b}(babelHelpers.wrapNativeSuper(Error));b=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var d;d=a.call(this,b)||this;d.name=\"SyncdRetryableError\";d.backoff=c;d.message=b;return d}return b}(babelHelpers.wrapNativeSuper(Error));c=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b)||this;c.name=\"SyncdFatalError\";c.message=b;return c}return b}(babelHelpers.wrapNativeSuper(Error));f.SyncdMissingKeyError=a;f.SyncdRetryableError=b;f.SyncdFatalError=c}),66);\n__d(\"WASyncdAntiTampering\",[\"$InternalEnum\",\"Promise\",\"WABaseGlobals\",\"WACryptoLtHash\",\"WACryptoUtils\",\"WAGetCollectionVersion\",\"WAGetSyncAction\",\"WALogger\",\"WAPromiseEach\",\"WAServerSync.pb\",\"WASyncdConst\",\"WASyncdCrypto\",\"WASyncdCryptoUtils\",\"WASyncdError\",\"WASyncdKeyCache\",\"WASyncdKeyTypes\",\"WASyncdMetricFatalError\",\"WASyncdMetrics\",\"WATextEncoding\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: lthash inconsistent for \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"|\",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: current snapshot \",\" v\",\" with \",\" mutations:\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: logMacs: \",\": prepare\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: failed LtHash check for \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: computing ltHash for \",\":\\n  currentLtHash: \",\"\\n  macsToAdd:\\n      \",\"\\n  macsToRemove:\\n      \",\"\\n  macsToOverwrite (also remove):\\n      \",\"\\n  newLtHash: \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing indexMAC in sync-actions table for REMOVE mutation in collection \",\" version \",\" direction \",\" for platform \",\":\\n        \",\"\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: had to use fallbackQueryForValueMac in collection \",\" for platform \",\": \",\"\\n        }\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: computing snapshot and patch macs for outgoing patch \",\" v\",\":\\n  encoded version: \",\"\\n  encoded collection: \",\"\\n  snapshotMAC: \",\"\\n  patchMAC: \",\"\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd:\\n      expected patchMAC: \",\"$\\n      computed patchMAC: \",\"\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: unable to validate patch mac.\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: skip fatal after snapshot mac mismatch for collection \",\"\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd:\\n      expected snapshotMAC: \",\"\\n      computed snapshotMAC: \",\"\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: unable to validate snapshot mac.\"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: collection \",\" is already in snapshot mac mismatch so not checking again\"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: empty local lthash found when processing \",\" patch v\",\"\"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: \",\" received patch v\",\" !== latest local version (v\",\") + 1\"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: error on incoming records:\\n    \\t\",\"\"],[\"syncd: error on incoming records:\\n    \\\\t\",\"\"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: validating snapshot and patch mac for \",\" v\",\":\\n  expected snapshotMAC: \",\"\\n  expected patchMAC: \",\"\\n  encoded version: \",\"\\n  encoded collection: \",\"\\n  key ID: \",\"\\n  \"]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: shouldRecalculateLtHash: \",\"\"]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: computeLtHashAndValidatePatch for \",\"\"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: validating snapshot mac for \",\" snapshot v\",\":\\n  ltHash: \",\"\\n  encoded version: \",\"\\n  encoded collection: \",\"\\n  expected snapshotMAC: \",\"\\n  \"]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd:\\n  \",\" snapshot macsToAdd:\\n      \",\"\"]);E=function(){return a};return a}var F=b(\"$InternalEnum\").Mirrored([\"Incoming\",\"Outgoing\"]);function G(a,b,c){c===void 0&&(c=!0);a=typeof a===\"string\"?a:d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(a);b=typeof b===\"string\"?b:d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(b);c=c?-16:0;return a.slice(c)+\":\"+b.slice(c)}var H=d(\"WATextEncoding\").newTextDecoder();function a(a,c){var e,f,g,h,i,j,k,l,m,n,o;return b(\"regeneratorRuntime\").async(function(p){while(1)switch(p.prev=p.next){case 0:e=c.mac,f=c.version,g=c.keyId,h=c.records;p.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdKeyCache\").getKeyData(g.id));case 3:i=p.sent;if(i){p.next=6;break}throw new(d(\"WASyncdError\").SyncdMissingKeyError)();case 6:j=new Map(h.map(function(a){return[d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(a.index.blob),d(\"WASyncdCrypto\").valueMacFromIndexAndValueCipherText(a.value.blob)]}));d(\"WALogger\").LOG(E(),a,Array.from(j.entries()).map(function(a){var b=a[0];a=a[1];return G(b,a)}).join(\"\\n\\t\"));p.next=10;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoLtHash\").LT_HASH_ANTI_TAMPERING.add(d(\"WACryptoLtHash\").EMPTY_LT_HASH,Array.from(j.values())));case 10:k=p.sent;p.next=13;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generateEncryptionKeys(i));case 13:l=p.sent;m=l.snapshotMacKey;n=d(\"WASyncdCryptoUtils\").to64BitNetworkOrder(f.version);o=d(\"WASyncdCryptoUtils\").toUtf8(a).buffer;d(\"WALogger\").LOG(D(),a,f.version,d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(k),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(n),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(o),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(e)).devConsole(\"\\n  --- DEV ONLY ---\\n  snapshotMacKey: \"+d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(m));p.next=20;return b(\"regeneratorRuntime\").awrap(J(a,e,m,k,n,o,!0,h.length,c.version.version,null,null,null,null));case 20:return p.abrupt(\"return\",k);case 21:case\"end\":return p.stop()}},null,this)}function c(a,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;return b(\"regeneratorRuntime\").async(function(y){while(1)switch(y.prev=y.next){case 0:x=function(){var c,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b(\"regeneratorRuntime\").awrap(P(a,!1));case 2:c=f.sent,e=new Map(c.map(function(a){var b=a.indexMac;a=a.valueMac;return[d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(b),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(a)]})),d(\"WALogger\").LOG(z(),p.map(function(a){var b=a.operation,c=a.indexMac;a=a.valueMac;return(b===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET?\"set\":\"remove\")+\" | \"+G(c,a,!1)+\" | \"+(e.has(d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(c))?\"found\":\"did not find\")+\" indexMAC in the above logged macs\"}).join(\"\\n\\t\"));case 5:case\"end\":return f.stop()}},null,this)};d(\"WALogger\").LOG(C(),a);f=c.version,g=c.mutations,h=c.snapshotMac,i=c.patchMac,j=c.keyId;k=j.id;y.next=6;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdKeyCache\").getKeyData(k));case 6:l=y.sent;if(l){y.next=9;break}throw new(d(\"WASyncdError\").SyncdMissingKeyError)();case 9:y.next=11;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generateEncryptionKeys(l));case 11:m=y.sent;n=m.snapshotMacKey;o=m.patchMacKey;p=g.map(function(a){return{operation:a.operation,indexMac:a.record.index.blob,valueMac:d(\"WASyncdCrypto\").valueMacFromIndexAndValueCipherText(a.record.value.blob)}});y.next=17;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0},function(d){var e,c;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:e=d.SyncActionStore;f.next=3;return b(\"regeneratorRuntime\").awrap(e.getByCollections([a]));case 3:c=f.sent;return f.abrupt(\"return\",c);case 5:case\"end\":return f.stop()}},null,this)}));case 17:q=y.sent;r=1e3;s=d(\"WABaseGlobals\").getConfig().syncShouldCalculateLtHashFromScratch()&&q&&q.length<r;d(\"WALogger\").LOG(B(),s);if(!s){y.next=27;break}y.next=24;return b(\"regeneratorRuntime\").awrap(N(q));case 24:y.t0=y.sent;y.next=30;break;case 27:y.next=29;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").getCollectionVersionLtHashInTransaction(a));case 29:y.t0=y.sent;case 30:t=y.t0;y.next=33;return b(\"regeneratorRuntime\").awrap(L(a,p,e,c.version.version,F.Incoming,t));case 33:u=y.sent;v=d(\"WASyncdCryptoUtils\").to64BitNetworkOrder(f.version);w=d(\"WASyncdCryptoUtils\").toUtf8(a).buffer;d(\"WALogger\").LOG(A(),a,f.version,d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(h),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(i),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(v),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(w),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(d(\"WASyncdKeyTypes\").fromSyncKeyId(k)));y.prev=37;y.next=40;return b(\"regeneratorRuntime\").awrap(K(a,i,o,h,p.map(function(a){return a.valueMac}),v,w,g.length,f.version));case 40:y.next=42;return b(\"regeneratorRuntime\").awrap(J(a,h,n,u.ltHash,v,w,!1,g.length,f.version,c.clientDebugData,t,u,c.deviceIndex));case 42:y.next=49;break;case 44:y.prev=44;y.t1=y[\"catch\"](37);y.next=48;return b(\"regeneratorRuntime\").awrap(x());case 48:throw y.t1;case 49:return y.abrupt(\"return\",u.ltHash);case 50:case\"end\":return y.stop()}},null,this,[[37,44]])}function I(a,c){var e,f,g;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").getCollectionVersionInTransaction(a).then(function(a){return(a=a==null?void 0:a.version)!=null?a:0}));case 2:e=h.sent;if(!(e!==c-1)){h.next=7;break}f=e>c-1?\"greater-than-expected\":\"less-than-expected\";d(\"WALogger\").WARN(y(),a,c,e).sendLogs(\"syncd-version-check-error-local-version-\"+f);throw new(d(\"WASyncdError\").SyncdRetryableError)(\"syncd-version-check-error-local-version-\"+f);case 7:h.next=9;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").getCollectionVersionLtHashInTransaction(a));case 9:g=h.sent;if(!(d(\"WACryptoUtils\").arrayBuffersEqual(g,d(\"WACryptoLtHash\").EMPTY_LT_HASH)&&c!==1)){h.next=13;break}d(\"WALogger\").WARN(x(),a,c).sendLogs(\"syncd-empty-lthash-on-mac-mismatch\");throw new(d(\"WASyncdError\").SyncdRetryableError)(\"empty lthash\");case 13:case\"end\":return h.stop()}},null,this)}function J(a,c,e,f,g,h,i,j,k,l,m,n,o){var p,q,r,s,x,y,z,A,B,C,D,E,F,G,H,J,K,L,N,O,P,Q,R,S,T,U,V,W,X,Y,Z;return b(\"regeneratorRuntime\").async(function($){while(1)switch($.prev=$.next){case 0:q=d(\"WABaseGlobals\").getConfig().syncdShouldNotFatalOnSnapshotMacMismatchInPatches()&&!i;$.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").getIsCollectionInMacMismatchFatalInTransaction(a));case 3:$.t0=p=$.sent;if(!($.t0!=null)){$.next=8;break}$.t1=p;$.next=9;break;case 8:$.t1=!1;case 9:r=$.t1;if(!(q&&r)){$.next=13;break}d(\"WALogger\").LOG(w(),a);return $.abrupt(\"return\");case 13:$.next=15;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generateSnapshotMac(e,f,g,h));case 15:s=$.sent;x=d(\"WACryptoUtils\").arrayBuffersEqual(s,c);if(x){$.next=64;break}d(\"WALogger\").WARN(v()).sendLogs(\"syncd: unable to validate snapshot mac.\",0);d(\"WALogger\").DEV(u(),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(c),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(s));if(i){$.next=23;break}$.next=23;return b(\"regeneratorRuntime\").awrap(I(a,k));case 23:$.next=25;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"failed validate snapshot mac\"));case 25:$.next=27;return b(\"regeneratorRuntime\").awrap(M(a));case 27:y=$.sent;z=y.isLtHashConsistent;A=y.scratchLtHash;B=i?d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT:d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.SNAPSHOT_MAC_MISMATCH_IN_PATCH;C=(l==null?void 0:l.collectionName)&&!d(\"WACryptoUtils\").arrayBuffersEqual(h,l==null?void 0:l.collectionName);D=(l==null?void 0:l.newLthash)&&!d(\"WACryptoUtils\").arrayBuffersEqual(f,l==null?void 0:l.newLthash);E=(l==null?void 0:l.patchVersion)&&!d(\"WACryptoUtils\").arrayBuffersEqual(g,l==null?void 0:l.patchVersion);F=(l==null?void 0:l.currentLthash)&&m&&!d(\"WACryptoUtils\").arrayBuffersEqual(m,l==null?void 0:l.currentLthash);G=(l==null?void 0:l.newLthashSubtract)&&(n==null?void 0:n.subtractResult)&&!d(\"WACryptoUtils\").arrayBuffersEqual(n==null?void 0:n.subtractResult,l==null?void 0:l.newLthashSubtract);H=n==null?void 0:n.hasOverride;J=n==null?void 0:n.numAdd;K=n==null?void 0:n.numRemove;L=(l==null?void 0:l.currentLthash)&&A&&!d(\"WACryptoUtils\").arrayBuffersEqual(A,l==null?void 0:l.currentLthash);N=o===0;O=(l==null?void 0:l.numberAdd)!=null&&(n==null?void 0:n.numAdd)!=null&&(n==null?void 0:n.numAdd)!==(l==null?void 0:l.numberAdd);P=(l==null?void 0:l.numberRemove)!=null&&(n==null?void 0:n.numRemove)!=null&&(n==null?void 0:n.numRemove)!==(l==null?void 0:l.numberRemove);Q=n==null?void 0:n.didUseFallback;R=n==null?void 0:n.hasMissingRemove;$.next=47;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").getCollectionVersionInTransaction(a));case 47:S=$.sent;T=S==null?void 0:S.didLastPatchFailPostValidation;U=(l==null?void 0:l.currentLthash)&&(S==null?void 0:S.lastPatchNewLtHashFromPatchDebugData)&&!d(\"WACryptoUtils\").arrayBuffersEqual(S==null?void 0:S.lastPatchNewLtHashFromPatchDebugData,l==null?void 0:l.currentLthash);V=S==null?void 0:S.isLastPatchAnIncomingPatch;W=S==null?void 0:S.isLastPatchSenderAPrimaryDevice;X=S==null?void 0:S.didBootstrapFromSnapshot;Y=(S==null?void 0:S.lastPatchSenderDeviceId)!=null&&o!=null&&o===(S==null?void 0:S.lastPatchSenderDeviceId);$.next=56;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getConfig().getAreThereMoreCompanions());case 56:Z=$.sent;d(\"WASyncdMetricFatalError\").reportSyncdFatalError(B,a,j,k,!q,z,C,F,D,E,G,H,J,K,L,N,Q,R,O,P,T,U,V,W,Y,X,Z);if(!q){$.next=63;break}$.next=61;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").updateIsCollectionInMacMismatchFatalInTransaction(a));case 61:d(\"WALogger\").LOG(t(),a);return $.abrupt(\"return\");case 63:throw new(d(\"WASyncdError\").SyncdFatalError)(\"unable to validate snapshot mac\");case 64:case\"end\":return $.stop()}},null,this)}function K(a,c,e,f,g,h,i,j,k){var l,m;return b(\"regeneratorRuntime\").async(function(n){while(1)switch(n.prev=n.next){case 0:n.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generatePatchMac(e,f,g,h,i));case 2:l=n.sent;m=d(\"WACryptoUtils\").arrayBuffersEqual(l,c);if(m){n.next=13;break}n.next=7;return b(\"regeneratorRuntime\").awrap(I(a,k));case 7:n.next=9;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"failed validate patch mac\"));case 9:d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MAC_MISMATCH_PATCH,a,j,k);d(\"WALogger\").WARN(s()).sendLogs(\"syncd: unable to validate patch mac.\");d(\"WALogger\").DEV(r(),c,l);throw new(d(\"WASyncdError\").SyncdFatalError)(\"unable to validate patch mac\");case 13:case\"end\":return n.stop()}},null,this)}function e(a,c,e,f){var g,h,i,j,k,l,m,n;return b(\"regeneratorRuntime\").async(function(o){while(1)switch(o.prev=o.next){case 0:o.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").getCollectionVersionInTransaction(a).then(function(a){return(a=a==null?void 0:a.version)!=null?a:d(\"WASyncdConst\").DEFAULT_COLLECTION_VERSION}));case 2:o.t0=o.sent;g=o.t0+1;o.next=6;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generateEncryptionKeys(f));case 6:h=o.sent;i=h.patchMacKey;j=h.snapshotMacKey;k=d(\"WASyncdCryptoUtils\").to64BitNetworkOrder(g);l=d(\"WASyncdCryptoUtils\").toUtf8(a).buffer;o.next=13;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generateSnapshotMac(j,c,k,l));case 13:m=o.sent;o.next=16;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generatePatchMac(i,m,e.map(function(a){return a.valueMac}),k,l));case 16:n=o.sent;d(\"WALogger\").LOG(q(),a,g,d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(k),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(l),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(m),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(n)).devConsole(\"\\n  --- DEV ONLY ---\\n  snapshotMacKey: \"+d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(j)+\"\\n  patchMacKey: \"+d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(i));return o.abrupt(\"return\",{snapshotMac:m,patchMac:n});case 19:case\"end\":return o.stop()}},null,this)}function L(a,c,e,f,g,i){var j,k,l,m,q,r,s,t,u,v,w,x;return b(\"regeneratorRuntime\").async(function(y){while(1)switch(y.prev=y.next){case 0:x=function(a){return e==null?(h||(h=b(\"Promise\"))).resolve(null):e(a)};if(!((j=i)!=null)){y.next=5;break}y.t0=j;y.next=8;break;case 5:y.next=7;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").getCollectionVersionLtHashInTransaction(a));case 7:y.t0=y.sent;case 8:k=y.t0;y.next=11;return b(\"regeneratorRuntime\").awrap(O(c.map(function(a){return a.indexMac})));case 11:l=y.sent;m=new Map();q=new Map();r=new Map();s=!1;t=!1;y.next=19;return b(\"regeneratorRuntime\").awrap(d(\"WAPromiseEach\").promiseEach(c,function(c){var e,h,i,j,k,n,u,v;return b(\"regeneratorRuntime\").async(function(w){while(1)switch(w.prev=w.next){case 0:e=c.indexMac,h=c.valueMac,i=c.operation;j=H.decode(e);k=l.get(j);if(!k){w.next=7;break}i===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.REMOVE?q.set(d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(e),k):r.set(d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(e),k);w.next=12;break;case 7:if(!(i===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.REMOVE)){w.next=12;break}w.next=10;return b(\"regeneratorRuntime\").awrap(x(e));case 10:n=w.sent,n!=null?(q.set(d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(e),n),t=!0,d(\"WALogger\").WARN(p(),a,(u=d(\"WABaseGlobals\").getConfig().primaryPlatform())!=null?u:\"[empty]\",d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(e).slice(-16)).tags(\"non-sad\").sendLogs(\"syncd: fallback query\")):(s=!0,d(\"WASyncdMetrics\").reportSyncdCriticalEvent(d(\"WASyncdMetrics\").SyncdCriticalEventType.MISSING_MUTATION_TO_REMOVE,a),d(\"WALogger\").ERROR(o(),a,f,g,(v=d(\"WABaseGlobals\").getConfig().primaryPlatform())!=null?v:\"[empty]\",d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(e).slice(-16)).sendLogs(\"syncd: missing indexMAC from REMOVE\",0));case 12:i===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET&&m.set(d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(e),h);case 13:case\"end\":return w.stop()}},null,this)}));case 19:y.next=21;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoLtHash\").LT_HASH_ANTI_TAMPERING.subtractThenAdd(k,Array.from(m.values()),Array.from(q.values()).concat(Array.from(r.values()))));case 21:u=y.sent;v=u.ltHash;w=u.subtractResult;d(\"WALogger\").LOG(n(),a,d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(k),Array.from(m.entries()).map(function(a){var b=a[0];a=a[1];return G(b,a)}).join(\"\\n\\t\"),Array.from(q.entries()).map(function(a){var b=a[0];a=a[1];return G(b,a)}).join(\"\\n\\t\"),Array.from(r.entries()).map(function(a){var b=a[0];a=a[1];return G(b,a)}).join(\"\\n\\t\"),d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(v));return y.abrupt(\"return\",{ltHash:v,numAdd:m.size,numRemove:q.size,hasOverride:r.size>0,subtractResult:w,hasMissingRemove:s,didUseFallback:t});case 26:case\"end\":return y.stop()}},null,this)}function M(a,c){var e,f,g,i,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0},function(c){var d,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:d=c.SyncActionStore,e=c.CollectionVersionStore;if(!(a==null)){g.next=7;break}g.next=4;return b(\"regeneratorRuntime\").awrap(e.getAll());case 4:g.t0=g.sent;g.next=11;break;case 7:g.next=9;return b(\"regeneratorRuntime\").awrap(e.get(a));case 9:g.t1=g.sent,g.t0=[g.t1];case 11:f=g.t0;return g.abrupt(\"return\",(h||(h=b(\"Promise\"))).all(f.filter(Boolean).map(function(a){var c,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:c=a.collection,e=a.ltHash;g.next=3;return b(\"regeneratorRuntime\").awrap(d.getByCollections([c]));case 3:f=g.sent;return g.abrupt(\"return\",{collection:c,ltHash:e,mutations:f});case 5:case\"end\":return g.stop()}},null,this)})));case 13:case\"end\":return g.stop()}},null,this)}));case 2:e=k.sent;f=0;e.map(function(a){a.collection;a.ltHash;a=a.mutations;f+=a.length});if(!(c!==void 0&&f>c)){k.next=7;break}return k.abrupt(\"return\",{isLtHashConsistent:void 0,scratchLtHash:void 0,cachedLtHash:void 0});case 7:g=null;i=null;j=!0;k.next=12;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(e.map(function(a){var c,e,f,h;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:c=a.collection,e=a.ltHash,f=a.mutations;k.next=3;return b(\"regeneratorRuntime\").awrap(N(f));case 3:h=k.sent,g==null&&(g=h),i==null&&(i=e),d(\"WACryptoUtils\").arrayBuffersEqual(e,h)||(j=!1,d(\"WALogger\").ERROR(m(),c).verbose().sendLogs(\"LtHash check failed\",0));case 7:case\"end\":return k.stop()}},null,this)})));case 12:return k.abrupt(\"return\",{isLtHashConsistent:j,scratchLtHash:g,cachedLtHash:i});case 13:case\"end\":return k.stop()}},null,this)}function N(a){a=new Map(a.map(function(a){return[d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(a.indexMac),a.valueMac]}));return d(\"WACryptoLtHash\").LT_HASH_ANTI_TAMPERING.add(d(\"WACryptoLtHash\").EMPTY_LT_HASH,Array.from(a.values()))}function O(a){var c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncAction\").getSyncActionsByIndexMacsInTransaction(a));case 2:c=e.sent;return e.abrupt(\"return\",new Map(c.map(function(a){return[H.decode(a.indexMac),a.valueMac]})));case 4:case\"end\":return e.stop()}},null,this)}function P(a,c){var e,f,g,i,m;return b(\"regeneratorRuntime\").async(function(n){while(1)switch(n.prev=n.next){case 0:c===void 0&&(c=!0);e=c?20:1;d(\"WALogger\").LOG(l(),a);n.next=5;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0},function(c){var d=c.SyncActionStore;c=c.CollectionVersionStore;return(h||(h=b(\"Promise\"))).all([c.get(a).then(function(a){return a==null?void 0:a.version}),d.getByCollections([a])])}));case 5:f=n.sent;g=f[0];i=f[1];d(\"WALogger\").LOG(k(),a,g,i.length);if(!(c&&i.length>100)){n.next=11;break}return n.abrupt(\"return\",i);case 11:m=i.reduce(function(a,b,d){d%e===0&&a.push(\"\");a[a.length-1]+=G(b.indexMac,b.valueMac,c)+\" | \";return a},[]);m.forEach(function(a){return d(\"WALogger\").LOG(j(),a)});return n.abrupt(\"return\",i);case 14:case\"end\":return n.stop()}},null,this)}function f(a,c){var e,f,g,h,j,k,l,m,n,o,p,q,r,s;return b(\"regeneratorRuntime\").async(function(t){while(1)switch(t.prev=t.next){case 0:t.next=2;return b(\"regeneratorRuntime\").awrap(M(a,300));case 2:e=t.sent;f=e.isLtHashConsistent;g=e.scratchLtHash;h=e.cachedLtHash;j=g==null?\"\":d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(g).slice(-16);k=h==null?\"\":d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(h).slice(-16);t.next=10;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").getIsCollectionLthashInconsistentInTransaction(a));case 10:l=t.sent;if(!(l===!0)){t.next=15;break}t.next=14;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"lthash already inconsistent. scratchLtHash: \"+j+\", cachedLtHash: \"+k+\", context: \"+c));case 14:return t.abrupt(\"return\",!0);case 15:if(!(f===!1)){t.next=37;break}t.next=18;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"lthash first time inconsistent. scratchLtHash: \"+j+\", cachedLtHash: \"+k+\", context: \"+c));case 18:t.next=20;return b(\"regeneratorRuntime\").awrap(M(a,300));case 20:m=t.sent;n=m.isLtHashConsistent;o=m.scratchLtHash;p=m.cachedLtHash;q=o==null?\"\":d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(o).slice(-16);r=p==null?\"\":d(\"WASyncdCryptoUtils\").arrayBufferToHexPadded(p).slice(-16);s=n==null?\"[undefined]\":(!n).toString();t.next=29;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"lthash inconsistency second run. is inconsistent? \"+s+\" scratchLtHash: \"+q+\", cachedLtHash: \"+r+\", context: \"+c));case 29:t.next=31;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().printSyncdLog());case 31:t.next=33;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").updateIsCollectionLthashInconsistentInTransaction(a));case 33:d(\"WALogger\").ERROR(i(),a).verbose().sendLogs(\"syncd: lthash inconsistent\",0);return t.abrupt(\"return\",!0);case 37:if(!(f===!0)){t.next=41;break}t.next=40;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"lthash consistent. scratchLtHash: \"+j+\", cachedLtHash: \"+k+\", context: \"+c));case 40:return t.abrupt(\"return\",!1);case 41:t.next=43;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"lthash unknown if consistent. scratchLtHash: \"+j+\", cachedLtHash: \"+k+\", context: \"+c));case 43:return t.abrupt(\"return\",void 0);case 44:case\"end\":return t.stop()}},null,this)}g.SyncdPatchDirection=F;g.computeLtHashAndValidateSnapshot=a;g.computeLtHashAndValidatePatch=c;g.computeOutgoingSnapshotAndPatchMacs=e;g.computeLtHash=L;g.checkLtHash=M;g.logMacsInSnapshot=P;g.reportCollectionInconsistency=f}),98);\n__d(\"WASyncdCollectionHandlerTypesConverter\",[\"WAServerSync.pb\",\"WASyncAction.pb\",\"decodeProtobuf\",\"encodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a){a=d(\"decodeProtobuf\").decodeProtobuf(d(\"WASyncAction.pb\").SyncActionValueSpec,a);return d(\"encodeProtobuf\").encodeProtobuf(d(\"WASyncAction.pb\").SyncActionDataSpec,{value:a}).readBuffer()}function a(a,b){return a.map(function(a){var c=h(a.binarySyncAction);return{index:a.index,action:a.action,binarySyncData:c,actionState:b,version:a.version,keyId:a.keyId,indexMac:a.indexMac,valueMac:a.valueMac,collection:a.collection,timestamp:a.timestamp}})}function b(a,b,c,d,e){return{index:a.index,binarySyncData:a.binarySyncData,version:a.version,keyId:a.keyId,indexMac:a.indexMac,valueMac:a.valueMac,collection:a.collection,timestamp:a.timestamp,action:c,actionState:b,modelId:d,modelType:e!=null?e:void 0}}function c(a){return a.map(function(a){return{collection:a.collection,index:a.index,action:a.action,indexMac:a.indexMac,keyId:a.keyId,operation:d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET,binarySyncData:a.binarySyncData,valueMac:a.valueMac,version:a.version}})}g.syncActionToSyncData=h;g.encryptedUploadMutationsToSyncActions=a;g.setMutationToSyncAction=b;g.syncActionsToDecryptedMutation=c}),98);\n__d(\"WASyncdCollectionUtils\",[\"WASyncdConst\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return a==null}function b(a){switch(a){case d(\"WASyncdConst\").CollectionName.CriticalBlock:return!0;case d(\"WASyncdConst\").CollectionName.CriticalUnblockLow:return!0;case d(\"WASyncdConst\").CollectionName.Regular:return!1;case d(\"WASyncdConst\").CollectionName.RegularHigh:return!1;case d(\"WASyncdConst\").CollectionName.RegularLow:return!1}}g.isBootstrap=a;g.isCriticalCollection=b}),98);\n__d(\"WASyncdDecode\",[\"WAServerSync.pb\",\"WASyncAction.pb\",\"WASyncdError\",\"WASyncdMetricFatalError\",\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){try{return d(\"decodeProtobuf\").decodeProtobuf(d(\"WAServerSync.pb\").ExternalBlobReferenceSpec,b)}catch(b){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"external blob reference protobuf deserialization failed\")}}function b(a,b){try{return d(\"decodeProtobuf\").decodeProtobuf(d(\"WAServerSync.pb\").SyncdSnapshotSpec,b)}catch(b){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"snapshot protobuf deserialization failed\")}}function c(a,b){try{return d(\"decodeProtobuf\").decodeProtobuf(d(\"WAServerSync.pb\").SyncdPatchSpec,b)}catch(b){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.PATCH_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"patch protobuf deserialization failed\")}}function e(a,b){try{return d(\"decodeProtobuf\").decodeProtobuf(d(\"WAServerSync.pb\").SyncdMutationsSpec,b)}catch(b){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"mutations protobuf deserialization failed\")}}function f(a,b){try{return d(\"decodeProtobuf\").decodeProtobuf(d(\"WASyncAction.pb\").SyncActionDataSpec,b)}catch(b){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"action data protobuf deserialization failed\")}}g.decodeExternalBlobReference=a;g.decodeSyncdSnapshot=b;g.decodeSyncdPatch=c;g.decodeSyncdMutations=e;g.decodeSyncActionData=f}),98);\n__d(\"WASyncdValidateSyncActionProtobuf\",[\"WASyncdError\",\"WASyncdMetricFatalError\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){function a(){}a.validateSyncActionDataProtobuf=function(a,b){var c=b.index,e=b.value,f=b.padding;b=b.version;if(!c){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_ACTION_INDEX,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing action index\")}if(b==null){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_ACTION_VERSION,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing action version\")}return{index:c,value:e,padding:f,version:b}};return a}();g[\"default\"]=a}),98);\n__d(\"WASyncdDecryptMutations\",[\"Promise\",\"WABaseGlobals\",\"WACryptoUtils\",\"WAServerSync.pb\",\"WASyncdCrypto\",\"WASyncdCryptoConst\",\"WASyncdCryptoUtils\",\"WASyncdDecode\",\"WASyncdError\",\"WASyncdKeyCache\",\"WASyncdMetricFatalError\",\"WASyncdValidateSyncActionProtobuf\",\"WATextEncoding\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=d(\"WATextEncoding\").newTextDecoder();function a(a,c){return(h||(h=b(\"Promise\"))).all(c.records.map(function(b){return j(a,d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET,b)}))}function e(a,c){return(h||(h=b(\"Promise\"))).all(c.mutations.map(function(b){return j(a,b.operation,b.record)}))}function j(a,c,e){var f,g,h,j,l,m,n,o,p;return b(\"regeneratorRuntime\").async(function(q){while(1)switch(q.prev=q.next){case 0:f=e.keyId.id;q.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdKeyCache\").getKeyData(f));case 3:g=q.sent;if(g){q.next=10;break}if(!(c===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.REMOVE)){q.next=9;break}q.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"exception: no key data for remove mutations\"));case 8:throw new(d(\"WASyncdError\").SyncdFatalError)(\"no key data for remove mutations\");case 9:throw new(d(\"WASyncdError\").SyncdMissingKeyError)();case 10:q.next=12;return b(\"regeneratorRuntime\").awrap(k(a,f,g,c,e));case 12:h=q.sent;j=h.syncAction;l=h.indexMac;m=h.valueMac;n=h.indexValueBinary;o=j.index,p=j.version;return q.abrupt(\"return\",{index:i.decode(o),action:null,version:p,keyId:f,operation:c,indexMac:l,valueMac:m,collection:a,binarySyncData:n});case 19:case\"end\":return q.stop()}},null,this)}function k(a,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;return b(\"regeneratorRuntime\").async(function(A){while(1)switch(A.prev=A.next){case 0:i=h.index.blob;j=h.value.blob;k=d(\"WASyncdCrypto\").valueMacFromIndexAndValueCipherText(j);l=d(\"WASyncdCryptoUtils\").split(j,d(\"WASyncdCryptoConst\").IV_LENGTH,j.byteLength-d(\"WASyncdCryptoConst\").MAC_LENGTH-d(\"WASyncdCryptoConst\").IV_LENGTH);m=l[0];n=l[1];o=l[2];A.next=9;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generateEncryptionKeys(f));case 9:p=A.sent;q=p.indexKey,r=p.valueEncryptionKey,s=p.valueMacKey;t=d(\"WASyncdCryptoUtils\").combine([m,n]);u=d(\"WASyncdCrypto\").generateAssociatedData(g,e);A.next=15;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generateMac(u,t,s));case 15:v=A.sent;if(d(\"WACryptoUtils\").arrayBuffersEqual(o,v)){A.next=19;break}d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.DECRYPTION_FAILED,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"decryption failure: valueMAC mismatch\");case 19:A.next=21;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").decryptCipherText(new Uint8Array(m),r,n));case 21:w=A.sent;x=d(\"WASyncdDecode\").decodeSyncActionData(a,w);y=c(\"WASyncdValidateSyncActionProtobuf\").validateSyncActionDataProtobuf(a,x);A.next=26;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generateIndexMac(q,y.index));case 26:z=A.sent;if(d(\"WACryptoUtils\").arrayBuffersEqual(i,z)){A.next=30;break}d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.DECRYPTION_FAILED,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"decryption failure: indexMAC mismatch\");case 30:return A.abrupt(\"return\",{syncAction:y,indexMac:i,valueMac:k,indexValueBinary:w});case 31:case\"end\":return A.stop()}},null,this)}g.tryDecryptSnapshot=a;g.tryDecryptPatch=e}),98);\n__d(\"WASyncdGetActionHandler\",[\"WABaseGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=null,i=null;function a(a){h==null&&(h=new Map(d(\"WABaseGlobals\").getConfig().syncdActionHandlers().map(function(a){return[a.getAction(),a]})));return h.get(a)}function b(){i==null&&(i=Math.max.apply(Math,d(\"WABaseGlobals\").getConfig().syncdActionHandlers().map(function(a){return a.getVersion()})));return i}g.getActionHandler=a;g.maxSupportedVersion=b}),98);\n__d(\"WAAsyncSleep\",[\"Promise\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f){\"use strict\";var g;function a(a,c,d){return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:c===void 0&&(c=200);d===void 0&&(d=200);if(!(a>0&&a%c===0)){e.next=5;break}e.next=5;return b(\"regeneratorRuntime\").awrap(h(d));case 5:case\"end\":return e.stop()}},null,this)}function h(a){return new(g||(g=b(\"Promise\")))(function(b){return setTimeout(b,a)})}f.asyncSleepAfterGivenLoopIteration=a;f.asyncSleep=h}),66);\n__d(\"WASyncdStoreMissingKeys\",[\"Promise\",\"WAAsyncSleep\",\"WABaseGlobals\",\"WAGetMissingKey\",\"WAGetSyncKey\",\"WALogger\",\"WASyncdCryptoUtils\",\"WASyncdMetricFatalError\",\"WATimeUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: fatal error: missing key on all clients\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: expired keys: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: actually missing keys: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing keys: \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: all keys: \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: check if has expired keys\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: fatal error: timeout while waiting for missing key\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: _timeoutWhileWaitingForMissingKey: no expired keys\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: _timeoutWhileWaitingForMissingKey\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: earliest missing key: \",\", timestamp=\",\", timeoutMs=\",\"\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: _setMissingKeyTimeout: missing keys: \",\"\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: updateMissingKeys: finish updating missing keys from device \",\"\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: updateMissingKeys: begin updating missing keys from device \",\"\\n      \\tmissingKeys: [\",\"]\"],[\"syncd: updateMissingKeys: begin updating missing keys from device \",\"\\n      \\\\tmissingKeys: [\",\"]\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: updateMissingKeys from device \",\"\\n    \\tkeys with keyData: \",\"\\n    \\tkeys without keyData: \",\"\"],[\"syncd: updateMissingKeys from device \",\"\\n    \\\\tkeys with keyData: \",\"\\n    \\\\tkeys without keyData: \",\"\"]);v=function(){return a};return a}var w;function a(){var a;return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().getDeviceFingerprint());case 2:a=c.sent.deviceIndexes;return c.abrupt(\"return\",d(\"WABaseGlobals\").runInTransaction({MissingKeyStore:!0},function(c){var d,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:d=c.MissingKeyStore;f.next=3;return b(\"regeneratorRuntime\").awrap(d.getAll());case 3:e=f.sent;if(!(e.length===0)){f.next=6;break}return f.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve());case 6:e.forEach(function(b){var c=b.deviceResponses;c.forEach(function(c,d){a.includes(d)||b.deviceResponses[\"delete\"](d)})});f.next=9;return b(\"regeneratorRuntime\").awrap(d.bulkUpdate(e));case 9:f.next=11;return b(\"regeneratorRuntime\").awrap(B({MissingKeyStore:d}));case 11:case\"end\":return f.stop()}},null,this)}));case 4:case\"end\":return c.stop()}},null,this)}function c(a,c){var e=[],f=[];a.forEach(function(a){var b=a.keyData;a=d(\"WASyncdCryptoUtils\").syncKeyIdToHex(a.keyId);b?e.push(a):f.push(a)});d(\"WALogger\").LOG(v(),c,e,f);return d(\"WABaseGlobals\").runInTransaction({MissingKeyStore:!0},function(a){var g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:g=a.MissingKeyStore;if(!(e.length>0)){i.next=6;break}i.next=4;return b(\"regeneratorRuntime\").awrap(g.bulkRemove(e));case 4:i.next=6;return b(\"regeneratorRuntime\").awrap(y({MissingKeyStore:g}));case 6:if(!(f.length>0)){i.next=18;break}i.next=9;return b(\"regeneratorRuntime\").awrap(g.bulkGet(f));case 9:i.t0=Boolean;h=i.sent.filter(i.t0);h.forEach(function(a){return a.deviceResponses.set(c,!1)});d(\"WALogger\").LOG(u(),c,f);i.next=15;return b(\"regeneratorRuntime\").awrap(g.bulkUpdate(h));case 15:d(\"WALogger\").LOG(t(),c);i.next=18;return b(\"regeneratorRuntime\").awrap(B({MissingKeyStore:g}));case 18:case\"end\":return i.stop()}},null,this)})}function x(){return d(\"WABaseGlobals\").runInTransaction({MissingKeyStore:!0},function(a){a=a.MissingKeyStore;return y({MissingKeyStore:a})})}function y(a){var c,e,f,g;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:c=a.MissingKeyStore;clearTimeout(w);w=null;h.next=5;return b(\"regeneratorRuntime\").awrap(c.getAll());case 5:e=h.sent;if(!(e.length===0)){h.next=8;break}return h.abrupt(\"return\");case 8:d(\"WALogger\").LOG(s(),e.map(function(a){return d(\"WASyncdCryptoUtils\").syncKeyIdToHex(a.keyId)})),f=e.reduce(function(a,b){return a.timestamp<b.timestamp?a:b}),g=d(\"WABaseGlobals\").getConfig().syncdWaitForKeyTimeoutDays()*d(\"WATimeUtils\").DAY_MILLISECONDS-(-f.timestamp+d(\"WATimeUtils\").unixTimeMs()),d(\"WALogger\").LOG(r(),d(\"WASyncdCryptoUtils\").syncKeyIdToHex(f.keyId),f.timestamp,g),w=setTimeout(z,g);case 13:case\"end\":return h.stop()}},null,this)}function z(){return b(\"regeneratorRuntime\").async(function(a){while(1)switch(a.prev=a.next){case 0:d(\"WALogger\").LOG(q());a.next=3;return b(\"regeneratorRuntime\").awrap(A());case 3:if(a.sent){a.next=6;break}d(\"WALogger\").LOG(p());return a.abrupt(\"return\");case 6:d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY),d(\"WALogger\").ERROR(o()).sendLogs(\"syncd fatal error: timeout while waiting for missing key\"),d(\"WABaseGlobals\").getDbImpls().handleSyncdFatal();case 9:case\"end\":return a.stop()}},null,this)}function A(){var a,c,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:d(\"WALogger\").LOG(n());g.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncKey\").getAllSyncKeysInTransaction());case 3:g.t0=function(a){return d(\"WASyncdCryptoUtils\").syncKeyIdToHex(a.keyId)};a=g.sent.map(g.t0);d(\"WALogger\").LOG(m(),a);g.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WAGetMissingKey\").getAllMissingKeysInTransaction());case 8:c=g.sent;d(\"WALogger\").LOG(l(),c.map(function(a){return d(\"WASyncdCryptoUtils\").syncKeyIdToHex(a.keyId)}));e=c.filter(function(b){return!a.includes(b.keyHex)});d(\"WALogger\").LOG(k(),c.map(function(a){return d(\"WASyncdCryptoUtils\").syncKeyIdToHex(a.keyId)}));f=e.filter(function(a){return d(\"WABaseGlobals\").getConfig().syncdWaitForKeyTimeoutDays()*d(\"WATimeUtils\").DAY_MILLISECONDS<d(\"WATimeUtils\").unixTimeMs()-a.timestamp});d(\"WALogger\").LOG(j(),f.map(function(a){return d(\"WASyncdCryptoUtils\").syncKeyIdToHex(a.keyId)}));return g.abrupt(\"return\",f.length>0);case 15:case\"end\":return g.stop()}},null,this)}function B(a){var c,e,f,g,h,j,k,l,m,n,o,p,q;return b(\"regeneratorRuntime\").async(function(r){while(1)switch(r.prev=r.next){case 0:c=a.MissingKeyStore;r.next=3;return b(\"regeneratorRuntime\").awrap(c.getAll());case 3:e=r.sent,(f=e,g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]());case 5:if(!g){r.next=11;break}if(!(h>=f.length)){r.next=8;break}return r.abrupt(\"break\",43);case 8:j=f[h++];r.next=15;break;case 11:h=f.next();if(!h.done){r.next=14;break}return r.abrupt(\"break\",43);case 14:j=h.value;case 15:k=j,l=!0,(m=k.deviceResponses.values(),n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]());case 18:if(!n){r.next=24;break}if(!(o>=m.length)){r.next=21;break}return r.abrupt(\"break\",34);case 21:p=m[o++];r.next=28;break;case 24:o=m.next();if(!o.done){r.next=27;break}return r.abrupt(\"break\",34);case 27:p=o.value;case 28:q=p;if(!(q==null)){r.next=32;break}l=!1;return r.abrupt(\"break\",34);case 32:r.next=18;break;case 34:if(!l){r.next=41;break}d(\"WALogger\").ERROR(i()).sendLogs(\"syncd: fatal error: missing key on all clients\");d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_KEY_ON_ALL_CLIENTS);r.next=39;return b(\"regeneratorRuntime\").awrap(d(\"WAAsyncSleep\").asyncSleep(5e3));case 39:d(\"WABaseGlobals\").getDbImpls().handleSyncdFatal();return r.abrupt(\"return\");case 41:r.next=5;break;case 43:case\"end\":return r.stop()}},null,this)}function e(a,c){var e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:e=function(){var a=new Map();c.forEach(function(b){return a.set(b,null)});return a};f=a.map(function(a){return{keyHex:d(\"WASyncdCryptoUtils\").syncKeyIdToHex(a),keyId:a,timestamp:d(\"WATimeUtils\").unixTimeMs(),deviceResponses:e()}});g.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WAGetMissingKey\").bulkUpdateMissingKeysInTransaction(f));case 4:g.next=6;return b(\"regeneratorRuntime\").awrap(x());case 6:case\"end\":return g.stop()}},null,this)}g.updateMissingKeyDevices=a;g.updateMissingKeys=c;g.setMissingKeyTimeoutInTransaction=x;g.hasExpiredKeys=A;g.addMissingKeys=e}),98);\n__d(\"WASyncdHandleMissingKeys\",[\"Promise\",\"WABaseGlobals\",\"WAGetMissingKey\",\"WAGetSyncKey\",\"WALogger\",\"WASyncdCryptoUtils\",\"WASyncdError\",\"WASyncdKeyTypes\",\"WASyncdStoreMissingKeys\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: requestAllMissingKeys: missing keys: [\",\"]\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: _handleMissingKeys: missing keys after filter: [\",\"]\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: _handleMissingKeys: missing keys [\",\"]\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: _handleMissingKeys: skipping due to resume from restart in progress\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: collection \",\"'s patches has missing keys \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: handleMissingKeysInPatches: missing key: keyId: \",\", patch version: \",\", patch device id: \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: collection \",\"'s snapshot has missing keys \",\"\"]);o=function(){return a};return a}var p=d(\"WASyncdKeyTypes\").toSyncKeyId(new ArrayBuffer(0));function a(a,c){var e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:e=new Set();g.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncKey\").getAllSyncKeysInTransaction());case 3:g.t0=function(a){return d(\"WASyncdCryptoUtils\").syncKeyIdToHex(a.keyId)};f=g.sent.map(g.t0);c.records.forEach(function(a){a=a.keyId.id;if(d(\"WASyncdCryptoUtils\").syncKeyIdsEqual(a,p))throw new(d(\"WASyncdError\").SyncdFatalError)(\"snapshot has empty key\");a=d(\"WASyncdCryptoUtils\").syncKeyIdToHex(a);f.includes(a)||e.add(a)});d(\"WALogger\").LOG(o(),a,Array.from(e));g.next=9;return b(\"regeneratorRuntime\").awrap(q(e));case 9:case\"end\":return g.stop()}},null,this)}function c(a,c){var e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:e=new Set();g.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncKey\").getAllSyncKeysInTransaction());case 3:g.t0=function(a){return d(\"WASyncdCryptoUtils\").syncKeyIdToHex(a.keyId)};f=g.sent.map(g.t0);c.forEach(function(a){var b=a.keyId.id;if(d(\"WASyncdCryptoUtils\").syncKeyIdsEqual(b,p))throw new(d(\"WASyncdError\").SyncdFatalError)(\"syncd: patch has empty key. patch device id: ${p.deviceIndex}\");b=d(\"WASyncdCryptoUtils\").syncKeyIdToHex(b);f.includes(b)||(d(\"WALogger\").LOG(n(),b,a.version.version,a.deviceIndex),e.add(b))});d(\"WALogger\").LOG(m(),a,Array.from(e));g.next=9;return b(\"regeneratorRuntime\").awrap(q(e));case 9:case\"end\":return g.stop()}},null,this)}function q(a){var c,e,f,g,i;return b(\"regeneratorRuntime\").async(function(m){while(1)switch(m.prev=m.next){case 0:if(!(d(\"WABaseGlobals\").getConfig().offlineProcessingState()!==\"idle\")){m.next=3;break}d(\"WALogger\").LOG(l());return m.abrupt(\"return\");case 3:c=Array.from(a);d(\"WALogger\").LOG(k(),c);m.t0=Set;m.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WAGetMissingKey\").bulkGetMissingKeysInTransaction(c));case 8:m.t1=Boolean;m.t2=function(a){return a.keyHex};m.t3=m.sent.filter(m.t1).map(m.t2);e=new m.t0(m.t3);f=c.filter(function(a){return!e.has(a)});d(\"WALogger\").LOG(j(),f);if(!(f.length===0)){m.next=16;break}return m.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve());case 16:g=f.map(function(a){return d(\"WASyncdKeyTypes\").toSyncKeyId(d(\"WASyncdCryptoUtils\").hexToUint8Array(a).buffer)});m.next=19;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().sendSyncdKeyRequest(g));case 19:i=m.sent;m.next=22;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdStoreMissingKeys\").addMissingKeys(g,i));case 22:case\"end\":return m.stop()}},null,this)}function e(){var a;return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAGetMissingKey\").getAllMissingKeysInTransaction());case 2:a=c.sent;d(\"WALogger\").LOG(i(),a.map(function(a){return a.keyHex}));if(!(a.length===0)){c.next=6;break}return c.abrupt(\"return\");case 6:c.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().sendSyncdKeyRequest(a.map(function(a){return a.keyId})));case 8:case\"end\":return c.stop()}},null,this)}g.handleMissingKeysInSnapshot=a;g.handleMissingKeysInPatches=c;g.requestAllMissingKeys=e}),98);\n__d(\"WASyncdValidateServerSyncProtobuf\",[\"WABaseGlobals\",\"WALongInt\",\"WASyncAction.pb\",\"WASyncdError\",\"WASyncdKeyTypes\",\"WASyncdMetricFatalError\",\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){function a(){}a.validateSnapshotProtobuf=function(b,c){var e=c.version,f=c.records,g=c.mac;c=c.keyId;var h=e==null?void 0:e.version;if(!e||h==null){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_SNAPSHOT_VERSION,b);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing snapshot version\")}e=f.map(function(c){return a.validateRecordProtobuf(b,c)});if(!g){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_SNAPSHOT_MAC,b);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing snapshot mac\")}f=a.validateKeyIdProtobuf(b,c,d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_SNAPSHOT_KEY_ID);return{version:{version:d(\"WALongInt\").numberOrThrowIfTooLarge(h)},records:e,mac:g,keyId:f}};a.validatePatchProtobuf=function(b,c){var e=c.version,f=c.mutations,g=c.externalMutations,h=c.snapshotMac,i=c.patchMac,j=c.keyId,k=c.exitCode,l=c.deviceIndex;c=c.clientDebugData;var m=e==null?void 0:e.version;if(!e||m==null){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_PATCH_VERSION,b);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing patch version\")}if(f&&f.length>0&&g){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS,b);throw new(d(\"WASyncdError\").SyncdFatalError)(\"patch with both inline and external mutations\")}if(!h){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_PATCH_SNAPSHOT_MAC,b);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing patch snapshot mac\")}if(!i){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_PATCH_MAC,b);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing patch mac\")}e=a.validateKeyIdProtobuf(b,j,d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_PATCH_KEY_ID);j=void 0;var n=d(\"WABaseGlobals\").getConfig().syncdShouldParsePatchDebugData();c!=null&&n&&(j=d(\"decodeProtobuf\").decodeProtobuf(d(\"WASyncAction.pb\").PatchDebugDataSpec,c));if(g){n=a.validateExternalBlobReference(b,g);return{version:{version:d(\"WALongInt\").numberOrThrowIfTooLarge(m)},mutations:void 0,externalMutations:n,snapshotMac:h,patchMac:i,keyId:e,deviceIndex:l,clientDebugData:j}}c=f.map(function(c){return a.validateMutationProtobuf(b,c)});return{version:{version:d(\"WALongInt\").numberOrThrowIfTooLarge(m)},mutations:c,externalMutations:void 0,exitCode:k,snapshotMac:h,patchMac:i,keyId:e,deviceIndex:l,clientDebugData:j}};a.validateExternalBlobReference=function(a,b){var c=b.mediaKey,e=b.directPath,f=b.handle,g=b.fileSizeBytes,h=b.fileSha256;b=b.fileEncSha256;if(!c){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing external blob reference media key\")}if(e==null){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing external blob reference direct path\")}if(!h){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing external blob reference file SHA256\")}if(!b){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing external blob reference file enc SHA256\")}return{mediaKey:c,directPath:e,handle:f,fileSizeBytes:g,fileSha256:h,fileEncSha256:b}};a.validateMutationProtobuf=function(b,c){var e=c.operation;c=c.record;if(e==null){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_MUTATION_OPERATION,b);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing mutation operation\")}if(!c){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_MUTATION_RECORD,b);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing mutation record\")}b=a.validateRecordProtobuf(b,c);return{operation:e,record:b}};a.validateRecordProtobuf=function(b,c){var e=c.index,f=c.value;c=c.keyId;var g=e==null?void 0:e.blob,h=f==null?void 0:f.blob;if(!e||!g){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_MUTATION_INDEX,b);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing mutation index\")}if(!f||!h){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_MUTATION_VALUE,b);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing mutation value\")}e=a.validateKeyIdProtobuf(b,c,d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_MUTATION_KEY_ID);return{index:{blob:g},value:{blob:h},keyId:e}};a.validateKeyIdProtobuf=function(a,b,c){var e=b==null?void 0:b.id;if(!b||!e){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(c,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing mutation key id\")}return{id:d(\"WASyncdKeyTypes\").toSyncKeyId(e)}};return a}();g[\"default\"]=a}),98);\n__d(\"WASyncdMMSDownload\",[\"WABaseGlobals\",\"WASyncdDecode\",\"WASyncdValidateServerSyncProtobuf\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,e){var f,g;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().downloadSyncBlob(e,\"snapshot\",a));case 2:f=h.sent;g=d(\"WASyncdDecode\").decodeSyncdSnapshot(a,f);return h.abrupt(\"return\",c(\"WASyncdValidateServerSyncProtobuf\").validateSnapshotProtobuf(a,g));case 5:case\"end\":return h.stop()}},null,this)}function e(a,e){var f,g;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().downloadSyncBlob(e,\"patch\",a));case 2:f=h.sent;g=d(\"WASyncdDecode\").decodeSyncdMutations(a,f).mutations;return h.abrupt(\"return\",g.map(function(b){return c(\"WASyncdValidateServerSyncProtobuf\").validateMutationProtobuf(a,b)}));case 5:case\"end\":return h.stop()}},null,this)}g.downloadSnapshot=a;g.downloadExternalPatch=e}),98);\n\/**\n * License: https:\/\/www.facebook.com\/legal\/license\/MDzNl_j9yvg\/\n *\/\n__d(\"toposort-1.0.3\",[],(function(a,b,c,d,e,f){\"use strict\";a={};var g={exports:a};function h(){g.exports=a=function(a){return b(c(a),a)};a.array=b;function b(a,b){var c=a.length,d=new Array(c),e={},f=c;while(f--)e[f]||g(a[f],f,[]);return d;function g(h,f,i){if(i.indexOf(h)>=0)throw new Error(\"Cyclic dependency: \"+JSON.stringify(h));if(!~a.indexOf(h))throw new Error(\"Found unknown node. Make sure to provided all involved nodes. Unknown node: \"+JSON.stringify(h));if(e[f])return;e[f]=!0;var j=b.filter(function(a){return a[0]===h});if(f=j.length){i=i.concat(h);do{var k=j[--f][1];g(k,a.indexOf(k),i)}while(f)}d[--c]=h}}function c(a){var b=[];for(var c=0,d=a.length;c<d;c++){var e=a[c];b.indexOf(e[0])<0&&b.push(e[0]);b.indexOf(e[1])<0&&b.push(e[1])}return b}}var i=!1;function j(){i||(i=!0,h());return g.exports}function b(a){switch(a){case void 0:return j()}}e.exports=b}),null);\n__d(\"toposort\",[\"toposort-1.0.3\"],(function(a,b,c,d,e,f){e.exports=b(\"toposort-1.0.3\")()}),null);\n__d(\"WASyncdToposortCrossIndex\",[\"WASyncdError\",\"WASyncdMetricFatalError\",\"toposort\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=new Map();function a(a){i();var b=[],e=[];try{a.forEach(function(c){b.push(c);var d=h.get(c.actionName);if(d==null)return;a.forEach(function(a){a!==c&&d.includes(a.actionName)&&j(a,c)&&(a.timestamp<c.timestamp?e.push([a,c]):e.push([c,a]))})});return c(\"toposort\").array(b,e)}catch(a){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.CYCLIC_MUTATION_DEPENDENCY_IN_PATCH);throw new(d(\"WASyncdError\").SyncdFatalError)(\"cyclic mutation dependency in patch\")}}function i(){}function b(a,b){h.set(a,b)}function j(a,b){a=a.actionHandler.getChatJidAndMessageKey(a);b=b.actionHandler.getChatJidAndMessageKey(b);return a&&b?a.chatJid===b.chatJid&&(a.messageKey==null||b.messageKey==null||a.messageKey===b.messageKey):!1}g.sort=a;g._setDependency=b}),98);\n__d(\"WASyncdResolveConflict\",[\"Promise\",\"WAGetPendingMutation\",\"WASyncdConst\",\"WASyncdToposortCrossIndex\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(a,c){var d,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(a.map(function(a){var d,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:d=c.get(a.index);if(!d){f.next=8;break}e=a.actionHandler;f.t0=a.index;f.next=6;return b(\"regeneratorRuntime\").awrap(e.resolveConflicts(d,a));case 6:f.t1=f.sent;return f.abrupt(\"return\",{remoteMutationIndex:f.t0,conflictResolutionState:f.t1});case 8:case\"end\":return f.stop()}},null,this)})));case 2:d=f.sent;e=new Map();d.forEach(function(a){a&&e.set(a.remoteMutationIndex,a.conflictResolutionState)});return f.abrupt(\"return\",e);case 6:case\"end\":return f.stop()}},null,this)}function a(a,c){var e,f,g,h,j,k,l,m,n,o,p;return b(\"regeneratorRuntime\").async(function(q){while(1)switch(q.prev=q.next){case 0:e=[];f=[];q.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WAGetPendingMutation\").getSyncPendingMutationsByCollectionInTransaction(a));case 4:g=q.sent;h=new Map(g.map(function(a){return[a.index,a]}));q.next=8;return b(\"regeneratorRuntime\").awrap(i(c,h));case 8:j=q.sent,c.forEach(function(a){var b=j.get(a.index);if(b)switch(b){case d(\"WASyncdConst\").ConflictResolutionState.SkipRemote:break;case d(\"WASyncdConst\").ConflictResolutionState.ApplyRemoteAndDropLocal:e.push(a);f=f.concat(g.filter(function(b){return b.index===a.index}));break;case d(\"WASyncdConst\").ConflictResolutionState.SkipRemoteAndDropLocal:f=f.concat(g.filter(function(b){return b.index===a.index}));break}else e.push(a)}),k=d(\"WASyncdToposortCrossIndex\").sort(e),l=[],m=0;case 13:if(!(m<k.length)){q.next=22;break}n=k[m].actionHandler;q.next=17;return b(\"regeneratorRuntime\").awrap(n.dropMutationDueToCrossIndexConflict(k[m],h));case 17:o=q.sent,o||l.push(k[m]);case 19:m++;q.next=13;break;case 22:p=f.map(function(a){return a.id}).filter(Boolean);return q.abrupt(\"return\",{remoteMutationsToApply:l,pendingMutationsToDrop:p});case 24:case\"end\":return q.stop()}},null,this)}g.resolveConflict=a}),98);\n__d(\"WASyncdValidateMutations\",[\"WALogger\",\"WALongInt\",\"WAServerSync.pb\",\"WASyncAction.pb\",\"WASyncdConst\",\"WASyncdError\",\"WASyncdMetricFatalError\",\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"validation not required for local mutations\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: duplicate \",\" mutation: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: duplicate \",\" mutation: \",\"\"]);j=function(){return a};return a}function a(a,b){var c=new Set();b.forEach(function(b){b=b.version.version;if(c.has(b)){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.DUPLICATE_PATCH_VERSION_IN_COLLECTION,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"duplicate patch version in collection\")}c.add(b)})}function k(a){return a==null?!0:[d(\"WASyncdConst\").Actions.Agent,d(\"WASyncdConst\").Actions.AndroidUnsupportedActions,d(\"WASyncdConst\").Actions.Archive,d(\"WASyncdConst\").Actions.BotWelcomeRequest,d(\"WASyncdConst\").Actions.ChatAssignment,d(\"WASyncdConst\").Actions.ChatAssignmentOpenedStatus,d(\"WASyncdConst\").Actions.ChatLockSettings,d(\"WASyncdConst\").Actions.ClearChat,d(\"WASyncdConst\").Actions.Contact,d(\"WASyncdConst\").Actions.CustomPaymentMethods,d(\"WASyncdConst\").Actions.DeleteChat,d(\"WASyncdConst\").Actions.DeleteMessageForMe,d(\"WASyncdConst\").Actions.DeviceCapabilities,d(\"WASyncdConst\").Actions.DisableLinkPreviews,d(\"WASyncdConst\").Actions.ExternalWebBeta,d(\"WASyncdConst\").Actions.FavoriteSticker,d(\"WASyncdConst\").Actions.LabelEdit,d(\"WASyncdConst\").Actions.LabelJid,d(\"WASyncdConst\").Actions.LabelMessage,d(\"WASyncdConst\").Actions.LabelReordering,d(\"WASyncdConst\").Actions.LocaleSetting,d(\"WASyncdConst\").Actions.LockChat,d(\"WASyncdConst\").Actions.MarkChatAsRead,d(\"WASyncdConst\").Actions.MarketingMessage,d(\"WASyncdConst\").Actions.MarketingMessageBroadcast,d(\"WASyncdConst\").Actions.Mute,d(\"WASyncdConst\").Actions.Nux,d(\"WASyncdConst\").Actions.PaymentInfo,d(\"WASyncdConst\").Actions.Pin,d(\"WASyncdConst\").Actions.PinDEPRECATED,d(\"WASyncdConst\").Actions.PnForLidChat,d(\"WASyncdConst\").Actions.PrimaryFeature,d(\"WASyncdConst\").Actions.PrimaryVersion,d(\"WASyncdConst\").Actions.QuickReply,d(\"WASyncdConst\").Actions.RemoveRecentSticker,d(\"WASyncdConst\").Actions.Sentinel,d(\"WASyncdConst\").Actions.SettingPushName,d(\"WASyncdConst\").Actions.ShareOwnPn,d(\"WASyncdConst\").Actions.Star,d(\"WASyncdConst\").Actions.StatusPrivacy,d(\"WASyncdConst\").Actions.Subscription,d(\"WASyncdConst\").Actions.TimeFormat,d(\"WASyncdConst\").Actions.UnarchiveChatsSetting,d(\"WASyncdConst\").Actions.UserStatusMute].includes(a)}function l(a){var b=d(\"WASyncdConst\").Actions.cast(JSON.parse(a.index)[0]),c=a.operation===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET?\"SET\":\"REMOVE\";k(b)&&d(\"WALogger\").LOG(j(),c,b);d(\"WALogger\").DEV(i(),c,a.index)}function b(a,b,c){var e=new Set(),f=new Set();b.forEach(function(b){var g=!1;b.operation===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET&&(e.has(b.index)?(l(b),g=!0):e.add(b.index));b.operation===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.REMOVE&&(f.has(b.index)?(l(b),g=!0):f.add(b.index));if(g)switch(c){case d(\"WASyncdConst\").SyncDataType.Patch:d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"same index for multiple mutations in patch\");case d(\"WASyncdConst\").SyncDataType.Snapshot:d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"same index for multiple mutations in snapshot\");case d(\"WASyncdConst\").SyncDataType.Local:d(\"WALogger\").WARN(h())}})}function c(a,b){return b.map(function(b){var c=d(\"decodeProtobuf\").decodeProtobuf(d(\"WASyncAction.pb\").SyncActionDataSpec,b.binarySyncData);c=c.value;if(!c){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_ACTION_VALUE,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing action value\")}c=d(\"WALongInt\").maybeNumberOrThrowIfTooLarge(c.timestamp);if(c==null){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MISSING_ACTION_TIMESTAMP,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"missing action timestamp\")}return{index:b.index,version:b.version,keyId:b.keyId,indexMac:b.indexMac,valueMac:b.valueMac,collection:b.collection,binarySyncData:b.binarySyncData,timestamp:c}})}g.validateNoDuplicatePatchVersionInCollection=a;g.validateNoSameIndexForMultipleMutations=b;g.validateAndTypeSetMutations=c}),98);\n__d(\"WASyncdWamAppState\",[\"WAPREList\",\"WAPREMetrics\",\"WAShiftTimer\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=k(),i=new(d(\"WAShiftTimer\").ShiftTimer)(c),j=1e3*60*5;function a(){i.isScheduled()&&i.forceRunNow()}function k(){return{mutationCount:0,invalidActionCount:0,unsupportedActionCount:0,keyRotationRemoveCount:0,storedMutationCount:0,uploadConflictCount:0,unsetActionCount:0,missingKeyCount:0}}function l(){h=k()}function m(a){return{\"int\":babelHelpers[\"extends\"]({},a)}}function b(a){var b;return{mutationCount:(a==null?void 0:(b=a[\"int\"])==null?void 0:b.mutationCount)||0,invalidActionCount:(a==null?void 0:(b=a[\"int\"])==null?void 0:b.invalidActionCount)||0,unsupportedActionCount:(a==null?void 0:(b=a[\"int\"])==null?void 0:b.unsupportedActionCount)||0,keyRotationRemoveCount:(a==null?void 0:(b=a[\"int\"])==null?void 0:b.keyRotationRemoveCount)||0,storedMutationCount:(a==null?void 0:(b=a[\"int\"])==null?void 0:b.storedMutationCount)||0,uploadConflictCount:(a==null?void 0:(b=a[\"int\"])==null?void 0:b.uploadConflictCount)||0,unsetActionCount:(a==null?void 0:(b=a[\"int\"])==null?void 0:b.unsetActionCount)||0,missingKeyCount:(a==null?void 0:(b=a[\"int\"])==null?void 0:b.missingKeyCount)||0}}function c(){var a=m(h);l();d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.APP_STATE_SYNC_DAILY).endSuccess(a)}function n(){i.onOrBefore(j)}function e(a){if(a===0)return;h.mutationCount+=a;n()}function f(a){h.invalidActionCount=a,n()}function o(a){h.unsupportedActionCount=a,n()}function p(a){if(a===0)return;h.keyRotationRemoveCount+=a;n()}function q(a){h.storedMutationCount=a,n()}function r(){h.uploadConflictCount++,n()}function s(a){if(a===0)return;h.unsetActionCount+=a;n()}function t(a){h.missingKeyCount=a,n()}g.forceCommitAppState=a;g.clear=l;g.convertAppStateSyncDailyFromAnnotations=b;g.addMutationCount=e;g.setInvalidActionCount=f;g.setUnsupportedActionCount=o;g.addKeyRotationRemoveCount=p;g.setStoredMutationCount=q;g.incConflict=r;g.addUnsetActionCount=s;g.setMissingKeyCount=t}),98);\n__d(\"WASyncdCollectionHandler\",[\"Promise\",\"WABaseGlobals\",\"WACryptoUtils\",\"WAErr\",\"WAGetCollectionVersion\",\"WAGetMissingKey\",\"WAGetSyncAction\",\"WALogger\",\"WALongInt\",\"WANullthrows\",\"WAServerSync.pb\",\"WASyncAction.pb\",\"WASyncdAntiTampering\",\"WASyncdCollectionHandlerTypesConverter\",\"WASyncdCollectionUtils\",\"WASyncdConst\",\"WASyncdDecryptMutations\",\"WASyncdError\",\"WASyncdGetActionHandler\",\"WASyncdHandleMissingKeys\",\"WASyncdMMSDownload\",\"WASyncdMetricCriticalBootstrapStage\",\"WASyncdMetricFatalError\",\"WASyncdMetrics\",\"WASyncdResolveConflict\",\"WASyncdValidateMutations\",\"WASyncdValidateServerSyncProtobuf\",\"WASyncdWamAppState\",\"WATimeUtils\",\"decodeProtobuf\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: no handler for action \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: invalid action \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: no handler for action \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: invalid action \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: after apply remove mutations for \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: before apply remove mutations for \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: completed apply set mutations for \",\"  \",\"\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: max timestamp from recent patch: \",\" days agp\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: after apply mutation batch for \",\"  \",\"\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: actionStates after apply \",\": \",\"\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"synd: catching error during _applySetMutations: \",\"\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: before apply mutation batch for \",\". mutations count: \",\"  \",\"\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: applying mutations \",\" \",\"\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: completed final transaction in _applyPatch for \",\" v\",\"\"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: processed \",\" mutations in patch version \",\" of collection \",\"\"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: completed _applyRemoveMutations for \",\" v\",\"\"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: completed computeLtHashAndValidatePatch for \",\" v\",\"\"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: \",\": empty patch found\"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: applying patch \",\" v\",\" from device \",\"\\n    SET count: \",\"\\n    REMOVE count: \",\"\"]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: no patches for collection \",\"\"]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: UI is unblocked, waited for \",\"ms\"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: patches have \",\" mutations, wait for UI unblock\"]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: completed applying snapshot for \",\"\"]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: collection \",\"'s snapshot v\",\" applied\"]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: processed \",\" mutations in snapshot of collection \",\" v\",\"\"]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: collection \",\"'s snapshot decrypted\"]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: collection \",\"'s snapshot validated\"]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: start validate \",\"'s snapshot\"]);J=function(){return a};return a}function K(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: \",\"'s external patch downloaded\"]);K=function(){return a};return a}function L(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: download patch for \",\"\"]);L=function(){return a};return a}function M(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: download snapshot for \",\"\"]);M=function(){return a};return a}function N(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: end _uploadSuccessful for \",\"\"]);N=function(){return a};return a}function O(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: _uploadSuccessful: write to db for \",\"\"]);O=function(){return a};return a}function P(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: _uploadSuccessful: unexpected server version (\",\") after patch upload, expected \",\"\"]);P=function(){return a};return a}function Q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\":\\n      lastSuccessfulSyncEndTime = \",\" (\",\" days ago))\\n      lastSyncAttemptStartTimes = \",\"\\n      lastSyncAttemptStartTimes by days ago: \",\"\\n    \"]);Q=function(){return a};return a}function R(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing patch info:\"]);R=function(){return a};return a}function S(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: could not log max timestamp: \",\"\"]);S=function(){return a};return a}function T(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: retryable error: \",\" throws \",\"\"]);T=function(){return a};return a}function U(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: fatal error: \",\" throws \",\"\"]);U=function(){return a};return a}function V(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: key error: \",\" missing keys\"]);V=function(){return a};return a}function W(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: applyAppStateSyncResponse: finished applying \",\" in \",\"ms\"]);W=function(){return a};return a}function X(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: sync \",\" but there are no updates\"]);X=function(){return a};return a}function Y(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: \",\" v\",\" uploaded successfully\"]);Y=function(){return a};return a}function aa(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: \",\" patches applied successfully\"]);aa=function(){return a};return a}function ba(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: has missing patches\"]);ba=function(){return a};return a}function ca(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: has missing patches. collection: \",\", localVersion: \",\",\\n           minPatch: \",\"\"]);ca=function(){return a};return a}function da(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: missing keys: [\",\"]\"]);da=function(){return a};return a}function ea(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: \",\" snapshot and patches applied successfully\"]);ea=function(){return a};return a}function fa(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: start applying collection \",\"\"]);fa=function(){return a};return a}function ga(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: end applyIndividualMutations\"]);ga=function(){return a};return a}function ha(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: end update db after apply individual mutations for collection \",\"\"]);ha=function(){return a};return a}function ia(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: end apply individual mutations for collection \",\"\"]);ia=function(){return a};return a}function ja(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: apply individual mutations for collection \",\"\"]);ja=function(){return a};return a}function ka(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: start applyIndividualMutations\"]);ka=function(){return a};return a}var la=0,ma=new ArrayBuffer(128);function a(a){var c,e,f,g;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!(a.length===0)){i.next=2;break}return i.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve());case 2:c=a.sort(function(a,b){return a.timestamp-b.timestamp});d(\"WALogger\").LOG(ka());e=d(\"WASyncdCollectionHandlerTypesConverter\").syncActionsToDecryptedMutation(c);f=e.reduce(function(a,b){var c;c=(c=a.get(b.collection))!=null?c:[];c.push(b);a.set(b.collection,c);return a},new Map());g=Array.from(f.keys()).map(function(a){var c,e,g,h,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:d(\"WALogger\").LOG(ja(),a);c=f.get(a);if(!(c===void 0)){j.next=4;break}return j.abrupt(\"return\");case 4:j.next=6;return b(\"regeneratorRuntime\").awrap(Z(a,c,d(\"WASyncdConst\").SyncDataType.Local,null));case 6:e=j.sent;g=e.setMutationsToPersist;h=e.pendingMutationsToDrop;i=g.map(function(a){return{action:a.action,actionState:a.actionState,binarySyncData:a.binarySyncData,collection:a.collection,index:a.index,keyId:a.keyId,modelId:a.modelId,modelType:a.modelType,timestamp:a.timestamp,version:a.version}});d(\"WALogger\").LOG(ia(),a);j.next=13;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0},function(a){var c,d;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:c=a.SyncActionStore,d=a.PendingMutationStore;e.next=3;return b(\"regeneratorRuntime\").awrap(c.bulkUpdate(i));case 3:e.next=5;return b(\"regeneratorRuntime\").awrap(d.bulkRemove(h));case 5:case\"end\":return e.stop()}},null,this)}));case 13:d(\"WALogger\").LOG(ha(),a);case 14:case\"end\":return j.stop()}},null,this)});i.next=9;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(g));case 9:d(\"WALogger\").LOG(ga());case 10:case\"end\":return i.stop()}},null,this)}function e(a,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;return b(\"regeneratorRuntime\").async(function(y){while(1)switch(y.prev=y.next){case 0:f=a.name,g=a.version,h=a.patches,i=a.snapshot,j=a.syncedPendingMutationsId,k=a.syncedEncryptedMutations;d(\"WALogger\").LOG(fa(),f);y.prev=2;e==null?void 0:e.mark(\"external_mutations_download_start\",{patchCount:(l=a.patches)==null?void 0:l.length,snapshotSizeBytes:(m=a.snapshot)==null?void 0:m.fileSizeBytes});y.next=6;return b(\"regeneratorRuntime\").awrap(qa(f,h,i,c));case 6:n=y.sent;o=n[0];p=n[1];e==null?void 0:e.mark(\"external_mutations_download_end\",{patchesWithMutationsCount:p==null?void 0:p.length,snapshotRecordsCount:o==null?void 0:o.records.length});q=performance.now();if(!(o!=null)){y.next=17;break}y.next=14;return b(\"regeneratorRuntime\").awrap(ta(f,o,p,e));case 14:d(\"WALogger\").LOG(ea(),f);y.next=57;break;case 17:if(!(p!=null)){y.next=43;break}r=Math.min.apply(Math,p.map(function(a){return a.version.version}));s=c!=null&&r>c+1&&p.length>0;if(!s){y.next=38;break}y.next=23;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(f,\"has missing patches\"));case 23:y.next=25;return b(\"regeneratorRuntime\").awrap(d(\"WAGetMissingKey\").getAllMissingKeysInTransaction());case 25:t=y.sent;d(\"WALogger\").LOG(da(),t.map(function(a){return a.keyHex+\":\"+a.timestamp}));d(\"WALogger\").LOG(ca(),f,c,r);y.next=30;return b(\"regeneratorRuntime\").awrap(na(f,p[0]));case 30:y.next=32;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().printSyncdLog());case 32:y.next=34;return b(\"regeneratorRuntime\").awrap(oa());case 34:d(\"WALogger\").ERROR(ba()).sendLogs(\"syncd: has missing patches\");if(!d(\"WABaseGlobals\").getConfig().syncdShouldFatalOnMissingPatch()){y.next=38;break}d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.SERVER_DID_NOT_SEND_ALL_PATCHES,f,void 0,(u=c)!=null?u:0);throw new(d(\"WASyncdError\").SyncdFatalError)(\"syncd: has missing patches\");case 38:y.next=40;return b(\"regeneratorRuntime\").awrap(va(f,p,e));case 40:d(\"WALogger\").LOG(aa(),f);y.next=57;break;case 43:if(!(g!=null)){y.next=53;break}y.next=46;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(f,\"start upload patches. version: \"+g+\". mutation count: \"+k.length));case 46:y.next=48;return b(\"regeneratorRuntime\").awrap(pa(f,g,j,k));case 48:y.next=50;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(f,\"end upload patches\"));case 50:d(\"WALogger\").LOG(Y(),f,g);y.next=57;break;case 53:if(!d(\"WASyncdCollectionUtils\").isBootstrap(c)){y.next=56;break}y.next=56;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").updateCollectionVersionAndLtHashInTransaction(f,la,ma));case 56:d(\"WALogger\").LOG(X(),f);case 57:v=Math.floor(performance.now()-q);d(\"WALogger\").LOG(W(),f,v);(p||o)&&(d(\"WASyncdCollectionUtils\").isBootstrap(c)&&!d(\"WASyncdCollectionUtils\").isCriticalCollection(f)&&(w=o!=null,d(\"WASyncdMetrics\").reportSyncdBootstrapDataApplied(f,w?d(\"WASyncdMetrics\").SyncdBootstrapDataAppliedSnapshotUsed.SNAPSHOT_USED:d(\"WASyncdMetrics\").SyncdBootstrapDataAppliedSnapshotUsed.SNAPSHOT_NOT_USED,v)));y.next=62;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").logMacsInSnapshot(a.name));case 62:return y.abrupt(\"return\",a);case 65:y.prev=65;y.t0=y[\"catch\"](2);x=y.t0.message;y.next=70;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(f,\"error (maybe retryable): \"+y.t0));case 70:if(!(y.t0 instanceof d(\"WASyncdError\").SyncdMissingKeyError)){y.next=73;break}d(\"WALogger\").WARN(V(),f);return y.abrupt(\"return\",{name:f,state:d(\"WASyncdConst\").CollectionState.Blocked});case 73:if(!(y.t0 instanceof d(\"WASyncdError\").SyncdFatalError)){y.next=76;break}d(\"WALogger\").ERROR(U(),f,x).sendLogs(\"syncd: fatal error: \"+String(f)+\" throws \"+x);return y.abrupt(\"return\",{name:f,state:d(\"WASyncdConst\").CollectionState.ErrorFatal});case 76:d(\"WALogger\").WARN(T(),f,x).sendLogs(\"syncd: retryable error: \"+String(f)+\" throws \"+x);return y.abrupt(\"return\",{name:f,state:d(\"WASyncdConst\").CollectionState.ErrorRetry});case 78:case\"end\":return y.stop()}},null,this,[[2,65]])}function na(a,c){var e,f,g,h,i,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:k.prev=0;k.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdDecryptMutations\").tryDecryptPatch(a,c));case 3:f=k.sent;g=f.filter(function(a){return a.operation===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET});h=d(\"WASyncdValidateMutations\").validateAndTypeSetMutations(a,g);i=h.length>0?h[0].timestamp:null;j=i==null?null:d(\"WATimeUtils\").daysDiff(d(\"WATimeUtils\").unixTimeMs(),i);k.next=10;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"max timestamp in first patch: \"+((e=j)!=null?e:\"n\/a\")+\" days ago\"));case 10:k.next=15;break;case 12:k.prev=12,k.t0=k[\"catch\"](0),d(\"WALogger\").WARN(S(),k.t0);case 15:case\"end\":return k.stop()}},null,this,[[0,12]])}function oa(){var a;return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:d(\"WALogger\").LOG(R());c.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").getAllCollectionVersionsInTransaction());case 3:a=c.sent,a.forEach(function(a){var b;b=((b=a.lastSyncAttemptStartTimes)!=null?b:[]).map(function(a){return d(\"WATimeUtils\").daysDiff(d(\"WATimeUtils\").unixTimeMs(),a)});var c=a.lastSuccessfulSyncEndTime;c=c==null?null:d(\"WATimeUtils\").daysDiff(d(\"WATimeUtils\").unixTimeMs(),c);d(\"WALogger\").LOG(Q(),a.collection,a.lastSuccessfulSyncEndTime,c,a.lastSyncAttemptStartTimes,b)});case 5:case\"end\":return c.stop()}},null,this)}function pa(a,c,e,f){var g,h,i,j,k,l,m,n;return b(\"regeneratorRuntime\").async(function(o){while(1)switch(o.prev=o.next){case 0:o.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").logMacsInSnapshot(a));case 2:h=f.map(function(a){return{indexMac:a.indexMac,valueMac:a.valueMac,operation:a.operation}});o.next=5;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").computeLtHash(a,h,null,c,d(\"WASyncdAntiTampering\").SyncdPatchDirection.Outgoing));case 5:i=o.sent;j=i.ltHash;k=d(\"WASyncdCollectionHandlerTypesConverter\").encryptedUploadMutationsToSyncActions(f.filter(function(a){return a.operation===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET}),d(\"WASyncdConst\").SyncActionState.Success);o.next=10;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").getCollectionVersionInTransaction(a).then(function(a){return a==null?void 0:a.version}));case 10:o.t0=g=o.sent;if(!(o.t0!=null)){o.next=15;break}o.t1=g;o.next=16;break;case 15:o.t1=0;case 16:l=o.t1;c!==l+1&&d(\"WALogger\").ERROR(P(),c,l+1).sendLogs(\"syncd: unexpected server version after patch upload\");d(\"WALogger\").LOG(O(),a);m=d(\"WABaseGlobals\").getConfig().syncdShouldParsePatchDebugData();if(!m){o.next=23;break}o.next=23;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").reportCollectionInconsistency(a,\"pre-processing outgoing patch \"+c));case 23:o.next=25;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},function(d){var f,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:f=d.SyncActionStore,g=d.PendingMutationStore,h=d.CollectionVersionStore;i.next=3;return b(\"regeneratorRuntime\").awrap(f.bulkSet(k));case 3:i.next=5;return b(\"regeneratorRuntime\").awrap(g.bulkRemove(e));case 5:i.next=7;return b(\"regeneratorRuntime\").awrap(h.update(a,{version:c,ltHash:j,isLastPatchAnIncomingPatch:!1,lastPatchNewLtHashFromPatchDebugData:void 0,isLastPatchSenderAPrimaryDevice:void 0,didLastPatchFailPostValidation:void 0,lastPatchSenderDeviceId:void 0}));case 7:case\"end\":return i.stop()}},null,this)}));case 25:d(\"WALogger\").LOG(N(),a);if(!m){o.next=32;break}o.next=29;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").reportCollectionInconsistency(a,\"post-processing outgoing patch \"+c));case 29:n=o.sent;o.next=32;return b(\"regeneratorRuntime\").awrap(xa(a,n));case 32:case\"end\":return o.stop()}},null,this)}function qa(a,e,f,g){var i,j,k,l,m,n,o,p,q,r;return b(\"regeneratorRuntime\").async(function(s){while(1)switch(s.prev=s.next){case 0:i=(h||(h=b(\"Promise\"))).resolve();j=0;k=d(\"WATimeUtils\").unixTimeMs();f!=null&&(m=c(\"WASyncdValidateServerSyncProtobuf\").validateExternalBlobReference(a,f),j+=d(\"WALongInt\").numberOrThrowIfTooLarge((l=m.fileSizeBytes)!=null?l:0),d(\"WALogger\").LOG(M(),a),i=d(\"WASyncdMMSDownload\").downloadSnapshot(a,m));n=(h||(h=b(\"Promise\"))).resolve();e!=null&&e.length>0&&(o=e.map(function(b){return c(\"WASyncdValidateServerSyncProtobuf\").validatePatchProtobuf(a,b)}),n=(h||(h=b(\"Promise\"))).all(o.map(function(c){var e,f,g;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:e=c.mutations||[];f=c.externalMutations;if(!f){h.next=9;break}d(\"WALogger\").LOG(L(),a);h.next=6;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdMMSDownload\").downloadExternalPatch(a,f));case 6:e=h.sent,d(\"WALogger\").LOG(K(),a),j+=d(\"WALongInt\").numberOrThrowIfTooLarge((g=f.fileSizeBytes)!=null?g:0);case 9:return h.abrupt(\"return\",{mutations:e,version:c.version,snapshotMac:c.snapshotMac,patchMac:c.patchMac,keyId:c.keyId,exitCode:c.exitCode,deviceIndex:c.deviceIndex,clientDebugData:c.clientDebugData});case 10:case\"end\":return h.stop()}},null,this)})));s.prev=6;s.next=9;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all([i,n]));case 9:r=s.sent;p=r[0];q=r[1];d(\"WASyncdCollectionUtils\").isBootstrap(g)&&d(\"WASyncdMetrics\").reportSyncdBootstrapAppStateDownloadMetric({collection:a,downloadStartTs:k,downloadSize:j,isSuccess:\"success\"});s.next=19;break;case 15:s.prev=15;s.t0=s[\"catch\"](6);d(\"WASyncdCollectionUtils\").isBootstrap(g)&&d(\"WASyncdMetrics\").reportSyncdBootstrapAppStateDownloadMetric({collection:a,downloadStartTs:k,downloadSize:j,isSuccess:\"failure\"});throw s.t0;case 19:return s.abrupt(\"return\",[p,q]);case 20:case\"end\":return s.stop()}},null,this,[[6,15]])}function ra(a){var c=function(c,e){var f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:a==null?void 0:a.mark(\"anti_tampering_start\",{source:d(\"WASyncdConst\").SyncDataType.Snapshot});g.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").computeLtHashAndValidateSnapshot(c,e));case 3:f=g.sent;a==null?void 0:a.mark(\"anti_tampering_end\",{source:d(\"WASyncdConst\").SyncDataType.Snapshot});return g.abrupt(\"return\",f);case 6:case\"end\":return g.stop()}},null,this)},e=function(c,e){var f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:a==null?void 0:a.mark(\"decryption_start\",{source:d(\"WASyncdConst\").SyncDataType.Snapshot});g.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdDecryptMutations\").tryDecryptSnapshot(c,e));case 3:f=g.sent;a==null?void 0:a.mark(\"decryption_end\",{source:d(\"WASyncdConst\").SyncDataType.Snapshot});return g.abrupt(\"return\",f);case 6:case\"end\":return g.stop()}},null,this)};return{measuredComputeLtHashAndValidateSnapshot:c,measuredTryDecryptSnapshot:e}}function sa(a){var c=function(c,e,f){var g;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:a==null?void 0:a.mark(\"anti_tampering_start\",{source:d(\"WASyncdConst\").SyncDataType.Patch});h.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").computeLtHashAndValidatePatch(c,e,f));case 3:g=h.sent;a==null?void 0:a.mark(\"anti_tampering_end\",{source:d(\"WASyncdConst\").SyncDataType.Patch});return h.abrupt(\"return\",g);case 6:case\"end\":return h.stop()}},null,this)},e=function(c,e){var f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:a==null?void 0:a.mark(\"decryption_start\",{source:d(\"WASyncdConst\").SyncDataType.Patch});g.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdDecryptMutations\").tryDecryptPatch(c,e));case 3:f=g.sent;a==null?void 0:a.mark(\"decryption_end\",{source:d(\"WASyncdConst\").SyncDataType.Patch});return g.abrupt(\"return\",f);case 6:case\"end\":return g.stop()}},null,this)};return{measuredComputeLtHashAndValidatePatch:c,measuredTryDecryptPatch:e}}function ta(a,c,e,f){var g,h,i,j,k,l,m,n,o;return b(\"regeneratorRuntime\").async(function(p){while(1)switch(p.prev=p.next){case 0:p.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"start _applySnapshotAndPatches. mutation count: \"+c.records.length+\", version: \"+c.version.version));case 2:p.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").logMacsInSnapshot(a));case 4:p.prev=4;g=ra(f),h=g.measuredComputeLtHashAndValidateSnapshot,i=g.measuredTryDecryptSnapshot;f==null?void 0:f.mark(\"apply_start\",{source:d(\"WASyncdConst\").SyncDataType.Snapshot,snapshotRecordsCount:c.records.length});d(\"WALogger\").LOG(J(),a);p.next=10;return b(\"regeneratorRuntime\").awrap(h(a,c));case 10:j=p.sent;d(\"WALogger\").LOG(I(),a);p.next=14;return b(\"regeneratorRuntime\").awrap(i(a,c));case 14:k=p.sent;d(\"WALogger\").LOG(H(),a);d(\"WASyncdWamAppState\").addMutationCount(c.records.length);d(\"WASyncdMetricCriticalBootstrapStage\").reportSyncdDecryptedMutations(d(\"WASyncdMetricCriticalBootstrapStage\").SyncdDecryptMutationsType.SNAPSHOT_MUTATIONS,k);d(\"WASyncdValidateMutations\").validateNoSameIndexForMultipleMutations(a,k,d(\"WASyncdConst\").SyncDataType.Snapshot);l=c.version.version;p.next=22;return b(\"regeneratorRuntime\").awrap(Z(a,k,d(\"WASyncdConst\").SyncDataType.Snapshot,f));case 22:m=p.sent;n=m.setMutationsToPersist;o=m.pendingMutationsToDrop;d(\"WALogger\").LOG(G(),k.length,a,l);d(\"WALogger\").LOG(F(),a,l);f==null?void 0:f.mark(\"update_DB_start\",{source:d(\"WASyncdConst\").SyncDataType.Snapshot,setMutationsToPersistCount:n.length,pendingMutationsToDropCount:o.length});p.next=30;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},function(c){var d,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:d=c.SyncActionStore,e=c.PendingMutationStore,f=c.CollectionVersionStore;g.next=3;return b(\"regeneratorRuntime\").awrap(d.bulkSet(n));case 3:g.next=5;return b(\"regeneratorRuntime\").awrap(e.bulkRemove(o));case 5:g.next=7;return b(\"regeneratorRuntime\").awrap(f.update(a,{version:l,ltHash:j,isLastPatchAnIncomingPatch:!0,lastPatchNewLtHashFromPatchDebugData:void 0,isLastPatchSenderAPrimaryDevice:void 0,didLastPatchFailPostValidation:void 0,lastPatchSenderDeviceId:void 0,didBootstrapFromSnapshot:!0}));case 7:case\"end\":return g.stop()}},null,this)}));case 30:f==null?void 0:f.mark(\"update_DB_end\",{source:d(\"WASyncdConst\").SyncDataType.Snapshot});d(\"WALogger\").LOG(E(),a);f==null?void 0:f.mark(\"apply_end\",{source:d(\"WASyncdConst\").SyncDataType.Snapshot,decryptedMutationsCount:k.length});p.next=43;break;case 35:p.prev=35;p.t0=p[\"catch\"](4);p.next=39;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"exception \"+p.t0.message));case 39:if(!(p.t0 instanceof d(\"WASyncdError\").SyncdMissingKeyError)){p.next=42;break}p.next=42;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdHandleMissingKeys\").handleMissingKeysInSnapshot(a,c));case 42:throw p.t0;case 43:p.next=45;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"done applying snapshot\"));case 45:if(!e){p.next=50;break}f==null?void 0:f.mark(\"apply_start\",{source:d(\"WASyncdConst\").SyncDataType.Patch,patchCount:e.length});p.next=49;return b(\"regeneratorRuntime\").awrap(va(a,e,f));case 49:f==null?void 0:f.mark(\"apply_end\",{source:d(\"WASyncdConst\").SyncDataType.Patch,patchCount:e.length});case 50:case\"end\":return p.stop()}},null,this,[[4,35]])}function ua(a){var c,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:c=d(\"WABaseGlobals\").getConfig().syncdMaxMutationsToProcessDuringResume();if(!(a>c)){f.next=7;break}e=Date.now();d(\"WALogger\").LOG(D(),a);f.next=6;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().handleSyncDelayApplyingPatchUntilUIUnblocks());case 6:d(\"WALogger\").LOG(C(),Date.now()-e);case 7:case\"end\":return f.stop()}},null,this)}function va(a,c,e){var f,g,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:f=c.length===0?\"n\/a\":c[c.length-1].version.version;j.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"start apply patches. count: \"+c.length+\", last patch version: \"+f));case 3:if(!(c.length===0)){j.next=6;break}d(\"WALogger\").LOG(B(),a);return j.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve());case 6:d(\"WASyncdValidateMutations\").validateNoDuplicatePatchVersionInCollection(a,c);c.sort(function(a,b){return a.version.version>b.version.version?1:-1});j.prev=8;g=c.reduce(function(a,b){return a+b.mutations.length},0);j.next=12;return b(\"regeneratorRuntime\").awrap(ua(g));case 12:i=0;case 13:if(!(i<c.length)){j.next=25;break}if(!(i<=4||i%10===0)){j.next=17;break}j.next=17;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"start applying patch \"+c[i].version.version+\" with \"+c[i].mutations.length+\" mutations\"));case 17:j.next=19;return b(\"regeneratorRuntime\").awrap(wa(a,c[i],e,i<=1));case 19:if(!(i<=4||i%10===0)){j.next=22;break}j.next=22;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"finished applying patch \"+c[i].version.version+\" with \"+c[i].mutations.length+\" mutations\"));case 22:i++;j.next=13;break;case 25:j.next=27;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"after apply patches (total mutations: \"+g+\")\"));case 27:j.next=37;break;case 29:j.prev=29;j.t0=j[\"catch\"](8);j.next=33;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"exception\"+j.t0.message));case 33:if(!(j.t0 instanceof d(\"WASyncdError\").SyncdMissingKeyError)){j.next=36;break}j.next=36;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdHandleMissingKeys\").handleMissingKeysInPatches(a,c));case 36:throw j.t0;case 37:case\"end\":return j.stop()}},null,this,[[8,29]])}function wa(a,c,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,B,C,D,E,F;return b(\"regeneratorRuntime\").async(function(G){while(1)switch(G.prev=G.next){case 0:F=function(c){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncAction\").getSyncActionsByCollectionsInTransaction([a]));case 2:f.t0=function(a){return d(\"WACryptoUtils\").arrayBuffersEqual(c,a.indexMac)};f.t1=e=f.sent.filter(f.t0).pop();if(!(f.t1==null)){f.next=8;break}f.t2=void 0;f.next=9;break;case 8:f.t2=e.valueMac;case 9:return f.abrupt(\"return\",f.t2);case 10:case\"end\":return f.stop()}},null,this)};f===void 0&&(f=!1);G.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").logMacsInSnapshot(a));case 4:g=d(\"WABaseGlobals\").getConfig().syncdShouldParsePatchDebugData();if(!g){G.next=8;break}G.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").reportCollectionInconsistency(a,\"pre-processing incoming patch \"+c.version.version));case 8:if(!c.exitCode){G.next=21;break}j=c.exitCode.code;G.next=12;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"patch exit code \"+((h=j)!=null?h:\"\")));case 12:G.t0=j;G.next=G.t0===100?15:G.t0===101?17:19;break;case 15:d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.TERMINAL_PATCH_MISSING_DATA,a);return G.abrupt(\"break\",20);case 17:d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.TERMINAL_PATCH_DESERIALIZATION_ERROR,a);return G.abrupt(\"break\",20);case 19:d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.TERMINAL_PATCH_UNKNOWN,a);case 20:throw new(d(\"WASyncdError\").SyncdFatalError)(\"received terminal patch with exit code:  \"+String(j)+\" text: \"+String((i=c.exitCode)==null?void 0:i.text)+\"  \");case 21:G.next=23;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().handleSyncBeforeApplyPatch(c));case 23:k=c.mutations.filter(function(a){return a.operation===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET}).length;l=c.mutations.length-k;d(\"WALogger\").LOG(A(),a,c.version.version,c.deviceIndex,k,l);k===0&&l===0&&d(\"WALogger\").WARN(z(),a).sendLogs(\"syncd: \"+a+\": empty patch found\");m=sa(e),n=m.measuredComputeLtHashAndValidatePatch,o=m.measuredTryDecryptPatch;G.next=30;return b(\"regeneratorRuntime\").awrap(n(a,c,F));case 30:p=G.sent;d(\"WALogger\").LOG(y(),a,c.version.version);G.next=34;return b(\"regeneratorRuntime\").awrap(o(a,c));case 34:q=G.sent;d(\"WASyncdMetricCriticalBootstrapStage\").reportSyncdDecryptedMutations(d(\"WASyncdMetricCriticalBootstrapStage\").SyncdDecryptMutationsType.PATCH_MUTATIONS,q);if(!f){G.next=39;break}G.next=39;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"after decrypt patch \"+c.version.version));case 39:d(\"WASyncdWamAppState\").addMutationCount(q.length);d(\"WASyncdValidateMutations\").validateNoSameIndexForMultipleMutations(a,q,d(\"WASyncdConst\").SyncDataType.Patch);r=Aa(q);s=r.filter(function(a){return a.operation===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.REMOVE});G.next=45;return b(\"regeneratorRuntime\").awrap(ya(a,s));case 45:d(\"WALogger\").LOG(x(),a,c.version.version);t=r.filter(function(a){return a.operation===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET});G.next=49;return b(\"regeneratorRuntime\").awrap(Z(a,t,d(\"WASyncdConst\").SyncDataType.Patch,e,f));case 49:u=G.sent;B=u.setMutationsToPersist;C=u.pendingMutationsToDrop;d(\"WALogger\").LOG(w(),q.length,c.version.version,a);e==null?void 0:e.mark(\"update_DB_start\",{source:d(\"WASyncdConst\").SyncDataType.Patch,setMutationsToPersistCount:B.length,pendingMutationsToDropCount:C.length});D=c.version.version;G.next=57;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},function(d){var e,f,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:f=d.SyncActionStore,g=d.PendingMutationStore,h=d.CollectionVersionStore;i.next=3;return b(\"regeneratorRuntime\").awrap(f.bulkRemove(s.map(function(a){return a.index})));case 3:i.next=5;return b(\"regeneratorRuntime\").awrap(f.bulkSet(B));case 5:i.next=7;return b(\"regeneratorRuntime\").awrap(g.bulkRemove(C));case 7:i.next=9;return b(\"regeneratorRuntime\").awrap(h.update(a,{version:D,ltHash:p,lastPatchNewLtHashFromPatchDebugData:(e=c.clientDebugData)==null?void 0:e.newLthash,isLastPatchAnIncomingPatch:!0,isLastPatchSenderAPrimaryDevice:c.deviceIndex===0,didLastPatchFailPostValidation:void 0,lastPatchSenderDeviceId:c.deviceIndex}));case 9:case\"end\":return i.stop()}},null,this)}));case 57:if(!g){G.next=63;break}G.next=60;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").reportCollectionInconsistency(a,\"post-processing incoming patch \"+c.version.version+\". has remove: \"+(l>0).toString()));case 60:E=G.sent;G.next=63;return b(\"regeneratorRuntime\").awrap(xa(a,E));case 63:e==null?void 0:e.mark(\"update_DB_end\",{source:d(\"WASyncdConst\").SyncDataType.Patch});d(\"WALogger\").LOG(v(),a,c.version.version);if(!f){G.next=68;break}G.next=68;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"after final transaction for patch \"+c.version.version));case 68:case\"end\":return G.stop()}},null,this)}function xa(a,c){return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").runInTransaction({CollectionVersionStore:!0},function(d){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:e=d.CollectionVersionStore;f.next=3;return b(\"regeneratorRuntime\").awrap(e.update(a,{didLastPatchFailPostValidation:c}));case 3:case\"end\":return f.stop()}},null,this)}));case 2:case\"end\":return e.stop()}},null,this)}function Z(a,e,f,g,h){var i,j,k,l,m,n,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P;return b(\"regeneratorRuntime\").async(function(Q){while(1)switch(Q.prev=Q.next){case 0:h===void 0&&(h=!1);d(\"WASyncdMetricCriticalBootstrapStage\").reportSyncdCriticalBootstrapStage(d(\"WASyncdMetricCriticalBootstrapStage\").SyncdCriticalBootstrapStageType.ABOUT_TO_APPLY_MUTATIONS);j=f===d(\"WASyncdConst\").SyncDataType.Local?\" (individual mutations)\":\"\";k=[];l=d(\"WASyncdValidateMutations\").validateAndTypeSetMutations(a,e);m=Ba(a,l),n=m.supportedMutations,v=m.unsupportedMutations;v.forEach(function(a){return k.push(d(\"WASyncdCollectionHandlerTypesConverter\").setMutationToSyncAction(a,d(\"WASyncdConst\").SyncActionState.Unsupported))});g==null?void 0:g.mark(\"conflict_resolution_start\",{source:f,collectionName:a,count:n.length});Q.next=10;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdResolveConflict\").resolveConflict(a,n));case 10:w=Q.sent,x=w.remoteMutationsToApply,y=w.pendingMutationsToDrop,z=n.filter(function(a){return!x.includes(a)}),g==null?void 0:g.mark(\"conflict_resolution_end\",{source:f,collectionName:a,apply:x.length,drop:z.length}),z.forEach(function(a){return k.push(d(\"WASyncdCollectionHandlerTypesConverter\").setMutationToSyncAction(a,d(\"WASyncdConst\").SyncActionState.Skipped,a.actionName))}),g==null?void 0:g.mark(\"apply_set_mutations_start\",{source:f,collectionName:a,count:x.length}),A=Ca(x),B=null,C=0;case 20:if(!(C<A.length)){Q.next=52;break}D=h&&C<=1;E=A[C][0].actionHandler;F=A[C].map(function(a){var b;a.binarySyncData?b=c(\"WANullthrows\")(d(\"decodeProtobuf\").decodeProtobuf(d(\"WASyncAction.pb\").SyncActionDataSpec,a.binarySyncData).value):b=d(\"decodeProtobuf\").decodeProtobuf(d(\"WASyncAction.pb\").SyncActionValueSpec,a.binarySyncAction);(B==null||B<a.timestamp)&&(B=a.timestamp);return{operation:\"set\",indexParts:a.indexArr,value:b,timestamp:a.timestamp}});if(!D){Q.next=27;break}Q.next=27;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"after deserialize. mutationsToApply length: \"+F.length));case 27:G=[];H=!1;Q.prev=29;d(\"WALogger\").DEV(u(),JSON.stringify(F,null,2),j);d(\"WALogger\").LOG(t(),a,F.length,j);Q.next=34;return b(\"regeneratorRuntime\").awrap(E.applyMutations(F,{setMutationsPendingToPersist:k,allSupportedSetMutations:x},D));case 34:G=Q.sent;if(!D){Q.next=38;break}Q.next=38;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"after apply. result length: \"+G.length));case 38:Q.next=46;break;case 40:Q.prev=40;Q.t0=Q[\"catch\"](29);if(!(Q.t0 instanceof d(\"WASyncdError\").SyncdFatalError||a===d(\"WASyncdConst\").CollectionName.CriticalBlock)){Q.next=44;break}throw Q.t0;case 44:H=!0,d(\"WALogger\").WARN(s(),Q.t0);case 46:d(\"WALogger\").DEV(r(),j,G.slice(0,100).map(function(a){return a.actionState}));d(\"WALogger\").LOG(q(),a,j);for(I=0;I<A[C].length;I++)L=H?d(\"WASyncdConst\").SyncActionState.Failed:G[I].actionState,k.push(d(\"WASyncdCollectionHandlerTypesConverter\").setMutationToSyncAction(A[C][I],L,A[C][I].actionName,H?void 0:(J=G[I].orphanModel)==null?void 0:J.modelId,H?void 0:(K=G[I].orphanModel)==null?void 0:K.modelType));case 49:C++;Q.next=20;break;case 52:M=B;N=M==null?null:d(\"WATimeUtils\").daysDiff(d(\"WATimeUtils\").unixTimeMs(),M);d(\"WALogger\").LOG(p(),(i=N)!=null?i:\"n\/a\");if(!h){Q.next=58;break}Q.next=58;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,\"max timestamp from recent patch: \"+((O=N)!=null?O:\"n\/a\")+\" days ago\"));case 58:P=k.reduce(function(a,b){b=b.actionState;a[b]==null&&(a[b]=0);a[b]++;return a},{});g==null?void 0:g.mark(\"apply_set_mutations_end\",babelHelpers[\"extends\"]({source:f,collectionName:a,count:x.length},P));d(\"WASyncdMetricCriticalBootstrapStage\").reportSyncdCriticalBootstrapStage(d(\"WASyncdMetricCriticalBootstrapStage\").SyncdCriticalBootstrapStageType.APPLIED_MUTATIONS);d(\"WALogger\").LOG(o(),a,j);return Q.abrupt(\"return\",{setMutationsToPersist:k,pendingMutationsToDrop:y});case 63:case\"end\":return Q.stop()}},null,this,[[29,40]])}function ya(a,c){var e,f,g,h,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:(e=za(c),f=e.supportedMutations),g=Ca(f),d(\"WALogger\").LOG(n(),a),h=0;case 4:if(!(h<g.length)){j.next=11;break}i=g[h][0].actionHandler;j.next=8;return b(\"regeneratorRuntime\").awrap(i.applyMutations(g[h].map(function(b){return{operation:\"remove\",indexParts:$(a,b.index)}}),{setMutationsPendingToPersist:[],allSupportedSetMutations:[]}));case 8:h++;j.next=4;break;case 11:d(\"WALogger\").LOG(m(),a);case 12:case\"end\":return j.stop()}},null,this)}function za(a){a=a.map(function(a){if(a.version>d(\"WASyncdGetActionHandler\").maxSupportedVersion())return{unsupported:a};var b=$(a.collection,a.index),c=d(\"WASyncdConst\").Actions.cast(b[0]);if(!c){d(\"WALogger\").WARN(l(),b[0]);return{unsupported:a}}var e=d(\"WASyncdGetActionHandler\").getActionHandler(c);if(!e){d(\"WALogger\").WARN(k(),c);return{unsupported:a}}a={collection:a.collection,index:a.index,indexMac:a.indexMac,keyId:a.keyId,binarySyncData:a.binarySyncData,valueMac:a.valueMac,version:a.version,indexArr:b,actionName:c,actionHandler:e};return{supported:a}});var b=[],c=[];a.map(function(a){var d=a.supported;a=a.unsupported;d!=null?b.push(d):a!=null&&c.push(a)});return{supportedMutations:b,unsupportedMutations:c}}function Aa(a){var b=a.filter(function(a){return a.operation===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET}),c=new Set(b.map(function(a){return a.index}));a=a.filter(function(a){return a.operation===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.REMOVE});a.forEach(function(a){c.has(a.index)||b.push(a)});return b}function Ba(a,b){b=b.map(function(b){if(b.version>d(\"WASyncdGetActionHandler\").maxSupportedVersion())return{unsupported:b};var c=$(a,b.index),e=d(\"WASyncdConst\").Actions.cast(c[0]);if(!e){d(\"WALogger\").WARN(j(),c[0]);return{unsupported:b}}var f=d(\"WASyncdGetActionHandler\").getActionHandler(e);if(!f){d(\"WALogger\").WARN(i(),e);return{unsupported:b}}return{supported:{collection:b.collection,index:b.index,indexMac:b.indexMac,keyId:b.keyId,timestamp:b.timestamp,binarySyncData:b.binarySyncData,valueMac:b.valueMac,version:b.version,indexArr:c,actionName:e,actionHandler:f}}});var c=[],e=[];b.map(function(a){var b=a.supported;a=a.unsupported;b!=null?c.push(b):a!=null&&e.push(a)});return{supportedMutations:c,unsupportedMutations:e}}function Ca(a){return a.reduce(function(a,b){a.length!==0&&b.actionName===a[a.length-1][0].actionName?a[a.length-1].push(b):a.push([b]);return a},[])}function $(a,b){try{b=JSON.parse(b);if(b.length<1)throw c(\"WAErr\")();return b}catch(b){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.INVALID_ACTION_INDEX,a);throw new(d(\"WASyncdError\").SyncdFatalError)(\"invalid action index\")}}g.applyIndividualMutations=a;g.applyAppStateSyncResponse=e}),98);\n__d(\"WASyncdOrphan\",[\"Promise\",\"WAGetSyncAction\",\"WALogger\",\"WASyncdCollectionHandler\",\"WASyncdConst\",\"WASyncdDisabled\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: end applyAllOrphansAndUnsupported\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: start applyAllOrphansAndUnsupported\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: finished applying orphans of type \",\" with ids=\",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: applying orphans of type \",\" with ids=\",\"\"]);l=function(){return a};return a}function a(a,c){return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!d(\"WASyncdDisabled\").isSyncdDisabled()){e.next=2;break}return e.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve());case 2:e.next=4;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all([m(a),n(c)]));case 4:case\"end\":return e.stop()}},null,this)}function m(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b(\"regeneratorRuntime\").awrap(o(a,d(\"WASyncdConst\").SyncModelType.Msg));case 2:case\"end\":return c.stop()}},null,this)}function n(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b(\"regeneratorRuntime\").awrap(o(a,d(\"WASyncdConst\").SyncModelType.Chat));case 2:case\"end\":return c.stop()}},null,this)}function o(a,c){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:d(\"WALogger\").DEV(l(),c,a);if(!d(\"WASyncdDisabled\").isSyncdDisabled()){f.next=3;break}return f.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve());case 3:f.next=5;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncAction\").getSyncActionsByModelInfosInTransaction(a.map(function(a){return[a,c,d(\"WASyncdConst\").SyncActionState.Orphan]})));case 5:e=f.sent;f.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCollectionHandler\").applyIndividualMutations(e));case 8:d(\"WALogger\").DEV(k(),c,a);case 9:case\"end\":return f.stop()}},null,this)}function c(){var a;return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:if(!d(\"WASyncdDisabled\").isSyncdDisabled()){c.next=2;break}return c.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve());case 2:d(\"WALogger\").LOG(j());c.next=5;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncAction\").getSyncActionsByActionStatesInTransaction([d(\"WASyncdConst\").SyncActionState.Orphan,d(\"WASyncdConst\").SyncActionState.Unsupported]));case 5:a=c.sent;c.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCollectionHandler\").applyIndividualMutations(a));case 8:d(\"WALogger\").LOG(i());case 9:case\"end\":return c.stop()}},null,this)}function e(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b(\"regeneratorRuntime\").awrap(o(a,d(\"WASyncdConst\").SyncModelType.Agent));case 2:case\"end\":return c.stop()}},null,this)}function f(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b(\"regeneratorRuntime\").awrap(o(a,d(\"WASyncdConst\").SyncModelType.ChatAssignment));case 2:case\"end\":return c.stop()}},null,this)}function p(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b(\"regeneratorRuntime\").awrap(o(a,d(\"WASyncdConst\").SyncModelType.UserStatusMute));case 2:case\"end\":return c.stop()}},null,this)}g.checkOrphanMutations=a;g.checkOrphanMessages=m;g.checkOrphanChats=n;g.applyAllOrphansAndUnsupported=c;g.checkOrphanAgents=e;g.checkOrphanChatAssignments=f;g.checkOrphanUserStatusMutes=p}),98);\n__d(\"WAMediaCalculateFilehash\",[\"WACryptoDependencies\",\"WACryptoSha256\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return d(\"WACryptoSha256\").sha256Base64(a)}function b(){var a=d(\"WACryptoDependencies\").getCrypto().getRandomValues(new Uint8Array(20));a=a.buffer;return d(\"WACryptoSha256\").sha256Base64(a)}g.calculateFilehash=a;g.getRandomFilehash=b}),98);\n__d(\"WASyncdRequestEncode\",[\"WAServerSync.pb\",\"WASyncAction.pb\",\"WASyncdError\",\"WASyncdMetricFatalError\",\"encodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){try{return d(\"encodeProtobuf\").encodeProtobuf(d(\"WAServerSync.pb\").SyncdPatchSpec,a).readBuffer()}catch(a){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.PATCH_PROTOBUF_SERIALIZATION_FAILED);throw new(d(\"WASyncdError\").SyncdFatalError)(\"patch protobuf serialization failed\")}}function b(a){try{return d(\"encodeProtobuf\").encodeProtobuf(d(\"WAServerSync.pb\").SyncdMutationsSpec,a).readBuffer()}catch(a){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.MUTATIONS_PROTOBUF_SERIALIZATION_FAILED);throw new(d(\"WASyncdError\").SyncdFatalError)(\"mutations protobuf serialization failed\")}}function c(a){try{return d(\"encodeProtobuf\").encodeProtobuf(d(\"WASyncAction.pb\").SyncActionDataSpec,a).readBuffer()}catch(a){d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED);throw new(d(\"WASyncdError\").SyncdFatalError)(\"action data protobuf serialization failed\")}}g.encodeSyncdPatch=a;g.encodeSyncdMutations=b;g.encodeSyncActionData=c}),98);\n__d(\"WASyncdEncryptMutations\",[\"WAArrayBufferUtils\",\"WACryptoDependencies\",\"WAGetSyncAction\",\"WAServerSync.pb\",\"WASyncAction.pb\",\"WASyncdCrypto\",\"WASyncdCryptoConst\",\"WASyncdCryptoUtils\",\"WASyncdError\",\"WASyncdKeyCache\",\"WASyncdMetricFatalError\",\"WASyncdRequestEncode\",\"decodeProtobuf\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,c){var e,f,g,i,j,k,l,m,n,o,p;return b(\"regeneratorRuntime\").async(function(q){while(1)switch(q.prev=q.next){case 0:e=a.index,f=a.operation;g=c.keyId;i=c.keyData;q.t0=f;q.next=q.t0===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET?6:q.t0===d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.REMOVE?7:20;break;case 6:return q.abrupt(\"break\",20);case 7:q.next=9;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncAction\").getSyncActionInTransaction(e));case 9:j=q.sent;if(j){q.next=12;break}throw new(d(\"WASyncdError\").SyncdFatalError)(\"no corresponding set mutation\");case 12:k=j.keyId;q.next=15;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdKeyCache\").getKeyData(k));case 15:l=q.sent;if(!(l==null)){q.next=18;break}throw new(d(\"WASyncdError\").SyncdFatalError)(\"no key data for corresponding mutation\");case 18:g=k,i=l;case 20:q.next=22;return b(\"regeneratorRuntime\").awrap(h(a,g,i));case 22:m=q.sent;n=m.indexMac;o=m.indexAndValueCipherText;p=d(\"WASyncdCrypto\").valueMacFromIndexAndValueCipherText(o);return q.abrupt(\"return\",babelHelpers[\"extends\"]({},a,{keyId:g,keyData:i,indexMac:n,indexAndValueCipherText:o,valueMac:p}));case 27:case\"end\":return q.stop()}},null,this)}function h(a,c,e){var f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w;return b(\"regeneratorRuntime\").async(function(x){while(1)switch(x.prev=x.next){case 0:x.prev=0;f=a.index,g=a.binarySyncAction,h=a.operation,j=a.version;k=d(\"WAArrayBufferUtils\").stringToArrayBuffer(f);x.next=5;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generateEncryptionKeys(e));case 5:l=x.sent;m=l.indexKey,n=l.valueEncryptionKey,o=l.valueMacKey;x.next=9;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoDependencies\").getCrypto().getRandomValues(new Uint8Array(d(\"WASyncdCryptoConst\").IV_LENGTH)));case 9:p=x.sent;q=d(\"WASyncdCrypto\").generatePadding(k.byteLength,g.byteLength);r=i(k,g,q,j);x.next=14;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generateCipherText(p,n,r));case 14:s=x.sent;t=d(\"WASyncdCrypto\").generateAssociatedData(h,c);x.next=18;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generateMac(t,s,o));case 18:u=x.sent;v=d(\"WASyncdCryptoUtils\").combine([s,u]);x.next=22;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdCrypto\").generateIndexMac(m,k));case 22:w=x.sent;return x.abrupt(\"return\",{indexMac:w,indexAndValueCipherText:v});case 26:x.prev=26;x.t0=x[\"catch\"](0);d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.ENCRYPTION_FAILED);throw new(d(\"WASyncdError\").SyncdFatalError)(\"encryption failure\");case 30:case\"end\":return x.stop()}},null,this,[[0,26]])}function i(a,b,c,e){return d(\"WASyncdRequestEncode\").encodeSyncActionData({index:a,value:d(\"decodeProtobuf\").decodeProtobuf(d(\"WASyncAction.pb\").SyncActionValueSpec,b),padding:c,version:e})}g.encryptMutation=a}),98);\n__d(\"WASyncdMMSUpload\",[\"WABaseGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=100,i=2e3,j=10,k=100;function a(a){var b=Math.min(i,Math.max(d(\"WABaseGlobals\").getConfig().syncdInlineMutationsMaxCount(),h));return a.length>b}function b(a){var b=Math.min(k,Math.max(d(\"WABaseGlobals\").getConfig().syncdPatchProtobufMaxSize(),j))*1e3;return a.byteLength>b}g.exceedInlineMutationCount=a;g.exceedPatchProtobufSize=b}),98);\n__d(\"WASyncdRequestBuilderTypesConverter\",[\"WASyncAction.pb\",\"decodeProtobuf\",\"encodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){return a.map(function(a){var c=d(\"decodeProtobuf\").decodeProtobuf(d(\"WASyncAction.pb\").SyncActionDataSpec,a.binarySyncData).value;c=d(\"encodeProtobuf\").encodeProtobuf(d(\"WASyncAction.pb\").SyncActionValueSpec,c).readBuffer();return{collection:a.collection,index:a.index,binarySyncAction:c,operation:b,version:a.version,timestamp:a.timestamp,action:a.action}})}g.syncActionsToPendingMutations=a}),98);\n__d(\"WASyncdRequestBuilderBuild\",[\"Promise\",\"WABase64\",\"WABaseGlobals\",\"WAGetCollectionVersion\",\"WAGetSyncAction\",\"WAJids\",\"WALogger\",\"WAMediaCalculateFilehash\",\"WAServerSync.pb\",\"WASyncdAntiTampering\",\"WASyncdConst\",\"WASyncdCryptoUtils\",\"WASyncdEncryptMutations\",\"WASyncdKeyManagement\",\"WASyncdKeyManagementUtils\",\"WASyncdKeyTypes\",\"WASyncdMMSUpload\",\"WASyncdRequestBuilderTypesConverter\",\"WASyncdRequestEncode\",\"WASyncdWamAppState\",\"WAWap\",\"regeneratorRuntime\",\"sortBy\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: end _buildCollectionNodes\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: skipping \",\" in sync iq patch because initial full sync\\n        is incomplete\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: start _buildCollectionNodes\"]);k=function(){return a};return a}var l=5;function a(a){var c,e,f,g,h,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b(\"regeneratorRuntime\").awrap(n(a));case 2:c=j.sent;e=c.collectionNodes;f=c.collectionWithEncryptedMutations;g=c.localCollectionVersions;h=c.collectionsToSkip;i=m(d(\"WAWap\").wap(\"sync\",null,e));return j.abrupt(\"return\",{syncIqNode:i,collectionWithEncryptedMutations:f,localCollectionVersions:g,collectionsToSkip:h});case 9:case\"end\":return j.stop()}},null,this)}function e(){return m(d(\"WAWap\").wap(\"delete_all_data\",null))}function m(a){return d(\"WAWap\").wap(\"iq\",{to:d(\"WAWap\").S_WHATSAPP_NET,xmlns:\"w:sync:app:state\",type:\"set\",id:d(\"WAWap\").generateId()},a)}function n(a){var c,e,f,g,l,m,n;return b(\"regeneratorRuntime\").async(function(p){while(1)switch(p.prev=p.next){case 0:d(\"WALogger\").LOG(k());c=[];e=function(a,e){var f,g,h,i,k,l;return b(\"regeneratorRuntime\").async(function(m){while(1)switch(m.prev=m.next){case 0:m.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").getCollectionVersionInTransaction(a).then(function(a){return a==null?void 0:a.version}));case 2:f=m.sent;if(!(e!=null&&e.length>0)){m.next=16;break}if(!(f==null)){m.next=9;break}d(\"WALogger\").LOG(j(),a);c.push(a);m.next=16;break;case 9:m.next=11;return b(\"regeneratorRuntime\").awrap(o(a,e));case 11:i=m.sent,k=i.patchNode,l=i.encryptedMutations,g=k,h=l;case 16:return m.abrupt(\"return\",{collection:a,version:f,patchNode:g,encryptedMutations:h});case 17:case\"end\":return m.stop()}},null,this)};f=new Map();g=new Map();l=[];a.forEach(function(a,b){return l.push(e(b,a))});p.next=9;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(l));case 9:m=p.sent;n=m.map(function(a){var b=a.collection,c=a.version,e=a.patchNode;a=a.encryptedMutations;a&&g.set(b,a);f.set(b,c);return d(\"WAWap\").wap(\"collection\",{name:d(\"WAWap\").CUSTOM_STRING(b),version:d(\"WAWap\").INT((a=c)!=null?a:d(\"WASyncdConst\").DEFAULT_COLLECTION_VERSION),return_snapshot:c===void 0?\"true\":\"false\"},e)});d(\"WALogger\").LOG(i());return p.abrupt(\"return\",{collectionNodes:n,collectionWithEncryptedMutations:g,localCollectionVersions:f,collectionsToSkip:c});case 13:case\"end\":return p.stop()}},null,this)}function o(a,c){var e,f,g,i,j,k,l,m,n,o,w,x,y,z,A;return b(\"regeneratorRuntime\").async(function(B){while(1)switch(B.prev=B.next){case 0:B.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdKeyManagement\").getActiveKey(!p(c)));case 2:e=B.sent;B.next=5;return b(\"regeneratorRuntime\").awrap(v(a,c,e));case 5:f=B.sent;g=f.map(function(a){return d(\"WASyncdEncryptMutations\").encryptMutation(a,e)});B.next=9;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(g));case 9:i=B.sent;j=i.map(function(a){return{indexMac:a.indexMac,valueMac:a.valueMac,operation:a.operation}});B.next=13;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").computeLtHash(a,j));case 13:k=B.sent;l=k.ltHash;B.next=17;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdAntiTampering\").computeOutgoingSnapshotAndPatchMacs(a,l,i,e.keyData));case 17:m=B.sent;n=m.snapshotMac;o=m.patchMac;w=i.map(function(a){return u(a.keyId,a.operation,a.indexMac,a.indexAndValueCipherText)});x=t(w);y=function(){var a,c;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().uploadSyncExternalPatch(x));case 2:a=f.sent;f.next=5;return b(\"regeneratorRuntime\").awrap(q(a,x));case 5:c=f.sent;return f.abrupt(\"return\",r(c,e.keyId,n,o));case 7:case\"end\":return f.stop()}},null,this)};if(!d(\"WASyncdMMSUpload\").exceedInlineMutationCount(w)){B.next=29;break}B.next=26;return b(\"regeneratorRuntime\").awrap(y());case 26:z=B.sent;B.next=34;break;case 29:z=s(w,e.keyId,n,o);if(!d(\"WASyncdMMSUpload\").exceedPatchProtobufSize(z)){B.next=34;break}B.next=33;return b(\"regeneratorRuntime\").awrap(y());case 33:z=B.sent;case 34:A=d(\"WAWap\").wap(\"patch\",null,z);return B.abrupt(\"return\",{patchNode:A,encryptedMutations:i});case 36:case\"end\":return B.stop()}},null,this)}function p(a){return d(\"WABaseGlobals\").getConfig().logoutInProgress()&&a.some(function(a){return JSON.parse(a.index)[0]===d(\"WASyncdConst\").Actions.Sentinel})}function q(a,c){var e,f,g,h,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:e=a.mediaKey,f=a.directPath,g=a.encFilehash,h=a.handle;j.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAMediaCalculateFilehash\").calculateFilehash(c));case 3:i=j.sent;return j.abrupt(\"return\",{mediaKey:e,directPath:f,handle:h,fileSizeBytes:c.byteLength,fileSha256:d(\"WABase64\").decodeB64(i),fileEncSha256:g});case 5:case\"end\":return j.stop()}},null,this)}function r(a,b,c,e){var f=d(\"WABaseGlobals\").getConfig().syncdPatchDeviceIndexIncluded()?d(\"WAJids\").extractDeviceId(d(\"WABaseGlobals\").getMyDeviceJid()):void 0;return d(\"WASyncdRequestEncode\").encodeSyncdPatch({keyId:{id:d(\"WASyncdKeyTypes\").fromSyncKeyId(b)},externalMutations:a,snapshotMac:c,patchMac:e,deviceIndex:f})}function s(a,b,c,e){var f=d(\"WABaseGlobals\").getConfig().syncdPatchDeviceIndexIncluded()?d(\"WAJids\").extractDeviceId(d(\"WABaseGlobals\").getMyDeviceJid()):void 0;return d(\"WASyncdRequestEncode\").encodeSyncdPatch({keyId:{id:d(\"WASyncdKeyTypes\").fromSyncKeyId(b)},mutations:a,snapshotMac:c,patchMac:e,deviceIndex:f})}function t(a){return d(\"WASyncdRequestEncode\").encodeSyncdMutations({mutations:a})}function u(a,b,c,e){return{operation:b,record:{keyId:{id:d(\"WASyncdKeyTypes\").fromSyncKeyId(a)},index:{blob:c},value:{blob:e}}}}function v(a,c,e){var f,g,h,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncAction\").getSyncActionsByCollectionsInTransaction([a]));case 2:f=j.sent;g=c;h=w(f,c,e.keyId);g=g.concat(h);i=x(f,g,e.keyId);d(\"WASyncdWamAppState\").addKeyRotationRemoveCount(i.length);g=g.concat(i);return j.abrupt(\"return\",g);case 10:case\"end\":return j.stop()}},null,this)}function w(a,b,e){a=a.filter(function(a){return!b.map(function(a){return a.index}).includes(a.index)&&!d(\"WASyncdCryptoUtils\").syncKeyIdsEqual(a.keyId,e)});a=c(\"sortBy\")(a,function(a){return d(\"WASyncdKeyManagementUtils\").getKeyEpoch(a.keyId)});var f=Math.min(l,d(\"WABaseGlobals\").getConfig().syncdAdditionalMutations());a=a.slice(0,f);return d(\"WASyncdRequestBuilderTypesConverter\").syncActionsToPendingMutations(a,d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.SET)}function x(a,b,c){var e=b.map(function(a){return a.index});b=a.filter(function(a){return e.includes(a.index)});a=b.filter(function(a){return!d(\"WASyncdCryptoUtils\").syncKeyIdsEqual(a.keyId,c)});return d(\"WASyncdRequestBuilderTypesConverter\").syncActionsToPendingMutations(a,d(\"WAServerSync.pb\").SyncdMutation$SyncdOperation.REMOVE)}g.buildSyncIqNode=a;g.buildDeleteAllIqNode=e;g._generateMutationsToUpload=v}),98);\n__d(\"WASyncdRequestBuilderUtils\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a){return g(a.reverse(),function(a){return a.index}).reverse()}function g(a,b){var c=new Set();return a.filter(function(a){a=b(a);if(c.has(a))return!1;c.add(a);return!0})}f.compactPatch=a}),66);\n__d(\"WASyncdRequestBuilder\",[\"Promise\",\"WAGetPendingMutation\",\"WASyncdRequestBuilderBuild\",\"WASyncdRequestBuilderUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){var c,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:c=new Map();e=new Map();g.next=4;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(a.map(function(a){var f,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAGetPendingMutation\").getSyncPendingMutationsByCollectionInTransaction(a));case 2:f=i.sent,g=f.map(function(a){return a.id}).filter(Boolean),e.set(a,g),h=d(\"WASyncdRequestBuilderUtils\").compactPatch(f),c.set(a,h);case 7:case\"end\":return i.stop()}},null,this)})));case 4:g.next=6;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdRequestBuilderBuild\").buildSyncIqNode(c));case 6:f=g.sent;return g.abrupt(\"return\",{syncIqNode:f.syncIqNode,collectionWithPendingMutationsIds:e,collectionWithEncryptedMutations:f.collectionWithEncryptedMutations,localCollectionVersions:f.localCollectionVersions,collectionsToSkip:f.collectionsToSkip});case 8:case\"end\":return g.stop()}},null,this)}g[\"default\"]=a}),98);\n__d(\"WASyncdResponseParser\",[\"WADeprecatedWapParser\",\"WALogger\",\"WASyncdConst\",\"WASyncdDecode\",\"WASyncdError\",\"WASyncdMetricFatalError\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: collection \",\" did not get server error\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: collection \",\" got server code has_more_patches\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: retryable error: collection \",\" throws \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: fatal error 404: collection \",\" throws \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: fatal error: collection \",\" throws \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: collection \",\" got server error: \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: successfully parsed collection \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: collection \",\" has no version, patches or snapshot\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: start parsing syncd collections\"]);p=function(){return a};return a}a=new(c(\"WADeprecatedWapParser\"))(\"syncResponseParser\",function(a){d(\"WALogger\").LOG(p());var b=[];a=a.child(\"sync\");a.mapChildrenWithTag(\"collection\",function(a){var c=babelHelpers[\"extends\"]({},null),e=d(\"WASyncdConst\").CollectionName.cast(a.attrString(\"name\"));if(!e)throw new(d(\"WASyncdError\").SyncdFatalError)(\"invalid collection name\");c.name=e;c.state=q(a,c.name);a.hasAttr(\"version\")&&(c.version=parseInt(a.attrString(\"version\"),10));a.hasChild(\"patches\")&&(c.patches=a.child(\"patches\").mapChildrenWithTag(\"patch\",function(a){return d(\"WASyncdDecode\").decodeSyncdPatch(e,a.contentBytes())}));a.hasChild(\"snapshot\")&&(c.snapshot=d(\"WASyncdDecode\").decodeExternalBlobReference(e,a.child(\"snapshot\").contentBytes()));b.push(c);c.version==null&&c.patches==null&&c.snapshot==null&&d(\"WALogger\").LOG(o(),e);d(\"WALogger\").LOG(n(),e)});return b});function q(a,b){if(a.hasAttr(\"type\")&&a.attrString(\"type\")===\"error\"){var c=a.child(\"error\"),e=c.attrString(\"code\");c=c.attrString(\"text\");d(\"WALogger\").LOG(m(),b,e);switch(e){case\"409\":return a.hasAttr(\"has_more_patches\")?d(\"WASyncdConst\").CollectionState.ConflictHasMore:d(\"WASyncdConst\").CollectionState.Conflict;case\"400\":d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.XMPP_BAD_REQUEST_FOR_COLLECTION);d(\"WALogger\").ERROR(l(),String(b),c).sendLogs(\"syncd: fatal error 400: collection \"+String(b));return d(\"WASyncdConst\").CollectionState.ErrorFatal;case\"404\":d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.XMPP_NOT_FOUND_FOR_COLLECTION);d(\"WALogger\").ERROR(k(),String(b),c).sendLogs(\"syncd: fatal error: collection \"+String(b));return d(\"WASyncdConst\").CollectionState.ErrorFatal;default:d(\"WALogger\").WARN(j(),String(b),c).sendLogs(\"syncd: retryable error: collection \"+String(b));return d(\"WASyncdConst\").CollectionState.ErrorRetry}}else if(a.hasAttr(\"has_more_patches\")){d(\"WALogger\").LOG(i(),b);return d(\"WASyncdConst\").CollectionState.SuccessHasMore}else{d(\"WALogger\").LOG(h(),b);return d(\"WASyncdConst\").CollectionState.Success}}g.syncResponseParser=a}),98);\n__d(\"WASyncdServerSync\",[\"Promise\",\"WABaseGlobals\",\"WADeprecatedSendIq\",\"WAGetCollectionVersion\",\"WAGetPendingMutation\",\"WALogger\",\"WASyncdCollectionHandler\",\"WASyncdConst\",\"WASyncdError\",\"WASyncdMetricCriticalBootstrapStage\",\"WASyncdMetricFatalError\",\"WASyncdMetrics\",\"WASyncdRequestBuilder\",\"WASyncdResponseParser\",\"WASyncdWamAppState\",\"WATimeUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: cannot log collection sync start: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: received sync response for collections: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: completed network operation for collections: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: sending sync request for collections: \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: retryable error: syncd global throws \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: fatal error: syncd global throws \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: end apply collections: \",\"\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: start apply collections: \",\"\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\\n\\t\",\" v\",\"\"],[\"\\\\n\\\\t\",\" v\",\"\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: local collection versions:\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: deferred local mutation upload for \",\"\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: reached max iterations for collections: \",\"\"]);t=function(){return a};return a}var u=5,v=500;function a(a){var c,e,f,g,i,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b(\"regeneratorRuntime\").awrap(A(a,\"start serverSync\"));case 2:c=[],e=[].concat(a),f=0;case 5:if(!(f<u||e.length>0&&f<v)){k.next=20;break}if(!(e.length===0)){k.next=8;break}return k.abrupt(\"break\",20);case 8:k.next=10;return b(\"regeneratorRuntime\").awrap(w(e));case 10:g=k.sent;i=g.doneCollections;j=g.refetchCollections;k.next=15;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(i.map(function(a){return A([a.name],\"done collection, state: \"+a.state)})));case 15:e=j;c=c.concat(i);f++;k.next=5;break;case 20:if(!(e.length>0)){k.next=25;break}k.next=23;return b(\"regeneratorRuntime\").awrap(A(e,\"error: max iterations\"));case 23:d(\"WALogger\").ERROR(t(),e).tags(\"syncd\").sendLogs(\"syncd: max iteration\"),c=c.concat(e.map(function(a){return{state:d(\"WASyncdConst\").CollectionState.ErrorRetry,name:a}}));case 25:return k.abrupt(\"return\",c);case 26:case\"end\":return k.stop()}},null,this)}function w(a){var c,e,f,g,i,j,k,l,t,u,v;return b(\"regeneratorRuntime\").async(function(w){while(1)switch(w.prev=w.next){case 0:if(!(a.length===0)){w.next=2;break}return w.abrupt(\"return\",{doneCollections:[],refetchCollections:[]});case 2:w.next=4;return b(\"regeneratorRuntime\").awrap(z(a));case 4:w.prev=4;w.next=7;return b(\"regeneratorRuntime\").awrap(x(a));case 7:c=w.sent;e=c.collectionDetails;f=c.localCollectionVersions;g=c.collectionsToUpload;g.length>0&&d(\"WALogger\").LOG(s(),g);d(\"WALogger\").LOG(r());f.forEach(function(a,b){d(\"WALogger\").LOG(q(),b,(b=a)!=null?b:\"(undefined)}\")});i=[];j=[];e.forEach(function(a){switch(a.state){case d(\"WASyncdConst\").CollectionState.ErrorRetry:case d(\"WASyncdConst\").CollectionState.ErrorFatal:case d(\"WASyncdConst\").CollectionState.Blocked:j.push(a);return;default:i.push(a)}(a.state===d(\"WASyncdConst\").CollectionState.Conflict||a.state===d(\"WASyncdConst\").CollectionState.ConflictHasMore)&&d(\"WASyncdWamAppState\").incConflict()});d(\"WALogger\").LOG(p(),i.map(function(a){return a.name}));k=new(d(\"WASyncdMetrics\").SyncdEventFlow)();w.next=21;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(i.map(function(a){return d(\"WASyncdCollectionHandler\").applyAppStateSyncResponse(a,f.get(a.name),k)})));case 21:l=w.sent;k.end();d(\"WALogger\").LOG(o(),i.map(function(a){return a.name}));t=[];w.next=27;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(l.map(function(a){var c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!(a.state===d(\"WASyncdConst\").CollectionState.Conflict)){e.next=8;break}e.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGetPendingMutation\").getSyncPendingMutationsByCollectionInTransaction(a.name));case 3:e.t0=e.sent.length;c=e.t0>0;c?t.push(a.name):(a.state=d(\"WASyncdConst\").CollectionState.Success,j.push(a));e.next=15;break;case 8:if(!(a.state===d(\"WASyncdConst\").CollectionState.ConflictHasMore||a.state===d(\"WASyncdConst\").CollectionState.SuccessHasMore||a.state===d(\"WASyncdConst\").CollectionState.Success&&g.some(function(b){return b===a.name}))){e.next=12;break}t.push(a.name);e.next=15;break;case 12:j.push(a);e.next=15;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").updateLastSuccessfulSyncEndTimeInTransaction(a.name));case 15:case\"end\":return e.stop()}},null,this)})));case 27:return w.abrupt(\"return\",{doneCollections:j,refetchCollections:t});case 30:w.prev=30;w.t0=w[\"catch\"](4);if(!(w.t0 instanceof d(\"WASyncdError\").SyncdFatalError)){w.next=38;break}d(\"WALogger\").ERROR(n(),w.t0.message).sendLogs(\"syncd: fatal error: syncd global throws \"+w.t0.message);w.next=36;return b(\"regeneratorRuntime\").awrap(A(a,\"moving to fatal state: \"+w.t0.name+\" \"+w.t0.message+\" \"+w.t0.stack));case 36:u=a.map(function(a){return{state:d(\"WASyncdConst\").CollectionState.ErrorFatal,name:a}});return w.abrupt(\"return\",{doneCollections:u,refetchCollections:[]});case 38:d(\"WALogger\").WARN(m(),w.t0.message).sendLogs(\"syncd: retryable error: syncd global throws \"+w.t0.message);w.next=41;return b(\"regeneratorRuntime\").awrap(A(a,\"retryable error: \"+w.t0));case 41:v=a.map(function(a){return{state:d(\"WASyncdConst\").CollectionState.ErrorRetry,name:a,serverBackoff:w.t0.errorBackoff}});return w.abrupt(\"return\",{doneCollections:v,refetchCollections:[]});case 43:case\"end\":return w.stop()}},null,this,[[4,30]])}function x(a){var e,f,g,h,i,m,n,o,p,q,r;return b(\"regeneratorRuntime\").async(function(s){while(1)switch(s.prev=s.next){case 0:s.next=2;return b(\"regeneratorRuntime\").awrap(c(\"WASyncdRequestBuilder\")(a));case 2:e=s.sent;f=e.syncIqNode;g=e.collectionWithPendingMutationsIds;h=e.collectionWithEncryptedMutations;i=e.localCollectionVersions;m=e.collectionsToSkip;d(\"WASyncdMetricCriticalBootstrapStage\").reportSyncdCriticalBootstrapStage(d(\"WASyncdMetricCriticalBootstrapStage\").SyncdCriticalBootstrapStageType.REQUEST_BUILT);d(\"WALogger\").LOG(l(),a.map(function(a){var b;return\"\\n\\t\"+a+\" v\"+((b=i.get(a))!=null?b:\"(undefined)\")+\" \"+(((b=(b=g.get(a))==null?void 0:b.length)!=null?b:0)>0&&i.get(a)!=null?\" with local changes\":\"\")}));s.next=12;return b(\"regeneratorRuntime\").awrap(A(a,\"before sendIq\"));case 12:s.next=14;return b(\"regeneratorRuntime\").awrap(d(\"WADeprecatedSendIq\").deprecatedSendIq(f,d(\"WASyncdResponseParser\").syncResponseParser));case 14:n=s.sent;d(\"WALogger\").LOG(k(),a);d(\"WASyncdMetricCriticalBootstrapStage\").reportSyncdCriticalBootstrapStage(d(\"WASyncdMetricCriticalBootstrapStage\").SyncdCriticalBootstrapStageType.RESPONSE_RECEIVED);if(!n.success){s.next=25;break}d(\"WASyncdMetricCriticalBootstrapStage\").reportSyncdCriticalBootstrapStage(d(\"WASyncdMetricCriticalBootstrapStage\").SyncdCriticalBootstrapStageType.RESPONSE_PARSED_VALID);s.next=21;return b(\"regeneratorRuntime\").awrap(A(a,\"after sendIq success\"));case 21:o=n.result;d(\"WALogger\").LOG(j(),o.map(function(a){var b=\"\\n\"+a.name;a.version!=null&&(b+=\"\\n\\tupdated to version \"+a.version);a.snapshot!=null&&(b+=\"\\n\\tcontains snapshot\");a.patches!=null&&(b+=\"\\n\\tcontains \"+a.patches.length+\" patches\");return b}));o.forEach(function(a){var b=g.get(a.name);b&&(a.syncedPendingMutationsId=b);b=h.get(a.name);b&&(a.syncedEncryptedMutations=b)});return s.abrupt(\"return\",{collectionDetails:o,localCollectionVersions:i,collectionsToUpload:m});case 25:p=n.errorCode,q=n.errorText,r=n.errorBackoff;throw y(p,q,r);case 27:case\"end\":return s.stop()}},null,this)}function y(a,b,c){switch(a){case 400:d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.XMPP_BAD_REQUEST_GLOBAL_ERROR);return new(d(\"WASyncdError\").SyncdFatalError)(b);case 404:d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.XMPP_NOT_FOUND_GLOBAL_ERROR);return new(d(\"WASyncdError\").SyncdFatalError)(b);case 405:d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.XMPP_BAD_METHOD_GLOBAL_ERROR);return new(d(\"WASyncdError\").SyncdFatalError)(b);case 406:d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR);return new(d(\"WASyncdError\").SyncdFatalError)(b);default:return new(d(\"WASyncdError\").SyncdRetryableError)(b,c)}}function z(a){var c,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:g.prev=0;c=5;g.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").bulkGetCollectionVersionsInTransaction(a));case 4:e=g.sent;f=e.filter(Boolean).map(function(a){var b;b=((b=a.lastSyncAttemptStartTimes)!=null?b:[]).slice(-c+1);return{collection:a.collection,lastSyncAttemptStartTimes:[].concat(b,[d(\"WATimeUtils\").unixTimeMs()])}});g.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").bulkSetCollectionSyncAttemptStartTimesInTransaction(f));case 8:g.next=13;break;case 10:g.prev=10,g.t0=g[\"catch\"](0),d(\"WALogger\").ERROR(i(),g.t0).tags(\"syncd\").sendLogs(\"syncd: cannot log collection sync start\");case 13:case\"end\":return g.stop()}},null,this,[[0,10]])}function A(a,c){return(h||(h=b(\"Promise\"))).all(a.map(function(a){return d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(a,c)}))}g.serverSync=a}),98);\n__d(\"WASyncd\",[\"Promise\",\"WABaseGlobals\",\"WAGetCollectionVersion\",\"WAGetMissingKey\",\"WAGetPendingMutation\",\"WAGetSyncAction\",\"WAGetSyncKey\",\"WALogger\",\"WASyncdCollectionsStateMachine\",\"WASyncdConst\",\"WASyncdCryptoUtils\",\"WASyncdDisabled\",\"WASyncdKeyCache\",\"WASyncdMetricCriticalBootstrapStage\",\"WASyncdMetricFatalError\",\"WASyncdOrphan\",\"WASyncdServerSync\",\"WASyncdWamAppState\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: syncing pending mutations and blocked collections due to app resume\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: syncPendingMutationsAndBlockedCollections: [\",\"]\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: syncPendingMutationsAndBlockedCollections\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: retry is in flight\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: state machine tick\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: fatal error: expired collections\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: cleanup after handleRetry()\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: exception during handleRetry(): \",\"\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: server sync retry successful\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: initiate server sync retry\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: cleanup after sync()\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: exception during sync(): \",\"\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: server sync successful\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: initiate server sync\"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: no collections to sync\"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: dirty collections: \",\"\"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: syncBlockedCollections:\\n    \\tmoving blocked collections to dirty: [\",\"]\\n    \\tadding inflight collections to pending: [\",\"]\"],[\"syncd: syncBlockedCollections:\\n    \\\\tmoving blocked collections to dirty: [\",\"]\\n    \\\\tadding inflight collections to pending: [\",\"]\"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: sync blocked collections: \",\"\"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd:\\n        key id: \",\"\\n        key timestamp: \",\"\\n        key device indexes: \",\"\"]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: \",\" unsupported mutations\"]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd:\\n        \",\" successful \",\" mutations\\n        \",\" orphan \",\" mutations,\\n        \",\" failed \",\" mutations\"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: local version (\",\")for \",\" >= server version (\",\"); will not mark for sync.\"]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: local version (\",\") for \",\" less than server version (\",\"); will mark for sync.\"]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: server version for \",\" missing; will mark for sync.\"]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: local version for \",\" missing; will mark for sync.\"]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: start filter collections: \",\"\"]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: \",\" state before sync: \",\"\"]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: marking for sync: \",\"\"]);J=function(){return a};return a}var K=1e3,L=1e3*60*60,M=2,N=new Set(),O=new Set(),P,Q=!1,R=0,S=0;function T(a,e){var f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:if(!(e!=null)){g.next=6;break}g.next=3;return b(\"regeneratorRuntime\").awrap(U(a,e));case 3:g.t0=g.sent;g.next=7;break;case 6:g.t0=a;case 7:f=g.t0;d(\"WALogger\").LOG(J(),f);f.forEach(function(a){var b=c(\"WASyncdCollectionsStateMachine\").getCollectionState(a);d(\"WALogger\").LOG(I(),a,b);b===d(\"WASyncdConst\").CollectionSyncState.UpToDate?c(\"WASyncdCollectionsStateMachine\").moveCollectionsToDirty([a]):b===d(\"WASyncdConst\").CollectionSyncState.Dirty&&(O=new Set([].concat(Array.from(O),[a])))});g.next=12;return b(\"regeneratorRuntime\").awrap(c(\"WASyncdCollectionsStateMachine\").persistToDb());case 12:return g.abrupt(\"return\",V());case 13:case\"end\":return g.stop()}},null,this)}function U(a,c){var e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:d(\"WALogger\").LOG(H(),a);g.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCollectionVersion\").bulkGetCollectionVersionsInTransaction(a));case 3:e=g.sent;f=new Map(a.map(function(a,b){return[a,(a=e[b])==null?void 0:a.version]}));return g.abrupt(\"return\",a.filter(function(a){var b=f.get(a);if(b==null){d(\"WALogger\").LOG(G(),a);return!0}var e=c.get(a);if(e==null){d(\"WALogger\").LOG(F(),a);return!0}if(b<e){d(\"WALogger\").LOG(E(),b,a,e);return!0}d(\"WALogger\").LOG(D(),b,a,e);return!1}));case 6:case\"end\":return g.stop()}},null,this)}function a(){var a,c,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncAction\").countSyncActionsInTransaction());case 2:a=g.sent;d(\"WASyncdWamAppState\").setStoredMutationCount(a);g.next=6;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncAction\").getSyncActionsByActionStatesInTransaction([d(\"WASyncdConst\").SyncActionState.Malformed]));case 6:c=g.sent;d(\"WASyncdWamAppState\").setInvalidActionCount(c.length);g.next=10;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncAction\").getSyncActionsByActionStatesInTransaction([d(\"WASyncdConst\").SyncActionState.Unsupported]));case 10:e=g.sent;d(\"WASyncdWamAppState\").setUnsupportedActionCount(e.length);g.next=14;return b(\"regeneratorRuntime\").awrap(d(\"WAGetMissingKey\").getMissingKeyCountTransaction());case 14:f=g.sent,d(\"WASyncdWamAppState\").setMissingKeyCount(f);case 16:case\"end\":return g.stop()}},null,this)}function e(){var a,c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=7;break;e.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncAction\").getAllSyncActions());case 3:a=e.sent,Array.from(d(\"WASyncdConst\").Actions.members()).forEach(function(b){var c=a.filter(function(a){return a.action!=null&&a.action===b});if(c.length>0){var e=c.filter(function(a){return a.actionState===d(\"WASyncdConst\").SyncActionState.Success||a.actionState===d(\"WASyncdConst\").SyncActionState.Skipped}),f=c.filter(function(a){return a.actionState===d(\"WASyncdConst\").SyncActionState.Orphan});c=c.filter(function(a){return a.actionState===d(\"WASyncdConst\").SyncActionState.Malformed||a.actionState===d(\"WASyncdConst\").SyncActionState.Failed});d(\"WALogger\").DEV(C(),e.length,b,f.length,b,c.length,b)}}),c=a.filter(function(a){return a.actionState===d(\"WASyncdConst\").SyncActionState.Unsupported}),d(\"WALogger\").DEV(B(),c.length);case 7:case\"end\":return e.stop()}},null,this)}function f(){var a;return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=5;break;c.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGetSyncKey\").getAllSyncKeysInTransaction());case 3:a=c.sent,a.forEach(function(a){d(\"WALogger\").DEV(A(),d(\"WASyncdCryptoUtils\").syncKeyIdToHex(a.keyId),a.timestamp,a.fingerprint.deviceIndexes)});case 5:case\"end\":return c.stop()}},null,this)}function e(){var a=c(\"WASyncdCollectionsStateMachine\").getCollectionsInStateBlocked();d(\"WALogger\").LOG(z(),a);c(\"WASyncdCollectionsStateMachine\").moveCollectionsToDirty(a);O=new Set([].concat(Array.from(O),Array.from(N)));d(\"WALogger\").LOG(y(),a,Array.from(N));return V()}function V(){var a,e,f,g;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!d(\"WASyncdDisabled\").isSyncdDisabled()){i.next=2;break}return i.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve());case 2:a=c(\"WASyncdCollectionsStateMachine\").getCollectionsInStateDirty();d(\"WALogger\").LOG(x(),a);e=new Set(a.filter(function(a){return!N.has(a)}));if(!(e.size===0)){i.next=8;break}d(\"WALogger\").LOG(w());return i.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve());case 8:f=[];i.prev=9;N=new Set([].concat(Array.from(N),Array.from(e)));d(\"WALogger\").LOG(v());i.next=14;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdServerSync\").serverSync(Array.from(e)));case 14:f=i.sent;d(\"WALogger\").LOG(u());g=f.filter(function(a){return a.state===d(\"WASyncdConst\").CollectionState.ErrorRetry});g.length>0&&(S=g[0].serverBackoff||0,R=0);$(f);i.next=26;break;case 22:i.prev=22,i.t0=i[\"catch\"](9),d(\"WALogger\").LOG(t(),i.t0),c(\"WASyncdCollectionsStateMachine\").moveCollectionsToFiniteRetry(Array.from(e));case 26:i.prev=26;d(\"WALogger\").LOG(s());c(\"WASyncdCollectionsStateMachine\").persistToDb();N=new Set(Array.from(N).filter(function(a){return!e.has(a)}));Z();i.next=33;return b(\"regeneratorRuntime\").awrap(d(\"WABaseGlobals\").getDbImpls().handleSyncCompleted(f));case 33:return i.finish(26);case 34:case\"end\":return i.stop()}},null,this,[[9,22,26,34]])}function W(){if(d(\"WASyncdDisabled\").isSyncdDisabled())return;var a=new Set(c(\"WASyncdCollectionsStateMachine\").getCollectionsInStateRetry());if(a.size===0)return;P=setTimeout(function(){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:f.prev=0;Q=!0;R+=1;d(\"WALogger\").LOG(r());f.next=6;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdServerSync\").serverSync(Array.from(a)));case 6:e=f.sent;d(\"WALogger\").LOG(q());$(e);f.next=15;break;case 11:f.prev=11,f.t0=f[\"catch\"](0),d(\"WALogger\").LOG(p(),f.t0),c(\"WASyncdCollectionsStateMachine\").moveCollectionsToFiniteRetry(Array.from(a));case 15:f.prev=15;d(\"WALogger\").LOG(o());Y();c(\"WASyncdCollectionsStateMachine\").persistToDb();Q=!1;Z();return f.finish(15);case 22:case\"end\":return f.stop()}},null,this,[[0,11,15,22]])},X(R,S))}function X(a,b){a=Math.pow(M,a)*K;return Math.min(Math.max(a,b),L)}function Y(){var a=c(\"WASyncdCollectionsStateMachine\").getExpiredCollections();a.length>0&&(c(\"WASyncdCollectionsStateMachine\").moveCollectionsToFatal(a),d(\"WALogger\").ERROR(n()).sendLogs(\"syncd: fatal error: expired collections\"),d(\"WASyncdMetricFatalError\").reportSyncdFatalError(d(\"WASyncdMetricFatalError\").SyncdFatalErrorType.TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D))}function Z(){d(\"WALogger\").LOG(m());c(\"WASyncdCollectionsStateMachine\").getCollectionsInStateDirty().length>0&&(O=new Set(Array.from(O).filter(function(a){return N.has(a)})),V());var a=c(\"WASyncdCollectionsStateMachine\").getCollectionsInStateRetry();if(a.length>0){if(Q){d(\"WALogger\").LOG(l());return}P!=null&&clearTimeout(P);O=new Set(Array.from(O).filter(function(b){return!a.includes(b)}));W()}c(\"WASyncdCollectionsStateMachine\").getCollectionsInStateFatal().length>0&&d(\"WABaseGlobals\").getDbImpls().handleSyncdFatal({collections:c(\"WASyncdCollectionsStateMachine\").getCollectionsInStateFatal()})}function $(a){return a.forEach(function(a){if(a.state===d(\"WASyncdConst\").CollectionState.Success&&!O.has(a.name))return c(\"WASyncdCollectionsStateMachine\").moveCollectionsToUpToDate([a.name]);if(a.state===d(\"WASyncdConst\").CollectionState.ErrorRetry){d(\"WASyncdMetricCriticalBootstrapStage\").reportSyncdCriticalBootstrapStage(d(\"WASyncdMetricCriticalBootstrapStage\").SyncdCriticalBootstrapStageType.ENTERED_RETRY_MODE);return c(\"WASyncdCollectionsStateMachine\").moveCollectionsToFiniteRetry([a.name])}if(a.state===d(\"WASyncdConst\").CollectionState.ErrorFatal)return c(\"WASyncdCollectionsStateMachine\").moveCollectionsToFatal([a.name]);if(a.state===d(\"WASyncdConst\").CollectionState.Blocked&&!O.has(a.name))return c(\"WASyncdCollectionsStateMachine\").moveCollectionsToBlocked([a.name])})}function aa(){var a,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:d(\"WALogger\").LOG(k());g.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGetPendingMutation\").getAllSyncPendingMutationsInTransaction());case 3:a=g.sent,e=c(\"WASyncdCollectionsStateMachine\").getCollectionsInStateBlocked(),c(\"WASyncdCollectionsStateMachine\").moveCollectionsToDirty(e),f=a.map(function(a){return a.collection}).concat(e),f.length>0&&(d(\"WALogger\").LOG(j(),f),T(f));case 8:case\"end\":return g.stop()}},null,this)}function ba(){return c(\"WASyncdCollectionsStateMachine\").loadStatesFromDb().then(function(){return Z()})}function ca(){return b(\"regeneratorRuntime\").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdOrphan\").applyAllOrphansAndUnsupported());case 2:d(\"WALogger\").LOG(i());a.next=5;return b(\"regeneratorRuntime\").awrap(aa());case 5:case\"end\":return a.stop()}},null,this)}function da(){return d(\"WABaseGlobals\").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0,PendingMutationStore:!0,MissingKeyStore:!0,SyncKeyStore:!0},function(a){var e=a.SyncActionStore,f=a.CollectionVersionStore,g=a.PendingMutationStore,i=a.MissingKeyStore;a=a.SyncKeyStore;return(h||(h=b(\"Promise\"))).all([e.clear(),f.clear(),g.clear(),i.clear(),a.clear()]).then(function(){c(\"WASyncdCollectionsStateMachine\").clean(),d(\"WASyncdKeyCache\").clearSyncKeysCache()})})}g.markCollectionsForSync=T;g.reportWam=a;g.logKeysInfoInIntern=f;g.syncBlockedCollections=e;g.initializeStateMachine=ba;g.processOnAppResume=ca;g.clearSyncdData=da}),98);\n__d(\"WAHandleSyncdNotification\",[\"WAGlobals\",\"WALogger\",\"WASyncd\",\"WAWap\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleSyncdNotification with id: \",\"\"]);h=function(){return a};return a}function a(a){return d(\"WAWap\").wap(\"ack\",{\"class\":\"notification\",id:d(\"WAWap\").CUSTOM_STRING(a),to:d(\"WAWap\").S_WHATSAPP_NET,type:\"server_sync\"})}function c(a){var c,e,f,g;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:c=a.stanzaId;e=a.notification,f=e.collections,g=e.deleted;d(\"WALogger\").LOG(h(),c);if(!g){i.next=8;break}i.next=6;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getDbImpls().handleSyncdFatal({fromServer:!0}));case 6:i.next=10;break;case 8:i.next=10;return b(\"regeneratorRuntime\").awrap(d(\"WASyncd\").markCollectionsForSync(Array.from(f.keys()),f));case 10:case\"end\":return i.stop()}},null,this)}g.makeAckForSyncdNotification=a;g.handleSyncdNotification=c}),98);\n__d(\"MAWHandleNotification\",[\"Promise\",\"WAGlobals\",\"WAHandleServerNotification\",\"WAHandleSyncdNotification\",\"WAProtocolQueue\",\"WAProtocolQueueState\",\"WAResolvable\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(a){switch(a.type){case\"server\":return d(\"WAHandleServerNotification\").handleServerNotification(a);case\"syncd\":return d(\"WAHandleSyncdNotification\").handleSyncdNotification(a);default:a.type;return(h||(h=b(\"Promise\"))).resolve()}}function j(a){switch(a.type){case\"devices\":case\"thread\":case\"mediaretry\":case\"group\":a.ack;var b=babelHelpers.objectWithoutPropertiesLoose(a,[\"ack\"]);return b;default:a.type;return}}function k(a){switch(a.type){case\"devices\":return{consumerRetries:0,jid:a.notification.jid,notification:a,priority:d(\"WAGlobals\").getConfig().isIdleOQM1()?d(\"WAProtocolQueue\").WAProtocolQueuePriorityLow:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh,stanzaId:a.stanzaId,type:\"notification\"};case\"group\":return{consumerRetries:0,jid:a.notification.groupJid,notification:a,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh,stanzaId:a.stanzaId,type:\"notification\"};case\"mediaretry\":return{consumerRetries:0,jid:a.notification.from.chat,notification:a,priority:d(\"WAGlobals\").getConfig().isIdleOQM1()?d(\"WAProtocolQueue\").WAProtocolQueuePriorityLow:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh,stanzaId:a.stanzaId,type:\"notification\"};case\"thread\":return{consumerRetries:0,jid:a.notification.chatJid,notification:a,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh,stanzaId:a.stanzaId,type:\"notification\"};default:a;throw c(\"err\")(\"Received unsupported notification type: \"+a.type)}}function l(a){return d(\"WAProtocolQueueState\").persistStanza(k(a))}function a(a){var c=new(d(\"WAResolvable\").Resolvable)();return i(a).then(function(){var d=j(a),e=(h||(h=b(\"Promise\"))).resolve();d&&(e=l(d));c.resolve();return e}).then(function(){return a.ack()})}g.notificationHandler=a}),98);\n__d(\"MAWHandleAbPropsRefreshNotification\",[\"MAWHandleNotification\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){var b=a.id,c=a.makeAck,e=a.offline;a=a.serverTs;return d(\"MAWHandleNotification\").notificationHandler({ack:c,offline:e,stanzaId:b,ts:a,type:\"server\"})};g.handleAbPropsRefreshNotification=a}),98);\n__d(\"WADecryptPkmsgOrMsg\",[\"WACryptoManagerUtils\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b=a.from,c=a.ciphertext,e=a.encType,f=a.cb;a=a.ctx;return d(\"WACryptoManagerUtils\").decryptMsg(e,b,c,a).then(function(a){if(a.success===!1)return f(a);return a.value!=null?f(d(\"WAResultOrError\").makeResult({plaintext:a.value.plaintext,remoteIdentity:a.value.remoteIdentity})):f(d(\"WAResultOrError\").makeError(\"missing-content\"))})}g.decryptPkmsgOrMsg=a}),98);\n__d(\"WAParseMessageTransport\",[\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a){return{version:\"v3\",type:\"error\",error:a}}function i(a,b){return a!=null&&(b.dsm==null||b.dsm.destinationJid==null||b.dsm.destinationJid!==a)}function a(a,b){var c=a.payload;a=a.protocol;if(c==null&&a==null)return h(\"There is no payload and protocol in the message transport\");else if(a==null)return h(\"There is no protocol part in the message transport\");var e=a.integral;if(e==null)return h(\"There is no integral part in the message transport\");else if(e.padding==null)return h(\"There is no padding in the message transport\");else if(i(b,e))return h(\"The recipient does not match the device sent message recipient\");else if(d(\"decodeProtobuf\").getUnknownFields(e)!=null)return babelHelpers[\"extends\"]({},h(\"There are unknown fields in the integral\"),{futureProof:c==null?void 0:c.futureProof});if(c!=null){b=c.applicationPayload;return b==null?h(\"There is no applicationPayload payload in the message transport\"):{type:\"applicationPayload\",applicationPayload:b,skdm:j(a.ancillary),icdc:k(a.ancillary)}}e=j(a.ancillary);return e!=null?{type:\"skdm\",skdm:e,icdc:k(a.ancillary)}:{type:\"unknown\"}}function j(a){return a==null?null:a.skdm}function k(a){return a==null?null:a.icdc}g.parseMessageTransport=a}),98);\n__d(\"WAHandleAppdataMessageProtocol\",[\"WAMsgTransport.pb\",\"WAParseMessageTransport\",\"WAResultOrError\",\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){a=d(\"decodeProtobuf\").decodeProtobuf(d(\"WAMsgTransport.pb\").MessageTransportSpec,a);a=d(\"WAParseMessageTransport\").parseMessageTransport(a,null);switch(a.type){case\"error\":return d(\"WAResultOrError\").makeError(a.error);case\"skdm\":return d(\"WAResultOrError\").makeError(\"skdm appdata is not supported\");case\"unknown\":return d(\"WAResultOrError\").makeError(\"unknown appdata\");default:a.type;return d(\"WAResultOrError\").makeResult(a.applicationPayload)}}g.decodeAppdata=a}),98);\n__d(\"WAStanzaRootTag\",[],(function(a,b,c,d,e,f){\"use strict\";a=\"notification\";b=\"receipt\";c=\"message\";d=\"call\";e=\"chatstate\";var g=\"presence\",h=\"appdata\",i=\"failure\",j=\"stream:error\",k=\"ib\",l=\"iq\",m=\"error\",n=\"success\",o=\"xmlstreamend\",p={NOTIFICATION:a,RECEIPT:b,MESSAGE:c,CHATSTATE:e,PRESENCE:g,APPDATA:h,CALL:d,IQ:l,IB:k,STREAM_ERROR:j,FAILURE:i,SUCCESS:n,ERROR:m,XML_STREAM_END:o};f.NOTIFICATION=a;f.RECEIPT=b;f.MESSAGE=c;f.CALL=d;f.CHATSTATE=e;f.PRESENCE=g;f.APPDATA=h;f.FAILURE=i;f.STREAM_ERROR=j;f.IB=k;f.IQ=l;f.ERROR=m;f.SUCCESS=n;f.XML_STREAM_END=o;f.STANZA_ROOT_TAG=p}),66);\n__d(\"MAWHandleAppdataMessage\",[\"Promise\",\"WADecryptPkmsgOrMsg\",\"WAHandleAppdataMessageProtocol\",\"WAProtocolQueue\",\"WAProtocolQueueState\",\"WAResolvable\",\"WAStanzaRootTag\",\"WATagsLogger\",\"asyncToGeneratorRuntime\",\"promiseDone\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Appdata contains unexpected message transport. \",\"\"]);i=function(){return a};return a}var j=d(\"WATagsLogger\").TAGS([\"backend\",\"appdata\"]);a=function(a,e){var f=a.parsedAppdata,g=a.sendDeliveryReceipt,k=a.sendRetryReceipt,l=new(d(\"WAResolvable\").Resolvable)();return d(\"WADecryptPkmsgOrMsg\").decryptPkmsgOrMsg({cb:m,ciphertext:f.ciphertext,ctx:e,encType:f.encType,from:f.from});function m(a){return(h||(h=b(\"Promise\"))).resolve().then(function(){if(!a.success)return(h||(h=b(\"Promise\"))).resolve(babelHelpers[\"extends\"]({error:a.error,type:\"Undecrypted\"},f));else return(h||(h=b(\"Promise\"))).resolve(babelHelpers[\"extends\"]({type:\"Decrypted\"},f,a.value))}).then(function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(a.type===\"Undecrypted\"){c(\"promiseDone\")(k());return\"NO_ACK\"}var b=d(\"WAHandleAppdataMessageProtocol\").decodeAppdata(a.plaintext);if(!b.success){j.ERROR(i(),b.error);return\"NO_ACK\"}l.resolve();yield d(\"WAProtocolQueueState\").persistStanza({appdata:d(\"WAProtocolQueue\").appdataApplicationProtocol(b.value),consumerRetries:0,deviceJid:a.from,jid:a.author,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityLow,stanzaId:a.stanzaId,type:d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.APPDATA});c(\"promiseDone\")(g());return\"NO_ACK\"});return function(b){return a.apply(this,arguments)}}())}};g.handleAppdataMessage=a}),98);\n__d(\"MAWHandleChatState\",[\"MAWBridge\",\"MAWBridgeTypesCreators\",\"MAWGlobals\",\"Promise\",\"WAJids\",\"WALogger\",\"asyncToGeneratorRuntime\",\"promiseDone\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"ReceivedChatState route was unsupported, falling back on UI handler\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleChatStatus status for \",\": \",\"\"]);j=function(){return a};return a}function k(a,b,c){return l.apply(this,arguments)}function l(){l=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,e,f){d(\"WALogger\").LOG(j(),a,f);var g=(yield d(\"MAWGlobals\").getDbImpls().getThreadIdByJid(a));if(g!=null){var k={tag:\"ReceivedChatState\",value:d(\"MAWBridgeTypesCreators\").createBridgeReceivedChatState(g,a,e,f)};c(\"promiseDone\")(d(\"MAWBridge\").getBridge().sendAndReceive(\"event\",\"receivedChatState\",{senderId:d(\"WAJids\").extractUserId(e),state:f,threadId:g,threadJid:a}),null,function(){d(\"WALogger\").ERROR(i()),d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"uiUpdate\",{events:[k]})})}return(h||(h=b(\"Promise\"))).resolve(\"NO_ACK\")});return l.apply(this,arguments)}a=function(a){var b=a.jid,c=a.participant;a=a.status;return k(b,c,a)};e=function(a){var b=a.jid;a=a.status;return k(b,b,a)};g.handleGroupChatState=a;g.handleIndividualChatState=e}),98);\n__d(\"MAWHandleFailure\",[\"MAWBridge\",\"MAWQplProxy\",\"MAWRotateCAT\",\"Promise\",\"WAHandleFailureUtils\",\"WALogger\",\"WAOdsEnums\",\"asyncToGeneratorRuntime\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"failure reason \",\" not implemented yet\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleFailure: got failure code \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Crypto auth token Error: \",\", rotating CAT\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received <failure> stanza with \",\" code. ReregisterPhone\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received <failure> stanza with \",\" code. DeregisterPhone\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleFailure: got failure code \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received <failure> stanza with \",\" code. DeregisterPhone\"]);o=function(){return a};return a}a=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=a.reason;d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"odsBumpEntityKey\",{entity:d(\"WAOdsEnums\").Entity.STREAM_ERROR,key:\"failure.\"+a});d(\"MAWQplProxy\").sendQPLDoubleAnnotationsThroughBridge(c(\"qpl\")._(1056839232,\"112\"),{waiLoginError:Number(a)});switch(a){case d(\"WAHandleFailureUtils\").FAILURE_CODES.BANNED:d(\"WALogger\").WARN(o(),a);yield d(\"WAHandleFailureUtils\").deregisterPhone();break;case d(\"WAHandleFailureUtils\").FAILURE_CODES.TEMP_BANNED:d(\"WALogger\").WARN(n(),a);break;case d(\"WAHandleFailureUtils\").FAILURE_CODES.NOT_FOUND:d(\"WALogger\").WARN(m(),a);yield d(\"WAHandleFailureUtils\").deregisterPhone();break;case d(\"WAHandleFailureUtils\").FAILURE_CODES.GENERIC_FAILURE:case d(\"WAHandleFailureUtils\").FAILURE_CODES.NOT_AUTHORIZED:d(\"WALogger\").WARN(l(),a);yield d(\"WAHandleFailureUtils\").reregisterPhone();break;case d(\"WAHandleFailureUtils\").FAILURE_CODES.CAT_EXPIRED:case d(\"WAHandleFailureUtils\").FAILURE_CODES.CAT_INVALID:d(\"WALogger\").WARN(k(),a);yield d(\"MAWRotateCAT\").rotateCAT();break;case d(\"WAHandleFailureUtils\").FAILURE_CODES.INTERNAL_ERROR:case d(\"WAHandleFailureUtils\").FAILURE_CODES.SERVER_UNAVAILABLE:d(\"WALogger\").WARN(j(),a);break;default:d(\"WALogger\").WARN(i(),a);return(h||(h=b(\"Promise\"))).reject(\"failure reason \"+a+\" not implemented yet\")}return(h||(h=b(\"Promise\"))).resolve(\"NO_ACK\")});return function(b){return a.apply(this,arguments)}}();g.handleLoginFailure=a}),98);\n__d(\"WAHandleDeviceChangeNotification\",[\"WAGlobals\",\"WAJobDefinitions\",\"WAJobs\",\"WALogger\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to notify \",\" contacts of device change\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Notified \",\" contacts of device change\"]);j=function(){return a};return a}function a(a,c){var e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:if(!c){g.next=2;break}return g.abrupt(\"return\");case 2:e=d(\"WAGlobals\").getMyUserJid();if(!(a!==e)){g.next=5;break}return g.abrupt(\"return\");case 5:g.next=7;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getDbImpls().loadRecentParticipants(d(\"WAGlobals\").getConfig().maxUsersForNotifyDeviceChange(),e));case 7:f=g.sent;g.next=10;return b(\"regeneratorRuntime\").awrap(d(\"WAJobs\").getJobManager().waitUntilPersisted(d(\"WAJobDefinitions\").createStartJobInfo(\"notifyDeviceChange\",{uniqueJob:!0,users:f})).then(function(){d(\"WALogger\").LOG(j(),f.size)})[\"catch\"](function(a){d(\"WALogger\").LOG(i(),f.size),d(\"WALogger\").ERROR(h(),a)}));case 10:case\"end\":return g.stop()}},null,this)}g.notifyDeviceChange=a}),98);\n__d(\"WAProtocolQueueHandleNotification\",[\"WAGlobals\",\"WAICDCUtils\",\"WAJobDefinitions\",\"WAJobs\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var c,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:c=a.notification,e=c.jid,f=c.icdcInfo;if(!(f==null)){g.next=3;break}return g.abrupt(\"return\");case 3:if(!h(e,f)){g.next=8;break}g.next=6;return b(\"regeneratorRuntime\").awrap(i(f));case 6:g.next=10;break;case 8:g.next=10;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return a.storage.saveICDC(e,f)},{operationType:\"save_icdc\",flush:!0,afterInit:!0}));case 10:case\"end\":return g.stop()}},null,this)}function h(a,b){if(a!==d(\"WAGlobals\").getMyUserJid())return!1;return b==null||d(\"WAICDCUtils\").isICDCIndexInvalid(b)||(b==null?void 0:b.dirty)?!0:!1}function i(a){var c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:a==null?c=\"empty\":a.dirty?c=\"dirty\":c=\"invalidIndex\";e.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAJobs\").getJobManager().waitUntilPersisted(d(\"WAJobDefinitions\").jobSerializers.computeAndUploadICDCInfo(c,\"device_notification\",a==null?void 0:a.sequence)));case 3:case\"end\":return e.stop()}},null,this)}g.handleICDC=a;g.doesItNeedToComputeICDC=h;g.computeAndSaveICDC=i}),98);\n__d(\"WADeviceNotificationFlushable\",[\"Promise\",\"WAGlobals\",\"WAHandleDeviceChangeNotification\",\"WAOfflineUtils\",\"WAProtocolQueueHandleNotification\",\"WAScheduleAfterOfflineResume\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"flushing device notification has no payload to saveICDC\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"flushing device notification failed to saveICDC: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"flushing device notification has no payload to computeAndSaveICDC\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"flushing device notification failed to computeAndSaveICDC: \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"flushing device notification payload with \",\" entries from \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"flushing device notification payload\"]);n=function(){return a};return a}a=function(){function a(){this.$1=[]}var c=a.prototype;c.handleDeviceNotification=function(a){a.ack;var b=babelHelpers.objectWithoutPropertiesLoose(a,[\"ack\"]);this.$1.push(b.notification);return a.ack()};c.flush=function(a,c,e){var f,g,o,p,q,r,s,t,u,v,w,x,y;return b(\"regeneratorRuntime\").async(function(z){while(1)switch(z.prev=z.next){case 0:e.addPoint(\"device_notification_flushable_flush_start\");c.LOG(n());if(!(this.$1.length===0)){z.next=5;break}e.addPoint(\"device_notification_flushable_flush_empty\");return z.abrupt(\"return\");case 5:f=new Map(),g=this.$1,this.$1=[],(o=g,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]());case 9:if(!p){z.next=15;break}if(!(q>=o.length)){z.next=12;break}return z.abrupt(\"break\",24);case 12:r=o[q++];z.next=19;break;case 15:q=o.next();if(!q.done){z.next=18;break}return z.abrupt(\"break\",24);case 18:r=q.value;case 19:s=r,t=s.jid,f.set(t,s);case 22:z.next=9;break;case 24:u=Array.from(f.values());e.addPoint(\"device_notification_flushable_flush_non_empty\",{\"int\":{payloadLength:g.length,dedupedPayloadLength:u.length}});c.LOG(m(),u.length,Array.from(f.keys()).join(\",\"));e.addPoint(\"device_notification_flushable_update_user_devices_start\");z.next=30;return b(\"regeneratorRuntime\").awrap(a.cryptoManager.storage.updateUserDevicesInfo(u.map(function(a){return babelHelpers[\"extends\"]({},a,{icdcInfo:null})})));case 30:e.addPoint(\"device_notification_flushable_update_user_devices_end\");e.addPoint(\"device_notification_flushable_flush_notify_device_start\");z.next=34;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(u.map(function(a){a=a.jid;return d(\"WAHandleDeviceChangeNotification\").notifyDeviceChange(a,d(\"WAGlobals\").getWaOneQueue().getMode()!==d(\"WAOfflineUtils\").ServerRPCMode.ONLINE)})));case 34:e.addPoint(\"device_notification_flushable_flush_notify_device_end\");v=[];w=[];for(x=0;x<u.length;x++)y=u[x],d(\"WAProtocolQueueHandleNotification\").doesItNeedToComputeICDC(y.jid,y.icdcInfo)?w.push(y):v.push(y);e.addPoint(\"device_notification_flushable_flush_compute_and_save_icdc\",{\"int\":{computeAndSave:w.length,justSave:v.length}});w.length>0?(e.addPoint(\"device_notification_flushable_finish_compute_and_save_start\"),d(\"WAScheduleAfterOfflineResume\").scheduleAfterOfflineResume({code:function(){return(h||(h=b(\"Promise\"))).all(w.map(function(a){return d(\"WAProtocolQueueHandleNotification\").computeAndSaveICDC(a.icdcInfo)}))[\"catch\"](function(a){c.ERROR(l(),a.toString())}).then(function(){})},combine:!0,id:\"pruneSentBytesCache\"}),e.addPoint(\"device_notification_flushable_finish_compute_and_save_end\")):c.LOG(k());if(!(v.length>0)){z.next=47;break}e.addPoint(\"device_notification_flushable_finish_just_save_start\");z.next=44;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(v.map(function(b){if(b.icdcInfo==null)return;return a.cryptoManager.storage.saveICDC(b.jid,b.icdcInfo)}))[\"catch\"](function(a){c.ERROR(j(),a.toString())}));case 44:e.addPoint(\"device_notification_flushable_finish_just_save_end\");z.next=48;break;case 47:c.LOG(i());case 48:e.addPoint(\"device_notification_flushable_flush_end\");case 49:case\"end\":return z.stop()}},null,this)};return a}();c=new a();g.DeviceNotificationFlushable=a;g.deviceNotificationFlushable=c}),98);\n__d(\"MAWHandleFbDeviceChangeNotification\",[\"Promise\",\"WADeviceNotificationFlushable\",\"WAJids\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;a=function(a){a.ctx;var c=a.devices,e=a.dhash,f=a.icdcInfo,g=a.id,i=a.makeAck,j=a.offline,k=a.serverTs;a=a.userJid;i={ack:i,notification:{devices:c.map(function(a){return{id:d(\"WAJids\").extractDeviceId(a.device),identity:a.identity,model:a.model,platform:a.platform}}),dhash:e,icdcInfo:f,jid:a,lastSyncTs:d(\"WATimeUtils\").unixTime(),notificationTs:k},offline:j,stanzaId:g,type:\"devices\"};return(h||(h=b(\"Promise\"))).resolve(d(\"WADeviceNotificationFlushable\").deviceNotificationFlushable.handleDeviceNotification(i))};g.handleFbDeviceChangeNotification=a}),98);\n__d(\"MAWHandleFbMultiwayNotification\",[\"Promise\"],(function(a,b,c,d,e,f){\"use strict\";var g;a=function(a){var b=a.domainJid,c=a.id,d=a.makeAck,e=a.multiwayBinaryVersion,f=a.multiwayElementValue,g=a.multiwayTransactionId,i=a.offline;a=a.serverTs;return h({domainJid:b,id:c,makeAck:d,multiwayBinaryVersion:e,multiwayElementValue:f,multiwayTransactionId:g,offline:i,serverTs:a})};function h(a){return(g||(g=b(\"Promise\"))).resolve(a.makeAck())}f.handleFbMultiwayNotification=a}),66);\n__d(\"MAWHandleFbThreadNotification\",[\"MAWHandleNotification\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){var b=a.chatJid,c=a.folderId,e=a.hasConnected,f=a.id,g=a.makeAck,h=a.offline;a=a.serverTs;var i=[];c!=null&&i.push({folderId:c,type:\"folder\"});e&&i.push({type:\"connected\"});return d(\"MAWHandleNotification\").notificationHandler({ack:g,notification:{actions:i,chatJid:b,ts:a},offline:h,stanzaId:f,type:\"thread\"})};g.handleFbThreadNotification=a}),98);\n__d(\"MAWHandleGroupNotification\",[\"MAWHandleNotification\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){var b=a.action,c=a.id,e=a.makeAck;a=a.offline;return d(\"MAWHandleNotification\").notificationHandler({ack:e,notification:b,offline:a,stanzaId:c,type:\"group\"})};g.handleGroupNotification=a}),98);\n__d(\"MAWHandleGroupReceipt\",[\"Promise\",\"WAProtocolQueue\",\"WAProtocolQueueState\",\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleGroupReceipts error: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"start handling...\"]);j=function(){return a};return a}var k=d(\"WATagsLogger\").TAGS([\"backend\",\"handleGroupReceipt\"]);a=function(a){k.DEV(j());return(h||(h=b(\"Promise\"))).resolve().then(function(){switch(a.aggregatedType){case\"none\":var b;b={chat:a.chat,externalIds:[a.stanzaId],from:{author:a.receiptSender,chat:a.chat,groupJid:a.chat,type:\"group\"},messageAuthor:a.author,offline:(b=a.offline)!=null?b:null,receiptType:\"group\",stanzaId:a.stanzaId,ts:a.serverTs,type:a.receiptType};return d(\"WAProtocolQueueState\").persistStanza({consumerRetries:0,jid:a.chat,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityLow,receipt:b,stanzaId:a.stanzaId,type:\"receipt\"});case\"sender\":b=a.stanzaIds[0];var c={chat:a.chat,externalIds:a.stanzaIds,from:{author:a.receiptSender,chat:a.chat,groupJid:a.chat,type:\"group\"},messageAuthor:a.author,offline:a.offline,receiptType:\"group\",stanzaId:b,ts:a.serverTs,type:a.receiptType};return d(\"WAProtocolQueueState\").persistStanza({consumerRetries:0,jid:a.chat,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityLow,receipt:c,stanzaId:b,type:\"receipt\"});default:a.aggregatedType;c={chat:a.chat,externalId:a.stanzaId,messageAuthor:a.author,offline:a.offline,receiptType:\"group-server-agg\",receivers:a.receiptSenders,stanzaId:a.stanzaId,type:a.receiptType};return d(\"WAProtocolQueueState\").persistStanza({consumerRetries:0,jid:a.chat,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityLow,receipt:c,stanzaId:a.stanzaId,type:\"receipt\"})}})[\"catch\"](function(a){k.ERROR(i(),a)}).then(function(){return a.makeAck()})};g.handleGroupReceipt=a}),98);\n__d(\"MAWHandleGroupRetryReceipt\",[\"Promise\",\"WAProtocolQueue\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;a=function(a){var c=a.chat,e=a.makeAck,f=a.offline;a=a.retryReceipt;var g=a.keys,i=a.receiptSender,j=a.recipient,k=a.regId,l=a.retryCount,m=a.stanzaId;a=a.timestamp;i={category:null,externalId:m,from:{author:i,chat:c,groupJid:c,type:\"group\"},keys:g,offline:f,recipient:j,regId:k,retryCount:l,timestamp:a};void d(\"WAProtocolQueue\").protocolQueue().write({consumerRetries:0,jid:c,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityLow,retry:i,stanzaId:m,type:\"retryReceipt\"});return(h||(h=b(\"Promise\"))).resolve(e())};g.handleGroupRetryReceipt=a}),98);\n__d(\"MAWAdjustEphemerality\",[\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){b;b=a.ephemeralLastUpdatedOrSetTimestamp===d(\"WATimeUtils\").DEFAULT_UNIXTIME?b:a.ephemeralLastUpdatedOrSetTimestamp;return babelHelpers[\"extends\"]({},a,{ephemeralLastUpdatedOrSetTimestamp:b})}g.adjustEphemerality=a}),98);\n__d(\"MAWGetMsgByProtocolIdApi\",[\"MAWDbMsgTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"getMsgsByProtocolMsgIdsTxn\",function(a){return function(b){return d(\"MAWDbMsgTxns\").getMsgsByProtocolMsgId(a,b)}});b=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"getMsgByProtocolMsgIds\",function(a){return function(b){return a.messages.where(\"externalId\").equals(b.externalId).toArray().then(function(a){return a.some(function(a){return a.author===b.author&&a.threadJid===b.chat})})}});c=d(\"MAWIndexedDb\").makeSignalTransactor({stanzaQueue:d(\"MAWTransactionMode\").READONLY},\"getMsgByProtocolMsgIds\",function(a){return function(b){return a.stanzaQueue.where(\"stanzaId\").equals(b.externalId).toArray().then(function(a){return a.some(function(a){return a.jid===b.chat})})}});g.getMsgsByProtocolMsgIdsTxn=a;g.getMsgExistenceByProtocolMsgId=b;g.getProtocolQueueExistenceByProtocolMsgIds=c}),98);\n__d(\"MAWReportingMeta\",[\"WAFranking\",\"WAFrankingTypes\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return a.frankingTag==null&&a.reportingTag==null?null:{frankingKey:null,frankingTag:a.frankingTag!=null?d(\"WAFrankingTypes\").castToFrankingTag(a.frankingTag):null,frankingVersion:d(\"WAFranking\").getFrankingVersion(),reportingContent:null,reportingTag:a.reportingTag}}g.getReportingMeta=a}),98);\n__d(\"WADecodeIncomingMsg\",[\"WALogger\",\"WALongInt\",\"WAMsgApplication.pb\",\"WAMsgTransport.pb\",\"WAParseMessageApplication\",\"WAParseMessageTransport\",\"WATimeUtils\",\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"decodeIncomingMsg called with unexpected encoding version: \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"instamadillo decodeIncomingMsg called with null applicationPayload\"]);i=function(){return a};return a}function j(a,b){return a.futureProof?{version:\"v3\",type:\"futureProof\",futureProof:a.futureProof,protobuf:b,subtype:null}:{version:\"v3\",type:\"error\",error:a.error}}function a(a,b,c,e){if(b===\"v2\")return{version:\"v2\",encoded:a};else if(b===\"v3\"){var f=d(\"decodeProtobuf\").decodeProtobufWithUnknowns(d(\"WAMsgTransport.pb\").MessageTransportSpec,a);f=d(\"WAParseMessageTransport\").parseMessageTransport(f,c);if(f.type===\"error\")return j(f,a);if(f.type===\"skdm\")return k(f.skdm,f.icdc);else if(f.type===\"applicationPayload\"){if(e===!0){if(f.applicationPayload.payload==null){d(\"WALogger\").DEV(i());return{version:\"v3\",type:\"error\",error:\"instamadillo unhandled proto\"}}return{version:\"v3\",type:\"instamadillo\",applicationPayload:new Uint8Array(f.applicationPayload.payload)}}c=l(f.applicationPayload,a,f.icdc);if(f.skdm!=null){e=k(f.skdm,f.icdc);return{version:\"v3\",type:\"msgWithSKDM\",msg:c,skdm:e}}return c}else{f.type;return{version:\"v3\",type:\"error\",error:\"unhandled proto\"}}}else{d(\"WALogger\").DEV(h(),b);return{type:\"error\",version:\"v3\",error:\"decodeIncomingMsg called with unexpected encoding version: \"+b}}}function k(a,b){var c=a.axolotlSenderKeyDistributionMessage;a=a.groupId;if(c==null)return{type:\"error\",version:\"v3\",error:\"parseSKDM called with null axolotlSenderKeyDistributionMessage\"};else if(a==null)return{type:\"error\",version:\"v3\",error:\"parseSKDM called with null groupId\"};return{version:\"v3\",type:\"skdm\",msg:{senderKey:c,groupId:a},icdc:b}}function l(a,b,c){var e=d(\"decodeProtobuf\").decodeProtobufWithUnknowns(d(\"WAMsgApplication.pb\").MessageApplicationSpec,a.payload);if(e.payload==null)return m(e.metadata);var f=d(\"WAParseMessageApplication\").parseMessageApplication(e);return f.type===\"error\"?j(f,b):{version:\"v3\",type:\"subprotocol\",metadata:(e=e.metadata)!=null?e:null,subprotocolType:f.subprotocolType,subprotocol:f.payload,protobuf:b,frankingContent:a.payload,icdc:c}}function m(a){a=a==null?void 0:a.chatEphemeralSetting;if(a!=null){var b=a.ephemeralExpiration,c=a.ephemeralSettingTimestamp;if(b==null)return{version:\"v3\",type:\"error\",error:\"Ephemeral setting without expiration\"};try{c=c!=null?d(\"WATimeUtils\").castToUnixTime(d(\"WALongInt\").numberOrThrowIfTooLarge(c)\/1e3):d(\"WATimeUtils\").DEFAULT_UNIXTIME;return{version:\"v3\",type:\"ephemeral\",ephemeralExpirationInSec:b,ephemeralLastUpdatedOrSetTimestamp:c,isEphemeralSettingReset:(c=a.isEphemeralSettingReset)!=null?c:!1}}catch(e){return{version:\"v3\",type:\"ephemeral\",ephemeralExpirationInSec:b,ephemeralLastUpdatedOrSetTimestamp:d(\"WATimeUtils\").DEFAULT_UNIXTIME,isEphemeralSettingReset:(c=a.isEphemeralSettingReset)!=null?c:!1}}}else return{version:\"v3\",type:\"error\",error:\"MessageApplication has no payload and is not ephemeral\"}}g.decodeIncomingMsg=a}),98);\n__d(\"WAAdv.pb\",[\"$InternalEnum\",\"WAProtoConst\"],(function(a,b,c,d,e,f,g){a=b(\"$InternalEnum\")({E2EE:0,HOSTED:1});c={};e={};f={};b={};var h={};c.internalDefaults={accountType:a.E2EE};c.internalSpec={rawId:[1,(d=d(\"WAProtoConst\")).TYPES.UINT32],timestamp:[2,d.TYPES.UINT64],currentIndex:[3,d.TYPES.UINT32],validIndexes:[4,d.FLAGS.REPEATED|d.FLAGS.PACKED|d.TYPES.UINT32],accountType:[5,d.TYPES.ENUM,a]};e.internalSpec={details:[1,d.TYPES.BYTES],accountSignature:[2,d.TYPES.BYTES],accountSignatureKey:[3,d.TYPES.BYTES]};f.internalDefaults={accountType:a.E2EE,deviceType:a.E2EE};f.internalSpec={rawId:[1,d.TYPES.UINT32],timestamp:[2,d.TYPES.UINT64],keyIndex:[3,d.TYPES.UINT32],accountType:[4,d.TYPES.ENUM,a],deviceType:[5,d.TYPES.ENUM,a]};b.internalSpec={details:[1,d.TYPES.BYTES],accountSignatureKey:[2,d.TYPES.BYTES],accountSignature:[3,d.TYPES.BYTES],deviceSignature:[4,d.TYPES.BYTES]};h.internalDefaults={accountType:a.E2EE};h.internalSpec={details:[1,d.TYPES.BYTES],hmac:[2,d.TYPES.BYTES],accountType:[3,d.TYPES.ENUM,a]};g.ADVEncryptionType=a;g.ADVKeyIndexListSpec=c;g.ADVSignedKeyIndexListSpec=e;g.ADVDeviceIdentitySpec=f;g.ADVSignedDeviceIdentitySpec=b;g.ADVSignedDeviceIdentityHMACSpec=h}),98);\n__d(\"WAMmsRetry.pb\",[\"$InternalEnum\",\"WAProtoConst\"],(function(a,b,c,d,e,f,g){a=b(\"$InternalEnum\")({GENERAL_ERROR:0,SUCCESS:1,NOT_FOUND:2,DECRYPTION_ERROR:3});c={};e={};c.internalSpec={stanzaId:[1,(f=d(\"WAProtoConst\")).TYPES.STRING],directPath:[2,f.TYPES.STRING],result:[3,f.TYPES.ENUM,a]};e.internalSpec={stanzaId:[1,f.TYPES.STRING]};g.MediaRetryNotification$ResultType=a;g.MediaRetryNotificationSpec=c;g.ServerErrorReceiptSpec=e}),98);\n__d(\"WAE2E.pb\",[\"$InternalEnum\",\"WAAdv.pb\",\"WAMmsRetry.pb\",\"WAProtoConst\",\"WAProtocol.pb\"],(function(a,b,c,d,e,f,g){var h,i;c=(a=b(\"$InternalEnum\"))({MASK_LINKED_DEVICES:0});e=a({UNKNOWN:0,AUDIO:1,VIDEO:2});f=a({CONNECTED:0,MISSED:1,FAILED:2,REJECTED:3,ACCEPTED_ELSEWHERE:4,ONGOING:5,SILENCED_BY_DND:6,SILENCED_UNKNOWN_CALLER:7});b=a({REGULAR:0,SCHEDULED_CALL:1,VOICE_CHAT:2});var aa=a({UNKNOWN:0,CANCEL:1}),ba=a({UNKNOWN:0,VOICE:1,VIDEO:2}),ca=a({UNKNOWN:0,GOING:1,NOT_GOING:2}),da=a({UNKNOWN_TYPE:0,PIN_FOR_ALL:1,UNPIN_FOR_ALL:2}),ea=a({UNKNOWN:0,DISPLAY_TEXT:1}),fa=a({UNKNOWN:0,RESPONSE:1,NATIVE_FLOW:2}),ga=a({UNKNOWN:0,EMPTY:1,TEXT:2,DOCUMENT:3,IMAGE:4,VIDEO:5,LOCATION:6}),ha=a({UNKNOWN:0,EVENT_EDIT:1}),ia=a({DEFAULT:0,PARENT:1}),j=a({DEFAULT:0,EXTENSIONS_1:1}),ja=a({UNKNOWN_SURFACE:0,FB:1,IG:2,WA:3}),ka=a({UNKNOWN:0,SINGLE_SELECT:1}),la=a({UNKNOWN:0,SINGLE_SELECT:1,PRODUCT_LIST:2}),ma=a({CATALOG:1}),na=a({INQUIRY:1,ACCEPTED:2,DECLINED:3}),oa=a({UNKNOWN:0,FBPAY:1,NOVI:2,UPI:3}),pa=a({GREGORIAN:1,SOLAR_HIJRI:2}),qa=a({MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,SUNDAY:7}),k=a({UPLOAD_STICKER:0,SEND_RECENT_STICKER_BOOTSTRAP:1,GENERATE_LINK_PREVIEW:2,HISTORY_SYNC_ON_DEMAND:3,PLACEHOLDER_MESSAGE_RESEND:4}),ra=a({INITIAL_BOOTSTRAP:0,INITIAL_STATUS_V3:1,FULL:2,RECENT:3,PUSH_NAME:4,NON_BLOCKING_DATA:5,ON_DEMAND:6}),sa=a({EMPTY:0,NON_EMPTY:1}),ta=a({REVOKE:0,EPHEMERAL_SETTING:3,EPHEMERAL_SYNC_RESPONSE:4,HISTORY_SYNC_NOTIFICATION:5,APP_STATE_SYNC_KEY_SHARE:6,APP_STATE_SYNC_KEY_REQUEST:7,MSG_FANOUT_BACKFILL_REQUEST:8,INITIAL_SECURITY_NOTIFICATION_SETTING_SYNC:9,APP_STATE_FATAL_EXCEPTION_NOTIFICATION:10,SHARE_PHONE_NUMBER:11,MESSAGE_EDIT:14,PEER_DATA_OPERATION_REQUEST_MESSAGE:16,PEER_DATA_OPERATION_REQUEST_RESPONSE_MESSAGE:17,REQUEST_WELCOME_MESSAGE:18,BOT_FEEDBACK_MESSAGE:19,MEDIA_NOTIFY_MESSAGE:20}),ua=a({BOT_FEEDBACK_MULTIPLE_POSITIVE_GENERIC:1}),va=a({BOT_FEEDBACK_MULTIPLE_NEGATIVE_GENERIC:1,BOT_FEEDBACK_MULTIPLE_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_MULTIPLE_NEGATIVE_INTERESTING:4,BOT_FEEDBACK_MULTIPLE_NEGATIVE_ACCURATE:8,BOT_FEEDBACK_MULTIPLE_NEGATIVE_SAFE:16,BOT_FEEDBACK_MULTIPLE_NEGATIVE_OTHER:32,BOT_FEEDBACK_MULTIPLE_NEGATIVE_REFUSED:64,BOT_FEEDBACK_MULTIPLE_NEGATIVE_NOT_VISUALLY_APPEALING:128,BOT_FEEDBACK_MULTIPLE_NEGATIVE_NOT_RELEVANT_TO_TEXT:256}),wa=a({BOT_FEEDBACK_POSITIVE:0,BOT_FEEDBACK_NEGATIVE_GENERIC:1,BOT_FEEDBACK_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_NEGATIVE_INTERESTING:3,BOT_FEEDBACK_NEGATIVE_ACCURATE:4,BOT_FEEDBACK_NEGATIVE_SAFE:5,BOT_FEEDBACK_NEGATIVE_OTHER:6,BOT_FEEDBACK_NEGATIVE_REFUSED:7,BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING:8,BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT:9}),xa=a({NONE:0,GIPHY:1,TENOR:2}),l=a({DEFAULT:0,PARENT:1,SUB:2,DEFAULT_SUB:3}),ya=a({NONE:0,VIDEO:1,PLACEHOLDER:4,IMAGE:5}),za=a({SYSTEM:0,SYSTEM_TEXT:1,FB_SCRIPT:2,SYSTEM_BOLD:6,MORNINGBREEZE_REGULAR:7,CALISTOGA_REGULAR:8,EXO2_EXTRABOLD:9,COURIERPRIME_BOLD:10}),Aa=a({IMAGE:0,PDF:1}),Ba=a({USER_IMAGE:0,AI_GENERATED:1,AI_MODIFIED:2}),Ca=a({UPDATE:1,UPDATE_CARD:2,LINK_CARD:3}),Da=a({NONE:0,IMAGE:1,VIDEO:2}),Ea=a({NONE:0,IMAGE:1,VIDEO:2}),Fa=a({REELS:1,SEARCH:2}),Ga=a({BING:1,GOOGLE:2}),Ha=a({FULL:1,TALL:2,COMPACT:3}),Ia=a({UNKNOWN:0,DEFAULT:1}),Ja=a({UNKNOWN:0,CHAT_SETTING:1,ACCOUNT_SETTING:2,BULK_CHANGE:3,BIZ_SUPPORTS_FB_HOSTING:4}),Ka=a({CHANGED_IN_CHAT:0,INITIATED_BY_ME:1,INITIATED_BY_OTHER:2,BIZ_UPGRADE_FB_HOSTING:3});a=a({UNKNOWN:0,KEEP_FOR_ALL:1,UNDO_KEEP_FOR_ALL:2});var m={},n={},o={},p={},q={},r={},s={},t={},La={},u={},v={},w={},x={},y={},Ma={},Na={},Oa={},Pa={},Qa={},Ra={},z={},Sa={},Ta={},Ua={},Va={},Wa={},Xa={},Ya={},Za={},$a={},A={},ab={},bb={},cb={},db={},eb={},B={},C={},D={},E={},F={},fb={},G={},H={},gb={},hb={},ib={},jb={},kb={},lb={},mb={},nb={},ob={},pb={},qb={},rb={},I={},J={},sb={},tb={},ub={},K={},L={},vb={},M={},wb={},xb={},yb={},zb={},Ab={},Bb={},N={},Cb={},Db={},Eb={},Fb={},Gb={},Hb={},Ib={},Jb={},Kb={},Lb={},Mb={},Nb={},Ob={},Pb={},Qb={},Rb={},Sb={},Tb={},Ub={},Vb={},Wb={},Xb={},O={},Yb={},Zb={},$b={},ac={},bc={},cc={},dc={},P={},ec={},Q={},fc={},R={},S={},gc={},T={},U={},V={},hc={},W={},ic={},jc={},kc={},lc={},mc={},nc={},oc={},pc={},qc={},rc={},X={},Y={},sc={},tc={},uc={},vc={},wc={},xc={},yc={},zc={},Ac={},Bc={},Cc={},Z={},Dc={},$={},Ec={},Fc={},Gc={},Hc={};m.internalSpec={conversation:[1,(h=d(\"WAProtoConst\")).TYPES.STRING],senderKeyDistributionMessage:[2,h.TYPES.MESSAGE,U],imageMessage:[3,h.TYPES.MESSAGE,T],contactMessage:[4,h.TYPES.MESSAGE,S],locationMessage:[5,h.TYPES.MESSAGE,R],extendedTextMessage:[6,h.TYPES.MESSAGE,fc],documentMessage:[7,h.TYPES.MESSAGE,Q],audioMessage:[8,h.TYPES.MESSAGE,ec],videoMessage:[9,h.TYPES.MESSAGE,P],call:[10,h.TYPES.MESSAGE,dc],chat:[11,h.TYPES.MESSAGE,cc],protocolMessage:[12,h.TYPES.MESSAGE,ac],contactsArrayMessage:[13,h.TYPES.MESSAGE,Hb],highlyStructuredMessage:[14,h.TYPES.MESSAGE,N],fastRatchetKeySenderKeyDistributionMessage:[15,h.TYPES.MESSAGE,U],sendPaymentMessage:[16,h.TYPES.MESSAGE,Bb],liveLocationMessage:[18,h.TYPES.MESSAGE,wb],requestPaymentMessage:[22,h.TYPES.MESSAGE,Ab],declinePaymentRequestMessage:[23,h.TYPES.MESSAGE,zb],cancelPaymentRequestMessage:[24,h.TYPES.MESSAGE,yb],templateMessage:[25,h.TYPES.MESSAGE,K],stickerMessage:[26,h.TYPES.MESSAGE,M],groupInviteMessage:[28,h.TYPES.MESSAGE,db],templateButtonReplyMessage:[29,h.TYPES.MESSAGE,ub],productMessage:[30,h.TYPES.MESSAGE,J],deviceSentMessage:[31,h.TYPES.MESSAGE,ab],messageContextInfo:[35,h.TYPES.MESSAGE,rc],listMessage:[36,h.TYPES.MESSAGE,lb],viewOnceMessage:[37,h.TYPES.MESSAGE,A],orderMessage:[38,h.TYPES.MESSAGE,I],listResponseMessage:[39,h.TYPES.MESSAGE,jb],ephemeralMessage:[40,h.TYPES.MESSAGE,A],invoiceMessage:[41,h.TYPES.MESSAGE,gc],buttonsMessage:[42,h.TYPES.MESSAGE,Wa],buttonsResponseMessage:[43,h.TYPES.MESSAGE,Va],paymentInviteMessage:[44,h.TYPES.MESSAGE,xb],interactiveMessage:[45,h.TYPES.MESSAGE,D],reactionMessage:[46,h.TYPES.MESSAGE,Ua],stickerSyncRmrMessage:[47,h.TYPES.MESSAGE,Ta],interactiveResponseMessage:[48,h.TYPES.MESSAGE,eb],pollCreationMessage:[49,h.TYPES.MESSAGE,z],pollUpdateMessage:[50,h.TYPES.MESSAGE,Ra],keepInChatMessage:[51,h.TYPES.MESSAGE,Na],documentWithCaptionMessage:[53,h.TYPES.MESSAGE,A],requestPhoneNumberMessage:[54,h.TYPES.MESSAGE,bb],viewOnceMessageV2:[55,h.TYPES.MESSAGE,A],encReactionMessage:[56,h.TYPES.MESSAGE,y],editedMessage:[58,h.TYPES.MESSAGE,A],viewOnceMessageV2Extension:[59,h.TYPES.MESSAGE,A],pollCreationMessageV2:[60,h.TYPES.MESSAGE,z],scheduledCallCreationMessage:[61,h.TYPES.MESSAGE,t],groupMentionedMessage:[62,h.TYPES.MESSAGE,A],pinInChatMessage:[63,h.TYPES.MESSAGE,Ma],pollCreationMessageV3:[64,h.TYPES.MESSAGE,z],scheduledCallEditMessage:[65,h.TYPES.MESSAGE,s],ptvMessage:[66,h.TYPES.MESSAGE,P],botInvokeMessage:[67,h.TYPES.MESSAGE,A],callLogMesssage:[69,h.TYPES.MESSAGE,q],messageHistoryBundle:[70,h.TYPES.MESSAGE,p],encCommentMessage:[71,h.TYPES.MESSAGE,x],bcallMessage:[72,h.TYPES.MESSAGE,o],lottieStickerMessage:[74,h.TYPES.MESSAGE,A],eventMessage:[75,h.TYPES.MESSAGE,v],encEventResponseMessage:[76,h.TYPES.MESSAGE,u],commentMessage:[77,h.TYPES.MESSAGE,w],newsletterAdminInviteMessage:[78,h.TYPES.MESSAGE,cb],placeholderMessage:[80,h.TYPES.MESSAGE,n],secretEncryptedMessage:[82,h.TYPES.MESSAGE,$a]};n.internalSpec={type:[1,h.TYPES.ENUM,c]};o.internalSpec={sessionId:[1,h.TYPES.STRING],mediaType:[2,h.TYPES.ENUM,e],masterKey:[3,h.TYPES.BYTES],caption:[4,h.TYPES.STRING]};p.internalSpec={mimetype:[2,h.TYPES.STRING],fileSha256:[3,h.TYPES.BYTES],mediaKey:[5,h.TYPES.BYTES],fileEncSha256:[6,h.TYPES.BYTES],directPath:[7,h.TYPES.STRING],mediaKeyTimestamp:[8,h.TYPES.INT64],contextInfo:[9,h.TYPES.MESSAGE,V],participants:[10,h.FLAGS.REPEATED|h.TYPES.STRING]};q.internalSpec={isVideo:[1,h.TYPES.BOOL],callOutcome:[2,h.TYPES.ENUM,f],durationSecs:[3,h.TYPES.INT64],callType:[4,h.TYPES.ENUM,b],participants:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,r]};r.internalSpec={jid:[1,h.TYPES.STRING],callOutcome:[2,h.TYPES.ENUM,f]};s.internalSpec={key:[1,h.TYPES.MESSAGE,(i=d(\"WAProtocol.pb\")).MessageKeySpec],editType:[2,h.TYPES.ENUM,aa]};t.internalSpec={scheduledTimestampMs:[1,h.TYPES.INT64],callType:[2,h.TYPES.ENUM,ba],title:[3,h.TYPES.STRING]};La.internalSpec={response:[1,h.TYPES.ENUM,ca],timestampMs:[2,h.TYPES.INT64]};u.internalSpec={eventCreationMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES]};v.internalSpec={contextInfo:[1,h.TYPES.MESSAGE,V],isCanceled:[2,h.TYPES.BOOL],name:[3,h.TYPES.STRING],description:[4,h.TYPES.STRING],location:[5,h.TYPES.MESSAGE,R],joinLink:[6,h.TYPES.STRING],startTime:[7,h.TYPES.INT64]};w.internalSpec={message:[1,h.TYPES.MESSAGE,m],targetMessageKey:[2,h.TYPES.MESSAGE,i.MessageKeySpec]};x.internalSpec={targetMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES]};y.internalSpec={targetMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES]};Ma.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],type:[2,h.TYPES.ENUM,da],senderTimestampMs:[3,h.TYPES.INT64]};Na.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],keepType:[2,h.TYPES.ENUM,a],timestampMs:[3,h.TYPES.INT64]};Oa.internalSpec={selectedOptions:[1,h.FLAGS.REPEATED|h.TYPES.BYTES]};Pa.internalSpec={encPayload:[1,h.TYPES.BYTES],encIv:[2,h.TYPES.BYTES]};Qa.internalSpec={};Ra.internalSpec={pollCreationMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],vote:[2,h.TYPES.MESSAGE,Pa],metadata:[3,h.TYPES.MESSAGE,Qa],senderTimestampMs:[4,h.TYPES.INT64]};z.internalSpec={encKey:[1,h.TYPES.BYTES],name:[2,h.TYPES.STRING],options:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Sa],selectableOptionsCount:[4,h.TYPES.UINT32],contextInfo:[5,h.TYPES.MESSAGE,V]};Sa.internalSpec={optionName:[1,h.TYPES.STRING]};Ta.internalSpec={filehash:[1,h.FLAGS.REPEATED|h.TYPES.STRING],rmrSource:[2,h.TYPES.STRING],requestTimestamp:[3,h.TYPES.INT64]};Ua.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],text:[2,h.TYPES.STRING],groupingKey:[3,h.TYPES.STRING],senderTimestampMs:[4,h.TYPES.INT64]};Va.internalSpec={selectedButtonId:[1,h.TYPES.STRING],selectedDisplayText:[2,h.TYPES.STRING],contextInfo:[3,h.TYPES.MESSAGE,V],type:[4,h.TYPES.ENUM,ea],__oneofs__:{response:[\"selectedDisplayText\"]}};Wa.internalSpec={text:[1,h.TYPES.STRING],documentMessage:[2,h.TYPES.MESSAGE,Q],imageMessage:[3,h.TYPES.MESSAGE,T],videoMessage:[4,h.TYPES.MESSAGE,P],locationMessage:[5,h.TYPES.MESSAGE,R],contentText:[6,h.TYPES.STRING],footerText:[7,h.TYPES.STRING],contextInfo:[8,h.TYPES.MESSAGE,V],buttons:[9,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Xa],headerType:[10,h.TYPES.ENUM,ga],__oneofs__:{header:[\"text\",\"documentMessage\",\"imageMessage\",\"videoMessage\",\"locationMessage\"]}};Xa.internalSpec={buttonId:[1,h.TYPES.STRING],buttonText:[2,h.TYPES.MESSAGE,Za],type:[3,h.TYPES.ENUM,fa],nativeFlowInfo:[4,h.TYPES.MESSAGE,Ya]};Ya.internalSpec={name:[1,h.TYPES.STRING],paramsJson:[2,h.TYPES.STRING]};Za.internalSpec={displayText:[1,h.TYPES.STRING]};$a.internalSpec={targetMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES],secretEncType:[4,h.TYPES.ENUM,ha]};A.internalSpec={message:[1,h.TYPES.MESSAGE,m]};ab.internalSpec={destinationJid:[1,h.TYPES.STRING],message:[2,h.TYPES.MESSAGE,m],phash:[3,h.TYPES.STRING]};bb.internalSpec={contextInfo:[1,h.TYPES.MESSAGE,V]};cb.internalSpec={newsletterJid:[1,h.TYPES.STRING],newsletterName:[2,h.TYPES.STRING],jpegThumbnail:[3,h.TYPES.BYTES],caption:[4,h.TYPES.STRING],inviteExpiration:[5,h.TYPES.INT64],contextInfo:[6,h.TYPES.MESSAGE,V]};db.internalSpec={groupJid:[1,h.TYPES.STRING],inviteCode:[2,h.TYPES.STRING],inviteExpiration:[3,h.TYPES.INT64],groupName:[4,h.TYPES.STRING],jpegThumbnail:[5,h.TYPES.BYTES],caption:[6,h.TYPES.STRING],contextInfo:[7,h.TYPES.MESSAGE,V],groupType:[8,h.TYPES.ENUM,ia]};eb.internalSpec={body:[1,h.TYPES.MESSAGE,C],nativeFlowResponseMessage:[2,h.TYPES.MESSAGE,B],contextInfo:[15,h.TYPES.MESSAGE,V],__oneofs__:{interactiveResponseMessage:[\"nativeFlowResponseMessage\"]}};B.internalDefaults={version:1};B.internalSpec={name:[1,h.TYPES.STRING],paramsJson:[2,h.TYPES.STRING],version:[3,h.TYPES.INT32]};C.internalDefaults={format:j.DEFAULT};C.internalSpec={text:[1,h.TYPES.STRING],format:[2,h.TYPES.ENUM,j]};D.internalSpec={header:[1,h.TYPES.MESSAGE,ib],body:[2,h.TYPES.MESSAGE,hb],footer:[3,h.TYPES.MESSAGE,gb],shopStorefrontMessage:[4,h.TYPES.MESSAGE,H],collectionMessage:[5,h.TYPES.MESSAGE,G],nativeFlowMessage:[6,h.TYPES.MESSAGE,F],carouselMessage:[7,h.TYPES.MESSAGE,E],contextInfo:[15,h.TYPES.MESSAGE,V],__oneofs__:{interactiveMessage:[\"shopStorefrontMessage\",\"collectionMessage\",\"nativeFlowMessage\",\"carouselMessage\"]}};E.internalDefaults={messageVersion:1};E.internalSpec={cards:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,D],messageVersion:[2,h.TYPES.INT32]};F.internalDefaults={messageVersion:1};F.internalSpec={buttons:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,fb],messageParamsJson:[2,h.TYPES.STRING],messageVersion:[3,h.TYPES.INT32]};fb.internalSpec={name:[1,h.TYPES.STRING],buttonParamsJson:[2,h.TYPES.STRING]};G.internalDefaults={messageVersion:1};G.internalSpec={bizJid:[1,h.TYPES.STRING],id:[2,h.TYPES.STRING],messageVersion:[3,h.TYPES.INT32]};H.internalDefaults={messageVersion:1};H.internalSpec={id:[1,h.TYPES.STRING],surface:[2,h.TYPES.ENUM,ja],messageVersion:[3,h.TYPES.INT32]};gb.internalSpec={text:[1,h.TYPES.STRING]};hb.internalSpec={text:[1,h.TYPES.STRING]};ib.internalSpec={title:[1,h.TYPES.STRING],subtitle:[2,h.TYPES.STRING],documentMessage:[3,h.TYPES.MESSAGE,Q],imageMessage:[4,h.TYPES.MESSAGE,T],jpegThumbnail:[6,h.TYPES.BYTES],videoMessage:[7,h.TYPES.MESSAGE,P],locationMessage:[8,h.TYPES.MESSAGE,R],productMessage:[9,h.TYPES.MESSAGE,J],hasMediaAttachment:[5,h.TYPES.BOOL],__oneofs__:{media:[\"documentMessage\",\"imageMessage\",\"jpegThumbnail\",\"videoMessage\",\"locationMessage\",\"productMessage\"]}};jb.internalSpec={title:[1,h.TYPES.STRING],listType:[2,h.TYPES.ENUM,ka],singleSelectReply:[3,h.TYPES.MESSAGE,kb],contextInfo:[4,h.TYPES.MESSAGE,V],description:[5,h.TYPES.STRING]};kb.internalSpec={selectedRowId:[1,h.TYPES.STRING]};lb.internalSpec={title:[1,h.TYPES.STRING],description:[2,h.TYPES.STRING],buttonText:[3,h.TYPES.STRING],listType:[4,h.TYPES.ENUM,la],sections:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,qb],productListInfo:[6,h.TYPES.MESSAGE,mb],footerText:[7,h.TYPES.STRING],contextInfo:[8,h.TYPES.MESSAGE,V]};mb.internalSpec={productSections:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,ob],headerImage:[2,h.TYPES.MESSAGE,nb],businessOwnerJid:[3,h.TYPES.STRING]};nb.internalSpec={productId:[1,h.TYPES.STRING],jpegThumbnail:[2,h.TYPES.BYTES]};ob.internalSpec={title:[1,h.TYPES.STRING],products:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,pb]};pb.internalSpec={productId:[1,h.TYPES.STRING]};qb.internalSpec={title:[1,h.TYPES.STRING],rows:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,rb]};rb.internalSpec={title:[1,h.TYPES.STRING],description:[2,h.TYPES.STRING],rowId:[3,h.TYPES.STRING]};I.internalDefaults={messageVersion:1};I.internalSpec={orderId:[1,h.TYPES.STRING],thumbnail:[2,h.TYPES.BYTES],itemCount:[3,h.TYPES.INT32],status:[4,h.TYPES.ENUM,na],surface:[5,h.TYPES.ENUM,ma],message:[6,h.TYPES.STRING],orderTitle:[7,h.TYPES.STRING],sellerJid:[8,h.TYPES.STRING],token:[9,h.TYPES.STRING],totalAmount1000:[10,h.TYPES.INT64],totalCurrencyCode:[11,h.TYPES.STRING],contextInfo:[17,h.TYPES.MESSAGE,V],messageVersion:[12,h.TYPES.INT32],orderRequestMessageId:[13,h.TYPES.MESSAGE,i.MessageKeySpec]};J.internalSpec={product:[1,h.TYPES.MESSAGE,sb],businessOwnerJid:[2,h.TYPES.STRING],catalog:[4,h.TYPES.MESSAGE,tb],body:[5,h.TYPES.STRING],footer:[6,h.TYPES.STRING],contextInfo:[17,h.TYPES.MESSAGE,V]};sb.internalSpec={productImage:[1,h.TYPES.MESSAGE,T],productId:[2,h.TYPES.STRING],title:[3,h.TYPES.STRING],description:[4,h.TYPES.STRING],currencyCode:[5,h.TYPES.STRING],priceAmount1000:[6,h.TYPES.INT64],retailerId:[7,h.TYPES.STRING],url:[8,h.TYPES.STRING],productImageCount:[9,h.TYPES.UINT32],firstImageId:[11,h.TYPES.STRING],salePriceAmount1000:[12,h.TYPES.INT64]};tb.internalSpec={catalogImage:[1,h.TYPES.MESSAGE,T],title:[2,h.TYPES.STRING],description:[3,h.TYPES.STRING]};ub.internalSpec={selectedId:[1,h.TYPES.STRING],selectedDisplayText:[2,h.TYPES.STRING],contextInfo:[3,h.TYPES.MESSAGE,V],selectedIndex:[4,h.TYPES.UINT32],selectedCarouselCardIndex:[5,h.TYPES.UINT32]};K.internalSpec={fourRowTemplate:[1,h.TYPES.MESSAGE,vb],hydratedFourRowTemplate:[2,h.TYPES.MESSAGE,L],interactiveMessageTemplate:[5,h.TYPES.MESSAGE,D],contextInfo:[3,h.TYPES.MESSAGE,V],hydratedTemplate:[4,h.TYPES.MESSAGE,L],templateId:[9,h.TYPES.STRING],__oneofs__:{format:[\"fourRowTemplate\",\"hydratedFourRowTemplate\",\"interactiveMessageTemplate\"]}};L.internalSpec={documentMessage:[1,h.TYPES.MESSAGE,Q],hydratedTitleText:[2,h.TYPES.STRING],imageMessage:[3,h.TYPES.MESSAGE,T],videoMessage:[4,h.TYPES.MESSAGE,P],locationMessage:[5,h.TYPES.MESSAGE,R],hydratedContentText:[6,h.TYPES.STRING],hydratedFooterText:[7,h.TYPES.STRING],hydratedButtons:[8,h.FLAGS.REPEATED|h.TYPES.MESSAGE,yc],templateId:[9,h.TYPES.STRING],maskLinkedDevices:[10,h.TYPES.BOOL],__oneofs__:{title:[\"documentMessage\",\"hydratedTitleText\",\"imageMessage\",\"videoMessage\",\"locationMessage\"]}};vb.internalSpec={documentMessage:[1,h.TYPES.MESSAGE,Q],highlyStructuredMessage:[2,h.TYPES.MESSAGE,N],imageMessage:[3,h.TYPES.MESSAGE,T],videoMessage:[4,h.TYPES.MESSAGE,P],locationMessage:[5,h.TYPES.MESSAGE,R],content:[6,h.TYPES.MESSAGE,N],footer:[7,h.TYPES.MESSAGE,N],buttons:[8,h.FLAGS.REPEATED|h.TYPES.MESSAGE,uc],__oneofs__:{title:[\"documentMessage\",\"highlyStructuredMessage\",\"imageMessage\",\"videoMessage\",\"locationMessage\"]}};M.internalSpec={url:[1,h.TYPES.STRING],fileSha256:[2,h.TYPES.BYTES],fileEncSha256:[3,h.TYPES.BYTES],mediaKey:[4,h.TYPES.BYTES],mimetype:[5,h.TYPES.STRING],height:[6,h.TYPES.UINT32],width:[7,h.TYPES.UINT32],directPath:[8,h.TYPES.STRING],fileLength:[9,h.TYPES.UINT64],mediaKeyTimestamp:[10,h.TYPES.INT64],firstFrameLength:[11,h.TYPES.UINT32],firstFrameSidecar:[12,h.TYPES.BYTES],isAnimated:[13,h.TYPES.BOOL],pngThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],stickerSentTs:[18,h.TYPES.INT64],isAvatar:[19,h.TYPES.BOOL],isAiSticker:[20,h.TYPES.BOOL],isLottie:[21,h.TYPES.BOOL]};wb.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],accuracyInMeters:[3,h.TYPES.UINT32],speedInMps:[4,h.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[5,h.TYPES.UINT32],caption:[6,h.TYPES.STRING],sequenceNumber:[7,h.TYPES.INT64],timeOffset:[8,h.TYPES.UINT32],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V]};xb.internalSpec={serviceType:[1,h.TYPES.ENUM,oa],expiryTimestamp:[2,h.TYPES.INT64]};yb.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};zb.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};Ab.internalSpec={noteMessage:[4,h.TYPES.MESSAGE,m],currencyCodeIso4217:[1,h.TYPES.STRING],amount1000:[2,h.TYPES.UINT64],requestFrom:[3,h.TYPES.STRING],expiryTimestamp:[5,h.TYPES.INT64],amount:[6,h.TYPES.MESSAGE,Cc],background:[7,h.TYPES.MESSAGE,Z]};Bb.internalSpec={noteMessage:[2,h.TYPES.MESSAGE,m],requestMessageKey:[3,h.TYPES.MESSAGE,i.MessageKeySpec],background:[4,h.TYPES.MESSAGE,Z]};N.internalSpec={namespace:[1,h.TYPES.STRING],elementName:[2,h.TYPES.STRING],params:[3,h.FLAGS.REPEATED|h.TYPES.STRING],fallbackLg:[4,h.TYPES.STRING],fallbackLc:[5,h.TYPES.STRING],localizableParams:[6,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Cb],deterministicLg:[7,h.TYPES.STRING],deterministicLc:[8,h.TYPES.STRING],hydratedHsm:[9,h.TYPES.MESSAGE,K]};Cb.internalSpec={\"default\":[1,h.TYPES.STRING],currency:[2,h.TYPES.MESSAGE,Gb],dateTime:[3,h.TYPES.MESSAGE,Db],__oneofs__:{paramOneof:[\"currency\",\"dateTime\"]}};Db.internalSpec={component:[1,h.TYPES.MESSAGE,Fb],unixEpoch:[2,h.TYPES.MESSAGE,Eb],__oneofs__:{datetimeOneof:[\"component\",\"unixEpoch\"]}};Eb.internalSpec={timestamp:[1,h.TYPES.INT64]};Fb.internalSpec={dayOfWeek:[1,h.TYPES.ENUM,qa],year:[2,h.TYPES.UINT32],month:[3,h.TYPES.UINT32],dayOfMonth:[4,h.TYPES.UINT32],hour:[5,h.TYPES.UINT32],minute:[6,h.TYPES.UINT32],calendar:[7,h.TYPES.ENUM,pa]};Gb.internalSpec={currencyCode:[1,h.TYPES.STRING],amount1000:[2,h.TYPES.INT64]};Hb.internalSpec={displayName:[1,h.TYPES.STRING],contacts:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,S],contextInfo:[17,h.TYPES.MESSAGE,V]};Ib.internalSpec={securityNotificationEnabled:[1,h.TYPES.BOOL]};Jb.internalSpec={peerDataOperationRequestType:[1,h.TYPES.ENUM,k],stanzaId:[2,h.TYPES.STRING],peerDataOperationResult:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Kb]};Kb.internalSpec={mediaUploadResult:[1,h.TYPES.ENUM,d(\"WAMmsRetry.pb\").MediaRetryNotification$ResultType],stickerMessage:[2,h.TYPES.MESSAGE,M],linkPreviewResponse:[3,h.TYPES.MESSAGE,Mb],placeholderMessageResendResponse:[4,h.TYPES.MESSAGE,Lb]};Lb.internalSpec={webMessageInfoBytes:[1,h.TYPES.BYTES]};Mb.internalSpec={url:[1,h.TYPES.STRING],title:[2,h.TYPES.STRING],description:[3,h.TYPES.STRING],thumbData:[4,h.TYPES.BYTES],canonicalUrl:[5,h.TYPES.STRING],matchText:[6,h.TYPES.STRING],previewType:[7,h.TYPES.STRING],hqThumbnail:[8,h.TYPES.MESSAGE,Nb]};Nb.internalSpec={directPath:[1,h.TYPES.STRING],thumbHash:[2,h.TYPES.STRING],encThumbHash:[3,h.TYPES.STRING],mediaKey:[4,h.TYPES.BYTES],mediaKeyTimestampMs:[5,h.TYPES.INT64],thumbWidth:[6,h.TYPES.INT32],thumbHeight:[7,h.TYPES.INT32]};Ob.internalSpec={peerDataOperationRequestType:[1,h.TYPES.ENUM,k],requestStickerReupload:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Sb],requestUrlPreview:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Rb],historySyncOnDemandRequest:[4,h.TYPES.MESSAGE,Qb],placeholderMessageResendRequest:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Pb]};Pb.internalSpec={messageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};Qb.internalSpec={chatJid:[1,h.TYPES.STRING],oldestMsgId:[2,h.TYPES.STRING],oldestMsgFromMe:[3,h.TYPES.BOOL],onDemandMsgCount:[4,h.TYPES.INT32],oldestMsgTimestampMs:[5,h.TYPES.INT64]};Rb.internalSpec={url:[1,h.TYPES.STRING],includeHqThumbnail:[2,h.TYPES.BOOL]};Sb.internalSpec={fileSha256:[1,h.TYPES.STRING]};Tb.internalSpec={collectionNames:[1,h.FLAGS.REPEATED|h.TYPES.STRING],timestamp:[2,h.TYPES.INT64]};Ub.internalSpec={keyIds:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,O]};Vb.internalSpec={keys:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Yb]};Wb.internalSpec={keyData:[1,h.TYPES.BYTES],fingerprint:[2,h.TYPES.MESSAGE,Xb],timestamp:[3,h.TYPES.INT64]};Xb.internalSpec={rawId:[1,h.TYPES.UINT32],currentIndex:[2,h.TYPES.UINT32],deviceIndexes:[3,h.FLAGS.REPEATED|h.FLAGS.PACKED|h.TYPES.UINT32]};O.internalSpec={keyId:[1,h.TYPES.BYTES]};Yb.internalSpec={keyId:[1,h.TYPES.MESSAGE,O],keyData:[2,h.TYPES.MESSAGE,Wb]};Zb.internalSpec={fileSha256:[1,h.TYPES.BYTES],fileLength:[2,h.TYPES.UINT64],mediaKey:[3,h.TYPES.BYTES],fileEncSha256:[4,h.TYPES.BYTES],directPath:[5,h.TYPES.STRING],syncType:[6,h.TYPES.ENUM,ra],chunkOrder:[7,h.TYPES.UINT32],originalMessageId:[8,h.TYPES.STRING],progress:[9,h.TYPES.UINT32],oldestMsgInChunkTimestampSec:[10,h.TYPES.INT64],initialHistBootstrapInlinePayload:[11,h.TYPES.BYTES],peerDataRequestSessionId:[12,h.TYPES.STRING]};$b.internalSpec={localChatState:[1,h.TYPES.ENUM,sa]};ac.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],type:[2,h.TYPES.ENUM,ta],ephemeralExpiration:[4,h.TYPES.UINT32],ephemeralSettingTimestamp:[5,h.TYPES.INT64],historySyncNotification:[6,h.TYPES.MESSAGE,Zb],appStateSyncKeyShare:[7,h.TYPES.MESSAGE,Vb],appStateSyncKeyRequest:[8,h.TYPES.MESSAGE,Ub],initialSecurityNotificationSettingSync:[9,h.TYPES.MESSAGE,Ib],appStateFatalExceptionNotification:[10,h.TYPES.MESSAGE,Tb],disappearingMode:[11,h.TYPES.MESSAGE,$],editedMessage:[14,h.TYPES.MESSAGE,m],timestampMs:[15,h.TYPES.INT64],peerDataOperationRequestMessage:[16,h.TYPES.MESSAGE,Ob],peerDataOperationRequestResponseMessage:[17,h.TYPES.MESSAGE,Jb],botFeedbackMessage:[18,h.TYPES.MESSAGE,bc],invokerJid:[19,h.TYPES.STRING],requestWelcomeMessageMetadata:[20,h.TYPES.MESSAGE,$b],mediaNotifyMessage:[21,h.TYPES.MESSAGE,Hc]};bc.internalSpec={messageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],kind:[2,h.TYPES.ENUM,wa],text:[3,h.TYPES.STRING],kindNegative:[4,h.TYPES.UINT64],kindPositive:[5,h.TYPES.UINT64]};cc.internalSpec={displayName:[1,h.TYPES.STRING],id:[2,h.TYPES.STRING]};dc.internalSpec={callKey:[1,h.TYPES.BYTES],conversionSource:[2,h.TYPES.STRING],conversionData:[3,h.TYPES.BYTES],conversionDelaySeconds:[4,h.TYPES.UINT32]};P.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],fileSha256:[3,h.TYPES.BYTES],fileLength:[4,h.TYPES.UINT64],seconds:[5,h.TYPES.UINT32],mediaKey:[6,h.TYPES.BYTES],caption:[7,h.TYPES.STRING],gifPlayback:[8,h.TYPES.BOOL],height:[9,h.TYPES.UINT32],width:[10,h.TYPES.UINT32],fileEncSha256:[11,h.TYPES.BYTES],interactiveAnnotations:[12,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y],directPath:[13,h.TYPES.STRING],mediaKeyTimestamp:[14,h.TYPES.INT64],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],streamingSidecar:[18,h.TYPES.BYTES],gifAttribution:[19,h.TYPES.ENUM,xa],viewOnce:[20,h.TYPES.BOOL],thumbnailDirectPath:[21,h.TYPES.STRING],thumbnailSha256:[22,h.TYPES.BYTES],thumbnailEncSha256:[23,h.TYPES.BYTES],staticUrl:[24,h.TYPES.STRING],annotations:[25,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y]};ec.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],fileSha256:[3,h.TYPES.BYTES],fileLength:[4,h.TYPES.UINT64],seconds:[5,h.TYPES.UINT32],ptt:[6,h.TYPES.BOOL],mediaKey:[7,h.TYPES.BYTES],fileEncSha256:[8,h.TYPES.BYTES],directPath:[9,h.TYPES.STRING],mediaKeyTimestamp:[10,h.TYPES.INT64],contextInfo:[17,h.TYPES.MESSAGE,V],streamingSidecar:[18,h.TYPES.BYTES],waveform:[19,h.TYPES.BYTES],backgroundArgb:[20,h.TYPES.FIXED32],viewOnce:[21,h.TYPES.BOOL]};Q.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],title:[3,h.TYPES.STRING],fileSha256:[4,h.TYPES.BYTES],fileLength:[5,h.TYPES.UINT64],pageCount:[6,h.TYPES.UINT32],mediaKey:[7,h.TYPES.BYTES],fileName:[8,h.TYPES.STRING],fileEncSha256:[9,h.TYPES.BYTES],directPath:[10,h.TYPES.STRING],mediaKeyTimestamp:[11,h.TYPES.INT64],contactVcard:[12,h.TYPES.BOOL],thumbnailDirectPath:[13,h.TYPES.STRING],thumbnailSha256:[14,h.TYPES.BYTES],thumbnailEncSha256:[15,h.TYPES.BYTES],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],thumbnailHeight:[18,h.TYPES.UINT32],thumbnailWidth:[19,h.TYPES.UINT32],caption:[20,h.TYPES.STRING]};fc.internalSpec={text:[1,h.TYPES.STRING],matchedText:[2,h.TYPES.STRING],canonicalUrl:[4,h.TYPES.STRING],description:[5,h.TYPES.STRING],title:[6,h.TYPES.STRING],textArgb:[7,h.TYPES.FIXED32],backgroundArgb:[8,h.TYPES.FIXED32],font:[9,h.TYPES.ENUM,za],previewType:[10,h.TYPES.ENUM,ya],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],doNotPlayInline:[18,h.TYPES.BOOL],thumbnailDirectPath:[19,h.TYPES.STRING],thumbnailSha256:[20,h.TYPES.BYTES],thumbnailEncSha256:[21,h.TYPES.BYTES],mediaKey:[22,h.TYPES.BYTES],mediaKeyTimestamp:[23,h.TYPES.INT64],thumbnailHeight:[24,h.TYPES.UINT32],thumbnailWidth:[25,h.TYPES.UINT32],inviteLinkGroupType:[26,h.TYPES.ENUM,l],inviteLinkParentGroupSubjectV2:[27,h.TYPES.STRING],inviteLinkParentGroupThumbnailV2:[28,h.TYPES.BYTES],inviteLinkGroupTypeV2:[29,h.TYPES.ENUM,l],viewOnce:[30,h.TYPES.BOOL]};R.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],name:[3,h.TYPES.STRING],address:[4,h.TYPES.STRING],url:[5,h.TYPES.STRING],isLive:[6,h.TYPES.BOOL],accuracyInMeters:[7,h.TYPES.UINT32],speedInMps:[8,h.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[9,h.TYPES.UINT32],comment:[11,h.TYPES.STRING],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V]};S.internalSpec={displayName:[1,h.TYPES.STRING],vcard:[16,h.TYPES.STRING],contextInfo:[17,h.TYPES.MESSAGE,V]};gc.internalSpec={note:[1,h.TYPES.STRING],token:[2,h.TYPES.STRING],attachmentType:[3,h.TYPES.ENUM,Aa],attachmentMimetype:[4,h.TYPES.STRING],attachmentMediaKey:[5,h.TYPES.BYTES],attachmentMediaKeyTimestamp:[6,h.TYPES.INT64],attachmentFileSha256:[7,h.TYPES.BYTES],attachmentFileEncSha256:[8,h.TYPES.BYTES],attachmentDirectPath:[9,h.TYPES.STRING],attachmentJpegThumbnail:[10,h.TYPES.BYTES]};T.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],caption:[3,h.TYPES.STRING],fileSha256:[4,h.TYPES.BYTES],fileLength:[5,h.TYPES.UINT64],height:[6,h.TYPES.UINT32],width:[7,h.TYPES.UINT32],mediaKey:[8,h.TYPES.BYTES],fileEncSha256:[9,h.TYPES.BYTES],interactiveAnnotations:[10,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y],directPath:[11,h.TYPES.STRING],mediaKeyTimestamp:[12,h.TYPES.INT64],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,V],firstScanSidecar:[18,h.TYPES.BYTES],firstScanLength:[19,h.TYPES.UINT32],experimentGroupId:[20,h.TYPES.UINT32],scansSidecar:[21,h.TYPES.BYTES],scanLengths:[22,h.FLAGS.REPEATED|h.TYPES.UINT32],midQualityFileSha256:[23,h.TYPES.BYTES],midQualityFileEncSha256:[24,h.TYPES.BYTES],viewOnce:[25,h.TYPES.BOOL],thumbnailDirectPath:[26,h.TYPES.STRING],thumbnailSha256:[27,h.TYPES.BYTES],thumbnailEncSha256:[28,h.TYPES.BYTES],staticUrl:[29,h.TYPES.STRING],annotations:[30,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y],imageSourceType:[31,h.TYPES.ENUM,Ba]};U.internalSpec={groupId:[1,h.TYPES.STRING],axolotlSenderKeyDistributionMessage:[2,h.TYPES.BYTES]};V.internalSpec={stanzaId:[1,h.TYPES.STRING],participant:[2,h.TYPES.STRING],quotedMessage:[3,h.TYPES.MESSAGE,m],remoteJid:[4,h.TYPES.STRING],mentionedJid:[15,h.FLAGS.REPEATED|h.TYPES.STRING],conversionSource:[18,h.TYPES.STRING],conversionData:[19,h.TYPES.BYTES],conversionDelaySeconds:[20,h.TYPES.UINT32],forwardingScore:[21,h.TYPES.UINT32],isForwarded:[22,h.TYPES.BOOL],quotedAd:[23,h.TYPES.MESSAGE,kc],placeholderKey:[24,h.TYPES.MESSAGE,i.MessageKeySpec],expiration:[25,h.TYPES.UINT32],ephemeralSettingTimestamp:[26,h.TYPES.INT64],ephemeralSharedSecret:[27,h.TYPES.BYTES],externalAdReply:[28,h.TYPES.MESSAGE,jc],entryPointConversionSource:[29,h.TYPES.STRING],entryPointConversionApp:[30,h.TYPES.STRING],entryPointConversionDelaySeconds:[31,h.TYPES.UINT32],disappearingMode:[32,h.TYPES.MESSAGE,$],actionLink:[33,h.TYPES.MESSAGE,Ec],groupSubject:[34,h.TYPES.STRING],parentGroupJid:[35,h.TYPES.STRING],trustBannerType:[37,h.TYPES.STRING],trustBannerAction:[38,h.TYPES.UINT32],isSampled:[39,h.TYPES.BOOL],groupMentions:[40,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Fc],utm:[41,h.TYPES.MESSAGE,ic],forwardedNewsletterMessageInfo:[43,h.TYPES.MESSAGE,W],businessMessageForwardInfo:[44,h.TYPES.MESSAGE,lc],smbClientCampaignId:[45,h.TYPES.STRING],smbServerCampaignId:[46,h.TYPES.STRING],dataSharingContext:[47,h.TYPES.MESSAGE,hc],alwaysShowAdAttribution:[48,h.TYPES.BOOL]};hc.internalSpec={showMmDisclosure:[1,h.TYPES.BOOL]};W.internalSpec={newsletterJid:[1,h.TYPES.STRING],serverMessageId:[2,h.TYPES.INT32],newsletterName:[3,h.TYPES.STRING],contentType:[4,h.TYPES.ENUM,Ca],accessibilityText:[5,h.TYPES.STRING]};ic.internalSpec={utmSource:[1,h.TYPES.STRING],utmCampaign:[2,h.TYPES.STRING]};jc.internalSpec={title:[1,h.TYPES.STRING],body:[2,h.TYPES.STRING],mediaType:[3,h.TYPES.ENUM,Da],thumbnailUrl:[4,h.TYPES.STRING],mediaUrl:[5,h.TYPES.STRING],thumbnail:[6,h.TYPES.BYTES],sourceType:[7,h.TYPES.STRING],sourceId:[8,h.TYPES.STRING],sourceUrl:[9,h.TYPES.STRING],containsAutoReply:[10,h.TYPES.BOOL],renderLargerThumbnail:[11,h.TYPES.BOOL],showAdAttribution:[12,h.TYPES.BOOL],ctwaClid:[13,h.TYPES.STRING],ref:[14,h.TYPES.STRING]};kc.internalSpec={advertiserName:[1,h.TYPES.STRING],mediaType:[2,h.TYPES.ENUM,Ea],jpegThumbnail:[16,h.TYPES.BYTES],caption:[17,h.TYPES.STRING]};lc.internalSpec={businessOwnerJid:[1,h.TYPES.STRING]};mc.internalSpec={sentiment:[1,h.TYPES.UINT32],behaviorGraph:[2,h.TYPES.STRING],action:[3,h.TYPES.UINT32],intensity:[4,h.TYPES.UINT32],wordCount:[5,h.TYPES.UINT32]};nc.internalSpec={provider:[1,h.TYPES.ENUM,Ga],pluginType:[2,h.TYPES.ENUM,Fa],thumbnailCdnUrl:[3,h.TYPES.STRING],profilePhotoCdnUrl:[4,h.TYPES.STRING],searchProviderUrl:[5,h.TYPES.STRING],referenceIndex:[6,h.TYPES.UINT32],expectedLinksCount:[7,h.TYPES.UINT32],searchQuery:[9,h.TYPES.STRING],parentPluginMessageKey:[10,h.TYPES.MESSAGE,i.MessageKeySpec]};oc.internalSpec={suggestedPrompts:[1,h.FLAGS.REPEATED|h.TYPES.STRING],selectedPromptIndex:[2,h.TYPES.UINT32]};pc.internalSpec={sessionId:[1,h.TYPES.STRING]};qc.internalSpec={avatarMetadata:[1,h.TYPES.MESSAGE,mc],personaId:[2,h.TYPES.STRING],pluginMetadata:[3,h.TYPES.MESSAGE,nc],suggestedPromptMetadata:[4,h.TYPES.MESSAGE,oc],invokerJid:[5,h.TYPES.STRING],searchMetadata:[6,h.TYPES.MESSAGE,pc]};rc.internalSpec={deviceListMetadata:[1,h.TYPES.MESSAGE,X],deviceListMetadataVersion:[2,h.TYPES.INT32],messageSecret:[3,h.TYPES.BYTES],paddingBytes:[4,h.TYPES.BYTES],messageAddOnDurationInSecs:[5,h.TYPES.UINT32],botMessageSecret:[6,h.TYPES.BYTES],botMetadata:[7,h.TYPES.MESSAGE,qc],reportingTokenVersion:[8,h.TYPES.INT32]};X.internalDefaults={senderAccountType:(i=d(\"WAAdv.pb\")).ADVEncryptionType.E2EE,receiverAccountType:i.ADVEncryptionType.E2EE};X.internalSpec={senderKeyHash:[1,h.TYPES.BYTES],senderTimestamp:[2,h.TYPES.UINT64],senderKeyIndexes:[3,h.FLAGS.REPEATED|h.FLAGS.PACKED|h.TYPES.UINT32],senderAccountType:[4,h.TYPES.ENUM,i.ADVEncryptionType],receiverAccountType:[5,h.TYPES.ENUM,i.ADVEncryptionType],recipientKeyHash:[8,h.TYPES.BYTES],recipientTimestamp:[9,h.TYPES.UINT64],recipientKeyIndexes:[10,h.FLAGS.REPEATED|h.FLAGS.PACKED|h.TYPES.UINT32]};Y.internalSpec={polygonVertices:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,sc],location:[2,h.TYPES.MESSAGE,tc],newsletter:[3,h.TYPES.MESSAGE,W],shouldSkipConfirmation:[4,h.TYPES.BOOL],__oneofs__:{action:[\"location\",\"newsletter\"]}};sc.internalSpec={xDeprecated:[1,h.TYPES.INT32],yDeprecated:[2,h.TYPES.INT32],x:[3,h.TYPES.DOUBLE],y:[4,h.TYPES.DOUBLE]};tc.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],name:[3,h.TYPES.STRING]};uc.internalSpec={quickReplyButton:[1,h.TYPES.MESSAGE,xc],urlButton:[2,h.TYPES.MESSAGE,wc],callButton:[3,h.TYPES.MESSAGE,vc],index:[4,h.TYPES.UINT32],__oneofs__:{button:[\"quickReplyButton\",\"urlButton\",\"callButton\"]}};vc.internalSpec={displayText:[1,h.TYPES.MESSAGE,N],phoneNumber:[2,h.TYPES.MESSAGE,N]};wc.internalSpec={displayText:[1,h.TYPES.MESSAGE,N],url:[2,h.TYPES.MESSAGE,N]};xc.internalSpec={displayText:[1,h.TYPES.MESSAGE,N],id:[2,h.TYPES.STRING]};yc.internalSpec={quickReplyButton:[1,h.TYPES.MESSAGE,Bc],urlButton:[2,h.TYPES.MESSAGE,Ac],callButton:[3,h.TYPES.MESSAGE,zc],index:[4,h.TYPES.UINT32],__oneofs__:{hydratedButton:[\"quickReplyButton\",\"urlButton\",\"callButton\"]}};zc.internalSpec={displayText:[1,h.TYPES.STRING],phoneNumber:[2,h.TYPES.STRING]};Ac.internalSpec={displayText:[1,h.TYPES.STRING],url:[2,h.TYPES.STRING],consentedUsersUrl:[3,h.TYPES.STRING],webviewPresentation:[4,h.TYPES.ENUM,Ha]};Bc.internalSpec={displayText:[1,h.TYPES.STRING],id:[2,h.TYPES.STRING]};Cc.internalSpec={value:[1,h.TYPES.INT64],offset:[2,h.TYPES.UINT32],currencyCode:[3,h.TYPES.STRING]};Z.internalSpec={id:[1,h.TYPES.STRING],fileLength:[2,h.TYPES.UINT64],width:[3,h.TYPES.UINT32],height:[4,h.TYPES.UINT32],mimetype:[5,h.TYPES.STRING],placeholderArgb:[6,h.TYPES.FIXED32],textArgb:[7,h.TYPES.FIXED32],subtextArgb:[8,h.TYPES.FIXED32],mediaData:[9,h.TYPES.MESSAGE,Dc],type:[10,h.TYPES.ENUM,Ia]};Dc.internalSpec={mediaKey:[1,h.TYPES.BYTES],mediaKeyTimestamp:[2,h.TYPES.INT64],fileSha256:[3,h.TYPES.BYTES],fileEncSha256:[4,h.TYPES.BYTES],directPath:[5,h.TYPES.STRING]};$.internalSpec={initiator:[1,h.TYPES.ENUM,Ka],trigger:[2,h.TYPES.ENUM,Ja],initiatorDeviceJid:[3,h.TYPES.STRING],initiatedByMe:[4,h.TYPES.BOOL]};Ec.internalSpec={url:[1,h.TYPES.STRING],buttonTitle:[2,h.TYPES.STRING]};Fc.internalSpec={groupJid:[1,h.TYPES.STRING],groupSubject:[2,h.TYPES.STRING]};Gc.internalSpec={version:[1,h.TYPES.SFIXED32],encIv:[2,h.TYPES.BYTES],encPayload:[3,h.TYPES.BYTES]};Hc.internalSpec={expressPathUrl:[1,h.TYPES.STRING],fileEncSha256:[2,h.TYPES.BYTES],fileLength:[3,h.TYPES.UINT64]};g.Message$PlaceholderMessage$PlaceholderType=c;g.Message$BCallMessage$MediaType=e;g.Message$CallLogMessage$CallOutcome=f;g.Message$CallLogMessage$CallType=b;g.Message$ScheduledCallEditMessage$EditType=aa;g.Message$ScheduledCallCreationMessage$CallType=ba;g.Message$EventResponseMessage$EventResponseType=ca;g.Message$PinInChatMessage$Type=da;g.Message$ButtonsResponseMessage$Type=ea;g.Message$ButtonsMessage$Button$Type=fa;g.Message$ButtonsMessage$HeaderType=ga;g.Message$SecretEncryptedMessage$SecretEncType=ha;g.Message$GroupInviteMessage$GroupType=ia;g.Message$InteractiveResponseMessage$Body$Format=j;g.Message$InteractiveMessage$ShopMessage$Surface=ja;g.Message$ListResponseMessage$ListType=ka;g.Message$ListMessage$ListType=la;g.Message$OrderMessage$OrderSurface=ma;g.Message$OrderMessage$OrderStatus=na;g.Message$PaymentInviteMessage$ServiceType=oa;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponent$CalendarType=pa;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponent$DayOfWeekType=qa;g.Message$PeerDataOperationRequestType=k;g.Message$HistorySyncNotification$HistorySyncType=ra;g.Message$RequestWelcomeMessageMetadata$LocalChatState=sa;g.Message$ProtocolMessage$Type=ta;g.Message$BotFeedbackMessage$BotFeedbackKindMultiplePositive=ua;g.Message$BotFeedbackMessage$BotFeedbackKindMultipleNegative=va;g.Message$BotFeedbackMessage$BotFeedbackKind=wa;g.Message$VideoMessage$Attribution=xa;g.Message$ExtendedTextMessage$InviteLinkGroupType=l;g.Message$ExtendedTextMessage$PreviewType=ya;g.Message$ExtendedTextMessage$FontType=za;g.Message$InvoiceMessage$AttachmentType=Aa;g.Message$ImageMessage$ImageSourceType=Ba;g.ContextInfo$ForwardedNewsletterMessageInfo$ContentType=Ca;g.ContextInfo$ExternalAdReplyInfo$MediaType=Da;g.ContextInfo$AdReplyInfo$MediaType=Ea;g.BotPluginMetadata$PluginType=Fa;g.BotPluginMetadata$SearchProvider=Ga;g.HydratedTemplateButton$HydratedURLButton$WebviewPresentationType=Ha;g.PaymentBackground$Type=Ia;g.DisappearingMode$Trigger=Ja;g.DisappearingMode$Initiator=Ka;g.KeepType=a;g.MessageSpec=m;g.Message$PlaceholderMessageSpec=n;g.Message$BCallMessageSpec=o;g.Message$MessageHistoryBundleSpec=p;g.Message$CallLogMessageSpec=q;g.Message$CallLogMessage$CallParticipantSpec=r;g.Message$ScheduledCallEditMessageSpec=s;g.Message$ScheduledCallCreationMessageSpec=t;g.Message$EventResponseMessageSpec=La;g.Message$EncEventResponseMessageSpec=u;g.Message$EventMessageSpec=v;g.Message$CommentMessageSpec=w;g.Message$EncCommentMessageSpec=x;g.Message$EncReactionMessageSpec=y;g.Message$PinInChatMessageSpec=Ma;g.Message$KeepInChatMessageSpec=Na;g.Message$PollVoteMessageSpec=Oa;g.Message$PollEncValueSpec=Pa;g.Message$PollUpdateMessageMetadataSpec=Qa;g.Message$PollUpdateMessageSpec=Ra;g.Message$PollCreationMessageSpec=z;g.Message$PollCreationMessage$OptionSpec=Sa;g.Message$StickerSyncRMRMessageSpec=Ta;g.Message$ReactionMessageSpec=Ua;g.Message$ButtonsResponseMessageSpec=Va;g.Message$ButtonsMessageSpec=Wa;g.Message$ButtonsMessage$ButtonSpec=Xa;g.Message$ButtonsMessage$Button$NativeFlowInfoSpec=Ya;g.Message$ButtonsMessage$Button$ButtonTextSpec=Za;g.Message$SecretEncryptedMessageSpec=$a;g.Message$FutureProofMessageSpec=A;g.Message$DeviceSentMessageSpec=ab;g.Message$RequestPhoneNumberMessageSpec=bb;g.Message$NewsletterAdminInviteMessageSpec=cb;g.Message$GroupInviteMessageSpec=db;g.Message$InteractiveResponseMessageSpec=eb;g.Message$InteractiveResponseMessage$NativeFlowResponseMessageSpec=B;g.Message$InteractiveResponseMessage$BodySpec=C;g.Message$InteractiveMessageSpec=D;g.Message$InteractiveMessage$CarouselMessageSpec=E;g.Message$InteractiveMessage$NativeFlowMessageSpec=F;g.Message$InteractiveMessage$NativeFlowMessage$NativeFlowButtonSpec=fb;g.Message$InteractiveMessage$CollectionMessageSpec=G;g.Message$InteractiveMessage$ShopMessageSpec=H;g.Message$InteractiveMessage$FooterSpec=gb;g.Message$InteractiveMessage$BodySpec=hb;g.Message$InteractiveMessage$HeaderSpec=ib;g.Message$ListResponseMessageSpec=jb;g.Message$ListResponseMessage$SingleSelectReplySpec=kb;g.Message$ListMessageSpec=lb;g.Message$ListMessage$ProductListInfoSpec=mb;g.Message$ListMessage$ProductListHeaderImageSpec=nb;g.Message$ListMessage$ProductSectionSpec=ob;g.Message$ListMessage$ProductSpec=pb;g.Message$ListMessage$SectionSpec=qb;g.Message$ListMessage$RowSpec=rb;g.Message$OrderMessageSpec=I;g.Message$ProductMessageSpec=J;g.Message$ProductMessage$ProductSnapshotSpec=sb;g.Message$ProductMessage$CatalogSnapshotSpec=tb;g.Message$TemplateButtonReplyMessageSpec=ub;g.Message$TemplateMessageSpec=K;g.Message$TemplateMessage$HydratedFourRowTemplateSpec=L;g.Message$TemplateMessage$FourRowTemplateSpec=vb;g.Message$StickerMessageSpec=M;g.Message$LiveLocationMessageSpec=wb;g.Message$PaymentInviteMessageSpec=xb;g.Message$CancelPaymentRequestMessageSpec=yb;g.Message$DeclinePaymentRequestMessageSpec=zb;g.Message$RequestPaymentMessageSpec=Ab;g.Message$SendPaymentMessageSpec=Bb;g.Message$HighlyStructuredMessageSpec=N;g.Message$HighlyStructuredMessage$HSMLocalizableParameterSpec=Cb;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTimeSpec=Db;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeUnixEpochSpec=Eb;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponentSpec=Fb;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMCurrencySpec=Gb;g.Message$ContactsArrayMessageSpec=Hb;g.Message$InitialSecurityNotificationSettingSyncSpec=Ib;g.Message$PeerDataOperationRequestResponseMessageSpec=Jb;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResultSpec=Kb;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$PlaceholderMessageResendResponseSpec=Lb;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponseSpec=Mb;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponse$LinkPreviewHighQualityThumbnailSpec=Nb;g.Message$PeerDataOperationRequestMessageSpec=Ob;g.Message$PeerDataOperationRequestMessage$PlaceholderMessageResendRequestSpec=Pb;g.Message$PeerDataOperationRequestMessage$HistorySyncOnDemandRequestSpec=Qb;g.Message$PeerDataOperationRequestMessage$RequestUrlPreviewSpec=Rb;g.Message$PeerDataOperationRequestMessage$RequestStickerReuploadSpec=Sb;g.Message$AppStateFatalExceptionNotificationSpec=Tb;g.Message$AppStateSyncKeyRequestSpec=Ub;g.Message$AppStateSyncKeyShareSpec=Vb;g.Message$AppStateSyncKeyDataSpec=Wb;g.Message$AppStateSyncKeyFingerprintSpec=Xb;g.Message$AppStateSyncKeyIdSpec=O;g.Message$AppStateSyncKeySpec=Yb;g.Message$HistorySyncNotificationSpec=Zb;g.Message$RequestWelcomeMessageMetadataSpec=$b;g.Message$ProtocolMessageSpec=ac;g.Message$BotFeedbackMessageSpec=bc;g.Message$ChatSpec=cc;g.Message$CallSpec=dc;g.Message$VideoMessageSpec=P;g.Message$AudioMessageSpec=ec;g.Message$DocumentMessageSpec=Q;g.Message$ExtendedTextMessageSpec=fc;g.Message$LocationMessageSpec=R;g.Message$ContactMessageSpec=S;g.Message$InvoiceMessageSpec=gc;g.Message$ImageMessageSpec=T;g.Message$SenderKeyDistributionMessageSpec=U;g.ContextInfoSpec=V;g.ContextInfo$DataSharingContextSpec=hc;g.ContextInfo$ForwardedNewsletterMessageInfoSpec=W;g.ContextInfo$UTMInfoSpec=ic;g.ContextInfo$ExternalAdReplyInfoSpec=jc;g.ContextInfo$AdReplyInfoSpec=kc;g.ContextInfo$BusinessMessageForwardInfoSpec=lc;g.BotAvatarMetadataSpec=mc;g.BotPluginMetadataSpec=nc;g.BotSuggestedPromptMetadataSpec=oc;g.BotSearchMetadataSpec=pc;g.BotMetadataSpec=qc;g.MessageContextInfoSpec=rc;g.DeviceListMetadataSpec=X;g.InteractiveAnnotationSpec=Y;g.PointSpec=sc;g.LocationSpec=tc;g.TemplateButtonSpec=uc;g.TemplateButton$CallButtonSpec=vc;g.TemplateButton$URLButtonSpec=wc;g.TemplateButton$QuickReplyButtonSpec=xc;g.HydratedTemplateButtonSpec=yc;g.HydratedTemplateButton$HydratedCallButtonSpec=zc;g.HydratedTemplateButton$HydratedURLButtonSpec=Ac;g.HydratedTemplateButton$HydratedQuickReplyButtonSpec=Bc;g.MoneySpec=Cc;g.PaymentBackgroundSpec=Z;g.PaymentBackground$MediaDataSpec=Dc;g.DisappearingModeSpec=$;g.ActionLinkSpec=Ec;g.GroupMentionSpec=Fc;g.MessageSecretMessageSpec=Gc;g.MediaNotifyMessageSpec=Hc}),98);\n__d(\"WAForceSecondRetryErrorTypes\",[],(function(a,b,c,d,e,f){\"use strict\";a=new Set([\"errSignalTooManyMessagesInFuture\",\"errSignalGrpTooManyMessagesInFuture\"]);f.FORCE_SECOND_RETRY_ON=a}),66);\n__d(\"WAParseProtocol\",[\"WAAckLevel\",\"WAAssertUnreachable\",\"WAE2E.pb\",\"WAErr\",\"WAGlobals\",\"WAHex\",\"WAJids\",\"WALogger\",\"WALongInt\",\"WAMedia\",\"WAMediaUtils\",\"WAMsgMap\",\"WAMsgType\",\"WASortedLists\",\"WAStanzaUtils\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"cannot compose mediaEntry with the media message\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"protobuf msg with too large size \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"protobuf msg with bad size \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"protobuf msg with no plaintext hash\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"received protocol message with unknown type \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"received unsupported protocol message with type \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"received invalid revoke key\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"received a non supported revoke\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received extendedTextMsg with no text content\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"There are no admin made reactions\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"We dont support this message type yet\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"interpretProto msg came with tags \",\" and \",\"\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received a quote of a type that is not yet supported: \",\"\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received quote invalid author \",\"\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received quote with missing data in the protobuf\"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received quote from a type that us not supported \",\"\"]);w=function(){return a};return a}var x={};function y(){return{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null}}function z(a){var b=a.unstoredMsg,c=a.unstoredMedia;c=c===void 0?null:c;a=a.unstoredQuotedMedia;a=a===void 0?null:a;if(b==null&&c==null)return y();else return{unstoredMsg:b,unstoredMedia:c,unstoredQuotedMedia:a}}function a(a){var b=F(a.proto);if(!b)return y();var e=C(a,b),f=A(a,b),g=f.quote;f=f.quotedMedia;switch(b.type){case\"conversation\":var h;h=babelHelpers[\"extends\"]({type:d(\"WAMsgType\").MSG_TYPE.TEXT,msgContent:{content:b.value},quote:(h=g)!=null?h:void 0},e);return z({unstoredMsg:h,unstoredQuotedMedia:f});case\"imageMessage\":h=b.value;f=G(h,e.ts);h=babelHelpers[\"extends\"]({type:d(\"WAMsgType\").MSG_TYPE.IMAGE,mediaId:f==null?void 0:f.plaintextHash,quote:(h=g)!=null?h:void 0},e);return z({unstoredMsg:h,unstoredMedia:f});case\"videoMessage\":h=b.value;f=H(h,e.ts);h=babelHelpers[\"extends\"]({type:d(\"WAMsgType\").MSG_TYPE.VIDEO,mediaId:f==null?void 0:f.plaintextHash,quote:(h=g)!=null?h:void 0},e);return z({unstoredMsg:h,unstoredMedia:f});case\"audioMessage\":h=b.value;f=I(h,e.ts);h=babelHelpers[\"extends\"]({type:d(\"WAMsgType\").MSG_TYPE.PTT,mediaId:f==null?void 0:f.plaintextHash},e);return z({unstoredMsg:h,unstoredMedia:f});case\"documentMessage\":h=b.value;f=N(h,e.ts);h=babelHelpers[\"extends\"]({type:d(\"WAMsgType\").MSG_TYPE.DOCUMENT_FILE,mediaId:f==null?void 0:f.plaintextHash,quote:(h=g)!=null?h:void 0},e);return z({unstoredMsg:h,unstoredMedia:f});case\"futureproof\":h={type:d(\"WAMsgType\").MSG_TYPE.FUTUREPROOF,msgContent:{protobuf:d(\"WAHex\").bytesToBuffer(a.bytes),subtype:x[b.type]||null},id:e.id,ts:e.ts,sentTs:e.sentTs,serverTs:e.serverTs,ack:e.ack,reportingMeta:e.reportingMeta};return z({unstoredMsg:h});case\"reactionMessage\":f=b.value;a=J(f,e);return z({unstoredMsg:a});case\"protocolMessage\":h=M(b.value,e);return z({unstoredMsg:h});case\"extendedTextMessage\":return K(b.value,e,g);default:return c(\"WAAssertUnreachable\")(b.type)}}function A(a,b){b=D(b);var c=b==null?void 0:b.quotedMessage;if(b==null||c==null)return{quote:null,quotedMedia:null};var e=F(c);if(e==null){d(\"WALogger\").ERROR(w(),c);return{quote:null,quotedMedia:null}}c=b.stanzaId;b=b.participant;if(c==null||b==null){d(\"WALogger\").ERROR(v());return{quote:null,quotedMedia:null}}b=b?d(\"WAJids\").validateUserJid(b):d(\"WAJids\").interpretAsUserJid(a.jid);if(b==null){d(\"WALogger\").ERROR(u(),b);return{quote:null,quotedMedia:null}}c={externalId:d(\"WAStanzaUtils\").toStanzaId(c),ts:null,author:b,serverTs:a.ts};switch(e.type){case\"conversation\":b=babelHelpers[\"extends\"]({type:d(\"WAMsgType\").MSG_TYPE.TEXT,msgContent:{content:e.value}},c);return{quote:{content:b,remoteJid:null},quotedMedia:null};case\"imageMessage\":b=e.value;b=G(b,a.ts);a=babelHelpers[\"extends\"]({type:d(\"WAMsgType\").MSG_TYPE.IMAGE,mediaId:b==null?void 0:b.plaintextHash},c);return{quote:{content:a,remoteJid:null},quotedMedia:b};default:d(\"WALogger\").ERROR(t(),e.type);return{quote:null,quotedMedia:null}}}var B=[\"conversation\",\"imageMessage\",\"videoMessage\",\"audioMessage\",\"reactionMessage\",\"protocolMessage\",\"extendedTextMessage\",\"documentMessage\"];function C(a,b){var c=D(b);return{id:{externalId:a.externalId,author:a.author,chat:a.jid},ts:a.ts,ack:d(\"WAAckLevel\").ACK.RECEIVED,serverTs:a.ts,forwardingScore:E(b,c)}}function D(a){switch(a.type){case\"imageMessage\":case\"videoMessage\":case\"extendedTextMessage\":case\"audioMessage\":case\"documentMessage\":return a.value.contextInfo;default:a.type;return null}}function E(a,b){if(a.type===\"futureproof\")return 0;return(b==null?void 0:b.forwardingScore)!=null?b==null?void 0:b.forwardingScore:(b==null?void 0:b.isForwarded)===!0?1:0}function F(a){var b=null;for(var e=0;e<B.length;e++)if(a[B[e]]!=null){if(b){d(\"WALogger\").ERROR(s(),b,B[e]);return null}b=B[e]}if(b==null){d(\"WALogger\").ERROR(r()).devConsole(a);return{type:\"futureproof\"}}switch(b){case\"audioMessage\":return a.audioMessage!=null?{type:\"audioMessage\",value:a.audioMessage}:null;case\"videoMessage\":return a.videoMessage!=null?{type:\"videoMessage\",value:a.videoMessage}:null;case\"imageMessage\":return a.imageMessage!=null?{type:\"imageMessage\",value:a.imageMessage}:null;case\"documentMessage\":return a.documentMessage!=null?{type:\"documentMessage\",value:a.documentMessage}:null;case\"conversation\":return a.conversation!=null?{type:\"conversation\",value:a.conversation}:null;case\"protocolMessage\":return a.protocolMessage!=null?{type:\"protocolMessage\",value:a.protocolMessage}:null;case\"extendedTextMessage\":return a.extendedTextMessage!=null?{type:\"extendedTextMessage\",value:a.extendedTextMessage}:null;case\"reactionMessage\":return a.reactionMessage!=null?{type:\"reactionMessage\",value:a.reactionMessage}:null;default:c(\"WAAssertUnreachable\")(b)}}function G(a,b){var c=P(a,\"image\");if(!c)return null;c=O(c,b);return babelHelpers[\"extends\"]({},c,{mediaType:d(\"WAMedia\").IMAGE,validatedVideoInfo:null,validatedImageInfo:{width:a.width,height:a.height,jpegThumbnail:a.jpegThumbnail},validatedAudioInfo:null,validatedDocumentFileInfo:null})}function H(a,b){var c=P(a,\"video\");if(!c)return null;c=O(c,b);return babelHelpers[\"extends\"]({},c,{mediaType:d(\"WAMedia\").VIDEO,validatedVideoInfo:{duration:a.seconds!=null&&a.seconds>1?a.seconds:1,width:a.width,height:a.height,mimetype:a.mimetype,jpegThumbnail:a.jpegThumbnail},validatedImageInfo:null,validatedAudioInfo:null,validatedDocumentFileInfo:null})}function I(a,b){var c=P(a,\"ptt\");if(!c)return null;c=O(c,b);return babelHelpers[\"extends\"]({},c,{mediaType:d(\"WAMedia\").PTT,validatedVideoInfo:null,validatedImageInfo:null,validatedAudioInfo:{duration:a.seconds!=null&&a.seconds>1?a.seconds:1,mimetype:a.mimetype,played:!1},validatedDocumentFileInfo:null})}function J(a,b){var c;c=(c=a.key)==null?void 0:c.id;var e=b.id.author;if(d(\"WAJids\").isAuthorSystem(e)){d(\"WALogger\").ERROR(q());return null}return c==null?null:{type:d(\"WAMsgType\").MSG_TYPE.REACTION,reactToAuthor:e,reaction:a.text,reactToExternalId:d(\"WAStanzaUtils\").toStanzaId(c),groupingKey:a.groupingKey,id:b.id,ts:b.ts,ack:d(\"WAAckLevel\").ACK.RECEIVED,serverTs:b.ts}}function K(a,b,c){var e=a.text;if(e==null){d(\"WALogger\").ERROR(p());return y()}a=L((a=a.contextInfo)==null?void 0:a.mentionedJid,e);e=babelHelpers[\"extends\"]({type:d(\"WAMsgType\").MSG_TYPE.TEXT,msgContent:{content:e,mentionedJids:(e=a)!=null?e:void 0},quote:(a=c)!=null?a:void 0},b);return z({unstoredMsg:e})}function L(a,b){b=b;if(a==null||b==null)return null;var c=[];for(var e=0;e<a.length;e++){var f=d(\"WAJids\").interpretAndValidateJid(a[e]);f.jidType===\"phoneUser\"&&b.includes(\"@\"+d(\"WAJids\").phoneNumberFromJid(f.userJid))&&c.push(f.userJid)}return c.length?d(\"WASortedLists\").sortAndDedupe(c):void 0}function M(a,b){var e=b.id.author,f=a.type;if(d(\"WAJids\").isAuthorSystem(e))throw c(\"WAErr\")(\"There are no admin made reactions\");else if(f==null)throw c(\"WAErr\")(\"Received invalid protocol message with no type\");switch(f){case d(\"WAE2E.pb\").Message$ProtocolMessage$Type.REVOKE:a=a.key;var g=b.id.chat;if(a&&(a.remoteJid===d(\"WAGlobals\").getMyUserJid()?e===g:a.remoteJid===g)&&a.id!=null){e=a.fromMe;g=a.id;e=(e=e)!=null?e:!1;if(e)return{id:b.id,ts:b.ts,sentTs:b.sentTs,serverTs:b.serverTs,ack:b.ack,reportingMeta:b.reportingMeta,type:d(\"WAMsgType\").MSG_TYPE.REVOKED,revokedExternalId:d(\"WAStanzaUtils\").toStanzaId(g),unsendMsgContentDeleteTs:null,msgContent:null};else{d(\"WALogger\").ERROR(o());return null}}else{d(\"WALogger\").ERROR(n()).devConsole(a,b);return null}case d(\"WAE2E.pb\").Message$ProtocolMessage$Type.EPHEMERAL_SETTING:case d(\"WAE2E.pb\").Message$ProtocolMessage$Type.EPHEMERAL_SYNC_RESPONSE:case d(\"WAE2E.pb\").Message$ProtocolMessage$Type.APP_STATE_SYNC_KEY_REQUEST:d(\"WALogger\").ERROR(m(),f);return null;default:d(\"WALogger\").ERROR(l(),f);return null}}function N(a,b){var c=P(a,\"document\");if(!c)return null;c=O(c,b);return babelHelpers[\"extends\"]({},c,{mediaType:d(\"WAMedia\").DOCUMENT_FILE,validatedVideoInfo:null,validatedImageInfo:null,validatedAudioInfo:null,validatedDocumentFileInfo:{filename:a.fileName,mimetype:a.mimetype}})}function O(a,b){return{mediaEntry:a.mediaEntry,plaintextHash:a.plaintextHash,size:a.size,msgIds:[],mediaEntries:new(d(\"WAMsgMap\").MsgMap)(),ts:b}}function P(a,b){var c=a.fileSha256;if(!c){d(\"WALogger\").ERROR(k());return null}var e=a.fileLength;if(e==null||e===0){d(\"WALogger\").ERROR(j(),e);return null}try{e=d(\"WALongInt\").numberOrThrowIfTooLarge(e)}catch(a){d(\"WALogger\").ERROR(i(),e);return null}if(a.fileSha256==null||a.fileEncSha256==null||a.mediaKey==null||a.directPath==null||a.mediaKeyTimestamp==null){d(\"WALogger\").ERROR(h());return null}a=d(\"WAMediaUtils\").rawDataToMediaEntry(a.fileSha256,a.fileEncSha256,a.mediaKey,a.directPath,d(\"WATimeUtils\").castLongIntToUnixTime(a.mediaKeyTimestamp),b);return{size:e,plaintextHash:d(\"WAMediaUtils\").toPlaintextHash(new Uint8Array(c)),mediaEntry:a}}g.FUTUREPROOF_TYPES=x;g.parseProtocol=a;g.interpretMsg=F}),98);\n__d(\"WAParseV3Protocol\",[\"WAAckLevel\",\"WAAssertUnreachable\",\"WAErr\",\"WAGlobals\",\"WAHex\",\"WAMsgType\",\"WAParseConsumerMessageProtocol\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return function(b,e,f,g,h){h={id:{chat:e,author:g,externalId:f},ts:h,serverTs:h,ack:d(\"WAAckLevel\").ACK.RECEIVED,forwardingScore:b.type!==\"futureProof\"?(f=b==null?void 0:(g=b.metadata)==null?void 0:g.forwardingScore)!=null?f:0:0};g=b.type!==\"futureProof\"&&((g=b.metadata)==null?void 0:(f=g.chatEphemeralSetting)==null?void 0:f.ephemeralExpiration)!=null&&((g=b.metadata)==null?void 0:(f=g.chatEphemeralSetting)==null?void 0:f.ephemeralExpiration)>0;if(b.type===\"futureProof\"||g&&!d(\"WAGlobals\").getConfig().isEphemeralMessagesEnabled())return{unstoredMsg:{type:d(\"WAMsgType\").FUTUREPROOF,msgContent:{subtype:null,protobuf:d(\"WAHex\").bytesToBuffer(b.protobuf)},id:h.id,ts:h.ts,sentTs:h.sentTs,serverTs:h.serverTs,ack:h.ack,reportingMeta:h.reportingMeta},unstoredMedia:null,unstoredQuotedMedia:null};else if(b.type===\"subprotocol\"){f=a==null?void 0:a.get(b.subprotocolType);if(f!=null)return f(e,b.subprotocol,h,b.protobuf,b.metadata);switch(b.subprotocolType){case\"consumerMessage\":return d(\"WAParseConsumerMessageProtocol\").parseConsumerMessageProtocol(e,b.subprotocol,h,b.protobuf,b.metadata);case\"businessMessage\":throw c(\"WAErr\")(\"unsupported subprotocolType: \"+b.subprotocolType);case\"paymentMessage\":throw c(\"WAErr\")(\"unsupported subprotocolType: \"+b.subprotocolType);case\"multiDevice\":throw c(\"WAErr\")(\"unsupported subprotocolType: \"+b.subprotocolType);case\"voip\":throw c(\"WAErr\")(\"unsupported subprotocolType: \"+b.subprotocolType);default:throw c(\"WAErr\")(\"Subprotocol parser for: \"+b.subprotocolType+\" was not found\")}}else return c(\"WAAssertUnreachable\")(b.type)}}g.createV3ProtocolParser=a}),98);\n__d(\"WAPreKeysStanzaUtils\",[\"WAWap\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b;return(b=d(\"WAWap\")).wap(\"key\",null,b.wap(\"id\",null,b.BIG_ENDIAN_CONTENT(a.id,3)),b.wap(\"value\",null,a.keyPair.publicKey))}function b(a){var b;return(b=d(\"WAWap\")).wap(\"skey\",null,b.wap(\"id\",null,b.BIG_ENDIAN_CONTENT(a.id,3)),b.wap(\"value\",null,a.keyPair.publicKey),b.wap(\"signature\",null,a.signature))}function c(a){var b=a.child(\"skey\"),c=null;if(a.hasChild(\"key\")){var d=a.child(\"key\");c={id:d.child(\"id\").contentUint(3),publicKey:d.child(\"value\").contentSerializedPubKey()}}return{identity:a.child(\"identity\").contentSerializedPubKey(),signedKey:{id:b.child(\"id\").contentUint(3),publicKey:b.child(\"value\").contentSerializedPubKey(),signature:b.child(\"signature\").contentBytes(64)},oneTimeKey:c}}g.xmppPreKey=a;g.xmppSignedPreKey=b;g.readSessionInfo=c}),98);\n__d(\"WASmaxInPreKeysIQErrorItemNotFoundMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"item-not-found\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",404);return!a.success?a:d(\"WAResultOrError\").makeResult({text:b.value,code:a.value})}g.parseIQErrorItemNotFoundMixin=a}),98);\n__d(\"WASmaxInPreKeysIQErrorNotAcceptableMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"field\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"name\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrString(a,\"reason\");return!a.success?a:d(\"WAResultOrError\").makeResult({name:b.value,reason:a.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"field\",h);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"not-acceptable\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",406);return!a.success?a:d(\"WAResultOrError\").makeResult({text:c.value,code:a.value,field:b.value})}g.parseIQErrorNotAcceptableField=h;g.parseIQErrorNotAcceptableMixin=a}),98);\n__d(\"WASmaxInPreKeysRequestErrorsFetchDigest\",[\"WAResultOrError\",\"WASmaxInPreKeysIQErrorFallbackClientMixin\",\"WASmaxInPreKeysIQErrorItemNotFoundMixin\",\"WASmaxInPreKeysIQErrorNotAcceptableMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInPreKeysIQErrorNotAcceptableMixin\").parseIQErrorNotAcceptableMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"IQErrorNotAcceptable\",value:b.value});var c=d(\"WASmaxInPreKeysIQErrorItemNotFoundMixin\").parseIQErrorItemNotFoundMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"IQErrorItemNotFound\",value:c.value});var e=d(\"WASmaxInPreKeysIQErrorFallbackClientMixin\").parseIQErrorFallbackClientMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"IQErrorFallbackClient\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"IQErrorNotAcceptable\",\"IQErrorItemNotFound\",\"IQErrorFallbackClient\"],[b,c,e])}g.parseRequestErrorsFetchDigest=a}),98);\n__d(\"WASmaxInPreKeysFetchDigestResponseRequestError\",[\"WAResultOrError\",\"WASmaxInPreKeysIQErrorResponseMixin\",\"WASmaxInPreKeysRequestErrorsFetchDigest\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInPreKeysIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInPreKeysRequestErrorsFetchDigest\").parseRequestErrorsFetchDigest(c.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{errorRequestErrorsFetchDigest:b.value}))}g.parseFetchDigestResponseRequestError=a}),98);\n__d(\"WASmaxInPreKeysFetchDigestResponseServerError\",[\"WAResultOrError\",\"WASmaxInPreKeysIQErrorResponseMixin\",\"WASmaxInPreKeysServerErrors\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInPreKeysIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInPreKeysServerErrors\").parseServerErrors(c.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{errorServerErrors:b.value}))}g.parseFetchDigestResponseServerError=a}),98);\n__d(\"WASmaxInPreKeysKeysHashMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"hash\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentBytesRange(a.value,20,20);return!a.success?a:d(\"WAResultOrError\").makeResult({hashElementValue:a.value})}g.parseKeysHashMixin=a}),98);\n__d(\"WASmaxInPreKeysPreKeyIDListMixin\",[\"WAResultOrError\",\"WASmaxInPreKeysKeyIDMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"id\");if(!b.success)return b;b=d(\"WASmaxInPreKeysKeyIDMixin\").parseKeyIDMixin(a);return!b.success?b:b}function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"list\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a.value,\"id\",0,2e4,h);return!a.success?a:d(\"WAResultOrError\").makeResult({listId:a.value})}g.parsePreKeyIDListListId=h;g.parsePreKeyIDListMixin=a}),98);\n__d(\"WASmaxInPreKeysIdentityDigestBundleMixin\",[\"WAResultOrError\",\"WASmaxInPreKeysIdentityKeyMixin\",\"WASmaxInPreKeysKeyTypeMixin\",\"WASmaxInPreKeysKeysHashMixin\",\"WASmaxInPreKeysPreKeyIDListMixin\",\"WASmaxInPreKeysRegistrationIDMixin\",\"WASmaxInPreKeysSignedPreKeyMixin\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInPreKeysRegistrationIDMixin\").parseRegistrationIDMixin(a);if(!b.success)return b;var c=d(\"WASmaxInPreKeysIdentityKeyMixin\").parseIdentityKeyMixin(a);if(!c.success)return c;var e=d(\"WASmaxInPreKeysPreKeyIDListMixin\").parsePreKeyIDListMixin(a);if(!e.success)return e;var f=d(\"WASmaxInPreKeysSignedPreKeyMixin\").parseSignedPreKeyMixin(a);if(!f.success)return f;var g=d(\"WASmaxInPreKeysKeyTypeMixin\").parseKeyTypeMixin(a);a=d(\"WASmaxInPreKeysKeysHashMixin\").parseKeysHashMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,c.value,e.value,f.value,{keyTypeMixin:g.success?g.value:null},a.value))}g.parseIdentityDigestBundleMixin=a}),98);\n__d(\"WASmaxInPreKeysFetchDigestResponseSuccess\",[\"WAResultOrError\",\"WASmaxInPreKeysIQResultResponseMixin\",\"WASmaxInPreKeysIdentityDigestBundleMixin\",\"WASmaxParseReference\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"digest\");if(!c.success)return c;var e=d(\"WASmaxParseReference\").optionalAttrStringFromReference(b,[\"digest\",\"identity_type\"]);if(!e.success)return e;e=d(\"WASmaxParseUtils\").optionalLiteral(d(\"WASmaxParseUtils\").attrString,c.value,\"identity_type\",e.value);if(!e.success)return e;c=d(\"WASmaxInPreKeysIdentityDigestBundleMixin\").parseIdentityDigestBundleMixin(c.value);if(!c.success)return c;a=d(\"WASmaxInPreKeysIQResultResponseMixin\").parseIQResultResponseMixin(a,b);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({hasDigestIdentityType:e.value!=null,digestIdentityDigestBundleMixin:c.value},a.value))}g.parseFetchDigestResponseSuccess=a}),98);\n__d(\"WASmaxOutPreKeysFetchDigestRequest\",[\"WASmaxJsx\",\"WASmaxOutPreKeysClientRequestMixin\"],(function(a,b,c,d,e,f,g){function a(){var a=d(\"WASmaxOutPreKeysClientRequestMixin\").mergeClientRequestMixin(d(\"WASmaxJsx\").smax(\"iq\",{type:\"get\"},d(\"WASmaxJsx\").smax(\"digest\",null)));return a}g.makeFetchDigestRequest=a}),98);\n__d(\"WASmaxPreKeysFetchDigestRPC\",[\"WAComms\",\"WASmaxInPreKeysFetchDigestResponseRequestError\",\"WASmaxInPreKeysFetchDigestResponseServerError\",\"WASmaxInPreKeysFetchDigestResponseSuccess\",\"WASmaxOutPreKeysFetchDigestRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a){var c,e,f,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:c=d(\"WASmaxOutPreKeysFetchDigestRequest\").makeFetchDigestRequest();i.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(c,a));case 3:e=i.sent;f=d(\"WASmaxInPreKeysFetchDigestResponseSuccess\").parseFetchDigestResponseSuccess(e,c);if(!f.success){i.next=7;break}return i.abrupt(\"return\",{name:\"FetchDigestResponseSuccess\",value:f.value});case 7:g=d(\"WASmaxInPreKeysFetchDigestResponseRequestError\").parseFetchDigestResponseRequestError(e,c);if(!g.success){i.next=10;break}return i.abrupt(\"return\",{name:\"FetchDigestResponseRequestError\",value:g.value});case 10:h=d(\"WASmaxInPreKeysFetchDigestResponseServerError\").parseFetchDigestResponseServerError(e,c);if(!h.success){i.next=13;break}return i.abrupt(\"return\",{name:\"FetchDigestResponseServerError\",value:h.value});case 13:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"FetchDigest\",{Success:f,RequestError:g,ServerError:h}));case 14:case\"end\":return i.stop()}},null,this)}g.sendFetchDigestRPC=a}),98);\n__d(\"WARequestPreKeyDigestProtocol\",[\"WABinary\",\"WAConvertRegistrationIdMixin\",\"WAConvertSignedPreKeyMixin\",\"WACryptoDependencies\",\"WACryptoUtils\",\"WAParsableXmlNode\",\"WAResultOrError\",\"WASignalKeys\",\"WASmaxPreKeysFetchDigestRPC\",\"WATagsLogger\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": \",\"\"]);i=function(){return a};return a}var j=d(\"WATagsLogger\").TAGS([\"requestPreKeyDigestProtocol\"]);function a(a){return d(\"WASmaxPreKeysFetchDigestRPC\").sendFetchDigestRPC({withoutRetry:!1}).then(function(b){switch(b.name){case\"FetchDigestResponseServerError\":var c=b.value.errorServerErrors.name;j.ERROR(i(),b.name,c);return d(\"WAResultOrError\").makeError({type:\"server-error\",payload:c});case\"FetchDigestResponseRequestError\":c=b.value.errorRequestErrorsFetchDigest.name;j.ERROR(h(),b.name,c);return d(\"WAResultOrError\").makeError({type:\"request-error\",payload:c});default:b.name;c=k(b.value.digestIdentityDigestBundleMixin);return l(c,a).then(function(a){return a===\"ok\"?d(\"WAResultOrError\").makeResult():d(\"WAResultOrError\").makeError({type:\"compare-error\",payload:a})})}})}function k(a){var b=d(\"WAConvertRegistrationIdMixin\").registrationIdMixin(a),c=d(\"WAConvertSignedPreKeyMixin\").convertSignedPreKeyMixin(a),e=a.listId.map(function(a){return d(\"WASignalKeys\").castToPreKeyId(d(\"WAParsableXmlNode\").convertBytesToUint(a.elementValue,3))});a=a.hashElementValue;return{regId:b,skeyId:c.id,preKeyIds:e,hash:a}}function l(a,c){var e,f,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!(a.regId!==c.regInfo.regId)){i.next=2;break}return i.abrupt(\"return\",\"RegIdMismatch\");case 2:if(!(a.skeyId!==c.signedPreKey.id)){i.next=4;break}return i.abrupt(\"return\",\"SignedPreKeyIdMismatch\");case 4:e=new Map();c.preKeys.forEach(function(a){return e.set(a.id,a)});f=a.preKeyIds.some(function(a){return!e.has(a)});if(!f){i.next=9;break}return i.abrupt(\"return\",\"UnknownPreKey\");case 9:g=a.preKeyIds.map(function(a){return e.get(a)}).filter(Boolean);i.next=12;return b(\"regeneratorRuntime\").awrap(m(c,g));case 12:h=i.sent;if(d(\"WACryptoUtils\").uint8ArraysEqual(h,a.hash)){i.next=15;break}return i.abrupt(\"return\",\"HashMismatch\");case 15:return i.abrupt(\"return\",\"ok\");case 16:case\"end\":return i.stop()}},null,this)}function m(a,b){var c=new(d(\"WABinary\").Binary)();c.writeByteArray(a.regInfo.staticKeyPair.publicKey);c.writeByteArray(a.signedPreKey.keyPair.publicKey);c.writeByteArray(a.signedPreKey.signature);b.forEach(function(a){c.writeByteArray(a.keyPair.publicKey)});return d(\"WACryptoDependencies\").getCrypto().subtle.digest(\"SHA-1\",c.readByteArray()).then(function(a){return new Uint8Array(a)})}g.requestPreKeyDigestProtocol=a}),98);\n__d(\"WARequestPreKeyDigest\",[\"WABridge\",\"WAErr\",\"WAGetKeysForUpload\",\"WAGlobals\",\"WAJobDefinitions\",\"WAJobOrchestratorTypes\",\"WAJobs\",\"WALogger\",\"WAOdsEnums\",\"WAPromiseManagement\",\"WARequestPreKeyDigestProtocol\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"PreKey digest comparison failed: \",\"\"]);h=function(){return a};return a}function i(a){var e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b(\"regeneratorRuntime\").awrap(a(function(a){a=a.cryptoManager;return d(\"WAGetKeysForUpload\").getKeysForUpload(a)}));case 2:e=g.sent;if(!(e.success===!1)){g.next=6;break}d(\"WABridge\").getBridge().fireAndForget(\"event\",\"odsBumpEntityKey\",{entity:d(\"WAOdsEnums\").Entity.PREKEY_DIGEST,key:\"fail\"});throw c(\"WAErr\")(\"Error while loading keys: \"+e.error);case 6:g.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WARequestPreKeyDigestProtocol\").requestPreKeyDigestProtocol(e.value));case 8:f=g.sent;if(!(f.success===!1)){g.next=17;break}d(\"WABridge\").getBridge().fireAndForget(\"event\",\"odsBumpEntityKey\",{entity:d(\"WAOdsEnums\").Entity.PREKEY_DIGEST,key:\"fail\"});if(!(f.error.type===\"compare-error\")){g.next=16;break}d(\"WALogger\").ERROR(h(),f.error.payload);g.next=15;return b(\"regeneratorRuntime\").awrap(d(\"WAJobs\").getJobManager().waitUntilPersisted(d(\"WAJobDefinitions\").createStartJobInfo(\"generateAndUploadPreKeys\",{scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH},reason:\"prekey digest comparison failed\",uniqueJob:!0})));case 15:return g.abrupt(\"return\");case 16:throw c(\"WAErr\")(\"Error while requesting key digest: \"+f.error.type+\" \"+f.error.payload);case 17:f.success,d(\"WABridge\").getBridge().fireAndForget(\"event\",\"odsBumpEntityKey\",{entity:d(\"WAOdsEnums\").Entity.PREKEY_DIGEST,key:\"success\"});case 19:case\"end\":return g.stop()}},null,this)}a=d(\"WAJobs\").getPersistedJobsApi().definePersistedJob().finalStep(\"requestPreKeyDigest\",d(\"WAPromiseManagement\").nullaryCacheWhilePending(function(){return i(function(a){return d(\"WAGlobals\").getWaOneQueue().enqueue(a,{operationType:\"request_prekey_digest\",flush:!1})})})).end();g.requestPreKeyDigestFn=i;g.requestPreKeyDigest=a}),98);\n__d(\"WAReceiptUtils\",[\"WACryptoManagerUtils\",\"WADeprecatedSendIq\",\"WAPREList\",\"WAPREMetrics\",\"WAPreKeysStanzaUtils\",\"WARequestPreKeyDigest\",\"WAWap\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a,c){var e,f,g,h,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:e=a.retryCount;f=e+1;g=d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.RETRY_RECEIPTS_SENT,{\"int\":{retries:f}});if(!(f>=3)){k.next=6;break}k.next=6;return b(\"regeneratorRuntime\").awrap(d(\"WARequestPreKeyDigest\").requestPreKeyDigestFn(function(a){return a(c)}));case 6:h=null;if(!(f>=2)){k.next=11;break}k.next=10;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoManagerUtils\").getSignalInfoForRetry(c.cryptoManager));case 10:h=k.sent;case 11:j=c.cryptoManager.regInfo.regId;g.endSuccess();return k.abrupt(\"return\",i(a,f,j,h));case 14:case\"end\":return k.stop()}},null,this)}function a(a,c){var e,f,g,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:e=a.externalId,f=a.from,g=a.participant;f.type===\"group\"?i=f.groupJid:(f.type,i=f.deviceJid);j.t0=b(\"regeneratorRuntime\");j.t1=d(\"WADeprecatedSendIq\").deprecatedSendStanzaAndWaitForAck;j.next=6;return b(\"regeneratorRuntime\").awrap(h(a,c));case 6:j.t2=j.sent;j.t3={id:e,\"class\":\"receipt\",from:i,participant:g};j.t4=j.t1(j.t2,j.t3);j.next=11;return j.t0.awrap.call(j.t0,j.t4);case 11:case\"end\":return j.stop()}},null,this)}function i(a,b,c,e){var f=null;if(e!=null){var g=e.keyType,h=e.signedPreKey,i=e.preKey;e=e.publicKey;var j=a.deviceIdentity!=null?d(\"WAWap\").wap(\"device-identity\",null,a.deviceIdentity):null;f=d(\"WAWap\").wap(\"keys\",null,d(\"WAWap\").wap(\"type\",null,d(\"WAWap\").BIG_ENDIAN_CONTENT(g,1)),d(\"WAWap\").wap(\"identity\",null,e),d(\"WAPreKeysStanzaUtils\").xmppPreKey(i),d(\"WAPreKeysStanzaUtils\").xmppSignedPreKey(h),j)}a.from.type===\"group\"?g=a.from.groupJid:(a.from.type,g=a.from.deviceJid);return d(\"WAWap\").wap(\"receipt\",{category:a.category!=null?d(\"WAWap\").CUSTOM_STRING(a.category):d(\"WAWap\").DROP_ATTR,id:d(\"WAWap\").CUSTOM_STRING(a.externalId),participant:a.participant?d(\"WAWap\").DEVICE_JID(a.participant):d(\"WAWap\").DROP_ATTR,recipient:a.recipient?d(\"WAWap\").USER_JID(a.recipient):d(\"WAWap\").DROP_ATTR,to:d(\"WAWap\").JID(g),type:\"retry\"},d(\"WAWap\").wap(\"retry\",{count:d(\"WAWap\").INT(b),id:d(\"WAWap\").CUSTOM_STRING(a.externalId),t:d(\"WAWap\").INT(a.ts),v:\"1\"}),d(\"WAWap\").wap(\"registration\",null,d(\"WAWap\").BIG_ENDIAN_CONTENT(c)),f)}g.makeRetryReceipt=h;g.sendRetryReceipt=a}),98);\n__d(\"WATransformRetryOrIndividualRegularMixinGroup\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a){return{retryCount:a.name===\"Retry\"?a.value.encEncRetryMixin.count:0,ciphertext:a.value.encEncTypeIndividualMixin.elementValue,encVersion:String(a.value.encEncVersion2Or3OrFutureproofMixinGroup.value.v),encType:a.value.encEncTypeIndividualMixin.type}}f.transformRetryOrIndividualRegularMixinGroup=a}),66);\n__d(\"WAHandleIndividualMessageProtocol\",[\"WACryptoPkcs7\",\"WADecodeIncomingMsg\",\"WAE2E.pb\",\"WAErr\",\"WAForceSecondRetryErrorTypes\",\"WAICDCUtils\",\"WAJids\",\"WALogger\",\"WAParseProtocol\",\"WAParseV3Protocol\",\"WAReceiptUtils\",\"WAResultOrError\",\"WATransformRetryOrIndividualRegularMixinGroup\",\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"enc version \",\" is not supported.\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown message content type: \",\"\"]);i=function(){return a};return a}var j=d(\"WAParseV3Protocol\").createV3ProtocolParser();function k(a){switch(a){case\"ContentTypeText\":return\"text\";case\"ContentTypeLiveLocationSingle\":return\"live_location\";case\"ContentTypeMedia\":return\"media\";case\"ContentTypeMedianotify\":case\"ContentTypeMediaSingle\":return\"media\";case\"ContentTypePayIndividual\":return\"pay\";case\"ContentTypeReaction\":return\"reaction\";case\"ContentTypeList\":return\"product_list\";case\"ContentTypePollCreation\":return\"poll_creation\";case\"ContentTypePollVote\":return\"poll_vote\";default:a;d(\"WALogger\").ERROR(i(),a);return\"text\"}}function a(a){var b=a.from,e=a.recipientMixin;a=a.availableOrUnavailableMixinGroup;var f=d(\"WAJids\").extractUserJid(b),g=e==null?f:e.recipient;f=e==null?f:\"@me\";if(a.name===\"Unavailable\")return{type:\"Unavailable\",author:f,chat:g,from:b,recipient:e==null?void 0:e.recipient,contentType:k(a.value.contentUnavailableMixins.name)};var h=a.value.retryOrIndividualRegularOrBotResponseMessageMixinGroup;if(h.name===\"BotResponseMessage\")throw c(\"WAErr\")(\"BotResponseMessage is unsupported\");return babelHelpers[\"extends\"]({type:\"Available\",author:f,chat:g,from:b,recipient:e==null?void 0:e.recipient},d(\"WATransformRetryOrIndividualRegularMixinGroup\").transformRetryOrIndividualRegularMixinGroup(h),{contentType:k(a.value.contentAvailableMixins.name)})}e=function(a){a=a.decryptedMessage;var b=a.plaintext,c=a.encVersion,e=a.author,f=a.chat,g=a.stanzaId;a=a.serverTs;if(c!==\"2\"&&c!==\"3\"){d(\"WALogger\").WARN(h(),c);return d(\"WAResultOrError\").makeError(\"unknown-plaintext\")}var i=null;if(c===\"2\"){var k,l=d(\"WACryptoPkcs7\").unpadPkcs7(b);l=d(\"decodeProtobuf\").decodeProtobuf(d(\"WAE2E.pb\").MessageSpec,l);if(l.deviceSentMessage!=null&&l.deviceSentMessage.destinationJid!==f)return d(\"WAResultOrError\").makeError(\"invalid-device-sent-message\");k=(k=l.deviceSentMessage)==null?void 0:k.message;k!=null&&(l=k);k={author:e,bytes:b,externalId:g,jid:f,proto:l,ts:a};i=d(\"WAParseProtocol\").parseProtocol(k)}else{c;l=e===\"@me\"?f:null;k=d(\"WADecodeIncomingMsg\").decodeIncomingMsg(b,\"v3\",l);if(k.version!==\"v3\"||k.type!==\"subprotocol\")return d(\"WAResultOrError\").makeError(\"unknown-plaintext\");i=j(k,f,g,e,a)}return d(\"WAResultOrError\").makeResult(i)};f=function(a,b){var c=a.stanzaId,e=a.serverTs,f=a.retryCount,g=a.from,h=a.author,i=a.chat;a=a.deviceIdentity;h=h===\"@me\";return d(\"WAReceiptUtils\").sendRetryReceipt({category:null,externalId:c,from:{deviceJid:g,type:\"device\"},participant:null,recipient:h?i:null,retryCount:f,ts:e,deviceIdentity:a},b)};var l=function(a,b){var c=a.stanzaId,e=a.serverTs,f=a.retryCount,g=a.from,h=a.author,i=a.chat,j=a.deviceIdentity;a=a.error;h=h===\"@me\";var k=f;d(\"WAForceSecondRetryErrorTypes\").FORCE_SECOND_RETRY_ON.has(a)&&(k=Math.max(2,f));return d(\"WAReceiptUtils\").makeRetryReceipt({category:null,externalId:c,from:{deviceJid:g,type:\"device\"},participant:null,recipient:h?i:null,retryCount:k,ts:e,deviceIdentity:j},b)};function b(a){var b=a.icdc,c=a.from;a=a.serverTs;d(\"WAICDCUtils\").icdcFlushable.enqueue({icdc:b,from:c,serverTs:a})}g.parseIndividualMessage=a;g.decodeIndividualMessage=e;g.sendIndividualMessageRetryReceipt=f;g.makeIndividualMessageRetryReceipt=l;g.handleICDCPayloadFromIncomingMsg=b}),98);\n__d(\"WAMessageLoggingPublisher\",[\"WAHashStringToNumber\",\"WAPubSub\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return d(\"WAHashStringToNumber\").hashStringToNumber(a)}b=d(\"WAPubSub\").simplePubSub();g.getWAIncomingMsgLoggingId=a;g.messageLoggingPublisher=b}),98);\n__d(\"MAWHandleAvailableIndividualMsg\",[\"MAWAdjustEphemerality\",\"MAWGetMsgByProtocolIdApi\",\"MAWReportingMeta\",\"WACryptoManagerUtils\",\"WADecodeIncomingMsg\",\"WAFranking\",\"WAGlobals\",\"WAHandleIndividualMessageProtocol\",\"WAMessageLoggingPublisher\",\"WAProtocolQueue\",\"WAResultOrError\",\"WATagsLogger\",\"asyncToGeneratorRuntime\",\"err\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Decrypted msg with error \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received message with invalid or missing franking tag\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unsupported type \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Decoding error \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Decoded not v3 protobuff\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received not v3 protobuff\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Fail to persist the msg \",\"\"]);p=function(){return a};return a}var q=d(\"WATagsLogger\").TAGS([\"AvailableIndividualMsgHandling\"]);function r(a,b,c){d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({commonMessageBase:a,id:c,msg:b,type:\"decrypt-start\"})}function s(a){d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:a,type:\"persist-start\"})}function t(a){d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:a,type:\"persist-end\"})}function u(a,b){q.ERROR(p(),b),d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:a,type:\"persist-fail\"})}function v(a,b,c,d,e,f){return w.apply(this,arguments)}function w(){w=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,e,f,g,h){d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:e,type:\"decrypt-end\"});if(b.encVersion!==\"3\"){q.ERROR(o());throw c(\"err\")(\"Received not v3 protobuff\")}var i=a.internalTestConfig===\"armadillo_express\";i=d(\"WADecodeIncomingMsg\").decodeIncomingMsg(h.plaintext,\"v3\",null,i);if(i.version===\"v2\"){q.ERROR(n());throw c(\"err\")(\"Decoded not v3 protobuff\")}if(i.type===\"error\"){q.ERROR(m(),i.error);throw c(\"err\")(\"Decoding error \"+i.error)}if(i.type===\"msgWithSKDM\"||i.type===\"skdm\"){q.ERROR(l(),i.type);throw c(\"err\")(\"Unsupported type \"+i.type)}var j=(yield d(\"WAFranking\").handleAndValidateFrankingFromIncomingMsg(i,d(\"MAWReportingMeta\").getReportingMeta(a)));if(j.decision===d(\"WAFranking\").FrankingDecision.DROP){q.ERROR(k());d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:e,type:\"franking-drop\"});return f()}i.version===\"v3\"&&i.type===\"subprotocol\"&&i.icdc!=null&&d(\"WAHandleIndividualMessageProtocol\").handleICDCPayloadFromIncomingMsg({from:b.from,icdc:i.icdc,serverTs:a.serverTs});i.type===\"ephemeral\"&&(i=d(\"MAWAdjustEphemerality\").adjustEphemerality(i,a.serverTs));s(e);if(i.type===\"instamadillo\"){f={consumerRetries:0,contentType:b.contentType,failAcks:0,fbFolderId:a.fbFolderId,from:b.from,jid:b.chat,message:i,offline:a.offline,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh,recipient:b.recipient,remoteIdentity:h.remoteIdentity,reportingMeta:j.updatedReportingMeta,retryCount:b.retryCount,serverTs:a.serverTs,stanzaId:a.stanzaId,subtype:\"instamadillo\",type:\"message\"};f=f}else{i={consumerRetries:0,contentType:b.contentType,failAcks:0,fbFolderId:a.fbFolderId,from:b.from,jid:b.chat,message:i,offline:a.offline,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh,recipient:b.recipient,remoteIdentity:h.remoteIdentity,reportingMeta:j.updatedReportingMeta,retryCount:b.retryCount,serverTs:a.serverTs,stanzaId:a.stanzaId,subtype:\"armadillo\",type:\"message\"};f=i}void d(\"WAProtocolQueue\").protocolQueue().write(f).then(function(){t(e)})[\"catch\"](function(a){u(e,a)});return g({chat:b.chat,from:b.from,stanzaId:a.stanzaId})});return w.apply(this,arguments)}function x(a,b,c,d,e,f,g){return y.apply(this,arguments)}function y(){y=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,e,f,g,k,l){d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({errorResult:k,id:e,type:\"decrypt-fail\"});var m=!0;a.hideDecryptionFailure&&(m=!1);if(k.error===\"errDuplicateMsg\"){var n={author:b.author,chat:b.chat,externalId:a.stanzaId},o=(yield d(\"MAWGetMsgByProtocolIdApi\").getMsgExistenceByProtocolMsgId(n)[\"catch\"](function(a){q.ERROR(j(),a)}));n=(yield d(\"MAWGetMsgByProtocolIdApi\").getProtocolQueueExistenceByProtocolMsgIds(n)[\"catch\"](function(a){q.ERROR(i(),a)}));(o===!0||n===!0)&&(m=!1)}q.WARN(h(),k.error);c(\"gkx\")(\"23915\")&&(yield d(\"WAGlobals\").getDbImpls().writeDebugMsg(b.chat,\"Message \"+a.stanzaId+\" has decryption error: \"+k.error+\" from user \"+b.from,{decryptionError:k.error,protocolMsgId:{author:b.author,chat:b.chat,externalId:a.stanzaId}}));if(!m)return f({chat:b.chat,from:b.from,stanzaId:a.stanzaId});s(e);o={consumerRetries:0,contentType:b.contentType,decryptionError:k.error,failAcks:0,fbFolderId:a.fbFolderId,from:b.from,jid:b.chat,offline:a.offline,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh,recipient:b.recipient,reportingMeta:d(\"MAWReportingMeta\").getReportingMeta(a),retryCount:b.retryCount,serverTs:a.serverTs,stanzaId:a.stanzaId,subtype:\"ciphertext\",type:\"message\"};void d(\"WAProtocolQueue\").protocolQueue().write(o).then(function(){t(e)})[\"catch\"](function(a){u(e,a)});d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:e,type:\"issue-retry\"});return g({author:b.author,chat:b.chat,deviceIdentity:null,error:k.error,from:b.from,retryCount:b.retryCount,serverTs:a.serverTs,stanzaId:a.stanzaId},l)});return y.apply(this,arguments)}function a(a,b,c,d,e,f){return z.apply(this,arguments)}function z(){z=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,c,e,f,g){var h=d(\"WAMessageLoggingPublisher\").getWAIncomingMsgLoggingId(a.stanzaId);d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({commonMessageBase:a,id:h,msg:b,type:\"new-message\"});r(a,b,h);var i=(yield d(\"WACryptoManagerUtils\").decryptMsg(b.encType,b.from,b.ciphertext,g));if(i.success===!1)return x(a,b,h,e,f,i,g);return i.value==null?x(a,b,h,e,f,d(\"WAResultOrError\").makeError(\"empty-content\"),g):v(a,b,h,c,e,i.value)});return z.apply(this,arguments)}g.handleIndividualMsg=a}),98);\n__d(\"MAWHandleGroupMsg\",[\"MAWAdjustEphemerality\",\"MAWGetMsgByProtocolIdApi\",\"MAWReportingMeta\",\"WACryptoManagerUtils\",\"WADecodeIncomingMsg\",\"WAFranking\",\"WAGlobals\",\"WAJids\",\"WAMessageLoggingPublisher\",\"WAProtocolQueue\",\"WAResultOrError\",\"WATagsLogger\",\"asyncToGeneratorRuntime\",\"err\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unsupported type \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unsupported type \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unsupported type \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Sender key session is saved\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Fail to save senderKeySession \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Saving sender key session\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Group mismatch \",\" vs \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Decoded not v3 protobuff\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unsupported type \",\"\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unsupported type \",\"\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"DualEnc cannot receive SKMSG first\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Fail to save senderKeySession \",\"\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Group mismatch \",\" vs \",\"\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Decrypted msg with error \",\"\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\"\"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\"\"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received message with invalid or missing franking tag\"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unsupported type instamadillo\"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose([\"msgWithSKDM skdm decoding error\"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Decoding error \",\"\"]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Decoded not v3 protobuff\"]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Fail to persist the msg \",\"\"]);C=function(){return a};return a}var D=d(\"WATagsLogger\").TAGS([\"GroupMsgHandling\"]);function E(a){d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:a,type:\"persist-end\"})}function F(a,b){D.ERROR(C(),b),d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:a,type:\"persist-fail\"})}function G(a,b,c,d,e,f,g,h,i){return H.apply(this,arguments)}function H(){H=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,e,f,g,h,i,j,k){a=a;if(a.version===\"v2\"){D.ERROR(B());throw c(\"err\")(\"Decoded not v3 protobuff\")}if(a.type===\"error\"){D.ERROR(A(),a.error);throw c(\"err\")(\"Decoding error \"+a.error)}if(a.type===\"msgWithSKDM\"){var l=a.skdm;if(l.type===\"error\"){D.ERROR(z());throw c(\"err\")(\"msgWithSKDM skdm decoding error\")}yield K(l,e.chat,e.from,k);return G(a.msg,b,e,f,g,h,i,j,k)}if(a.type===\"skdm\"){yield K(a,e.chat,e.from,k);d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:f,type:\"invisible-msg-done\"});return g()}if(a.type===\"instamadillo\"){D.ERROR(y());throw c(\"err\")(\"Unsupported type instamadillo\")}l=(yield d(\"WAFranking\").handleAndValidateFrankingFromIncomingMsg(a,d(\"MAWReportingMeta\").getReportingMeta(b)));if(l.decision===d(\"WAFranking\").FrankingDecision.DROP){D.ERROR(x());d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:f,type:\"franking-drop\"});return g()}a.type===\"ephemeral\"&&(a=d(\"MAWAdjustEphemerality\").adjustEphemerality(a,b.serverTs));d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:f,type:\"persist-start\"});k={consumerRetries:0,contentType:e.contentType,failAcks:0,fbFolderId:b.fbFolderId,from:e.from,jid:e.chat,message:a,offline:b.offline,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh,recipient:void 0,remoteIdentity:i,reportingMeta:l.updatedReportingMeta,retryCount:j,serverTs:b.serverTs,stanzaId:b.stanzaId,subtype:\"armadillo\",type:\"message\"};void d(\"WAProtocolQueue\").protocolQueue().write(k).then(function(){E(f)})[\"catch\"](function(a){F(f,a)});return h({chat:e.chat,from:e.from,stanzaId:b.stanzaId})});return H.apply(this,arguments)}function I(a,b,c,d,e,f,g,h){return J.apply(this,arguments)}function J(){J=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,e,f,g,h,i,j){d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({errorResult:h,id:e,type:\"decrypt-fail\"});var k=!0;a.hideDecryptionFailure&&(k=!1);if(h.error===\"errDuplicateMsg\"){var l={author:b.author,chat:b.chat,externalId:a.stanzaId},m=(yield d(\"MAWGetMsgByProtocolIdApi\").getMsgExistenceByProtocolMsgId(l)[\"catch\"](function(a){D.ERROR(w(),a)}));l=(yield d(\"MAWGetMsgByProtocolIdApi\").getProtocolQueueExistenceByProtocolMsgIds(l)[\"catch\"](function(a){D.ERROR(v(),a)}));(m===!0||l===!0)&&(k=!1)}D.WARN(u(),h.error);c(\"gkx\")(\"23915\")&&(yield d(\"WAGlobals\").getDbImpls().writeDebugMsg(b.chat,\"Message \"+a.stanzaId+\" has decryption error: \"+h.error+\" from user \"+b.from,{decryptionError:h.error,protocolMsgId:{author:b.author,chat:b.chat,externalId:a.stanzaId}}));if(!k)return f({chat:b.chat,from:b.from,stanzaId:a.stanzaId});if(a.hideDecryptionFailure===!1){d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:e,type:\"persist-start\"});m={consumerRetries:0,contentType:b.contentType,decryptionError:h.error,failAcks:0,fbFolderId:a.fbFolderId,from:b.from,jid:b.chat,offline:a.offline,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh,recipient:void 0,reportingMeta:d(\"MAWReportingMeta\").getReportingMeta(a),retryCount:i,serverTs:a.serverTs,stanzaId:a.stanzaId,subtype:\"ciphertext\",type:\"message\"};void d(\"WAProtocolQueue\").protocolQueue().write(m).then(function(){E(e)})[\"catch\"](function(a){F(e,a)});d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:e,type:\"issue-retry\"})}return g({author:b.author,chat:b.chat,deviceIdentity:null,error:h.error,from:b.from,retryCount:i,serverTs:a.serverTs,stanzaId:a.stanzaId},j)});return J.apply(this,arguments)}function K(a,b,c,d){return L.apply(this,arguments)}function L(){L=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,e,f){if(d(\"WAJids\").toGroupJid(a.msg.groupId)!==b){D.ERROR(t(),a.msg.groupId,b);throw c(\"err\")(\"group-mismatch\")}b=(yield d(\"WACryptoManagerUtils\").saveSenderKeySession(b,e,new Uint8Array(a.msg.senderKey),f));if(!b.success){D.ERROR(s(),b.error);throw c(\"err\")(\"fail-to-save\")}});return L.apply(this,arguments)}function M(a,b){return N.apply(this,arguments)}function N(){N=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){var e=a.senderKeyDistributionEnc,f;switch(e.encType){case\"skmsg\":D.ERROR(r());throw c(\"err\")(\"DualEnc cannot receive SKMSG first\");case\"pkmsg\":case\"msg\":f=(yield d(\"WACryptoManagerUtils\").decryptMsg(e.encType,a.from,e.ciphertext,b));break;case\"msmsg\":D.ERROR(q(),e.encType);throw c(\"err\")(\"Unsupported type \"+e.encType);default:e.encType;D.ERROR(p(),e.encType);throw c(\"err\")(\"Unsupported type \"+e.encType)}if(f.success===!1)return d(\"WAResultOrError\").makeError(f.error);if(f.value==null)return d(\"WAResultOrError\").makeError(\"empty\");e=d(\"WADecodeIncomingMsg\").decodeIncomingMsg(f.value.plaintext,\"v3\");if(e.version!==\"v3\"){D.ERROR(o());return d(\"WAResultOrError\").makeError(\"not-v3\")}if(e.type===\"skdm\"){if(d(\"WAJids\").toGroupJid(e.msg.groupId)!==a.chat){D.ERROR(n(),e.msg.groupId,a.chat);return d(\"WAResultOrError\").makeError(\"group-mismatch\")}D.LOG(m());a=(yield d(\"WACryptoManagerUtils\").saveSenderKeySession(a.chat,a.from,new Uint8Array(e.msg.senderKey),b));if(!a.success){D.ERROR(l(),a.error);return d(\"WAResultOrError\").makeError(\"fail-to-save\")}D.LOG(k());return d(\"WAResultOrError\").makeResult()}else{D.ERROR(j(),e.type);return d(\"WAResultOrError\").makeError(\"fail-to-save\")}});return N.apply(this,arguments)}function a(a,b,c,d,e,f){return O.apply(this,arguments)}function O(){O=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,e,f,g,j){var k=d(\"WAMessageLoggingPublisher\").getWAIncomingMsgLoggingId(a.stanzaId);d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({commonMessageBase:a,id:k,msg:b,type:\"new-message\"});d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({commonMessageBase:a,id:k,msg:b,type:\"decrypt-start\"});var l=0;if(b.type===\"DualEnc\"){var m=(yield M(b,j));d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:k,result:m,type:\"decrypt-skdm-done\"});m=b.senderKeyMessageEnc}else{var n;m=b.enc;l=(n=b.enc.retryCount)!=null?n:0}var o;switch(m.encType){case\"skmsg\":o=(yield d(\"WACryptoManagerUtils\").decryptGroupMsg(b.chat,b.from,m.ciphertext,j));break;case\"pkmsg\":case\"msg\":o=(yield d(\"WACryptoManagerUtils\").decryptMsg(m.encType,b.from,m.ciphertext,j));break;case\"msmsg\":D.ERROR(i(),m.encType);throw c(\"err\")(\"Unsupported type \"+m.encType);default:m.encType;D.ERROR(h(),m.encType);throw c(\"err\")(\"Unsupported type \"+m.encType)}if(o.success===!1)return I(a,b,k,f,g,o,l,j);if(o.value==null)return I(a,b,k,f,g,d(\"WAResultOrError\").makeError(\"empty-content\"),l,j);n=o.value;m=n.plaintext;g=n.remoteIdentity;d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:k,type:\"decrypt-end\"});return G(d(\"WADecodeIncomingMsg\").decodeIncomingMsg(m,\"v3\"),a,b,k,e,f,g,l,j)});return O.apply(this,arguments)}g.handleGroupMsg=a}),98);\n__d(\"MAWHandleUnavailableIndividualMsg\",[\"MAWReportingMeta\",\"Promise\",\"WAMessageLoggingPublisher\",\"WAProtocolQueue\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a,c,e){var f=d(\"WAMessageLoggingPublisher\").getWAIncomingMsgLoggingId(a.stanzaId);d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({commonMessageBase:a,id:f,msg:c,type:\"new-message\"});if(c.contentType===\"reaction\"){d(\"WAMessageLoggingPublisher\").messageLoggingPublisher.publish({id:f,type:\"unavailable-reaction\"});return(h||(h=b(\"Promise\"))).resolve(e())}if(a.hideDecryptionFailure)return(h||(h=b(\"Promise\"))).resolve(e());f={consumerRetries:0,contentType:c.contentType,failAcks:0,fbFolderId:a.fbFolderId,from:c.from,jid:c.chat,offline:a.offline,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh,recipient:c.recipient,reportingMeta:d(\"MAWReportingMeta\").getReportingMeta(a),retryCount:0,serverTs:a.serverTs,stanzaId:a.stanzaId,subtype:\"unavailable\",type:\"message\"};void d(\"WAProtocolQueue\").protocolQueue().write(f);return(h||(h=b(\"Promise\"))).resolve(e())}g.handleUnavailableMsg=a}),98);\n__d(\"MAWHandleIncomingMsgV2\",[\"MAWHandleAvailableIndividualMsg\",\"MAWHandleGroupMsg\",\"MAWHandleUnavailableIndividualMsg\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"HandleIncomingMsgV2\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"HandleIncomingMsgV2\"]);i=function(){return a};return a}a=function(a,b){a.decodeMessage;var c=a.makeAck,e=a.makeDeliveryReceipt,f=a.makeRetryReceipt,g=a.parsedMessage;a.sendDeliveryReceipt;a.sendRetryReceipt;a=babelHelpers.objectWithoutPropertiesLoose(a,[\"decodeMessage\",\"makeAck\",\"makeDeliveryReceipt\",\"makeRetryReceipt\",\"parsedMessage\",\"sendDeliveryReceipt\",\"sendRetryReceipt\"]);d(\"WALogger\").LOG(i());return g.type===\"Unavailable\"?d(\"MAWHandleUnavailableIndividualMsg\").handleUnavailableMsg(a,g,c):d(\"MAWHandleAvailableIndividualMsg\").handleIndividualMsg(a,g,c,e,f,b)};b=function(a,b){var c=a.makeAck,e=a.makeDeliveryReceipt,f=a.makeRetryReceipt,g=a.parsedMessage;a=babelHelpers.objectWithoutPropertiesLoose(a,[\"makeAck\",\"makeDeliveryReceipt\",\"makeRetryReceipt\",\"parsedMessage\"]);d(\"WALogger\").LOG(h());return d(\"MAWHandleGroupMsg\").handleGroupMsg(a,g,c,e,f,b)};g.handleIncomingIndividualMsg=a;g.handleGroupMessage=b}),98);\n__d(\"MAWHandleIndividualRetryReceipt\",[\"Promise\",\"WAProtocolQueue\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;a=function(a){var c=a.chat,e=a.makeAck,f=a.offline;a=a.retryReceipt;var g=a.keys,i=a.receiptSender,j=a.recipient,k=a.regId,l=a.retryCount,m=a.stanzaId;a=a.timestamp;i={category:null,externalId:m,from:{author:i,chat:c,deviceJid:i,type:\"device\"},keys:g,offline:f,recipient:j,regId:k,retryCount:l,timestamp:a};void d(\"WAProtocolQueue\").protocolQueue().write({consumerRetries:0,jid:c,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityLow,retry:i,stanzaId:m,type:\"retryReceipt\"});return(h||(h=b(\"Promise\"))).resolve(e())};g.handleIndividualRetryReceipt=a}),98);\n__d(\"WASmaxInPassiveModeActiveIQResponseSuccess\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"active\");if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"id\"]);if(!c.success)return c;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"id\",c.value);if(!b.success)return b;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"result\");if(!c.success)return c;b=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:c.value,from:b.value})}g.parseActiveIQResponseSuccess=a}),98);\n__d(\"WASmaxOutPassiveModeActiveIQRequest\",[\"WASmaxJsx\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(){var a=d(\"WASmaxJsx\").smax(\"iq\",{id:d(\"WAWap\").generateId(),type:\"set\",xmlns:\"passive\",to:d(\"WAWap\").S_WHATSAPP_NET},d(\"WASmaxJsx\").smax(\"active\",null));return a}g.makeActiveIQRequest=a}),98);\n__d(\"WASmaxPassiveModeActiveIQRPC\",[\"WAComms\",\"WASmaxInPassiveModeActiveIQResponseSuccess\",\"WASmaxOutPassiveModeActiveIQRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a){var c,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:c=d(\"WASmaxOutPassiveModeActiveIQRequest\").makeActiveIQRequest();g.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(c,a));case 3:e=g.sent;f=d(\"WASmaxInPassiveModeActiveIQResponseSuccess\").parseActiveIQResponseSuccess(e,c);if(!f.success){g.next=7;break}return g.abrupt(\"return\",{name:\"ActiveIQResponseSuccess\",value:f.value});case 7:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"ActiveIQ\",{Success:f}));case 8:case\"end\":return g.stop()}},null,this)}g.sendActiveIQRPC=a}),98);\n__d(\"WASmaxInPassiveModePassiveIQResponseSuccess\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"passive\");if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"id\"]);if(!c.success)return c;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"id\",c.value);if(!b.success)return b;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"result\");if(!c.success)return c;b=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:c.value,from:b.value})}g.parsePassiveIQResponseSuccess=a}),98);\n__d(\"WASmaxOutPassiveModePassiveIQRequest\",[\"WASmaxJsx\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(){var a=d(\"WASmaxJsx\").smax(\"iq\",{id:d(\"WAWap\").generateId(),type:\"set\",xmlns:\"passive\",to:d(\"WAWap\").S_WHATSAPP_NET},d(\"WASmaxJsx\").smax(\"passive\",null));return a}g.makePassiveIQRequest=a}),98);\n__d(\"WASmaxPassiveModePassiveIQRPC\",[\"WAComms\",\"WASmaxInPassiveModePassiveIQResponseSuccess\",\"WASmaxOutPassiveModePassiveIQRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a){var c,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:c=d(\"WASmaxOutPassiveModePassiveIQRequest\").makePassiveIQRequest();g.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(c,a));case 3:e=g.sent;f=d(\"WASmaxInPassiveModePassiveIQResponseSuccess\").parsePassiveIQResponseSuccess(e,c);if(!f.success){g.next=7;break}return g.abrupt(\"return\",{name:\"PassiveIQResponseSuccess\",value:f.value});case 7:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"PassiveIQ\",{Success:f}));case 8:case\"end\":return g.stop()}},null,this)}g.sendPassiveIQRPC=a}),98);\n__d(\"WASendPassiveModeProtocol\",[\"WALogger\",\"WASmaxPassiveModeActiveIQRPC\",\"WASmaxPassiveModePassiveIQRPC\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"sendPassiveModeIq: passive mode set to '\",\"'\"]);h=function(){return a};return a}function a(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:if(!(a===\"active\")){c.next=5;break}c.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WASmaxPassiveModeActiveIQRPC\").sendActiveIQRPC());case 3:c.next=7;break;case 5:c.next=7;return b(\"regeneratorRuntime\").awrap(d(\"WASmaxPassiveModePassiveIQRPC\").sendPassiveIQRPC());case 7:d(\"WALogger\").LOG(h(),a);case 8:case\"end\":return c.stop()}},null,this)}g.sendPassiveModeProtocol=a}),98);\n__d(\"WAPassiveMode\",[\"WACastStanzas\",\"WADanglingQueue\",\"WAGlobals\",\"WAPubSub\",\"WASendPassiveModeProtocol\",\"WATagsLogger\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Dangling queue: switch back to active mode\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Cannot process passive mode \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Dangling queue: \",\"\"]);j=function(){return a};return a}var k=d(\"WATagsLogger\").TAGS([\"passive-mode\"]),l=d(\"WAPubSub\").simplePubSub();function a(){var a=!1;d(\"WAGlobals\").getWaOneQueue().enqueue(function(){var c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WADanglingQueue\").isDanglingQueueEmpty());case 2:c=e.sent;k.LOG(j(),!c);if(!c){e.next=6;break}return e.abrupt(\"return\");case 6:a=!0;e.next=9;return b(\"regeneratorRuntime\").awrap(d(\"WACastStanzas\").castDanglingStanzas());case 9:l.publish({type:\"passive-mode-end\"});case 10:case\"end\":return e.stop()}},null,this)},{operationType:\"dangling_receipts\",flush:!1})[\"catch\"](function(a){l.publish({type:\"passive-mode-fail\"}),k.ERROR(i(),a)})[\"finally\"](function(){a&&(k.LOG(h()),void d(\"WASendPassiveModeProtocol\").sendPassiveModeProtocol(\"active\"))})}g.passiveModeNotifier=l;g.maybeProcessPassiveMode=a}),98);\n__d(\"WASmaxOutReceiptBizOriginalEnvelopeMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.originalEnvelopeElementValue;a=d(\"WASmaxJsx\").smax(\"biz\",null,d(\"WASmaxJsx\").smax(\"original_envelope\",null,a));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeBizOriginalEnvelopeMixin=a}),98);\n__d(\"WASmaxOutReceiptFromProxyAccountMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptActualFrom;a=d(\"WASmaxJsx\").smax(\"receipt\",{actual_from:d(\"WAWap\").JID(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeFromProxyAccountMixin=a}),98);\n__d(\"WASmaxOutReceiptNeedPrivacyTokenMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(){var a=d(\"WASmaxJsx\").smax(\"receipt\",{privacy_token:\"false\"});return a}function a(a){var b=h();return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeNeedPrivacyTokenMixin=a}),98);\n__d(\"WASmaxOutReceiptRecipientMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptRecipient;a=d(\"WASmaxJsx\").smax(\"receipt\",{recipient:d(\"WAWap\").USER_JID(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeRecipientMixin=a}),98);\n__d(\"WASmaxOutReceiptSenderAggregatedPublishMixin\",[\"WASmaxChildren\",\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.itemId;a=d(\"WASmaxJsx\").smax(\"item\",{id:d(\"WAWap\").STANZA_ID(a)});return a}function i(a){var b=a.itemArgs;a=a.receiptId;a=d(\"WASmaxJsx\").smax(\"receipt\",{id:d(\"WAWap\").STANZA_ID(a)},d(\"WASmaxJsx\").smax(\"list\",null,d(\"WASmaxChildren\").REPEATED_CHILD(h,b,0,255)));return a}function a(a,b){b=i(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.makeSenderAggregatedPublishListItem=h;g.mergeSenderAggregatedPublishMixin=a}),98);\n__d(\"WASmaxOutReceiptSingleMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptId;a=d(\"WASmaxJsx\").smax(\"receipt\",{id:d(\"WAWap\").STANZA_ID(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeSingleMixin=a}),98);\n__d(\"WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup\",[\"WASmaxMixinGroupExhaustiveError\",\"WASmaxOutReceiptSenderAggregatedPublishMixin\",\"WASmaxOutReceiptSingleMixin\"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.senderAggregatedPublish)return d(\"WASmaxOutReceiptSenderAggregatedPublishMixin\").mergeSenderAggregatedPublishMixin(a,b.senderAggregatedPublish);if(b.single)return d(\"WASmaxOutReceiptSingleMixin\").mergeSingleMixin(a,b.single);throw new(d(\"WASmaxMixinGroupExhaustiveError\").SmaxMixinGroupExhaustiveError)()}g.mergeSenderAggregatedPublishOrSingleMixinGroup=a}),98);\n__d(\"WASmaxOutReceiptBroadcastDeviceMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d(\"WASmaxJsx\").smax(\"receipt\",{to:d(\"WAWap\").BROADCAST_JID(b),participant:d(\"WAWap\").DEVICE_JID(a)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeBroadcastDeviceMixin=a}),98);\n__d(\"WASmaxOutReceiptGroupDeviceMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d(\"WASmaxJsx\").smax(\"receipt\",{to:d(\"WAWap\").GROUP_JID(b),participant:d(\"WAWap\").JID(a)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeGroupDeviceMixin=a}),98);\n__d(\"WASmaxOutReceiptIndividualDeviceMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d(\"WASmaxJsx\").smax(\"receipt\",{to:d(\"WAWap\").JID(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeIndividualDeviceMixin=a}),98);\n__d(\"WASmaxOutReceiptStatusDeviceMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d(\"WASmaxJsx\").smax(\"receipt\",{to:d(\"WAWap\").JID(b),participant:d(\"WAWap\").DEVICE_JID(a)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeStatusDeviceMixin=a}),98);\n__d(\"WASmaxOutReceiptDeviceMixins\",[\"WASmaxMixinGroupExhaustiveError\",\"WASmaxOutReceiptBroadcastDeviceMixin\",\"WASmaxOutReceiptGroupDeviceMixin\",\"WASmaxOutReceiptIndividualDeviceMixin\",\"WASmaxOutReceiptStatusDeviceMixin\"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.groupDevice)return d(\"WASmaxOutReceiptGroupDeviceMixin\").mergeGroupDeviceMixin(a,b.groupDevice);if(b.individualDevice)return d(\"WASmaxOutReceiptIndividualDeviceMixin\").mergeIndividualDeviceMixin(a,b.individualDevice);if(b.statusDevice)return d(\"WASmaxOutReceiptStatusDeviceMixin\").mergeStatusDeviceMixin(a,b.statusDevice);if(b.broadcastDevice)return d(\"WASmaxOutReceiptBroadcastDeviceMixin\").mergeBroadcastDeviceMixin(a,b.broadcastDevice);throw new(d(\"WASmaxMixinGroupExhaustiveError\").SmaxMixinGroupExhaustiveError)()}g.mergeDeviceMixins=a}),98);\n__d(\"WASmaxOutReceiptDeviceMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutReceiptDeviceMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.deviceMixinsArgs;a=d(\"WASmaxOutReceiptDeviceMixins\").mergeDeviceMixins(d(\"WASmaxJsx\").smax(\"receipt\",null),a);return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeDeviceMixin=a}),98);\n__d(\"WASmaxOutReceiptInteropDeviceMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d(\"WASmaxJsx\").smax(\"receipt\",{to:d(\"WAWap\").JID(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeInteropDeviceMixin=a}),98);\n__d(\"WASmaxOutReceiptInteropUserMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d(\"WASmaxJsx\").smax(\"receipt\",{to:d(\"WAWap\").JID(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeInteropUserMixin=a}),98);\n__d(\"WASmaxOutReceiptBroadcastUserMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d(\"WASmaxJsx\").smax(\"receipt\",{to:d(\"WAWap\").BROADCAST_JID(b),participant:d(\"WAWap\").USER_JID(a)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeBroadcastUserMixin=a}),98);\n__d(\"WASmaxOutReceiptGroupUserMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d(\"WASmaxJsx\").smax(\"receipt\",{to:d(\"WAWap\").GROUP_JID(b),participant:d(\"WAWap\").JID(a)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeGroupUserMixin=a}),98);\n__d(\"WASmaxOutReceiptIndividualUserMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.receiptTo;a=d(\"WASmaxJsx\").smax(\"receipt\",{to:d(\"WAWap\").JID(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeIndividualUserMixin=a}),98);\n__d(\"WASmaxOutReceiptStatusUserMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.receiptTo;a=a.receiptParticipant;b=d(\"WASmaxJsx\").smax(\"receipt\",{to:d(\"WAWap\").JID(b),participant:d(\"WAWap\").USER_JID(a)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeStatusUserMixin=a}),98);\n__d(\"WASmaxOutReceiptUserMixins\",[\"WASmaxMixinGroupExhaustiveError\",\"WASmaxOutReceiptBroadcastUserMixin\",\"WASmaxOutReceiptGroupUserMixin\",\"WASmaxOutReceiptIndividualUserMixin\",\"WASmaxOutReceiptStatusUserMixin\"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.groupUser)return d(\"WASmaxOutReceiptGroupUserMixin\").mergeGroupUserMixin(a,b.groupUser);if(b.individualUser)return d(\"WASmaxOutReceiptIndividualUserMixin\").mergeIndividualUserMixin(a,b.individualUser);if(b.statusUser)return d(\"WASmaxOutReceiptStatusUserMixin\").mergeStatusUserMixin(a,b.statusUser);if(b.broadcastUser)return d(\"WASmaxOutReceiptBroadcastUserMixin\").mergeBroadcastUserMixin(a,b.broadcastUser);throw new(d(\"WASmaxMixinGroupExhaustiveError\").SmaxMixinGroupExhaustiveError)()}g.mergeUserMixins=a}),98);\n__d(\"WASmaxOutReceiptUserMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutReceiptUserMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.userMixinsArgs;a=d(\"WASmaxOutReceiptUserMixins\").mergeUserMixins(d(\"WASmaxJsx\").smax(\"receipt\",null),a);return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeUserMixin=a}),98);\n__d(\"WASmaxOutReceiptUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup\",[\"WASmaxMixinGroupExhaustiveError\",\"WASmaxOutReceiptDeviceMixin\",\"WASmaxOutReceiptInteropDeviceMixin\",\"WASmaxOutReceiptInteropUserMixin\",\"WASmaxOutReceiptUserMixin\"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.user)return d(\"WASmaxOutReceiptUserMixin\").mergeUserMixin(a,b.user);if(b.device)return d(\"WASmaxOutReceiptDeviceMixin\").mergeDeviceMixin(a,b.device);if(b.interopUser)return d(\"WASmaxOutReceiptInteropUserMixin\").mergeInteropUserMixin(a,b.interopUser);if(b.interopDevice)return d(\"WASmaxOutReceiptInteropDeviceMixin\").mergeInteropDeviceMixin(a,b.interopDevice);throw new(d(\"WASmaxMixinGroupExhaustiveError\").SmaxMixinGroupExhaustiveError)()}g.mergeUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup=a}),98);\n__d(\"WASmaxOutReceiptPublishDeliveryRequest\",[\"WASmaxChildren\",\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutReceiptBizOriginalEnvelopeMixin\",\"WASmaxOutReceiptFromProxyAccountMixin\",\"WASmaxOutReceiptNeedPrivacyTokenMixin\",\"WASmaxOutReceiptRecipientMixin\",\"WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup\",\"WASmaxOutReceiptUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup\"],(function(a,b,c,d,e,f,g){function h(a){a=d(\"WASmaxOutReceiptBizOriginalEnvelopeMixin\").mergeBizOriginalEnvelopeMixin(d(\"WASmaxJsx\").smax(\"biz\",null),a);return a}function a(a){var b=a.bizArgs,c=a.recipientMixinArgs,e=a.fromProxyAccountMixinArgs,f=a.hasNeedPrivacyToken,g=a.userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs;a=a.senderAggregatedPublishOrSingleMixinGroupArgs;b=d(\"WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup\").mergeSenderAggregatedPublishOrSingleMixinGroup(d(\"WASmaxOutReceiptUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup\").mergeUserOrDeviceOrInteropUserOrInteropDeviceMixinGroup(d(\"WASmaxMixins\").optionalMerge(d(\"WASmaxOutReceiptNeedPrivacyTokenMixin\").mergeNeedPrivacyTokenMixin,d(\"WASmaxMixins\").optionalMerge(d(\"WASmaxOutReceiptFromProxyAccountMixin\").mergeFromProxyAccountMixin,d(\"WASmaxMixins\").optionalMerge(d(\"WASmaxOutReceiptRecipientMixin\").mergeRecipientMixin,d(\"WASmaxJsx\").smax(\"receipt\",null,d(\"WASmaxChildren\").OPTIONAL_CHILD(h,b)),c),e),f),g),a);return b}g.makePublishDeliveryRequestBiz=h;g.makePublishDeliveryRequest=a}),98);\n__d(\"WASmaxOutReceiptSenderTypeMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(){var a=d(\"WASmaxJsx\").smax(\"receipt\",{type:\"sender\"});return a}function a(a){var b=h();return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeSenderTypeMixin=a}),98);\n__d(\"WASmaxOutReceiptPublishSenderBroadcastDeviceSenderTypeMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutReceiptBroadcastDeviceMixin\",\"WASmaxOutReceiptSenderTypeMixin\"],(function(a,b,c,d,e,f,g){function h(a){a=d(\"WASmaxOutReceiptSenderTypeMixin\").mergeSenderTypeMixin(d(\"WASmaxOutReceiptBroadcastDeviceMixin\").mergeBroadcastDeviceMixin(d(\"WASmaxJsx\").smax(\"receipt\",null),a));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergePublishSenderBroadcastDeviceSenderTypeMixin=a}),98);\n__d(\"WASmaxOutReceiptPublishSenderGroupDeviceSenderTypeMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutReceiptGroupDeviceMixin\",\"WASmaxOutReceiptSenderTypeMixin\"],(function(a,b,c,d,e,f,g){function h(a){a=d(\"WASmaxOutReceiptSenderTypeMixin\").mergeSenderTypeMixin(d(\"WASmaxOutReceiptGroupDeviceMixin\").mergeGroupDeviceMixin(d(\"WASmaxJsx\").smax(\"receipt\",null),a));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergePublishSenderGroupDeviceSenderTypeMixin=a}),98);\n__d(\"WASmaxOutReceiptPublishSenderIndividualDeviceSenderTypeMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutReceiptIndividualDeviceMixin\",\"WASmaxOutReceiptRecipientMixin\",\"WASmaxOutReceiptSenderTypeMixin\"],(function(a,b,c,d,e,f,g){function h(a){a=d(\"WASmaxOutReceiptRecipientMixin\").mergeRecipientMixin(d(\"WASmaxOutReceiptSenderTypeMixin\").mergeSenderTypeMixin(d(\"WASmaxOutReceiptIndividualDeviceMixin\").mergeIndividualDeviceMixin(d(\"WASmaxJsx\").smax(\"receipt\",null),a)),a);return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergePublishSenderIndividualDeviceSenderTypeMixin=a}),98);\n__d(\"WASmaxOutReceiptPublishSenderStatusDeviceSenderTypeMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutReceiptSenderTypeMixin\",\"WASmaxOutReceiptStatusDeviceMixin\"],(function(a,b,c,d,e,f,g){function h(a){a=d(\"WASmaxOutReceiptSenderTypeMixin\").mergeSenderTypeMixin(d(\"WASmaxOutReceiptStatusDeviceMixin\").mergeStatusDeviceMixin(d(\"WASmaxJsx\").smax(\"receipt\",null),a));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergePublishSenderStatusDeviceSenderTypeMixin=a}),98);\n__d(\"WASmaxOutReceiptPublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup\",[\"WASmaxMixinGroupExhaustiveError\",\"WASmaxOutReceiptPublishSenderBroadcastDeviceSenderTypeMixin\",\"WASmaxOutReceiptPublishSenderGroupDeviceSenderTypeMixin\",\"WASmaxOutReceiptPublishSenderIndividualDeviceSenderTypeMixin\",\"WASmaxOutReceiptPublishSenderStatusDeviceSenderTypeMixin\"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.publishSenderGroupDeviceSenderType)return d(\"WASmaxOutReceiptPublishSenderGroupDeviceSenderTypeMixin\").mergePublishSenderGroupDeviceSenderTypeMixin(a,b.publishSenderGroupDeviceSenderType);if(b.publishSenderIndividualDeviceSenderType)return d(\"WASmaxOutReceiptPublishSenderIndividualDeviceSenderTypeMixin\").mergePublishSenderIndividualDeviceSenderTypeMixin(a,b.publishSenderIndividualDeviceSenderType);if(b.publishSenderStatusDeviceSenderType)return d(\"WASmaxOutReceiptPublishSenderStatusDeviceSenderTypeMixin\").mergePublishSenderStatusDeviceSenderTypeMixin(a,b.publishSenderStatusDeviceSenderType);if(b.publishSenderBroadcastDeviceSenderType)return d(\"WASmaxOutReceiptPublishSenderBroadcastDeviceSenderTypeMixin\").mergePublishSenderBroadcastDeviceSenderTypeMixin(a,b.publishSenderBroadcastDeviceSenderType);throw new(d(\"WASmaxMixinGroupExhaustiveError\").SmaxMixinGroupExhaustiveError)()}g.mergePublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup=a}),98);\n__d(\"WASmaxOutReceiptPublishSenderRequest\",[\"WASmaxJsx\",\"WASmaxOutReceiptPublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup\",\"WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup\"],(function(a,b,c,d,e,f,g){function a(a){var b=a.publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs;a=a.senderAggregatedPublishOrSingleMixinGroupArgs;b=d(\"WASmaxOutReceiptSenderAggregatedPublishOrSingleMixinGroup\").mergeSenderAggregatedPublishOrSingleMixinGroup(d(\"WASmaxOutReceiptPublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup\").mergePublishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroup(d(\"WASmaxJsx\").smax(\"receipt\",null),b),a);return b}g.makePublishSenderRequest=a}),98);\n__d(\"WASendAggregatedDeliveryReceiptProtocol\",[\"WAComms\",\"WAGlobals\",\"WAJids\",\"WASmaxOutReceiptPublishDeliveryRequest\",\"WASmaxOutReceiptPublishSenderRequest\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){a=h(a);d(\"WAComms\").castSmaxStanza(a)}function h(a){var b=a.from,c=a.chat,e=a.stanzaIdList;return d(\"WAJids\").switchOnMsgrChatJidType(c,{group:function(a){var c=d(\"WAJids\").extractUserJid(b);if(c===d(\"WAGlobals\").getMyUserJid())return k({stanzaIdList:e,from:b,chat:a});else return l({from:b,stanzaIdList:e,chat:a})},user:function(a){a=d(\"WAJids\").extractUserJid(b);if(a===d(\"WAGlobals\").getMyUserJid())return j({from:b,stanzaIdList:e});else return i({stanzaIdList:e,from:b})}})}function i(a){var b=a.from;a=a.stanzaIdList;b={device:{deviceMixinsArgs:{individualDevice:{receiptTo:b}}}};a={senderAggregatedPublish:{itemArgs:a.slice(1).map(function(a){return{itemId:a}}),receiptId:a[0]}};a={senderAggregatedPublishOrSingleMixinGroupArgs:a,userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs:b};return d(\"WASmaxOutReceiptPublishDeliveryRequest\").makePublishDeliveryRequest(a)}function j(a){var b=a.from;a=a.stanzaIdList;b={publishSenderIndividualDeviceSenderType:{receiptRecipient:d(\"WAJids\").extractUserJid(b),receiptTo:b}};a={senderAggregatedPublish:{itemArgs:a.slice(1).map(function(a){return{itemId:a}}),receiptId:a[0]}};a={senderAggregatedPublishOrSingleMixinGroupArgs:a,publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs:b};return d(\"WASmaxOutReceiptPublishSenderRequest\").makePublishSenderRequest(a)}function k(a){var b=a.stanzaIdList,c=a.chat;a=a.from;c={publishSenderGroupDeviceSenderType:{receiptTo:c,receiptParticipant:a}};a={senderAggregatedPublish:{itemArgs:b.slice(1).map(function(a){return{itemId:a}}),receiptId:b[0]}};b={publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs:c,senderAggregatedPublishOrSingleMixinGroupArgs:a};return d(\"WASmaxOutReceiptPublishSenderRequest\").makePublishSenderRequest(b)}function l(a){var b=a.stanzaIdList,c=a.chat;a=a.from;c={device:{deviceMixinsArgs:{groupDevice:{receiptTo:c,receiptParticipant:a}}}};a={senderAggregatedPublish:{itemArgs:b.slice(1).map(function(a){return{itemId:a}}),receiptId:b[0]}};b={senderAggregatedPublishOrSingleMixinGroupArgs:a,userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs:c};return d(\"WASmaxOutReceiptPublishDeliveryRequest\").makePublishDeliveryRequest(b)}g.sendAggregatedDeliveryReceipts=a;g.makeAggregatedDeliveryReceipts=h}),98);\n__d(\"WACastStanzas\",[\"Promise\",\"WAArrayUtils\",\"WAComms\",\"WADanglingQueue\",\"WALogger\",\"WAPassiveMode\",\"WASendAggregatedDeliveryReceiptProtocol\",\"WAStanzaUtils\",\"WAWap\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Dangling Queue: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to cast stanzas: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Passive: cast stanzas \",\", \",\"\"]);k=function(){return a};return a}function a(a){a.forEach(function(a){a!==\"NO_ACK\"&&a!==\"CLOSE_SOCKET\"&&d(\"WAComms\").castSmaxStanza(a)})}function l(a,b,c){var e;((e=d(\"WAComms\").getComms())==null?void 0:e.socketId)===b?d(\"WAComms\").castSmaxStanza(a):c==null?void 0:c.addAnnotations({string:{omitCastStanza:\"socketId\"}})}function c(a,b){d(\"WALogger\").LOG(k(),a.length,b);var c=[],e=[],f=[];a.forEach(function(a){var b=a.response,d=a.socketId;a=a.eventFlow;if(b===\"NO_ACK\"||b===\"CLOSE_SOCKET\")return;b;if(b.tag===\"ack\"){c.push({node:b,socketId:d,eventFlow:a});return}if(b.tag===\"receipt\"){if(b.attrs.type===\"retry\"){e.push({node:b,socketId:d,eventFlow:a});return}if(b.attrs.type===\"delivery\"||b.attrs.type===\"sender\"||b.attrs.type==null){f.push({node:b,socketId:d,eventFlow:a});return}}c.push({node:b,socketId:d,eventFlow:a})});c.forEach(function(a){var c=a.node,e=a.socketId;a=a.eventFlow;b.store&&d(\"WADanglingQueue\").danglingQueueWrite({node:d(\"WAWap\").encodeStanza(c)});b.send&&(l(c,e,a),a==null?void 0:a.endSuccess())});try{r(e,b),q(f,b)}catch(a){d(\"WALogger\").ERROR(j(),a)}finally{b.store&&d(\"WADanglingQueue\").danglingQueueFlush()[\"catch\"](function(a){d(\"WALogger\").ERROR(i(),a)})}}function m(a){return a.map(function(a){var b=a.node,c=a.socketId;a=a.eventFlow;return{stanzaId:d(\"WAStanzaUtils\").toStanzaId(\"\"+b.attrs.id),to:\"\"+b.attrs.to,participant:b.attrs.participant?\"\"+b.attrs.participant:\"\"+b.attrs.to,socketId:c,eventFlow:a}})}function n(a){var b=new Map();a.forEach(function(a){var c=b.get(a.socketId);c||(c=new Map(),b.set(a.socketId,c));var d=c.get(a.to);d||(d=new Map(),c.set(a.to,d));c=d.get(a.participant);c||(c=[],d.set(a.participant,c));c.push([a.stanzaId,a.eventFlow])});return b}var o=255;function p(a,b){a=n(m(a));a.forEach(function(a,c){a.forEach(function(a,e){a.forEach(function(a,f){var g=function(){if(i){if(j>=h.length)return\"break\";k=h[j++]}else{j=h.next();if(j.done)return\"break\";k=j.value}var a=k,g=[],m=[];a.forEach(function(a){var b=a[0];a=a[1];g.push(b);m.push(a)});a=d(\"WASendAggregatedDeliveryReceiptProtocol\").makeAggregatedDeliveryReceipts({from:f,chat:e,stanzaIdList:g});b.store&&d(\"WADanglingQueue\").danglingQueueWrite({node:d(\"WAWap\").encodeStanza(a)});b.send&&(l(a,c),m.forEach(function(a){var b;((b=d(\"WAComms\").getComms())==null?void 0:b.socketId)!==c&&(a==null?void 0:a.addAnnotations({string:{omitCastStanza:\"socketId\"}}));a==null?void 0:a.endSuccess()}))};for(var h=d(\"WAArrayUtils\").peekEvery(a,o),i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var k;a=g();if(a===\"break\")break}})})})}function q(a,b){if(a.length===0)return;if(a.length>1)return p(a,b);b.store&&d(\"WADanglingQueue\").danglingQueueWrite({node:d(\"WAWap\").encodeStanza(a[0].node)});b.send&&a.forEach(function(a){var b=a.node,c=a.socketId;a=a.eventFlow;l(b,c,a);a==null?void 0:a.endSuccess()})}function r(a,b){b.store&&a.forEach(function(a){a=a.node;d(\"WADanglingQueue\").danglingQueueWrite({node:d(\"WAWap\").encodeStanza(a)})}),b.send&&a.map(function(a){var b=a.node,c=a.socketId;a=a.eventFlow;l(b,c);a==null?void 0:a.endSuccess()})}function e(){var a;return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WADanglingQueue\").danglingQueueRead());case 2:a=c.sent;d(\"WAPassiveMode\").passiveModeNotifier.publish({type:\"passive-mode-start\",count:a.length});c.next=6;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).allSettled(a.map(function(a){var c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAWap\").decodeStanza(a.node,function(a){return(h||(h=b(\"Promise\"))).resolve(a)}));case 2:c=e.sent;return e.abrupt(\"return\",d(\"WAComms\").castSmaxStanza(c));case 4:case\"end\":return e.stop()}},null,this)})).then(function(){}));case 6:c.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WADanglingQueue\").danglingQueueClear());case 8:case\"end\":return c.stop()}},null,this)}g.castStanzas=a;g.castStanzasByCategories=c;g.castDanglingStanzas=e}),98);\n__d(\"MAWHandleLoginSuccess\",[\"MAWQplProxy\",\"Promise\",\"WAPassiveMode\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;a=function(a){d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(1056839232,\"112\"),\"wai_login\",{timestamp:a.timestamp*1e3});d(\"WAPassiveMode\").maybeProcessPassiveMode();return(h||(h=b(\"Promise\"))).resolve(\"NO_ACK\")};g.handleLoginSuccess=a}),98);\n__d(\"MAWHandlePeerAppdataReceipt\",[\"WAJids\",\"WAProtocolQueue\",\"WAProtocolQueueState\",\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to persist incoming stanza: \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"start...\"]);i=function(){return a};return a}var j=d(\"WATagsLogger\").TAGS([\"backend\",\"handlePeerAppdataReceipt\"]);a=function(a){var b=a.makeAck,c=a.receiptSender,e=a.receiptType;a=a.stanzaId;j.DEV(i());return d(\"WAProtocolQueueState\").persistStanza({consumerRetries:0,jid:d(\"WAJids\").extractUserJid(c),priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityLow,receipt:{externalIds:[a],from:c,offline:null,receiptType:\"appdata\",stanzaId:a,type:e},stanzaId:a,type:\"receipt\"})[\"catch\"](function(a){j.ERROR(h(),a);throw a}).then(function(){return b()})};g.handlePeerAppdataReceipt=a}),98);\n__d(\"MAWHandlePeerAppdataRetryReceipt\",[\"Promise\",\"WAJids\",\"WAProtocolQueue\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;a=function(a){var c=a.category,e=a.makeAck;a=a.retryReceipt;var f=a.keys,g=a.receiptSender,i=a.regId,j=a.retryCount,k=a.stanzaId;a=a.timestamp;c={category:c,externalId:k,from:{author:g,chat:d(\"WAJids\").extractUserJid(g),deviceJid:g,type:\"device\"},keys:f,offline:null,recipient:null,regId:i,retryCount:j,timestamp:a};void d(\"WAProtocolQueue\").protocolQueue().write({consumerRetries:0,jid:d(\"WAJids\").extractUserJid(g),priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityLow,retry:c,stanzaId:k,type:\"retryReceipt\"});return(h||(h=b(\"Promise\"))).resolve(e())};g.handlePeerAppdataRetryReceipt=a}),98);\n__d(\"MAWHandleSpam\",[\"MAWGlobals\",\"MAWJobDefinitions\",\"Promise\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleInfoBulletin unrecognized spam state\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleInfoBulletin spam messages have been drained\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleInfoBulletin continues to fetch spam messages\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleInfoBulletin receives spam marker\"]);l=function(){return a};return a}function a(a){d(\"WALogger\").LOG(l());a=a.spamState;if(a===\"continue\"){d(\"WALogger\").LOG(k());return d(\"MAWGlobals\").getJobManager().waitUntilPersisted(d(\"MAWJobDefinitions\").jobSerializers.getSpams()).then(function(){return\"NO_ACK\"})}else if(a===\"complete\"){d(\"WALogger\").LOG(j());return d(\"MAWGlobals\").getJobManager().waitUntilPersisted(d(\"MAWJobDefinitions\").jobSerializers.handleSpamMsg()).then(function(){return\"NO_ACK\"})}d(\"WALogger\").WARN(i());return(h||(h=b(\"Promise\"))).resolve(\"NO_ACK\")}g.handleSpam=a}),98);\n__d(\"MAWHandleEncryptedBackupsSecretsApi\",[\"MAWDbHistorySyncQRCodeData\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({historySyncQRCodeData:d(\"MAWTransactionMode\").READWRITE},\"handleEncryptedBackupsSecret\",function(a){return function(b){var c=b.backupId,e=b.epoch,f=b.mailboxRootKey,g=b.obliviousValidationToken,i=b.serverDataId,j=b.tempOcmfClientState;return a.historySyncQRCodeData.get(d(\"MAWDbHistorySyncQRCodeData\").qrCodeRowId).then(function(b){if(!(b==null?void 0:b.isQRScanned))return a.historySyncQRCodeData.put({isQRScanned:!0,rowId:d(\"MAWDbHistorySyncQRCodeData\").qrCodeRowId}).then(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"CallFinishAddDevice\",value:{backupId:c.toString(),epoch:h(e),mailboxRootKey:f,obliviousValidationToken:g,serverDataId:i.toString(),tempOcmfClientState:j}});return})[\"catch\"](function(b){return a.historySyncQRCodeData.put({isQRScanned:!1,rowId:d(\"MAWDbHistorySyncQRCodeData\").qrCodeRowId}).then(function(){})})})}});function h(a){return a.map(function(a){var b=a.anonId,c=a.id,d=a.rootKey;a=a.status;return{epoch_anon_id:b,epoch_id:c.toString(),epoch_root_key:d,epoch_status:a.toString()}})}g.handleEncryptedBackupsSecret=a}),98);\n__d(\"MAWSharedCOPLogger\",[\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"WATagsLogger\").TAGS([\"COP\"]);g[\"default\"]=a}),98);\n__d(\"MAWWriteMetaSyncsApi\",[\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"MAWWriteMetaSyncsTxns\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor({chunk:(a=d(\"MAWTransactionMode\")).READWRITE,deletedMessages:a.READWRITE,editMsgHistory:a.READWRITE,groupInfo:a.READWRITE,groupInvites:a.READWRITE,media:a.READWRITE,messages:a.READWRITE,participants:a.READWRITE,pendingStanzas:a.READWRITE,personalSenderKeyStatuses:a.READWRITE,reactions:a.READWRITE,receipts:a.READWRITE,senderKeySessions:a.READWRITE,threads:a.READWRITE,unrenderedMessages:a.READWRITE,xma:a.READWRITE},\"writeMetaSyncs\",function(a){return function(b){return d(\"MAWDexieTable\").dexieAll(b.map(function(b){return d(\"MAWWriteMetaSyncsTxns\").handleMetaSyncAction(a,b)})).then(function(){})}});g.writeMetaSyncs=b}),98);\n__d(\"WAAppData\",[],(function(a,b,c,d,e,f){\"use strict\";a=1;b=2;f.EPOCH_STATUS_OPEN=a;f.EPOCH_STATUS_CLOSE=b}),66);\n__d(\"WAMultiDevice.pb\",[\"WAProtoConst\"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={},i={},j={},k={},l={},m={};a.internalSpec={payload:[1,(d=d(\"WAProtoConst\")).TYPES.MESSAGE,c],metadata:[2,d.TYPES.MESSAGE,b]};b.internalSpec={};c.internalSpec={applicationData:[1,d.TYPES.MESSAGE,e],signal:[2,d.TYPES.MESSAGE,m],__oneofs__:{payload:[\"applicationData\",\"signal\"]}};e.internalSpec={appStateSyncKeyShare:[1,d.TYPES.MESSAGE,h],appStateSyncKeyRequest:[2,d.TYPES.MESSAGE,f],__oneofs__:{applicationData:[\"appStateSyncKeyShare\",\"appStateSyncKeyRequest\"]}};f.internalSpec={keyIds:[1,d.FLAGS.REPEATED|d.TYPES.MESSAGE,l]};h.internalSpec={keys:[1,d.FLAGS.REPEATED|d.TYPES.MESSAGE,i]};i.internalSpec={keyId:[1,d.TYPES.MESSAGE,l],keyData:[2,d.TYPES.MESSAGE,j]};j.internalSpec={keyData:[1,d.TYPES.BYTES],fingerprint:[2,d.TYPES.MESSAGE,k],timestamp:[3,d.TYPES.INT64]};k.internalSpec={rawId:[1,d.TYPES.UINT32],currentIndex:[2,d.TYPES.UINT32],deviceIndexes:[3,d.FLAGS.REPEATED|d.FLAGS.PACKED|d.TYPES.UINT32]};l.internalSpec={keyId:[1,d.TYPES.BYTES]};m.internalSpec={};g.MultiDeviceSpec=a;g.MultiDevice$MetadataSpec=b;g.MultiDevice$PayloadSpec=c;g.MultiDevice$ApplicationDataSpec=e;g.MultiDevice$ApplicationData$AppStateSyncKeyRequestMessageSpec=f;g.MultiDevice$ApplicationData$AppStateSyncKeyShareMessageSpec=h;g.MultiDevice$ApplicationData$AppStateSyncKeySpec=i;g.MultiDevice$ApplicationData$AppStateSyncKey$AppStateSyncKeyDataSpec=j;g.MultiDevice$ApplicationData$AppStateSyncKey$AppStateSyncKeyData$AppStateSyncKeyFingerprintSpec=k;g.MultiDevice$ApplicationData$AppStateSyncKeyIdSpec=l;g.MultiDevice$SignalSpec=m}),98);\n__d(\"WAParseAppStateSyncKeyRequest\",[\"WASyncdKeyTypes\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b=[];for(var a=a.keyIds,c=Array.isArray(a),e=0,a=c?a:a[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var f;if(c){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;f.keyId!=null&&b.push(d(\"WASyncdKeyTypes\").toSyncKeyId(f.keyId))}return{keyIds:b}}g.parseAppStateSyncKeyRequest=a}),98);\n__d(\"WAParseAppStateSyncKeyShare\",[\"WALogger\",\"WALongInt\",\"WASyncdKeyManagementUtils\",\"WASyncdKeyTypes\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Key missing keyId\"]);h=function(){return a};return a}function a(a){var b=[],c=[];for(var a=a.keys,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;f=i(f);f!=null&&(f.type===\"orphan\"?c.push(f.keyId):(f.type,b.push(f.keyData)))}return{keys:b,orphanKeys:c}}function i(a){var b,c,e,f,g,i;if(((b=a.keyId)==null?void 0:b.keyId)==null){d(\"WALogger\").WARN(h());return null}b=d(\"WASyncdKeyTypes\").toSyncKeyId(a.keyId.keyId);c=(c=a.keyData)==null?void 0:c.keyData;e=d(\"WALongInt\").maybeNumberOrThrowIfTooLarge((e=a.keyData)==null?void 0:e.timestamp);f=(f=a.keyData)==null?void 0:(f=f.fingerprint)==null?void 0:f.currentIndex;g=(g=a.keyData)==null?void 0:(g=g.fingerprint)==null?void 0:g.deviceIndexes;i=(i=a.keyData)==null?void 0:(i=i.fingerprint)==null?void 0:i.rawId;return a.keyData==null||c==null||e==null||f==null||g==null||i==null?{keyId:b,type:\"orphan\"}:{keyData:{fingerprint:{currentIndex:f,deviceIndexes:g,rawId:i},keyData:d(\"WASyncdKeyTypes\").toSyncKeyData(c),keyEpoch:d(\"WASyncdKeyManagementUtils\").getKeyEpoch(b),keyId:b,timestamp:e},type:\"key\"}}g.parseAppStateSyncKeyShare=a}),98);\n__d(\"WAConvertAppData\",[\"WAAppData\",\"WAArmadilloApplication.pb\",\"WAErr\",\"WAJids\",\"WALogger\",\"WAMultiDevice.pb\",\"WAParseAppStateSyncKeyRequest\",\"WAParseAppStateSyncKeyShare\",\"WAStanzaUtils\",\"WASyncdKeyTypes\",\"WATimeUtils\",\"decodeProtobuf\",\"encodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown appdata type: \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown appdata type: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown appdata type: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown appdata type: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown appdata type: \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"missing keys in EncryptedBackupsSecrets\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"status in EncryptedBackupsSecretsEpoch has invalid value\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"missing keys in EncryptedBackupsSecretsEpoch\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown appdata sync action type: \",\"\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown appdata sync action type: \",\"\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No participant in messageKey in message action when it is group chat and message is not fromMe: \",\"\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Missing messageKey in message action: \",\"\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown appdata sync action type: \",\"\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Missing chatId in chat action: \",\"\"]);u=function(){return a};return a}function v(a){a=d(\"WAJids\").interpretAndValidateJid(a);if(a.jidType===\"msgrUser\")return a.userJid;else if(a.jidType===\"group\")return a.groupJid;else{a.jidType;throw c(\"WAErr\")(\"Incorrect jid type: \"+a.jidType)}}function w(a){a=d(\"WAJids\").interpretAndValidateJid(a);if(a.jidType===\"msgrUser\")return a.userJid;else if(a.jidType===\"msgrDevice\")return d(\"WAJids\").extractUserJid(a.deviceJid);else{a.jidType;throw c(\"WAErr\")(\"Incorrect jid type: \"+a.jidType)}}function x(a){return a!=null?typeof a===\"number\"&&a>d(\"WATimeUtils\").MAX_INT?d(\"WATimeUtils\").castMilliSecondsToUnixTime(a):d(\"WATimeUtils\").castLongIntToUnixTime(a):void 0}function y(a){return a==null?void 0:{lastMessageTimestamp:x(a.lastMessageTimestamp),lastSystemMessageTimestamp:x(a.lastSystemMessageTimestamp),messages:a.messages==null?[]:a.messages.map(function(a){return{key:a.key==null?void 0:{fromMe:a.key.fromMe,id:a.key.id},ts:x(a.timestamp)}})}}function z(a,b){var c=a.chatId;if(c==null){d(\"WALogger\").WARN(u(),a);return null}if(a.chatArchive!=null){var e=a.chatArchive;e=y(e.messageRange);return{chatJid:v(c),messageRange:e,ts:b,type:\"chat_archive\"}}else if(a.chatDelete!=null){e=a.chatDelete;e=y(e.messageRange);return{chatJid:v(c),messageRange:e,ts:b,type:\"chat_delete\"}}else if(a.chatRead!=null){e=a.chatRead;var f=y(e.messageRange);return{chatJid:v(c),messageRange:f,read:e.read,ts:b,type:\"chat_read\"}}else{d(\"WALogger\").WARN(t(),a);return null}}function A(a){var b=a.key,c=b==null?void 0:b.remoteJid,e=b==null?void 0:b.id,f=b==null?void 0:b.fromMe;if(b==null||c==null||f==null||e==null){d(\"WALogger\").WARN(s(),a);return null}var g=v(c),h=d(\"WAJids\").interpretAsGroupJid(g)!=null;if(h&&!f){if((b==null?void 0:b.participant)==null){d(\"WALogger\").WARN(r(),a);return null}h=w(b.participant)}else f?h=d(\"WAJids\").AUTHOR_ME:h=w(c);b={author:h,chat:g,externalId:d(\"WAStanzaUtils\").toStanzaId(e)};if(a.messageDelete!=null)return{protocolMsgId:b,type:\"delete_for_me\"};else{d(\"WALogger\").WARN(q(),a);return null}}function B(a){var b=[];for(var c=0;c<a.length;c++){var e=a[c],f=x(e.actionTimestamp);if(e.chatAction!=null){f=z(e.chatAction,f);f!=null&&b.push({chatAction:f})}else if(e.messageAction!=null){f=A(e.messageAction);f!=null&&b.push({messageAction:f})}else d(\"WALogger\").WARN(p(),e)}return b}function C(a){var b=a.anonId,c=a.id,e=a.rootKey;a=a.status;if(a==null||c==null||b==null||e==null){d(\"WALogger\").WARN(o());return null}var f;if(a===d(\"WAArmadilloApplication.pb\").ARMADILLO_SIGNAL_ENCRYPTED_BACKUPS_SECRETS_EPOCH_EPOCH_STATUS.ES_OPEN)f=d(\"WAAppData\").EPOCH_STATUS_OPEN;else if(a===d(\"WAArmadilloApplication.pb\").ARMADILLO_SIGNAL_ENCRYPTED_BACKUPS_SECRETS_EPOCH_EPOCH_STATUS.ES_CLOSE)f=d(\"WAAppData\").EPOCH_STATUS_CLOSE;else{d(\"WALogger\").WARN(n());return null}return{anonId:b,id:c,rootKey:e,status:f}}function D(a){var b=a.backupId,c=a.epoch,e=a.mailboxRootKey,f=a.obliviousValidationToken,g=a.serverDataId;a=a.tempOcmfClientState;if(b==null||g==null||a==null||e==null||f==null){d(\"WALogger\").WARN(m());return null}return{backupId:b,epoch:c.map(C).reduce(function(a,b){if(b!=null)return a.concat([b]);else return a},[]),mailboxRootKey:e,obliviousValidationToken:f,serverDataId:g,tempOcmfClientState:a}}function E(a){var b;if(((b=a.applicationData)==null?void 0:(b=b.metadataSync)==null?void 0:b.actions)!=null){return{actions:B((b=a.applicationData)==null?void 0:(b=b.metadataSync)==null?void 0:b.actions),type:\"meta_sync\"}}else if(((b=a.signal)==null?void 0:b.encryptedBackupsSecrets)!=null){b=D(a.signal.encryptedBackupsSecrets);return b==null?null:{encryptedBackupsSecrets:b,type:\"backups_secrets\"}}else{d(\"WALogger\").WARN(l(),a);return null}}function F(a){var b;if(((b=a.applicationData)==null?void 0:b.appStateSyncKeyShare)!=null){return{syncKeyShare:d(\"WAParseAppStateSyncKeyShare\").parseAppStateSyncKeyShare((b=a.applicationData)==null?void 0:b.appStateSyncKeyShare),type:\"sync_key_share\"}}else if(((b=a.applicationData)==null?void 0:b.appStateSyncKeyRequest)!=null){return{syncKeyRequest:d(\"WAParseAppStateSyncKeyRequest\").parseAppStateSyncKeyRequest((b=a.applicationData)==null?void 0:b.appStateSyncKeyRequest),type:\"sync_key_request\"}}else{d(\"WALogger\").WARN(k(),a);return null}}function a(a){if(a.subprotocolType===\"armadillo\"){var b=d(\"decodeProtobuf\").decodeProtobufWithUnknowns(d(\"WAArmadilloApplication.pb\").ArmadilloSpec,a.payload);if(b.payload==null)throw c(\"WAErr\")(\"Appdata contains unparseable armadillo data.\");return E(b.payload)}else if(a.subprotocolType===\"multiDevice\"){b=d(\"decodeProtobuf\").decodeProtobufWithUnknowns(d(\"WAMultiDevice.pb\").MultiDeviceSpec,a.payload);if(b.payload==null)throw c(\"WAErr\")(\"Appdata contains unparseable armadillo data.\");return F(b.payload)}else throw c(\"WAErr\")(\"Appdata contains unexpected message application: \"+a.subprotocolType)}function G(a){return a==null?void 0:{lastMessageTimestamp:a.lastMessageTimestamp,lastSystemMessageTimestamp:a.lastSystemMessageTimestamp,messages:a.messages.map(function(a){return{key:a.key==null?void 0:{fromMe:a.key.fromMe,id:a.key.id},timestamp:a.ts}})}}function H(a){switch(a.type){case\"meta_sync\":return{payload:{applicationData:P(a)}};case\"backups_secrets\":return{payload:{signal:{encryptedBackupsSecrets:N(a.encryptedBackupsSecrets)}}};default:a.type;d(\"WALogger\").WARN(j(),a.type);return{}}}function I(a){return{keyId:d(\"WASyncdKeyTypes\").fromSyncKeyId(a)}}function J(a){return{keyData:{fingerprint:{currentIndex:a.fingerprint.currentIndex,deviceIndexes:a.fingerprint.deviceIndexes,rawId:a.fingerprint.rawId},keyData:d(\"WASyncdKeyTypes\").fromSyncKeyData(a.keyData),timestamp:a.timestamp},keyId:I(a.keyId)}}function K(a){var b=a.keys.map(J);a=a.orphanKeys==null?[]:a.orphanKeys.map(function(a){return{keyId:I(a)}});b.push.apply(b,a);return{keys:b}}function L(a){return{keyIds:a.keyIds.map(I)}}function M(a){switch(a.type){case\"sync_key_share\":return{payload:{applicationData:{appStateSyncKeyShare:K(a.syncKeyShare)}}};case\"sync_key_request\":return{payload:{applicationData:{appStateSyncKeyRequest:L(a.syncKeyRequest)}}};default:a.type;d(\"WALogger\").WARN(i(),a.type);return{}}}function b(a){var b;switch(a.type){case\"meta_sync\":case\"backups_secrets\":var c=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAArmadilloApplication.pb\").ArmadilloSpec,H(a));b={armadillo:{payload:c.readByteArray(),version:1}};break;case\"sync_key_share\":case\"sync_key_request\":c=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAMultiDevice.pb\").MultiDeviceSpec,M(a));b={multiDevice:{payload:c.readByteArray(),version:1}};break;default:a.type,d(\"WALogger\").WARN(h(),a.type),b={}}return{payload:{subProtocol:b}}}function N(a){return{backupId:a.backupId,epoch:a.epoch.map(O),mailboxRootKey:a.mailboxRootKey,obliviousValidationToken:a.obliviousValidationToken,serverDataId:a.serverDataId,tempOcmfClientState:a.tempOcmfClientState}}function O(a){var b;a.status===d(\"WAAppData\").EPOCH_STATUS_OPEN?b=d(\"WAArmadilloApplication.pb\").ARMADILLO_SIGNAL_ENCRYPTED_BACKUPS_SECRETS_EPOCH_EPOCH_STATUS.ES_OPEN:a.status===d(\"WAAppData\").EPOCH_STATUS_CLOSE&&(b=d(\"WAArmadilloApplication.pb\").ARMADILLO_SIGNAL_ENCRYPTED_BACKUPS_SECRETS_EPOCH_EPOCH_STATUS.ES_CLOSE);return{anonId:a.anonId,id:a.id,rootKey:a.rootKey,status:b}}function P(a){return{metadataSync:{actions:a.actions.map(function(a){if(a.chatAction)return{actionTimestamp:a.chatAction.ts,chatAction:Q(a.chatAction)};else return{messageAction:R(a.messageAction)}})}}}function Q(a){var b=G(a.messageRange),c=a.chatJid;switch(a.type){case\"chat_archive\":return{chatArchive:{archived:a.archived,messageRange:b},chatId:c};case\"chat_delete\":return{chatDelete:{messageRange:b},chatId:c};default:a.type;return{chatId:c,chatRead:{messageRange:b,read:a.read}}}}function R(a){if(a.type===\"delete_for_me\"){var b=a.protocolMsgId.chat,e=d(\"WAJids\").interpretAsGroupJid(b)!=null;return{key:{fromMe:d(\"WAJids\").isAuthorMe(a.protocolMsgId.author),id:a.protocolMsgId.externalId,participant:!d(\"WAJids\").isAuthorMe(a.protocolMsgId.author)&&e?a.protocolMsgId.author:void 0,remoteJid:b},messageDelete:{}}}else throw c(\"WAErr\")(\"No other available type\")}g.parseArmadilloAppData=E;g.parseMultiDeviceAppData=F;g.parseAppData=a;g.convertArmadilloAppData=H;g.convertMultiDeviceAppData=M;g.convertAppData=b}),98);\n__d(\"MAWProtocolQueueAppdata\",[\"MAWGlobals\",\"MAWHandleEncryptedBackupsSecretsApi\",\"MAWSharedCOPLogger\",\"MAWSharedOfflineResumeUINotifier\",\"MAWWriteMetaSyncsApi\",\"Promise\",\"WAConvertAppData\",\"WAMsgApplication.pb\",\"WAParseMessageApplication\",\"WAProtocolQueue\",\"WAResultOrError\",\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown appdata type: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Handle appdata: backup secret\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Handle appdata: meta sync\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Handle appdata\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Appdata contains unparseable message application.\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Parse Appdata application protocol\"]);n=function(){return a};return a}function a(a){var c=a.map(function(a){return o(a.appdata)});return(h||(h=b(\"Promise\"))).all(c.map(function(a){a=p(a);return a})).then(function(b){var c=[];b.map(function(b,d){b.success===!0&&c.push(a[d].stanzaQueueId)});d(\"MAWSharedOfflineResumeUINotifier\").offlineResumeUINotifier.addMAWEntity(c.length);d(\"MAWGlobals\").getOfflineResumeStats().addMAWEntity(c.length);return{followUpParams:void 0,toAck:c}})}function o(a){c(\"MAWSharedCOPLogger\").DEV(n());a=d(\"decodeProtobuf\").decodeProtobufWithUnknowns(d(\"WAMsgApplication.pb\").MessageApplicationSpec,d(\"WAProtocolQueue\").extractSubProtocolFromAppdataProtocol(a).payload);a=d(\"WAParseMessageApplication\").parseMessageApplication(a);if(a.type===\"error\"){c(\"MAWSharedCOPLogger\").ERROR(m());return}return d(\"WAConvertAppData\").parseAppData(a)}function p(a){c(\"MAWSharedCOPLogger\").LOG(l());if(a==null)return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult());switch(a.type){case\"meta_sync\":c(\"MAWSharedCOPLogger\").LOG(k());return d(\"MAWWriteMetaSyncsApi\").writeMetaSyncs(a.actions).then(function(){return d(\"WAResultOrError\").makeResult()});case\"backups_secrets\":c(\"MAWSharedCOPLogger\").LOG(j());return d(\"MAWHandleEncryptedBackupsSecretsApi\").handleEncryptedBackupsSecret(a.encryptedBackupsSecrets).then(function(){return d(\"WAResultOrError\").makeResult()});case\"sync_key_share\":return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult());case\"sync_key_request\":return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult());default:a.type;c(\"MAWSharedCOPLogger\").WARN(i(),a.type);return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult())}}g.handleAppdataStanzas=a}),98);\n__d(\"MAWIncomingMsgUtils\",[\"MAWEphemeralUtil\",\"MAWParseArmadilloProtocol\",\"MAWUnstoredContentToUnstoredDbContentUtils\",\"WAParseV3Protocol\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=d(\"WAParseV3Protocol\").createV3ProtocolParser(new Map([[\"armadillo\",d(\"MAWParseArmadilloProtocol\").parseArmadilloProtocol]]));function a(a){var b=a.author,e=a.chat,f=a.externalId,g=a.msg,i=a.reportingMeta;a=a.serverTs;if(g.version===\"v2\")throw c(\"err\")(\"Armadillo does not support protobuf v2\");if(g.type===\"ephemeral\"){var j=d(\"MAWEphemeralUtil\").buildUnstoredDbEphemeralSettingMsgWithoutContentPlaceholder(a);i!=null&&j.unstoredDbMsg!=null&&(j.unstoredDbMsg.reportingMeta=i);return j}j=babelHelpers[\"extends\"]({unstoredXMA:null},h(g,e,f,b,a));i!=null&&j.unstoredMsg!=null&&(j.unstoredMsg.reportingMeta=i);return d(\"MAWUnstoredContentToUnstoredDbContentUtils\").unstoredContentToUnstoredDbContent(j)}g.getDbMsg=a}),98);\n__d(\"MAWProtocolQueueDecodeProto\",[\"MAWIncomingMsgUtils\",\"WAStanzaRootTag\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a){switch(a.type){case\"IncomingMsg\":var b=a.folder,c=a.id,e=a.msg,f=a.reportingMeta;a=a.ts;var g=c.author,h=c.chat;c=c.externalId;return d(\"MAWIncomingMsgUtils\").getDbMsg({author:g,chat:h,externalId:c,folder:b,msg:e,reportingMeta:f,serverTs:a});case\"InvisibleMsg\":case\"IncomingCiphertextMsg\":default:return}}function a(a){a=a.map(function(a){switch(a.type){case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.MESSAGE:var b=a.items.map(function(a){if(a.message.decrypted.type===\"InstamadilloMsg\")return;var b=h(a.message.decrypted);return{decodedMsg:b!=null?b:void 0,stanza:a}}).filter(Boolean);return{items:b,type:a.type};default:return a}});return a}g.decodeMsg=h;g.decodeMessageProtoStanzas=a}),98);\n__d(\"MessageBackupDirectiveGenerator\",[\"I64\",\"MAWMsgType\",\"MessageBackupSupplementalKeyGenerator\",\"WAGlobals\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(a,b){return{actionType:2,originalMsgProtocolId:a,supplementalKey:d(\"MessageBackupSupplementalKeyGenerator\").createMessageSupplementalKey(d(\"MessageBackupSupplementalKeyGenerator\").SupplementalKeyPrefix.REACTION,(h||(h=d(\"I64\"))).to_string(b))}}function j(a,b){return{actionType:2,originalMsgProtocolId:a,supplementalKey:d(\"MessageBackupSupplementalKeyGenerator\").createMessageSupplementalKey(d(\"MessageBackupSupplementalKeyGenerator\").SupplementalKeyPrefix.EDIT,(h||(h=d(\"I64\"))).to_string(b))}}function k(a){if(d(\"WAJids\").isAuthorSystem(a.author))return null;if(a.reactToExternalId!=null)return{author:a.reactToAuthor,chat:a.threadJid,externalId:a.reactToExternalId};else if(a.originalMsgExternalId!=null)return{author:a.author,chat:a.threadJid,externalId:a.originalMsgExternalId};else if(a.revokedExternalId!=null)return{author:a.author,chat:a.threadJid,externalId:a.revokedExternalId};return a.externalId==null?null:{author:a.author,chat:a.threadJid,externalId:a.externalId}}function a(a){var b=(h||(h=d(\"I64\"))).of_string(d(\"WAJids\").authorToUserId(a.author,d(\"WAJids\").extractUserId(d(\"WAGlobals\").getMyUserJid()))),c=k(a);if(c==null)return null;if(a.originalMsgExternalId!=null)return j(c,b);return a.reactToExternalId!=null?i(c,b):l(c,b,a.type)}function l(a,b,c){switch(c){case d(\"MAWMsgType\").MSG_TYPE.TEXT:case d(\"MAWMsgType\").MSG_TYPE.IMAGE:case d(\"MAWMsgType\").MSG_TYPE.PTT:case d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE:case d(\"MAWMsgType\").MSG_TYPE.VIDEO:case d(\"MAWMsgType\").MSG_TYPE.GIF:case d(\"MAWMsgType\").MSG_TYPE.STICKER:return{actionType:1,originalMsgProtocolId:a};case d(\"MAWMsgType\").MSG_TYPE.REACTION:return i(a,b);case d(\"MAWMsgType\").MSG_TYPE.EDIT_ACTION:return j(a,b);case d(\"MAWMsgType\").MSG_TYPE.REVOKED:return{actionType:4,originalMsgProtocolId:a};case d(\"MAWMsgType\").MSG_TYPE.DELETE_FOR_ME:return{actionType:3,originalMsgProtocolId:a};default:return{actionType:0,originalMsgProtocolId:a}}}g.createMessageBackupDirectiveFromDbMsg=a;g.createMessageBackupDirective=l}),98);\n__d(\"MAWEbUploadFollowUp\",[\"I64\",\"MAWEBUploadTrackingUtils\",\"MAWMsgType\",\"MAWProtocolQueueFollowUps\",\"MAWSharedEbUploadQueue\",\"MessageBackupDirectiveGenerator\",\"Promise\",\"WAAsMessageApplication\",\"WAGlobals\",\"WAJids\",\"WALogger\",\"WAMsgApplication.pb\",\"asyncToGeneratorRuntime\",\"encodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] no result or failed for incoming stanza \",\"\"]);j=function(){return a};return a}function k(a){var b,c=a.stanza.message.decrypted.id;if(((b=a.decodedMsg)==null?void 0:b.unstoredDbReaction)!=null)return babelHelpers[\"extends\"]({},c,{author:a.decodedMsg.unstoredDbReaction.reactToAuthor,externalId:a.decodedMsg.unstoredDbReaction.reactToExternalId});else if(((b=a.decodedMsg)==null?void 0:b.unstoredDbEditActionMsg)!=null){return babelHelpers[\"extends\"]({},c,{externalId:(b=a.decodedMsg)==null?void 0:(a=b.unstoredDbEditActionMsg)==null?void 0:a.originalMsgExternalId})}return c}function a(a,b){return l.apply(this,arguments)}function l(){l=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,c){if(!d(\"WAGlobals\").getConfig().useEbUploadQueue())return;d(\"MAWProtocolQueueFollowUps\").bumpFollowUpEntity(\"eb_upload_follow_up\");a=a.map(function(a){var b,e=a.stanza.message.decrypted.id,f=c.get(a.stanza.message.decrypted.id),g=m(a.decodedMsg);if(f==null||!f.success||g==null){d(\"WALogger\").ERROR(j(),a.stanza.message.decrypted.id);return null}f=k(a);if(f==null)return null;var h=a.stanza.message.decrypted.msg;if((h==null?void 0:h.version)!==\"v3\"||h.type!==\"subprotocol\")return null;h={metadata:h.metadata,payload:{subProtocol:(b={},b[h.subprotocolType]={payload:h.subprotocol.buffer,version:1},b)}};b={bytes:d(\"WAAsMessageApplication\").castToMessageApplicationBytes(d(\"encodeProtobuf\").encodeProtobuf(d(\"WAMsgApplication.pb\").MessageApplicationSpec,h).readByteArray()),version:\"v3\"};h=a.stanza.message.details.reportingMeta;d(\"MAWEBUploadTrackingUtils\").maybeStartTrackingForUploadQueue(e,\"receive\",0,g);return{backupDirective:d(\"MessageBackupDirectiveGenerator\").createMessageBackupDirective(f,(i||(i=d(\"I64\"))).of_string(d(\"WAJids\").authorToUserId(e.author,d(\"WAJids\").extractUserId(d(\"WAGlobals\").getMyUserJid()))),g),messageApplication:b.bytes,msgId:e,originalMsgProtocolId:f,reportingMeta:h,senderId:i.of_string(d(\"WAJids\").authorToUserId(e.author,d(\"WAJids\").extractUserId(d(\"WAGlobals\").getMyUserJid()))),serverTs:a.stanza.message.details.ts}});a=(yield (h||(h=b(\"Promise\"))).all(a)).filter(Boolean);return a.length>0?d(\"MAWSharedEbUploadQueue\").putMsgsToEbUpload(a):(h||(h=b(\"Promise\"))).resolve()});return l.apply(this,arguments)}function m(a){if(a==null)return null;if(a.unstoredDbReaction!=null)return d(\"MAWMsgType\").MSG_TYPE.REACTION;else if(a.unstoredDbEditActionMsg!=null)return d(\"MAWMsgType\").MSG_TYPE.EDIT_ACTION;else if(a.unstoredDbMedia!=null)return a.unstoredDbMedia.mediaType;else if(a.unstoredXMA!=null)return d(\"MAWMsgType\").MSG_TYPE.XMA;else if(a.unstoredDbMsg!=null)return a.unstoredDbMsg.type;else return null}g.ebUploadFollowUp=a}),98);\n__d(\"MAWProtocolQueueFollowUps\",[\"MAWEBSwitch\",\"MAWEbUploadFollowUp\",\"MAWODSProxy\",\"MAWProtocolQueueGroupNotification\",\"MAWProtocolQueueMsg\",\"MAWProtocolQueueNotification\",\"Promise\",\"WAMsgMap\",\"WAOdsEnums\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=function(a){var b={groupRecoveries:[],incomingMsgResults:new(d(\"WAMsgMap\").MsgMap)(),incomingMsgs:[],retryNotifications:[]};a.forEach(function(a){a=a.followUpParams;if(!a)return;a.incomingMsgResults&&a.incomingMsgResults.entries().forEach(function(a){var c=a[0];a=a[1];b.incomingMsgResults.set(c,a)});a.incomingMsgs&&a.incomingMsgs.forEach(function(a){b.incomingMsgs.push(a),a.receiveFlow.addPoint(\"consumer_handle_message_stanza_end\")});if(a.retryNotifications){var c;(c=b.retryNotifications).push.apply(c,a.retryNotifications)}if(a.groupRecoveries){(c=b.groupRecoveries).push.apply(c,a.groupRecoveries)}});return b};a=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){j(\"base\");a=i(a);var e=a.groupRecoveries,f=a.incomingMsgResults,g=a.incomingMsgs;a=a.retryNotifications;var k=function(){return c(\"MAWEBSwitch\").isEnabled()?d(\"MAWEbUploadFollowUp\").ebUploadFollowUp(g,f):(h||(h=b(\"Promise\"))).resolve()};yield (h||(h=b(\"Promise\"))).all([d(\"MAWProtocolQueueGroupNotification\").groupRecovery(e)].concat(a.map(function(a){a=a.notification;return d(\"MAWProtocolQueueNotification\").mediaRetryNotification(a)}),[k(),d(\"MAWProtocolQueueMsg\").handleMessagePersistResult(g,f)]))});return function(b){return a.apply(this,arguments)}}();var j=function(a){d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.PROTOCOL_QUEUE,key:\"follow-ups-\"+a})};g.buildFollowUpParams=i;g.processFollowUps=a;g.bumpFollowUpEntity=j}),98);\n__d(\"WAMessageAuthor\",[\"WAGlobals\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){var c=a.chat,e=d(\"WAJids\").extractUserJid(a.author),f=d(\"WAJids\").extractDeviceId(a.author);d(\"WAGlobals\").isPeerDevice(a.author)&&(e=\"@me\",b!=null&&(c=b));return{chat:c,author:e,deviceId:f}}g.extractChatAuthor=a}),98);\n__d(\"WAGroupParserUtils\",[\"WAErr\",\"WAGroupInviteUtils\",\"WAJids\",\"WALogger\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"received unknown participant error code: \",\"\"]);h=function(){return a};return a}var i={superadmin:\"superadmin\",admin:\"admin\",participant:\"participant\",nonparticipant:\"nonparticipant\"};function j(a){if(!a.hasAttr(\"error\"))throw c(\"WAErr\")(\"Expected participant node to have error attr\");var b=a.attrInt(\"error\"),e=a.attrUserJid(\"jid\");switch(b){case 401:return{errorCode:b,text:\"not-authorized\",user:e};case 403:a=a.child(\"add_request\");return{errorCode:b,text:\"request-code\",code:d(\"WAGroupInviteUtils\").toInviteCode(a.attrString(\"code\")),expiration:a.attrTime(\"expiration\"),user:e};case 404:return{errorCode:b,text:\"not-found\",user:e};case 406:return{errorCode:b,text:\"enterprise-not-allowed\",user:e};case 408:return{errorCode:b,text:\"temporarily-blocked\",user:e};case 409:return{errorCode:b,text:\"conflict\",user:e};case 500:return{errorCode:b,text:\"resource-constraint\",user:e};default:d(\"WALogger\").ERROR(h(),b);return{errorCode:-1,text:\"unknown\",user:e}}}function k(a,b){a.assertTag(\"participant\");var c=\"participant\";switch(b){case\"add\":case\"demote\":c=\"participant\";break;case\"promote\":c=\"admin\";break;case\"remove\":c=\"nonparticipant\";break}b=a.attrUserJid(\"jid\");if(a.hasAttr(\"error\")){var e=j(a);return d(\"WAResultOrError\").makeError(e)}else{e=a.attrEnumOrDefault(\"type\",i,c);c=a.maybeAttrString(\"addressable\")!==\"false\";return d(\"WAResultOrError\").makeResult({user:b,type:e,addressable:c})}}function a(a){a.assertTag(\"group\");var b,c=a.attrString(\"id\");c.includes(\"@\")?b=a.attrGroupJid(\"id\"):b=d(\"WAJids\").toGroupJid(c);return{jid:b,creator:a.maybeAttrUserJid(\"creator\")||void 0,creationTs:a.attrTime(\"creation\"),subject:{content:a.maybeAttrString(\"subject\")||void 0,user:a.maybeAttrUserJid(\"s_o\")||void 0,ts:a.hasAttr(\"s_t\")?a.attrTime(\"s_t\"):void 0},description:m(a)||void 0,participantVersion:a.maybeAttrString(\"p_v_id\")||void 0,participants:a.mapChildrenWithTag(\"participant\",function(a){return k(a)}),memberAddMode:l(a)||void 0}}function l(a){if(a.hasChild(\"member_add_mode\")){a=a.child(\"member_add_mode\");if(a.hasContent()){a=a.contentString();if(a===\"admin_add\"||a===\"all_member_add\")return a}}return null}function m(a){if(a.hasChild(\"description\")){a=a.child(\"description\");if(a.hasChild(\"body\")){var b=a.child(\"body\");if(b.hasContent())return{id:a.attrString(\"id\"),ts:a.attrTime(\"t\"),content:b.contentString(),user:b.maybeAttrUserJid(\"participant\")||void 0}}}return null}g.PARTICIPANT_TYPES=i;g.parseProtocolGroupParticipantNode=k;g.parseGroupNode=a}),98);\n__d(\"WAWaterFlow\",[\"$InternalEnum\",\"WAErr\",\"WAMapWithDefault\",\"WAPREMetrics\",\"WATagsLogger\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\" -> Done. Success: false\\nTime taken: \",\" sec;\\n\",\"\\n\",\"\\n\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\" -> Done. Success: true\\nTime taken: \",\" sec;\\n\",\"\\n\",\"\\n\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\" -> in progress.\\nTime passed: \",\" sec;\\n\",\"\\n\",\"\\n\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Step should be a enum type\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" -> Done.;\\nTime taken: \",\" sec;\\nTime from start: \",\" sec;\\n\",\"\\n\",\"\\n\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Step should be a enum type\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No start point was found for step: \",\".\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" -> Start.\\n\",\"\\n\",\"\\n\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Step should be a enum type\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\" -> Start.\\n    \",\"\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\" -> Start.\\n\",\"\\n\"]);r=function(){return a};return a}var s=d(\"WATagsLogger\").TAGS([\"WAWaterflow\"]),t=b(\"$InternalEnum\").Mirrored([\"INIT\",\"ON_GOING\",\"COMPLETED\"]),u=function(){function a(a,b){this.$1=t.INIT,this.$7=[],this.$9=new(d(\"WAMapWithDefault\").MapWithDefault)(function(){return[]}),this.$5=s.TAGS([a]),this.$8=b,this.$3={},this.$4=new Set(),this.$6=d(\"WATimeUtils\").performanceAbsoluteNow(),this.$5.LOG(r(),v(this.$3))}var b=a.prototype;b.$10=function(){var a=this,b={\"int\":{},bool:{},string:{},string_array:{}};this.$4.forEach(function(c){var d=a.$3[c];Array.isArray(d)&&(b.string_array[c]=d);typeof d===\"boolean\"&&(b.bool[c]=d);typeof d===\"number\"&&(b[\"int\"][c]=d);typeof d===\"string\"&&(b.string[c]=d)});return b};b.$11=function(a){if(a==null)return;for(var b in a){var c=a[b];c!==this.$3[b]&&(this.$4.add(b),this.$3[b]=c)}};b.$12=function(a,b){this.$11(a);a=this.$10();this.$4.clear();this.$5.LOG(q(),v(this.$3));this.$1=t.ON_GOING;if(this.$8==null)return this;this.$2=d(\"WAPREMetrics\").startMetric(this.$8,a,b);return this};b.startMetric=function(a){return this.$12(a)};b.reStartMetric=function(a,b){return this.$12(b,a)};b.startPoint=function(a,b){var e;if(typeof a!==\"string\"){this.$5.ERROR(p());throw c(\"WAErr\")(\"Step should be a enum type\")}this.$11(b);b=this.$10();(e=this.$2)==null?void 0:e.addPoint(a+\"_start\",b);this.$4.clear();e={step:a,from:d(\"WATimeUtils\").performanceAbsoluteNow()};this.$7.push(e);this.$9.get(a).push(e);this.$5.LOG(o(),a,w(this.$7,this.$6),v(this.$3))};b.endPoint=function(a,b){var e,f=d(\"WATimeUtils\").performanceAbsoluteNow(),g=this.$9.get(a).pop();g==null?this.$5.WARN(n(),a):g.to=f;if(typeof a!==\"string\"){this.$5.ERROR(m());throw c(\"WAErr\")(\"Step should be a enum type\")}this.$11(b);b=this.$10();(e=this.$2)==null?void 0:e.addPoint(a+\"_end\",b);this.$4.clear();this.$5.LOG(l(),a,x(g!=null?f-g.from:0),x(f-this.$6),w(this.$7,this.$6),v(this.$3))};b.isOnGoing=function(){return this.$1===t.ON_GOING};b.isCompleted=function(){return this.$1===t.COMPLETED};b.annotate=function(a){this.$11(a)};b.reAnnotate=function(a){this.$11(a(this.$3))};b.getAnnotations=function(){return this.$3};b.annotateImmediately=function(a){var b;this.$11(a);a=this.$10();(b=this.$2)==null?void 0:b.addAnnotations(a);this.$4.clear()};b.addPoint=function(a,b){var d;if(typeof a!==\"string\"){this.$5.ERROR(k());throw c(\"WAErr\")(\"Step should be a enum type\")}this.$11(b);b=this.$10();(d=this.$2)==null?void 0:d.addPoint(a,b);this.$4.clear()};b.getStartTime=function(){return this.$6};b.log=function(){this.$5.LOG(j(),(d(\"WATimeUtils\").performanceAbsoluteNow()-this.$6)\/1e3,w(this.$7,this.$6),v(this.$3))};b.endSuccess=function(a){var b;this.$11(a);a=this.$10();(b=this.$2)==null?void 0:b.endSuccess(a);this.$4.clear();this.$5.LOG(i(),(d(\"WATimeUtils\").performanceAbsoluteNow()-this.$6)\/1e3,w(this.$7,this.$6),v(this.$3));this.$1=t.COMPLETED};b.endFail=function(a,b){var c;this.$11(b);b=this.$10();(c=this.$2)==null?void 0:c.endFail(a,b);this.$4.clear();this.$5.LOG(h(),(d(\"WATimeUtils\").performanceAbsoluteNow()-this.$6)\/1e3,w(this.$7,this.$6),v(this.$3));this.$1=t.COMPLETED};return a}();function a(a){if(a==null)return{};var b={bool:{},\"int\":{},string:{},string_array:{}};for(var c in a)Array.isArray(a[c])&&(b.string_array[c]=a[c]),typeof a[c]===\"number\"&&(b[\"int\"][c]=a[c]),typeof a[c]===\"boolean\"&&(b.bool[c]=a[c]),typeof a[c]===\"string\"&&(b.string[c]=a[c]);return b}function v(a){return Object.entries(a).map(function(a){var b=a[0];a=a[1];return b+\": \"+String(a)}).join(\"\\n\")}function w(a,b){return\"\\n  \"+a.map(function(a){var c=a.from,e=a.to;a=a.step;return typeof a===\"string\"?a+\" => Started after: \"+x(c-b)+\" sec; \"+(e!=null?\"Completed after: \"+x(e-c)+\" sec\":\"in progress: \"+x(d(\"WATimeUtils\").performanceAbsoluteNow()-c)):\"Step is not string\"}).join(\"\\n\")+\";\\n\"}function x(a){return a\/1e3+\" sec\"}function e(a,b){return new u(a,b)}g.WAWaterflow=u;g.convertToPREAnnotation=a;g.makeWaterflow=e}),98);\n__d(\"WAQueryGroup\",[\"$InternalEnum\",\"WADeprecatedSendIq\",\"WADeprecatedWapParser\",\"WAGroupParserUtils\",\"WAPREList\",\"WAPREMetrics\",\"WAResultOrError\",\"WAWap\",\"WAWaterFlow\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=new(c(\"WADeprecatedWapParser\"))(\"queryAllGroupsResponse\",function(a){a.assertTag(\"iq\");return{groups:a.child(\"groups\").mapChildren(d(\"WAGroupParserUtils\").parseGroupNode)}});function a(){var a,c,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:a=d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.QUERY_GROUPS);c=d(\"WAWap\").wap(\"iq\",{id:d(\"WAWap\").generateId(),to:d(\"WAWap\").G_US,type:\"get\",xmlns:\"w:g2\"},d(\"WAWap\").wap(\"participating\",null,d(\"WAWap\").wap(\"participants\",null),d(\"WAWap\").wap(\"description\",null)));f.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WADeprecatedSendIq\").deprecatedSendIq(c,h));case 4:e=f.sent;if(e.success){f.next=8;break}a.endFail(\"query_groups_fail\");return f.abrupt(\"return\",d(\"WAResultOrError\").makeError(e));case 8:a.endSuccess();return f.abrupt(\"return\",d(\"WAResultOrError\").makeResult(e.result));case 10:case\"end\":return f.stop()}},null,this)}var i=new(c(\"WADeprecatedWapParser\"))(\"queryAllGroupsResponse\",function(a){a.assertTag(\"iq\");return{group:d(\"WAGroupParserUtils\").parseGroupNode(a.child(\"group\"))}}),j=b(\"$InternalEnum\").Mirrored([\"IQ_REQUEST\"]);function e(a,c){var e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:e=d(\"WAWaterFlow\").makeWaterflow(\"query-group\",d(\"WAPREList\").PRE_METRIC.QUERY_GROUP).startMetric();e.addPoint(j.IQ_REQUEST);g.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WADeprecatedSendIq\").deprecatedSendIq(d(\"WAWap\").wap(\"iq\",{id:d(\"WAWap\").generateId(),to:d(\"WAWap\").GROUP_JID(a),type:\"get\",xmlns:\"w:g2\"},d(\"WAWap\").wap(\"query\",{request:c!=null?d(\"WAWap\").CUSTOM_STRING(c):d(\"WAWap\").DROP_ATTR})),i));case 4:f=g.sent;if(f.success){g.next=8;break}e.endFail(\"Fail-\"+f.errorCode);return g.abrupt(\"return\",d(\"WAResultOrError\").makeError(f));case 8:e.endSuccess();return g.abrupt(\"return\",d(\"WAResultOrError\").makeResult(f.result.group));case 10:case\"end\":return g.stop()}},null,this)}g.queryAllGroups=a;g.parseQueryGroupResponse=i;g.queryGroup=e}),98);\n__d(\"WAQueryGroupInvite\",[\"WADeprecatedSendIq\",\"WAPREList\",\"WAPREMetrics\",\"WAQueryGroup\",\"WAResultOrError\",\"WAWap\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,c,e,f){var g,h,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:g=d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.QUERY_GROUP);h=d(\"WAWap\").wap(\"iq\",{id:d(\"WAWap\").generateId(),to:d(\"WAWap\").GROUP_JID(a),type:\"get\",xmlns:\"w:g2\"},d(\"WAWap\").wap(\"query\",null,d(\"WAWap\").wap(\"add_request\",{admin:d(\"WAWap\").USER_JID(f),code:d(\"WAWap\").CUSTOM_STRING(c),expiration:d(\"WAWap\").CUSTOM_STRING(e.toString(10))})));j.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WADeprecatedSendIq\").deprecatedSendIq(h,d(\"WAQueryGroup\").parseQueryGroupResponse));case 4:i=j.sent;if(i.success){j.next=8;break}g.endFail(\"query_group_for_invitee_fail\");return j.abrupt(\"return\",d(\"WAResultOrError\").makeError(i));case 8:g.endSuccess();return j.abrupt(\"return\",d(\"WAResultOrError\").makeResult(i.result.group));case 10:case\"end\":return j.stop()}},null,this)}g.queryGroupInvite=a}),98);\n__d(\"MAWMessageHandlingFollowUps\",[\"MAWGlobals\",\"MAWIncomingMsg\",\"MAWJobDefinitions\",\"MAWLoggerUtils\",\"Promise\",\"WAGlobals\",\"WAJids\",\"WAMessageAuthor\",\"WAQueryGroup\",\"WAQueryGroupInvite\",\"WATimeUtils\",\"asyncToGeneratorRuntime\",\"gkx\",\"promiseDone\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Cannot request a group invite for a message: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Cannot request a group for a message: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Scheduling job for \",\", plaintextHash: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"processSingleDBResult - externalId=\",\" - plaintextFollowUp - plaintextHash=\",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleMsg: detected out-of-sync ephemeral setting for \",\", sending EPHEMERAL_SYNC_RESPONSE\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"processSingleDBResult - externalId=\",\" - start - type=\",\"\"]);n=function(){return a};return a}var o=function(){return c(\"gkx\")(\"120\")},p=d(\"MAWIncomingMsg\").logger.TAGS([\"MAWMessageHandlingFollowUps\"]);function q(a){a=a.getFlowDetails();return new Map([[a.name,a.instanceKey]])}function a(a){a.receiveFlow.addPoint(\"consumer_process_db_result\");var b=a.db,e=a.decrypted,f=a.details,g=f.from;f=f.recipient;p.LOG(n(),a.details.externalId,a.details.type);g=d(\"WAMessageAuthor\").extractChatAuthor(g,f);if((((f=b.error)==null?void 0:f.type)===\"no_thread\"||((f=b.error)==null?void 0:f.type)===\"group_invite\")&&(e.type===\"IncomingMsg\"||e.type===\"IncomingCiphertextMsg\")){var h;f=b.error;a.receiveFlow.endFail(\"end_with_db_error_\"+f.type);if(f.type===\"group_invite\"&&(e==null?void 0:(h=e.msg)==null?void 0:h.type)!==\"ephemeral\")return babelHelpers[\"extends\"]({},a,{queryGroupInvite:{folder:f.folder,groupInvite:{inviteCode:f.inviteCode,inviteExpireTs:f.inviteExpireTs,inviterJid:f.inviterJid},groupJid:f.groupJid,type:\"queryGroupForInvitee\"}});else{h=d(\"WAJids\").interpretAsGroupJid(g.chat);if(h!=null&&(e==null?void 0:(f=e.msg)==null?void 0:f.type)!==\"ephemeral\")return babelHelpers[\"extends\"]({},a,{queryGroup:{groupJid:h,type:\"queryGroup\"}})}}if(b.success){f=[];h=new Set();var i=null;if(b.value!=null){var j=b.value,k=j.msgType,o=j.outOfSyncEphemeralSetting,q=j.plaintextHashs,t=j.protocolMsgId,u=j.unknownDevice;j=j.unknownGroup;if(u){u=g.author===\"@me\"?d(\"WAGlobals\").getMyUserJid():g.author;f.push(u);h.add(\"unknown-device\")}if(j){u=d(\"WAJids\").interpretAsGroupJid(g.chat);i=u}o!=null&&(p.TAGS([d(\"MAWLoggerUtils\").Tag.Ephemeral,d(\"MAWLoggerUtils\").Tag.SettingSync]).LOG(m(),t==null?void 0:t.externalId),c(\"promiseDone\")(s(o)));q==null?void 0:q.forEach(function(b){p.LOG(l(),a.details.externalId,b),r(t,b,a.receiveFlow,k)})}u={\"int\":{getDevicesCount:(j=f==null?void 0:f.length)!=null?j:void 0},string:{getDevicesReason:f.length>0?Array.from(h).join(\"|\"):void 0,queryGroup:(g=i)!=null?g:void 0}};if(e.type===\"IncomingCiphertextMsg\"){a.receiveFlow.endFail(\"end_with_decryption_error\",babelHelpers[\"extends\"]({},u,{string:babelHelpers[\"extends\"]({},u.string,{errorDescription:(q=(o=a.decryptionError)==null?void 0:o.error)!=null?q:\"Unknown decryption failure\"})}));return babelHelpers[\"extends\"]({},a,{getDevices:{reason:Array.from(h).join(\"|\"),users:f},queryGroup:i!=null?{groupJid:i,type:\"queryGroup\"}:void 0})}else{a.details.type!==\"media\"&&a.receiveFlow.endSuccess(u);return babelHelpers[\"extends\"]({},a,{getDevices:{reason:Array.from(h).join(\"|\"),users:f},queryGroup:i!=null?{groupJid:i,type:\"queryGroup\"}:void 0})}}a.receiveFlow.endFail(\"end_with_unexpected_db_issue\",{string:{errorDescription:\"Unexpected db issue: \"+b.error.type}});return babelHelpers[\"extends\"]({},a)}function r(a,b,c,e){a!=null&&b!=null&&(c.addPoint(\"start_media_download_job\"),p.TAGS([\"downloadAndHandleMedia\"]).LOG(k(),a,b),d(\"MAWGlobals\").getJobManager().fireAndForget(d(\"MAWJobDefinitions\").jobSerializers.downloadAndHandleMedia(a,b,\"WAIncomingMsg\",e,null,q(c))))}function s(a){return d(\"MAWGlobals\").getJobManager().waitUntilPersisted(d(\"MAWJobDefinitions\").jobSerializers.sendEphemeralSettingMsg(a.chatJid,{ephemeralSetting:{ephemeralExpirationInSec:a.correctEphemeralExpirationInSec,ephemeralLastUpdatedOrSetTimestamp:a.correctEphemeralLastUpdatedOrSetTimestamp},isEphemeralSettingReset:!1,isForSyncResponse:!0}))}function t(a){return u.apply(this,arguments)}function u(){u=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){yield d(\"MAWGlobals\").getDbImpls().createGroups(a.map(function(a){var b=a.folder;a=a.group;return{extras:null,folder:b,groupStatus:\"added\",groupToCreate:a,key:null,serverTs:d(\"WATimeUtils\").unixTime()}}))});return u.apply(this,arguments)}function e(a){return v.apply(this,arguments)}function v(){v=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=new Set(a.map(function(a){return(a=a.queryGroup)==null?void 0:a.groupJid}).filter(Boolean));a=(yield (h||(h=b(\"Promise\"))).allSettled(Array.from(a).map(function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=(yield d(\"WAQueryGroup\").queryGroup(a,\"interactive\"));if(a.success===!1){p.WARN(j(),a.error);return}if(!o())yield t([{folder:null,group:a.value}]);else return{folder:null,group:a.value}});return function(b){return a.apply(this,arguments)}}())));if(o()){a=a.map(function(a){return a.value}).filter(Boolean);yield t(a)}});return v.apply(this,arguments)}function f(a){return w.apply(this,arguments)}function w(){w=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=(yield (h||(h=b(\"Promise\"))).allSettled(a.map(function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(a.queryGroupInvite==null)return;var b=a.queryGroupInvite.groupInvite,c=b.inviteCode,e=b.inviteExpireTs;b=b.inviterJid;c=(yield d(\"WAQueryGroupInvite\").queryGroupInvite(a.queryGroupInvite.groupJid,c,e,b));if(c.success===!1){p.WARN(i(),c.error);return}if(!o()){yield t([{folder:(e=a.queryGroupInvite)==null?void 0:e.folder,group:c.value}])}else{return{folder:(b=a.queryGroupInvite)==null?void 0:b.folder,group:c.value}}});return function(b){return a.apply(this,arguments)}}())));if(o()){a=a.map(function(a){return a.value}).filter(Boolean);yield t(a)}});return w.apply(this,arguments)}g.processSingleDBResult=a;g.processQueryGroupActions=e;g.processQueryGroupInviteActions=f}),98);\n__d(\"MAWUploadIncomingMessageStanzas\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a){}f.uploadIncomingMessagesStanzas=a}),66);\n__d(\"WAResultOrErrorUtils\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a){var b=[];a.forEach(function(a){a.success&&b.push(a.value)});return b}function b(a){var b=[];a.forEach(function(a){a.success||b.push(a.error)});return b}f.unpackValues=a;f.unpackErrors=b}),66);\n__d(\"MAWProtocolQueueMsg\",[\"MAWBulkHandleIncomingMsgApi\",\"MAWMessageHandlingFollowUps\",\"MAWMsgType\",\"MAWProtocolQueueFollowUps\",\"MAWUploadIncomingMessageStanzas\",\"MAWXMAUtils\",\"Promise\",\"WALogger\",\"WAResultOrErrorUtils\",\"asyncToGeneratorRuntime\",\"err\",\"qex\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Some messages failed to be written to DB: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Cannot re-create thread after creation attempt, dropping message\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Instamadillo Msg got into protocol queue. It shouldn't happen before instamadillo Web support\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"RTC XMA is not supported\"]);l=function(){return a};return a}function a(a){c(\"qex\")._(\"944\")===!0&&d(\"MAWUploadIncomingMessageStanzas\").uploadIncomingMessagesStanzas(a);var b=[],e=a.map(function(a){var c;if(((c=a.decodedMsg)==null?void 0:(c=c.unstoredDbMsg)==null?void 0:c.type)===d(\"MAWMsgType\").MSG_TYPE.FUTUREPROOF){a.receiveFlow.addPoint(\"msg_not_supported\",{\"int\":{unsupportedXmaTargetType:(c=(c=a.decodedMsg)==null?void 0:c.xmaTargetTypeForLogging)!=null?c:-1},string:{unsupportedContentType:(c=(c=a.decodedMsg)==null?void 0:c.contentTypeForLogging)!=null?c:\"\"}})}else{a.receiveFlow.addPoint(\"msg_is_supported\",{\"int\":{xmaTargetType:(c=(c=a.decodedMsg)==null?void 0:c.xmaTargetTypeForLogging)!=null?c:-1},string:{contentType:(c=(c=a.decodedMsg)==null?void 0:c.contentTypeForLogging)!=null?c:\"\"}})}if(d(\"MAWXMAUtils\").isRtcXMA((c=a.decodedMsg)==null?void 0:(c=c.unstoredXMA)==null?void 0:(c=c.unstoredDbXMA)==null?void 0:c.targetType)){a.receiveFlow.endFail(\"rtc_xma_not_supported\");b.push(a.stanza.stanzaQueueId);d(\"WALogger\").ERROR(l());return null}if(a.stanza.message.decrypted.type===\"InstamadilloMsg\"){d(\"WALogger\").ERROR(k());a.receiveFlow.endFail(\"instamadillo_not_supported\");b.push(a.stanza.stanzaQueueId);return null}return{msgData:a.stanza.message.decrypted,unstoredContent:a.decodedMsg}}).filter(Boolean);return d(\"MAWBulkHandleIncomingMsgApi\").bulkHandleIncomingMsgs(e).then(function(b){var e=b.msgResults,f=[];a.map(function(a){var b=e.get(a.stanza.message.decrypted.id);if(b==null)throw c(\"err\")(\"Cannot have null HIM result - SHOULD NEVER HAPPEN\");if(b.success===!0){var g;f.push(a.stanza.stanzaQueueId);g=(g=b.value)==null?void 0:g.protocolMsgId;a.receiveFlow.addAnnotations({string:{persistedChatJid:g==null?void 0:g.chat}})}b.success===!1&&b.error.type===\"no_thread\"&&(d(\"WALogger\").ERROR(j()),f.push(a.stanza.stanzaQueueId))});return{followUpParams:{incomingMsgResults:e,incomingMsgs:a},toAck:f}})[\"catch\"](function(b){var c=\"empty\";try{typeof b.message===\"string\"&&(c=b.message)}catch(a){c=\"Not an Error instance\"}a.forEach(function(a){a.receiveFlow.endFail(\"consumer_handle_message_transaction_error\",{string:{errorDescription:c}})});throw b})}function e(a,b){return m.apply(this,arguments)}function m(){m=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,c){d(\"MAWProtocolQueueFollowUps\").bumpFollowUpEntity(\"message_persist_result\");a=n(a.map(function(a){var b=a.receiveFlow;a=a.stanza;return babelHelpers[\"extends\"]({},a.message,{receiveFlow:b})}),c);c=a.map(function(a){return d(\"MAWMessageHandlingFollowUps\").processSingleDBResult(a)});yield (h||(h=b(\"Promise\"))).all([d(\"MAWMessageHandlingFollowUps\").processQueryGroupActions(c),d(\"MAWMessageHandlingFollowUps\").processQueryGroupInviteActions(c)])});return m.apply(this,arguments)}function n(a,b){var e=d(\"WAResultOrErrorUtils\").unpackErrors(Array.from(b.values()));e.length>0&&d(\"WALogger\").WARN(i(),e.map(function(a){return a.type}).join(\", \"));return a.map(function(a){var d=b.get(a.decrypted.id);if(d==null)throw c(\"err\")(\"[ProtocolQueue] Result for message can't be null\");d.success===!1&&a.receiveFlow.addPoint(d.error.type);return babelHelpers[\"extends\"]({},a,{db:d})})}g.handleIncomingMessagesStanzas=a;g.handleMessagePersistResult=e}),98);\n__d(\"MAWHandleConnectedAdminMsgApi\",[\"MAWAdminWriteUsersConnectedMsgTxn\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleConnectedAdminMsg: chat \",\"\"]);h=function(){return a};return a}b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE},\"handleConnectedAdminMsg\",function(a){return function(b){var c=b.chatJid;b=b.isOtherContactMsplit;d(\"WALogger\").LOG(h(),c);return d(\"MAWAdminWriteUsersConnectedMsgTxn\").writeUsersConnectedAdminMsg(a,c,b)}});g.handleConnectedAdminMsg=b}),98);\n__d(\"MAWUpdateThreadFolderApi\",[\"MAWBridgeTypesCreators\",\"MAWDbThreadTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Update thread \",\" folder with folder id \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Update thread \",\"\"]);i=function(){return a};return a}a=d(\"MAWIndexedDb\").makeMsgrTransactor({threads:d(\"MAWTransactionMode\").READWRITE},\"updateThreadFolder\",function(a){return function(b,c){d(\"WALogger\").LOG(i(),b);return d(\"MAWDbThreadTxns\").getThreadByJid(a,b).then(function(b){if(!b.success)return;var e=b.value.chatId;return a.threads.update(e,{folder:c}).then(function(a){d(\"WALogger\").LOG(h(),e,c);d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadUpdated\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdatedThread({folder:c,threadId:e,threadJid:b.value.jid})});return})})}});g.updateThreadFolder=a}),98);\n__d(\"WAMediaRetryCrypto\",[\"WABinary\",\"WACryptoDependencies\",\"WACryptoHkdf\",\"WALogger\",\"WAMmsRetry.pb\",\"decodeProtobuf\",\"encodeProtobuf\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"encodeMediaRetryNotification\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"encodeServerErrorReceipt\"]);i=function(){return a};return a}function j(a){d(\"WALogger\").DEV(i()).devConsole(a);a=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAMmsRetry.pb\").ServerErrorReceiptSpec,a);return a.readByteArray()}function a(a,b,c){return l(a,b,j({stanzaId:b}),c)}function c(a,b,c,e){return m(a,b,c,e).then(function(a){return d(\"decodeProtobuf\").decodeProtobuf(d(\"WAMmsRetry.pb\").ServerErrorReceiptSpec,a)})}function k(a){d(\"WALogger\").DEV(h()).devConsole(a);a=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAMmsRetry.pb\").MediaRetryNotificationSpec,a);return a.readByteArray()}function e(a,b,c,d,e){return l(a,b,k({stanzaId:b,directPath:c,result:e}),d)}function f(a,b,c,e){return m(a,b,c,e).then(function(a){return d(\"decodeProtobuf\").decodeProtobuf(d(\"WAMmsRetry.pb\").MediaRetryNotificationSpec,a)})}function l(a,c,e,f){var g,h,i,j,k;return b(\"regeneratorRuntime\").async(function(l){while(1)switch(l.prev=l.next){case 0:g=(f==null?void 0:f.slice())||p();l.next=3;return b(\"regeneratorRuntime\").awrap(o(a,c,g));case 3:h=l.sent;i=h.key;j=h.params;l.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoDependencies\").getCrypto().subtle.encrypt(j,i,e));case 8:k=l.sent;return l.abrupt(\"return\",{ciphertext:k,iv:g});case 10:case\"end\":return l.stop()}},null,this)}function m(a,c,e,f){var g,h,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b(\"regeneratorRuntime\").awrap(o(a,c,e));case 2:g=j.sent;h=g.key;i=g.params;return j.abrupt(\"return\",d(\"WACryptoDependencies\").getCrypto().subtle.decrypt(i,h,f));case 6:case\"end\":return j.stop()}},null,this)}var n=\"WhatsApp Media Retry Notification\";function o(a,c,e){var f,g,h,i,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoHkdf\").extractAndExpand(new Uint8Array(a),n,32));case 2:f=k.sent;g=new(d(\"WABinary\").Binary)();g.write(c);h=g.readByteArray();i={name:\"AES-GCM\",iv:e,additionalData:h};k.next=9;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoDependencies\").getCrypto().subtle.importKey(\"raw\",new Uint8Array(f),\"AES-GCM\",!1,[\"encrypt\",\"decrypt\"]));case 9:j=k.sent;return k.abrupt(\"return\",{key:j,params:i});case 11:case\"end\":return k.stop()}},null,this)}function p(){var a=new Uint8Array(12);d(\"WACryptoDependencies\").getCrypto().getRandomValues(a);return a}g.encryptServerErrorReceipt=a;g.decryptServerErrorReceipt=c;g.encryptMediaRetryNotification=e;g.decryptMediaRetryNotification=f}),98);\n__d(\"WAHandleMediaRetryNotification\",[\"WAGlobals\",\"WALogger\",\"WAMediaRetryCrypto\",\"WAMediaUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleMediaRetryNotification: no directPath in mediaretry notification\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleMediaRetryNotification: invalid encrypted stanzaId received\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Media retry: different stanzaIds: \",\" \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleMediaRetryNotification: Msg \",\" mediaEntry is invalid\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleMediaRetryNotification: Msg \",\" \",\" no longer exists\"]);l=function(){return a};return a}function a(a,c){var e,f,g,m,n,o,p,q,r,s,t,u,v,w,x,y,z;return b(\"regeneratorRuntime\").async(function(A){while(1)switch(A.prev=A.next){case 0:e=a.stanzaId,f=a.notification,g=f.from,m=f.encProto,n=f.encIv;A.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getDbImpls().getMediaMsgForRedownload(g.chat,e,g.author));case 3:o=A.sent;if(o.success){A.next=7;break}d(\"WALogger\").LOG(l(),g.chat,e);return A.abrupt(\"return\",null);case 7:p=o.value,q=p.plaintextHash,r=p.mediaEntryData;s=d(\"WAMediaUtils\").decodeMediaEntryData(r);t=s.fileSha256,u=s.fileEncSha256,v=s.mediaKey,w=s.serverMediaType;if(!(v==null||t==null||u==null||w==null)){A.next=13;break}d(\"WALogger\").LOG(k(),c);return A.abrupt(\"return\",null);case 13:A.next=15;return b(\"regeneratorRuntime\").awrap(d(\"WAMediaRetryCrypto\").decryptMediaRetryNotification(v,e,n,m));case 15:x=A.sent;y=x.stanzaId;z=x.directPath;if(!(y!==e)){A.next=22;break}d(\"WALogger\").WARN(j(),y,e);d(\"WALogger\").ERROR(i());return A.abrupt(\"return\",null);case 22:if(!(z==null)){A.next=25;break}d(\"WALogger\").ERROR(h());return A.abrupt(\"return\",null);case 25:return A.abrupt(\"return\",{plaintextHash:q,updateEntry:function(){return d(\"WAMediaUtils\").encodeMediaEntryForDownload({fileSha256:t,fileEncSha256:u,mediaKey:v,serverMediaType:w,directPath:z})}});case 26:case\"end\":return A.stop()}},null,this)}g.prepareMediaRetry=a}),98);\n__d(\"MAWProtocolQueueNotification\",[\"MAWBridge\",\"MAWFolderTypes\",\"MAWGlobals\",\"MAWHandleConnectedAdminMsgApi\",\"MAWJobDefinitions\",\"MAWProtocolQueueFollowUps\",\"MAWProtocolQueueGroupNotification\",\"MAWSharedOfflineResumeUINotifier\",\"MAWUpdateMediaEntryForMsgApi\",\"MAWUpdateThreadFolderApi\",\"Promise\",\"WAHandleMediaRetryNotification\",\"WAJids\",\"WALogger\",\"WAProtocolQueueHandleNotification\",\"WAResultOrError\",\"WATagsLogger\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleThreadNotification (\",\") unknown thread action, jid: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleThreadNotification (\",\") connected, jid: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleThreadNotification (\",\") with folder id \",\", jid: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received unsupported notification type: \",\"\"]);l=function(){return a};return a}function m(a){return d(\"WAProtocolQueueHandleNotification\").handleICDC(a).then(function(){return d(\"WAResultOrError\").makeResult()})}function n(a){return o.apply(this,arguments)}function o(){o=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var c=a.stanzaId;a=a.notification;var e=a.actions,f=a.chatJid,g=d(\"WAJids\").interpretAsUserJid(f),l=(yield d(\"MAWBridge\").getBridge().sendAndReceive(\"event\",\"getLSDBUsersIsMsplit\",{users:[g].filter(Boolean)}));return(h||(h=b(\"Promise\"))).all(e.map(function(a){switch(a.type){case\"folder\":var e;e=(e=a.folderId)!=null?e:d(\"MAWFolderTypes\").FOLDER_ID.INBOX;d(\"WALogger\").LOG(k(),c,e,f);return d(\"MAWUpdateThreadFolderApi\").updateThreadFolder(f,e);case\"connected\":d(\"WALogger\").LOG(j(),c,f);e=g!=null&&l.get(g)===!0;return d(\"MAWHandleConnectedAdminMsgApi\").handleConnectedAdminMsg({chatJid:f,isOtherContactMsplit:e});default:a.type;d(\"WALogger\").ERROR(i(),c,f);return(h||(h=b(\"Promise\"))).reject()}})).then(function(){})});return o.apply(this,arguments)}function a(a){return p.apply(this,arguments)}function p(){p=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){d(\"MAWProtocolQueueFollowUps\").bumpFollowUpEntity(\"media_retry_notification\");var b=a.notification.from,c=a.stanzaId;b={author:d(\"WAJids\").extractUserJid(b.author),chat:b.chat,externalId:c};c=(yield d(\"WAHandleMediaRetryNotification\").prepareMediaRetry(a,b));if(c==null)return;a=c.plaintextHash;c=c.updateEntry;yield d(\"MAWUpdateMediaEntryForMsgApi\").updateMediaEntryForMsg(a,b,c);yield d(\"MAWGlobals\").getJobManager().waitUntilPersisted(d(\"MAWJobDefinitions\").jobSerializers.downloadAndHandleMedia(b,a,\"WAHandleMediaRetryNotification\"))});return p.apply(this,arguments)}function c(a){return(h||(h=b(\"Promise\"))).all(a.map(function(a){a=a.notification;a=q(a);return a})).then(function(b){var c={groupRecoveries:[],retryNotifications:[]},e=[];b.map(function(b,d){if(b.success===!0){e.push(a[d].stanzaQueueId);if(b.value!=null){d=b.value;d.type===\"group\"&&c.groupRecoveries.push(d.data);d.type===\"mediaretry\"&&c.retryNotifications.push(d.data)}}});d(\"MAWSharedOfflineResumeUINotifier\").offlineResumeUINotifier.addMAWEntity(e.length);d(\"MAWGlobals\").getOfflineResumeStats().addMAWEntity(e.length);return{followUpParams:c,toAck:e}})}function q(a){switch(a.type){case\"devices\":return m(a);case\"group\":return d(\"MAWProtocolQueueGroupNotification\").handleProtocolQueueGroupNotification(a).then(function(a){return a.value?d(\"WAResultOrError\").makeResult({data:a.value,type:\"group\"}):d(\"WAResultOrError\").makeResult()});case\"thread\":return n(a).then(function(){return d(\"WAResultOrError\").makeResult()});case\"mediaretry\":return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult({data:{notification:a},type:\"mediaretry\"}));default:a;d(\"WATagsLogger\").TAGS([\"ProtocolQueue\"]).ERROR(l(),a.type);return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult())}}g.mediaRetryNotification=a;g.handleIncomingNotificationStanzas=c}),98);\n__d(\"MAWCreateGroupApi\",[\"MAWDexieTable\",\"MAWGroupManagementTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=function(a,b){var c=b.extras,e=b.folder,f=b.groupStatus,g=b.groupToCreate,h=b.key;b=b.serverTs;return d(\"MAWGroupManagementTxns\").createGroupInternal(a,{deduplicationKey:h!=null?h:void 0,extras:c,folder:e,groupStatus:f,groupToCreate:g,serverTs:b})};b=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,contacts:a.READONLY,editMsgHistory:a.READONLY,groupInfo:a.READWRITE,media:a.READONLY,messages:a.READWRITE,participants:a.READWRITE,personalSenderKeyStatuses:a.READWRITE,reactions:a.READONLY,threads:a.READWRITE,xma:a.READONLY},\"createGroup\",function(a){return function(b,c,d,e,f,g){return h(a,{extras:g,folder:e,groupStatus:c,groupToCreate:b,key:f,serverTs:d})}});c=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor({chunk:a.READONLY,contacts:a.READONLY,editMsgHistory:a.READONLY,groupInfo:a.READWRITE,media:a.READONLY,messages:a.READWRITE,participants:a.READWRITE,personalSenderKeyStatuses:a.READWRITE,reactions:a.READONLY,threads:a.READWRITE,xma:a.READONLY},\"createGroups\",function(a){return function(b){return d(\"MAWDexieTable\").dexieAll(b.map(function(b){var c=b.extras,d=b.folder,e=b.groupStatus,f=b.groupToCreate,g=b.key;b=b.serverTs;return h(a,{extras:c,folder:d,groupStatus:e,groupToCreate:f,key:g,serverTs:b})})).then(function(){})}});g.createGroup=b;g.createGroups=c}),98);\n__d(\"WAAddGroupParticipantsApi\",[\"WAAdminMsgHelpers\",\"WAGlobals\",\"WAResultOrError\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return d(\"WAGlobals\").runInTransaction({MessagesStore:!0,ParticipantsStore:!0,GroupInfoStore:!0},function(a){return h.apply(void 0,[a].concat(b))},\"addGroupParticipants\")};var h=function(a,c,e,f,g,h,i){var j,k,l,m,n,o;return b(\"regeneratorRuntime\").async(function(p){while(1)switch(p.prev=p.next){case 0:j=a.MessagesStore,k=a.ParticipantsStore,l=a.GroupInfoStore;p.next=3;return b(\"regeneratorRuntime\").awrap(l.get(e));case 3:m=p.sent;if(m.success){p.next=6;break}return p.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing_group\"));case 6:i=m.value;if(!(c!=null&&c.previous!=null&&i.participantVersion!==c.previous)){p.next=9;break}return p.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"mismatch\"));case 9:n=g.map(function(a){return{chatJid:e,type:a.type,user:a.user,addressable:a.addressable}});p.next=12;return b(\"regeneratorRuntime\").awrap(k.bulkPut(n));case 12:if(!(c!=null)){p.next=18;break}o=d(\"WAAdminMsgHelpers\").createParticipantAddAdminMessage(e,n.map(function(a){return a.user}),f);p.next=16;return b(\"regeneratorRuntime\").awrap(j.create(o));case 16:p.next=18;return b(\"regeneratorRuntime\").awrap(l.update(e,function(a){return babelHelpers[\"extends\"]({},a,{participantVersion:c.current})},{updateParticipantMedatadata:h}));case 18:return p.abrupt(\"return\",d(\"WAResultOrError\").makeResult());case 19:case\"end\":return p.stop()}},null,this)};g.addGroupParticipants=a;g.addGroupParticipantsTransactor=h}),98);\n__d(\"WAChangeGroupMemberAddModeApi\",[\"WAAdminMsgHelpers\",\"WAGlobals\",\"WAResultOrError\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return d(\"WAGlobals\").runInTransaction({GroupInfoStore:!0,MessagesStore:!0},function(a){return h.apply(void 0,[a].concat(b))},\"changeGroupMemberAddMode\")};var h=function(a,c,e,f){var g,h,i,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:g=a.GroupInfoStore,h=a.MessagesStore;k.next=3;return b(\"regeneratorRuntime\").awrap(g.get(c));case 3:i=k.sent;if(i.success){k.next=6;break}return k.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing_group\"));case 6:k.next=8;return b(\"regeneratorRuntime\").awrap(g.update(c,function(a){return babelHelpers[\"extends\"]({},a,{memberAddMode:f})}));case 8:j=d(\"WAAdminMsgHelpers\").createMemberAddModeChangeAdminMsg(c,f,e);if(!(j!=null)){k.next=12;break}k.next=12;return b(\"regeneratorRuntime\").awrap(h.create(j));case 12:return k.abrupt(\"return\",d(\"WAResultOrError\").makeResult());case 13:case\"end\":return k.stop()}},null,this)};g.changeGroupMemberAddMode=a;g.changeGroupMemberAddModeTransactor=h}),98);\n__d(\"WAChangeGroupParticipantAdminStatusApi\",[\"WAAdminMsgHelpers\",\"WAGlobals\",\"WAResultOrError\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return d(\"WAGlobals\").runInTransaction({MessagesStore:!0,ParticipantsStore:!0,GroupInfoStore:!0},function(a){return h.apply(void 0,[a].concat(b))},\"changeGroupParticipantAdminStatus\")};var h=function(a,c,e,f,g,h){var i,j,k,l,m,n,o,p;return b(\"regeneratorRuntime\").async(function(q){while(1)switch(q.prev=q.next){case 0:i=a.MessagesStore,j=a.ParticipantsStore,k=a.GroupInfoStore;q.next=3;return b(\"regeneratorRuntime\").awrap(k.get(e));case 3:l=q.sent;if(l.success){q.next=6;break}return q.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing_group\"));case 6:m=l.value;if(!(c!=null&&c.previous!=null&&m.participantVersion!==c.previous)){q.next=9;break}return q.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"mismatch\"));case 9:n=g.map(function(a){return{addressable:a.addressable,type:h,chatJid:e,user:a.user}});q.next=12;return b(\"regeneratorRuntime\").awrap(j.bulkPut(n));case 12:if(!(c!=null)){q.next=23;break}q.next=15;return b(\"regeneratorRuntime\").awrap(k.update(e,function(a){return babelHelpers[\"extends\"]({},a,{participantVersion:c.current})}));case 15:p=0;case 16:if(!(p<n.length)){q.next=23;break}h===\"admin\"?o=d(\"WAAdminMsgHelpers\").createParticipantPromoteAdminMsg(e,n[p].user,f):o=d(\"WAAdminMsgHelpers\").createParticipantDemoteAdminMsg(e,n[p].user,f);q.next=20;return b(\"regeneratorRuntime\").awrap(i.create(o));case 20:p++;q.next=16;break;case 23:return q.abrupt(\"return\",d(\"WAResultOrError\").makeResult());case 24:case\"end\":return q.stop()}},null,this)};g.changeGroupParticipantAdminStatus=a;g.changeGroupParticipantAdminStatusTransactor=h}),98);\n__d(\"WARemoveGroupParticipantsApi\",[\"WAAdminMsgHelpers\",\"WAGlobals\",\"WAResultOrError\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){for(var a=arguments.length,c=new Array(a),e=0;e<a;e++)c[e]=arguments[e];return d(\"WAGlobals\").runInTransaction({MessagesStore:!0,ParticipantsStore:!0,GroupInfoStore:!0},function(a){return h.apply(void 0,[a].concat(c))},\"removeGroupParticipants\").then(function(a){return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!a.success){e.next=3;break}e.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getDbImpls().bulkSetRotateSenderKeyToTrue([c[1]]));case 3:return e.abrupt(\"return\",a);case 4:case\"end\":return e.stop()}},null,this)})};var h=function(a,c,e,f,g,h,i){var j,k,l,m,n,o,p;return b(\"regeneratorRuntime\").async(function(q){while(1)switch(q.prev=q.next){case 0:j=a.MessagesStore,k=a.ParticipantsStore,l=a.GroupInfoStore;q.next=3;return b(\"regeneratorRuntime\").awrap(l.get(e));case 3:m=q.sent;if(m.success){q.next=6;break}return q.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing_group\"));case 6:i=m.value;if(!(c!=null&&c.previous!=null&&i.participantVersion!==c.previous)){q.next=9;break}return q.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"mismatch\"));case 9:n=g.map(function(a){return a.user});o=n.map(function(a){return{groupJid:e,userJid:a}});q.next=13;return b(\"regeneratorRuntime\").awrap(k.bulkDelete(o,{remover:f}));case 13:if(!(c!=null)){q.next=19;break}p=d(\"WAAdminMsgHelpers\").createParticipantRemoveAdminMsg(e,n,f);q.next=17;return b(\"regeneratorRuntime\").awrap(j.create(p));case 17:q.next=19;return b(\"regeneratorRuntime\").awrap(l.update(e,function(a){return babelHelpers[\"extends\"]({},a,{participantVersion:c.current})},{updateParticipantMedatadata:h}));case 19:return q.abrupt(\"return\",d(\"WAResultOrError\").makeResult());case 20:case\"end\":return q.stop()}},null,this)};g.removeGroupParticipants=a;g.removeGroupParticipantsTransactor=h}),98);\n__d(\"WAUpdateGroupSubjectApi\",[\"WAAdminMsgHelpers\",\"WAGlobals\",\"WAJids\",\"WAResultOrError\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return d(\"WAGlobals\").runInTransaction({MessagesStore:!0,ParticipantsStore:!0,GroupInfoStore:!0},function(a){return h.apply(void 0,[a].concat(b))},\"updateGroupSubject\")};var h=function(a,c,e){var f,g,h,i,j,k,l,m;return b(\"regeneratorRuntime\").async(function(n){while(1)switch(n.prev=n.next){case 0:f=a.MessagesStore,g=a.GroupInfoStore;n.next=3;return b(\"regeneratorRuntime\").awrap(g.get(c));case 3:h=n.sent;if(h.success){n.next=6;break}return n.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing_group\"));case 6:i=h.value;if(!(i.subject.ts!=null&&(e.ts==null||i.subject.ts>e.ts))){n.next=9;break}return n.abrupt(\"return\",d(\"WAResultOrError\").makeResult());case 9:n.next=11;return b(\"regeneratorRuntime\").awrap(g.update(c,function(a){return babelHelpers[\"extends\"]({},a,{subject:e})}));case 11:n.next=13;return b(\"regeneratorRuntime\").awrap(g.get(i.jid));case 13:j=n.sent;if(j.success){n.next=16;break}return n.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing_group\"));case 16:k=j.value;l=k.subject.user;m=d(\"WAAdminMsgHelpers\").createGroupNameChangeAdminMsg(c,k,l!=null?d(\"WAJids\").userIdFromJid(l):void 0);if(!(m!=null)){n.next=22;break}n.next=22;return b(\"regeneratorRuntime\").awrap(f.create(m));case 22:return n.abrupt(\"return\",d(\"WAResultOrError\").makeResult());case 23:case\"end\":return n.stop()}},null,this)};g.updateGroupSubject=a;g.updateGroupSubjectTransactor=h}),98);\n__d(\"MAWHandleGroupNotifications\",[\"MAWCreateGroupApi\",\"MAWGlobals\",\"MAWSendSenderKeyDistributionMsg\",\"Promise\",\"WAAddGroupParticipantsApi\",\"WAChangeGroupMemberAddModeApi\",\"WAChangeGroupParticipantAdminStatusApi\",\"WAJobDefinitions\",\"WAJobOrchestratorTypes\",\"WAJobs\",\"WARemoveGroupParticipantsApi\",\"WAResultOrError\",\"WAScheduleAfterOfflineResume\",\"WAUpdateGroupSubjectApi\",\"asyncToGeneratorRuntime\",\"err\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){var e=a.notification;switch(e.type){case\"join\":return i(e).then(function(){d(\"WAScheduleAfterOfflineResume\").scheduleAfterOfflineResume({code:function(){return d(\"MAWSendSenderKeyDistributionMsg\").maybePreEstablishSessionsAndSendSenderKeyDistributionMsg(e.group.jid,e.group.participants.map(function(a){return a.success?a.value.user:null}).filter(Boolean))},id:e.group.jid+\"-e2e-session\"});return d(\"WAResultOrError\").makeResult()});case\"add\":return k(e);case\"remove\":return l(e);case\"promote\":return n(e);case\"demote\":return m(e);case\"delete\":a=e.groupJid;var f=e.participant;if(f==null)throw c(\"err\")(\"Group delete notification without deleter JID: \"+a);return d(\"MAWGlobals\").getDbImpls().deleteGroups([{deleter:f,group:a}]).then(function(){return d(\"WAResultOrError\").makeResult()});case\"subject\":return o(e).then(function(){return d(\"WAResultOrError\").makeResult()});case\"memberAddMode\":return p(e);default:e.type;return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult())}}function i(a){return j.apply(this,arguments)}function j(){j=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(a.isE2EEMigration)return;var b=a.group,c=a.isNew,e=a.key,f=a.serverTs;yield d(\"MAWCreateGroupApi\").createGroup(b,c?\"new\":\"added\",f,null,e,e!=null?{deduplicationKey:e,platform:\"msgr\"}:null);b=a.group.participants.map(function(a){if(a.success)return a.value.user;else return a.error.user});yield d(\"WAJobs\").getJobManager().waitUntilCompleted(d(\"WAJobDefinitions\").createStartJobInfo(\"getDevices\",{ignoreDhash:!1,reason:\"added-to-group\",scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW},users:new Set(b)}))});return j.apply(this,arguments)}function k(a){var b=a.groupJid,e=a.participant,f=a.participants,g=a.previousVersionId,h=a.reason;a=a.versionId;if(e==null)throw c(\"err\")(\"Group add participant notification without adder JID: \"+b);return d(\"WAAddGroupParticipantsApi\").addGroupParticipants({current:a,previous:g},b,e,f,!1,h)}function l(a){var b=a.groupJid,e=a.participant,f=a.participants,g=a.previousVersionId;a=a.versionId;if(e==null)throw c(\"err\")(\"Group remove participant notification without remover JID: \"+b);var h=null;a!=null&&(h={current:a,previous:g});return d(\"WARemoveGroupParticipantsApi\").removeGroupParticipants(h,b,e,f,!1)}function m(a){var b=a.groupJid,c=a.participant,e=a.participants,f=a.previousVersionId;a=a.versionId;return d(\"WAChangeGroupParticipantAdminStatusApi\").changeGroupParticipantAdminStatus({current:a,previous:f},b,c,e,\"participant\")}function n(a){var b=a.groupJid,c=a.participant,e=a.participants,f=a.previousVersionId;a=a.versionId;return d(\"WAChangeGroupParticipantAdminStatusApi\").changeGroupParticipantAdminStatus({current:a,previous:f},b,c,e,\"admin\")}function o(a){var b=a.groupJid,c=a.participant,e=a.subject;a=a.ts;return d(\"WAUpdateGroupSubjectApi\").updateGroupSubject(b,{content:e,ts:a,user:c}).then(function(a){})}function p(a){var e=a.groupJid,f=a.memberAddMode;a=a.participant;return c(\"gkx\")(\"33036\")?d(\"WAChangeGroupMemberAddModeApi\").changeGroupMemberAddMode(e,a,f):(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult())}g.persistGroupNotification=a}),98);\n__d(\"WASyncParticipantsApi\",[\"WAResultOrError\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a,c,e){var f,g,h,i,j,k,l,m;return b(\"regeneratorRuntime\").async(function(n){while(1)switch(n.prev=n.next){case 0:f=a.ParticipantsStore;n.next=3;return b(\"regeneratorRuntime\").awrap(f.bulkGetInGroup(c));case 3:g=n.sent;if(!(g.success!==!0)){n.next=6;break}return n.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing_participants\"));case 6:if(!(e.length===0&&g.value.length===0)){n.next=8;break}return n.abrupt(\"return\",d(\"WAResultOrError\").makeResult({removedJids:[],addedJids:[],typeUpdateJids:[]}));case 8:h=new Map();g.value.forEach(function(a){h.set(a.user,a)});i=new Set(e.map(function(a){return a.user}));j=[];k=[];l=[];m=[];h.forEach(function(a,b){i.has(b)||(a.type!==\"invitedParticipant\"?j.push({userJid:b,groupJid:c}):(m.push({type:a.type,userJid:a.user}),l.push(babelHelpers[\"extends\"]({},a))))});e.forEach(function(a){var b=h.get(a.user);b==null?(k.push(a),a.type===\"admin\"&&m.push({type:a.type,userJid:a.user})):(b.type!==a.type&&m.push({type:a.type,userJid:a.user}),l.push(babelHelpers[\"extends\"]({},b,a)))});n.next=19;return b(\"regeneratorRuntime\").awrap(f.bulkPut(k));case 19:n.next=21;return b(\"regeneratorRuntime\").awrap(f.bulkPut(l));case 21:n.next=23;return b(\"regeneratorRuntime\").awrap(f.bulkDelete(j));case 23:return n.abrupt(\"return\",d(\"WAResultOrError\").makeResult({removedJids:j.map(function(a){a=a.userJid;return a}),addedJids:k.map(function(a){return a.user}),typeUpdateJids:m}));case 24:case\"end\":return n.stop()}},null,this)};g.syncParticipantsTransactor=a}),98);\n__d(\"WAResetGroupParticipantInfoApi\",[\"Promise\",\"WAAdminMsgHelpers\",\"WAGlobals\",\"WALogger\",\"WAResultOrError\",\"WASyncParticipantsApi\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unexpectedly received an error when sync-ing participants\"]);i=function(){return a};return a}a=function(){for(var a=arguments.length,c=new Array(a),e=0;e<a;e++)c[e]=arguments[e];return d(\"WAGlobals\").runInTransaction({ParticipantsStore:!0,GroupInfoStore:!0,MessagesStore:!0},function(a){return j.apply(void 0,[a].concat(c))},\"resetGroupParticipantInfo\").then(function(a){return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!a.success){e.next=3;break}e.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getDbImpls().bulkSetRotateSenderKeyToTrue([c[0]]));case 3:return e.abrupt(\"return\",a);case 4:case\"end\":return e.stop()}},null,this)})};var j=function(a,c,e,f){var g,j,k,l,m,n,o,p,q,r,s,t;return b(\"regeneratorRuntime\").async(function(u){while(1)switch(u.prev=u.next){case 0:g=a.ParticipantsStore,j=a.GroupInfoStore,k=a.MessagesStore;l=e.map(function(a){return{user:a.user,type:a.type,addressable:a.addressable,chatJid:c}});u.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WASyncParticipantsApi\").syncParticipantsTransactor({ParticipantsStore:g},c,l));case 4:m=u.sent;if(!(f!=null)){u.next=11;break}u.next=8;return b(\"regeneratorRuntime\").awrap(j.update(c,function(a){return babelHelpers[\"extends\"]({},a,{participantVersion:f})}));case 8:n=u.sent;if(n.success){u.next=11;break}return u.abrupt(\"return\",n);case 11:if(!(m.success!==!0)){u.next=14;break}d(\"WALogger\").ERROR(i());return u.abrupt(\"return\",m);case 14:o=m.value;p=[];o.removedJids.length>0&&(q=d(\"WAAdminMsgHelpers\").createParticipantRemoveAdminMsg(c,o.removedJids,null),p.push(k.create(q)));o.addedJids.length>0&&(r=d(\"WAAdminMsgHelpers\").createParticipantAddAdminMessage(c,o.addedJids,null),p.push(k.create(r)));if(o.typeUpdateJids.length>0)for(s=0;s<o.typeUpdateJids.length;s++)t=o.typeUpdateJids[s].type===\"admin\"?d(\"WAAdminMsgHelpers\").createParticipantPromoteAdminMsg(c,o.typeUpdateJids[s].userJid,null):d(\"WAAdminMsgHelpers\").createParticipantDemoteAdminMsg(c,o.typeUpdateJids[s].userJid,null),p.push(k.create(t));return u.abrupt(\"return\",(h||(h=b(\"Promise\"))).all(p).then(function(){return d(\"WAResultOrError\").makeResult()}));case 20:case\"end\":return u.stop()}},null,this)};g.resetGroupParticipantInfo=a;g.resetGroupParticipantInfoTransactor=j}),98);\n__d(\"MAWProtocolQueueGroupNotification\",[\"MAWGlobals\",\"MAWHandleGroupNotifications\",\"MAWJobDefinitions\",\"MAWProtocolQueueFollowUps\",\"MAWSendSenderKeyDistributionMsg\",\"Promise\",\"WALogger\",\"WAQueryGroup\",\"WAResetGroupParticipantInfoApi\",\"WAResultOrError\",\"WAScheduleAfterOfflineResume\",\"WATimeUtils\",\"asyncToGeneratorRuntime\",\"err\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to create group infos\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to recover missing group info\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[doGroupRecovery] Cannot get a group, as per \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to query groups\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to get group info\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unexpectedly received a participant with an error\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[ParticipantRecovery] Cannot get a group, as per \",\"\"]);o=function(){return a};return a}var p=function(){return c(\"gkx\")(\"120\")};function a(a){var b=a.notification;return d(\"MAWHandleGroupNotifications\").persistGroupNotification(a).then(function(a){return a.success?a:d(\"WAResultOrError\").makeResult({errorResult:a,groupNotification:b})})}function e(a){return q.apply(this,arguments)}function q(){q=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){d(\"MAWProtocolQueueFollowUps\").bumpFollowUpEntity(\"group_recovery\");var c=new Set(),e=new Set();yield (h||(h=b(\"Promise\"))).all(a.map(function(a){var d=a.errorResult;a=a.groupNotification;if(a.type===\"add\"||a.type===\"remove\"||a.type===\"promote\"||a.type===\"demote\"){d=d.error===\"mismatch\";if(p())d?c.add(a.groupJid):e.add(a.groupJid);else if(d)return r([a.groupJid]);else return t([a.groupJid])}return(h||(h=b(\"Promise\"))).resolve()}));p()&&(yield (h||(h=b(\"Promise\"))).all([r(Array.from(c)),t(Array.from(e))]))});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=(yield (h||(h=b(\"Promise\"))).all(a.map(function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){try{var b=(yield d(\"WAQueryGroup\").queryGroup(a,\"participant_change_recovery\"));if(b.success===!1){d(\"WALogger\").ERROR(o(),b.error);throw c(\"err\")(\"[ParticipantRecovery] Cannot get a group, as per \"+JSON.stringify(b.error))}b=b.value;var e=b.participants.map(function(a){if(a.error){d(\"WALogger\").ERROR(n());return null}return a.value}).filter(Boolean);e=(yield d(\"WAResetGroupParticipantInfoApi\").resetGroupParticipantInfo(a,e,b.participantVersion));b=e.error;if(!e.success&&b===\"missing_group\")return a}catch(a){d(\"WALogger\").DEV(m()).devConsole(a)}});return function(b){return a.apply(this,arguments)}}()))).filter(Boolean);try{yield d(\"MAWGlobals\").getJobManager().waitUntilPersisted(d(\"MAWJobDefinitions\").jobSerializers.queryGroups(a))}catch(a){d(\"WALogger\").DEV(l()).devConsole(a)}});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=(yield (h||(h=b(\"Promise\"))).all(a.map(function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){try{a=(yield d(\"WAQueryGroup\").queryGroup(a,\"interactive\"));if(a.success===!1){d(\"WALogger\").ERROR(k(),a.error);throw c(\"err\")(\"[doGroupRecovery] Cannot get a group, as per \"+JSON.stringify(a.error))}return a.value}catch(a){d(\"WALogger\").DEV(j()).devConsole(a)}});return function(b){return a.apply(this,arguments)}}()))).filter(Boolean);try{yield d(\"MAWGlobals\").getDbImpls().createGroups(a.map(function(a){return{extras:null,folder:null,groupStatus:\"queried\",groupToCreate:a,key:null,serverTs:d(\"WATimeUtils\").unixTime()}})),a.forEach(function(a){d(\"WAScheduleAfterOfflineResume\").scheduleAfterOfflineResume({code:function(){return d(\"MAWSendSenderKeyDistributionMsg\").maybePreEstablishSessionsAndSendSenderKeyDistributionMsg(a.jid,a.participants.map(function(a){return a.success?a.value.user:null}).filter(Boolean))},id:a.jid+\"-e2e-session\"})})}catch(a){d(\"WALogger\").DEV(i()).devConsole(a)}});return u.apply(this,arguments)}g.handleProtocolQueueGroupNotification=a;g.groupRecovery=e}),98);\n__d(\"MAWUpdateDevicesForUserApi\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a,b){return a.identity.where(\"userJid\").equals(b).toArray().then(function(a){return a.map(function(a){return a.deviceJid})})}function b(a){var b=a.allowSecurityAlertForContact;a=a.isMe;return!a&&b}f.getAllDeviceJidsForUser=a;f.getShouldShowAdminMessages=b}),66);\n__d(\"MAWProtocolQueueInstructions\",[\"MAWAdminWriteUserDeviceMsgTxn\",\"MAWBridge\",\"MAWDbAddDeviceChangeAlertsTxn\",\"MAWDbContact\",\"MAWDbDeviceChangeAlerts\",\"MAWDbGetAlertsWithDeviceJidTxn\",\"MAWDbGetUnArchivedDeviceChangeAlertsCountTxn\",\"MAWDbMsgTypeVersionTxns\",\"MAWDbPersonalSenderKeyStatusTxns\",\"MAWDbThreadTxns\",\"MAWDbUpdateDeviceChangeAlertsLogInStatusTxn\",\"MAWDexieTable\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWODSProxy\",\"MAWSharedOfflineResumeUINotifier\",\"MAWTransactionMode\",\"MAWUpdateDevicesForUserApi\",\"WAAssertUnreachable\",\"WAGlobals\",\"WAJids\",\"WALogger\",\"WAOdsEnums\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"ICDC error instruction for thread \",\" not found\"]);h=function(){return a};return a}function i(a,b){b=new Set(b.map(function(a){return a.jid}));return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbMsgTypeVersionTxns\").maybeBulkGetSecuritySetting(a),d(\"MAWDbThreadTxns\").getAllThreadsForUsers(a,Array.from(b))])}function a(a){return j.apply(this,arguments)}function j(){j=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b=(yield d(\"MAWBridge\").getBridge().sendAndReceive(\"event\",\"getLSDBUsersRelationships\",{users:Array.from(new Set(a.map(function(a){return a.jid})))}));return k(a,b)});return j.apply(this,arguments)}var k=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor({appMeta:(e=d(\"MAWTransactionMode\")).READONLY,deviceChangeAlerts:e.READWRITE,groupInfo:e.READONLY,messages:e.READWRITE,participants:e.READONLY,personalSenderKeyStatuses:e.READWRITE,threads:e.READWRITE},\"handleInstructions\",function(a){return function(b,c){return i(a,b).then(function(e){var f=e[0],g=f.allowSecurityAlertForContact,h=f.allowSecurityAlertForSelf,i=e[1];return d(\"MAWDexieTable\").dexieSequentialAll(b.map(function(b){var e=b.jid,f=e===d(\"WAGlobals\").getMyUserJid(),j=d(\"MAWUpdateDevicesForUserApi\").getShouldShowAdminMessages({allowSecurityAlertForContact:g,isMe:f})&&c.get(e)===d(\"MAWDbContact\").TWO_WAY_CONTACT,k={allowSecurityAlertForSelf:h,isMe:f,shouldShowAdminMessages:j,threads:(f=i.get(e))!=null?f:[],user:e};return function(){return l(a,b,k)}})).then(function(){d(\"MAWSharedOfflineResumeUINotifier\").offlineResumeUINotifier.addMAWEntity(b.length);d(\"MAWGlobals\").getOfflineResumeStats().addMAWEntity(b.length);return{followUpParams:void 0,toAck:b.map(function(a){return a.stanzaQueueId})}})})}});function l(a,b,d){switch(b.instruction){case\"identityChanged\":return m(a,b,d);case\"identityAdded\":return n(a,b,d);case\"identityRemoved\":return o(a,b,d);case\"icdcError\":return p(a,b,d);default:throw c(\"WAAssertUnreachable\")(b)}}function m(a,b,c){var e=c.allowSecurityAlertForSelf,f=c.isMe,g=c.shouldShowAdminMessages;c=c.threads;var h=f&&b.model!=null&&b.platform!=null&&b.notificationTs!=null;return d(\"MAWDexieTable\").dexieAll([h&&b.model!=null&&b.platform!=null&&b.notificationTs!=null?d(\"MAWDbAddDeviceChangeAlertsTxn\").addDeviceChangeAlertsTxn(a,{action:d(\"MAWDbDeviceChangeAlerts\").KEY_CHANGE,deviceJid:b.device,identity:b.identity,isArchived:!e,model:b.model,platform:b.platform,ts:b.notificationTs}).then(function(){return d(\"MAWDbGetUnArchivedDeviceChangeAlertsCountTxn\").getUnArchivedDeviceChangeAlertsCountTxn(a)}):d(\"MAWDexieTable\").dexieResolve()].concat(g?c.map(function(c){return d(\"WAJids\").interpretAsGroupJid(c.jid)==null&&d(\"MAWAdminWriteUserDeviceMsgTxn\").writeUserDeviceAdminMsg(a,b.jid,c,d(\"MAWAdminWriteUserDeviceMsgTxn\").DeviceChange.update,b.notificationTs)}):[])).then(function(){(h||g)&&d(\"MAWODSProxy\").odsBumpEntityKey({entity:f?d(\"WAOdsEnums\").Entity.SECURITY_ALERT_FOR_SELF:d(\"WAOdsEnums\").Entity.SECURITY_ALERT_FOR_CONTACT,key:d(\"MAWDbDeviceChangeAlerts\").KEY_CHANGE})})}function n(a,b,c){var e=c.allowSecurityAlertForSelf,f=c.isMe,g=c.shouldShowAdminMessages,h=c.threads,i=c.user,j=f&&b.model!=null&&b.platform!=null&&b.notificationTs!=null;return d(\"MAWDexieTable\").dexieAll([j&&b.model!=null&&b.platform!=null&&b.notificationTs!=null?d(\"MAWDbAddDeviceChangeAlertsTxn\").addDeviceChangeAlertsTxn(a,{action:d(\"MAWDbDeviceChangeAlerts\").ADD,deviceJid:b.device,identity:b.identity,isArchived:!e,model:b.model,platform:b.platform,ts:b.notificationTs}).then(function(){return d(\"MAWDbGetUnArchivedDeviceChangeAlertsCountTxn\").getUnArchivedDeviceChangeAlertsCountTxn(a)}):d(\"MAWDexieTable\").dexieResolve()].concat(g?h.map(function(c){return d(\"WAJids\").interpretAsGroupJid(c.jid)==null&&d(\"MAWAdminWriteUserDeviceMsgTxn\").writeUserDeviceAdminMsg(a,i,c,d(\"MAWAdminWriteUserDeviceMsgTxn\").DeviceChange.add,b.notificationTs)}):[])).then(function(){(j||g)&&d(\"MAWODSProxy\").odsBumpEntityKey({entity:f?d(\"WAOdsEnums\").Entity.SECURITY_ALERT_FOR_SELF:d(\"WAOdsEnums\").Entity.SECURITY_ALERT_FOR_CONTACT,key:d(\"MAWDbDeviceChangeAlerts\").ADD})})}function o(a,b,c){var e=c.isMe,f=c.shouldShowAdminMessages,g=c.threads,h=c.user;c=g.map(function(a){return d(\"WAJids\").interpretAsGroupJid(a.jid)}).filter(Boolean);return d(\"MAWDexieTable\").dexieAll([e?d(\"MAWDbGetAlertsWithDeviceJidTxn\").getAlertsWithDeviceJidTxn(a,b.device).then(function(){return d(\"MAWDbUpdateDeviceChangeAlertsLogInStatusTxn\").updateDeviceChangeAlertsLogInStatusTxn(a,b.device)}).then(function(){return d(\"MAWDbGetUnArchivedDeviceChangeAlertsCountTxn\").getUnArchivedDeviceChangeAlertsCountTxn(a)}):d(\"MAWDexieTable\").dexieResolve()].concat(f?g.map(function(c){return d(\"WAJids\").interpretAsGroupJid(c.jid)==null&&d(\"MAWAdminWriteUserDeviceMsgTxn\").writeUserDeviceAdminMsg(a,h,c,d(\"MAWAdminWriteUserDeviceMsgTxn\").DeviceChange.remove,b.notificationTs)}):[],[c.length>0?d(\"MAWDbPersonalSenderKeyStatusTxns\").bulkSetRotateSenderKeyToTrueTxn(a,c):d(\"MAWDexieTable\").dexieResolve()])).then(function(){(e||f)&&d(\"MAWODSProxy\").odsBumpEntityKey({entity:e?d(\"WAOdsEnums\").Entity.SECURITY_ALERT_FOR_SELF:d(\"WAOdsEnums\").Entity.SECURITY_ALERT_FOR_CONTACT,key:d(\"MAWDbDeviceChangeAlerts\").REMOVE})})}function p(a,b,c){c=c.threads;if(!d(\"WAGlobals\").getConfig().isICDCErrorEnabled())return d(\"MAWDexieTable\").dexieResolve();c=c.find(function(a){return a.jid===b.jid});if(c==null){d(\"WALogger\").ERROR(h(),b.jid);return d(\"MAWDexieTable\").dexieResolve()}return d(\"MAWAdminWriteUserDeviceMsgTxn\").writeICDCAlert(a,b.jid,c,b.notificationTs)}g.handleInstructions=a}),98);\n__d(\"MAWWriteAppDataReceiptsApi\",[\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({appData:d(\"MAWTransactionMode\").READWRITE},\"writeAppDataReceipts\",function(a){return function(b){return h(a,b).then(function(b){return i(a,b)})}});function h(a,b){if(b.length===0)return d(\"MAWDexieTable\").dexieResolve();b=b.reduce(function(a,b){var c=a.appDataExternalIdSet,d=a.appDataReceiversSet;a=b.externalIds;b=b.receivers;a.forEach(function(a){c.add(a)});b.forEach(function(a){d.add(a)});return{appDataExternalIdSet:c,appDataReceiversSet:d}},{appDataExternalIdSet:new Set(),appDataReceiversSet:new Set()});var c=b.appDataExternalIdSet;b=b.appDataReceiversSet;c=Array.from(c);var e=Array.from(b);return a.appData.where(\"externalId\").anyOf(c).toArray().then(function(a){if(a.length===0)return;return j(a,e)})}function i(a,b){if(b==null)return d(\"MAWDexieTable\").dexieResolve();var c=b.toDelete;b=b.toUpdate;return d(\"MAWDexieTable\").dexieAll([c.length>0?a.appData.bulkDelete(c):d(\"MAWDexieTable\").dexieResolve(),b.length>0?a.appData.bulkPut(b):d(\"MAWDexieTable\").dexieResolve()]).then(function(){})}function j(a,b){return a.reduce(function(a,c){if(c==null)return a;for(var d=0;d<b.length;d++){var e=b[d];c.permittedIdentitiesPerDevice[\"delete\"](e)}if(c.permittedIdentitiesPerDevice.size===0){a.toDelete.push(c.appDataId);return a}else{a.toUpdate.push(c);return a}},{toDelete:[],toUpdate:[]})}g.writeAppDataReceipts=a;g.prepareBulkAppDataReceipts=h;g.writeBulkAppDataReceipts=i}),98);\n__d(\"MAWWritePeerMsgReceiptsApi\",[\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDbPendingReceiptTxns\",\"MAWDexieTable\",\"MAWEphemeralGatingUtil\",\"MAWEphemeralMsgTxns\",\"MAWGlobals\",\"MAWLoggerUtils\",\"MAWMarkThreadAsReadTxns\",\"MAWMsgType\",\"WAJids\",\"WALogger\",\"WATagsLogger\",\"WATimeUtils\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"WritePeerMsgReceiptApi - Marking \",\" as read\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Processing \",\" receipt for messages not from me\"]);i=function(){return a};return a}function j(a,b,c){return d(\"MAWDbMsgTxns\").maybeGetMsgByProtocolMsgId(a,b).then(function(a){return a==null||a.type===d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT?{msg:b,readReceipt:c,type:\"missing\"}:{dbMsg:a,msg:b,readReceipt:c,type:\"found\"}})}function k(a){a=a.map(function(a){return a.type===\"missing\"?null:a.dbMsg}).filter(Boolean);return a.reduce(function(a,b){var c=b.threadJid,e=d(\"WATimeUtils\").castToMillisTime(d(\"MAWDbMsg\").getSortOrderWithFallback(b)),f=a.get(c);(f==null||e>f.msgSortOrderMs)&&a.set(c,{msgId:b.msgId,msgSortOrderMs:e});return a},new Map())}function l(a){var b=new Map();a.forEach(function(a){if(a.type===\"missing\")return;var c=a.dbMsg.thread;a=a.dbMsg.msgId;var d=b.get(c);(d==null||a>d)&&b.set(c,a)});return b}function a(a,b){if(b.length===0)return d(\"MAWDexieTable\").dexieResolve([]);b=b.map(function(a){d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.Ephemeral,d(\"MAWLoggerUtils\").Tag.PeerReceipt]).LOG(i(),a.type);if(a.type===\"delivered\")return;var b={device:void 0,ts:void 0};a.receivers.forEach(function(a){var c=a.device;a=a.ts;var e=d(\"WAJids\").extractUserJid(c);e===d(\"MAWGlobals\").getMyUserJid()&&(b.ts==null||a<b.ts)&&(b.device=c,b.ts=a)});if(b.device!=null&&b.ts!=null)return babelHelpers[\"extends\"]({},a,{receivers:{device:b.device,ts:b.ts}});else return}).filter(Boolean);var c=[];b.forEach(function(a){a.msgs.forEach(function(b){c.push([b,a.receivers])})});return d(\"MAWDexieTable\").dexieAll(c.map(function(b){var c=b[0];b=b[1];return j(a,c,b)}))}function b(a,b){if(b.length===0)return d(\"MAWDexieTable\").dexieResolve();var e=[],f=[];b.map(function(a){a.type===\"missing\"?e.push({author:a.msg.author,deliveryReceipts:[],externalId:a.msg.externalId,readReceipts:[a.readReceipt],thread:a.msg.chat}):f.push({msgId:a.msg,ts:a.readReceipt.ts})});if(d(\"MAWDbMsgTxns\").IS_SORT_ORDER_COMPARISON_ENABLED){var g=k(b),i=b.reduce(function(a,b){b=b.msg.chat;var c=g.get(b);c!=null&&a.set(b,{msgId:c.msgId,sortOrderMs:c.msgSortOrderMs});return a},new Map());return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbPendingReceiptTxns\").bulkAddPendingReceipts(a,e),d(\"MAWMarkThreadAsReadTxns\").bulkMarkThreadAsReadUpToMsgSortOrderMs(a,i),d(\"MAWEphemeralGatingUtil\").isSendBasedDisappearingMessageEnabled()?d(\"MAWDexieTable\").dexieResolve():d(\"MAWEphemeralMsgTxns\").bulkMarkEphemeralMessageAsRead(a,f)]).then(function(){})}var j=l(b);i=Array.from(j.keys()).map(function(a){var b=j.get(a);if(b!=null)return{threadId:a,upToMsgId:b};else return null}).filter(Boolean);c(\"gkx\")(\"23916\")&&d(\"WALogger\").LOG(h(),f);return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbPendingReceiptTxns\").bulkAddPendingReceipts(a,e),d(\"MAWMarkThreadAsReadTxns\").bulkMarkThreadAsReadUpToMsgId__DONOTUSE(a,i),d(\"MAWEphemeralGatingUtil\").isSendBasedDisappearingMessageEnabled()?d(\"MAWDexieTable\").dexieResolve():d(\"MAWEphemeralMsgTxns\").bulkMarkEphemeralMessageAsRead(a,f)]).then(function(){})}g.getResultByProtocolMsgId=j;g.prepareReceiptsForMeToWrite=a;g.bulkWritePeerReceiptsForMsgsNotFromMeInternal=b}),98);\n__d(\"MAWBulkWriteReceiptsApi\",[\"MAWDexieTable\",\"MAWIncomingReceiptDataFormatTxns\",\"MAWIncomingReceiptTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"MAWWriteAppDataReceiptsApi\",\"MAWWritePeerMsgReceiptsApi\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a,b){var c=[],e=[],f=[];b.forEach(function(a){switch(a.type){case\"msg-receipt\":c.push(a.params);break;case\"not-from-me\":e.push(a.params);break;default:f.push(a.params);break}});return d(\"MAWDexieTable\").dexieAll([f.length>0?d(\"MAWWriteAppDataReceiptsApi\").prepareBulkAppDataReceipts(a,f):d(\"MAWDexieTable\").dexieResolve(),c.length>0?d(\"MAWIncomingReceiptDataFormatTxns\").prepareDataForReceiptsToWrite(a,c):d(\"MAWDexieTable\").dexieResolve(),e.length>0?d(\"MAWWritePeerMsgReceiptsApi\").prepareReceiptsForMeToWrite(a,e):d(\"MAWDexieTable\").dexieResolve([])]).then(function(a){var b=a[0],c=a[1];a=a[2];if(b==null)return{incomingReceiptData:c,processedPeerReceiptsNotForMeResults:a};var d=b.toDelete;b=b.toUpdate;return{appDataReceipts:{toDelete:d,toUpdate:b},incomingReceiptData:c,processedPeerReceiptsNotForMeResults:a}})}b=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor({appData:(a=d(\"MAWTransactionMode\")).READWRITE,chunk:a.READONLY,contacts:a.READONLY,media:a.READONLY,messages:a.READWRITE,participants:a.READWRITE,pendingReceipts:a.READWRITE,receipts:a.READWRITE,threads:a.READWRITE,unrenderedMessages:a.READWRITE,xma:a.READONLY},\"bulkWriteReceipts\",function(a){return function(b){return b.length===0?d(\"MAWDexieTable\").dexieResolve():h(a,b).then(function(b){var c=b.appDataReceipts,e=b.incomingReceiptData;b=b.processedPeerReceiptsNotForMeResults;return d(\"MAWDexieTable\").dexieAll([c!=null&&(c==null?void 0:c.toDelete.length)>0&&(c==null?void 0:c.toUpdate.length)>0?d(\"MAWWriteAppDataReceiptsApi\").writeBulkAppDataReceipts(a,c):d(\"MAWDexieTable\").dexieResolve(),e!=null?d(\"MAWIncomingReceiptTxns\").bulkHandleIncomingReceipts(a,e):d(\"MAWDexieTable\").dexieResolve(),b.length>0?d(\"MAWWritePeerMsgReceiptsApi\").bulkWritePeerReceiptsForMsgsNotFromMeInternal(a,b):d(\"MAWDexieTable\").dexieResolve()]).then(function(){})})}});g.bulkWriteReceipts=b}),98);\n__d(\"MAWSharedProtocolQueueReceipt\",[\"MAWGlobals\",\"MAWSharedOfflineResumeUINotifier\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a){if(a.receiptType===\"appdata\")return{params:{externalIds:a.externalIds,receivers:[a.from]},type:\"appdata\"};var b,c,d=a.chat;switch(a.receiptType){case\"user\":c=a.externalIds;b=[{device:a.from.author,ts:a.ts}];break;case\"group\":c=a.externalIds;b=[{device:a.from.author,ts:a.ts}];break;default:a.receiptType;c=[a.externalId];b=a.receivers;break}var e=a.messageAuthor;a=a.type;if(e===\"@me\"||a===\"sender\")return{params:{msgs:c.map(function(a){return{author:\"@me\",chat:d,externalId:a}}),receivers:b,type:a},type:\"msg-receipt\"};else return{params:{msgs:c.map(function(a){return{author:e,chat:d,externalId:a}}),receivers:b,type:a},type:\"not-from-me\"}}function a(a,b){var c=a.map(function(a){a=h(a.receipt);return a});d(\"MAWSharedOfflineResumeUINotifier\").offlineResumeUINotifier.addMAWEntity(c.length);d(\"MAWGlobals\").getOfflineResumeStats().addMAWEntity(c.length);return b(c).then(function(){return{followUpParams:void 0,toAck:a.map(function(a){return a.stanzaQueueId})}})}g.sharedHandleIncomingReceiptStanza=a}),98);\n__d(\"MAWProtocolQueueReceipt\",[\"MAWBulkWriteReceiptsApi\",\"MAWSharedProtocolQueueReceipt\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return d(\"MAWSharedProtocolQueueReceipt\").sharedHandleIncomingReceiptStanza(a,d(\"MAWBulkWriteReceiptsApi\").bulkWriteReceipts)}g.handleIncomingReceiptStanza=a}),98);\n__d(\"MAWGetActiveThreadIdsApi\",[\"CurrentEnvironment\",\"MAWGlobals\",\"MAWTransactionMode\",\"MAWTransactor\",\"MessengerWebInitData\",\"Promise\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=d(\"MAWTransactor\").makeMsgrTransactor({threads:d(\"MAWTransactionMode\").READONLY},\"getChatJidsForThreadKeys\",function(a){return function(b){return a.threads.where(\"authoritativeThreadKey\").anyOf(b).toArray().then(function(a){return a.map(function(a){a=a.jid;return a})})}});function a(){return j.apply(this,arguments)}function j(){j=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){if(!c(\"CurrentEnvironment\").facebookdotcom&&!c(\"CurrentEnvironment\").messengerdotcom)return[];var a=c(\"MessengerWebInitData\").activeThreadKeys,b=d(\"MAWGlobals\").getMAWActiveChatThreadKey();a=(yield i([].concat(a,[b]).filter(Boolean)));return Array.from(new Set(a).values())});return j.apply(this,arguments)}function e(a){return k.apply(this,arguments)}function k(){k=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(!a)return(h||(h=b(\"Promise\"))).resolve([]);var e=new Set(a);a=c(\"MessengerWebInitData\").activeThreadKeys;var f=d(\"MAWGlobals\").getMAWActiveChatThreadKey();a=(yield i([].concat(a,[f]).filter(Boolean)));return a.filter(function(a){return e.has(a)})});return k.apply(this,arguments)}f=function(){var a=c(\"MessengerWebInitData\").activeThreadKeys;return i(a)};var l=function(a){return i([a])},m=function(){var a=d(\"MAWGlobals\").getMAWActiveChatThreadKey();return a!=null?l(a):(h||(h=b(\"Promise\"))).resolve([])};g.fetchActiveChatJids=a;g.filterActiveChatJids=e;g.getActiveChatJids=f;g.getActiveChatJidsFromThreadKey=l;g.getActiveChatJidsFromMessenger=m}),98);\n__d(\"MAWSharedRestoreUnavailableMessages\",[\"LSMEBTaskCreationSource\",\"MAWBridgeEventTransmitter\",\"WAJids\",\"setTimeout\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=1e4,i=new Map();function a(a){for(var a=a,b=Array.isArray(a),e=0,a=b?a:a[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var f;if(b){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}var g=f;if(g.type===\"message\"&&(g.message.decrypted.type===\"IncomingCiphertextMsg\"||g.message.decrypted.type===\"UnavailableMsg\")){f=function(){var a=g.message.decrypted.id,b=a.externalId;if(i.get(b))return\"continue\";else i.set(b,!0),c(\"setTimeout\")(function(){var e=a.chat;d(\"MAWBridgeEventTransmitter\").issuePointQueryOutsideTxn(b,d(\"WAJids\").threadIdForChatJid(e),void 0,c(\"LSMEBTaskCreationSource\").EB_POINT_QUERY_RETRY_DECRYPTION_FAILURES,e)},h)}();if(f===\"continue\")continue}}}g.restoreUnavailableMessages=a}),98);\n__d(\"MAWSharedCOPHandler\",[\"$InternalEnum\",\"MAWDbStaleQueue\",\"MAWGetActiveThreadIdsApi\",\"MAWProtocolQueueUtils\",\"MAWQplProxy\",\"MAWSharedCOPLogger\",\"MAWSharedOfflineResumeUINotifier\",\"MAWSharedRestoreUnavailableMessages\",\"Promise\",\"WAPREList\",\"WAProtocolQueue\",\"WAProtocolQueueState\",\"WAResultOrError\",\"WAWaterFlow\",\"asyncToGeneratorRuntime\",\"justknobx\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Processed \",\" stanzas. Exhausted: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Blocking end\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Blocking start\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Early flush end\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Active chat process failed \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"High pri start\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Empty queue\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Active chat process failed: \",\"\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Maximum attempts reached. Failing all \",\" stanzas.\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[failAck] Cannot ack from MAWConsumer: \",\"\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed processing \",\" items\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[ackProtocols] Cannot ack from MAWConsumer: \",\"\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received object is not an error: \",\", \",\"\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Runtime error while processing stanzas batch. \",\"\"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Quota exceeded while processing stanzas batch. \",\"\"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" stanzas. Config:\",\"\"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Processed \",\" stanzas. Exhausted: \",\"\"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Cannot process batch: \",\", \",\"\"]);z=function(){return a};return a}var A=c(\"justknobx\")._(\"1265\"),B=c(\"justknobx\")._(\"2294\");f=b(\"$InternalEnum\").Mirrored([\"PERSIST\",\"PERSIST_FAIL\",\"FOLLOW_UP\",\"PROCESS_RETRIES\"]);function C(a,b){return D.apply(this,arguments)}function D(){D=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){var e=(yield d(\"WAProtocolQueueState\").where(a));if(e.length===0)return{exhausted:!0,handled:0};c(\"MAWSharedCOPLogger\").LOG(x(),e.length,a);var f=d(\"WAWaterFlow\").makeWaterflow(\"consumer\",d(\"WAPREList\").PRE_METRIC.PROTOCOL_QUEUE_CONSUMER).startMetric();d(\"MAWSharedRestoreUnavailableMessages\").restoreUnavailableMessages(e);var g;try{g=(yield b(e,f))}catch(a){if(N(a)){c(\"MAWSharedCOPLogger\").ERROR(w(),a);f.endFail(\"quota_exceeded\");return{exhausted:!0,handled:0}}c(\"MAWSharedCOPLogger\").ERROR(v(),a.message);var h=\"not-an-error\";try{h=a.message}catch(b){c(\"MAWSharedCOPLogger\").ERROR(u(),a,b)}g=d(\"WAResultOrError\").makeError(h)}g.success===!0?(h=g.value.toAck,f.endSuccess()):(h=[],f.endFail(\"fail_process_entity\"));yield d(\"WAProtocolQueueState\").ackProtocols(h)[\"catch\"](function(a){return c(\"MAWSharedCOPLogger\").ERROR(t(),a)});if(h.length>=e.length)return{exhausted:!1,handled:h.length};c(\"MAWSharedCOPLogger\").WARN(s(),e.length-h.length);var i=new Set(h);f=e.filter(function(a){return i.has(a.stanzaQueueId)===!1}).map(function(a){return a.stanzaQueueId});var j=(yield d(\"MAWProtocolQueueUtils\").failAck(f)[\"catch\"](function(a){c(\"MAWSharedCOPLogger\").ERROR(r(),a)}));if(j===!0){yield d(\"WAProtocolQueueState\").deleteQueueIDs(e.map(function(a){return a.stanzaQueueId}));c(\"MAWSharedCOPLogger\").ERROR(q(),e.length);return{exhausted:!1,handled:f.length}}if(a.limit===1){yield d(\"WAProtocolQueueState\").deleteQueueIDs(e.map(function(a){return a.stanzaQueueId}));yield d(\"MAWDbStaleQueue\").add(e,g.success?\"not-processed\":(j=g.error)!=null?j:\"runtime\");return{exhausted:!1,handled:1}}else{return{exhausted:!1,handled:h.length+(yield C(babelHelpers[\"extends\"]({},a,{limit:Math.ceil(((f=a.limit)!=null?f:A)\/2)}),b)).handled}}});return D.apply(this,arguments)}function a(a){return E.apply(this,arguments)}function E(){E=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=a.processEntries;var b=d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(25300082,\"2258\"));try{a=(yield C({limit:B},a));var e=a.exhausted;a=a.handled;b.endSuccess({\"int\":{size:a}});return{exhausted:e}}catch(a){b.endFail(\"runtime\",{string:{error:a.message}});return{exhausted:!1}}});return E.apply(this,arguments)}function F(a){return G.apply(this,arguments)}function G(){G=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var e=a.processEntries;a=(yield d(\"MAWGetActiveThreadIdsApi\").fetchActiveChatJids());a=(yield (h||(h=b(\"Promise\"))).allSettled(a.map(function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){yield K({config:{jid:a,limit:A,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh},processEntries:e}),d(\"MAWSharedOfflineResumeUINotifier\").offlineResumeUINotifier.notifyUIChatReady(a)});return function(b){return a.apply(this,arguments)}}())));a.forEach(function(a){a.status===\"rejected\"&&c(\"MAWSharedCOPLogger\").ERROR(p(),a.reason)})});return G.apply(this,arguments)}function H(a){return I.apply(this,arguments)}function I(){I=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=a.processEntries;yield K({config:{limit:A,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh},processEntries:a})});return I.apply(this,arguments)}function e(a){return J.apply(this,arguments)}function J(){J=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b=a.processEntries;a=a.pubSub;var e=(yield d(\"WAProtocolQueueState\").where({limit:1,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh}));if(e==null||e.length===0){c(\"MAWSharedCOPLogger\").LOG(o());return}c(\"MAWSharedCOPLogger\").LOG(n());a.publish({type:\"maw-infra-start\"});a.publish({stage:\"start\",type:\"maw-early-flush\"});yield F({processEntries:b})[\"catch\"](function(a){return c(\"MAWSharedCOPLogger\").ERROR(m(),a)});a.publish({stage:\"end\",type:\"maw-early-flush\"});c(\"MAWSharedCOPLogger\").LOG(l());c(\"MAWSharedCOPLogger\").LOG(k());a.publish({stage:\"start\",type:\"maw-blocking-priority\"});yield H({processEntries:b});a.publish({stage:\"end\",type:\"maw-blocking-priority\"});c(\"MAWSharedCOPLogger\").LOG(j())});return J.apply(this,arguments)}function K(a){return L.apply(this,arguments)}function L(){L=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b=a.config;a=a.processEntries;var d;while((d=(yield C(b,a))).exhausted===!1)c(\"MAWSharedCOPLogger\").LOG(i(),d.handled,d.exhausted)});return L.apply(this,arguments)}var M=function a(b,d){var e=babelHelpers[\"extends\"]({limit:A},b);return C(e,d)[\"catch\"](function(a){c(\"MAWSharedCOPLogger\").ERROR(z(),a,a.message);return{exhausted:!1,handled:0}}).then(function(e){var f=e.exhausted;e=e.handled;c(\"MAWSharedCOPLogger\").LOG(y(),e,f);if(f===!1)return a(b,d)})},N=function(a){return a.name===\"QuotaExceededError\"||a.inner&&a.inner.name===\"QuotaExceededError\"};g.ConsumerProcessingStages=f;g.copHandleLowPri=a;g.copHandleActiveChat=F;g.copHandleHighPri=H;g.copHandleHighPriOffline=e;g.processFromProtocolQueue=M;g.isQuotaExceededError=N}),98);\n__d(\"MAWBulkGetAppDataForRetryApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=30*d(\"WATimeUtils\").DAY_SECONDS;a=d(\"MAWIndexedDb\").makeMsgrTransactor({appData:d(\"MAWTransactionMode\").READONLY},\"bulkGetAppDataForRetry\",function(a){return function(b){var c=b.map(function(a){a=a.externalId;return a});return a.appData.where(\"externalId\").anyOf(c).toArray().then(function(a){var c=new Map(a.map(function(a){return[a.externalId,a]}));return b.map(function(a){var b=a.deviceJid;a=a.externalId;a=c.get(a);if(a==null)return{type:\"missing\"};b=a.permittedIdentitiesPerDevice.get(b);return b==null||!d(\"WATimeUtils\").happenedWithin(a.ts,h)?{type:\"unauthorized\"}:{appData:a.contents,deviceIdentity:b,permittedIdentitiesPerDevice:a.permittedIdentitiesPerDevice,type:\"unacked\"}})})}});g.bulkGetAppDataForRetry=a}),98);\n__d(\"WAGetCurrentUserDeviceInfoApi\",[\"WAGlobals\",\"WASignalKeys\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){return d(\"WAGlobals\").getDbImpls().getMeta().then(function(a){var b=a==null?void 0:a.deviceId;a=a==null?void 0:a.identityKeyPair;if(b==null||a==null)return null;a=d(\"WASignalKeys\").serializePubKey(a);return{deviceId:b,identityKey:a}})};g.getCurrentUserDeviceInfo=a}),98);\n__d(\"WASmaxInAppdataPublishAckMixin\",[\"WAResultOrError\",\"WASmaxParseReference\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"ack\");if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"to\"]);if(!c.success)return c;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"from\",c.value);if(!c.success)return c;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"class\",\"appdata\");if(!c.success)return c;b=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"id\"]);if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"id\",b.value);if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);return!b.success?b:d(\"WAResultOrError\").makeResult({\"class\":c.value,t:b.value})}g.parseAckMixin=a}),98);\n__d(\"WASmaxInAppdataPublishPeerResponseNegative\",[\"WAResultOrError\",\"WASmaxInAppdataPublishAckMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"ack\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").attrString(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInAppdataPublishAckMixin\").parseAckMixin(a,b);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({error:c.value},a.value))}g.parsePeerResponseNegative=a}),98);\n__d(\"WASmaxInAppdataPublishDeviceListStaleMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"ack\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"phash\");return!b.success?b:d(\"WAResultOrError\").makeResult({phash:b.value})}g.parseDeviceListStaleMixin=a}),98);\n__d(\"WASmaxInAppdataPublishPeerResponseSuccess\",[\"WAResultOrError\",\"WASmaxInAppdataPublishAckMixin\",\"WASmaxInAppdataPublishDeviceListStaleMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"ack\");if(!c.success)return c;c=d(\"WASmaxInAppdataPublishAckMixin\").parseAckMixin(a,b);if(!c.success)return c;b=d(\"WASmaxInAppdataPublishDeviceListStaleMixin\").parseDeviceListStaleMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},c.value,{deviceListStaleMixin:b.success?b.value:null}))}g.parsePeerResponseSuccess=a}),98);\n__d(\"WASmaxOutAppdataPublishDeviceIdentityMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.deviceIdentityElementValue;a=d(\"WASmaxJsx\").smax(\"smax$any\",null,d(\"WASmaxJsx\").smax(\"device-identity\",null,a));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeDeviceIdentityMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishInternalTestMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.testConfig;a=d(\"WASmaxJsx\").smax(\"appdata\",null,d(\"WASmaxJsx\").smax(\"test\",{config:d(\"WAWap\").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeInternalTestMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishRequestIDMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.requestIdElementValue;a=d(\"WASmaxJsx\").smax(\"trace\",null,d(\"WASmaxJsx\").smax(\"request_id\",null,a));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeRequestIDMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishTraceIDMixin\",[\"WASmaxChildren\",\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.edgeIdElementValue;a=d(\"WASmaxJsx\").smax(\"edge_id\",null,a);return a}function i(a){var b=a.edgeIdArgs;a=a.traceIdElementValue;a=d(\"WASmaxJsx\").smax(\"trace\",null,d(\"WASmaxJsx\").smax(\"trace_id\",null,a),d(\"WASmaxChildren\").OPTIONAL_CHILD(h,b));return a}function a(a,b){b=i(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.makeTraceIDEdgeId=h;g.mergeTraceIDMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishRequestOrTraceIDMixinGroup\",[\"WASmaxMixinGroupExhaustiveError\",\"WASmaxOutAppdataPublishRequestIDMixin\",\"WASmaxOutAppdataPublishTraceIDMixin\"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.requestID)return d(\"WASmaxOutAppdataPublishRequestIDMixin\").mergeRequestIDMixin(a,b.requestID);if(b.traceID)return d(\"WASmaxOutAppdataPublishTraceIDMixin\").mergeTraceIDMixin(a,b.traceID);throw new(d(\"WASmaxMixinGroupExhaustiveError\").SmaxMixinGroupExhaustiveError)()}g.mergeRequestOrTraceIDMixinGroup=a}),98);\n__d(\"WASmaxOutAppdataPublishTraceContextMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutAppdataPublishRequestOrTraceIDMixinGroup\"],(function(a,b,c,d,e,f,g){function h(a){a=a.requestOrTraceIDMixinGroupArgs;a=d(\"WASmaxJsx\").smax(\"smax$any\",null,d(\"WASmaxOutAppdataPublishRequestOrTraceIDMixinGroup\").mergeRequestOrTraceIDMixinGroup(d(\"WASmaxJsx\").smax(\"trace\",null),a));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeTraceContextMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishWithDeviceListCheckMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.appdataDeviceListCheck;a=d(\"WASmaxJsx\").smax(\"appdata\",{device_list_check:d(\"WAWap\").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeWithDeviceListCheckMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishBaseMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutAppdataPublishDeviceIdentityMixin\",\"WASmaxOutAppdataPublishInternalTestMixin\",\"WASmaxOutAppdataPublishTraceContextMixin\",\"WASmaxOutAppdataPublishWithDeviceListCheckMixin\"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.deviceIdentityMixinArgs,e=a.withDeviceListCheckMixinArgs,f=a.internalTestMixinArgs;a=a.traceContextMixinArgs;b=(b=d(\"WASmaxMixins\")).optionalMerge(d(\"WASmaxOutAppdataPublishTraceContextMixin\").mergeTraceContextMixin,b.optionalMerge(d(\"WASmaxOutAppdataPublishInternalTestMixin\").mergeInternalTestMixin,b.optionalMerge(d(\"WASmaxOutAppdataPublishWithDeviceListCheckMixin\").mergeWithDeviceListCheckMixin,b.optionalMerge(d(\"WASmaxOutAppdataPublishDeviceIdentityMixin\").mergeDeviceIdentityMixin,d(\"WASmaxJsx\").smax(\"appdata\",null),c),e),f),a);return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeBaseMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishEncPayloadMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.encElementValue;a=d(\"WASmaxJsx\").smax(\"enc\",null,a);return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeEncPayloadMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishEncTypeIndividualMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutAppdataPublishEncPayloadMixin\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.encType;b=d(\"WASmaxOutAppdataPublishEncPayloadMixin\").mergeEncPayloadMixin(d(\"WASmaxJsx\").smax(\"enc\",{type:d(\"WAWap\").CUSTOM_STRING(b)}),a);return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeEncTypeIndividualMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishEncVersionFutureproofMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.encV;a=d(\"WASmaxJsx\").smax(\"enc\",{v:d(\"WAWap\").INT(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeEncVersionFutureproofMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishPeerPeerFanoutMixin\",[\"WASmaxChildren\",\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutAppdataPublishEncTypeIndividualMixin\",\"WASmaxOutAppdataPublishEncVersionFutureproofMixin\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.toJid,c=a.encVersionFutureproofMixinArgs;a=a.encTypeIndividualMixinArgs;b=d(\"WASmaxJsx\").smax(\"to\",{jid:d(\"WAWap\").DEVICE_JID(b)},d(\"WASmaxOutAppdataPublishEncTypeIndividualMixin\").mergeEncTypeIndividualMixin(d(\"WASmaxOutAppdataPublishEncVersionFutureproofMixin\").mergeEncVersionFutureproofMixin(d(\"WASmaxJsx\").smax(\"enc\",null),c),a));return b}function i(a){var b=a.toArgs;a=a.appdataTo;a=d(\"WASmaxJsx\").smax(\"appdata\",{to:d(\"WAWap\").USER_JID(a)},d(\"WASmaxJsx\").smax(\"participants\",null,d(\"WASmaxChildren\").REPEATED_CHILD(h,b,1,24)));return a}function a(a,b){b=i(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.makePeerPeerFanoutParticipantsTo=h;g.mergePeerPeerFanoutMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishEncRetryMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.encCount;a=d(\"WASmaxJsx\").smax(\"enc\",{count:d(\"WAWap\").INT(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeEncRetryMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishRetryMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutAppdataPublishEncRetryMixin\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.appdataT;a=a.encRetryMixinArgs;b=d(\"WASmaxJsx\").smax(\"appdata\",{t:d(\"WAWap\").INT(b)},d(\"WASmaxOutAppdataPublishEncRetryMixin\").mergeEncRetryMixin(d(\"WASmaxJsx\").smax(\"enc\",null),a));return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeRetryMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishPeerPeerSingleMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutAppdataPublishEncTypeIndividualMixin\",\"WASmaxOutAppdataPublishEncVersionFutureproofMixin\",\"WASmaxOutAppdataPublishRetryMixin\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.appdataTo,c=a.retryMixinArgs,e=a.encVersionFutureproofMixinArgs;a=a.encTypeIndividualMixinArgs;b=d(\"WASmaxMixins\").optionalMerge(d(\"WASmaxOutAppdataPublishRetryMixin\").mergeRetryMixin,d(\"WASmaxJsx\").smax(\"appdata\",{to:d(\"WAWap\").DEVICE_JID(b)},d(\"WASmaxOutAppdataPublishEncTypeIndividualMixin\").mergeEncTypeIndividualMixin(d(\"WASmaxOutAppdataPublishEncVersionFutureproofMixin\").mergeEncVersionFutureproofMixin(d(\"WASmaxJsx\").smax(\"enc\",null),e),a)),c);return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergePeerPeerSingleMixin=a}),98);\n__d(\"WASmaxOutAppdataPublishPeerPeerFanoutOrPeerSingleMixinGroup\",[\"WASmaxMixinGroupExhaustiveError\",\"WASmaxOutAppdataPublishPeerPeerFanoutMixin\",\"WASmaxOutAppdataPublishPeerPeerSingleMixin\"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.peerPeerFanout)return d(\"WASmaxOutAppdataPublishPeerPeerFanoutMixin\").mergePeerPeerFanoutMixin(a,b.peerPeerFanout);if(b.peerPeerSingle)return d(\"WASmaxOutAppdataPublishPeerPeerSingleMixin\").mergePeerPeerSingleMixin(a,b.peerPeerSingle);throw new(d(\"WASmaxMixinGroupExhaustiveError\").SmaxMixinGroupExhaustiveError)()}g.mergePeerPeerFanoutOrPeerSingleMixinGroup=a}),98);\n__d(\"WASmaxOutAppdataPublishPeerRequest\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WASmaxOutAppdataPublishBaseMixin\",\"WASmaxOutAppdataPublishPeerPeerFanoutOrPeerSingleMixinGroup\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=a.appdataId,c=a.appdataPushPriority,e=a.peerPeerFanoutOrPeerSingleMixinGroupArgs;b=d(\"WASmaxOutAppdataPublishPeerPeerFanoutOrPeerSingleMixinGroup\").mergePeerPeerFanoutOrPeerSingleMixinGroup(d(\"WASmaxOutAppdataPublishBaseMixin\").mergeBaseMixin(d(\"WASmaxJsx\").smax(\"appdata\",{id:d(\"WAWap\").STANZA_ID(b),category:\"peer\",push_priority:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").CUSTOM_STRING,c)}),a),e);return b}g.makePeerRequest=a}),98);\n__d(\"WASmaxAppdataPublishPeerRPC\",[\"WAComms\",\"WASmaxInAppdataPublishPeerResponseNegative\",\"WASmaxInAppdataPublishPeerResponseSuccess\",\"WASmaxOutAppdataPublishPeerRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:e=d(\"WASmaxOutAppdataPublishPeerRequest\").makePeerRequest(a);i.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(e,c));case 3:f=i.sent;g=d(\"WASmaxInAppdataPublishPeerResponseNegative\").parsePeerResponseNegative(f,e);if(!g.success){i.next=7;break}return i.abrupt(\"return\",{name:\"PeerResponseNegative\",value:g.value});case 7:h=d(\"WASmaxInAppdataPublishPeerResponseSuccess\").parsePeerResponseSuccess(f,e);if(!h.success){i.next=10;break}return i.abrupt(\"return\",{name:\"PeerResponseSuccess\",value:h.value});case 10:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Peer\",{Negative:g,Success:h}));case 11:case\"end\":return i.stop()}},null,this)}g.sendPeerRPC=a}),98);\n__d(\"WASendAppDataIndividualProtocol\",[\"WAAsMessageApplication\",\"WAConvertAppData\",\"WAEncUserMsg\",\"WAErrorMessage\",\"WAGetCurrentUserDeviceInfoApi\",\"WAGlobals\",\"WAMsgApplication.pb\",\"WAResultOrError\",\"WASmaxAppdataPublishPeerRPC\",\"WATagsLogger\",\"WATimeUtils\",\"encodeProtobuf\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to send appdata. Error: \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to fetch current device public identity key\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAWSendAppData Failed to encrypt appdata\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Sending appdata, externalId: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to send appdata retry to device with error: \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to send appdata to device with error: \",\"\"]);m=function(){return a};return a}var n=d(\"WATagsLogger\").TAGS([\"sendAppDataIndividual\"]);function a(a,b,c,e,f){return o(a,b,c,void 0,e,f)[\"catch\"](function(a){a=d(\"WAErrorMessage\").maybeGetMessageFromError(a);n.ERROR(m(),a);return d(\"WAResultOrError\").makeError(\"runtime-error\")})}function c(a,b,c,e,f,g){return o(a,b,c,e,f,g)[\"catch\"](function(a){a=d(\"WAErrorMessage\").maybeGetMessageFromError(a);n.ERROR(l(),a);return d(\"WAResultOrError\").makeError(\"runtime-error\")})}function o(a,c,e,f,g,l){var m,o,p,q,r,s,t,u,v,w,x;return b(\"regeneratorRuntime\").async(function(y){while(1)switch(y.prev=y.next){case 0:n.LOG(k(),c);m=d(\"WAConvertAppData\").convertAppData(a);o={bytes:d(\"WAAsMessageApplication\").castToMessageApplicationBytes(d(\"encodeProtobuf\").encodeProtobuf(d(\"WAMsgApplication.pb\").MessageApplicationSpec,m).readByteArray()),version:\"v3\"};y.next=5;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return d(\"WAEncUserMsg\").encryptDeviceJidMessage(e,{messageBytes:o,type:\"appdata\"},{cryptoManager:a},void 0,l,g)},{operationType:\"encrypt\",flush:!0}));case 5:p=y.sent;if(!(p==null)){y.next=9;break}n.LOG(j());return y.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"encrypt-failure\"));case 9:f!=null&&(q={appdataT:d(\"WATimeUtils\").unixTime(),encRetryMixinArgs:{encCount:f}});r={appdataTo:e,encVersionFutureproofMixinArgs:{encV:parseInt(p.v,10)},encTypeIndividualMixinArgs:{encType:p.type,encElementValue:p.ciphertext},retryMixinArgs:q};s={peerPeerSingle:r};t=void 0;if(!(p.type===\"pkmsg\")){y.next=22;break}y.next=16;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCurrentUserDeviceInfoApi\").getCurrentUserDeviceInfo());case 16:u=y.sent;v=u==null?void 0:u.identityKey;if(!(v==null)){y.next=21;break}n.ERROR(i());return y.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"no-public-identity\"));case 21:t={deviceIdentityElementValue:v};case 22:w={appdataId:c,peerPeerFanoutOrPeerSingleMixinGroupArgs:s,deviceIdentityMixinArgs:t};y.next=25;return b(\"regeneratorRuntime\").awrap(d(\"WASmaxAppdataPublishPeerRPC\").sendPeerRPC(w));case 25:x=y.sent;y.t0=x.name;y.next=y.t0===\"PeerResponseSuccess\"?29:30;break;case 29:return y.abrupt(\"return\",d(\"WAResultOrError\").makeResult({baseKey:p.baseKey}));case 30:x.name;n.ERROR(h(),x.value.error);return y.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"ack-failure\"));case 33:case\"end\":return y.stop()}},null,this)}g.sendAppDataToIndividualDeviceProtocol=a;g.sendAppDataRetryToIndividualDeviceProtocol=c}),98);\n__d(\"MAWSharedHandleRetryRequest\",[\"MAWBulkGetAppDataForRetryApi\",\"MAWConstants\",\"MAWGlobals\",\"MAWQplProxy\",\"MAWSharedOfflineResumeUINotifier\",\"Promise\",\"WACryptoManagerUtils\",\"WACryptoUtils\",\"WAGenReportingMeta\",\"WAGlobals\",\"WAJids\",\"WALogger\",\"WASendAppDataIndividualProtocol\",\"WASendMsgUtil\",\"WASentBytesCache\",\"WAWap\",\"asyncToGeneratorRuntime\",\"gkx\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleRetryRequest denied because receipt is null\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleRetryRequest denied because (messageId, deviceJID, retryCount) is already executed for retryCount \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleRetryRequest denied with type \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleRetryRequest denied with type \",\" id: \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"bulkHandleRetryRequest unexpected receipt\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"bulkHandleRetryRequest called for \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown receipt categories: \",\"\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleRetryRequest denied due to retry count\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received retry request from peer without recipient set\"]);q=function(){return a};return a}function r(){var a=0,b=0,c=new Map();return{getMetrics:function(){var d;return{appDataMissing:(d=c.get(\"appDatamissing\"))!=null?d:0,appDataUnauthorized:(d=c.get(\"appDataunauthorized\"))!=null?d:0,appDataUnsupported:(d=c.get(\"appDataunsupported\"))!=null?d:0,msgMissing:(d=c.get(\"msgmissing\"))!=null?d:0,msgUnauthorized:(d=c.get(\"msgunauthorized\"))!=null?d:0,msgUnsupported:(d=c.get(\"msgunsupported\"))!=null?d:0,receiptFailures:b,receiptSuccesses:a}},markError:function(){return b++},markSuccess:function(){return a++},setError:function(a){var b=c.get(a);b!=null?c.set(a,b+1):c.set(a,1)}}}function s(a,b){return b+\"_\"+a}function a(a){return t.apply(this,arguments)}function t(){t=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(a.length===0)return[];d(\"WALogger\").LOG(n(),a.map(function(a){a=a.externalId;return a}).join(\",\"));var e=d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(25308942,\"164\"),{bool:{bulk:!0},\"int\":{receipts:a.length},string:{origin:self.location.origin}}),f=new Set(a.filter(function(a){return a.category!=null&&!C(a)||D(a)}).map(function(a){return a.externalId})),g=a.filter(function(a){return!f.has(a.externalId)&&!C(a)}),i=a.filter(C);i=(yield (h||(h=b(\"Promise\"))).all([u(i),x(g)]));g=i[0];i=i[1];e.addPoint(\"get_msg_for_retry_complete\");var j=[],k=r();for(a of a){var l=g.get(a.externalId),o=i.get(s(a.from.author,a.externalId));f.has(a.externalId)?(e.addPoint(\"just_ack\"),k.markError(),k.setError(\"just_ack\"),E(a)):l!=null?(e.addPoint(\"app_data_for_retry\"),yield F(a,l,e,!1,k),e.addPoint(\"app_data_for_retry_complete\")):o!=null?(e.addPoint(\"msg_for_retry\"),yield H(a,o,e,!1,k),e.addPoint(\"msg_for_retry_complete\")):(d(\"WALogger\").ERROR(m()),k.markError(),k.setError(\"unexpected_receipt\"));j.push(B(a));d(\"MAWSharedOfflineResumeUINotifier\").offlineResumeUINotifier.addMAWEntity(1);d(\"MAWGlobals\").getOfflineResumeStats().addMAWEntity(1)}e.endSuccess({\"int\":babelHelpers[\"extends\"]({},k.getMetrics())});return j});return t.apply(this,arguments)}function u(a){return v.apply(this,arguments)}function v(){v=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(a.length===0)return new Map();var b=a.map(function(a){var b=a.externalId;a=a.from;return{deviceJid:a.author,externalId:b}});b=(yield d(\"MAWBulkGetAppDataForRetryApi\").bulkGetAppDataForRetry(b));return new Map(b.map(function(b,c){c=a[c];return[c.externalId,b]}))});return v.apply(this,arguments)}function w(a){return a.map(function(a){var b=a.externalId,c=a.from,e=a.recipient,f=c.chat;if(c.type===\"device\"&&d(\"WAJids\").extractUserJid(c.author)===d(\"WAJids\").extractUserJid(d(\"MAWGlobals\").getMyDeviceJid())){if(e==null){d(\"WALogger\").ERROR(q());return}f=e}e={author:\"@me\",chat:f,externalId:b};return{deviceJid:c.author,protocolMsgId:e,retryCount:a.retryCount}})}function x(a){return y.apply(this,arguments)}function y(){y=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(a.length===0)return new Map();var b=w(a),c=a.filter(function(a,c){return b[c]!=null}),e=b.filter(Boolean);a=(yield d(\"WASentBytesCache\").sentBytesCache().getMsgsForRetry(e));a=new Map(a.map(function(a,b){return[s(e[b].deviceJid,c[b].externalId),{msgForRetry:a,retryRequest:e[b]}]}));return a});return y.apply(this,arguments)}function z(a,b){return A.apply(this,arguments)}function A(){A=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){var c=void 0,e=(yield d(\"WAGlobals\").getWaOneQueue().enqueue(function(b){b=b.cryptoManager;return d(\"WACryptoManagerUtils\").getParticipantInfo(a.from.author,b)},{flush:!1,operationType:\"get_participant_info\"}));if(a.keys!=null){var f=a.keys,g=a.timestamp;b={baseKey:b.baseKey,keys:f,timestamp:g};f=J(a,e);f?c={session:b,type:\"compareTSAndUseSession\"}:c={session:b,type:\"useSession\"}}else{g=e==null||a.regId!==e.regId;g&&(c={type:\"requestNewSession\"})}return c});return A.apply(this,arguments)}function B(a){var b,c=a.externalId;a=a.from;return(b=d(\"WAWap\")).wap(\"ack\",{\"class\":\"receipt\",id:b.CUSTOM_STRING(c),participant:b.PARTICIPANT_JID(a),to:b.TO_JID(a),type:\"retry\"})}function C(a){a=a.category;return a===\"peer_appdata\"||a===\"peer\"}function D(a){a=a.retryCount;return a>=d(\"MAWConstants\").MESSAGE_RETRY_COUNT_LIMIT}function E(a){if(D(a)){d(\"WALogger\").LOG(p());return}if(a.category!=null){d(\"WALogger\").WARN(o(),a.category);return}}function F(a,b,c,d,e){return G.apply(this,arguments)}function G(){G=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,c,e,f){e===void 0&&(e=!0);var g=a.externalId,h=a.from,i=a.retryCount;c.addPoint(\"get_app_data_for_retry\");if(b.type!==\"unacked\"){d(\"WALogger\").LOG(l(),b.type,g);e?c.endFail(b.type):c.addPoint(b.type);f==null?void 0:f.markError();f==null?void 0:f.setError(\"appData\"+b.type);return}e=b.appData;b=b.deviceIdentity;a=(yield z(a,b));c.addPoint(\"get_session_info\");e=(yield d(\"WASendAppDataIndividualProtocol\").sendAppDataRetryToIndividualDeviceProtocol(e,g,h.author,i,b.pubKey,a));c.addPoint(\"send_app_data\");if(i>=2&&e.success===!0&&e.value.baseKey!=null){b=e.value.baseKey;yield d(\"MAWGlobals\").getDbImpls().writeAppDataRetry(g,h.author,b)}f==null?void 0:f.markSuccess();return e});return G.apply(this,arguments)}function H(a,b,c,d,e){return I.apply(this,arguments)}function I(){I=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,e,f,g){var h;f===void 0&&(f=!0);var l=b.msgForRetry;b=b.retryRequest;var m=a.externalId,n=a.from,o=a.retryCount,p=b.protocolMsgId.chat;if(l.type!==\"unacked\"){f&&e.endFail(l.type);d(\"WALogger\").LOG(k(),l.type);g==null?void 0:g.markError();g==null?void 0:g.setError(\"msg\"+l.type);return}if(l.retryCount!=null&&l.retryCount>0&&l.retryCount===o){f&&e.endFail(\"unauthorized\");d(\"WALogger\").LOG(j(),o);g==null?void 0:g.markError();g==null?void 0:g.setError(\"msgunauthorized\");return}n.type===\"group\"&&(yield d(\"MAWGlobals\").getDbImpls().markParticipantNeedsKey(n.chat,n.author),e.addPoint(\"mark_participant_needs_key_complete\"));var q=l.frankingKey,r=l.frankingVersion,s=l.isInstamadillo,t=l.messageBytes,u=l.messageType,v=l.protocolMsgId,w=(yield d(\"MAWGlobals\").getDbImpls().loadReceipt({author:v.author,chat:v.chat,externalId:v.externalId}).then(function(a){return a.success?a.value:null}));h=w==null?void 0:(h=w.permittedIdentitiesPerDevice)==null?void 0:h.get(b.deviceJid);if(w==null||h==null){f&&e.endFail(\"unauthorized\");d(\"WALogger\").LOG(i());g==null?void 0:g.markError();g==null?void 0:g.setError(\"msgunauthorized\");return}w=(yield z(a,h));e.addPoint(\"get_session_info_complete\");c(\"gkx\")(\"24021\")&&(yield d(\"MAWGlobals\").getDbImpls().writeDebugMsg(p,\"Handling retry request for message: \"+l.protocolMsgId.externalId.toString()+\" to user \"+n.author));f=(yield d(\"WAGenReportingMeta\").genReportingMeta(t.bytes,q,r));a=(yield d(\"WASendMsgUtil\").sendMessage({chat:p,count:o,deviceIdentity:null,externalId:m,identityKey:h.pubKey,messageBytes:t,messageType:u,protocolMsgId:v,reportingMeta:f,sessionInfo:w,to:n.author,type:\"direct\"},null,s));e.addPoint(\"send_message_complete\");if(o>=2&&a.success&&a.value.baseKey!=null){l=a.value.baseKey;yield d(\"MAWGlobals\").getDbImpls().writeMsgRetry(b.protocolMsgId,n.author,l)}o>=1&&a.success&&(yield d(\"MAWGlobals\").getDbImpls().writeMsgRetryCount(b.protocolMsgId,n.author,o));g==null?void 0:g.markSuccess()});return I.apply(this,arguments)}function J(a,b){if(a.offline==null)return!1;var c=b==null||a.regId!==b.regId;b=b!=null&&a.keys!=null&&!d(\"WACryptoUtils\").uint8ArraysEqual(b.pubKey,a.keys.identity);return c||b}g.bulkHandleRetryRequest=a}),98);\n__d(\"MAWSharedProtocolQueueGroupBy\",[\"WAStanzaRootTag\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b=[],c=[],e=[];for(var a=a,f=Array.isArray(a),g=0,a=f?a:a[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var i;if(f){if(g>=a.length)break;i=a[g++]}else{g=a.next();if(g.done)break;i=g.value}i=i;switch(i.type){case\"retryReceipt\":c.push(i);break;case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.APPDATA:e.push(i);break;case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.MESSAGE:h(i,b);break;default:h(i,b)}}return{groupedStanzas:[{items:e,type:d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.APPDATA}].concat(b),retryStanzas:c}}function b(a){var b=new Map();for(var e=0;e<a.length;e++){var f=a[e];switch(f.type){case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.MESSAGE:case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.RECEIPT:case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.NOTIFICATION:case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.APPDATA:var g=b.get(f.jid)||[];g.push(f);b.set(f.jid,g);break;case\"retryReceipt\":default:throw c(\"err\")(\"Got unhandled message type \"+f.type)}}return b}function h(a,b){b.length===0||b[b.length-1].type!==a.type?b.push({items:[a],type:a.type}):b[b.length-1].items.push(a)}g.groupStanzaEntryByOperation=a;g.groupStanzaEntryByChatJid=b}),98);\n__d(\"MAWProtocolQueueProcess\",[\"MAWProtocolQueueAppdata\",\"MAWProtocolQueueDecodeProto\",\"MAWProtocolQueueFollowUps\",\"MAWProtocolQueueInstructions\",\"MAWProtocolQueueMsg\",\"MAWProtocolQueueNotification\",\"MAWProtocolQueueReceipt\",\"MAWProtocolQueueUtils\",\"MAWSharedCOPHandler\",\"MAWSharedHandleRetryRequest\",\"MAWSharedProtocolQueueGroupBy\",\"MAWTransactor\",\"Promise\",\"WAProtocolQueueLogger\",\"WAResultOrError\",\"WAStanzaRootTag\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Error during consumer processing: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Error during retry processing: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Finished processing batch with \",\" items\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Errors occurred while processing batch, see transactor error reports.\\n    persistDataSuccess: \",\", persistedData: \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Got unhandled message type \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Appdata consumer: \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Receipt consumer: \",\"\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Notification consumer: \",\"\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Messages consumer: \",\"\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"instruction consumer: \",\"\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"invoked protocol queue for \",\" entries\"]);s=function(){return a};return a}function t(a){return d(\"MAWSharedHandleRetryRequest\").bulkHandleRetryRequest(a.map(function(a){a=a.retry;return a}))}function a(a,b){return u.apply(this,arguments)}function u(){u=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,c){d(\"WAProtocolQueueLogger\").logger.LOG(s(),a.length);a=d(\"MAWSharedProtocolQueueGroupBy\").groupStanzaEntryByOperation(a);var e=a.groupedStanzas,f=a.retryStanzas;c.annotate({retryStanzasCount:f.length,stanzaGroupsCount:e.length});c.startPoint(d(\"MAWSharedCOPHandler\").ConsumerProcessingStages.PERSIST);var g=d(\"MAWProtocolQueueDecodeProto\").decodeMessageProtoStanzas(e);a=(yield d(\"MAWTransactor\").runInBulkTransaction(function(){return(h||(h=b(\"Promise\"))).allSettled(g.flatMap(function(a){switch(a.type){case\"instruction\":return d(\"MAWProtocolQueueInstructions\").handleInstructions(a.items)[\"catch\"](function(a){d(\"WAProtocolQueueLogger\").logger.ERROR(r(),a);return(h||(h=b(\"Promise\"))).reject(a)});case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.MESSAGE:var c=a.items.map(function(a){return d(\"MAWProtocolQueueUtils\").addMetricToMessage(a)});return d(\"MAWProtocolQueueMsg\").handleIncomingMessagesStanzas(c)[\"catch\"](function(a){d(\"WAProtocolQueueLogger\").logger.ERROR(q(),a);c.forEach(function(a){a=a.receiveFlow;a.endFail(\"consumer_handle_message_db_error\")});return(h||(h=b(\"Promise\"))).reject(a)});case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.NOTIFICATION:return d(\"MAWProtocolQueueNotification\").handleIncomingNotificationStanzas(a.items)[\"catch\"](function(a){d(\"WAProtocolQueueLogger\").logger.ERROR(p(),a);return(h||(h=b(\"Promise\"))).reject(a)});case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.RECEIPT:return d(\"MAWProtocolQueueReceipt\").handleIncomingReceiptStanza(a.items)[\"catch\"](function(a){d(\"WAProtocolQueueLogger\").logger.ERROR(o(),a);return(h||(h=b(\"Promise\"))).reject(a)});case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.APPDATA:return d(\"MAWProtocolQueueAppdata\").handleAppdataStanzas(a.items)[\"catch\"](function(a){d(\"WAProtocolQueueLogger\").logger.ERROR(n(),a);return(h||(h=b(\"Promise\"))).reject(a)});default:a;d(\"WAProtocolQueueLogger\").logger.ERROR(m(),a.type);return(h||(h=b(\"Promise\"))).reject(\"Got unhandled message type \"+a.type)}}))}));c.endPoint(d(\"MAWSharedCOPHandler\").ConsumerProcessingStages.PERSIST);a.forEach(function(a){if(a.status===\"rejected\"&&d(\"MAWSharedCOPHandler\").isQuotaExceededError(a.reason))throw a.reason});e=a.filter(function(a){return a.status===\"fulfilled\"});e.length!==a.length?(d(\"WAProtocolQueueLogger\").logger.WARN(l(),e.length,a.length),c.addPoint(d(\"MAWSharedCOPHandler\").ConsumerProcessingStages.PERSIST_FAIL)):d(\"WAProtocolQueueLogger\").logger.LOG(k(),e.length);a=e.flatMap(function(a){return a.value}).filter(Boolean);var u=a.flatMap(function(a){return(a=a.toAck)!=null?a:[]});c.startPoint(d(\"MAWSharedCOPHandler\").ConsumerProcessingStages.FOLLOW_UP);return d(\"MAWProtocolQueueFollowUps\").processFollowUps(a).then(b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){c.endPoint(d(\"MAWSharedCOPHandler\").ConsumerProcessingStages.FOLLOW_UP);if(f.length>0){c.startPoint(d(\"MAWSharedCOPHandler\").ConsumerProcessingStages.PROCESS_RETRIES);try{yield t(f),u.push.apply(u,f.map(function(a){return a.stanzaQueueId}))}catch(a){d(\"WAProtocolQueueLogger\").logger.ERROR(j(),a)}c.endPoint(d(\"MAWSharedCOPHandler\").ConsumerProcessingStages.PROCESS_RETRIES)}return d(\"WAResultOrError\").makeResult({toAck:u})}))[\"catch\"](function(a){d(\"WAProtocolQueueLogger\").logger.ERROR(i(),a);return d(\"WAResultOrError\").makeResult({toAck:u})})});return u.apply(this,arguments)}g.processProtocolQueueEntries=a}),98);\n__d(\"MAWSharedCOPQueue\",[\"WAPromiseQueue\",\"WAResolvable\",\"WAShiftTimer\",\"promiseDone\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=500;b=function(){function a(){var a=this;this.$1=new(d(\"WAPromiseQueue\").PromiseQueue)();this.$2=new Map();this.$3=new(d(\"WAShiftTimer\").ShiftTimer)(function(){if(a.$2.size===0)return;if(a.$1.size()>0){a.$3.onOrAfter(h);return}var b=a.$2.entries().next().value;if(b==null)return;var d=b[0],e=b[1];c(\"promiseDone\")(a.$1.enqueue(function(){return e.fn().then(function(){a.$2[\"delete\"](d)})}).then(function(){a.$2.size>0&&a.$3.onOrBefore(h)}))})}var b=a.prototype;b.demand=function(a,b){var c=this.$2.get(a);c!=null&&this.$2[\"delete\"](a);return this.$1.enqueue(function(){var a=b();c!=null&&(c==null?void 0:c.resolvable.resolve(a));return a})};b.background=function(a,b){var c=this.$2.get(a);if(c!=null){this.$3.onOrBefore(h);return c.resolvable.promise}var e=new(d(\"WAResolvable\").Resolvable)();this.$2.set(a,{fn:function(b){function a(){return b.apply(this,arguments)}a.toString=function(){return b.toString()};return a}(function(){var a=b();e.resolve(a);return a}),resolvable:e});this.$3.onOrBefore(h);return e.promise};b.wait=function(){return this.$1.wait()};return a}();function a(a){return\"p0-\"+a}e=\"rest\";f=\"messages\";g.COPQueue=b;g.makeChatCopId=a;g.copP1=e;g.copP0=f}),98);\n__d(\"MAWSharedStaleQueueReporter\",[\"MAWDbStaleQueue\",\"MAWQplProxy\",\"asyncToGeneratorRuntime\",\"justknobx\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){return h.apply(this,arguments)}function h(){h=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=(yield d(\"MAWDbStaleQueue\").isEmpty());if(a)return;a=c(\"justknobx\")._(\"1498\");a=(yield d(\"MAWDbStaleQueue\").read(a));var b=a.map(function(a){return[a.dbVersion,a.exception]});d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(1056849770,\"993\"),{\"int\":{count:a.length},string_array:{dbErrors:Array.from(new Set(b.map(function(a){return a[1]}))),dbVersions:Array.from(new Set(b.map(function(a){return\"\"+a[0]})))}}).endSuccess()});return h.apply(this,arguments)}g[\"default\"]=a}),98);\n__d(\"MAWSharedCOP\",[\"CurrentEnvironment\",\"MAWGetActiveThreadIdsApi\",\"MAWSharedCOPHandler\",\"MAWSharedCOPLogger\",\"MAWSharedCOPQueue\",\"MAWSharedOfflineResumeUINotifier\",\"MAWSharedStaleQueueReporter\",\"WAPromiseEach\",\"WAPromiseQueue\",\"WAProtocolQueue\",\"WAProtocolQueueState\",\"WAPubSub\",\"asyncToGeneratorRuntime\",\"gkx\",\"promiseDone\",\"setTimeout\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Active chat process failed \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Online: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"StaleQueue: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"offline COP: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"offline\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"LowPri FATAL: \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"HighPri FATAL: \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"IdleOQ M1: Offline\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Online HighPri FATAL: \",\"\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"IdleOQ M1: online\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Low pri end\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Low priority returned error \",\"\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Low pri start\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Blocking end\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Blocking start\"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Early flush end\"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose([\"ActiveChat: \",\"\"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Early flush start\"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Offline start\"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Empty queue\"]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose([\"online\"]);B=function(){return a};return a}a=function(){function a(a){var e=this;this.$1=\"offline\";this.$2=new(d(\"WAPromiseQueue\").PromiseQueue)();this.$4=d(\"WAPubSub\").simplePubSub();this.$6=new(d(\"MAWSharedCOPQueue\").COPQueue)();this.processOnlineProtocolEntries=function(){c(\"MAWSharedCOPLogger\").LOG(B());return d(\"MAWSharedCOPHandler\").processFromProtocolQueue({},e.$5)};this.processOfflineProtocolEntries=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=(yield d(\"WAProtocolQueueState\").isProtocolQueueEmpty());if(a){c(\"MAWSharedCOPLogger\").LOG(A());return}c(\"MAWSharedCOPLogger\").LOG(z());e.$4.publish({type:\"maw-infra-start\"});c(\"MAWSharedCOPLogger\").LOG(y());e.$4.publish({participantsRaceCondition:e.$3==null,stage:\"start\",type:\"maw-early-flush\"});yield e.$8()[\"catch\"](function(a){return c(\"MAWSharedCOPLogger\").ERROR(x(),a)});e.$4.publish({participantsRaceCondition:e.$3==null,stage:\"end\",type:\"maw-early-flush\"});c(\"MAWSharedCOPLogger\").LOG(w());c(\"MAWSharedCOPLogger\").LOG(v());e.$4.publish({stage:\"start\",type:\"maw-blocking-priority\"});yield d(\"MAWSharedCOPHandler\").processFromProtocolQueue({priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh},e.$5);e.$4.publish({stage:\"end\",type:\"maw-blocking-priority\"});c(\"MAWSharedCOPLogger\").LOG(u());c(\"MAWSharedCOPLogger\").LOG(t());e.$4.publish({stage:\"start\",type:\"maw-low-priority\"});yield d(\"MAWSharedCOPHandler\").processFromProtocolQueue({},e.$5)[\"catch\"](function(a){return c(\"MAWSharedCOPLogger\").ERROR(s(),a)});e.$4.publish({stage:\"end\",type:\"maw-low-priority\"});c(\"MAWSharedCOPLogger\").LOG(r())});this.$5=a}var e=a.prototype;e.onlineProcessing=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=this;c(\"MAWSharedCOPLogger\").LOG(q());yield this.$6.demand(d(\"MAWSharedCOPQueue\").copP0,function(){return d(\"MAWSharedCOPHandler\").copHandleHighPri({processEntries:a.$5})})[\"catch\"](function(a){c(\"MAWSharedCOPLogger\").ERROR(p(),a)});this.scheduleLowPriority()});function e(){return a.apply(this,arguments)}return e}();e.handleHighPriorityOffline=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=this;c(\"MAWSharedCOPLogger\").LOG(o());try{yield this.$6.demand(d(\"MAWSharedCOPQueue\").copP0,b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){yield d(\"MAWSharedCOPHandler\").copHandleHighPriOffline({processEntries:a.$5,pubSub:a.$4}),a.$4.publish({success:!0,type:\"maw-infra-end\"})}))}catch(a){c(\"MAWSharedCOPLogger\").ERROR(n(),a),this.$4.publish({success:!1,type:\"maw-infra-end\"})}});function e(){return a.apply(this,arguments)}return e}();e.scheduleLowPriority=function(){var a=this,e=null;this.$6.background(d(\"MAWSharedCOPQueue\").copP1,b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){e=(yield d(\"MAWSharedCOPHandler\").copHandleLowPri({processEntries:a.$5}))}))[\"catch\"](function(a){c(\"MAWSharedCOPLogger\").ERROR(m(),a)})[\"finally\"](function(){(e==null||e.exhausted===!1)&&a.scheduleLowPriority()})};e.$7=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=this;c(\"MAWSharedCOPLogger\").LOG(l());c(\"gkx\")(\"1559\")?(this.scheduleLowPriority(),yield this.handleHighPriorityOffline()):yield this.$2.enqueue(this.processOfflineProtocolEntries).then(function(){a.$4.publish({success:!0,type:\"maw-infra-end\"})})[\"catch\"](function(b){c(\"MAWSharedCOPLogger\").ERROR(k(),b.message),a.$4.publish({success:!1,type:\"maw-infra-end\"})});c(\"setTimeout\")(function(){c(\"MAWSharedStaleQueueReporter\")()[\"catch\"](function(a){c(\"MAWSharedCOPLogger\").ERROR(j(),a)})},1e3)});function d(){return a.apply(this,arguments)}return d}();e.subscribeToOfflineQueue=function(a,b){var d=this;a.subscribe(function(a){switch(a.type){case\"offline-start\":d.$1=\"offline\";break;case\"offline-end\":d.$1=\"online\";c(\"promiseDone\")(d.$7());break;default:a.type;break}});b.subscribe(function(a){switch(a.type){case\"flush\":if(d.$1!==\"online\")return;c(\"gkx\")(\"1559\")?c(\"promiseDone\")(d.onlineProcessing()):d.$2.enqueue(d.processOnlineProtocolEntries)[\"catch\"](function(a){c(\"MAWSharedCOPLogger\").ERROR(i(),a.message)});return}})};e.notifyEb=function(a,b){if(!a)return;this.$4.publish({offlineStage:a,stage:b,type:\"eb\"})};e.subscribe=function(a){return this.$4.subscribe(a)};e.$8=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=this;if(!c(\"CurrentEnvironment\").facebookdotcom&&!c(\"CurrentEnvironment\").messengerdotcom)return;try{var b=(yield d(\"MAWGetActiveThreadIdsApi\").filterActiveChatJids(this.$3));yield d(\"WAPromiseEach\").promiseEach(b,function(b){return d(\"MAWSharedCOPHandler\").processFromProtocolQueue({jid:b,priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityHigh},a.$5).then(function(){d(\"MAWSharedOfflineResumeUINotifier\").offlineResumeUINotifier.notifyUIChatReady(b)})})}catch(a){c(\"MAWSharedCOPLogger\").ERROR(h(),a)}});function e(){return a.apply(this,arguments)}return e}();e.handleThreadMetadata=function(a){this.$3=a.map(function(a){return a.from}),d(\"MAWSharedOfflineResumeUINotifier\").offlineResumeUINotifier.setThreadMetadata(a)};e.wait=function(){return this.$2.wait()};e.TEST_ONLY_setMode=function(a){this.$1=a};e.TEST_ONLY_getMode=function(){return this.$1};return a}();g.COP=a}),98);\n__d(\"MAWCOP\",[\"MAWProtocolQueueProcess\",\"MAWSharedCOP\"],(function(a,b,c,d,e,f,g){\"use strict\";a=new(d(\"MAWSharedCOP\").COP)(d(\"MAWProtocolQueueProcess\").processProtocolQueueEntries);g.cop=a}),98);\n__d(\"MAWHandleThreadMetadata\",[\"MAWBridge\",\"MAWCOP\",\"Promise\",\"WALogger\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Handle thread metadata: \",\"}\"]);i=function(){return a};return a}a=function(a){d(\"WALogger\").DEV(i(),JSON.stringify(a));c(\"gkx\")(\"23944\")&&d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"uiUpdate\",{events:[{tag:\"COPDigestReceived\",value:a}]});d(\"MAWCOP\").cop.handleThreadMetadata(a);return(h||(h=b(\"Promise\"))).resolve(\"NO_ACK\")};g.handleThreadMetadata=a}),98);\n__d(\"WAHandleErrorStanza\",[\"Promise\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Invalid stanza sent (smax-invalid)\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown error code: \",\"\"]);j=function(){return a};return a}a=function(a){a=a.code;d(\"WALogger\").ERROR(j(),a).sendLogs(\"unknown-error-code\");return(h||(h=b(\"Promise\"))).resolve(\"NO_ACK\")};c=function(){d(\"WALogger\").ERROR(i()).devConsole(\"check tracelogs for more info\").sendLogs(\"smax-invalid\");return(h||(h=b(\"Promise\"))).resolve(\"NO_ACK\")};g.handleErrorStanza=a;g.handleSmaxErrorStanza=c}),98);\n__d(\"WASetRoutingInfoApi\",[\"WAGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){return d(\"WAGlobals\").getDbImpls().setMeta({edgeInfo:(a=a.edgeInfo)!=null?a:void 0})};g.setRoutingInfo=a}),98);\n__d(\"WAHandleInfoBulletin\",[\"Promise\",\"WACryptoUtils\",\"WAGetRoutingInfoApi\",\"WAGlobals\",\"WALogger\",\"WASetRoutingInfoApi\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Error while processing <offline> \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleInfoBulletin setting edge info\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleInfoBulletin no change to edge info\"]);k=function(){return a};return a}function a(a){var b=a.edgeInfo;return d(\"WAGetRoutingInfoApi\").getRoutingInfo().then(function(a){a=a.edgeInfo;if(a!=null&&d(\"WACryptoUtils\").uint8ArraysEqual(a,b))d(\"WALogger\").LOG(k());else{d(\"WALogger\").LOG(j());return d(\"WASetRoutingInfoApi\").setRoutingInfo({edgeInfo:b})}}).then(function(){return\"NO_ACK\"})}function c(a){var c;(c=d(\"WAGlobals\").getWaOneQueue())==null?void 0:c.offlineStart(a);return(h||(h=b(\"Promise\"))).resolve(\"NO_ACK\")}function e(){var a;(a=d(\"WAGlobals\").getWaOneQueue())==null?void 0:a.offlineEnd()[\"catch\"](function(a){d(\"WALogger\").ERROR(i(),a)});return(h||(h=b(\"Promise\"))).resolve(\"NO_ACK\")}g.handleEdgeRoutingInfo=a;g.handleOfflineStart=c;g.handleOfflineEnd=e}),98);\n__d(\"WAHandleEncryptNotification\",[\"WAJobDefinitions\",\"WAJobOrchestratorTypes\",\"WAJobs\",\"WALogger\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handlePrekeyContactIDChangedNotification is not implemented\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleEncryptNotification type=\",\"\"]);i=function(){return a};return a}function a(a){var c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:c=a.notification.encryptType;d(\"WALogger\").LOG(i(),c);e.t0=c;e.next=e.t0===\"count\"?5:e.t0===\"digest\"?8:e.t0===\"identity\"?10:12;break;case 5:e.next=7;return b(\"regeneratorRuntime\").awrap(d(\"WAJobs\").getJobManager().waitUntilPersisted(d(\"WAJobDefinitions\").createStartJobInfo(\"generateAndUploadPreKeys\",{scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH},reason:\"handle encrypt notification\",uniqueJob:!0})));case 7:return e.abrupt(\"break\",12);case 8:d(\"WAJobs\").getJobManager().fireAndForgetNonPersisted(d(\"WAJobDefinitions\").createStartJobInfo(\"requestPreKeyDigest\",{scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH}}));return e.abrupt(\"break\",12);case 10:d(\"WALogger\").ERROR(h());return e.abrupt(\"break\",12);case 12:return e.abrupt(\"return\");case 13:case\"end\":return e.stop()}},null,this)}g.handleEncryptNotification=a}),98);\n__d(\"WAHandlePrekeyContactIDChangedNotification\",[\"WAHandleEncryptNotification\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){var b=a.encryptType,c=a.id,e=a.makeAck;a=a.offline;return d(\"WAHandleEncryptNotification\").handleEncryptNotification({ack:e,notification:{encryptType:b},offline:a,stanzaId:c,type:\"encrypt\"}).then(function(){return e()})};g.handlePrekeyContactIDChangedNotification=a}),98);\n__d(\"WAHandlePrekeyDigestNotification\",[\"WAHandleEncryptNotification\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){var b=a.encryptType,c=a.id,e=a.makeAck;a=a.offline;return d(\"WAHandleEncryptNotification\").handleEncryptNotification({ack:e,notification:{encryptType:b},offline:a,stanzaId:c,type:\"encrypt\"}).then(function(){return e()})};g.handlePrekeyDigestNotification=a}),98);\n__d(\"WAHandlePrekeyLowCountNotification\",[\"WAHandleEncryptNotification\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){var b=a.encryptType,c=a.id,e=a.makeAck;a=a.offline;return d(\"WAHandleEncryptNotification\").handleEncryptNotification({ack:e,notification:{encryptType:b},offline:a,stanzaId:c,type:\"encrypt\"}).then(function(){return e()})};g.handlePrekeyLowCountNotification=a}),98);\n__d(\"WAHandleReceipt\",[\"Promise\",\"WAProtocolQueue\",\"WAProtocolQueueState\",\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleIndividualReceipts error: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"start handling...\"]);j=function(){return a};return a}var k=d(\"WATagsLogger\").TAGS([\"backend\",\"handleIndividualReceipt\"]);a=function(a){k.DEV(j());return(h||(h=b(\"Promise\"))).resolve().then(function(){switch(a.aggregatedType){case\"none\":var b={chat:a.chat,externalIds:[a.stanzaId],from:{author:a.receiptSender,chat:a.chat,deviceJid:a.receiptSender,type:\"device\"},messageAuthor:a.author,offline:a.offline,receiptType:\"user\",stanzaId:a.stanzaId,ts:a.serverTs,type:a.receiptType};return d(\"WAProtocolQueueState\").persistStanza({consumerRetries:0,jid:a.chat,receipt:b,stanzaId:a.stanzaId,type:\"receipt\",priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityLow});default:a.aggregatedType;b=a.stanzaIds[0];var c={chat:a.chat,externalIds:a.stanzaIds,from:{author:a.receiptSender,chat:a.chat,deviceJid:a.receiptSender,type:\"device\"},messageAuthor:a.author,offline:a.offline,receiptType:\"user\",stanzaId:b,ts:a.serverTs,type:a.receiptType};return d(\"WAProtocolQueueState\").persistStanza({consumerRetries:0,jid:a.chat,receipt:c,stanzaId:b,type:\"receipt\",priority:d(\"WAProtocolQueue\").WAProtocolQueuePriorityLow})}})[\"catch\"](function(a){k.ERROR(i(),a)}).then(function(){return a.makeAck()})};g.handleIndividualReceipt=a}),98);\n__d(\"WAHandleServerPing\",[\"Promise\"],(function(a,b,c,d,e,f){\"use strict\";var g;a=function(a){a=a.makeResponse;return(g||(g=b(\"Promise\"))).resolve(a())};f.handleServerPing=a}),66);\n__d(\"WAHandleStreamError\",[\"Promise\",\"WABridge\",\"WAHandleFailureUtils\",\"WALogger\",\"WAOdsEnums\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Stream error of type \",\" is causing a closed socket\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Code \",\" stream:error is received\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Conflict stream:error is received\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"bad-mac stream:error is received\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"xml-not-well-formed stream:error is received\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unacked ping id: \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Client didn't send 'ack' back (type: \",\", class: \",\"), closing socket. Unacked id: \",\"\"]);o=function(){return a};return a}a=function(a){var b=a.ackClass,c=a.ackId;a=a.ackType;var e=\"ack\";d(\"WABridge\").getBridge().fireAndForget(\"event\",\"odsBumpEntityKey\",{entity:d(\"WAOdsEnums\").Entity.STREAM_ERROR,key:e+\".\"+a+\".\"+b});d(\"WALogger\").WARN(o(),a,b,c);return r(e)};c=function(a){a=a.pingId;var b=\"ping\";d(\"WABridge\").getBridge().fireAndForget(\"event\",\"odsBumpEntityKey\",{entity:d(\"WAOdsEnums\").Entity.STREAM_ERROR,key:\"\"+b});d(\"WALogger\").WARN(n(),a);return r(b)};e=function(){var a=\"xml-not-well-formed\";d(\"WABridge\").getBridge().fireAndForget(\"event\",\"odsBumpEntityKey\",{entity:d(\"WAOdsEnums\").Entity.STREAM_ERROR,key:\"\"+a});d(\"WALogger\").WARN(m());return r(a)};f=function(){var a=\"bad-mac\";d(\"WABridge\").getBridge().fireAndForget(\"event\",\"odsBumpEntityKey\",{entity:d(\"WAOdsEnums\").Entity.STREAM_ERROR,key:\"\"+a});d(\"WALogger\").WARN(l());return r(a)};var p=function(a){var b,c=a.code;a=a.conflictReason;var e=\"conflict\";d(\"WABridge\").getBridge().fireAndForget(\"event\",\"odsBumpEntityKey\",{entity:d(\"WAOdsEnums\").Entity.STREAM_ERROR,key:e+\".\"+((b=c)!=null?b:\"undefined\")+\".\"+((b=a)!=null?b:\"undefined\")});if(c===d(\"WAHandleFailureUtils\").FAILURE_CODES.NOT_AUTHORIZED)return s();d(\"WALogger\").WARN(k());return r(e)},q=function(a){a=a.code;var b=\"other\";d(\"WALogger\").WARN(j(),a);d(\"WABridge\").getBridge().fireAndForget(\"event\",\"odsBumpEntityKey\",{entity:d(\"WAOdsEnums\").Entity.STREAM_ERROR,key:b+\".\"+a});return a===d(\"WAHandleFailureUtils\").FAILURE_CODES.NOT_AUTHORIZED?s():r(b)};function r(a){d(\"WALogger\").WARN(i(),a);return(h||(h=b(\"Promise\"))).resolve(\"CLOSE_SOCKET\")}function s(){return(h||(h=b(\"Promise\"))).resolve(\"NO_ACK\")}g.handleAckKick=a;g.handlePingKick=c;g.handleXmlNotWellFormed=e;g.handleBadMac=f;g.handleConflict=p;g.handleStreamErrorCode=q}),98);\n__d(\"WASyncdSyncAllCollections\",[\"WABaseGlobals\",\"WAJobs\",\"WALogger\",\"WASyncd\",\"WASyncdConst\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncd: periodic sync for all collection\"]);h=function(){return a};return a}a=d(\"WAJobs\").getPersistedJobsApi().definePersistedJob().finalStep(\"syncAllCollections\",function(){d(\"WALogger\").LOG(h());return i()}).end();function i(){d(\"WABaseGlobals\").getDbImpls().writeSyncdLog(\"\",\"start periodic sync\")[\"catch\"](function(){});var a=Array.from(d(\"WASyncdConst\").CollectionName.members());return d(\"WASyncd\").markCollectionsForSync(a)}g.syncdSyncAllCollections=a;g.syncdSyncAllCollectionsFn=i}),98);\n__d(\"WAHandleSyncdDirtyBit\",[\"WASyncdDisabled\",\"WASyncdSyncAllCollections\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";c={groups:\"groups\",account_sync:\"account_sync\",syncd_app_state:\"syncd_app_state\"};function a(a){return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:if(d(\"WASyncdDisabled\").isSyncdDisabled()){c.next=3;break}c.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WASyncdSyncAllCollections\").syncdSyncAllCollectionsFn());case 3:return c.abrupt(\"return\",a.cleanDirtyBits().then(function(){return\"NO_ACK\"}));case 4:case\"end\":return c.stop()}},null,this)}g.DIRTY_BIT_TYPES=c;g.handleSyncdDirtyBit=a}),98);\n__d(\"WASmaxOutReceiptAppDataPeerCategoryMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(){var a=d(\"WASmaxJsx\").smax(\"receipt\",{category:\"peer_appdata\"});return a}function a(a){var b=h();return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeAppDataPeerCategoryMixin=a}),98);\n__d(\"WASmaxOutReceiptPublishAppDataPeerDeliveryRequest\",[\"WASmaxJsx\",\"WASmaxOutReceiptAppDataPeerCategoryMixin\",\"WASmaxOutReceiptIndividualDeviceMixin\",\"WASmaxOutReceiptSingleMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutReceiptAppDataPeerCategoryMixin\").mergeAppDataPeerCategoryMixin(d(\"WASmaxOutReceiptSingleMixin\").mergeSingleMixin(d(\"WASmaxOutReceiptIndividualDeviceMixin\").mergeIndividualDeviceMixin(d(\"WASmaxJsx\").smax(\"receipt\",null),a),a));return a}g.makePublishAppDataPeerDeliveryRequest=a}),98);\n__d(\"WASmaxReceiptPublishAppDataPeerDeliveryRPC\",[\"WAComms\",\"WASmaxOutReceiptPublishAppDataPeerDeliveryRequest\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a){var c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:c=d(\"WASmaxOutReceiptPublishAppDataPeerDeliveryRequest\").makePublishAppDataPeerDeliveryRequest(a);e.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").castSmaxStanza(c));case 3:case\"end\":return e.stop()}},null,this)}g.sendPublishAppDataPeerDeliveryRPC=a}),98);\n__d(\"WASendAppdataDeliveryReceiptProtocol\",[\"WASmaxReceiptPublishAppDataPeerDeliveryRPC\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){var b=a.stanzaId;a=a.from;return d(\"WASmaxReceiptPublishAppDataPeerDeliveryRPC\").sendPublishAppDataPeerDeliveryRPC({receiptTo:a,receiptId:b})};g.sendAppdataDeliveryReceiptProtocol=a}),98);\n__d(\"WASendAppdataRetryReceiptProtocol\",[\"WAReceiptUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a,b){var c=a.stanzaId,e=a.from,f=a.serverTs;a=a.retryCount;return d(\"WAReceiptUtils\").sendRetryReceipt({category:\"peer_appdata\",deviceIdentity:null,externalId:c,from:{deviceJid:e,type:\"device\"},participant:null,recipient:null,retryCount:a,ts:f},b)};g.sendAppdataRetryReceiptProtocol=a}),98);\n__d(\"WASmaxInAppdataDeliverDeviceIdentityMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"device-identity\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentBytes(a.value);return!a.success?a:d(\"WAResultOrError\").makeResult({deviceIdentityElementValue:a.value})}g.parseDeviceIdentityMixin=a}),98);\n__d(\"WASmaxInAppdataDeliverEncRetryMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"count\",1,4);return!b.success?b:d(\"WAResultOrError\").makeResult({count:b.value})}g.parseEncRetryMixin=a}),98);\n__d(\"WASmaxInAppdataDeliverEncHideDecryptionPlaceholderMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"decrypt-fail\",\"hide\");return!b.success?b:d(\"WAResultOrError\").makeResult({decryptFail:b.value})}g.parseEncHideDecryptionPlaceholderMixin=a}),98);\n__d(\"WASmaxInAppdataDeliverEncPayloadMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentBytesRange(a,1,1048576);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}g.parseEncPayloadMixin=a}),98);\n__d(\"WASmaxInAppdataDeliverEnums\",[\"WAJids\"],(function(a,b,c,d,e,f,g){a={high:\"high\",low:\"low\"};b={msg:\"msg\",pkmsg:\"pkmsg\"};c={validators:[d(\"WAJids\").validateDeviceJid,d(\"WAJids\").validateGroupJid],typeName:\"DeviceJid|GroupJid\"};g.ENUM_HIGH_LOW=a;g.ENUM_MSG_PKMSG=b;g.DEVICEJID_GROUPJID=c}),98);\n__d(\"WASmaxInAppdataDeliverEncTypeIndividualMixin\",[\"WAResultOrError\",\"WASmaxInAppdataDeliverEncHideDecryptionPlaceholderMixin\",\"WASmaxInAppdataDeliverEncPayloadMixin\",\"WASmaxInAppdataDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"type\",d(\"WASmaxInAppdataDeliverEnums\").ENUM_MSG_PKMSG);if(!b.success)return b;var c=d(\"WASmaxInAppdataDeliverEncHideDecryptionPlaceholderMixin\").parseEncHideDecryptionPlaceholderMixin(a);a=d(\"WASmaxInAppdataDeliverEncPayloadMixin\").parseEncPayloadMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({type:b.value,encHideDecryptionPlaceholderMixin:c.success?c.value:null},a.value))}g.parseEncTypeIndividualMixin=a}),98);\n__d(\"WASmaxInAppdataDeliverEncVersionFutureproofMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"v\",3,void 0);return!b.success?b:d(\"WAResultOrError\").makeResult({v:b.value})}g.parseEncVersionFutureproofMixin=a}),98);\n__d(\"WASmaxInAppdataDeliverOfflineMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrIntRange(a,\"offline\",0,12);return!a.success?a:d(\"WAResultOrError\").makeResult({offline:a.value})}g.parseOfflineMixin=a}),98);\n__d(\"WASmaxInAppdataDeliverRegistrationIDMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"registration\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentBytesRange(a.value,4,4);return!a.success?a:d(\"WAResultOrError\").makeResult({registrationElementValue:a.value})}g.parseRegistrationIDMixin=a}),98);\n__d(\"WASmaxInAppdataDeliverPeerRequest\",[\"WAResultOrError\",\"WASmaxInAppdataDeliverDeviceIdentityMixin\",\"WASmaxInAppdataDeliverEncRetryMixin\",\"WASmaxInAppdataDeliverEncTypeIndividualMixin\",\"WASmaxInAppdataDeliverEncVersionFutureproofMixin\",\"WASmaxInAppdataDeliverEnums\",\"WASmaxInAppdataDeliverOfflineMixin\",\"WASmaxInAppdataDeliverRegistrationIDMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"appdata\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"enc\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"category\",\"peer\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"push_priority\",d(\"WASmaxInAppdataDeliverEnums\").ENUM_HIGH_LOW);if(!f.success)return f;var g=d(\"WASmaxParseJid\").attrDeviceJid(a,\"from\");if(!g.success)return g;var h=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!h.success)return h;var i=d(\"WASmaxInAppdataDeliverEncVersionFutureproofMixin\").parseEncVersionFutureproofMixin(b.value);if(!i.success)return i;var j=d(\"WASmaxInAppdataDeliverEncRetryMixin\").parseEncRetryMixin(b.value);b=d(\"WASmaxInAppdataDeliverEncTypeIndividualMixin\").parseEncTypeIndividualMixin(b.value);if(!b.success)return b;var k=d(\"WASmaxInAppdataDeliverDeviceIdentityMixin\").parseDeviceIdentityMixin(a),l=d(\"WASmaxInAppdataDeliverRegistrationIDMixin\").parseRegistrationIDMixin(a);a=d(\"WASmaxInAppdataDeliverOfflineMixin\").parseOfflineMixin(a);return d(\"WAResultOrError\").makeResult({id:c.value,category:e.value,pushPriority:f.value,from:g.value,t:h.value,encEncVersionFutureproofMixin:i.value,encEncRetryMixin:j.success?j.value:null,encEncTypeIndividualMixin:b.value,deviceIdentityMixin:k.success?k.value:null,registrationIDMixin:l.success?l.value:null,offlineMixin:a.success?a.value:null})}g.parsePeerRequest=a}),98);\n__d(\"WASmaxAppdataDeliverPeerRPC\",[\"WASmaxInAppdataDeliverPeerRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInAppdataDeliverPeerRequest\").parsePeerRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Peer\",{Request:a}));return{parsedRequest:a.value}}g.receivePeerRPC=a}),98);\n__d(\"WACreateHandleAppdata\",[\"Promise\",\"WAJids\",\"WAResultOrError\",\"WASendAppdataDeliveryReceiptProtocol\",\"WASendAppdataRetryReceiptProtocol\",\"WASmaxAppdataDeliverPeerRPC\",\"WATagsLogger\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to send retry receipt due to \",\"}\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to send delivery receipt due to \",\"}\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"start handling...\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"received appdata, but no handler is provied. Fallback to default ack.\"]);l=function(){return a};return a}var m=d(\"WATagsLogger\").TAGS([\"decision tree\",\"handleAppdata\"]);function a(a){return function(c,e,f){e=(e=a.appdataMessage)==null?void 0:e.handleAppdataMessage;if(e==null){m.ERROR(l());return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(\"NO_ACK\"))}m.DEV(k());c=d(\"WASmaxAppdataDeliverPeerRPC\").receivePeerRPC(c);c=c.parsedRequest;var g=c.id,n=c.from,o=c.t,p=c.offlineMixin,q=c.encEncRetryMixin,r=c.encEncTypeIndividualMixin;c=c.encEncVersionFutureproofMixin;var s=d(\"WATimeUtils\").castToUnixTime(o),t={from:n,author:d(\"WAJids\").extractUserJid(n),retryCount:(o=q==null?void 0:q.count)!=null?o:0,ciphertext:r.elementValue,encVersion:String(c.v),encType:r.type,hideDecryptionFailure:((q=r.encHideDecryptionPlaceholderMixin)==null?void 0:q.decryptFail)===\"hide\",stanzaId:g};o=function(){return d(\"WASendAppdataDeliveryReceiptProtocol\").sendAppdataDeliveryReceiptProtocol({from:n,stanzaId:g})[\"catch\"](function(a){m.ERROR(j(),a);throw a})};c=function(){return d(\"WASendAppdataRetryReceiptProtocol\").sendAppdataRetryReceiptProtocol({from:n,stanzaId:g,retryCount:t.retryCount,serverTs:s},{cryptoManager:f})[\"catch\"](function(a){m.ERROR(i(),a);throw a})};return e({parsedAppdata:t,offline:p==null?void 0:p.offline,serverTs:s,sendDeliveryReceipt:o,sendRetryReceipt:c},{cryptoManager:f}).then(d(\"WAResultOrError\").makeResult)}}g.createHandleAppdata=a}),98);\n__d(\"WAHandleChatStateProtocol\",[],(function(a,b,c,d,e,f){\"use strict\";function a(a){var b;a.name===\"Paused\"?b=\"idle\":(a.name,b=a.value.composingMedia===\"audio\"?\"recording_audio\":\"typing\");return b}f.parseChatStatus=a}),66);\n__d(\"WASmaxInChatstateComposingMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"chatstate\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"composing\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optionalLiteral(d(\"WASmaxParseUtils\").attrString,b.value,\"media\",\"audio\");return!a.success?a:d(\"WAResultOrError\").makeResult({composingMedia:a.value})}g.parseComposingMixin=a}),98);\n__d(\"WASmaxInChatstatePausedMixin\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"chatstate\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"paused\");return!b.success?b:d(\"WASmaxParseUtils\").voidSuccess}g.parsePausedMixin=a}),98);\n__d(\"WASmaxInChatstateComposingOrPausedMixinGroup\",[\"WAResultOrError\",\"WASmaxInChatstateComposingMixin\",\"WASmaxInChatstatePausedMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInChatstateComposingMixin\").parseComposingMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"Composing\",value:b.value});var c=d(\"WASmaxInChatstatePausedMixin\").parsePausedMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"Paused\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Composing\",\"Paused\"],[b,c])}g.parseComposingOrPausedMixinGroup=a}),98);\n__d(\"WASmaxInChatstateFromGroupMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"chatstate\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrGroupJid(a,\"from\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").attrUserJid(a,\"participant\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"participant_pn\");return!a.success?a:d(\"WAResultOrError\").makeResult({from:b.value,participant:c.value,participantPn:a.value})}g.parseFromGroupMixin=a}),98);\n__d(\"WASmaxInChatstateFromUserMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"chatstate\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"from\");return!b.success?b:d(\"WAResultOrError\").makeResult({from:b.value})}g.parseFromUserMixin=a}),98);\n__d(\"WASmaxInChatstateFromUserOrGroupMixinGroup\",[\"WAResultOrError\",\"WASmaxInChatstateFromGroupMixin\",\"WASmaxInChatstateFromUserMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInChatstateFromUserMixin\").parseFromUserMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"FromUser\",value:b.value});var c=d(\"WASmaxInChatstateFromGroupMixin\").parseFromGroupMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"FromGroup\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"FromUser\",\"FromGroup\"],[b,c])}g.parseFromUserOrGroupMixinGroup=a}),98);\n__d(\"WASmaxInChatstateInternalTestMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"test\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a.value,\"config\");return!a.success?a:d(\"WAResultOrError\").makeResult({testConfig:a.value})}g.parseInternalTestMixin=a}),98);\n__d(\"WASmaxInChatstateServerNotificationRequest\",[\"WAResultOrError\",\"WASmaxInChatstateComposingOrPausedMixinGroup\",\"WASmaxInChatstateFromUserOrGroupMixinGroup\",\"WASmaxInChatstateInternalTestMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"chatstate\");if(!b.success)return b;b=d(\"WASmaxInChatstateInternalTestMixin\").parseInternalTestMixin(a);var c=d(\"WASmaxInChatstateFromUserOrGroupMixinGroup\").parseFromUserOrGroupMixinGroup(a);if(!c.success)return c;a=d(\"WASmaxInChatstateComposingOrPausedMixinGroup\").parseComposingOrPausedMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({internalTestMixin:b.success?b.value:null,fromUserOrGroupMixinGroup:c.value,composingOrPausedMixinGroup:a.value})}g.parseServerNotificationRequest=a}),98);\n__d(\"WASmaxChatstateServerNotificationRPC\",[\"WASmaxInChatstateServerNotificationRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInChatstateServerNotificationRequest\").parseServerNotificationRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"ServerNotification\",{Request:a}));return{parsedRequest:a.value}}g.receiveServerNotificationRPC=a}),98);\n__d(\"WACreateHandleChatState\",[\"Promise\",\"WAHandleChatStateProtocol\",\"WAResultOrError\",\"WASmaxChatstateServerNotificationRPC\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=(h||b(\"Promise\")).resolve(d(\"WAResultOrError\").makeResult(\"NO_ACK\"));function a(a){var b,c=(b=a.individualMessage)==null?void 0:b.handleIndividualChatState,e=(b=a.groupMessage)==null?void 0:b.handleGroupChatState;return function(a){if(c==null&&e==null)return i;a=d(\"WASmaxChatstateServerNotificationRPC\").receiveServerNotificationRPC(a);a=a.parsedRequest;var b=a.composingOrPausedMixinGroup;a=a.fromUserOrGroupMixinGroup;b=d(\"WAHandleChatStateProtocol\").parseChatStatus(b);if(a.name===\"FromUser\"){var f;return(f=c==null?void 0:c({status:b,jid:a.value.from}).then(d(\"WAResultOrError\").makeResult))!=null?f:i}else{a.name;return(f=e==null?void 0:e({status:b,jid:a.value.from,participant:a.value.participant,participantPn:a.value.participantPn}).then(d(\"WAResultOrError\").makeResult))!=null?f:i}}}g.createHandleChatState=a}),98);\n__d(\"WAHandleErrorStanzaProtocol\",[],(function(a,b,c,d,e,f){\"use strict\";a=479;f.SMAX_INVALID_CODE=a}),66);\n__d(\"WASmaxInSmaxInvalidErrorRequest\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"code\",\"479\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"smax-invalid\");return!a.success?a:d(\"WAResultOrError\").makeResult({code:b.value,text:a.value})}g.parseErrorRequest=a}),98);\n__d(\"WASmaxSmaxInvalidErrorRPC\",[\"WASmaxInSmaxInvalidErrorRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInSmaxInvalidErrorRequest\").parseErrorRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Error\",{Request:a}));return{parsedRequest:a.value}}g.receiveErrorRPC=a}),98);\n__d(\"WAUnknownStanzaError\",[\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"WAResultOrError\").makeError({type:\"unknown-stanza\"});g.unknownStanzaError=a}),98);\n__d(\"WACreateHandleErrorStanza\",[\"Promise\",\"WAHandleErrorStanzaProtocol\",\"WALogger\",\"WAResultOrError\",\"WASmaxParseUtils\",\"WASmaxSmaxInvalidErrorRPC\",\"WAUnknownStanzaError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Receiced error from server: \",\"\"]);i=function(){return a};return a}function a(a){var c=a.error;return function(a){var e=d(\"WASmaxParseUtils\").attrInt(a,\"code\");if(!e.success)return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError);e=e.value;if((c==null?void 0:c.handleSmaxErrorStanza)!=null&&e===d(\"WAHandleErrorStanzaProtocol\").SMAX_INVALID_CODE){var f=d(\"WASmaxSmaxInvalidErrorRPC\").receiveErrorRPC(a);f=f.parsedRequest;return c.handleSmaxErrorStanza({code:d(\"WAHandleErrorStanzaProtocol\").SMAX_INVALID_CODE,text:f.text}).then(d(\"WAResultOrError\").makeResult)}if((c==null?void 0:c.handleErrorStanza)!=null)return c.handleErrorStanza({code:e}).then(d(\"WAResultOrError\").makeResult);d(\"WALogger\").ERROR(i(),a.toString());return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(\"NO_ACK\"))}}g.createHandleErrorStanza=a}),98);\n__d(\"WASmaxInLoginEnums\",[],(function(a,b,c,d,e,f){a={400:\"400\",401:\"401\",402:\"402\",403:\"403\",405:\"405\",406:\"406\",409:\"409\",412:\"412\",413:\"413\",414:\"414\",415:\"415\",416:\"416\",500:\"500\",501:\"501\",503:\"503\"};b={\"false\":\"false\",\"true\":\"true\"};f.ENUM_400_401_402_403_405_406_409_412_413_414_415_416_500_501_503=a;f.ENUM_FALSE_TRUE=b}),66);\n__d(\"WASmaxInLoginFailureRequest\",[\"WAResultOrError\",\"WASmaxInLoginEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"failure\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"reason\",d(\"WASmaxInLoginEnums\").ENUM_400_401_402_403_405_406_409_412_413_414_415_416_500_501_503);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"location\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"code\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"expire\",0,void 0);if(!f.success)return f;var g=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"retry\",0,void 0);if(!g.success)return g;var h=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"t\",0,void 0);if(!h.success)return h;var i=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"message\");if(!i.success)return i;var j=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"vt\",1,1e5);if(!j.success)return j;var k=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"has_offline\",d(\"WASmaxInLoginEnums\").ENUM_FALSE_TRUE);if(!k.success)return k;var l=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"url\");if(!l.success)return l;var m=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"logout_message_header\");if(!m.success)return m;var n=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"logout_message_subtext\");if(!n.success)return n;var o=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"logout_message_locale\");if(!o.success)return o;var p=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"logout_main_button_text\");if(!p.success)return p;var q=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"logout_main_button_url\");if(!q.success)return q;var r=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"logout_secondary_button_text\");if(!r.success)return r;var s=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"logout_secondary_button_url\");if(!s.success)return s;var t=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"logout_secondary_button_ch_entrypoint_id\");if(!t.success)return t;var u=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"appeal_token\");if(!u.success)return u;var v=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"violation_reason\");if(!v.success)return v;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"source_acct\",-1,2);return!a.success?a:d(\"WAResultOrError\").makeResult({reason:b.value,location:c.value,code:e.value,expire:f.value,retry:g.value,t:h.value,message:i.value,vt:j.value,hasOffline:k.value,url:l.value,logoutMessageHeader:m.value,logoutMessageSubtext:n.value,logoutMessageLocale:o.value,logoutMainButtonText:p.value,logoutMainButtonUrl:q.value,logoutSecondaryButtonText:r.value,logoutSecondaryButtonUrl:s.value,logoutSecondaryButtonChEntrypointId:t.value,appealToken:u.value,violationReason:v.value,sourceAcct:a.value})}g.parseFailureRequest=a}),98);\n__d(\"WASmaxLoginFailureRPC\",[\"WASmaxInLoginFailureRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInLoginFailureRequest\").parseFailureRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Failure\",{Request:a}));return{parsedRequest:a.value}}g.receiveFailureRPC=a}),98);\n__d(\"WACreateHandleFailure\",[\"Promise\",\"WAResultOrError\",\"WASmaxLoginFailureRPC\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){var c=(a=a.login)==null?void 0:a.handleLoginFailure;return function(a){if(c!=null){a=d(\"WASmaxLoginFailureRPC\").receiveFailureRPC(a);a=a.parsedRequest;return c({reason:a.reason,location:a.location,expire:a.expire}).then(d(\"WAResultOrError\").makeResult)}return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(\"NO_ACK\"))}}g.createHandleFailure=a}),98);\n__d(\"WASmaxInDirtyBitsIQErrorBadRequestMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"bad-request\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",400);return!a.success?a:d(\"WAResultOrError\").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);\n__d(\"WASmaxInDirtyBitsIQErrorFeatureNotImplementedMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"feature-not-implemented\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",501);return!a.success?a:d(\"WAResultOrError\").makeResult({text:b.value,code:a.value})}g.parseIQErrorFeatureNotImplementedMixin=a}),98);\n__d(\"WASmaxInDirtyBitsIQErrorInternalServerErrorMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"internal-server-error\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",500);return!a.success?a:d(\"WAResultOrError\").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);\n__d(\"WASmaxInDirtyBitsIQErrorServiceUnavailableMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"service-unavailable\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",503);return!a.success?a:d(\"WAResultOrError\").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);\n__d(\"WASmaxInDirtyBitsIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup\",[\"WAResultOrError\",\"WASmaxInDirtyBitsIQErrorBadRequestMixin\",\"WASmaxInDirtyBitsIQErrorFeatureNotImplementedMixin\",\"WASmaxInDirtyBitsIQErrorInternalServerErrorMixin\",\"WASmaxInDirtyBitsIQErrorServiceUnavailableMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInDirtyBitsIQErrorBadRequestMixin\").parseIQErrorBadRequestMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"IQErrorBadRequest\",value:b.value});var c=d(\"WASmaxInDirtyBitsIQErrorFeatureNotImplementedMixin\").parseIQErrorFeatureNotImplementedMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"IQErrorFeatureNotImplemented\",value:c.value});var e=d(\"WASmaxInDirtyBitsIQErrorServiceUnavailableMixin\").parseIQErrorServiceUnavailableMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"IQErrorServiceUnavailable\",value:e.value});var f=d(\"WASmaxInDirtyBitsIQErrorInternalServerErrorMixin\").parseIQErrorInternalServerErrorMixin(a);return f.success?d(\"WAResultOrError\").makeResult({name:\"IQErrorInternalServerError\",value:f.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"IQErrorBadRequest\",\"IQErrorFeatureNotImplemented\",\"IQErrorServiceUnavailable\",\"IQErrorInternalServerError\"],[b,c,e,f])}g.parseIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup=a}),98);\n__d(\"WASmaxInDirtyBitsIQErrorResponseMixin\",[\"WAResultOrError\",\"WASmaxParseReference\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"id\"]);if(!c.success)return c;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"id\",c.value);if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"to\"]);if(!c.success)return c;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"from\",c.value);if(!b.success)return b;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"error\");return!c.success?c:d(\"WAResultOrError\").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);\n__d(\"WASmaxInDirtyBitsCleanResponseError\",[\"WAResultOrError\",\"WASmaxInDirtyBitsIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup\",\"WASmaxInDirtyBitsIQErrorResponseMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInDirtyBitsIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInDirtyBitsIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup\").parseIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup(c.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{errorIQErrorBadRequestOrFeatureNotImplementedOrServiceUnavailableOrInternalServerErrorMixinGroup:b.value}))}g.parseCleanResponseError=a}),98);\n__d(\"WASmaxInDirtyBitsIQResultResponseMixin\",[\"WAResultOrError\",\"WASmaxParseReference\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"id\"]);if(!c.success)return c;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"id\",c.value);if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"to\"]);if(!c.success)return c;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"from\",c.value);if(!b.success)return b;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"result\");return!c.success?c:d(\"WAResultOrError\").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);\n__d(\"WASmaxInDirtyBitsCleanResponseSuccess\",[\"WASmaxInDirtyBitsIQResultResponseMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxInDirtyBitsIQResultResponseMixin\").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseCleanResponseSuccess=a}),98);\n__d(\"WASmaxOutDirtyBitsBaseIQSetRequestMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(){var a=d(\"WASmaxJsx\").smax(\"iq\",{id:d(\"WAWap\").generateId(),type:\"set\"});return a}function a(a){var b=h();return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeBaseIQSetRequestMixin=a}),98);\n__d(\"WASmaxOutDirtyBitsCleanTypeMixin\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.cleanType;a=a.cleanTimestamp;b=d(\"WASmaxJsx\").smax(\"clean\",{type:d(\"WAWap\").CUSTOM_STRING(b),timestamp:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").INT,a)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeCleanTypeMixin=a}),98);\n__d(\"WASmaxOutDirtyBitsCleanTypeWithTimestampMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.cleanTimestamp;a=d(\"WASmaxJsx\").smax(\"clean\",{type:\"syncd_app_state\",timestamp:d(\"WAWap\").INT(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeCleanTypeWithTimestampMixin=a}),98);\n__d(\"WASmaxOutDirtyBitsTypeCleanOrCleanWithTimestampMixinGroup\",[\"WASmaxMixinGroupExhaustiveError\",\"WASmaxOutDirtyBitsCleanTypeMixin\",\"WASmaxOutDirtyBitsCleanTypeWithTimestampMixin\"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.cleanType)return d(\"WASmaxOutDirtyBitsCleanTypeMixin\").mergeCleanTypeMixin(a,b.cleanType);if(b.cleanTypeWithTimestamp)return d(\"WASmaxOutDirtyBitsCleanTypeWithTimestampMixin\").mergeCleanTypeWithTimestampMixin(a,b.cleanTypeWithTimestamp);throw new(d(\"WASmaxMixinGroupExhaustiveError\").SmaxMixinGroupExhaustiveError)()}g.mergeTypeCleanOrCleanWithTimestampMixinGroup=a}),98);\n__d(\"WASmaxOutDirtyBitsCleanRequest\",[\"WASmaxJsx\",\"WASmaxOutDirtyBitsBaseIQSetRequestMixin\",\"WASmaxOutDirtyBitsTypeCleanOrCleanWithTimestampMixinGroup\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){a=a.typeCleanOrCleanWithTimestampMixinGroupArgs;a=d(\"WASmaxOutDirtyBitsBaseIQSetRequestMixin\").mergeBaseIQSetRequestMixin(d(\"WASmaxJsx\").smax(\"iq\",{to:d(\"WAWap\").S_WHATSAPP_NET,xmlns:\"urn:xmpp:whatsapp:dirty\"},d(\"WASmaxOutDirtyBitsTypeCleanOrCleanWithTimestampMixinGroup\").mergeTypeCleanOrCleanWithTimestampMixinGroup(d(\"WASmaxJsx\").smax(\"clean\",null),a)));return a}g.makeCleanRequest=a}),98);\n__d(\"WASmaxDirtyBitsCleanRPC\",[\"WAComms\",\"WASmaxInDirtyBitsCleanResponseError\",\"WASmaxInDirtyBitsCleanResponseSuccess\",\"WASmaxOutDirtyBitsCleanRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:e=d(\"WASmaxOutDirtyBitsCleanRequest\").makeCleanRequest(a);i.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(e,c));case 3:f=i.sent;g=d(\"WASmaxInDirtyBitsCleanResponseSuccess\").parseCleanResponseSuccess(f,e);if(!g.success){i.next=7;break}return i.abrupt(\"return\",{name:\"CleanResponseSuccess\",value:g.value});case 7:h=d(\"WASmaxInDirtyBitsCleanResponseError\").parseCleanResponseError(f,e);if(!h.success){i.next=10;break}return i.abrupt(\"return\",{name:\"CleanResponseError\",value:h.value});case 10:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Clean\",{Success:g,Error:h}));case 11:case\"end\":return i.stop()}},null,this)}g.sendCleanRPC=a}),98);\n__d(\"WACleanDirtyBitsProtocol\",[\"WALogger\",\"WASmaxDirtyBitsCleanRPC\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to clean dirty bits for type: \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"sendCleanRPC error: \",\"\"]);i=function(){return a};return a}function a(a){var c,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:a.type===\"syncd_app_state\"?c={cleanTypeWithTimestamp:{cleanTimestamp:a.timestamp}}:c={cleanType:{cleanTimestamp:a.timestamp,cleanType:a.type}};f.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WASmaxDirtyBitsCleanRPC\").sendCleanRPC({typeCleanOrCleanWithTimestampMixinGroupArgs:c}));case 3:e=f.sent,e.name!==\"CleanResponseSuccess\"&&(d(\"WALogger\").WARN(i(),e),d(\"WALogger\").ERROR(h(),a.type));case 5:case\"end\":return f.stop()}},null,this)}g.cleanDirtyBitsProtocol=a}),98);\n__d(\"WASmaxInDirtyBitsEnums\",[],(function(a,b,c,d,e,f){a={account_sync:\"account_sync\",groups:\"groups\",newsletter_metadata:\"newsletter_metadata\",syncd_app_state:\"syncd_app_state\"};f.ENUM_ACCOUNTSYNC_GROUPS_NEWSLETTERMETADATA_SYNCDAPPSTATE=a}),66);\n__d(\"WASmaxInDirtyBitsNotifyRequest\",[\"WAResultOrError\",\"WASmaxInDirtyBitsEnums\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"ib\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"dirty\");if(!b.success)return b;a=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"timestamp\",0,void 0);if(!c.success)return c;b=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"type\",d(\"WASmaxInDirtyBitsEnums\").ENUM_ACCOUNTSYNC_GROUPS_NEWSLETTERMETADATA_SYNCDAPPSTATE);return!b.success?b:d(\"WAResultOrError\").makeResult({from:a.value,dirtyTimestamp:c.value,dirtyType:b.value})}g.parseNotifyRequest=a}),98);\n__d(\"WASmaxDirtyBitsNotifyRPC\",[\"WASmaxInDirtyBitsNotifyRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInDirtyBitsNotifyRequest\").parseNotifyRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Notify\",{Request:a}));return{parsedRequest:a.value}}g.receiveNotifyRPC=a}),98);\n__d(\"WAHandleDirtyBitsProtocol\",[\"WASmaxDirtyBitsNotifyRPC\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){a=d(\"WASmaxDirtyBitsNotifyRPC\").receiveNotifyRPC(a);a=a.parsedRequest;var b=a.dirtyType;a=a.dirtyTimestamp;return{dirtyBitType:b,dirtyBitTimestamp:a}}g.parseDirtyBit=a}),98);\n__d(\"WAHandleThreadMetadata\",[\"WAGlobals\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:c=a.map(function(a){return a.from});e.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return a.storage.warmCache(c)},{operationType:\"thread_metadata\",flush:!1}));case 3:case\"end\":return e.stop()}},null,this)}g.handleThreadMetadata=a}),98);\n__d(\"WASmaxDecisionTreeUtils\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b=d(\"WASmaxParseUtils\").maybeChildren(a);if(!b.success)return b;b=b.value;return b==null||b.length===0?d(\"WASmaxParseUtils\").errorMessage(a,\"to have at least 1 child, but found 0\"):d(\"WAResultOrError\").makeResult(b[0])}g.firstChild=a}),98);\n__d(\"WASmaxInEdgeEdgeRoutingRequest\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"ib\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"edge_routing\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"routing_info\");if(!b.success)return b;a=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").contentBytesRange(b.value,1,1024);return!b.success?b:d(\"WAResultOrError\").makeResult({from:a.value,edgeRoutingRoutingInfoElementValue:b.value})}g.parseEdgeRoutingRequest=a}),98);\n__d(\"WASmaxEdgeEdgeRoutingRPC\",[\"WASmaxInEdgeEdgeRoutingRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInEdgeEdgeRoutingRequest\").parseEdgeRoutingRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"EdgeRouting\",{Request:a}));return{parsedRequest:a.value}}g.receiveEdgeRoutingRPC=a}),98);\n__d(\"WASmaxInMessageRequestEnums\",[],(function(a,b,c,d,e,f){a={complete:\"complete\",\"continue\":\"continue\"};f.ENUM_COMPLETE_CONTINUE=a}),66);\n__d(\"WASmaxInMessageRequestSpamMarkerRequest\",[\"WAResultOrError\",\"WASmaxInMessageRequestEnums\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"ib\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"spam\");if(!b.success)return b;a=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"state\",d(\"WASmaxInMessageRequestEnums\").ENUM_COMPLETE_CONTINUE);return!b.success?b:d(\"WAResultOrError\").makeResult({from:a.value,spamState:b.value})}g.parseSpamMarkerRequest=a}),98);\n__d(\"WASmaxMessageRequestSpamMarkerRPC\",[\"WASmaxInMessageRequestSpamMarkerRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInMessageRequestSpamMarkerRequest\").parseSpamMarkerRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"SpamMarker\",{Request:a}));return{parsedRequest:a.value}}g.receiveSpamMarkerRPC=a}),98);\n__d(\"WASmaxInOfflineCompletionRequest\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"ib\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"offline\");if(!b.success)return b;a=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"count\",0,void 0);return!b.success?b:d(\"WAResultOrError\").makeResult({from:a.value,offlineCount:b.value})}g.parseCompletionRequest=a}),98);\n__d(\"WASmaxOfflineCompletionRPC\",[\"WASmaxInOfflineCompletionRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInOfflineCompletionRequest\").parseCompletionRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Completion\",{Request:a}));return{parsedRequest:a.value}}g.receiveCompletionRPC=a}),98);\n__d(\"WASmaxInOfflinePreviewRequest\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"ib\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"offline_preview\");if(!b.success)return b;a=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"count\",0,void 0);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"message\",0,void 0);if(!e.success)return e;var f=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"receipt\",0,void 0);if(!f.success)return f;var g=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"notification\",0,void 0);if(!g.success)return g;var h=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"appdata\",0,void 0);if(!h.success)return h;b=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"call\",0,void 0);return!b.success?b:d(\"WAResultOrError\").makeResult({from:a.value,offlinePreviewCount:c.value,offlinePreviewMessage:e.value,offlinePreviewReceipt:f.value,offlinePreviewNotification:g.value,offlinePreviewAppdata:h.value,offlinePreviewCall:b.value})}g.parsePreviewRequest=a}),98);\n__d(\"WASmaxOfflinePreviewRPC\",[\"WASmaxInOfflinePreviewRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInOfflinePreviewRequest\").parsePreviewRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Preview\",{Request:a}));return{parsedRequest:a.value}}g.receivePreviewRPC=a}),98);\n__d(\"WASmaxInOfflineEnums\",[\"WAJids\"],(function(a,b,c,d,e,f,g){b={validators:[(a=d(\"WAJids\")).validateGroupJid,a.validateUserJid,a.validateUserJid,a.validateUserJid],typeName:\"GroupJid|UserJid|UserJid|UserJid\"};g.GROUPJID_USERJID_USERJID_USERJID=b}),98);\n__d(\"WASmaxInOfflineThreadMetadataDelayedMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"item\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"from\");return!b.success?b:d(\"WAResultOrError\").makeResult({from:b.value})}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"status_msgs\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"count\",0,void 0);if(!b.success)return b;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"item\",1,Infinity,h);return!a.success?a:d(\"WAResultOrError\").makeResult({count:b.value,item:a.value})}function j(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notifications\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"count\",0,void 0);return!b.success?b:d(\"WAResultOrError\").makeResult({count:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"thread_metadata\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"status_msgs\",i);if(!b.success)return b;a=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"notifications\",j);return!a.success?a:d(\"WAResultOrError\").makeResult({statusMsgs:b.value,notifications:a.value})}g.parseThreadMetadataDelayedStatusMsgsItem=h;g.parseThreadMetadataDelayedStatusMsgs=i;g.parseThreadMetadataDelayedNotifications=j;g.parseThreadMetadataDelayedMixin=a}),98);\n__d(\"WASmaxInOfflineThreadMetadataRequest\",[\"WAResultOrError\",\"WASmaxInOfflineEnums\",\"WASmaxInOfflineThreadMetadataDelayedMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"item\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrJidEnum(a,\"from\",d(\"WASmaxInOfflineEnums\").GROUPJID_USERJID_USERJID_USERJID);if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({from:b.value,t:a.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"ib\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"thread_metadata\");if(!b.success)return b;a=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!a.success)return a;var c=d(\"WASmaxInOfflineThreadMetadataDelayedMixin\").parseThreadMetadataDelayedMixin(b.value);b=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"item\",0,50,h);return!b.success?b:d(\"WAResultOrError\").makeResult({from:a.value,threadMetadataThreadMetadataDelayedMixin:c.success?c.value:null,threadMetadataItem:b.value})}g.parseThreadMetadataRequestThreadMetadataItem=h;g.parseThreadMetadataRequest=a}),98);\n__d(\"WASmaxOfflineThreadMetadataRPC\",[\"WASmaxInOfflineThreadMetadataRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInOfflineThreadMetadataRequest\").parseThreadMetadataRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"ThreadMetadata\",{Request:a}));return{parsedRequest:a.value}}g.receiveThreadMetadataRPC=a}),98);\n__d(\"WACreateHandleInfoBulletin\",[\"Promise\",\"WACleanDirtyBitsProtocol\",\"WAHandleDirtyBitsProtocol\",\"WAHandleThreadMetadata\",\"WALogger\",\"WAResultOrError\",\"WASmaxDecisionTreeUtils\",\"WASmaxEdgeEdgeRoutingRPC\",\"WASmaxMessageRequestSpamMarkerRPC\",\"WASmaxOfflineCompletionRPC\",\"WASmaxOfflinePreviewRPC\",\"WASmaxOfflineThreadMetadataRPC\",\"WATimeUtils\",\"WAUnknownStanzaError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleInfoBulletin: unknown incoming <ib>: \",\"\"]);i=function(){return a};return a}var j=(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(\"NO_ACK\"));function a(a){return function(c){var e=d(\"WASmaxDecisionTreeUtils\").firstChild(c);if(e.success===!1)return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError);e=e.value.tag;switch(e){case\"edge_routing\":var f;e=d(\"WASmaxEdgeEdgeRoutingRPC\").receiveEdgeRoutingRPC(c).parsedRequest;e=e.edgeRoutingRoutingInfoElementValue;return(f=(f=a.comms)==null?void 0:f.handleEdgeRoutingInfo({edgeInfo:e}).then(d(\"WAResultOrError\").makeResult))!=null?f:j;case\"offline_preview\":e=d(\"WASmaxOfflinePreviewRPC\").receivePreviewRPC(c).parsedRequest;f={count:e.offlinePreviewCount,message:e.offlinePreviewMessage,receipt:e.offlinePreviewReceipt,notification:e.offlinePreviewNotification,appdata:e.offlinePreviewAppdata};return(e=(e=a.offline)==null?void 0:e.handleOfflineStart(f).then(d(\"WAResultOrError\").makeResult))!=null?e:j;case\"offline\":f=d(\"WASmaxOfflineCompletionRPC\").receiveCompletionRPC(c).parsedRequest.offlineCount;return(e=(e=a.offline)==null?void 0:e.handleOfflineEnd({offlineCount:f}).then(d(\"WAResultOrError\").makeResult))!=null?e:j;case\"thread_metadata\":var g=d(\"WASmaxOfflineThreadMetadataRPC\").receiveThreadMetadataRPC(c).parsedRequest.threadMetadataItem.map(function(a){var b=a.from;a=a.t;return{from:b,t:d(\"WATimeUtils\").castToUnixTime(a)}});return d(\"WAHandleThreadMetadata\").handleThreadMetadata(g).then(function(){var b;return(b=(b=a.offline)==null?void 0:b.handleThreadMetadata(g).then(d(\"WAResultOrError\").makeResult))!=null?b:j});case\"spam\":f=d(\"WASmaxMessageRequestSpamMarkerRPC\").receiveSpamMarkerRPC(c).parsedRequest.spamState;return(e=(e=a.spam)==null?void 0:e.handleSpam({spamState:f}).then(d(\"WAResultOrError\").makeResult))!=null?e:j;case\"dirty\":f=d(\"WAHandleDirtyBitsProtocol\").parseDirtyBit(c);var k=f.dirtyBitTimestamp,l=f.dirtyBitType;e=function(){return d(\"WACleanDirtyBitsProtocol\").cleanDirtyBitsProtocol({timestamp:k,type:l})};switch(l){case\"groups\":return(f=(f=a.groupMessage)==null?void 0:f.handleGroupDirtyBit==null?void 0:f.handleGroupDirtyBit({dirtyBitTimestamp:k,cleanDirtyBits:e}).then(d(\"WAResultOrError\").makeResult))!=null?f:j;case\"account_sync\":return(f=(f=a.accountSync)==null?void 0:f.handleAccountSyncDirtyBit({dirtyBitTimestamp:k,cleanDirtyBits:e}).then(d(\"WAResultOrError\").makeResult))!=null?f:j;case\"newsletter_metadata\":return(f=(f=a.newsletter)==null?void 0:f.handleNewsletterDirtyBit({dirtyBitTimestamp:k,cleanDirtyBits:e}).then(d(\"WAResultOrError\").makeResult))!=null?f:j;default:l;return(f=(f=a.syncd)==null?void 0:f.handleSyncdDirtyBit({dirtyBitTimestamp:k,cleanDirtyBits:e}).then(d(\"WAResultOrError\").makeResult))!=null?f:j}default:d(\"WALogger\").WARN(i(),c.toString());return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}}}g.createHandleInfoBulletin=a}),98);\n__d(\"WAAdv\",[\"WAAdv.pb\",\"WABinary\",\"WAByteArray\",\"WACryptoDependencies\",\"WACryptoHmac\",\"WACryptoUtils\",\"WAResultOrError\",\"WASignalKeys\",\"WASignalOther\",\"WASignalSignatures\",\"decodeProtobuf\",\"encodeProtobuf\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=new Uint8Array([6,0]),i=new Uint8Array([6,1]);function a(a){return a}function c(a){return a}function e(a){return a}function f(){var a=new Uint8Array(32);d(\"WACryptoDependencies\").getCrypto().getRandomValues(a);return a}function j(a){var c,e,f,g,i,j,k,l,m,n,o,p,q;return b(\"regeneratorRuntime\").async(function(r){while(1)switch(r.prev=r.next){case 0:c=a.advSignedDeviceIdentityHmacProtobuf,e=a.advSecretKey,f=a.identityPubKey;g=d(\"decodeProtobuf\").decodeProtobuf(d(\"WAAdv.pb\").ADVSignedDeviceIdentityHMACSpec,c);i=g.details;j=g.hmac;if(!(i==null)){r.next=6;break}return r.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing-identity-hmac-details\"));case 6:if(!(j==null)){r.next=8;break}return r.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing-identity-hmac\"));case 8:r.next=10;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoHmac\").hmacSha256(e,i));case 10:k=r.sent;if(d(\"WACryptoUtils\").arrayBuffersEqual(k,j)){r.next=13;break}return r.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"hmac-mismatch\"));case 13:l=d(\"decodeProtobuf\").decodeProtobuf(d(\"WAAdv.pb\").ADVSignedDeviceIdentitySpec,i);m=l.details;if(!(m==null)){r.next=17;break}return r.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing-account-signature-details\"));case 17:n=l.accountSignatureKey;if(!(n==null)){r.next=20;break}return r.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing-account-signature-key\"));case 20:o=l.accountSignature;if(!(o==null)){r.next=23;break}return r.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing-account-signature\"));case 23:p=d(\"WABinary\").Binary.build(h,m,f).readByteArray();q=d(\"WASignalSignatures\").verifyMsgSignalVariant(d(\"WASignalKeys\").serializeIdentity(new Uint8Array(n)),p,d(\"WASignalOther\").toBytes(o,64));if(q){r.next=27;break}return r.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"signature-mismatch\"));case 27:return r.abrupt(\"return\",d(\"WAResultOrError\").makeResult({advSignedDeviceIdentity:l}));case 28:case\"end\":return r.stop()}},null,this)}function k(a){var c,e,f,g,h,j,k,l,m;return b(\"regeneratorRuntime\").async(function(n){while(1)switch(n.prev=n.next){case 0:c=a.advSignedDeviceIdentity,e=a.identityKeyPair;f=c.details;g=d(\"decodeProtobuf\").decodeProtobuf(d(\"WAAdv.pb\").ADVDeviceIdentitySpec,f);h=g.keyIndex;if(!(h==null)){n.next=6;break}return n.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"missing-key-index\"));case 6:j=d(\"WABinary\").Binary.build(i,f,e.publicKey,c.accountSignatureKey).readByteArray();n.next=9;return b(\"regeneratorRuntime\").awrap(d(\"WASignalSignatures\").signMsg(e,j));case 9:k=n.sent;l=babelHelpers[\"extends\"]({},c);l.deviceSignature=d(\"WAByteArray\").uint8ArrayToBuffer(k);l.accountSignatureKey=void 0;m=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAAdv.pb\").ADVSignedDeviceIdentitySpec,l).readByteArray();return n.abrupt(\"return\",d(\"WAResultOrError\").makeResult({signedDeviceIdentityProtobuf:m,keyIndex:h}));case 15:case\"end\":return n.stop()}},null,this)}g.castToAdvSignedDeviceIdentityHmacProtobuf=a;g.castToAdvSecretKey=c;g.castToAdvSignedDeviceIdentityProtobuf=e;g.generateAdvSecretKey=f;g.verifyAdvSignedDeviceIdentity=j;g.addDeviceSignatureToProtobuf=k}),98);\n__d(\"WASmaxInMdBaseIQSetRequestMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"set\");return!a.success?a:d(\"WAResultOrError\").makeResult({id:b.value,type:a.value})}g.parseBaseIQSetRequestMixin=a}),98);\n__d(\"WASmaxInMdSetToCompanionRequest\",[\"WAResultOrError\",\"WASmaxInMdBaseIQSetRequestMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"ref\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentBytes(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"pair-device\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"xmlns\",\"md\");if(!e.success)return e;a=d(\"WASmaxInMdBaseIQSetRequestMixin\").parseBaseIQSetRequestMixin(a);if(!a.success)return a;b=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"ref\",6,6,h);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:c.value,xmlns:e.value},a.value,{pairDeviceRef:b.value}))}g.parseSetToCompanionRequestPairDeviceRef=h;g.parseSetToCompanionRequest=a}),98);\n__d(\"WASmaxOutMdSetToCompanionResponseClientResponse\",[\"WASmaxJsx\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrDomainJid,a,[\"from\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"iq\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").DOMAIN_JID(a.value),type:\"result\"});return b}g.makeSetToCompanionResponseClientResponse=a}),98);\n__d(\"WASmaxMdSetToCompanionRPC\",[\"WASmaxInMdSetToCompanionRequest\",\"WASmaxOutMdSetToCompanionResponseClientResponse\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMdSetToCompanionRequest\").parseSetToCompanionRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"SetToCompanion\",{Request:b}));return{parsedRequest:b.value,makeSetToCompanionResponseClientResponse:function(){return d(\"WASmaxOutMdSetToCompanionResponseClientResponse\").makeSetToCompanionResponseClientResponse(a)}}}g.receiveSetToCompanionRPC=a}),98);\n__d(\"WAHandlePairDeviceProtocol\",[\"WABase64\",\"WABinary\",\"WAResultOrError\",\"WASmaxMdSetToCompanionRPC\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){a=d(\"WASmaxMdSetToCompanionRPC\").receiveSetToCompanionRPC(a);var b=a.makeSetToCompanionResponseClientResponse;a=a.parsedRequest;a=a.pairDeviceRef.map(function(a){a=a.elementValue;a=new(d(\"WABinary\").Binary)(a);return a.readString(a.size())});return d(\"WAResultOrError\").makeResult({refs:a,makeAck:b})}b=function(a){var b=a.ref,c=a.publicAuthKey,e=a.publicIdentityKey;a=a.advSecretKey;return b+\",\"+d(\"WABase64\").encodeB64(c)+\",\"+d(\"WABase64\").encodeB64(e)+\",\"+d(\"WABase64\").encodeB64(a)};g.parsePairDevice=a;g.generateRegistrationQrCodeString=b}),98);\n__d(\"WASmaxInMdEnums\",[],(function(a,b,c,d,e,f){a={\"false\":\"false\",\"true\":\"true\"};f.ENUM_FALSE_TRUE=a}),66);\n__d(\"WASmaxInMdSetRegRequest\",[\"WAResultOrError\",\"WASmaxInMdBaseIQSetRequestMixin\",\"WASmaxInMdEnums\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"biz\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"name\");return!b.success?b:d(\"WAResultOrError\").makeResult({name:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"pair-success\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"device-identity\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"device\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"platform\");if(!f.success)return f;b=d(\"WASmaxParseUtils\").optionalChildWithTag(b.value,\"biz\",h);if(!b.success)return b;var g=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!g.success)return g;var i=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"xmlns\",\"md\");if(!i.success)return i;c=d(\"WASmaxParseUtils\").contentBytesRange(c.value,1,500);if(!c.success)return c;var j=d(\"WASmaxParseJid\").attrDeviceJid(e.value,\"jid\");if(!j.success)return j;var k=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrDeviceJid,e.value,\"lid\");if(!k.success)return k;e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,e.value,\"beta\",d(\"WASmaxInMdEnums\").ENUM_FALSE_TRUE);if(!e.success)return e;f=d(\"WASmaxParseUtils\").attrString(f.value,\"name\");if(!f.success)return f;a=d(\"WASmaxInMdBaseIQSetRequestMixin\").parseBaseIQSetRequestMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:g.value,xmlns:i.value,pairSuccessDeviceIdentityElementValue:c.value,pairSuccessDeviceJid:j.value,pairSuccessDeviceLid:k.value,pairSuccessDeviceBeta:e.value,pairSuccessPlatformName:f.value},a.value,{pairSuccessBiz:b.value}))}g.parseSetRegRequestPairSuccessBiz=h;g.parseSetRegRequest=a}),98);\n__d(\"WASmaxOutMdRegularCompanionSetRegResponseBundleMixin\",[\"WASmaxAttrs\",\"WASmaxChildren\",\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.keyAttestationKeyId;a=a.keyAttestationElementValue;b=d(\"WASmaxJsx\").smax(\"key_attestation\",{key_id:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").CUSTOM_STRING,b)},a);return b}function i(a){a=a.gpiaElementValue;a=d(\"WASmaxJsx\").smax(\"gpia\",null,a);return a}function j(a){var b=a.keyAttestationArgs,c=a.gpiaArgs,e=a.deviceIdentityKeyIndex;a=a.deviceIdentityElementValue;e=d(\"WASmaxJsx\").smax(\"smax$any\",null,d(\"WASmaxJsx\").smax(\"pair-device-sign\",null,d(\"WASmaxJsx\").smax(\"device-identity\",{\"key-index\":d(\"WAWap\").INT(e)},a),d(\"WASmaxChildren\").OPTIONAL_CHILD(h,b),d(\"WASmaxChildren\").OPTIONAL_CHILD(i,c)));return e}function a(a,b){b=j(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.makeRegularCompanionSetRegResponseBundlePairDeviceSignKeyAttestation=h;g.makeRegularCompanionSetRegResponseBundlePairDeviceSignGpia=i;g.mergeRegularCompanionSetRegResponseBundleMixin=a}),98);\n__d(\"WASmaxOutMdSetRegResponseClientResponse\",[\"WASmaxJsx\",\"WASmaxOutMdRegularCompanionSetRegResponseBundleMixin\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a,b){b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,b,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);b=d(\"WASmaxOutMdRegularCompanionSetRegResponseBundleMixin\").mergeRegularCompanionSetRegResponseBundleMixin(d(\"WASmaxJsx\").smax(\"iq\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").S_WHATSAPP_NET,type:\"result\"}),a);return b}g.makeSetRegResponseClientResponse=a}),98);\n__d(\"WASmaxOutMdIQErrorNotAuthorizedMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(){var a=d(\"WASmaxJsx\").smax(\"error\",{text:\"not-authorized\",code:d(\"WAWap\").INT(401)});return a}function a(a){var b=h();return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeIQErrorNotAuthorizedMixin=a}),98);\n__d(\"WASmaxOutMdSetRegResponseError\",[\"WASmaxJsx\",\"WASmaxOutMdIQErrorNotAuthorizedMixin\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);a=d(\"WASmaxJsx\").smax(\"iq\",{id:d(\"WAWap\").STANZA_ID(a.value),to:d(\"WAWap\").S_WHATSAPP_NET,type:\"error\"},d(\"WASmaxOutMdIQErrorNotAuthorizedMixin\").mergeIQErrorNotAuthorizedMixin(d(\"WASmaxJsx\").smax(\"error\",null)));return a}g.makeSetRegResponseError=a}),98);\n__d(\"WASmaxOutMdHostedCompanionSetRegResponseBundleMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.deviceIdentityElementValue;a=d(\"WASmaxJsx\").smax(\"smax$any\",null,d(\"WASmaxJsx\").smax(\"hosted-pair-set\",null,d(\"WASmaxJsx\").smax(\"device-identity\",null,a)));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeHostedCompanionSetRegResponseBundleMixin=a}),98);\n__d(\"WASmaxOutMdSetRegResponseHostedClientResponse\",[\"WASmaxJsx\",\"WASmaxOutMdHostedCompanionSetRegResponseBundleMixin\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a,b){b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,b,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);b=d(\"WASmaxOutMdHostedCompanionSetRegResponseBundleMixin\").mergeHostedCompanionSetRegResponseBundleMixin(d(\"WASmaxJsx\").smax(\"iq\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").S_WHATSAPP_NET,type:\"result\"}),a);return b}g.makeSetRegResponseHostedClientResponse=a}),98);\n__d(\"WASmaxMdSetRegRPC\",[\"WASmaxInMdSetRegRequest\",\"WASmaxOutMdSetRegResponseClientResponse\",\"WASmaxOutMdSetRegResponseError\",\"WASmaxOutMdSetRegResponseHostedClientResponse\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMdSetRegRequest\").parseSetRegRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"SetReg\",{Request:b}));return{parsedRequest:b.value,makeSetRegResponseClientResponse:function(b){return d(\"WASmaxOutMdSetRegResponseClientResponse\").makeSetRegResponseClientResponse(b,a)},makeSetRegResponseHostedClientResponse:function(b){return d(\"WASmaxOutMdSetRegResponseHostedClientResponse\").makeSetRegResponseHostedClientResponse(b,a)},makeSetRegResponseError:function(){return d(\"WASmaxOutMdSetRegResponseError\").makeSetRegResponseError(a)}}}g.receiveSetRegRPC=a}),98);\n__d(\"WAHandlePairSuccessProtocol\",[\"WAAdv\",\"WAResultOrError\",\"WASmaxMdSetRegRPC\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){a=d(\"WASmaxMdSetRegRPC\").receiveSetRegRPC(a);var b=a.makeSetRegResponseHostedClientResponse,c=a.makeSetRegResponseClientResponse,e=a.makeSetRegResponseError;a=a.parsedRequest;var f=a.pairSuccessDeviceIdentityElementValue,g=a.pairSuccessDeviceJid,h=a.pairSuccessPlatformName;a=a.pairSuccessBiz;return d(\"WAResultOrError\").makeResult({bizName:a==null?void 0:a.name,platformName:h,deviceJid:g,advSignedDeviceIdentityHmacProtobuf:d(\"WAAdv\").castToAdvSignedDeviceIdentityHmacProtobuf(f),makeSetRegResponseHostedClientResponse:b,makeSetRegResponseClientResponse:c,makeSetRegResponseError:e})}g.parsePairSuccess=a}),98);\n__d(\"WASmaxInPingsServerPingRequest\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!b.success)return b;b=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"get\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"xmlns\",\"urn:xmpp:ping\");if(!f.success)return f;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStanzaId,a,\"id\");return!a.success?a:d(\"WAResultOrError\").makeResult({from:b.value,t:c.value,type:e.value,xmlns:f.value,id:a.value})}g.parseServerPingRequest=a}),98);\n__d(\"WASmaxOutPingsServerPingResponseClientResponse\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=a.hasIqXmlnsUrnx3Axmppx3Aping;a=a.iqTo;b=d(\"WASmaxJsx\").smax(\"iq\",{xmlns:d(\"WASmaxAttrs\").OPTIONAL_LITERAL(\"urn:xmpp:ping\",b),to:d(\"WAWap\").JID(a),type:\"result\",id:d(\"WAWap\").generateId()});return b}g.makeServerPingResponseClientResponse=a}),98);\n__d(\"WASmaxOutPingsServerPingResponseClientResponseError\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b,c=a.iqTo,e=a.errorCode;a=a.errorText;c=d(\"WASmaxJsx\").smax(\"iq\",{to:(b=d(\"WAWap\")).JID(c),type:\"error\",id:b.generateId()},d(\"WASmaxJsx\").smax(\"error\",{code:b.CUSTOM_STRING(e),text:d(\"WASmaxAttrs\").OPTIONAL(b.CUSTOM_STRING,a)}));return c}g.makeServerPingResponseClientResponseError=a}),98);\n__d(\"WASmaxPingsServerPingRPC\",[\"WASmaxInPingsServerPingRequest\",\"WASmaxOutPingsServerPingResponseClientResponse\",\"WASmaxOutPingsServerPingResponseClientResponseError\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInPingsServerPingRequest\").parseServerPingRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"ServerPing\",{Request:a}));return{parsedRequest:a.value,makeServerPingResponseClientResponse:d(\"WASmaxOutPingsServerPingResponseClientResponse\").makeServerPingResponseClientResponse,makeServerPingResponseClientResponseError:d(\"WASmaxOutPingsServerPingResponseClientResponseError\").makeServerPingResponseClientResponseError}}g.receiveServerPingRPC=a}),98);\n__d(\"WACreateHandleIq\",[\"Promise\",\"WAAdv\",\"WAHandlePairDeviceProtocol\",\"WAHandlePairSuccessProtocol\",\"WAResultOrError\",\"WASmaxParseUtils\",\"WASmaxPingsServerPingRPC\",\"WAUnknownStanzaError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){var c=a.md,e=a.comms;return function(a){var f=a.attrs;switch(f.xmlns){case\"urn:xmpp:ping\":f=e==null?void 0:e.handleServerPing;if(f!=null){var g=d(\"WASmaxPingsServerPingRPC\").receiveServerPingRPC(a),i=g.parsedRequest.from,j=g.makeServerPingResponseClientResponse;return f({makeResponse:function(){return j({hasIqXmlnsUrnx3Axmppx3Aping:!1,iqTo:i})}}).then(d(\"WAResultOrError\").makeResult)}break;case\"md\":g=d(\"WASmaxParseUtils\").maybeChildren(a);if(g.success&&g.value!=null){f=g.value[0].tag;switch(f){case\"pair-device\":g=c==null?void 0:c.handlePairDevice;if(g!=null){f=d(\"WAHandlePairDeviceProtocol\").parsePairDevice(a);f=f.value;var k=f.makeAck;f=f.refs;return g({generateRegistrationQrCodeString:d(\"WAHandlePairDeviceProtocol\").generateRegistrationQrCodeString,makeAck:k,refs:f}).then(d(\"WAResultOrError\").makeResult)}break;case\"pair-success\":g=c==null?void 0:c.handlePairSuccess;if(g!=null){k=d(\"WAHandlePairSuccessProtocol\").parsePairSuccess(a);if(k.success)return g(babelHelpers[\"extends\"]({},k.value,{addDeviceSignatureToProtobuf:d(\"WAAdv\").addDeviceSignatureToProtobuf,verifyAdvSignedDeviceIdentity:d(\"WAAdv\").verifyAdvSignedDeviceIdentity})).then(d(\"WAResultOrError\").makeResult)}break}}}return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}}g.createHandleIq=a}),98);\n__d(\"WACommonMessageBase\",[\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b=a.id,c=a.t,e=a.folderMixin,f=a.offlineMixin,g=a.metaHideDecryptionPlaceholderMixin,h=a.frankingMixin;return{stanzaId:b,serverTs:d(\"WATimeUtils\").castToUnixTime(c),offline:f==null?void 0:f.offline,fbFolderId:e==null?void 0:e.folderId,hideDecryptionFailure:(g==null?void 0:g.metaDecryptFail)===\"hide\",frankingTag:h==null?void 0:(b=h.clientFrankingTagMixin)==null?void 0:b.frankingFrankingTagElementValue,reportingTag:h==null?void 0:h.frankingReportingTagElementValue,internalTestConfig:(c=a.internalTestMixin)==null?void 0:c.testConfig}}g.transformMessageParsedRequest=a}),98);\n__d(\"WAHandleGroupMessageProtocol\",[\"Promise\",\"WACryptoManagerUtils\",\"WACryptoPkcs7\",\"WAE2E.pb\",\"WAForceSecondRetryErrorTypes\",\"WAGlobals\",\"WAJids\",\"WALogger\",\"WAReceiptUtils\",\"WAResultOrError\",\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"decryptGroupMessage error: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Fail to save senderKeySession \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"missing sender key in dual enc message\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"enc version \",\" is not supported.\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unknown message content type: \",\"\"]);m=function(){return a};return a}function n(a){return a.name===\"GroupDualEncMedia\"?\"ContentTypeMedia\":a.value.contentDualMixins.name}function o(a){switch(a){case\"ContentTypeText\":return\"text\";case\"ContentTypeLiveLocationSingle\":return\"live_location\";case\"ContentTypeMedia\":return\"media\";case\"ContentTypeMediaSingle\":return\"media\";case\"ContentTypePayGroup\":return\"pay\";case\"ContentTypeReaction\":return\"reaction\";case\"ContentTypeProductList\":return\"product_list\";case\"ContentTypePollCreation\":return\"poll_creation\";case\"ContentTypePollVote\":return\"poll_vote\";case\"ContentTypeScheduledCall\":return\"scheduled_call\";default:a;d(\"WALogger\").ERROR(m(),a);return\"text\"}}function a(a){var b=a.from,c=a.participant;a=a.groupDualOrSingleEncMixinGroup;var e=d(\"WAJids\").extractUserJid(c);b={chat:b,author:e===d(\"WAGlobals\").getMyUserJid()?\"@me\":e,from:c};switch(a.name){case\"GroupSingleEnc\":e=a.value;c=e.groupRetryOrBotResponseMessageOrGroupRegularMixinGroup;e=e.contentSingleMixins;return babelHelpers[\"extends\"]({},b,{enc:p(c),contentType:o(e.name),type:\"SingleEnc\"});default:a.name;c=a.value.groupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup;e=n(c);return babelHelpers[\"extends\"]({},b,q(c),{type:\"DualEnc\",contentType:o(e)})}}function p(a){switch(a.name){case\"GroupRetry\":return{encVersion:a.value.encEncVersion2Or3OrFutureproofMixinGroup.value.v,ciphertext:a.value.encEncTypeIndividualMixin.elementValue,encType:a.value.encEncTypeIndividualMixin.type,retryCount:a.value.encEncRetryMixin.count};case\"GroupRegular\":a.name;return r(a.value.encEncVersion2Or3OrFutureproofMixinGroup.value,a.value.encEncTypeIndividualOrSenderKeyMixinGroup.value);default:a.name;return{ciphertext:a.value.encEncTypeMessageSecretMessageMixin.elementValue,encVersion:a.value.encEncVersion2OrFutureproofMixinGroup.value.v,encType:a.value.encEncTypeMessageSecretMessageMixin.type}}}function q(a){switch(a.name){case\"GroupDualEncNonMedia\":var b=a.value.enc,c=b[0];b=b[1];return{senderKeyDistributionEnc:r(c.encVersion2Or3OrFutureproofMixinGroup.value,c.encTypeSenderKeyOrIndividualMixinGroup.value),senderKeyMessageEnc:r(b.encVersion2Or3OrFutureproofMixinGroup.value,b.encTypeSenderKeyOrIndividualMixinGroup.value)};default:a.name;c=a.value.enc;b=c[0];a=c[1];return{senderKeyDistributionEnc:r(b.encVersion2Or3OrFutureproofMixinGroup.value,b.encTypeSenderKeyAndGroupMediaOrIndividualMixinGroup.value),senderKeyMessageEnc:r(a.encVersion2Or3OrFutureproofMixinGroup.value,a.encTypeSenderKeyAndGroupMediaOrIndividualMixinGroup.value)}}}function r(a,b){return{encVersion:a.v,ciphertext:b.elementValue,encType:b.type}}function c(a,b){return s(a,b)}function s(a,b){switch(a.type){case\"DualEnc\":var c=a.senderKeyDistributionEnc,e=a.senderKeyMessageEnc,f=a.from,g=a.chat,h=a.author;return t(c,f,g,b).then(function(a){if(!a.success)return a;if(c.encVersion!==\"2\"){d(\"WALogger\").WARN(l(),c.encVersion);return d(\"WAResultOrError\").makeError(\"unknown-sender-key-distribution-plaintext\")}a=a.value.plaintext;a=d(\"WACryptoPkcs7\").unpadPkcs7(a);a=d(\"decodeProtobuf\").decodeProtobuf(d(\"WAE2E.pb\").MessageSpec,a);a=(a=a.senderKeyDistributionMessage)==null?void 0:a.axolotlSenderKeyDistributionMessage;if(a==null){d(\"WALogger\").ERROR(k());return d(\"WAResultOrError\").makeError(\"group-decrypt-error\")}return d(\"WACryptoManagerUtils\").saveSenderKeySession(g,f,new Uint8Array(a),b).then(function(a){if(!a.success){d(\"WALogger\").ERROR(j(),a.error);return d(\"WAResultOrError\").makeError(\"group-decrypt-error\")}return t(e,f,g,b)})}).then(function(a){return!a.success?{from:f,chat:g,author:h,retryCount:0,error:a.error,encVersion:e.encVersion,type:\"Undecrypted\"}:{from:f,chat:g,author:h,encVersion:e.encVersion,plaintext:a.value.plaintext,type:\"Decrypted\"}});default:a.type;var i=a.enc,m=a.from,n=a.chat,o=a.author;return t(i,m,n,b).then(function(a){if(!a.success){var b;return{from:m,chat:n,author:o,retryCount:(b=i.retryCount)!=null?b:0,error:a.error,encVersion:i.encVersion,type:\"Undecrypted\"}}return{from:m,chat:n,author:o,encVersion:i.encVersion,plaintext:a.value.plaintext,type:\"Decrypted\"}})}}function t(a,c,e,f){var g;a.encType===\"msg\"||a.encType===\"pkmsg\"?g=d(\"WACryptoManagerUtils\").decryptMsg(a.encType,c,a.ciphertext,f):a.encType===\"skmsg\"?(a.encType,g=d(\"WACryptoManagerUtils\").decryptGroupMsg(e,c,a.ciphertext,f)):(a.encType,g=(h||(h=b(\"Promise\"))).resolve({}));return g.then(function(a){if(!a.success){d(\"WALogger\").ERROR(i(),a.error);return d(\"WAResultOrError\").makeError(\"group-decrypt-error\")}return a.value==null?d(\"WAResultOrError\").makeError(\"missing-content\"):d(\"WAResultOrError\").makeResult({plaintext:a.value.plaintext,remoteIdentity:a.value.remoteIdentity})})}e=function(a,b){var c=a.stanzaId,e=a.serverTs,f=a.retryCount,g=a.from,h=a.author,i=a.chat,j=a.deviceIdentity;a=a.error;h=h===\"@me\";var k=f;d(\"WAForceSecondRetryErrorTypes\").FORCE_SECOND_RETRY_ON.has(a)&&(k=Math.max(2,f));return d(\"WAReceiptUtils\").makeRetryReceipt({category:null,externalId:c,from:{groupJid:i,type:\"group\"},participant:g,recipient:h?d(\"WAJids\").extractUserJid(g):null,retryCount:k,ts:e,deviceIdentity:j},b)};g.parseGroupMessage=a;g.decryptGroupMessage=c;g.makeGrouplMessageRetryReceipt=e}),98);\n__d(\"WASendDeliveryReceiptProtocol\",[\"Promise\",\"WAComms\",\"WAGlobals\",\"WAJids\",\"WASmaxOutReceiptPublishDeliveryRequest\",\"WASmaxOutReceiptPublishSenderRequest\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;c=function(a){var c=a.stanzaId,e=a.author;a=a.from;if(!d(\"WAJids\").isAuthorMe(e))return(h||(h=b(\"Promise\"))).resolve(d(\"WAComms\").castSmaxStanza(l({recipient:e,from:a,stanzaId:c})));else return(h||(h=b(\"Promise\"))).resolve(d(\"WAComms\").castSmaxStanza(m({recipient:d(\"WAGlobals\").getMyUserJid(),stanzaId:c,recipientDevice:a})))};function i(a){var b=a.stanzaId,c=a.from;a=a.chat;var e=d(\"WAJids\").extractUserJid(c);return d(\"WAJids\").switchOnMsgrChatJidType(a,{group:function(a){return e===d(\"WAGlobals\").getMyUserJid()?j({chat:a,from:c,stanzaId:b}):k({chat:a,from:c,stanzaId:b})},user:function(a){return e===d(\"WAGlobals\").getMyUserJid()?m({recipient:e,recipientDevice:c,stanzaId:b}):l({recipient:e,from:c,stanzaId:b})}})}function a(a){d(\"WAComms\").castSmaxStanza(i(a))}function j(a){var b=a.stanzaId,c=a.chat;a=a.from;c={publishSenderGroupDeviceSenderType:{receiptTo:c,receiptParticipant:a}};a={single:{receiptId:b}};b={publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs:c,senderAggregatedPublishOrSingleMixinGroupArgs:a};return d(\"WASmaxOutReceiptPublishSenderRequest\").makePublishSenderRequest(b)}function k(a){var b=a.stanzaId,c=a.chat;a=a.from;c={device:{deviceMixinsArgs:{groupDevice:{receiptTo:c,receiptParticipant:a}}}};a={single:{receiptId:b}};b={senderAggregatedPublishOrSingleMixinGroupArgs:a,userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs:c};return d(\"WASmaxOutReceiptPublishDeliveryRequest\").makePublishDeliveryRequest(b)}function l(a){var b=a.stanzaId;a=a.from;a={device:{deviceMixinsArgs:{individualDevice:{receiptTo:a}}}};b={single:{receiptId:b}};b={senderAggregatedPublishOrSingleMixinGroupArgs:b,userOrDeviceOrInteropUserOrInteropDeviceMixinGroupArgs:a};return d(\"WASmaxOutReceiptPublishDeliveryRequest\").makePublishDeliveryRequest(b)}function m(a){var b=a.recipientDevice,c=a.recipient;a=a.stanzaId;c={publishSenderIndividualDeviceSenderType:{receiptRecipient:c,receiptTo:b}};b={single:{receiptId:a}};a={publishSenderGroupOrPublishSenderIndividualOrPublishSenderStatusOrPublishSenderBroadcastDeviceSenderTypeMixinGroupArgs:c,senderAggregatedPublishOrSingleMixinGroupArgs:b};return d(\"WASmaxOutReceiptPublishSenderRequest\").makePublishSenderRequest(a)}g.sendIndividualMessageDeliveryReceipt=c;g.makeDeliveryReceipt=i;g.sendDeliveryReceipt=a}),98);\n__d(\"WACreateHandleGroupMessageBranch\",[\"WAHandleGroupMessageProtocol\",\"WAResultOrError\",\"WASendDeliveryReceiptProtocol\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return function(b){var c=b.groupMixin,e=b.commonMessageBase,f=b.makeAck;b=b.ctx;c=d(\"WAHandleGroupMessageProtocol\").parseGroupMessage(c);return a(babelHelpers[\"extends\"]({},e,{parsedMessage:c,makeAck:f,makeDeliveryReceipt:d(\"WASendDeliveryReceiptProtocol\").makeDeliveryReceipt,makeRetryReceipt:d(\"WAHandleGroupMessageProtocol\").makeGrouplMessageRetryReceipt}),b).then(d(\"WAResultOrError\").makeResult)}}g.createHandleGroupMessageBranch=a}),98);\n__d(\"WACreateHandleIndividualMessageBranch\",[\"WAHandleIndividualMessageProtocol\",\"WAResultOrError\",\"WASendDeliveryReceiptProtocol\",\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"starting...\"]);h=function(){return a};return a}var i=d(\"WATagsLogger\").TAGS([\"handleIndividualMessageBranch\"]);function a(a){return function(b){var c,e=b.individualMixin,f=b.commonMessageBase,g=b.makeAck;b=b.ctx;i.DEV(h());e=(c=d(\"WAHandleIndividualMessageProtocol\")).parseIndividualMessage(e);return a(babelHelpers[\"extends\"]({},f,{parsedMessage:e,makeAck:g,sendRetryReceipt:c.sendIndividualMessageRetryReceipt,sendDeliveryReceipt:d(\"WASendDeliveryReceiptProtocol\").sendIndividualMessageDeliveryReceipt,makeDeliveryReceipt:d(\"WASendDeliveryReceiptProtocol\").makeDeliveryReceipt,makeRetryReceipt:c.makeIndividualMessageRetryReceipt,decodeMessage:c.decodeIndividualMessage}),b).then(d(\"WAResultOrError\").makeResult)}}g.createHandleIndividualMessageBranch=a}),98);\n__d(\"WASmaxInReceiptEnums\",[\"WAJids\"],(function(a,b,c,d,e,f,g){a={0:\"0\",1:\"1\",7:\"7\"};b={1002:\"1002\",1007:\"1007\",1008:\"1008\"};c={all:\"all\",none:\"none\"};e={\"body-link\":\"body-link\",\"cta-call\":\"cta-call\",\"cta-url\":\"cta-url\",\"media-doc\":\"media-doc\",\"media-image\":\"media-image\",\"media-video\":\"media-video\",\"quick-reply\":\"quick-reply\"};f={\"cancellation-failed\":\"cancellation-failed\",\"invalid-transition\":\"invalid-transition\"};var h={CBP:\"CBP\",NBP:\"NBP\"},i={content:\"content\",title:\"title\"},j={delivery:\"delivery\",no_optimization:\"no_optimization\"},k={deliver:\"deliver\",delivery:\"delivery\"},l={\"false\":\"false\",\"true\":\"true\"},m={\"hsm-envelope-mismatch\":\"hsm-envelope-mismatch\",\"structure-unavailable\":\"structure-unavailable\"},n={validators:[(d=d(\"WAJids\")).validateBroadcastJid,d.validateGroupJid],typeName:\"BroadcastJid|GroupJid\"},o={validators:[d.validateBroadcastJid,d.validateGroupJid,d.validateNewsletterJid,d.validateStatusJid],typeName:\"BroadcastJid|GroupJid|NewsletterJid|StatusJid\"},p={validators:[d.validateDeviceJid,d.validateBroadcastJid,d.validateDeviceJid,d.validateGroupJid],typeName:\"DeviceJid|BroadcastJid|DeviceJid|GroupJid\"},q={validators:[d.validateDeviceJid,d.validateBroadcastJid,d.validateDeviceJid,d.validateGroupJid,d.validateNewsletterJid,d.validateStatusJid],typeName:\"DeviceJid|BroadcastJid|DeviceJid|GroupJid|NewsletterJid|StatusJid\"},r={validators:[d.validateDeviceJid,d.validateDeviceJid],typeName:\"DeviceJid|DeviceJid\"};d={validators:[d.validateDeviceJid,d.validateUserJid,d.validateDeviceJid],typeName:\"DeviceJid|UserJid|DeviceJid\"};g.ENUM_0_1_7=a;g.ENUM_1002_1007_1008=b;g.ENUM_ALL_NONE=c;g.ENUM_BODYLINK_CTACALL_CTAURL_MEDIADOC_MEDIAIMAGE_MEDIAVIDEO_QUICKREPLY=e;g.ENUM_CANCELLATIONFAILED_INVALIDTRANSITION=f;g.ENUM_CBP_NBP=h;g.ENUM_CONTENT_TITLE=i;g.ENUM_DELIVERY_NOOPTIMIZATION=j;g.ENUM_DELIVER_DELIVERY=k;g.ENUM_FALSE_TRUE=l;g.ENUM_HSMENVELOPEMISMATCH_STRUCTUREUNAVAILABLE=m;g.BROADCASTJID_GROUPJID=n;g.BROADCASTJID_GROUPJID_NEWSLETTERJID_STATUSJID=o;g.DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID=p;g.DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_NEWSLETTERJID_STATUSJID=q;g.DEVICEJID_DEVICEJID=r;g.DEVICEJID_USERJID_DEVICEJID=d}),98);\n__d(\"WASmaxInReceiptDeprecatedEditMixin\",[\"WAResultOrError\",\"WASmaxInReceiptEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrStringEnum(a,\"edit\",d(\"WASmaxInReceiptEnums\").ENUM_0_1_7);return!a.success?a:d(\"WAResultOrError\").makeResult({edit:a.value})}g.parseDeprecatedEditMixin=a}),98);\n__d(\"WASmaxInReceiptPublishSuccessMixin\",[\"WAResultOrError\",\"WASmaxInReceiptDeprecatedEditMixin\",\"WASmaxInReceiptEnums\",\"WASmaxParseReference\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"ack\");if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"id\"]);if(!c.success)return c;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"id\",c.value);if(!c.success)return c;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"class\",\"receipt\");if(!c.success)return c;var e=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"to\"]);if(!e.success)return e;e=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"from\",e.value);if(!e.success)return e;e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"t\",0,void 0);if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"readreceipts\",d(\"WASmaxInReceiptEnums\").ENUM_ALL_NONE);if(!f.success)return f;b=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"type\"]);if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",b.value);if(!b.success)return b;b=d(\"WASmaxInReceiptDeprecatedEditMixin\").parseDeprecatedEditMixin(a);return d(\"WAResultOrError\").makeResult({\"class\":c.value,t:e.value,readreceipts:f.value,deprecatedEditMixin:b.success?b.value:null})}g.parsePublishSuccessMixin=a}),98);\n__d(\"WASmaxInReceiptPublishPeerDeliveryResponseSuccess\",[\"WASmaxInReceiptPublishSuccessMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"ack\");if(!c.success)return c;c=d(\"WASmaxInReceiptPublishSuccessMixin\").parsePublishSuccessMixin(a,b);return!c.success?c:c}g.parsePublishPeerDeliveryResponseSuccess=a}),98);\n__d(\"WASmaxOutReceiptPeerMessageTypeMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(){var a=d(\"WASmaxJsx\").smax(\"receipt\",{type:\"peer_msg\"});return a}function a(a){var b=h();return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergePeerMessageTypeMixin=a}),98);\n__d(\"WASmaxOutReceiptPublishPeerDeliveryRequest\",[\"WASmaxJsx\",\"WASmaxOutReceiptIndividualDeviceMixin\",\"WASmaxOutReceiptPeerMessageTypeMixin\",\"WASmaxOutReceiptSingleMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutReceiptPeerMessageTypeMixin\").mergePeerMessageTypeMixin(d(\"WASmaxOutReceiptSingleMixin\").mergeSingleMixin(d(\"WASmaxOutReceiptIndividualDeviceMixin\").mergeIndividualDeviceMixin(d(\"WASmaxJsx\").smax(\"receipt\",null),a),a));return a}g.makePublishPeerDeliveryRequest=a}),98);\n__d(\"WASmaxReceiptPublishPeerDeliveryRPC\",[\"WAComms\",\"WASmaxInReceiptPublishPeerDeliveryResponseSuccess\",\"WASmaxOutReceiptPublishPeerDeliveryRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:e=d(\"WASmaxOutReceiptPublishPeerDeliveryRequest\").makePublishPeerDeliveryRequest(a);h.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(e,c));case 3:f=h.sent;g=d(\"WASmaxInReceiptPublishPeerDeliveryResponseSuccess\").parsePublishPeerDeliveryResponseSuccess(f,e);if(!g.success){h.next=7;break}return h.abrupt(\"return\",{name:\"PublishPeerDeliveryResponseSuccess\",value:g.value});case 7:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"PublishPeerDelivery\",{Success:g}));case 8:case\"end\":return h.stop()}},null,this)}g.sendPublishPeerDeliveryRPC=a}),98);\n__d(\"WASmaxInReceiptPublishPeerReadResponseSuccess\",[\"WASmaxInReceiptPublishSuccessMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"ack\");if(!c.success)return c;c=d(\"WASmaxInReceiptPublishSuccessMixin\").parsePublishSuccessMixin(a,b);return!c.success?c:c}g.parsePublishPeerReadResponseSuccess=a}),98);\n__d(\"WASmaxOutReceiptHistorySyncTypeMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(){var a=d(\"WASmaxJsx\").smax(\"receipt\",{type:\"hist_sync\"});return a}function a(a){var b=h();return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeHistorySyncTypeMixin=a}),98);\n__d(\"WASmaxOutReceiptPublishPeerReadRequest\",[\"WASmaxJsx\",\"WASmaxOutReceiptHistorySyncTypeMixin\",\"WASmaxOutReceiptIndividualDeviceMixin\",\"WASmaxOutReceiptSingleMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutReceiptHistorySyncTypeMixin\").mergeHistorySyncTypeMixin(d(\"WASmaxOutReceiptSingleMixin\").mergeSingleMixin(d(\"WASmaxOutReceiptIndividualDeviceMixin\").mergeIndividualDeviceMixin(d(\"WASmaxJsx\").smax(\"receipt\",null),a),a));return a}g.makePublishPeerReadRequest=a}),98);\n__d(\"WASmaxReceiptPublishPeerReadRPC\",[\"WAComms\",\"WASmaxInReceiptPublishPeerReadResponseSuccess\",\"WASmaxOutReceiptPublishPeerReadRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:e=d(\"WASmaxOutReceiptPublishPeerReadRequest\").makePublishPeerReadRequest(a);h.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(e,c));case 3:f=h.sent;g=d(\"WASmaxInReceiptPublishPeerReadResponseSuccess\").parsePublishPeerReadResponseSuccess(f,e);if(!g.success){h.next=7;break}return h.abrupt(\"return\",{name:\"PublishPeerReadResponseSuccess\",value:g.value});case 7:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"PublishPeerRead\",{Success:g}));case 8:case\"end\":return h.stop()}},null,this)}g.sendPublishPeerReadRPC=a}),98);\n__d(\"WAHandlePeerMessageProtocol\",[\"WACryptoManagerUtils\",\"WACryptoPkcs7\",\"WAE2E.pb\",\"WALogger\",\"WAReceiptUtils\",\"WAResultOrError\",\"WASmaxReceiptPublishPeerDeliveryRPC\",\"WASmaxReceiptPublishPeerReadRPC\",\"WATransformRetryOrIndividualRegularMixinGroup\",\"decodeProtobuf\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"decodePeerMessage: no protocolMessage.\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"decodePeerMessage: enc version \",\" is not supported.\"]);i=function(){return a};return a}function a(a){var b=a.from;a=a.retryOrIndividualRegularMixinGroup;return babelHelpers[\"extends\"]({from:b},d(\"WATransformRetryOrIndividualRegularMixinGroup\").transformRetryOrIndividualRegularMixinGroup(a))}function b(a,b){var c=a.from,e=a.ciphertext,f=a.encType,g=a.encVersion;return d(\"WACryptoManagerUtils\").decryptMsg(f,c,e,b).then(function(a){if(!a.success)return a;return a.value==null?d(\"WAResultOrError\").makeError(\"missing-content\"):d(\"WAResultOrError\").makeResult({encVersion:g,plaintext:a.value.plaintext,remoteIdentity:a.value.remoteIdentity})})}function c(a){a=a.decryptedMessage;var b=a.plaintext;a=a.encVersion;if(a!==\"2\"){d(\"WALogger\").WARN(i(),a);return d(\"WAResultOrError\").makeError(\"unknown-plaintext\")}a=d(\"WACryptoPkcs7\").unpadPkcs7(b);b=d(\"decodeProtobuf\").decodeProtobuf(d(\"WAE2E.pb\").MessageSpec,a);if(b.protocolMessage==null){d(\"WALogger\").WARN(h());return d(\"WAResultOrError\").makeError(\"missing-protocol-message\")}return d(\"WAResultOrError\").makeResult(b.protocolMessage)}function e(a){var b=a.stanzaId;a=a.to;return d(\"WASmaxReceiptPublishPeerDeliveryRPC\").sendPublishPeerDeliveryRPC({receiptId:b,receiptTo:a}).then(function(){})}function f(a){var b=a.stanzaId;a=a.to;return d(\"WASmaxReceiptPublishPeerReadRPC\").sendPublishPeerReadRPC({receiptId:b,receiptTo:a}).then(function(){})}function j(a,b){var c=a.stanzaId,e=a.serverTs,f=a.retryCount,g=a.from;a=a.deviceIdentity;return d(\"WAReceiptUtils\").sendRetryReceipt({category:\"peer\",externalId:c,from:{deviceJid:g,type:\"device\"},participant:null,recipient:null,retryCount:f,ts:e,deviceIdentity:a},b)}g.parsePeerMessage=a;g.decryptPeerMessage=b;g.decodePeerMessage=c;g.sendPeerMessageReceipt=e;g.sendHistorySyncReceipt=f;g.sendPeerMessageRetryReceipt=j}),98);\n__d(\"WASmaxInMessageDeliverContentTypeTextMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"text\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseContentTypeTextMixin=a}),98);\n__d(\"WASmaxInMessageDeliverDeviceIdentityMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"device-identity\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentBytes(a.value);return!a.success?a:d(\"WAResultOrError\").makeResult({deviceIdentityElementValue:a.value})}g.parseDeviceIdentityMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEnums\",[\"WAJids\"],(function(a,b,c,d,e,f,g){a={0:\"0\",1:\"1\"};b={1:\"1\",2:\"2\"};c={1:\"1\",3:\"3\"};e={ACCEPT:\"ACCEPT\",REJECT:\"REJECT\",UNKNOWN:\"UNKNOWN\"};f={address_message:\"address_message\",form_message:\"form_message\",galaxy_message:\"galaxy_message\",menu_options:\"menu_options\"};var h={address_message:\"address_message\",galaxy_message:\"galaxy_message\"},i={allowlist:\"allowlist\",contacts:\"contacts\",denylist:\"denylist\"},j={allow:\"allow\",bypass:\"bypass\",deny:\"deny\",error:\"error\"},k={ASPRESENTED:\"ASPRESENTED\",BIMONTHLY:\"BIMONTHLY\",DAILY:\"DAILY\",FORTNIGHTLY:\"FORTNIGHTLY\",HALFYEARLY:\"HALFYEARLY\",MONTHLY:\"MONTHLY\",ONETIME:\"ONETIME\",QUARTERLY:\"QUARTERLY\",UNKNOWN:\"UNKNOWN\",WEEKLY:\"WEEKLY\",YEARLY:\"YEARLY\"},l={audio:\"audio\",avatar_sticker:\"avatar_sticker\",buttons_response:\"buttons_response\",cataloglink:\"cataloglink\",contact:\"contact\",contact_array:\"contact_array\",document:\"document\",genai_sticker:\"genai_sticker\",gif:\"gif\",history:\"history\",image:\"image\",list_response:\"list_response\",location:\"location\",native_flow_response:\"native_flow_response\",order:\"order\",product:\"product\",productlink:\"productlink\",ptt:\"ptt\",ptv:\"ptv\",sticker:\"sticker\",url:\"url\",vcard:\"vcard\",video:\"video\",xma:\"xma\"},m={audio:\"audio\",avatar_sticker:\"avatar_sticker\",buttons_response:\"buttons_response\",cataloglink:\"cataloglink\",contact:\"contact\",contact_array:\"contact_array\",document:\"document\",gif:\"gif\",history:\"history\",image:\"image\",list_response:\"list_response\",location:\"location\",native_flow_response:\"native_flow_response\",order:\"order\",product:\"product\",productlink:\"productlink\",ptt:\"ptt\",ptv:\"ptv\",sticker:\"sticker\",url:\"url\",vcard:\"vcard\",video:\"video\",xma:\"xma\"},n={audio:\"audio\",avatar_sticker:\"avatar_sticker\",cataloglink:\"cataloglink\",document:\"document\",genai_sticker:\"genai_sticker\",gif:\"gif\",image:\"image\",productlink:\"productlink\",ptt:\"ptt\",sticker:\"sticker\",url:\"url\",vcard:\"vcard\",video:\"video\"},o={buyer:\"buyer\",seller:\"seller\"},p={card:\"card\",\"net-banking\":\"net-banking\",upi:\"upi\",wallet:\"wallet\"},q={catalog_message:\"catalog_message\",laneline_call:\"laneline_call\",menu_options:\"menu_options\",novi_complete_transaction:\"novi_complete_transaction\",novi_hub:\"novi_hub\",novi_login:\"novi_login\",novi_report_transaction:\"novi_report_transaction\",novi_view_bank_detail:\"novi_view_bank_detail\",novi_view_card_detail:\"novi_view_card_detail\",novi_view_code:\"novi_view_code\",novi_view_transaction:\"novi_view_transaction\",order_details:\"order_details\",order_status:\"order_status\",otp:\"otp\",payment_method:\"payment_method\",payment_status:\"payment_status\",voice_call:\"voice_call\"},r={creation:\"creation\",edit:\"edit\"},s={creation:\"creation\",edit:\"edit\",response:\"response\"},t={ctwa:\"ctwa\",username:\"username\"},u={EXACT:\"EXACT\",MAX:\"MAX\"},v={FAILURE:\"FAILURE\",INIT:\"INIT\",SUCCESS:\"SUCCESS\"},w={\"false\":\"false\",\"true\":\"true\"},x={FBPAY:\"FBPAY\",NOVI:\"NOVI\",P2M_LITE:\"P2M_LITE\",UPI:\"UPI\"},y={first:\"first\",full:\"full\",inner:\"inner\",last:\"last\"},z={FULL:\"FULL\",MISSING_FIELD_NOT_PARTIAL:\"MISSING_FIELD_NOT_PARTIAL\",PARTIAL:\"PARTIAL\"},A={high:\"high\",high_force:\"high_force\",low:\"low\"},B={high:\"high\",low:\"low\",unknown:\"unknown\"},C={HPP_PAYMENT_LINK:\"HPP_PAYMENT_LINK\",UPI:\"UPI\"},D={incentive:\"incentive\",p2m:\"p2m\",p2p:\"p2p\",payout:\"payout\"},E={lid:\"lid\",pn:\"pn\"},F={matched:\"matched\",unmatched:\"unmatched\"},G={msg:\"msg\",pkmsg:\"pkmsg\"},H={request:\"request\",send:\"send\"},I={validators:[(d=d(\"WAJids\")).validateDeviceJid,d.validateBroadcastJid,d.validateDeviceJid,d.validateGroupJid,d.validateStatusJid],typeName:\"DeviceJid|BroadcastJid|DeviceJid|GroupJid|StatusJid\"},J={validators:[d.validateDeviceJid,d.validateDeviceJid],typeName:\"DeviceJid|DeviceJid\"},K={validators:[d.validateDeviceJid,d.validateDeviceJid,d.validateDeviceJid],typeName:\"DeviceJid|DeviceJid|DeviceJid\"};d={validators:[d.validateGroupJid,d.validateUserJid],typeName:\"GroupJid|UserJid\"};g.ENUM_0_1=a;g.ENUM_1_2=b;g.ENUM_1_3=c;g.ENUM_ACCEPT_REJECT_UNKNOWN=e;g.ENUM_ADDRESSMESSAGE_FORMMESSAGE_GALAXYMESSAGE_MENUOPTIONS=f;g.ENUM_ADDRESSMESSAGE_GALAXYMESSAGE=h;g.ENUM_ALLOWLIST_CONTACTS_DENYLIST=i;g.ENUM_ALLOW_BYPASS_DENY_ERROR=j;g.ENUM_ASPRESENTED_BIMONTHLY_DAILY_FORTNIGHTLY_HALFYEARLY_MONTHLY_ONETIME_QUARTERLY_UNKNOWN_WEEKLY_YEARLY=k;g.ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_GENAISTICKER_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_URL_VCARD_VIDEO_XMA=l;g.ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_URL_VCARD_VIDEO_XMA=m;g.ENUM_AUDIO_AVATARSTICKER_CATALOGLINK_DOCUMENT_GENAISTICKER_GIF_IMAGE_PRODUCTLINK_PTT_STICKER_URL_VCARD_VIDEO=n;g.ENUM_BUYER_SELLER=o;g.ENUM_CARD_NETBANKING_UPI_WALLET=p;g.ENUM_CATALOGMESSAGE_LANELINECALL_MENUOPTIONS_NOVICOMPLETETRANSACTION_NOVIHUB_NOVILOGIN_NOVIREPORTTRANSACTION_NOVIVIEWBANKDETAIL_NOVIVIEWCARDDETAIL_NOVIVIEWCODE_NOVIVIEWTRANSACTION_ORDERDETAILS_ORDERSTATUS_OTP_PAYMENTMETHOD_PAYMENTSTATUS_VOICECALL=q;g.ENUM_CREATION_EDIT=r;g.ENUM_CREATION_EDIT_RESPONSE=s;g.ENUM_CTWA_USERNAME=t;g.ENUM_EXACT_MAX=u;g.ENUM_FAILURE_INIT_SUCCESS=v;g.ENUM_FALSE_TRUE=w;g.ENUM_FBPAY_NOVI_P2MLITE_UPI=x;g.ENUM_FIRST_FULL_INNER_LAST=y;g.ENUM_FULL_MISSINGFIELDNOTPARTIAL_PARTIAL=z;g.ENUM_HIGH_HIGHFORCE_LOW=A;g.ENUM_HIGH_LOW_UNKNOWN=B;g.ENUM_HPPPAYMENTLINK_UPI=C;g.ENUM_INCENTIVE_P2M_P2P_PAYOUT=D;g.ENUM_LID_PN=E;g.ENUM_MATCHED_UNMATCHED=F;g.ENUM_MSG_PKMSG=G;g.ENUM_REQUEST_SEND=H;g.DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_STATUSJID=I;g.DEVICEJID_DEVICEJID=J;g.DEVICEJID_DEVICEJID_DEVICEJID=K;g.GROUPJID_USERJID=d}),98);\n__d(\"WASmaxInMessageDeliverRegistrationIDMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"registration\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentBytesRange(a.value,4,4);return!a.success?a:d(\"WAResultOrError\").makeResult({registrationElementValue:a.value})}g.parseRegistrationIDMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"decrypt-fail\",\"hide\");return!b.success?b:d(\"WAResultOrError\").makeResult({decryptFail:b.value})}g.parseEncHideDecryptionPlaceholderMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncPayloadMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentBytesRange(a,1,1048576);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}g.parseEncPayloadMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncTypeIndividualMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin\",\"WASmaxInMessageDeliverEncPayloadMixin\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"type\",d(\"WASmaxInMessageDeliverEnums\").ENUM_MSG_PKMSG);if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin\").parseEncHideDecryptionPlaceholderMixin(a);a=d(\"WASmaxInMessageDeliverEncPayloadMixin\").parseEncPayloadMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({type:b.value,encHideDecryptionPlaceholderMixin:c.success?c.value:null},a.value))}g.parseEncTypeIndividualMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncVersion2Mixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"v\",\"2\");return!b.success?b:d(\"WAResultOrError\").makeResult({v:b.value})}g.parseEncVersion2Mixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncVersion3Mixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"v\",\"3\");return!b.success?b:d(\"WAResultOrError\").makeResult({v:b.value})}g.parseEncVersion3Mixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncVersionFutureproofMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"v\",3,void 0);return!b.success?b:d(\"WAResultOrError\").makeResult({v:b.value})}g.parseEncVersionFutureproofMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncVersion2Mixin\",\"WASmaxInMessageDeliverEncVersion3Mixin\",\"WASmaxInMessageDeliverEncVersionFutureproofMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverEncVersion2Mixin\").parseEncVersion2Mixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"EncVersion2\",value:b.value});var c=d(\"WASmaxInMessageDeliverEncVersion3Mixin\").parseEncVersion3Mixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"EncVersion3\",value:c.value});var e=d(\"WASmaxInMessageDeliverEncVersionFutureproofMixin\").parseEncVersionFutureproofMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"EncVersionFutureproof\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"EncVersion2\",\"EncVersion3\",\"EncVersionFutureproof\"],[b,c,e])}g.parseEncVersion2Or3OrFutureproofMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverIndividualRegularMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncTypeIndividualMixin\",\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"enc\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverEncTypeIndividualMixin\").parseEncTypeIndividualMixin(b.value);if(!a.success)return a;b=d(\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\").parseEncVersion2Or3OrFutureproofMixinGroup(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult({encEncTypeIndividualMixin:a.value,encEncVersion2Or3OrFutureproofMixinGroup:b.value})}g.parseIndividualRegularMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncRetryMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"count\",1,4);return!b.success?b:d(\"WAResultOrError\").makeResult({count:b.value})}g.parseEncRetryMixin=a}),98);\n__d(\"WASmaxInMessageDeliverRetryMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncRetryMixin\",\"WASmaxInMessageDeliverEncTypeIndividualMixin\",\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"enc\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverEncRetryMixin\").parseEncRetryMixin(b.value);if(!a.success)return a;var c=d(\"WASmaxInMessageDeliverEncTypeIndividualMixin\").parseEncTypeIndividualMixin(b.value);if(!c.success)return c;b=d(\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\").parseEncVersion2Or3OrFutureproofMixinGroup(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult({encEncRetryMixin:a.value,encEncTypeIndividualMixin:c.value,encEncVersion2Or3OrFutureproofMixinGroup:b.value})}g.parseRetryMixin=a}),98);\n__d(\"WASmaxInMessageDeliverRetryOrIndividualRegularMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverIndividualRegularMixin\",\"WASmaxInMessageDeliverRetryMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverRetryMixin\").parseRetryMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"Retry\",value:b.value});var c=d(\"WASmaxInMessageDeliverIndividualRegularMixin\").parseIndividualRegularMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"IndividualRegular\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Retry\",\"IndividualRegular\"],[b,c])}g.parseRetryOrIndividualRegularMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverPeerRequest\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeTextMixin\",\"WASmaxInMessageDeliverDeviceIdentityMixin\",\"WASmaxInMessageDeliverEnums\",\"WASmaxInMessageDeliverRegistrationIDMixin\",\"WASmaxInMessageDeliverRetryOrIndividualRegularMixinGroup\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"category\",\"peer\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"push_priority\",d(\"WASmaxInMessageDeliverEnums\").ENUM_HIGH_HIGHFORCE_LOW);if(!e.success)return e;var f=d(\"WASmaxParseJid\").attrDeviceJid(a,\"from\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!g.success)return g;var h=d(\"WASmaxInMessageDeliverContentTypeTextMixin\").parseContentTypeTextMixin(a);if(!h.success)return h;var i=d(\"WASmaxInMessageDeliverRegistrationIDMixin\").parseRegistrationIDMixin(a),j=d(\"WASmaxInMessageDeliverDeviceIdentityMixin\").parseDeviceIdentityMixin(a);a=d(\"WASmaxInMessageDeliverRetryOrIndividualRegularMixinGroup\").parseRetryOrIndividualRegularMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({id:b.value,category:c.value,pushPriority:e.value,from:f.value,t:g.value},h.value,{registrationIDMixin:i.success?i.value:null,deviceIdentityMixin:j.success?j.value:null,retryOrIndividualRegularMixinGroup:a.value}))}g.parsePeerRequest=a}),98);\n__d(\"WASmaxOutMessageDeliverPeerResponseSuccess\",[\"WASmaxJsx\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrDeviceJid,a,[\"from\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{to:d(\"WAWap\").DEVICE_JID(b.value),\"class\":\"message\",id:d(\"WAWap\").STANZA_ID(c.value),type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}g.makePeerResponseSuccess=a}),98);\n__d(\"WASmaxMessageDeliverPeerRPC\",[\"WASmaxInMessageDeliverPeerRequest\",\"WASmaxOutMessageDeliverPeerResponseSuccess\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverPeerRequest\").parsePeerRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Peer\",{Request:b}));return{parsedRequest:b.value,makePeerResponseSuccess:function(){return d(\"WASmaxOutMessageDeliverPeerResponseSuccess\").makePeerResponseSuccess(a)}}}g.receivePeerRPC=a}),98);\n__d(\"WACreateHandlePeerMessageBranch\",[\"Promise\",\"WAHandlePeerMessageProtocol\",\"WAResultOrError\",\"WASmaxMessageDeliverPeerRPC\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){var c=a.peerMessage;return function(a,e){a=d(\"WASmaxMessageDeliverPeerRPC\").receivePeerRPC(a);var f=a.makePeerResponseSuccess;a=a.parsedRequest;var g=a.id,i=a.from,j=a.retryOrIndividualRegularMixinGroup;a=a.t;if(c!=null){var k;return c.handlePeerMessage({from:i,parsedMessage:(k=d(\"WAHandlePeerMessageProtocol\")).parsePeerMessage({from:i,retryOrIndividualRegularMixinGroup:j}),stanzaId:g,sendPeerMessageReceipt:k.sendPeerMessageReceipt,sendHistorySyncReceipt:k.sendHistorySyncReceipt,sendRetryReceipt:k.sendPeerMessageRetryReceipt,makeAck:f,decryptMessage:k.decryptPeerMessage,decodeMessage:k.decodePeerMessage,serverTs:d(\"WATimeUtils\").castToUnixTime(a)},e).then(d(\"WAResultOrError\").makeResult)}return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(f()))}}g.createHandlePeerMessageBranch=a}),98);\n__d(\"WASmaxInMessageDeliverAdminEditMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"edit\",\"3\");return!b.success?b:d(\"WAResultOrError\").makeResult({edit:b.value})}g.parseAdminEditMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypeMediaMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"media\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseContentTypeMediaMixin=a}),98);\n__d(\"WASmaxInMessageDeliverPayloadMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"plaintext\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentBytesRange(a,1,1048576);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}g.parsePayloadMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterMediaMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeMediaMixin\",\"WASmaxInMessageDeliverEnums\",\"WASmaxInMessageDeliverPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"plaintext\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"mediatype\",d(\"WASmaxInMessageDeliverEnums\").ENUM_AUDIO_AVATARSTICKER_CATALOGLINK_DOCUMENT_GENAISTICKER_GIF_IMAGE_PRODUCTLINK_PTT_STICKER_URL_VCARD_VIDEO);if(!c.success)return c;b=d(\"WASmaxInMessageDeliverPayloadMixin\").parsePayloadMixin(b.value);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverContentTypeMediaMixin\").parseContentTypeMediaMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({plaintextMediatype:c.value,plaintextPayloadMixin:b.value},a.value))}g.parseNewsletterMediaMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterTextMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeTextMixin\",\"WASmaxInMessageDeliverPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"plaintext\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverPayloadMixin\").parsePayloadMixin(b.value);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverContentTypeTextMixin\").parseContentTypeTextMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({plaintextPayloadMixin:b.value},a.value))}g.parseNewsletterTextMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverNewsletterMediaMixin\",\"WASmaxInMessageDeliverNewsletterTextMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverNewsletterTextMixin\").parseNewsletterTextMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NewsletterText\",value:b.value});var c=d(\"WASmaxInMessageDeliverNewsletterMediaMixin\").parseNewsletterMediaMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"NewsletterMedia\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"NewsletterText\",\"NewsletterMedia\"],[b,c])}g.parseNewsletterTextOrMediaMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterEditMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverAdminEditMixin\",\"WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverAdminEditMixin\").parseAdminEditMixin(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup\").parseNewsletterTextOrMediaMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{newsletterTextOrMediaMixinGroup:a.value}))}g.parseNewsletterEditMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypePollCreationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"poll\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,b.value,\"polltype\",\"creation\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:a.value,metaPolltype:b.value})}g.parseContentTypePollCreationMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterPollCreationMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypePollCreationMixin\",\"WASmaxInMessageDeliverPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"plaintext\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverPayloadMixin\").parsePayloadMixin(b.value);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverContentTypePollCreationMixin\").parseContentTypePollCreationMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({plaintextPayloadMixin:b.value},a.value))}g.parseNewsletterPollCreationMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypePollVoteMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"poll\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,b.value,\"polltype\",\"vote\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:a.value,metaPolltype:b.value})}g.parseContentTypePollVoteMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterPollVoteMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypePollVoteMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"vote\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentBytesRange(a,32,32);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"votes\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverContentTypePollVoteMixin\").parseContentTypePollVoteMixin(a);if(!a.success)return a;b=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"vote\",0,1e3,h);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{votesVote:b.value}))}g.parseNewsletterPollVoteVotesVote=h;g.parseNewsletterPollVoteMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypeReactionMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"reaction\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseContentTypeReactionMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterReactionMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeReactionMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"reaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(b.value,\"code\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverContentTypeReactionMixin\").parseContentTypeReactionMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({reactionCode:b.value},a.value))}g.parseNewsletterReactionMixin=a}),98);\n__d(\"WASmaxInMessageDeliverRevokeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"edit\",\"7\");return!b.success?b:d(\"WAResultOrError\").makeResult({edit:b.value})}g.parseRevokeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterReactionRevokeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeReactionMixin\",\"WASmaxInMessageDeliverRevokeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"reaction\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverRevokeMixin\").parseRevokeMixin(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverContentTypeReactionMixin\").parseContentTypeReactionMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,a.value))}g.parseNewsletterReactionRevokeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverAdminRevokeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"edit\",\"8\");return!b.success?b:d(\"WAResultOrError\").makeResult({edit:b.value})}g.parseAdminRevokeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterRevokeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverAdminRevokeMixin\",\"WASmaxInMessageDeliverContentTypeTextMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"plaintext\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverAdminRevokeMixin\").parseAdminRevokeMixin(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverContentTypeTextMixin\").parseContentTypeTextMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,a.value))}g.parseNewsletterRevokeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterMessageFanoutContent\",[\"WAResultOrError\",\"WASmaxInMessageDeliverNewsletterEditMixin\",\"WASmaxInMessageDeliverNewsletterMediaMixin\",\"WASmaxInMessageDeliverNewsletterPollCreationMixin\",\"WASmaxInMessageDeliverNewsletterPollVoteMixin\",\"WASmaxInMessageDeliverNewsletterReactionMixin\",\"WASmaxInMessageDeliverNewsletterReactionRevokeMixin\",\"WASmaxInMessageDeliverNewsletterRevokeMixin\",\"WASmaxInMessageDeliverNewsletterTextMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverNewsletterEditMixin\").parseNewsletterEditMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NewsletterEdit\",value:b.value});var c=d(\"WASmaxInMessageDeliverNewsletterRevokeMixin\").parseNewsletterRevokeMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"NewsletterRevoke\",value:c.value});var e=d(\"WASmaxInMessageDeliverNewsletterTextMixin\").parseNewsletterTextMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"NewsletterText\",value:e.value});var f=d(\"WASmaxInMessageDeliverNewsletterMediaMixin\").parseNewsletterMediaMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"NewsletterMedia\",value:f.value});var g=d(\"WASmaxInMessageDeliverNewsletterReactionMixin\").parseNewsletterReactionMixin(a);if(g.success)return d(\"WAResultOrError\").makeResult({name:\"NewsletterReaction\",value:g.value});var h=d(\"WASmaxInMessageDeliverNewsletterReactionRevokeMixin\").parseNewsletterReactionRevokeMixin(a);if(h.success)return d(\"WAResultOrError\").makeResult({name:\"NewsletterReactionRevoke\",value:h.value});var i=d(\"WASmaxInMessageDeliverNewsletterPollCreationMixin\").parseNewsletterPollCreationMixin(a);if(i.success)return d(\"WAResultOrError\").makeResult({name:\"NewsletterPollCreation\",value:i.value});var j=d(\"WASmaxInMessageDeliverNewsletterPollVoteMixin\").parseNewsletterPollVoteMixin(a);return j.success?d(\"WAResultOrError\").makeResult({name:\"NewsletterPollVote\",value:j.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"NewsletterEdit\",\"NewsletterRevoke\",\"NewsletterText\",\"NewsletterMedia\",\"NewsletterReaction\",\"NewsletterReactionRevoke\",\"NewsletterPollCreation\",\"NewsletterPollVote\"],[b,c,e,f,g,h,i,j])}g.parseNewsletterMessageFanoutContent=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,b.value,\"msg_edit_t\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({metaMsgEditT:a.value})}g.parseNewsletterMessageLastEditTimestampMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,b.value,\"original_msg_t\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({metaOriginalMsgT:a.value})}g.parseNewsletterMessageOriginalTimestampMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterMessageFanoutMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverNewsletterMessageFanoutContent\",\"WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin\",\"WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrIntRange(a,\"server_id\",99,2147476647);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optionalLiteral(d(\"WASmaxParseUtils\").attrString,a,\"is_sender\",\"true\");if(!f.success)return f;var g=d(\"WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin\").parseNewsletterMessageOriginalTimestampMixin(a),h=d(\"WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin\").parseNewsletterMessageLastEditTimestampMixin(a);a=d(\"WASmaxInMessageDeliverNewsletterMessageFanoutContent\").parseNewsletterMessageFanoutContent(a);return!a.success?a:d(\"WAResultOrError\").makeResult({id:b.value,serverId:c.value,t:e.value,isSender:f.value,newsletterMessageOriginalTimestampMixin:g.success?g.value:null,newsletterMessageLastEditTimestampMixin:h.success?h.value:null,newsletterMessageFanoutContent:a.value})}g.parseNewsletterMessageFanoutMixin=a}),98);\n__d(\"WASmaxInMessageDeliverOfflineMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrIntRange(a,\"offline\",0,12);return!a.success?a:d(\"WAResultOrError\").makeResult({offline:a.value})}g.parseOfflineMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterMessageWithJIDMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverNewsletterMessageFanoutMixin\",\"WASmaxInMessageDeliverOfflineMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrNewsletterJid(a,\"from\");if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverNewsletterMessageFanoutMixin\").parseNewsletterMessageFanoutMixin(a);if(!c.success)return c;a=d(\"WASmaxInMessageDeliverOfflineMixin\").parseOfflineMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:b.value},c.value,{offlineMixin:a.success?a.value:null}))}g.parseNewsletterMessageWithJIDMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNewsletterRequest\",[\"WASmaxInMessageDeliverNewsletterMessageWithJIDMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverNewsletterMessageWithJIDMixin\").parseNewsletterMessageWithJIDMixin(a);return!b.success?b:b}g.parseNewsletterRequest=a}),98);\n__d(\"WASmaxOutMessageDeliverCommonAckMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrNewsletterJid,a,[\"from\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{to:d(\"WAWap\").JID(b.value),\"class\":\"message\",id:d(\"WAWap\").STANZA_ID(c.value),type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeCommonAckMixin=a}),98);\n__d(\"WASmaxOutMessageDeliverNewsletterResponseError\",[\"WASmaxJsx\",\"WASmaxOutMessageDeliverCommonAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutMessageDeliverCommonAckMixin\").mergeCommonAckMixin(d(\"WASmaxJsx\").smax(\"ack\",{error:\"406\"}),a);return a}g.makeNewsletterResponseError=a}),98);\n__d(\"WASmaxOutMessageDeliverNewsletterResponseSuccess\",[\"WASmaxJsx\",\"WASmaxOutMessageDeliverCommonAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutMessageDeliverCommonAckMixin\").mergeCommonAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a);return a}g.makeNewsletterResponseSuccess=a}),98);\n__d(\"WASmaxMessageDeliverNewsletterRPC\",[\"WASmaxInMessageDeliverNewsletterRequest\",\"WASmaxOutMessageDeliverNewsletterResponseError\",\"WASmaxOutMessageDeliverNewsletterResponseSuccess\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverNewsletterRequest\").parseNewsletterRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Newsletter\",{Request:b}));return{parsedRequest:b.value,makeNewsletterResponseError:function(){return d(\"WASmaxOutMessageDeliverNewsletterResponseError\").makeNewsletterResponseError(a)},makeNewsletterResponseSuccess:function(){return d(\"WASmaxOutMessageDeliverNewsletterResponseSuccess\").makeNewsletterResponseSuccess(a)}}}g.receiveNewsletterRPC=a}),98);\n__d(\"WASmaxInMessageDeliverAutomatedMixin\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"automated\");return!b.success?b:d(\"WASmaxParseUtils\").voidSuccess}g.parseAutomatedMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBizAcceptTsMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"accept_ts\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({bizAcceptTs:a.value})}g.parseBizAcceptTsMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBizROIMetricsGatingFlagsMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"roi_enabled\",d(\"WASmaxInMessageDeliverEnums\").ENUM_0_1);return!a.success?a:d(\"WAResultOrError\").makeResult({bizRoiEnabled:a.value})}g.parseBizROIMetricsGatingFlagsMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBizRolesMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"host_storage\",1,100);if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"actual_actors\",1,100);if(!c.success)return c;b=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"privacy_mode_ts\",0,void 0);return!b.success?b:d(\"WAResultOrError\").makeResult({bizHostStorage:a.value,bizActualActors:c.value,bizPrivacyModeTs:b.value})}g.parseBizRolesMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBusinessBotGatingMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"gating\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a.value,\"bot\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"state\",d(\"WASmaxInMessageDeliverEnums\").ENUM_ALLOW_BYPASS_DENY_ERROR);if(!a.success)return a;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,b.value,\"v\",1,void 0);return!b.success?b:d(\"WAResultOrError\").makeResult({bizGatingBotState:a.value,bizGatingBotV:b.value})}g.parseBusinessBotGatingMixin=a}),98);\n__d(\"WASmaxInMessageDeliverConversionRecipientStatusMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"conversion\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"recipient_status\",d(\"WASmaxInMessageDeliverEnums\").ENUM_MATCHED_UNMATCHED);return!a.success?a:d(\"WAResultOrError\").makeResult({conversionRecipientStatus:a.value})}g.parseConversionRecipientStatusMixin=a}),98);\n__d(\"WASmaxInMessageDeliverClickToWhatsAppTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"source_url\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentString(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"ctwa\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"source_url\",h);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"conversion_source\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"conversion_data\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"source_type\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"entry_point_conversion_source\");if(!g.success)return g;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"entry_point_conversion_app\");return!a.success?a:d(\"WAResultOrError\").makeResult({conversionSource:c.value,conversionData:e.value,sourceType:f.value,entryPointConversionSource:g.value,entryPointConversionApp:a.value,sourceUrl:b.value})}g.parseClickToWhatsAppTypeSourceUrl=h;g.parseClickToWhatsAppTypeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverCtwaConversionMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverClickToWhatsAppTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"ctwa\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverClickToWhatsAppTypeMixin\").parseClickToWhatsAppTypeMixin(a);return!b.success?b:b}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"ctwa\",h);return!b.success?b:d(\"WAResultOrError\").makeResult({ctwa:b.value})}g.parseCtwaConversionCtwa=h;g.parseCtwaConversionMixin=a}),98);\n__d(\"WASmaxInMessageDeliverButtonsMixin\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"buttons\");return!a.success?a:d(\"WASmaxParseUtils\").voidSuccess}g.parseButtonsMixin=a}),98);\n__d(\"WASmaxInMessageDeliverHSMReviewMetadataMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"category\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"tag\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"id\");if(!e.success)return e;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"sub_tag\");return!a.success?a:d(\"WAResultOrError\").makeResult({category:b.value,tag:c.value,id:e.value,subTag:a.value})}g.parseHSMReviewMetadataMixin=a}),98);\n__d(\"WASmaxInMessageDeliverHsmMixin\",[\"WASmaxInMessageDeliverHSMReviewMetadataMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"hsm\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverHSMReviewMetadataMixin\").parseHSMReviewMetadataMixin(b.value);return!a.success?a:a}g.parseHsmMixin=a}),98);\n__d(\"WASmaxInMessageDeliverExtensionsMetadataMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"capability\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"name\");return!b.success?b:d(\"WAResultOrError\").makeResult({name:b.value})}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"capabilities\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"capability\",1,50,h);return!b.success?b:d(\"WAResultOrError\").makeResult({capability:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"native_flow\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"extensions_metadata\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optionalChildWithTag(b.value,\"capabilities\",i);if(!a.success)return a;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,b.value,\"well_version\",1,void 0);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,b.value,\"data_api_version\",1,void 0);if(!e.success)return e;b=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"flow_message_version\",1,void 0);return!b.success?b:d(\"WAResultOrError\").makeResult({extensionsMetadataWellVersion:c.value,extensionsMetadataDataApiVersion:e.value,extensionsMetadataFlowMessageVersion:b.value,extensionsMetadataCapabilities:a.value})}g.parseExtensionsMetadataExtensionsMetadataCapabilitiesCapability=h;g.parseExtensionsMetadataExtensionsMetadataCapabilities=i;g.parseExtensionsMetadataMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNativeFlowMessageTypeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverExtensionsMetadataMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"interactive\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"native_flow\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"native_flow\");if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrString(b.value,\"name\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,b.value,\"v\",1,void 0);if(!e.success)return e;b=d(\"WASmaxInMessageDeliverExtensionsMetadataMixin\").parseExtensionsMetadataMixin(b.value);return d(\"WAResultOrError\").makeResult({type:a.value,nativeFlowName:c.value,nativeFlowV:e.value,nativeFlowExtensionsMetadataMixin:b.success?b.value:null})}g.parseNativeFlowMessageTypeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverInteractiveMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverNativeFlowMessageTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"interactive\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").optionalLiteral(d(\"WASmaxParseUtils\").attrString,a.value,\"v\",\"1\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverNativeFlowMessageTypeMixin\").parseNativeFlowMessageTypeMixin(a.value);return!a.success?a:d(\"WAResultOrError\").makeResult({bizInteractiveV:b.value,bizInteractiveNativeFlowMessageTypeMixin:a.value})}g.parseInteractiveMixin=a}),98);\n__d(\"WASmaxInMessageDeliverNativeFlowMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"native_flow_name\",d(\"WASmaxInMessageDeliverEnums\").ENUM_CATALOGMESSAGE_LANELINECALL_MENUOPTIONS_NOVICOMPLETETRANSACTION_NOVIHUB_NOVILOGIN_NOVIREPORTTRANSACTION_NOVIVIEWBANKDETAIL_NOVIVIEWCARDDETAIL_NOVIVIEWCODE_NOVIVIEWTRANSACTION_ORDERDETAILS_ORDERSTATUS_OTP_PAYMENTMETHOD_PAYMENTSTATUS_VOICECALL);if(!a.success)return a;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,b.value,\"native_flow_version\",1,void 0);return!b.success?b:d(\"WAResultOrError\").makeResult({bizNativeFlowName:a.value,bizNativeFlowVersion:b.value})}g.parseNativeFlowMixin=a}),98);\n__d(\"WASmaxInMessageDeliverProductListMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"list\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a.value,\"type\",\"product_list\");return!b.success?b:d(\"WAResultOrError\").makeResult({bizListType:b.value})}g.parseProductListMixin=a}),98);\n__d(\"WASmaxInMessageDeliverHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverButtonsMixin\",\"WASmaxInMessageDeliverHsmMixin\",\"WASmaxInMessageDeliverInteractiveMixin\",\"WASmaxInMessageDeliverNativeFlowMixin\",\"WASmaxInMessageDeliverProductListMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverHsmMixin\").parseHsmMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"Hsm\",value:b.value});var c=d(\"WASmaxInMessageDeliverButtonsMixin\").parseButtonsMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"Buttons\",value:c.value});var e=d(\"WASmaxInMessageDeliverNativeFlowMixin\").parseNativeFlowMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"NativeFlow\",value:e.value});var f=d(\"WASmaxInMessageDeliverInteractiveMixin\").parseInteractiveMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"Interactive\",value:f.value});var g=d(\"WASmaxInMessageDeliverProductListMixin\").parseProductListMixin(a);return g.success?d(\"WAResultOrError\").makeResult({name:\"ProductList\",value:g.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Hsm\",\"Buttons\",\"NativeFlow\",\"Interactive\",\"ProductList\"],[b,c,e,f,g])}g.parseHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverBizOriginalEnvelopeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"biz\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"original_envelope\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").contentBytesRange(b.value,1,102400);return!a.success?a:d(\"WAResultOrError\").makeResult({originalEnvelopeElementValue:a.value})}g.parseBizOriginalEnvelopeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverOriginalEnvelopeMixin\",[\"WASmaxInMessageDeliverBizOriginalEnvelopeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverBizOriginalEnvelopeMixin\").parseBizOriginalEnvelopeMixin(b.value);return!a.success?a:a}g.parseOriginalEnvelopeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBizMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBizAcceptTsMixin\",\"WASmaxInMessageDeliverBizROIMetricsGatingFlagsMixin\",\"WASmaxInMessageDeliverBizRolesMixin\",\"WASmaxInMessageDeliverBusinessBotGatingMixin\",\"WASmaxInMessageDeliverConversionRecipientStatusMixin\",\"WASmaxInMessageDeliverCtwaConversionMixin\",\"WASmaxInMessageDeliverHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup\",\"WASmaxInMessageDeliverOriginalEnvelopeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverBizRolesMixin\").parseBizRolesMixin(a);var c=d(\"WASmaxInMessageDeliverBizAcceptTsMixin\").parseBizAcceptTsMixin(a),e=d(\"WASmaxInMessageDeliverBizROIMetricsGatingFlagsMixin\").parseBizROIMetricsGatingFlagsMixin(a),f=d(\"WASmaxInMessageDeliverOriginalEnvelopeMixin\").parseOriginalEnvelopeMixin(a),g=d(\"WASmaxInMessageDeliverConversionRecipientStatusMixin\").parseConversionRecipientStatusMixin(a),h=d(\"WASmaxInMessageDeliverCtwaConversionMixin\").parseCtwaConversionMixin(a),i=d(\"WASmaxInMessageDeliverBusinessBotGatingMixin\").parseBusinessBotGatingMixin(a);a=d(\"WASmaxInMessageDeliverHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup\").parseHsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup(a);return d(\"WAResultOrError\").makeResult({bizRolesMixin:b.success?b.value:null,bizAcceptTsMixin:c.success?c.value:null,bizROIMetricsGatingFlagsMixin:e.success?e.value:null,originalEnvelopeMixin:f.success?f.value:null,conversionRecipientStatusMixin:g.success?g.value:null,ctwaConversionMixin:h.success?h.value:null,businessBotGatingMixin:i.success?i.value:null,hsmOrButtonsOrNativeFlowOrInteractiveOrProductListMixinGroup:a.success?a.value:null})}g.parseBizMixin=a}),98);\n__d(\"WASmaxInMessageDeliverDHashMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"dhash\");return!b.success?b:d(\"WAResultOrError\").makeResult({dhash:b.value})}g.parseDHashMixin=a}),98);\n__d(\"WASmaxInMessageDeliverFolderIDMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrInt(a,\"folder_id\");return!a.success?a:d(\"WAResultOrError\").makeResult({folderId:a.value})}g.parseFolderIDMixin=a}),98);\n__d(\"WASmaxInMessageDeliverFolderMixin\",[\"WASmaxInMessageDeliverFolderIDMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverFolderIDMixin\").parseFolderIDMixin(b.value);return!a.success?a:a}g.parseFolderMixin=a}),98);\n__d(\"WASmaxInMessageDeliverClientFrankingTagMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"franking\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a.value,\"franking_tag\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentBytesRange(a.value,32,128);return!a.success?a:d(\"WAResultOrError\").makeResult({frankingFrankingTagElementValue:a.value})}g.parseClientFrankingTagMixin=a}),98);\n__d(\"WASmaxInMessageDeliverServerFrankingTagMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"franking\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a.value,\"reporting_tag\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentBytesRange(a.value,16,128);return!a.success?a:d(\"WAResultOrError\").makeResult({frankingReportingTagElementValue:a.value})}g.parseServerFrankingTagMixin=a}),98);\n__d(\"WASmaxInMessageDeliverFrankingMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverClientFrankingTagMixin\",\"WASmaxInMessageDeliverServerFrankingTagMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverClientFrankingTagMixin\").parseClientFrankingTagMixin(a);a=d(\"WASmaxInMessageDeliverServerFrankingTagMixin\").parseServerFrankingTagMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({clientFrankingTagMixin:b.success?b.value:null},a.value))}g.parseFrankingMixin=a}),98);\n__d(\"WASmaxInMessageDeliverInternalTestMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"test\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a.value,\"config\");return!a.success?a:d(\"WAResultOrError\").makeResult({testConfig:a.value})}g.parseInternalTestMixin=a}),98);\n__d(\"WASmaxInMessageDeliverMetaHideDecryptionPlaceholderMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a.value,\"decrypt-fail\",\"hide\");return!a.success?a:d(\"WAResultOrError\").makeResult({metaDecryptFail:a.value})}g.parseMetaHideDecryptionPlaceholderMixin=a}),98);\n__d(\"WASmaxInMessageDeliverMulticastMixin\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"multicast\");return!b.success?b:d(\"WASmaxParseUtils\").voidSuccess}g.parseMulticastMixin=a}),98);\n__d(\"WASmaxInMessageDeliverPaddingMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"padding\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").contentBytesRange(b.value,0,128);return!a.success?a:d(\"WAResultOrError\").makeResult({paddingElementValue:a.value})}g.parsePaddingMixin=a}),98);\n__d(\"WASmaxInMessageDeliverPreFilledNumberMixin\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"url_number\");return!b.success?b:d(\"WASmaxParseUtils\").voidSuccess}g.parsePreFilledNumberMixin=a}),98);\n__d(\"WASmaxInMessageDeliverPreFilledTextMixin\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"url_text\");return!b.success?b:d(\"WASmaxParseUtils\").voidSuccess}g.parsePreFilledTextMixin=a}),98);\n__d(\"WASmaxInMessageDeliverPushNameMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"notify\");return!b.success?b:d(\"WAResultOrError\").makeResult({notify:b.value})}g.parsePushNameMixin=a}),98);\n__d(\"WASmaxInMessageDeliverRequestIDMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"trace\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"request_id\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").contentBytesRange(b.value,1,16);return!a.success?a:d(\"WAResultOrError\").makeResult({requestIdElementValue:a.value})}g.parseRequestIDMixin=a}),98);\n__d(\"WASmaxInMessageDeliverTraceIDMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"edge_id\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentBytesRange(a,1,8);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"trace\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"trace_id\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"edge_id\",h);if(!a.success)return a;b=d(\"WASmaxParseUtils\").contentBytesRange(b.value,1,8);return!b.success?b:d(\"WAResultOrError\").makeResult({traceIdElementValue:b.value,edgeId:a.value})}g.parseTraceIDEdgeId=h;g.parseTraceIDMixin=a}),98);\n__d(\"WASmaxInMessageDeliverRequestOrTraceIDMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverRequestIDMixin\",\"WASmaxInMessageDeliverTraceIDMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverRequestIDMixin\").parseRequestIDMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"RequestID\",value:b.value});var c=d(\"WASmaxInMessageDeliverTraceIDMixin\").parseTraceIDMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"TraceID\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"RequestID\",\"TraceID\"],[b,c])}g.parseRequestOrTraceIDMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverTraceContextMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverRequestOrTraceIDMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"trace\");if(!a.success)return a;a=d(\"WASmaxInMessageDeliverRequestOrTraceIDMixinGroup\").parseRequestOrTraceIDMixinGroup(a.value);return!a.success?a:d(\"WAResultOrError\").makeResult({traceRequestOrTraceIDMixinGroup:a.value})}g.parseTraceContextMixin=a}),98);\n__d(\"WASmaxInMessageDeliverTriggerBlockMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"tb_cooldown\",0,void 0);if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrIntRange(a,\"tb_expiration_ts\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({tbCooldown:b.value,tbExpirationTs:a.value})}g.parseTriggerBlockMixin=a}),98);\n__d(\"WASmaxInMessageDeliverTriggerMessageCSATAttributesMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").attrIntRange(a,\"tm_csat_cooldown\",0,void 0);if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrIntRange(a,\"tm_csat_exp_ts\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({tmCsatCooldown:b.value,tmCsatExpTs:a.value})}g.parseTriggerMessageCSATAttributesMixin=a}),98);\n__d(\"WASmaxInMessageDeliverTriggerMessageCSATMixin\",[\"WASmaxInMessageDeliverTriggerMessageCSATAttributesMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverTriggerMessageCSATAttributesMixin\").parseTriggerMessageCSATAttributesMixin(b.value);return!a.success?a:a}g.parseTriggerMessageCSATMixin=a}),98);\n__d(\"WASmaxInMessageDeliverVerifiedNameCertificateMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"verified_name\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrInt(b.value,\"v\");if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"verified_level\",d(\"WASmaxInMessageDeliverEnums\").ENUM_HIGH_LOW_UNKNOWN);if(!c.success)return c;b=d(\"WASmaxParseUtils\").contentBytesRange(b.value,1,1024);return!b.success?b:d(\"WAResultOrError\").makeResult({verifiedNameV:a.value,verifiedNameVerifiedLevel:c.value,verifiedNameElementValue:b.value})}g.parseVerifiedNameCertificateMixin=a}),98);\n__d(\"WASmaxInMessageDeliverVerifiedNameLevelMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"verified_level\",d(\"WASmaxInMessageDeliverEnums\").ENUM_HIGH_LOW_UNKNOWN);return!b.success?b:d(\"WAResultOrError\").makeResult({verifiedLevel:b.value})}g.parseVerifiedNameLevelMixin=a}),98);\n__d(\"WASmaxInMessageDeliverVerifiedNameNameMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"verified_name\");return!b.success?b:d(\"WAResultOrError\").makeResult({verifiedName:b.value})}g.parseVerifiedNameNameMixin=a}),98);\n__d(\"WASmaxInMessageDeliverVerifiedNameMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverVerifiedNameCertificateMixin\",\"WASmaxInMessageDeliverVerifiedNameLevelMixin\",\"WASmaxInMessageDeliverVerifiedNameNameMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverVerifiedNameNameMixin\").parseVerifiedNameNameMixin(a);if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverVerifiedNameLevelMixin\").parseVerifiedNameLevelMixin(a);if(!c.success)return c;a=d(\"WASmaxInMessageDeliverVerifiedNameCertificateMixin\").parseVerifiedNameCertificateMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,c.value,{verifiedNameCertificateMixin:a.success?a.value:null}))}g.parseVerifiedNameMixin=a}),98);\n__d(\"WASmaxInMessageDeliverClientReportingTokenMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"reporting\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a.value,\"reporting_token\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentBytesRange(a.value,32,128);return!a.success?a:d(\"WAResultOrError\").makeResult({reportingReportingTokenElementValue:a.value})}g.parseClientReportingTokenMixin=a}),98);\n__d(\"WASmaxInMessageDeliverServerReportingTokenMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"reporting\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a.value,\"reporting_tag\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentBytesRange(a.value,16,128);return!a.success?a:d(\"WAResultOrError\").makeResult({reportingReportingTagElementValue:a.value})}g.parseServerReportingTokenMixin=a}),98);\n__d(\"WASmaxInMessageDeliverWaReportingMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverClientReportingTokenMixin\",\"WASmaxInMessageDeliverServerReportingTokenMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverClientReportingTokenMixin\").parseClientReportingTokenMixin(a);a=d(\"WASmaxInMessageDeliverServerReportingTokenMixin\").parseServerReportingTokenMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({clientReportingTokenMixin:b.success?b.value:null},a.value))}g.parseWaReportingMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBaseMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverAutomatedMixin\",\"WASmaxInMessageDeliverBizMixin\",\"WASmaxInMessageDeliverDHashMixin\",\"WASmaxInMessageDeliverDeviceIdentityMixin\",\"WASmaxInMessageDeliverFolderMixin\",\"WASmaxInMessageDeliverFrankingMixin\",\"WASmaxInMessageDeliverInternalTestMixin\",\"WASmaxInMessageDeliverMetaHideDecryptionPlaceholderMixin\",\"WASmaxInMessageDeliverMulticastMixin\",\"WASmaxInMessageDeliverOfflineMixin\",\"WASmaxInMessageDeliverPaddingMixin\",\"WASmaxInMessageDeliverPreFilledNumberMixin\",\"WASmaxInMessageDeliverPreFilledTextMixin\",\"WASmaxInMessageDeliverPushNameMixin\",\"WASmaxInMessageDeliverRegistrationIDMixin\",\"WASmaxInMessageDeliverTraceContextMixin\",\"WASmaxInMessageDeliverTriggerBlockMixin\",\"WASmaxInMessageDeliverTriggerMessageCSATMixin\",\"WASmaxInMessageDeliverVerifiedNameMixin\",\"WASmaxInMessageDeliverWaReportingMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverTriggerBlockMixin\").parseTriggerBlockMixin(a);var c=d(\"WASmaxInMessageDeliverTriggerMessageCSATMixin\").parseTriggerMessageCSATMixin(a),e=d(\"WASmaxInMessageDeliverOfflineMixin\").parseOfflineMixin(a),f=d(\"WASmaxInMessageDeliverPushNameMixin\").parsePushNameMixin(a),g=d(\"WASmaxInMessageDeliverDeviceIdentityMixin\").parseDeviceIdentityMixin(a),h=d(\"WASmaxInMessageDeliverVerifiedNameMixin\").parseVerifiedNameMixin(a),i=d(\"WASmaxInMessageDeliverBizMixin\").parseBizMixin(a),j=d(\"WASmaxInMessageDeliverMulticastMixin\").parseMulticastMixin(a),k=d(\"WASmaxInMessageDeliverPreFilledTextMixin\").parsePreFilledTextMixin(a),l=d(\"WASmaxInMessageDeliverPreFilledNumberMixin\").parsePreFilledNumberMixin(a),m=d(\"WASmaxInMessageDeliverAutomatedMixin\").parseAutomatedMixin(a),n=d(\"WASmaxInMessageDeliverDHashMixin\").parseDHashMixin(a),o=d(\"WASmaxInMessageDeliverRegistrationIDMixin\").parseRegistrationIDMixin(a),p=d(\"WASmaxInMessageDeliverFolderMixin\").parseFolderMixin(a),q=d(\"WASmaxInMessageDeliverFrankingMixin\").parseFrankingMixin(a),r=d(\"WASmaxInMessageDeliverWaReportingMixin\").parseWaReportingMixin(a),s=d(\"WASmaxInMessageDeliverInternalTestMixin\").parseInternalTestMixin(a),t=d(\"WASmaxInMessageDeliverMetaHideDecryptionPlaceholderMixin\").parseMetaHideDecryptionPlaceholderMixin(a),u=d(\"WASmaxInMessageDeliverTraceContextMixin\").parseTraceContextMixin(a);a=d(\"WASmaxInMessageDeliverPaddingMixin\").parsePaddingMixin(a);return d(\"WAResultOrError\").makeResult({triggerBlockMixin:b.success?b.value:null,triggerMessageCSATMixin:c.success?c.value:null,offlineMixin:e.success?e.value:null,pushNameMixin:f.success?f.value:null,deviceIdentityMixin:g.success?g.value:null,verifiedNameMixin:h.success?h.value:null,bizMixin:i.success?i.value:null,hasMulticastMixin:j.success,hasPreFilledTextMixin:k.success,hasPreFilledNumberMixin:l.success,hasAutomatedMixin:m.success,dHashMixin:n.success?n.value:null,registrationIDMixin:o.success?o.value:null,folderMixin:p.success?p.value:null,frankingMixin:q.success?q.value:null,waReportingMixin:r.success?r.value:null,internalTestMixin:s.success?s.value:null,metaHideDecryptionPlaceholderMixin:t.success?t.value:null,traceContextMixin:u.success?u.value:null,paddingMixin:a.success?a.value:null})}g.parseBaseMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncMediaTypeFutureproofMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"mediatype\");return!b.success?b:d(\"WAResultOrError\").makeResult({mediatype:b.value})}g.parseEncMediaTypeFutureproofMixin=a}),98);\n__d(\"WASmaxInMessageDeliverAvatarStickerTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"sticker_type\",\"avatar\");return!b.success?b:d(\"WAResultOrError\").makeResult({stickerType:b.value})}g.parseAvatarStickerTypeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverMediaTypeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"mediatype\",d(\"WASmaxInMessageDeliverEnums\").ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_GENAISTICKER_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_URL_VCARD_VIDEO_XMA);return!b.success?b:d(\"WAResultOrError\").makeResult({mediatype:b.value})}g.parseMediaTypeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncMediaTypeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverAvatarStickerTypeMixin\",\"WASmaxInMessageDeliverEnums\",\"WASmaxInMessageDeliverMediaTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"native_flow_name\",d(\"WASmaxInMessageDeliverEnums\").ENUM_ADDRESSMESSAGE_FORMMESSAGE_GALAXYMESSAGE_MENUOPTIONS);if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverMediaTypeMixin\").parseMediaTypeMixin(a);if(!c.success)return c;a=d(\"WASmaxInMessageDeliverAvatarStickerTypeMixin\").parseAvatarStickerTypeMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({nativeFlowName:b.value},c.value,{avatarStickerTypeMixin:a.success?a.value:null}))}g.parseEncMediaTypeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncMediaTypeFutureproofMixin\",\"WASmaxInMessageDeliverEncMediaTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverEncMediaTypeMixin\").parseEncMediaTypeMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"EncMediaType\",value:b.value});var c=d(\"WASmaxInMessageDeliverEncMediaTypeFutureproofMixin\").parseEncMediaTypeFutureproofMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"EncMediaTypeFutureproof\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"EncMediaType\",\"EncMediaTypeFutureproof\"],[b,c])}g.parseEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverEncTypeSenderKeyMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin\",\"WASmaxInMessageDeliverEncPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"skmsg\");if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverEncHideDecryptionPlaceholderMixin\").parseEncHideDecryptionPlaceholderMixin(a);a=d(\"WASmaxInMessageDeliverEncPayloadMixin\").parseEncPayloadMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({type:b.value,encHideDecryptionPlaceholderMixin:c.success?c.value:null},a.value))}g.parseEncTypeSenderKeyMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup\",\"WASmaxInMessageDeliverEncTypeSenderKeyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverEncTypeSenderKeyMixin\").parseEncTypeSenderKeyMixin(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup\").parseEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{encMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup:a.value}))}g.parseEncTypeSenderKeyAndBroadcastMediaMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncTypeIndividualMixin\",\"WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaMixin\").parseEncTypeSenderKeyAndBroadcastMediaMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"EncTypeSenderKeyAndBroadcastMedia\",value:b.value});var c=d(\"WASmaxInMessageDeliverEncTypeIndividualMixin\").parseEncTypeIndividualMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"EncTypeIndividual\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"EncTypeSenderKeyAndBroadcastMedia\",\"EncTypeIndividual\"],[b,c])}g.parseEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverBroadcastDualEncMediaMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeMediaMixin\",\"WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup\",\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\").parseEncVersion2Or3OrFutureproofMixinGroup(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup\").parseEncTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({encVersion2Or3OrFutureproofMixinGroup:b.value,encTypeSenderKeyAndBroadcastMediaOrIndividualMixinGroup:a.value})}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"rcat\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentBytes(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"rcat\",i);if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverContentTypeMediaMixin\").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"enc\",2,2,h);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},c.value,{rcat:b.value,enc:a.value}))}g.parseBroadcastDualEncMediaEnc=h;g.parseBroadcastDualEncMediaRcat=i;g.parseBroadcastDualEncMediaMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncTypeIndividualMixin\",\"WASmaxInMessageDeliverEncTypeSenderKeyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverEncTypeSenderKeyMixin\").parseEncTypeSenderKeyMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"EncTypeSenderKey\",value:b.value});var c=d(\"WASmaxInMessageDeliverEncTypeIndividualMixin\").parseEncTypeIndividualMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"EncTypeIndividual\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"EncTypeSenderKey\",\"EncTypeIndividual\"],[b,c])}g.parseEncTypeSenderKeyOrIndividualMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeTextMixin\",\"WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup\",\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\").parseEncVersion2Or3OrFutureproofMixinGroup(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup\").parseEncTypeSenderKeyOrIndividualMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({encVersion2Or3OrFutureproofMixinGroup:b.value,encTypeSenderKeyOrIndividualMixinGroup:a.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverContentTypeTextMixin\").parseContentTypeTextMixin(a);if(!b.success)return b;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"enc\",2,2,h);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{enc:a.value}))}g.parseBroadcastDualEncNonMediaEnc=h;g.parseBroadcastDualEncNonMediaMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBroadcastDualEncMediaMixin\",\"WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverBroadcastDualEncMediaMixin\").parseBroadcastDualEncMediaMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"BroadcastDualEncMedia\",value:b.value});var c=d(\"WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin\").parseBroadcastDualEncNonMediaMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"BroadcastDualEncNonMedia\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"BroadcastDualEncMedia\",\"BroadcastDualEncNonMedia\"],[b,c])}g.parseBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverBroadcastEphemeralMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrString(a,\"eph_setting\");return!a.success?a:d(\"WAResultOrError\").makeResult({ephSetting:a.value})}g.parseBroadcastEphemeralMixin=a}),98);\n__d(\"WASmaxInMessageDeliverToUserMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"to\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"jid\");return!b.success?b:d(\"WAResultOrError\").makeResult({jid:b.value})}g.parseToUserMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBroadcastParticipantsMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBroadcastEphemeralMixin\",\"WASmaxInMessageDeliverToUserMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"to\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverToUserMixin\").parseToUserMixin(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverBroadcastEphemeralMixin\").parseBroadcastEphemeralMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{broadcastEphemeralMixin:a.success?a.value:null}))}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"participants\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"to\",0,256,h);return!a.success?a:d(\"WAResultOrError\").makeResult({participantsTo:a.value})}g.parseBroadcastParticipantsParticipantsTo=h;g.parseBroadcastParticipantsMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBroadcastDualEncMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup\",\"WASmaxInMessageDeliverBroadcastParticipantsMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverBroadcastParticipantsMixin\").parseBroadcastParticipantsMixin(a);a=d(\"WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup\").parseBroadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({broadcastParticipantsMixin:b.success?b.value:null,broadcastDualEncBroadcastDualEncMediaOrBroadcastDualEncNonMediaMediaMixinGroup:a.value})}g.parseBroadcastDualEncMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypeMedianotifyMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"medianotify\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseContentTypeMedianotifyMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypeMediaOrMedianotifyMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeMediaMixin\",\"WASmaxInMessageDeliverContentTypeMedianotifyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverContentTypeMediaMixin\").parseContentTypeMediaMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeMedia\",value:b.value});var c=d(\"WASmaxInMessageDeliverContentTypeMedianotifyMixin\").parseContentTypeMedianotifyMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"ContentTypeMedianotify\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ContentTypeMedia\",\"ContentTypeMedianotify\"],[b,c])}g.parseContentTypeMediaOrMedianotifyMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypeMediaSingleMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeMediaOrMedianotifyMixinGroup\",\"WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"rcat\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentBytes(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"enc\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"rcat\",h);if(!c.success)return c;b=d(\"WASmaxInMessageDeliverEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup\").parseEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup(b.value);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverContentTypeMediaOrMedianotifyMixinGroup\").parseContentTypeMediaOrMedianotifyMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({encEncMediaTypeEncMediaTypeOrEncMediaTypeFutureproofMixinGroup:b.value,contentTypeMediaOrMedianotifyMixinGroup:a.value,rcat:c.value})}g.parseContentTypeMediaSingleRcat=h;g.parseContentTypeMediaSingleMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeMediaSingleMixin\",\"WASmaxInMessageDeliverContentTypeTextMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverContentTypeTextMixin\").parseContentTypeTextMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeText\",value:b.value});var c=d(\"WASmaxInMessageDeliverContentTypeMediaSingleMixin\").parseContentTypeMediaSingleMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"ContentTypeMediaSingle\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ContentTypeText\",\"ContentTypeMediaSingle\"],[b,c])}g.parseContentTypeTextOrMediaSingleMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncTypeIndividualMixin\",\"WASmaxInMessageDeliverEncTypeSenderKeyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverEncTypeIndividualMixin\").parseEncTypeIndividualMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"EncTypeIndividual\",value:b.value});var c=d(\"WASmaxInMessageDeliverEncTypeSenderKeyMixin\").parseEncTypeSenderKeyMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"EncTypeSenderKey\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"EncTypeIndividual\",\"EncTypeSenderKey\"],[b,c])}g.parseEncTypeIndividualOrSenderKeyMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverBroadcastRegularMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBroadcastParticipantsMixin\",\"WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup\",\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"enc\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverBroadcastParticipantsMixin\").parseBroadcastParticipantsMixin(a);var c=d(\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\").parseEncVersion2Or3OrFutureproofMixinGroup(b.value);if(!c.success)return c;b=d(\"WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup\").parseEncTypeIndividualOrSenderKeyMixinGroup(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult({broadcastParticipantsMixin:a.success?a.value:null,encEncVersion2Or3OrFutureproofMixinGroup:c.value,encEncTypeIndividualOrSenderKeyMixinGroup:b.value})}g.parseBroadcastRegularMixin=a}),98);\n__d(\"WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBroadcastRegularMixin\",\"WASmaxInMessageDeliverRetryMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverRetryMixin\").parseRetryMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"Retry\",value:b.value});var c=d(\"WASmaxInMessageDeliverBroadcastRegularMixin\").parseBroadcastRegularMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"BroadcastRegular\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Retry\",\"BroadcastRegular\"],[b,c])}g.parseRetryOrBroadcastRegularMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverBroadcastSingleEncMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup\",\"WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup\").parseContentTypeTextOrMediaSingleMixinGroup(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup\").parseRetryOrBroadcastRegularMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({contentTypeTextOrMediaSingleMixinGroup:b.value,retryOrBroadcastRegularMixinGroup:a.value})}g.parseBroadcastSingleEncMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBroadcastDualOrSingleEncMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBroadcastDualEncMixin\",\"WASmaxInMessageDeliverBroadcastSingleEncMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverBroadcastDualEncMixin\").parseBroadcastDualEncMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"BroadcastDualEnc\",value:b.value});var c=d(\"WASmaxInMessageDeliverBroadcastSingleEncMixin\").parseBroadcastSingleEncMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"BroadcastSingleEnc\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"BroadcastDualEnc\",\"BroadcastSingleEnc\"],[b,c])}g.parseBroadcastDualOrSingleEncMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverFanoutCountMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrInt(a,\"count\");return!a.success?a:d(\"WAResultOrError\").makeResult({count:a.value})}g.parseFanoutCountMixin=a}),98);\n__d(\"WASmaxInMessageDeliverMessageEditMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"edit\",\"1\");return!b.success?b:d(\"WAResultOrError\").makeResult({edit:b.value})}g.parseMessageEditMixin=a}),98);\n__d(\"WASmaxInMessageDeliverMessageEditOrRevokeOrBroadcastEphemeralMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBroadcastEphemeralMixin\",\"WASmaxInMessageDeliverMessageEditMixin\",\"WASmaxInMessageDeliverRevokeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverMessageEditMixin\").parseMessageEditMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"MessageEdit\",value:b.value});var c=d(\"WASmaxInMessageDeliverRevokeMixin\").parseRevokeMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"Revoke\",value:c.value});var e=d(\"WASmaxInMessageDeliverBroadcastEphemeralMixin\").parseBroadcastEphemeralMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"BroadcastEphemeral\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"MessageEdit\",\"Revoke\",\"BroadcastEphemeral\"],[b,c,e])}g.parseMessageEditOrRevokeOrBroadcastEphemeralMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverSMBBroadcastSourceMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,b.value,\"biz_source\",\"smb_promo\");return!a.success?a:d(\"WAResultOrError\").makeResult({metaBizSource:a.value})}g.parseSMBBroadcastSourceMixin=a}),98);\n__d(\"WASmaxInMessageDeliverSMBBroadcastSourceWithCampaignMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,b.value,\"biz_source\",\"smb_promo\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrString(a.value,\"campaign_id\");return!a.success?a:d(\"WAResultOrError\").makeResult({metaBizSource:b.value,bizCampaignId:a.value})}g.parseSMBBroadcastSourceWithCampaignMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBroadcastMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBroadcastDualOrSingleEncMixinGroup\",\"WASmaxInMessageDeliverEnums\",\"WASmaxInMessageDeliverFanoutCountMixin\",\"WASmaxInMessageDeliverMessageEditOrRevokeOrBroadcastEphemeralMixinGroup\",\"WASmaxInMessageDeliverSMBBroadcastSourceMixin\",\"WASmaxInMessageDeliverSMBBroadcastSourceWithCampaignMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrBroadcastJid(a,\"from\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").attrJidEnum(a,\"participant\",d(\"WASmaxInMessageDeliverEnums\").DEVICEJID_DEVICEJID);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"participant_pn\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"participant_lid\");if(!f.success)return f;var g=d(\"WASmaxInMessageDeliverFanoutCountMixin\").parseFanoutCountMixin(a),h=d(\"WASmaxInMessageDeliverSMBBroadcastSourceMixin\").parseSMBBroadcastSourceMixin(a),i=d(\"WASmaxInMessageDeliverSMBBroadcastSourceWithCampaignMixin\").parseSMBBroadcastSourceWithCampaignMixin(a),j=d(\"WASmaxInMessageDeliverBroadcastDualOrSingleEncMixinGroup\").parseBroadcastDualOrSingleEncMixinGroup(a);if(!j.success)return j;a=d(\"WASmaxInMessageDeliverMessageEditOrRevokeOrBroadcastEphemeralMixinGroup\").parseMessageEditOrRevokeOrBroadcastEphemeralMixinGroup(a);return d(\"WAResultOrError\").makeResult({from:b.value,participant:c.value,participantPn:e.value,participantLid:f.value,fanoutCountMixin:g.success?g.value:null,sMBBroadcastSourceMixin:h.success?h.value:null,sMBBroadcastSourceWithCampaignMixin:i.success?i.value:null,broadcastDualOrSingleEncMixinGroup:j.value,messageEditOrRevokeOrBroadcastEphemeralMixinGroup:a.success?a.value:null})}g.parseBroadcastMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBotThreadIDMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"thread_id\");return!b.success?b:d(\"WAResultOrError\").makeResult({threadId:b.value})}g.parseBotThreadIDMixin=a}),98);\n__d(\"WASmaxInMessageDeliverDisplayNameMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrString(a,\"display_name\");return!a.success?a:d(\"WAResultOrError\").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupAddressingModeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrStringEnum(a,\"addressing_mode\",d(\"WASmaxInMessageDeliverEnums\").ENUM_LID_PN);return!a.success?a:d(\"WAResultOrError\").makeResult({addressingMode:a.value})}g.parseGroupAddressingModeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncListMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"mediatype\",\"list\");return!b.success?b:d(\"WAResultOrError\").makeResult({mediatype:b.value})}g.parseEncListMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncLiveLocationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"mediatype\",\"livelocation\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrIntRange(a,\"duration\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({mediatype:b.value,duration:a.value})}g.parseEncLiveLocationMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncListMixin\",\"WASmaxInMessageDeliverEncLiveLocationMixin\",\"WASmaxInMessageDeliverEncMediaTypeFutureproofMixin\",\"WASmaxInMessageDeliverEncMediaTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverEncLiveLocationMixin\").parseEncLiveLocationMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"EncLiveLocation\",value:b.value});var c=d(\"WASmaxInMessageDeliverEncListMixin\").parseEncListMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"EncList\",value:c.value});var e=d(\"WASmaxInMessageDeliverEncMediaTypeMixin\").parseEncMediaTypeMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"EncMediaType\",value:e.value});var f=d(\"WASmaxInMessageDeliverEncMediaTypeFutureproofMixin\").parseEncMediaTypeFutureproofMixin(a);return f.success?d(\"WAResultOrError\").makeResult({name:\"EncMediaTypeFutureproof\",value:f.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"EncLiveLocation\",\"EncList\",\"EncMediaType\",\"EncMediaTypeFutureproof\"],[b,c,e,f])}g.parseEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup\",\"WASmaxInMessageDeliverEncTypeSenderKeyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverEncTypeSenderKeyMixin\").parseEncTypeSenderKeyMixin(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup\").parseEncLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{encLiveLocationOrListOrMediaTypeOrMediaTypeFutureproofMixinGroup:a.value}))}g.parseEncTypeSenderKeyAndGroupMediaMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncTypeIndividualMixin\",\"WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaMixin\").parseEncTypeSenderKeyAndGroupMediaMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"EncTypeSenderKeyAndGroupMedia\",value:b.value});var c=d(\"WASmaxInMessageDeliverEncTypeIndividualMixin\").parseEncTypeIndividualMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"EncTypeIndividual\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"EncTypeSenderKeyAndGroupMedia\",\"EncTypeIndividual\"],[b,c])}g.parseEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverGroupDualEncMediaMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeMediaMixin\",\"WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup\",\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\").parseEncVersion2Or3OrFutureproofMixinGroup(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup\").parseEncTypeSenderKeyAndGroupMediaOrIndividualMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({encVersion2Or3OrFutureproofMixinGroup:b.value,encTypeSenderKeyAndGroupMediaOrIndividualMixinGroup:a.value})}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"rcat\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentBytes(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"rcat\",i);if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverContentTypeMediaMixin\").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"enc\",2,2,h);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},c.value,{rcat:b.value,enc:a.value}))}g.parseGroupDualEncMediaEnc=h;g.parseGroupDualEncMediaRcat=i;g.parseGroupDualEncMediaMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypeEventMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"event\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"event_type\",d(\"WASmaxInMessageDeliverEnums\").ENUM_CREATION_EDIT_RESPONSE);return!b.success?b:d(\"WAResultOrError\").makeResult({type:a.value,metaEventType:b.value})}g.parseContentTypeEventMixin=a}),98);\n__d(\"WASmaxInMessageDeliverDeprecatedPayTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"mediatype\",\"pay\");return!b.success?b:d(\"WAResultOrError\").makeResult({mediatype:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").mapHomogeneousChildrenWithTag(a,\"enc\",h);return!b.success?b:d(\"WAResultOrError\").makeResult({enc:b.value})}g.parseDeprecatedPayTypeEnc=h;g.parseDeprecatedPayTypeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypePayMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverDeprecatedPayTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"pay\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverDeprecatedPayTypeMixin\").parseDeprecatedPayTypeMixin(a);return d(\"WAResultOrError\").makeResult({type:b.value,deprecatedPayTypeMixin:a.success?a.value:null})}g.parseContentTypePayMixin=a}),98);\n__d(\"WASmaxInMessageDeliverLegacyAmountMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"pay\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"currency\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrString(a,\"amount\");return!a.success?a:d(\"WAResultOrError\").makeResult({currency:b.value,amount:a.value})}g.parseLegacyAmountMixin=a}),98);\n__d(\"WASmaxInMessageDeliverMoneyMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"money\");if(!a.success)return a;var b=d(\"WASmaxParseUtils\").attrString(a.value,\"value\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a.value,\"offset\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").attrString(a.value,\"currency\");return!a.success?a:d(\"WAResultOrError\").makeResult({moneyValue:b.value,moneyOffset:c.value,moneyCurrency:a.value})}g.parseMoneyMixin=a}),98);\n__d(\"WASmaxInMessageDeliverPayNodeTypeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"pay\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"type\",d(\"WASmaxInMessageDeliverEnums\").ENUM_REQUEST_SEND);return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parsePayNodeTypeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverTransactionSyncStatusMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrStringEnum(a,\"sync-status\",d(\"WASmaxInMessageDeliverEnums\").ENUM_FULL_MISSINGFIELDNOTPARTIAL_PARTIAL);return!a.success?a:d(\"WAResultOrError\").makeResult({syncStatus:a.value})}g.parseTransactionSyncStatusMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupDeliverSendPayNodeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverLegacyAmountMixin\",\"WASmaxInMessageDeliverMoneyMixin\",\"WASmaxInMessageDeliverPayNodeTypeMixin\",\"WASmaxInMessageDeliverTransactionSyncStatusMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"amount\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverMoneyMixin\").parseMoneyMixin(a);return!b.success?b:b}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"pay\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"amount\",h);if(!b.success)return b;var c=d(\"WASmaxParseJid\").attrUserJid(a,\"receiver\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrString(a,\"transaction-id\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").attrString(a,\"id\");if(!f.success)return f;var g=d(\"WASmaxParseJid\").attrGroupJid(a,\"group\");if(!g.success)return g;var i=d(\"WASmaxInMessageDeliverPayNodeTypeMixin\").parsePayNodeTypeMixin(a);if(!i.success)return i;var j=d(\"WASmaxInMessageDeliverTransactionSyncStatusMixin\").parseTransactionSyncStatusMixin(a);if(!j.success)return j;a=d(\"WASmaxInMessageDeliverLegacyAmountMixin\").parseLegacyAmountMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({receiver:c.value,transactionId:e.value,id:f.value,group:g.value},i.value,j.value,a.value,{amount:b.value}))}g.parseGroupDeliverSendPayNodeAmount=h;g.parseGroupDeliverSendPayNodeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBasePayNodeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxInMessageDeliverPayNodeTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"pay\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"country\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrIntRange(a,\"version\",0,void 0);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"is_first_send\",d(\"WASmaxInMessageDeliverEnums\").ENUM_0_1);if(!e.success)return e;a=d(\"WASmaxInMessageDeliverPayNodeTypeMixin\").parsePayNodeTypeMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({country:b.value,version:c.value,isFirstSend:e.value},a.value))}g.parseBasePayNodeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverIndividualRequestPayNodeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBasePayNodeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"pay\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"expiry-ts\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"request-id\");if(!c.success)return c;a=d(\"WASmaxInMessageDeliverBasePayNodeMixin\").parseBasePayNodeMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({expiryTs:b.value,requestId:c.value},a.value))}g.parseIndividualRequestPayNodeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupRequestPayNodeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverIndividualRequestPayNodeMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"pay\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"sender\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverIndividualRequestPayNodeMixin\").parseIndividualRequestPayNodeMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({sender:b.value},a.value))}g.parseGroupRequestPayNodeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupRequestOrDeliverSendPayNodeMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverGroupDeliverSendPayNodeMixin\",\"WASmaxInMessageDeliverGroupRequestPayNodeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverGroupRequestPayNodeMixin\").parseGroupRequestPayNodeMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"GroupRequestPayNode\",value:b.value});var c=d(\"WASmaxInMessageDeliverGroupDeliverSendPayNodeMixin\").parseGroupDeliverSendPayNodeMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"GroupDeliverSendPayNode\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"GroupRequestPayNode\",\"GroupDeliverSendPayNode\"],[b,c])}g.parseGroupRequestOrDeliverSendPayNodeMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverGroupDeliverPayNodeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverGroupRequestOrDeliverSendPayNodeMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"pay\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverGroupRequestOrDeliverSendPayNodeMixinGroup\").parseGroupRequestOrDeliverSendPayNodeMixinGroup(a);return!b.success?b:d(\"WAResultOrError\").makeResult({groupRequestOrDeliverSendPayNodeMixinGroup:b.value})}g.parseGroupDeliverPayNodeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupDeliverPayNodeMessageMixin\",[\"WASmaxInMessageDeliverGroupDeliverPayNodeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"pay\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverGroupDeliverPayNodeMixin\").parseGroupDeliverPayNodeMixin(b.value);return!a.success?a:a}g.parseGroupDeliverPayNodeMessageMixin=a}),98);\n__d(\"WASmaxInMessageDeliverIncentiveOfferClaimMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"offer_claim\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"offer_id\",1,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"id\",1,void 0);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"incentive_payment_id\");if(!e.success)return e;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"parent_transaction_id\");return!a.success?a:d(\"WAResultOrError\").makeResult({offerId:b.value,id:c.value,incentivePaymentId:e.value,parentTransactionId:a.value})}g.parseIncentiveOfferClaimMixin=a}),98);\n__d(\"WASmaxInMessageDeliverInstallmentMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverMoneyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"due_amount\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverMoneyMixin\").parseMoneyMixin(a);return!b.success?b:b}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"interest\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverMoneyMixin\").parseMoneyMixin(a);return!b.success?b:b}function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"installment\");if(!a.success)return a;var b=d(\"WASmaxParseUtils\").optionalChildWithTag(a.value,\"due_amount\",h);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optionalChildWithTag(a.value,\"interest\",i);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a.value,\"max_count\",1,50);if(!e.success)return e;a=d(\"WASmaxParseUtils\").attrIntRange(a.value,\"selected_count\",1,50);return!a.success?a:d(\"WAResultOrError\").makeResult({installmentMaxCount:e.value,installmentSelectedCount:a.value,installmentDueAmount:b.value,installmentInterest:c.value})}g.parseInstallmentInstallmentDueAmount=h;g.parseInstallmentInstallmentInterest=i;g.parseInstallmentMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBeneficiaryMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"beneficiary\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"name\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"address_line1\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"address_line2\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"city\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"state\");if(!g.success)return g;var h=d(\"WASmaxParseUtils\").attrString(a,\"country\");if(!h.success)return h;a=d(\"WASmaxParseUtils\").attrString(a,\"postal_code\");return!a.success?a:d(\"WAResultOrError\").makeResult({name:b.value,addressLine1:c.value,addressLine2:e.value,city:f.value,state:g.value,country:h.value,postalCode:a.value})}g.parseBeneficiaryMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBeneficiariesMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBeneficiaryMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"beneficiary\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverBeneficiaryMixin\").parseBeneficiaryMixin(a);return!b.success?b:b}function a(a){a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"beneficiary\",1,5,h);return!a.success?a:d(\"WAResultOrError\").makeResult({beneficiary:a.value})}g.parseBeneficiariesBeneficiary=h;g.parseBeneficiariesMixin=a}),98);\n__d(\"WASmaxInMessageDeliverOrderInPaymentMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBeneficiariesMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"beneficiaries\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverBeneficiariesMixin\").parseBeneficiariesMixin(a);return!b.success?b:b}function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"order\");if(!a.success)return a;var b=d(\"WASmaxParseUtils\").optionalChildWithTag(a.value,\"beneficiaries\",h);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a.value,\"id\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStanzaId,a.value,\"message_id\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a.value,\"payment_config_id\");if(!f.success)return f;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a.value,\"type\");return!a.success?a:d(\"WAResultOrError\").makeResult({orderId:c.value,orderMessageId:e.value,orderPaymentConfigId:f.value,orderType:a.value,orderBeneficiaries:b.value})}g.parseOrderInPaymentOrderBeneficiaries=h;g.parseOrderInPaymentMixin=a}),98);\n__d(\"WASmaxInMessageDeliverTransactionErrorMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"error-code\",1,1e7);if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrString(a,\"error-text\");return!a.success?a:d(\"WAResultOrError\").makeResult({errorCode:b.value,errorText:a.value})}g.parseTransactionErrorMixin=a}),98);\n__d(\"WASmaxInMessageDeliverTransactionTypeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrStringEnum(a,\"transaction-type\",d(\"WASmaxInMessageDeliverEnums\").ENUM_INCENTIVE_P2M_P2P_PAYOUT);return!a.success?a:d(\"WAResultOrError\").makeResult({transactionType:a.value})}g.parseTransactionTypeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverFullTransactionBaseMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxInMessageDeliverIncentiveOfferClaimMixin\",\"WASmaxInMessageDeliverInstallmentMixin\",\"WASmaxInMessageDeliverMoneyMixin\",\"WASmaxInMessageDeliverOrderInPaymentMixin\",\"WASmaxInMessageDeliverTransactionErrorMixin\",\"WASmaxInMessageDeliverTransactionSyncStatusMixin\",\"WASmaxInMessageDeliverTransactionTypeMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"offer_claim\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverIncentiveOfferClaimMixin\").parseIncentiveOfferClaimMixin(a);return!b.success?b:b}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"amount\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverMoneyMixin\").parseMoneyMixin(a);return!b.success?b:b}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"offer_claim\",h);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"amount\",i);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrString(a,\"id\");if(!e.success)return e;var f=d(\"WASmaxParseJid\").attrUserJid(a,\"sender\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"sender-alias\");if(!g.success)return g;var j=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"sender-name\");if(!j.success)return j;var k=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"receiver-name\");if(!k.success)return k;var l=d(\"WASmaxParseJid\").attrUserJid(a,\"receiver\");if(!l.success)return l;var m=d(\"WASmaxParseUtils\").attrString(a,\"currency\");if(!m.success)return m;var n=d(\"WASmaxParseUtils\").attrString(a,\"amount\");if(!n.success)return n;var o=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"credential-id\");if(!o.success)return o;var p=d(\"WASmaxParseUtils\").attrIntRange(a,\"ts\",0,void 0);if(!p.success)return p;var q=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"created-ts\",0,void 0);if(!q.success)return q;var r=d(\"WASmaxParseUtils\").attrString(a,\"status\");if(!r.success)return r;var s=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStanzaId,a,\"message-id\");if(!s.success)return s;var t=d(\"WASmaxParseUtils\").attrIntRange(a,\"counter\",0,void 0);if(!t.success)return t;var u=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"expiry-ts\",0,void 0);if(!u.success)return u;var v=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrGroupJid,a,\"group\");if(!v.success)return v;var w=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"service\",d(\"WASmaxInMessageDeliverEnums\").ENUM_FBPAY_NOVI_P2MLITE_UPI);if(!w.success)return w;var x=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"merchant-name\");if(!x.success)return x;var y=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"note\");if(!y.success)return y;var z=d(\"WASmaxInMessageDeliverTransactionErrorMixin\").parseTransactionErrorMixin(a),A=d(\"WASmaxInMessageDeliverTransactionTypeMixin\").parseTransactionTypeMixin(a);if(!A.success)return A;var B=d(\"WASmaxInMessageDeliverTransactionSyncStatusMixin\").parseTransactionSyncStatusMixin(a);if(!B.success)return B;var C=d(\"WASmaxInMessageDeliverOrderInPaymentMixin\").parseOrderInPaymentMixin(a);a=d(\"WASmaxInMessageDeliverInstallmentMixin\").parseInstallmentMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({id:e.value,sender:f.value,senderAlias:g.value,senderName:j.value,receiverName:k.value,receiver:l.value,currency:m.value,amount:n.value,credentialId:o.value,ts:p.value,createdTs:q.value,status:r.value,messageId:s.value,counter:t.value,expiryTs:u.value,group:v.value,service:w.value,merchantName:x.value,note:y.value,transactionErrorMixin:z.success?z.value:null},A.value,B.value,{orderInPaymentMixin:C.success?C.value:null,installmentMixin:a.success?a.value:null,offerClaim:b.value,childAmount:c.value}))}g.parseFullTransactionBaseOfferClaim=h;g.parseFullTransactionBaseAmount=i;g.parseFullTransactionBaseMixin=a}),98);\n__d(\"WASmaxInMessageDeliverP2MTransactionProtocolMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"psp_transaction_id\");return!b.success?b:d(\"WAResultOrError\").makeResult({pspTransactionId:b.value})}g.parseP2MTransactionProtocolMixin=a}),98);\n__d(\"WASmaxInMessageDeliverPaymentInitiatorMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrStringEnum(a,\"payment_initiator\",d(\"WASmaxInMessageDeliverEnums\").ENUM_BUYER_SELLER);return!a.success?a:d(\"WAResultOrError\").makeResult({paymentInitiator:a.value})}g.parsePaymentInitiatorMixin=a}),98);\n__d(\"WASmaxInMessageDeliverTransactionNUXReceiverMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"is-nux-receiver\",d(\"WASmaxInMessageDeliverEnums\").ENUM_0_1);return!b.success?b:d(\"WAResultOrError\").makeResult({isNuxReceiver:b.value})}g.parseTransactionNUXReceiverMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBRTransactionMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverFullTransactionBaseMixin\",\"WASmaxInMessageDeliverP2MTransactionProtocolMixin\",\"WASmaxInMessageDeliverPaymentInitiatorMixin\",\"WASmaxInMessageDeliverTransactionNUXReceiverMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverFullTransactionBaseMixin\").parseFullTransactionBaseMixin(a);if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverP2MTransactionProtocolMixin\").parseP2MTransactionProtocolMixin(a),e=d(\"WASmaxInMessageDeliverTransactionNUXReceiverMixin\").parseTransactionNUXReceiverMixin(a);if(!e.success)return e;a=d(\"WASmaxInMessageDeliverPaymentInitiatorMixin\").parsePaymentInitiatorMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{p2MTransactionProtocolMixin:c.success?c.value:null},e.value,{paymentInitiatorMixin:a.success?a.value:null}))}g.parseBRTransactionMixin=a}),98);\n__d(\"WASmaxInMessageDeliverCAPITransactionMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"id\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").attrUserJid(a,\"sender\");if(!c.success)return c;a=d(\"WASmaxParseJid\").attrUserJid(a,\"receiver\");return!a.success?a:d(\"WAResultOrError\").makeResult({id:b.value,sender:c.value,receiver:a.value})}g.parseCAPITransactionMixin=a}),98);\n__d(\"WASmaxInMessageDeliverIDTransactionGoPayMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"onboarding-provider\",\"GO\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"onboarding-provider-id\",\"GO\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"onboarding-provider-name\",\"GoPay\");return!a.success?a:d(\"WAResultOrError\").makeResult({onboardingProvider:b.value,onboardingProviderId:c.value,onboardingProviderName:a.value})}g.parseIDTransactionGoPayMixin=a}),98);\n__d(\"WASmaxInMessageDeliverIDTransactionOttoCashMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"onboarding-provider\",\"OTTO\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"onboarding-provider-id\",\"OTTO\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"onboarding-provider-name\",\"OttoCash\");return!a.success?a:d(\"WAResultOrError\").makeResult({onboardingProvider:b.value,onboardingProviderId:c.value,onboardingProviderName:a.value})}g.parseIDTransactionOttoCashMixin=a}),98);\n__d(\"WASmaxInMessageDeliverIDTransactionOvoMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"onboarding-provider\",\"OVO\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"onboarding-provider-id\",\"OVO\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"onboarding-provider-name\",\"OVO\");return!a.success?a:d(\"WAResultOrError\").makeResult({onboardingProvider:b.value,onboardingProviderId:c.value,onboardingProviderName:a.value})}g.parseIDTransactionOvoMixin=a}),98);\n__d(\"WASmaxInMessageDeliverIDTransactionGoPayOrOttoCashOrOvoMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverIDTransactionGoPayMixin\",\"WASmaxInMessageDeliverIDTransactionOttoCashMixin\",\"WASmaxInMessageDeliverIDTransactionOvoMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverIDTransactionGoPayMixin\").parseIDTransactionGoPayMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"IDTransactionGoPay\",value:b.value});var c=d(\"WASmaxInMessageDeliverIDTransactionOttoCashMixin\").parseIDTransactionOttoCashMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"IDTransactionOttoCash\",value:c.value});var e=d(\"WASmaxInMessageDeliverIDTransactionOvoMixin\").parseIDTransactionOvoMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"IDTransactionOvo\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"IDTransactionGoPay\",\"IDTransactionOttoCash\",\"IDTransactionOvo\"],[b,c,e])}g.parseIDTransactionGoPayOrOttoCashOrOvoMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverIDTransactionProtocolMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverIDTransactionGoPayOrOttoCashOrOvoMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverIDTransactionGoPayOrOttoCashOrOvoMixinGroup\").parseIDTransactionGoPayOrOttoCashOrOvoMixinGroup(a);return!b.success?b:d(\"WAResultOrError\").makeResult({iDTransactionGoPayOrOttoCashOrOvoMixinGroup:b.value})}g.parseIDTransactionProtocolMixin=a}),98);\n__d(\"WASmaxInMessageDeliverIDTransactionMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverFullTransactionBaseMixin\",\"WASmaxInMessageDeliverIDTransactionProtocolMixin\",\"WASmaxInMessageDeliverTransactionNUXReceiverMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverFullTransactionBaseMixin\").parseFullTransactionBaseMixin(a);if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverIDTransactionProtocolMixin\").parseIDTransactionProtocolMixin(a);if(!c.success)return c;a=d(\"WASmaxInMessageDeliverTransactionNUXReceiverMixin\").parseTransactionNUXReceiverMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,c.value,a.value))}g.parseIDTransactionMixin=a}),98);\n__d(\"WASmaxInMessageDeliverMXTransactionProtocolMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"bank-transaction-id\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"spei-transaction-id\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").attrIntRange(a,\"spei-ref-num\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({bankTransactionId:b.value,speiTransactionId:c.value,speiRefNum:a.value})}g.parseMXTransactionProtocolMixin=a}),98);\n__d(\"WASmaxInMessageDeliverMXTransactionMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverFullTransactionBaseMixin\",\"WASmaxInMessageDeliverMXTransactionProtocolMixin\",\"WASmaxInMessageDeliverTransactionNUXReceiverMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverFullTransactionBaseMixin\").parseFullTransactionBaseMixin(a);if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverMXTransactionProtocolMixin\").parseMXTransactionProtocolMixin(a);if(!c.success)return c;a=d(\"WASmaxInMessageDeliverTransactionNUXReceiverMixin\").parseTransactionNUXReceiverMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,c.value,a.value))}g.parseMXTransactionMixin=a}),98);\n__d(\"WASmaxInMessageDeliverP2MLiteTransactionProtocolMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverP2MTransactionProtocolMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"psp_receipt_url\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverP2MTransactionProtocolMixin\").parseP2MTransactionProtocolMixin(a);return d(\"WAResultOrError\").makeResult({pspReceiptUrl:b.value,p2MTransactionProtocolMixin:a.success?a.value:null})}g.parseP2MLiteTransactionProtocolMixin=a}),98);\n__d(\"WASmaxInMessageDeliverP2MLiteTransactionMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverFullTransactionBaseMixin\",\"WASmaxInMessageDeliverP2MLiteTransactionProtocolMixin\",\"WASmaxInMessageDeliverTransactionNUXReceiverMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverFullTransactionBaseMixin\").parseFullTransactionBaseMixin(a);if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverP2MLiteTransactionProtocolMixin\").parseP2MLiteTransactionProtocolMixin(a);if(!c.success)return c;a=d(\"WASmaxInMessageDeliverTransactionNUXReceiverMixin\").parseTransactionNUXReceiverMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,c.value,a.value))}g.parseP2MLiteTransactionMixin=a}),98);\n__d(\"WASmaxInMessageDeliverUPIComplaintMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"complaint\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"complaint-status\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"created-ts\",0,void 0);if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"updated-ts\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({complaintStatus:b.value,createdTs:c.value,updatedTs:a.value})}g.parseUPIComplaintMixin=a}),98);\n__d(\"WASmaxInMessageDeliverUPIInternationalFxDetailMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"fx-detail\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"base-amount\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"currency-fx\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrString(a,\"currency-markup\");if(!e.success)return e;a=d(\"WASmaxParseUtils\").attrString(a,\"base-currency\");return!a.success?a:d(\"WAResultOrError\").makeResult({baseAmount:b.value,currencyFx:c.value,currencyMarkup:e.value,baseCurrency:a.value})}g.parseUPIInternationalFxDetailMixin=a}),98);\n__d(\"WASmaxInMessageDeliverUPIInternationalTransactionDetailMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverUPIInternationalFxDetailMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"international-transaction-detail\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"fx-detail\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"invoice-number\");if(!a.success)return a;b=d(\"WASmaxInMessageDeliverUPIInternationalFxDetailMixin\").parseUPIInternationalFxDetailMixin(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult({invoiceNumber:a.value,fxDetailUPIInternationalFxDetailMixin:b.value})}g.parseUPIInternationalTransactionDetailMixin=a}),98);\n__d(\"WASmaxInMessageDeliverP2MHybridExternalPaymentMethodMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"type\",d(\"WASmaxInMessageDeliverEnums\").ENUM_CARD_NETBANKING_UPI_WALLET);if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrString(a,\"name\");return!a.success?a:d(\"WAResultOrError\").makeResult({type:b.value,name:a.value})}g.parseP2MHybridExternalPaymentMethodMixin=a}),98);\n__d(\"WASmaxInMessageDeliverUPITransactionProtocolWithP2MHybridMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxInMessageDeliverMoneyMixin\",\"WASmaxInMessageDeliverP2MHybridExternalPaymentMethodMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"offer\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"id\");return!b.success?b:d(\"WAResultOrError\").makeResult({id:b.value})}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"external_payment_method\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverP2MHybridExternalPaymentMethodMixin\").parseP2MHybridExternalPaymentMethodMixin(a);return!b.success?b:b}function j(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"offer_amount\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverMoneyMixin\").parseMoneyMixin(a);return!b.success?b:b}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"external_payment_method\",i);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"offer_amount\",j);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrStringEnum(a,\"is_p2m_hybrid\",d(\"WASmaxInMessageDeliverEnums\").ENUM_0_1);if(!e.success)return e;var f=d(\"WASmaxParseUtils\").attrStringEnum(a,\"payment_instrument_type\",d(\"WASmaxInMessageDeliverEnums\").ENUM_HPPPAYMENTLINK_UPI);if(!f.success)return f;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"offer\",0,Infinity,h);return!a.success?a:d(\"WAResultOrError\").makeResult({isP2mHybrid:e.value,paymentInstrumentType:f.value,externalPaymentMethod:b.value,offerAmount:c.value,offer:a.value})}g.parseUPITransactionProtocolWithP2MHybridOffer=h;g.parseUPITransactionProtocolWithP2MHybridExternalPaymentMethod=i;g.parseUPITransactionProtocolWithP2MHybridOfferAmount=j;g.parseUPITransactionProtocolWithP2MHybridMixin=a}),98);\n__d(\"WASmaxInMessageDeliverFrequencyRuleMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrStringEnum(a,\"frequency-rule\",d(\"WASmaxInMessageDeliverEnums\").ENUM_ASPRESENTED_BIMONTHLY_DAILY_FORTNIGHTLY_HALFYEARLY_MONTHLY_ONETIME_QUARTERLY_UNKNOWN_WEEKLY_YEARLY);return!a.success?a:d(\"WAResultOrError\").makeResult({frequencyRule:a.value})}g.parseFrequencyRuleMixin=a}),98);\n__d(\"WASmaxInMessageDeliverUPIMandateBaseMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxInMessageDeliverFrequencyRuleMixin\",\"WASmaxInMessageDeliverMoneyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"mandate\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"original-amount\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"mandate-no\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrStringEnum(a,\"amount-rule\",d(\"WASmaxInMessageDeliverEnums\").ENUM_EXACT_MAX);if(!e.success)return e;var f=d(\"WASmaxParseUtils\").attrIntRange(a,\"start-ts\",0,void 0);if(!f.success)return f;var g=d(\"WASmaxParseUtils\").attrIntRange(a,\"end-ts\",0,void 0);if(!g.success)return g;var h=d(\"WASmaxParseUtils\").attrStringEnum(a,\"is-revocable\",d(\"WASmaxInMessageDeliverEnums\").ENUM_0_1);if(!h.success)return h;var i=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"purpose-code\");if(!i.success)return i;var j=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"mandate-name\");if(!j.success)return j;var k=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"error-code\",1,1e7);if(!k.success)return k;b=d(\"WASmaxInMessageDeliverMoneyMixin\").parseMoneyMixin(b.value);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverFrequencyRuleMixin\").parseFrequencyRuleMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({mandateNo:c.value,amountRule:e.value,startTs:f.value,endTs:g.value,isRevocable:h.value,purposeCode:i.value,mandateName:j.value,errorCode:k.value,originalAmountMoneyMixin:b.value},a.value))}g.parseUPIMandateBaseMixin=a}),98);\n__d(\"WASmaxInMessageDeliverUPIMandateUpdateBaseMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxInMessageDeliverMoneyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"mandate-update\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"amount\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrIntRange(a,\"end-ts\",0,void 0);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrString(a,\"seq-no\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").attrString(a,\"mandate-update-info\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").attrStringEnum(a,\"status\",d(\"WASmaxInMessageDeliverEnums\").ENUM_FAILURE_INIT_SUCCESS);if(!g.success)return g;var h=d(\"WASmaxParseUtils\").attrStringEnum(a,\"action\",d(\"WASmaxInMessageDeliverEnums\").ENUM_ACCEPT_REJECT_UNKNOWN);if(!h.success)return h;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"error-code\",1,1e7);if(!a.success)return a;b=d(\"WASmaxInMessageDeliverMoneyMixin\").parseMoneyMixin(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult({endTs:c.value,seqNo:e.value,mandateUpdateInfo:f.value,status:g.value,action:h.value,errorCode:a.value,amountMoneyMixin:b.value})}g.parseUPIMandateUpdateBaseMixin=a}),98);\n__d(\"WASmaxInMessageDeliverUPIMandateWithUpdateMixin\",[\"WASmaxInMessageDeliverUPIMandateUpdateBaseMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"mandate\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"mandate-update\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverUPIMandateUpdateBaseMixin\").parseUPIMandateUpdateBaseMixin(b.value);return!a.success?a:a}g.parseUPIMandateWithUpdateMixin=a}),98);\n__d(\"WASmaxInMessageDeliverUPITransactionWithMandateMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverUPIMandateBaseMixin\",\"WASmaxInMessageDeliverUPIMandateWithUpdateMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"mandate\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverUPIMandateBaseMixin\").parseUPIMandateBaseMixin(b.value);if(!a.success)return a;b=d(\"WASmaxInMessageDeliverUPIMandateWithUpdateMixin\").parseUPIMandateWithUpdateMixin(b.value);return d(\"WAResultOrError\").makeResult({mandateUPIMandateBaseMixin:a.value,mandateUPIMandateWithUpdateMixin:b.success?b.value:null})}g.parseUPITransactionWithMandateMixin=a}),98);\n__d(\"WASmaxInMessageDeliverUPITransactionProtocolMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxInMessageDeliverUPIComplaintMixin\",\"WASmaxInMessageDeliverUPIInternationalTransactionDetailMixin\",\"WASmaxInMessageDeliverUPITransactionProtocolWithP2MHybridMixin\",\"WASmaxInMessageDeliverUPITransactionWithMandateMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"complaint\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverUPIComplaintMixin\").parseUPIComplaintMixin(a);return!b.success?b:b}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"international-transaction-detail\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverUPIInternationalTransactionDetailMixin\").parseUPIInternationalTransactionDetailMixin(a);return!b.success?b:b}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"complaint\",h);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"international-transaction-detail\",i);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"sender-alias\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"receiver-alias\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"receiver-name\");if(!g.success)return g;var j=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"bank-transaction-id\");if(!j.success)return j;var k=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"seq-no\");if(!k.success)return k;var l=d(\"WASmaxParseUtils\").attrStringEnum(a,\"is_vpa\",d(\"WASmaxInMessageDeliverEnums\").ENUM_0_1);if(!l.success)return l;var m=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"ref-url\");if(!m.success)return m;var n=d(\"WASmaxParseUtils\").attrStringEnum(a,\"is-mandate\",d(\"WASmaxInMessageDeliverEnums\").ENUM_0_1);if(!n.success)return n;var o=d(\"WASmaxParseUtils\").attrStringEnum(a,\"is-collect\",d(\"WASmaxInMessageDeliverEnums\").ENUM_0_1);if(!o.success)return o;var p=d(\"WASmaxParseUtils\").attrStringEnum(a,\"nodal\",d(\"WASmaxInMessageDeliverEnums\").ENUM_0_1);if(!p.success)return p;var q=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"is-complaint-eligible\",d(\"WASmaxInMessageDeliverEnums\").ENUM_0_1);if(!q.success)return q;var r=d(\"WASmaxInMessageDeliverUPITransactionWithMandateMixin\").parseUPITransactionWithMandateMixin(a);a=d(\"WASmaxInMessageDeliverUPITransactionProtocolWithP2MHybridMixin\").parseUPITransactionProtocolWithP2MHybridMixin(a);return d(\"WAResultOrError\").makeResult({senderAlias:e.value,receiverAlias:f.value,receiverName:g.value,bankTransactionId:j.value,seqNo:k.value,isVpa:l.value,refUrl:m.value,isMandate:n.value,isCollect:o.value,nodal:p.value,isComplaintEligible:q.value,uPITransactionWithMandateMixin:r.success?r.value:null,uPITransactionProtocolWithP2MHybridMixin:a.success?a.value:null,complaint:b.value,internationalTransactionDetail:c.value})}g.parseUPITransactionProtocolComplaint=h;g.parseUPITransactionProtocolInternationalTransactionDetail=i;g.parseUPITransactionProtocolMixin=a}),98);\n__d(\"WASmaxInMessageDeliverUPITransactionMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverFullTransactionBaseMixin\",\"WASmaxInMessageDeliverUPITransactionProtocolMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverFullTransactionBaseMixin\").parseFullTransactionBaseMixin(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverUPITransactionProtocolMixin\").parseUPITransactionProtocolMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,a.value))}g.parseUPITransactionMixin=a}),98);\n__d(\"WASmaxInMessageDeliverPayTransactions\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBRTransactionMixin\",\"WASmaxInMessageDeliverCAPITransactionMixin\",\"WASmaxInMessageDeliverIDTransactionMixin\",\"WASmaxInMessageDeliverMXTransactionMixin\",\"WASmaxInMessageDeliverP2MLiteTransactionMixin\",\"WASmaxInMessageDeliverUPITransactionMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverUPITransactionMixin\").parseUPITransactionMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"UPITransaction\",value:b.value});var c=d(\"WASmaxInMessageDeliverMXTransactionMixin\").parseMXTransactionMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"MXTransaction\",value:c.value});var e=d(\"WASmaxInMessageDeliverIDTransactionMixin\").parseIDTransactionMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"IDTransaction\",value:e.value});var f=d(\"WASmaxInMessageDeliverP2MLiteTransactionMixin\").parseP2MLiteTransactionMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"P2MLiteTransaction\",value:f.value});var g=d(\"WASmaxInMessageDeliverBRTransactionMixin\").parseBRTransactionMixin(a);if(g.success)return d(\"WAResultOrError\").makeResult({name:\"BRTransaction\",value:g.value});var h=d(\"WASmaxInMessageDeliverCAPITransactionMixin\").parseCAPITransactionMixin(a);return h.success?d(\"WAResultOrError\").makeResult({name:\"CAPITransaction\",value:h.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"UPITransaction\",\"MXTransaction\",\"IDTransaction\",\"P2MLiteTransaction\",\"BRTransaction\",\"CAPITransaction\"],[b,c,e,f,g,h])}g.parsePayTransactions=a}),98);\n__d(\"WASmaxInMessageDeliverPayTransactionAnyMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverPayTransactions\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"transaction\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverPayTransactions\").parsePayTransactions(a);return!b.success?b:d(\"WAResultOrError\").makeResult({payTransactions:b.value})}g.parsePayTransactionAnyMixin=a}),98);\n__d(\"WASmaxInMessageDeliverPayTransactionMessageMixin\",[\"WASmaxInMessageDeliverPayTransactionAnyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"transaction\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverPayTransactionAnyMixin\").parsePayTransactionAnyMixin(b.value);return!a.success?a:a}g.parsePayTransactionMessageMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupDeliverPayNodeOrPayTransactionMessageMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverGroupDeliverPayNodeMessageMixin\",\"WASmaxInMessageDeliverPayTransactionMessageMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverGroupDeliverPayNodeMessageMixin\").parseGroupDeliverPayNodeMessageMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"GroupDeliverPayNodeMessage\",value:b.value});var c=d(\"WASmaxInMessageDeliverPayTransactionMessageMixin\").parsePayTransactionMessageMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"PayTransactionMessage\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"GroupDeliverPayNodeMessage\",\"PayTransactionMessage\"],[b,c])}g.parseGroupDeliverPayNodeOrPayTransactionMessageMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypePayGroupMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypePayMixin\",\"WASmaxInMessageDeliverGroupDeliverPayNodeOrPayTransactionMessageMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverContentTypePayMixin\").parseContentTypePayMixin(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverGroupDeliverPayNodeOrPayTransactionMessageMixinGroup\").parseGroupDeliverPayNodeOrPayTransactionMessageMixinGroup(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{groupDeliverPayNodeOrPayTransactionMessageMixinGroup:a.success?a.value:null}))}g.parseContentTypePayGroupMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypeScheduledCallMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"scheduled-call\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"scheduled_call_type\",d(\"WASmaxInMessageDeliverEnums\").ENUM_CREATION_EDIT);return!b.success?b:d(\"WAResultOrError\").makeResult({type:a.value,metaScheduledCallType:b.value})}g.parseContentTypeScheduledCallMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentDualMixins\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeEventMixin\",\"WASmaxInMessageDeliverContentTypePayGroupMixin\",\"WASmaxInMessageDeliverContentTypePollCreationMixin\",\"WASmaxInMessageDeliverContentTypePollVoteMixin\",\"WASmaxInMessageDeliverContentTypeReactionMixin\",\"WASmaxInMessageDeliverContentTypeScheduledCallMixin\",\"WASmaxInMessageDeliverContentTypeTextMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverContentTypeTextMixin\").parseContentTypeTextMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeText\",value:b.value});var c=d(\"WASmaxInMessageDeliverContentTypePayGroupMixin\").parseContentTypePayGroupMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypePayGroup\",value:c.value});var e=d(\"WASmaxInMessageDeliverContentTypeReactionMixin\").parseContentTypeReactionMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeReaction\",value:e.value});var f=d(\"WASmaxInMessageDeliverContentTypePollCreationMixin\").parseContentTypePollCreationMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypePollCreation\",value:f.value});var g=d(\"WASmaxInMessageDeliverContentTypePollVoteMixin\").parseContentTypePollVoteMixin(a);if(g.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypePollVote\",value:g.value});var h=d(\"WASmaxInMessageDeliverContentTypeScheduledCallMixin\").parseContentTypeScheduledCallMixin(a);if(h.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeScheduledCall\",value:h.value});var i=d(\"WASmaxInMessageDeliverContentTypeEventMixin\").parseContentTypeEventMixin(a);return i.success?d(\"WAResultOrError\").makeResult({name:\"ContentTypeEvent\",value:i.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ContentTypeText\",\"ContentTypePayGroup\",\"ContentTypeReaction\",\"ContentTypePollCreation\",\"ContentTypePollVote\",\"ContentTypeScheduledCall\",\"ContentTypeEvent\"],[b,c,e,f,g,h,i])}g.parseContentDualMixins=a}),98);\n__d(\"WASmaxInMessageDeliverGroupDualEncNonMediaMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentDualMixins\",\"WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup\",\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\").parseEncVersion2Or3OrFutureproofMixinGroup(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverEncTypeSenderKeyOrIndividualMixinGroup\").parseEncTypeSenderKeyOrIndividualMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({encVersion2Or3OrFutureproofMixinGroup:b.value,encTypeSenderKeyOrIndividualMixinGroup:a.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverContentDualMixins\").parseContentDualMixins(a);if(!b.success)return b;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"enc\",2,2,h);return!a.success?a:d(\"WAResultOrError\").makeResult({contentDualMixins:b.value,enc:a.value})}g.parseGroupDualEncNonMediaEnc=h;g.parseGroupDualEncNonMediaMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverGroupDualEncMediaMixin\",\"WASmaxInMessageDeliverGroupDualEncNonMediaMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverGroupDualEncMediaMixin\").parseGroupDualEncMediaMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"GroupDualEncMedia\",value:b.value});var c=d(\"WASmaxInMessageDeliverGroupDualEncNonMediaMixin\").parseGroupDualEncNonMediaMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"GroupDualEncNonMedia\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"GroupDualEncMedia\",\"GroupDualEncNonMedia\"],[b,c])}g.parseGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverGroupDualEncMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup\").parseGroupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup(a);return!b.success?b:d(\"WAResultOrError\").makeResult({groupDualEncGroupDualEncMediaOrGroupDualEncNonMediaMediaMixinGroup:b.value})}g.parseGroupDualEncMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncLiveLocationDeprecatedMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"mediatype\",\"livelocation\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"duration\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({mediatype:b.value,duration:a.value})}g.parseEncLiveLocationDeprecatedMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncLiveLocationDeprecatedMixin\",\"WASmaxInMessageDeliverEncLiveLocationMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverEncLiveLocationMixin\").parseEncLiveLocationMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"EncLiveLocation\",value:b.value});var c=d(\"WASmaxInMessageDeliverEncLiveLocationDeprecatedMixin\").parseEncLiveLocationDeprecatedMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"EncLiveLocationDeprecated\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"EncLiveLocation\",\"EncLiveLocationDeprecated\"],[b,c])}g.parseEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverLiveLocationModeMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"liveloc_mode\",d(\"WASmaxInMessageDeliverEnums\").ENUM_LID_PN);return!a.success?a:d(\"WAResultOrError\").makeResult({metaLivelocMode:a.value})}g.parseLiveLocationModeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeMediaMixin\",\"WASmaxInMessageDeliverEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup\",\"WASmaxInMessageDeliverLiveLocationModeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"enc\");if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverContentTypeMediaMixin\").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d(\"WASmaxInMessageDeliverLiveLocationModeMixin\").parseLiveLocationModeMixin(a);b=d(\"WASmaxInMessageDeliverEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup\").parseEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},c.value,{liveLocationModeMixin:a.success?a.value:null,encEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup:b.value}))}g.parseContentTypeLiveLocationSingleMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypeProductListMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeMediaMixin\",\"WASmaxInMessageDeliverEncListMixin\",\"WASmaxInMessageDeliverProductListMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverEncListMixin\").parseEncListMixin(b.value);if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverContentTypeMediaMixin\").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d(\"WASmaxInMessageDeliverProductListMixin\").parseProductListMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({encEncListMixin:b.value},c.value,a.value))}g.parseContentTypeProductListMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentSingleMixins\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeEventMixin\",\"WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin\",\"WASmaxInMessageDeliverContentTypeMediaSingleMixin\",\"WASmaxInMessageDeliverContentTypePayGroupMixin\",\"WASmaxInMessageDeliverContentTypePollCreationMixin\",\"WASmaxInMessageDeliverContentTypePollVoteMixin\",\"WASmaxInMessageDeliverContentTypeProductListMixin\",\"WASmaxInMessageDeliverContentTypeReactionMixin\",\"WASmaxInMessageDeliverContentTypeScheduledCallMixin\",\"WASmaxInMessageDeliverContentTypeTextMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverContentTypeTextMixin\").parseContentTypeTextMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeText\",value:b.value});var c=d(\"WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin\").parseContentTypeLiveLocationSingleMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeLiveLocationSingle\",value:c.value});var e=d(\"WASmaxInMessageDeliverContentTypeMediaSingleMixin\").parseContentTypeMediaSingleMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeMediaSingle\",value:e.value});var f=d(\"WASmaxInMessageDeliverContentTypePayGroupMixin\").parseContentTypePayGroupMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypePayGroup\",value:f.value});var g=d(\"WASmaxInMessageDeliverContentTypeReactionMixin\").parseContentTypeReactionMixin(a);if(g.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeReaction\",value:g.value});var h=d(\"WASmaxInMessageDeliverContentTypeProductListMixin\").parseContentTypeProductListMixin(a);if(h.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeProductList\",value:h.value});var i=d(\"WASmaxInMessageDeliverContentTypePollCreationMixin\").parseContentTypePollCreationMixin(a);if(i.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypePollCreation\",value:i.value});var j=d(\"WASmaxInMessageDeliverContentTypePollVoteMixin\").parseContentTypePollVoteMixin(a);if(j.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypePollVote\",value:j.value});var k=d(\"WASmaxInMessageDeliverContentTypeScheduledCallMixin\").parseContentTypeScheduledCallMixin(a);if(k.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeScheduledCall\",value:k.value});var l=d(\"WASmaxInMessageDeliverContentTypeEventMixin\").parseContentTypeEventMixin(a);return l.success?d(\"WAResultOrError\").makeResult({name:\"ContentTypeEvent\",value:l.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ContentTypeText\",\"ContentTypeLiveLocationSingle\",\"ContentTypeMediaSingle\",\"ContentTypePayGroup\",\"ContentTypeReaction\",\"ContentTypeProductList\",\"ContentTypePollCreation\",\"ContentTypePollVote\",\"ContentTypeScheduledCall\",\"ContentTypeEvent\"],[b,c,e,f,g,h,i,j,k,l])}g.parseContentSingleMixins=a}),98);\n__d(\"WASmaxInMessageDeliverBotResponseMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"bot\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStanzaId,a,\"edit_target_id\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"sender_timestamp_ms\",0,void 0);if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"edit\",d(\"WASmaxInMessageDeliverEnums\").ENUM_FIRST_FULL_INNER_LAST);return!a.success?a:d(\"WAResultOrError\").makeResult({editTargetId:b.value,senderTimestampMs:c.value,edit:a.value})}g.parseBotResponseMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEmptyBizMixin\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");return!b.success?b:d(\"WASmaxParseUtils\").voidSuccess}g.parseEmptyBizMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncTypeMessageSecretMessageMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"msmsg\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverEncPayloadMixin\").parseEncPayloadMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({type:b.value},a.value))}g.parseEncTypeMessageSecretMessageMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncVersion2OrFutureproofMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncVersion2Mixin\",\"WASmaxInMessageDeliverEncVersionFutureproofMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverEncVersion2Mixin\").parseEncVersion2Mixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"EncVersion2\",value:b.value});var c=d(\"WASmaxInMessageDeliverEncVersionFutureproofMixin\").parseEncVersionFutureproofMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"EncVersionFutureproof\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"EncVersion2\",\"EncVersionFutureproof\"],[b,c])}g.parseEncVersion2OrFutureproofMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverMessageTargetMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"meta\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStanzaId(a,\"target_id\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"target_sender_jid\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrJidEnum,a,\"target_chat_jid\",d(\"WASmaxInMessageDeliverEnums\").GROUPJID_USERJID);return!a.success?a:d(\"WAResultOrError\").makeResult({targetId:b.value,targetSenderJid:c.value,targetChatJid:a.value})}g.parseMessageTargetMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBotResponseMessageMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBotResponseMixin\",\"WASmaxInMessageDeliverEmptyBizMixin\",\"WASmaxInMessageDeliverEncTypeMessageSecretMessageMixin\",\"WASmaxInMessageDeliverEncVersion2OrFutureproofMixinGroup\",\"WASmaxInMessageDeliverMessageTargetMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"bot\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"enc\");if(!e.success)return e;b=d(\"WASmaxInMessageDeliverBotResponseMixin\").parseBotResponseMixin(b.value);if(!b.success)return b;c=d(\"WASmaxInMessageDeliverMessageTargetMixin\").parseMessageTargetMixin(c.value);if(!c.success)return c;var f=d(\"WASmaxInMessageDeliverEncTypeMessageSecretMessageMixin\").parseEncTypeMessageSecretMessageMixin(e.value);if(!f.success)return f;a=d(\"WASmaxInMessageDeliverEmptyBizMixin\").parseEmptyBizMixin(a);e=d(\"WASmaxInMessageDeliverEncVersion2OrFutureproofMixinGroup\").parseEncVersion2OrFutureproofMixinGroup(e.value);return!e.success?e:d(\"WAResultOrError\").makeResult({botBotResponseMixin:b.value,metaMessageTargetMixin:c.value,encEncTypeMessageSecretMessageMixin:f.value,hasEmptyBizMixin:a.success,encEncVersion2OrFutureproofMixinGroup:e.value})}g.parseBotResponseMessageMixin=a}),98);\n__d(\"WASmaxInMessageDeliverEncMediaTypeDeprecatedMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverAvatarStickerTypeMixin\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"mediatype\",d(\"WASmaxInMessageDeliverEnums\").ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_URL_VCARD_VIDEO_XMA);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"native_flow_name\",d(\"WASmaxInMessageDeliverEnums\").ENUM_ADDRESSMESSAGE_GALAXYMESSAGE);if(!c.success)return c;a=d(\"WASmaxInMessageDeliverAvatarStickerTypeMixin\").parseAvatarStickerTypeMixin(a);return d(\"WAResultOrError\").makeResult({mediatype:b.value,nativeFlowName:c.value,avatarStickerTypeMixin:a.success?a.value:null})}g.parseEncMediaTypeDeprecatedMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupRegularMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEncMediaTypeDeprecatedMixin\",\"WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup\",\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"enc\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverEncMediaTypeDeprecatedMixin\").parseEncMediaTypeDeprecatedMixin(b.value);var c=d(\"WASmaxInMessageDeliverEncVersion2Or3OrFutureproofMixinGroup\").parseEncVersion2Or3OrFutureproofMixinGroup(b.value);if(!c.success)return c;b=d(\"WASmaxInMessageDeliverEncTypeIndividualOrSenderKeyMixinGroup\").parseEncTypeIndividualOrSenderKeyMixinGroup(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult({encEncMediaTypeDeprecatedMixin:a.success?a.value:null,encEncVersion2Or3OrFutureproofMixinGroup:c.value,encEncTypeIndividualOrSenderKeyMixinGroup:b.value})}g.parseGroupRegularMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBypassedMixin\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"bypassed\");return!b.success?b:d(\"WASmaxParseUtils\").voidSuccess}g.parseBypassedMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupRetryMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBypassedMixin\",\"WASmaxInMessageDeliverRetryMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverRetryMixin\").parseRetryMixin(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverBypassedMixin\").parseBypassedMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{hasBypassedMixin:a.success}))}g.parseGroupRetryMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBotResponseMessageMixin\",\"WASmaxInMessageDeliverGroupRegularMixin\",\"WASmaxInMessageDeliverGroupRetryMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverGroupRetryMixin\").parseGroupRetryMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"GroupRetry\",value:b.value});var c=d(\"WASmaxInMessageDeliverBotResponseMessageMixin\").parseBotResponseMessageMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"BotResponseMessage\",value:c.value});var e=d(\"WASmaxInMessageDeliverGroupRegularMixin\").parseGroupRegularMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"GroupRegular\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"GroupRetry\",\"BotResponseMessage\",\"GroupRegular\"],[b,c,e])}g.parseGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverGroupSingleEncMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentSingleMixins\",\"WASmaxInMessageDeliverGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverContentSingleMixins\").parseContentSingleMixins(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup\").parseGroupRetryOrBotResponseMessageOrGroupRegularMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({contentSingleMixins:b.value,groupRetryOrBotResponseMessageOrGroupRegularMixinGroup:a.value})}g.parseGroupSingleEncMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupDualOrSingleEncMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverGroupDualEncMixin\",\"WASmaxInMessageDeliverGroupSingleEncMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverGroupDualEncMixin\").parseGroupDualEncMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"GroupDualEnc\",value:b.value});var c=d(\"WASmaxInMessageDeliverGroupSingleEncMixin\").parseGroupSingleEncMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"GroupSingleEnc\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"GroupDualEnc\",\"GroupSingleEnc\"],[b,c])}g.parseGroupDualOrSingleEncMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverGroupEphemeralMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"expiration\",0,2147483647);return!b.success?b:d(\"WAResultOrError\").makeResult({expiration:b.value})}g.parseGroupEphemeralMixin=a}),98);\n__d(\"WASmaxInMessageDeliverMessagePinMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"edit\",\"2\");return!b.success?b:d(\"WAResultOrError\").makeResult({edit:b.value})}g.parseMessagePinMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupEditMixins\",[\"WAResultOrError\",\"WASmaxInMessageDeliverAdminRevokeMixin\",\"WASmaxInMessageDeliverGroupEphemeralMixin\",\"WASmaxInMessageDeliverMessageEditMixin\",\"WASmaxInMessageDeliverMessagePinMixin\",\"WASmaxInMessageDeliverRevokeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverMessageEditMixin\").parseMessageEditMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"MessageEdit\",value:b.value});var c=d(\"WASmaxInMessageDeliverMessagePinMixin\").parseMessagePinMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"MessagePin\",value:c.value});var e=d(\"WASmaxInMessageDeliverRevokeMixin\").parseRevokeMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"Revoke\",value:e.value});var f=d(\"WASmaxInMessageDeliverAdminRevokeMixin\").parseAdminRevokeMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"AdminRevoke\",value:f.value});var g=d(\"WASmaxInMessageDeliverGroupEphemeralMixin\").parseGroupEphemeralMixin(a);return g.success?d(\"WAResultOrError\").makeResult({name:\"GroupEphemeral\",value:g.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"MessageEdit\",\"MessagePin\",\"Revoke\",\"AdminRevoke\",\"GroupEphemeral\"],[b,c,e,f,g])}g.parseGroupEditMixins=a}),98);\n__d(\"WASmaxInMessageDeliverParticipantLIDMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"participant_lid\");return!b.success?b:d(\"WAResultOrError\").makeResult({participantLid:b.value})}g.parseParticipantLIDMixin=a}),98);\n__d(\"WASmaxInMessageDeliverThreadMsgMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStanzaId(b.value,\"thread_msg_id\");if(!a.success)return a;b=d(\"WASmaxParseJid\").attrUserJid(b.value,\"thread_msg_sender_jid\");return!b.success?b:d(\"WAResultOrError\").makeResult({metaThreadMsgId:a.value,metaThreadMsgSenderJid:b.value})}g.parseThreadMsgMixin=a}),98);\n__d(\"WASmaxInMessageDeliverToProxyAccountMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"actual_to\");return!b.success?b:d(\"WAResultOrError\").makeResult({actualTo:b.value})}g.parseToProxyAccountMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBotThreadIDMixin\",\"WASmaxInMessageDeliverDisplayNameMixin\",\"WASmaxInMessageDeliverEnums\",\"WASmaxInMessageDeliverFanoutCountMixin\",\"WASmaxInMessageDeliverGroupAddressingModeMixin\",\"WASmaxInMessageDeliverGroupDualOrSingleEncMixinGroup\",\"WASmaxInMessageDeliverGroupEditMixins\",\"WASmaxInMessageDeliverParticipantLIDMixin\",\"WASmaxInMessageDeliverThreadMsgMixin\",\"WASmaxInMessageDeliverToProxyAccountMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrGroupJid(a,\"from\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").attrJidEnum(a,\"participant\",d(\"WASmaxInMessageDeliverEnums\").DEVICEJID_DEVICEJID);if(!c.success)return c;var e=d(\"WASmaxInMessageDeliverFanoutCountMixin\").parseFanoutCountMixin(a),f=d(\"WASmaxInMessageDeliverParticipantLIDMixin\").parseParticipantLIDMixin(a),g=d(\"WASmaxInMessageDeliverDisplayNameMixin\").parseDisplayNameMixin(a),h=d(\"WASmaxInMessageDeliverGroupAddressingModeMixin\").parseGroupAddressingModeMixin(a),i=d(\"WASmaxInMessageDeliverToProxyAccountMixin\").parseToProxyAccountMixin(a),j=d(\"WASmaxInMessageDeliverBotThreadIDMixin\").parseBotThreadIDMixin(a),k=d(\"WASmaxInMessageDeliverThreadMsgMixin\").parseThreadMsgMixin(a),l=d(\"WASmaxInMessageDeliverGroupDualOrSingleEncMixinGroup\").parseGroupDualOrSingleEncMixinGroup(a);if(!l.success)return l;a=d(\"WASmaxInMessageDeliverGroupEditMixins\").parseGroupEditMixins(a);return d(\"WAResultOrError\").makeResult({from:b.value,participant:c.value,fanoutCountMixin:e.success?e.value:null,participantLIDMixin:f.success?f.value:null,displayNameMixin:g.success?g.value:null,groupAddressingModeMixin:h.success?h.value:null,toProxyAccountMixin:i.success?i.value:null,botThreadIDMixin:j.success?j.value:null,threadMsgMixin:k.success?k.value:null,groupDualOrSingleEncMixinGroup:l.value,groupEditMixins:a.success?a.value:null})}g.parseGroupMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBusinessBotMessageMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"bot\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"biz_bot\",d(\"WASmaxInMessageDeliverEnums\").ENUM_1_3);return!a.success?a:d(\"WAResultOrError\").makeResult({botBizBot:a.value})}g.parseBusinessBotMessageMixin=a}),98);\n__d(\"WASmaxInMessageDeliverSingleSelectListMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"list\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a.value,\"type\",\"single_select\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a.value,\"v\",d(\"WASmaxInMessageDeliverEnums\").ENUM_1_2);return!a.success?a:d(\"WAResultOrError\").makeResult({bizListType:b.value,bizListV:a.value})}g.parseSingleSelectListMixin=a}),98);\n__d(\"WASmaxInMessageDeliverSingleSelectOrProductListMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverProductListMixin\",\"WASmaxInMessageDeliverSingleSelectListMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverSingleSelectListMixin\").parseSingleSelectListMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"SingleSelectList\",value:b.value});var c=d(\"WASmaxInMessageDeliverProductListMixin\").parseProductListMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"ProductList\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"SingleSelectList\",\"ProductList\"],[b,c])}g.parseSingleSelectOrProductListMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypeListMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeMediaMixin\",\"WASmaxInMessageDeliverEncListMixin\",\"WASmaxInMessageDeliverSingleSelectOrProductListMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverEncListMixin\").parseEncListMixin(b.value);if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverContentTypeMediaMixin\").parseContentTypeMediaMixin(a);if(!c.success)return c;a=d(\"WASmaxInMessageDeliverSingleSelectOrProductListMixinGroup\").parseSingleSelectOrProductListMixinGroup(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({encEncListMixin:b.value},c.value,{singleSelectOrProductListMixinGroup:a.success?a.value:null}))}g.parseContentTypeListMixin=a}),98);\n__d(\"WASmaxInMessageDeliverIndividualDeliverPayNodeMixin\",[\"WASmaxInMessageDeliverIndividualRequestPayNodeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"pay\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverIndividualRequestPayNodeMixin\").parseIndividualRequestPayNodeMixin(a);return!b.success?b:b}g.parseIndividualDeliverPayNodeMixin=a}),98);\n__d(\"WASmaxInMessageDeliverIndividualDeliverPayNodeMessageMixin\",[\"WASmaxInMessageDeliverIndividualDeliverPayNodeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"pay\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverIndividualDeliverPayNodeMixin\").parseIndividualDeliverPayNodeMixin(b.value);return!a.success?a:a}g.parseIndividualDeliverPayNodeMessageMixin=a}),98);\n__d(\"WASmaxInMessageDeliverIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverIndividualDeliverPayNodeMessageMixin\",\"WASmaxInMessageDeliverPayTransactionMessageMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverIndividualDeliverPayNodeMessageMixin\").parseIndividualDeliverPayNodeMessageMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"IndividualDeliverPayNodeMessage\",value:b.value});var c=d(\"WASmaxInMessageDeliverPayTransactionMessageMixin\").parsePayTransactionMessageMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"PayTransactionMessage\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"IndividualDeliverPayNodeMessage\",\"PayTransactionMessage\"],[b,c])}g.parseIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverContentTypePayIndividualMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypePayMixin\",\"WASmaxInMessageDeliverIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverContentTypePayMixin\").parseContentTypePayMixin(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup\").parseIndividualDeliverPayNodeOrPayTransactionMessageMixinGroup(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{individualDeliverPayNodeOrPayTransactionMessageMixinGroup:a.success?a.value:null}))}g.parseContentTypePayIndividualMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentAvailableMixins\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeListMixin\",\"WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin\",\"WASmaxInMessageDeliverContentTypeMediaSingleMixin\",\"WASmaxInMessageDeliverContentTypeMedianotifyMixin\",\"WASmaxInMessageDeliverContentTypePayIndividualMixin\",\"WASmaxInMessageDeliverContentTypePollCreationMixin\",\"WASmaxInMessageDeliverContentTypePollVoteMixin\",\"WASmaxInMessageDeliverContentTypeReactionMixin\",\"WASmaxInMessageDeliverContentTypeTextMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverContentTypeTextMixin\").parseContentTypeTextMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeText\",value:b.value});var c=d(\"WASmaxInMessageDeliverContentTypeListMixin\").parseContentTypeListMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeList\",value:c.value});var e=d(\"WASmaxInMessageDeliverContentTypeLiveLocationSingleMixin\").parseContentTypeLiveLocationSingleMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeLiveLocationSingle\",value:e.value});var f=d(\"WASmaxInMessageDeliverContentTypeMediaSingleMixin\").parseContentTypeMediaSingleMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeMediaSingle\",value:f.value});var g=d(\"WASmaxInMessageDeliverContentTypePayIndividualMixin\").parseContentTypePayIndividualMixin(a);if(g.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypePayIndividual\",value:g.value});var h=d(\"WASmaxInMessageDeliverContentTypeReactionMixin\").parseContentTypeReactionMixin(a);if(h.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeReaction\",value:h.value});var i=d(\"WASmaxInMessageDeliverContentTypePollCreationMixin\").parseContentTypePollCreationMixin(a);if(i.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypePollCreation\",value:i.value});var j=d(\"WASmaxInMessageDeliverContentTypePollVoteMixin\").parseContentTypePollVoteMixin(a);if(j.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypePollVote\",value:j.value});var k=d(\"WASmaxInMessageDeliverContentTypeMedianotifyMixin\").parseContentTypeMedianotifyMixin(a);return k.success?d(\"WAResultOrError\").makeResult({name:\"ContentTypeMedianotify\",value:k.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ContentTypeText\",\"ContentTypeList\",\"ContentTypeLiveLocationSingle\",\"ContentTypeMediaSingle\",\"ContentTypePayIndividual\",\"ContentTypeReaction\",\"ContentTypePollCreation\",\"ContentTypePollVote\",\"ContentTypeMedianotify\"],[b,c,e,f,g,h,i,j,k])}g.parseContentAvailableMixins=a}),98);\n__d(\"WASmaxInMessageDeliverRetryOrIndividualRegularOrBotResponseMessageMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBotResponseMessageMixin\",\"WASmaxInMessageDeliverIndividualRegularMixin\",\"WASmaxInMessageDeliverRetryMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverRetryMixin\").parseRetryMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"Retry\",value:b.value});var c=d(\"WASmaxInMessageDeliverIndividualRegularMixin\").parseIndividualRegularMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"IndividualRegular\",value:c.value});var e=d(\"WASmaxInMessageDeliverBotResponseMessageMixin\").parseBotResponseMessageMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"BotResponseMessage\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Retry\",\"IndividualRegular\",\"BotResponseMessage\"],[b,c,e])}g.parseRetryOrIndividualRegularOrBotResponseMessageMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverAvailableMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBusinessBotMessageMixin\",\"WASmaxInMessageDeliverContentAvailableMixins\",\"WASmaxInMessageDeliverRetryOrIndividualRegularOrBotResponseMessageMixinGroup\",\"WASmaxInMessageDeliverRevokeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"enc\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverRevokeMixin\").parseRevokeMixin(a);var c=d(\"WASmaxInMessageDeliverBusinessBotMessageMixin\").parseBusinessBotMessageMixin(a),e=d(\"WASmaxInMessageDeliverRetryOrIndividualRegularOrBotResponseMessageMixinGroup\").parseRetryOrIndividualRegularOrBotResponseMessageMixinGroup(a);if(!e.success)return e;a=d(\"WASmaxInMessageDeliverContentAvailableMixins\").parseContentAvailableMixins(a);return!a.success?a:d(\"WAResultOrError\").makeResult({revokeMixin:b.success?b.value:null,businessBotMessageMixin:c.success?c.value:null,retryOrIndividualRegularOrBotResponseMessageMixinGroup:e.value,contentAvailableMixins:a.value})}g.parseAvailableMixin=a}),98);\n__d(\"WASmaxInMessageDeliverContentUnavailableMixins\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeMediaMixin\",\"WASmaxInMessageDeliverContentTypePayIndividualMixin\",\"WASmaxInMessageDeliverContentTypePollCreationMixin\",\"WASmaxInMessageDeliverContentTypePollVoteMixin\",\"WASmaxInMessageDeliverContentTypeReactionMixin\",\"WASmaxInMessageDeliverContentTypeTextMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverContentTypeTextMixin\").parseContentTypeTextMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeText\",value:b.value});var c=d(\"WASmaxInMessageDeliverContentTypeMediaMixin\").parseContentTypeMediaMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeMedia\",value:c.value});var e=d(\"WASmaxInMessageDeliverContentTypePayIndividualMixin\").parseContentTypePayIndividualMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypePayIndividual\",value:e.value});var f=d(\"WASmaxInMessageDeliverContentTypeReactionMixin\").parseContentTypeReactionMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypeReaction\",value:f.value});var g=d(\"WASmaxInMessageDeliverContentTypePollCreationMixin\").parseContentTypePollCreationMixin(a);if(g.success)return d(\"WAResultOrError\").makeResult({name:\"ContentTypePollCreation\",value:g.value});var h=d(\"WASmaxInMessageDeliverContentTypePollVoteMixin\").parseContentTypePollVoteMixin(a);return h.success?d(\"WAResultOrError\").makeResult({name:\"ContentTypePollVote\",value:h.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ContentTypeText\",\"ContentTypeMedia\",\"ContentTypePayIndividual\",\"ContentTypeReaction\",\"ContentTypePollCreation\",\"ContentTypePollVote\"],[b,c,e,f,g,h])}g.parseContentUnavailableMixins=a}),98);\n__d(\"WASmaxInMessageDeliverUnavailableMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentUnavailableMixins\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"unavailable\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalLiteral(d(\"WASmaxParseUtils\").attrString,b.value,\"hosted\",\"true\");if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverContentUnavailableMixins\").parseContentUnavailableMixins(a);if(!c.success)return c;a=d(\"WASmaxParseUtils\").countChildrenWithTag(a,\"enc\",0,Infinity,d(\"WAResultOrError\").makeResult);return!a.success?a:d(\"WAResultOrError\").makeResult({unavailableHosted:b.value,contentUnavailableMixins:c.value,countEnc:a.value})}g.parseUnavailableMixin=a}),98);\n__d(\"WASmaxInMessageDeliverAvailableOrUnavailableMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverAvailableMixin\",\"WASmaxInMessageDeliverUnavailableMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverAvailableMixin\").parseAvailableMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"Available\",value:b.value});var c=d(\"WASmaxInMessageDeliverUnavailableMixin\").parseUnavailableMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"Unavailable\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Available\",\"Unavailable\"],[b,c])}g.parseAvailableOrUnavailableMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverBotLocaleMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"locale\");return!b.success?b:d(\"WAResultOrError\").makeResult({locale:b.value})}g.parseBotLocaleMixin=a}),98);\n__d(\"WASmaxInMessageDeliverGroupInviteTargetMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseJid\").attrGroupJid(b.value,\"group_invite\");return!a.success?a:d(\"WAResultOrError\").makeResult({metaGroupInvite:a.value})}g.parseGroupInviteTargetMixin=a}),98);\n__d(\"WASmaxInMessageDeliverLidChatOriginMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"origin\",d(\"WASmaxInMessageDeliverEnums\").ENUM_CTWA_USERNAME);if(!a.success)return a;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,b.value,\"share_pn\",d(\"WASmaxInMessageDeliverEnums\").ENUM_FALSE_TRUE);return!b.success?b:d(\"WAResultOrError\").makeResult({metaOrigin:a.value,metaSharePn:b.value})}g.parseLidChatOriginMixin=a}),98);\n__d(\"WASmaxInMessageDeliverMessageEditOrMessagePinOrRevokeMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverMessageEditMixin\",\"WASmaxInMessageDeliverMessagePinMixin\",\"WASmaxInMessageDeliverRevokeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverMessageEditMixin\").parseMessageEditMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"MessageEdit\",value:b.value});var c=d(\"WASmaxInMessageDeliverMessagePinMixin\").parseMessagePinMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"MessagePin\",value:c.value});var e=d(\"WASmaxInMessageDeliverRevokeMixin\").parseRevokeMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"Revoke\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"MessageEdit\",\"MessagePin\",\"Revoke\"],[b,c,e])}g.parseMessageEditOrMessagePinOrRevokeMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverRecipientDisplayNameMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"recipient_display_name\");return!b.success?b:d(\"WAResultOrError\").makeResult({recipientDisplayName:b.value})}g.parseRecipientDisplayNameMixin=a}),98);\n__d(\"WASmaxInMessageDeliverRecipientLIDMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"recipient_lid\");return!b.success?b:d(\"WAResultOrError\").makeResult({recipientLid:b.value})}g.parseRecipientLIDMixin=a}),98);\n__d(\"WASmaxInMessageDeliverRecipientPNMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"recipient_pn\");return!b.success?b:d(\"WAResultOrError\").makeResult({recipientPn:b.value})}g.parseRecipientPNMixin=a}),98);\n__d(\"WASmaxInMessageDeliverRecipientUsernameMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"recipient_username\");return!b.success?b:d(\"WAResultOrError\").makeResult({recipientUsername:b.value})}g.parseRecipientUsernameMixin=a}),98);\n__d(\"WASmaxInMessageDeliverRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverRecipientDisplayNameMixin\",\"WASmaxInMessageDeliverRecipientLIDMixin\",\"WASmaxInMessageDeliverRecipientPNMixin\",\"WASmaxInMessageDeliverRecipientUsernameMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverRecipientLIDMixin\").parseRecipientLIDMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"RecipientLID\",value:b.value});var c=d(\"WASmaxInMessageDeliverRecipientPNMixin\").parseRecipientPNMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"RecipientPN\",value:c.value});var e=d(\"WASmaxInMessageDeliverRecipientDisplayNameMixin\").parseRecipientDisplayNameMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"RecipientDisplayName\",value:e.value});var f=d(\"WASmaxInMessageDeliverRecipientUsernameMixin\").parseRecipientUsernameMixin(a);return f.success?d(\"WAResultOrError\").makeResult({name:\"RecipientUsername\",value:f.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"RecipientLID\",\"RecipientPN\",\"RecipientDisplayName\",\"RecipientUsername\"],[b,c,e,f])}g.parseRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverRecipientMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"recipient\");return!b.success?b:d(\"WAResultOrError\").makeResult({recipient:b.value})}g.parseRecipientMixin=a}),98);\n__d(\"WASmaxInMessageDeliverSenderLIDMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"sender_lid\");return!b.success?b:d(\"WAResultOrError\").makeResult({senderLid:b.value})}g.parseSenderLIDMixin=a}),98);\n__d(\"WASmaxInMessageDeliverSenderPNMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"sender_pn\");return!b.success?b:d(\"WAResultOrError\").makeResult({senderPn:b.value})}g.parseSenderPNMixin=a}),98);\n__d(\"WASmaxInMessageDeliverSenderUsernameMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"username\");return!b.success?b:d(\"WAResultOrError\").makeResult({username:b.value})}g.parseSenderUsernameMixin=a}),98);\n__d(\"WASmaxInMessageDeliverSenderPNOrLIDOrUsernameMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverSenderLIDMixin\",\"WASmaxInMessageDeliverSenderPNMixin\",\"WASmaxInMessageDeliverSenderUsernameMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverSenderPNMixin\").parseSenderPNMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"SenderPN\",value:b.value});var c=d(\"WASmaxInMessageDeliverSenderLIDMixin\").parseSenderLIDMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"SenderLID\",value:c.value});var e=d(\"WASmaxInMessageDeliverSenderUsernameMixin\").parseSenderUsernameMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"SenderUsername\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"SenderPN\",\"SenderLID\",\"SenderUsername\"],[b,c,e])}g.parseSenderPNOrLIDOrUsernameMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverThreadTypeTagEnumMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"meta\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrInt(a,\"thread_type\");return!b.success?b:d(\"WAResultOrError\").makeResult({threadType:b.value})}g.parseThreadTypeTagEnumMixin=a}),98);\n__d(\"WASmaxInMessageDeliverThreadTypeTagLegacyMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"meta\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"thread_type\");return!b.success?b:d(\"WAResultOrError\").makeResult({threadType:b.value})}g.parseThreadTypeTagLegacyMixin=a}),98);\n__d(\"WASmaxInMessageDeliverThreadTypeTagEnumOrLegacyMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverThreadTypeTagEnumMixin\",\"WASmaxInMessageDeliverThreadTypeTagLegacyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverThreadTypeTagEnumMixin\").parseThreadTypeTagEnumMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"ThreadTypeTagEnum\",value:b.value});var c=d(\"WASmaxInMessageDeliverThreadTypeTagLegacyMixin\").parseThreadTypeTagLegacyMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"ThreadTypeTagLegacy\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ThreadTypeTagEnum\",\"ThreadTypeTagLegacy\"],[b,c])}g.parseThreadTypeTagEnumOrLegacyMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverThreadTypeTagMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverThreadTypeTagEnumOrLegacyMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxInMessageDeliverThreadTypeTagEnumOrLegacyMixinGroup\").parseThreadTypeTagEnumOrLegacyMixinGroup(b.value);return!a.success?a:d(\"WAResultOrError\").makeResult({metaThreadTypeTagEnumOrLegacyMixinGroup:a.value})}g.parseThreadTypeTagMixin=a}),98);\n__d(\"WASmaxInMessageDeliverIndividualMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverAvailableOrUnavailableMixinGroup\",\"WASmaxInMessageDeliverBotLocaleMixin\",\"WASmaxInMessageDeliverBotThreadIDMixin\",\"WASmaxInMessageDeliverDisplayNameMixin\",\"WASmaxInMessageDeliverEnums\",\"WASmaxInMessageDeliverGroupInviteTargetMixin\",\"WASmaxInMessageDeliverLidChatOriginMixin\",\"WASmaxInMessageDeliverMessageEditOrMessagePinOrRevokeMixinGroup\",\"WASmaxInMessageDeliverRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup\",\"WASmaxInMessageDeliverRecipientMixin\",\"WASmaxInMessageDeliverSenderPNOrLIDOrUsernameMixinGroup\",\"WASmaxInMessageDeliverThreadTypeTagMixin\",\"WASmaxInMessageDeliverToProxyAccountMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrJidEnum(a,\"from\",d(\"WASmaxInMessageDeliverEnums\").DEVICEJID_DEVICEJID);if(!b.success)return b;var c=d(\"WASmaxInMessageDeliverRecipientMixin\").parseRecipientMixin(a),e=d(\"WASmaxInMessageDeliverDisplayNameMixin\").parseDisplayNameMixin(a),f=d(\"WASmaxInMessageDeliverGroupInviteTargetMixin\").parseGroupInviteTargetMixin(a),g=d(\"WASmaxInMessageDeliverThreadTypeTagMixin\").parseThreadTypeTagMixin(a),h=d(\"WASmaxInMessageDeliverToProxyAccountMixin\").parseToProxyAccountMixin(a),i=d(\"WASmaxInMessageDeliverBotThreadIDMixin\").parseBotThreadIDMixin(a),j=d(\"WASmaxInMessageDeliverLidChatOriginMixin\").parseLidChatOriginMixin(a),k=d(\"WASmaxInMessageDeliverBotLocaleMixin\").parseBotLocaleMixin(a),l=d(\"WASmaxInMessageDeliverMessageEditOrMessagePinOrRevokeMixinGroup\").parseMessageEditOrMessagePinOrRevokeMixinGroup(a),m=d(\"WASmaxInMessageDeliverAvailableOrUnavailableMixinGroup\").parseAvailableOrUnavailableMixinGroup(a);if(!m.success)return m;var n=d(\"WASmaxInMessageDeliverSenderPNOrLIDOrUsernameMixinGroup\").parseSenderPNOrLIDOrUsernameMixinGroup(a);a=d(\"WASmaxInMessageDeliverRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup\").parseRecipientLIDOrPNOrDisplayNameOrUsernameMixinGroup(a);return d(\"WAResultOrError\").makeResult({from:b.value,recipientMixin:c.success?c.value:null,displayNameMixin:e.success?e.value:null,groupInviteTargetMixin:f.success?f.value:null,threadTypeTagMixin:g.success?g.value:null,toProxyAccountMixin:h.success?h.value:null,botThreadIDMixin:i.success?i.value:null,lidChatOriginMixin:j.success?j.value:null,botLocaleMixin:k.success?k.value:null,messageEditOrMessagePinOrRevokeMixinGroup:l.success?l.value:null,availableOrUnavailableMixinGroup:m.value,senderPNOrLIDOrUsernameMixinGroup:n.success?n.value:null,recipientLIDOrPNOrDisplayNameOrUsernameMixinGroup:a.success?a.value:null})}g.parseIndividualMixin=a}),98);\n__d(\"WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBroadcastDualEncMediaMixin\",\"WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverBroadcastDualEncNonMediaMixin\").parseBroadcastDualEncNonMediaMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"BroadcastDualEncNonMedia\",value:b.value});var c=d(\"WASmaxInMessageDeliverBroadcastDualEncMediaMixin\").parseBroadcastDualEncMediaMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"BroadcastDualEncMedia\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"BroadcastDualEncNonMedia\",\"BroadcastDualEncMedia\"],[b,c])}g.parseBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverStatusDualEncMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup\").parseBroadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup(a);return!b.success?b:d(\"WAResultOrError\").makeResult({broadcastDualEncBroadcastDualEncNonMediaOrBroadcastDualEncMediaMediaMixinGroup:b.value})}g.parseStatusDualEncMixin=a}),98);\n__d(\"WASmaxInMessageDeliverStatusSingleEncMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup\",\"WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxInMessageDeliverContentTypeTextOrMediaSingleMixinGroup\").parseContentTypeTextOrMediaSingleMixinGroup(a);if(!b.success)return b;a=d(\"WASmaxInMessageDeliverRetryOrBroadcastRegularMixinGroup\").parseRetryOrBroadcastRegularMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({contentTypeTextOrMediaSingleMixinGroup:b.value,retryOrBroadcastRegularMixinGroup:a.value})}g.parseStatusSingleEncMixin=a}),98);\n__d(\"WASmaxInMessageDeliverStatusDualOrSingleEncMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverStatusDualEncMixin\",\"WASmaxInMessageDeliverStatusSingleEncMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverStatusDualEncMixin\").parseStatusDualEncMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"StatusDualEnc\",value:b.value});var c=d(\"WASmaxInMessageDeliverStatusSingleEncMixin\").parseStatusSingleEncMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"StatusSingleEnc\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"StatusDualEnc\",\"StatusSingleEnc\"],[b,c])}g.parseStatusDualOrSingleEncMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverStatusSettingMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"status_setting\",d(\"WASmaxInMessageDeliverEnums\").ENUM_ALLOWLIST_CONTACTS_DENYLIST);return!a.success?a:d(\"WAResultOrError\").makeResult({metaStatusSetting:a.value})}g.parseStatusSettingMixin=a}),98);\n__d(\"WASmaxInMessageDeliverStatusMixin\",[\"WAResultOrError\",\"WASmaxInMessageDeliverFanoutCountMixin\",\"WASmaxInMessageDeliverRevokeMixin\",\"WASmaxInMessageDeliverStatusDualOrSingleEncMixinGroup\",\"WASmaxInMessageDeliverStatusSettingMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrStatusJid,a,\"from\",\"status@broadcast\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").attrDeviceJid(a,\"participant\");if(!c.success)return c;var e=d(\"WASmaxInMessageDeliverRevokeMixin\").parseRevokeMixin(a),f=d(\"WASmaxInMessageDeliverFanoutCountMixin\").parseFanoutCountMixin(a),g=d(\"WASmaxInMessageDeliverStatusSettingMixin\").parseStatusSettingMixin(a);a=d(\"WASmaxInMessageDeliverStatusDualOrSingleEncMixinGroup\").parseStatusDualOrSingleEncMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({from:b.value,participant:c.value,revokeMixin:e.success?e.value:null,fanoutCountMixin:f.success?f.value:null,statusSettingMixin:g.success?g.value:null,statusDualOrSingleEncMixinGroup:a.value})}g.parseStatusMixin=a}),98);\n__d(\"WASmaxInMessageDeliverIndividualOrGroupOrStatusOrBroadcastMixinGroup\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBroadcastMixin\",\"WASmaxInMessageDeliverGroupMixin\",\"WASmaxInMessageDeliverIndividualMixin\",\"WASmaxInMessageDeliverStatusMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverIndividualMixin\").parseIndividualMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"Individual\",value:b.value});var c=d(\"WASmaxInMessageDeliverGroupMixin\").parseGroupMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"Group\",value:c.value});var e=d(\"WASmaxInMessageDeliverStatusMixin\").parseStatusMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"Status\",value:e.value});var f=d(\"WASmaxInMessageDeliverBroadcastMixin\").parseBroadcastMixin(a);return f.success?d(\"WAResultOrError\").makeResult({name:\"Broadcast\",value:f.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Individual\",\"Group\",\"Status\",\"Broadcast\"],[b,c,e,f])}g.parseIndividualOrGroupOrStatusOrBroadcastMixinGroup=a}),98);\n__d(\"WASmaxInMessageDeliverRegularRequest\",[\"WAResultOrError\",\"WASmaxInMessageDeliverBaseMixin\",\"WASmaxInMessageDeliverIndividualOrGroupOrStatusOrBroadcastMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!c.success)return c;var e=d(\"WASmaxInMessageDeliverBaseMixin\").parseBaseMixin(a);if(!e.success)return e;a=d(\"WASmaxInMessageDeliverIndividualOrGroupOrStatusOrBroadcastMixinGroup\").parseIndividualOrGroupOrStatusOrBroadcastMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({id:b.value,t:c.value},e.value,{individualOrGroupOrStatusOrBroadcastMixinGroup:a.value}))}g.parseRegularRequest=a}),98);\n__d(\"WASmaxOutMessageDeliverAckMixin\",[\"WASmaxAttrs\",\"WASmaxInMessageDeliverEnums\",\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a,b){a=a.ackRecipient;var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrJidEnum,b,[\"from\"],d(\"WASmaxInMessageDeliverEnums\").DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_STATUSJID);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);var e=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,b,[\"id\"]);if(!e.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(e.error);var f=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,b,[\"type\"]);if(!f.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(f.error);var g=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrJidEnum,b,[\"participant\"],d(\"WASmaxInMessageDeliverEnums\").DEVICEJID_DEVICEJID_DEVICEJID);if(!g.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(g.error);b=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrUserJid,b,[\"actual_to\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);c=d(\"WASmaxJsx\").smax(\"ack\",{to:d(\"WAWap\").JID(c.value),\"class\":\"message\",id:d(\"WAWap\").STANZA_ID(e.value),type:d(\"WAWap\").CUSTOM_STRING(f.value),participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").JID,g.value),recipient:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").USER_JID,a),actual_from:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").JID,b.value)});return c}function a(a,b,c){b=h(b,c);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeAckMixin=a}),98);\n__d(\"WASmaxOutMessageDeliverRegularResponseMissingPlaceholder\",[\"WASmaxJsx\",\"WASmaxOutMessageDeliverAckMixin\"],(function(a,b,c,d,e,f,g){function a(a,b){a=d(\"WASmaxOutMessageDeliverAckMixin\").mergeAckMixin(d(\"WASmaxJsx\").smax(\"ack\",{error:\"404\"}),a,b);return a}g.makeRegularResponseMissingPlaceholder=a}),98);\n__d(\"WASmaxOutMessageDeliverRegularResponseSuccess\",[\"WASmaxJsx\",\"WASmaxOutMessageDeliverAckMixin\"],(function(a,b,c,d,e,f,g){function a(a,b){a=d(\"WASmaxOutMessageDeliverAckMixin\").mergeAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a,b);return a}g.makeRegularResponseSuccess=a}),98);\n__d(\"WASmaxMessageDeliverRegularRPC\",[\"WASmaxInMessageDeliverRegularRequest\",\"WASmaxOutMessageDeliverRegularResponseMissingPlaceholder\",\"WASmaxOutMessageDeliverRegularResponseSuccess\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageDeliverRegularRequest\").parseRegularRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Regular\",{Request:b}));return{parsedRequest:b.value,makeRegularResponseMissingPlaceholder:function(b){return d(\"WASmaxOutMessageDeliverRegularResponseMissingPlaceholder\").makeRegularResponseMissingPlaceholder(b,a)},makeRegularResponseSuccess:function(b){return d(\"WASmaxOutMessageDeliverRegularResponseSuccess\").makeRegularResponseSuccess(b,a)}}}g.receiveRegularRPC=a}),98);\n__d(\"WASmaxInMessageFallbackDeliverEncMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").countChildrenWithTag(a,\"enc\",1,Infinity,d(\"WAResultOrError\").makeResult);return!b.success?b:d(\"WAResultOrError\").makeResult({countEnc:b.value})}g.parseDeliverEncMixin=a}),98);\n__d(\"WASmaxInMessageFallbackEnums\",[\"WAJids\"],(function(a,b,c,d,e,f,g){b={validators:[(a=d(\"WAJids\")).validateBroadcastJid,a.validateCallJid,a.validateDeviceJid,a.validateDomainJid,a.validateGroupJid,a.validateStatusJid,a.validateUserJid],typeName:\"BroadcastJid|CallJid|DeviceJid|DomainJid|GroupJid|StatusJid|UserJid\"};g.BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID=b}),98);\n__d(\"WASmaxInMessageFallbackDeliverRequest\",[\"WAResultOrError\",\"WASmaxInMessageFallbackDeliverEncMixin\",\"WASmaxInMessageFallbackEnums\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"message\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").attrJidEnum(a,\"from\",d(\"WASmaxInMessageFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"type\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrJidEnum,a,\"participant\",d(\"WASmaxInMessageFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!f.success)return f;a=d(\"WASmaxInMessageFallbackDeliverEncMixin\").parseDeliverEncMixin(a);return d(\"WAResultOrError\").makeResult({id:b.value,from:c.value,type:e.value,participant:f.value,deliverEncMixin:a.success?a.value:null})}g.parseDeliverRequest=a}),98);\n__d(\"WASmaxOutMessageFallbackDeliverResponseBadStanza\",[\"WASmaxAttrs\",\"WASmaxInMessageFallbackEnums\",\"WASmaxJsx\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a,b){a=a.ackError;var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,b,[\"id\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);var e=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrJidEnum,b,[\"from\"],d(\"WASmaxInMessageFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(e.error);var f=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrJidEnum,b,[\"participant\"],d(\"WASmaxInMessageFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!f.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(f.error);b=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseUtils\").attrString,b,[\"type\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);c=d(\"WASmaxJsx\").smax(\"ack\",{\"class\":\"message\",id:d(\"WAWap\").STANZA_ID(c.value),to:d(\"WAWap\").JID(e.value),participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").JID,f.value),type:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").CUSTOM_STRING,b.value),error:d(\"WAWap\").INT(a)});return c}g.makeDeliverResponseBadStanza=a}),98);\n__d(\"WASmaxOutMessageFallbackDeliverResponseDelivery\",[\"WASmaxAttrs\",\"WASmaxInMessageFallbackEnums\",\"WASmaxJsx\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrJidEnum,a,[\"from\"],d(\"WASmaxInMessageFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrJidEnum,a,[\"participant\"],d(\"WASmaxInMessageFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"receipt\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").JID(c.value),participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").JID,a.value)});return b}g.makeDeliverResponseDelivery=a}),98);\n__d(\"WASmaxOutMessageFallbackDeliverResponseNoEnc\",[\"WASmaxAttrs\",\"WASmaxInMessageFallbackEnums\",\"WASmaxJsx\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrJidEnum,a,[\"from\"],d(\"WASmaxInMessageFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);var e=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrJidEnum,a,[\"participant\"],d(\"WASmaxInMessageFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(e.error);a=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{\"class\":\"message\",id:d(\"WAWap\").STANZA_ID(b.value),from:d(\"WAWap\").JID(c.value),participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").JID,e.value),type:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").CUSTOM_STRING,a.value),error:\"406\"});return b}g.makeDeliverResponseNoEnc=a}),98);\n__d(\"WASmaxMessageFallbackDeliverRPC\",[\"WASmaxInMessageFallbackDeliverRequest\",\"WASmaxOutMessageFallbackDeliverResponseBadStanza\",\"WASmaxOutMessageFallbackDeliverResponseDelivery\",\"WASmaxOutMessageFallbackDeliverResponseNoEnc\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageFallbackDeliverRequest\").parseDeliverRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Deliver\",{Request:b}));return{parsedRequest:b.value,makeDeliverResponseNoEnc:function(){return d(\"WASmaxOutMessageFallbackDeliverResponseNoEnc\").makeDeliverResponseNoEnc(a)},makeDeliverResponseDelivery:function(){return d(\"WASmaxOutMessageFallbackDeliverResponseDelivery\").makeDeliverResponseDelivery(a)},makeDeliverResponseBadStanza:function(b){return d(\"WASmaxOutMessageFallbackDeliverResponseBadStanza\").makeDeliverResponseBadStanza(b,a)}}}g.receiveDeliverRPC=a}),98);\n__d(\"WACreateHandleMessage\",[\"Promise\",\"WACommonMessageBase\",\"WACreateHandleGroupMessageBranch\",\"WACreateHandleIndividualMessageBranch\",\"WACreateHandlePeerMessageBranch\",\"WALogger\",\"WAResultOrError\",\"WASmaxMessageDeliverNewsletterRPC\",\"WASmaxMessageDeliverRegularRPC\",\"WASmaxMessageFallbackDeliverRPC\",\"WASmaxParsingFailure\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleMessage receives an invalid stanza. Error: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleMessage receives an invalid stanza: \",\".\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Ignore incoming <message \/> because no handler is provided\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"DT: handleMessage start\"]);l=function(){return a};return a}function a(a){var c=a.individualMessage,e=a.groupMessage,f=a.status,g=a.broadcast,m=d(\"WACreateHandlePeerMessageBranch\").createHandlePeerMessageBranch(a),n=c&&d(\"WACreateHandleIndividualMessageBranch\").createHandleIndividualMessageBranch(c.handleIndividualMessage),o=e&&d(\"WACreateHandleGroupMessageBranch\").createHandleGroupMessageBranch(e.handleGroupMessage);return function(a,c,e){d(\"WALogger\").LOG(l());try{if(((c=a.content)==null?void 0:(c=c[0])==null?void 0:c.tag)===\"plaintext\"){c=d(\"WASmaxMessageDeliverNewsletterRPC\").receiveNewsletterRPC(a);c=c.makeNewsletterResponseSuccess;return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(c()))}if(a.attrs.category===\"peer\")return m(a,{cryptoManager:e});c=d(\"WASmaxMessageDeliverRegularRPC\").receiveRegularRPC(a);var p=c.parsedRequest,q=c.makeRegularResponseSuccess;c=p.individualOrGroupOrStatusOrBroadcastMixinGroup;p=d(\"WACommonMessageBase\").transformMessageParsedRequest(p);switch(c.name){case\"Individual\":if(n!=null)return n({individualMixin:c.value,makeAck:function(){return q({})},commonMessageBase:p,ctx:{cryptoManager:e}});break;case\"Group\":if(o!=null)return o({groupMixin:c.value,makeAck:function(){return q({})},commonMessageBase:p,ctx:{cryptoManager:e}});break;case\"Broadcast\":if(g!=null)return g.handleBroadcastMessage({makeAck:function(){return q({})}}).then(d(\"WAResultOrError\").makeResult);break;default:c.name;if(f!=null)return f.handleStatusMessage({makeAck:function(){return q({})}}).then(d(\"WAResultOrError\").makeResult);break}d(\"WALogger\").LOG(k());p=d(\"WASmaxMessageFallbackDeliverRPC\").receiveDeliverRPC(a);e=p.makeDeliverResponseDelivery;return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(e()))}catch(e){if(e instanceof d(\"WASmaxParsingFailure\").SmaxParsingFailure){d(\"WALogger\").WARN(j(),a.toString());d(\"WALogger\").ERROR(i(),e);c=d(\"WASmaxMessageFallbackDeliverRPC\").receiveDeliverRPC(a);p=c.makeDeliverResponseBadStanza;return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(p({ackError:487})))}return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeError({type:\"runtime-error\",error:e}))}}}g.createHandleMessage=a}),98);\n__d(\"WASmaxInAccountSyncEnums\",[],(function(a,b,c,d,e,f){a={block:\"block\",unblock:\"unblock\"};f.ENUM_BLOCK_UNBLOCK=a}),66);\n__d(\"WASmaxInAccountSyncNotificationBlocklistMixin\",[\"WAResultOrError\",\"WASmaxInAccountSyncEnums\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"blocklist\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"item\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"dhash\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").attrString(a,\"prev_dhash\");if(!a.success)return a;var e=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"action\",d(\"WASmaxInAccountSyncEnums\").ENUM_BLOCK_UNBLOCK);if(!e.success)return e;b=d(\"WASmaxParseJid\").attrUserJid(b.value,\"jid\");return!b.success?b:d(\"WAResultOrError\").makeResult({dhash:c.value,prevDhash:a.value,itemAction:e.value,itemJid:b.value})}g.parseNotificationBlocklistMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationBlocklistNoPayloadMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"blocklist\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"action\",\"modify\");return!b.success?b:d(\"WAResultOrError\").makeResult({action:b.value})}g.parseNotificationBlocklistNoPayloadMixin=a}),98);\n__d(\"WASmaxInAccountSyncBlocklistNotificationType\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationBlocklistMixin\",\"WASmaxInAccountSyncNotificationBlocklistNoPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAccountSyncNotificationBlocklistMixin\").parseNotificationBlocklistMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationBlocklist\",value:b.value});var c=d(\"WASmaxInAccountSyncNotificationBlocklistNoPayloadMixin\").parseNotificationBlocklistNoPayloadMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"NotificationBlocklistNoPayload\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Blocklist\",\"BlocklistNoPayload\"],[b,c])}g.parseBlocklistNotificationType=a}),98);\n__d(\"WASmaxInAccountSyncNotificationBlocklistNotificationMixin\",[\"WAResultOrError\",\"WASmaxInAccountSyncBlocklistNotificationType\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"blocklist\");if(!b.success)return b;a=d(\"WASmaxInAccountSyncBlocklistNotificationType\").parseBlocklistNotificationType(b.value);return!a.success?a:d(\"WAResultOrError\").makeResult({blocklistBlocklistNotificationType:a.value})}g.parseNotificationBlocklistNotificationMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationDevicesMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"device\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrDeviceJid(a,\"jid\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"key-index\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({jid:b.value,keyIndex:a.value})}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"key-index-list\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"ts\",-1,void 0);if(!b.success)return b;a=d(\"WASmaxParseUtils\").contentBytesRange(a,0,100);return!a.success?a:d(\"WAResultOrError\").makeResult({ts:b.value,elementValue:a.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"devices\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"key-index-list\",i);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"dhash\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"device\",0,1e3,h);return!a.success?a:d(\"WAResultOrError\").makeResult({dhash:c.value,keyIndexList:b.value,device:a.value})}g.parseNotificationDevicesDevice=h;g.parseNotificationDevicesKeyIndexList=i;g.parseNotificationDevicesMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationDevicesNoPayloadMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"devices\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"action\",\"modify\");return!b.success?b:d(\"WAResultOrError\").makeResult({action:b.value})}g.parseNotificationDevicesNoPayloadMixin=a}),98);\n__d(\"WASmaxInAccountSyncDevicesNotificationType\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationDevicesMixin\",\"WASmaxInAccountSyncNotificationDevicesNoPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAccountSyncNotificationDevicesMixin\").parseNotificationDevicesMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationDevices\",value:b.value});var c=d(\"WASmaxInAccountSyncNotificationDevicesNoPayloadMixin\").parseNotificationDevicesNoPayloadMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"NotificationDevicesNoPayload\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Devices\",\"DevicesNoPayload\"],[b,c])}g.parseDevicesNotificationType=a}),98);\n__d(\"WASmaxInAccountSyncNotificationDevicesNotificationMixin\",[\"WAResultOrError\",\"WASmaxInAccountSyncDevicesNotificationType\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"devices\");if(!b.success)return b;a=d(\"WASmaxInAccountSyncDevicesNotificationType\").parseDevicesNotificationType(b.value);return!a.success?a:d(\"WAResultOrError\").makeResult({devicesDevicesNotificationType:a.value})}g.parseNotificationDevicesNotificationMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationDisappearingModeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"disappearing_mode\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"duration\",0,void 0);if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({duration:b.value,t:a.value})}g.parseNotificationDisappearingModeMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationDisappearingModeNoPayloadMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"disappearing_mode\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"action\",\"modify\");return!b.success?b:d(\"WAResultOrError\").makeResult({action:b.value})}g.parseNotificationDisappearingModeNoPayloadMixin=a}),98);\n__d(\"WASmaxInAccountSyncDisappearingModeNotificationType\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationDisappearingModeMixin\",\"WASmaxInAccountSyncNotificationDisappearingModeNoPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAccountSyncNotificationDisappearingModeMixin\").parseNotificationDisappearingModeMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationDisappearingMode\",value:b.value});var c=d(\"WASmaxInAccountSyncNotificationDisappearingModeNoPayloadMixin\").parseNotificationDisappearingModeNoPayloadMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"NotificationDisappearingModeNoPayload\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"DisappearingMode\",\"DisappearingModeNoPayload\"],[b,c])}g.parseDisappearingModeNotificationType=a}),98);\n__d(\"WASmaxInAccountSyncNotificationDisappearingModeNotificationMixin\",[\"WAResultOrError\",\"WASmaxInAccountSyncDisappearingModeNotificationType\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"disappearing_mode\");if(!b.success)return b;a=d(\"WASmaxInAccountSyncDisappearingModeNotificationType\").parseDisappearingModeNotificationType(b.value);return!a.success?a:d(\"WAResultOrError\").makeResult({disappearingModeDisappearingModeNotificationType:a.value})}g.parseNotificationDisappearingModeNotificationMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationNoticeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notice\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"id\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrIntRange(a,\"stage\",0,1e3);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!e.success)return e;var f=d(\"WASmaxParseUtils\").attrIntRange(a,\"version\",1,void 0);if(!f.success)return f;a=d(\"WASmaxParseUtils\").attrIntRange(a,\"type\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({id:b.value,stage:c.value,t:e.value,version:f.value,type:a.value})}g.parseNotificationNoticeMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationNoticeNoPayloadMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notice\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"action\",\"modify\");return!b.success?b:d(\"WAResultOrError\").makeResult({action:b.value})}g.parseNotificationNoticeNoPayloadMixin=a}),98);\n__d(\"WASmaxInAccountSyncNoticeNotificationType\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationNoticeMixin\",\"WASmaxInAccountSyncNotificationNoticeNoPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAccountSyncNotificationNoticeMixin\").parseNotificationNoticeMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationNotice\",value:b.value});var c=d(\"WASmaxInAccountSyncNotificationNoticeNoPayloadMixin\").parseNotificationNoticeNoPayloadMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"NotificationNoticeNoPayload\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Notice\",\"NoticeNoPayload\"],[b,c])}g.parseNoticeNotificationType=a}),98);\n__d(\"WASmaxInAccountSyncNotificationNoticeNotificationMixin\",[\"WAResultOrError\",\"WASmaxInAccountSyncNoticeNotificationType\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"notice\");if(!b.success)return b;a=d(\"WASmaxInAccountSyncNoticeNotificationType\").parseNoticeNotificationType(b.value);return!a.success?a:d(\"WAResultOrError\").makeResult({noticeNoticeNotificationType:a.value})}g.parseNotificationNoticeNotificationMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationPictureMixin\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"picture\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"delete\");return!b.success?b:d(\"WASmaxParseUtils\").voidSuccess}g.parseNotificationPictureMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationPictureNoPayloadMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"picture\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"action\",\"modify\");return!b.success?b:d(\"WAResultOrError\").makeResult({action:b.value})}g.parseNotificationPictureNoPayloadMixin=a}),98);\n__d(\"WASmaxInAccountSyncPictureNotificationType\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationPictureMixin\",\"WASmaxInAccountSyncNotificationPictureNoPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAccountSyncNotificationPictureMixin\").parseNotificationPictureMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationPicture\",value:b.value});var c=d(\"WASmaxInAccountSyncNotificationPictureNoPayloadMixin\").parseNotificationPictureNoPayloadMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"NotificationPictureNoPayload\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Picture\",\"PictureNoPayload\"],[b,c])}g.parsePictureNotificationType=a}),98);\n__d(\"WASmaxInAccountSyncNotificationPictureNotificationMixin\",[\"WAResultOrError\",\"WASmaxInAccountSyncPictureNotificationType\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"picture\");if(!b.success)return b;a=d(\"WASmaxInAccountSyncPictureNotificationType\").parsePictureNotificationType(b.value);return!a.success?a:d(\"WAResultOrError\").makeResult({picturePictureNotificationType:a.value})}g.parseNotificationPictureNotificationMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationContactBlacklistNoAdditionalDataMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"category\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"action\",\"modify\");return!b.success?b:d(\"WAResultOrError\").makeResult({action:b.value})}g.parseNotificationContactBlacklistNoAdditionalDataMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationContactBlacklistWithAdditionalDataMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"user\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"action\");if(!b.success)return b;a=d(\"WASmaxParseJid\").attrUserJid(a,\"jid\");return!a.success?a:d(\"WAResultOrError\").makeResult({action:b.value,jid:a.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"category\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"dhash\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"prev_dhash\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"user\",0,1e3,h);return!a.success?a:d(\"WAResultOrError\").makeResult({dhash:b.value,prevDhash:c.value,user:a.value})}g.parseNotificationContactBlacklistWithAdditionalDataUser=h;g.parseNotificationContactBlacklistWithAdditionalDataMixin=a}),98);\n__d(\"WASmaxInAccountSyncContactBlacklistData\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationContactBlacklistNoAdditionalDataMixin\",\"WASmaxInAccountSyncNotificationContactBlacklistWithAdditionalDataMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAccountSyncNotificationContactBlacklistWithAdditionalDataMixin\").parseNotificationContactBlacklistWithAdditionalDataMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationContactBlacklistWithAdditionalData\",value:b.value});var c=d(\"WASmaxInAccountSyncNotificationContactBlacklistNoAdditionalDataMixin\").parseNotificationContactBlacklistNoAdditionalDataMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"NotificationContactBlacklistNoAdditionalData\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ContactBlacklistWithAdditionalData\",\"ContactBlacklistNoAdditionalData\"],[b,c])}g.parseContactBlacklistData=a}),98);\n__d(\"WASmaxInAccountSyncNotificationPrivacyMixin\",[\"WAResultOrError\",\"WASmaxInAccountSyncContactBlacklistData\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"category\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"name\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"value\");if(!c.success)return c;a=d(\"WASmaxInAccountSyncContactBlacklistData\").parseContactBlacklistData(a);return d(\"WAResultOrError\").makeResult({name:b.value,value:c.value,contactBlacklistData:a.success?a.value:null})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"privacy\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"category\",0,1e3,h);return!b.success?b:d(\"WAResultOrError\").makeResult({category:b.value})}g.parseNotificationPrivacyCategory=h;g.parseNotificationPrivacyMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationPrivacyNoPayloadMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"privacy\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"action\",\"modify\");return!b.success?b:d(\"WAResultOrError\").makeResult({action:b.value})}g.parseNotificationPrivacyNoPayloadMixin=a}),98);\n__d(\"WASmaxInAccountSyncPrivacyNotificationType\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationPrivacyMixin\",\"WASmaxInAccountSyncNotificationPrivacyNoPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAccountSyncNotificationPrivacyNoPayloadMixin\").parseNotificationPrivacyNoPayloadMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationPrivacyNoPayload\",value:b.value});var c=d(\"WASmaxInAccountSyncNotificationPrivacyMixin\").parseNotificationPrivacyMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"NotificationPrivacy\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"PrivacyNoPayload\",\"Privacy\"],[b,c])}g.parsePrivacyNotificationType=a}),98);\n__d(\"WASmaxInAccountSyncNotificationPrivacyNotificationMixin\",[\"WAResultOrError\",\"WASmaxInAccountSyncPrivacyNotificationType\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"privacy\");if(!b.success)return b;a=d(\"WASmaxInAccountSyncPrivacyNotificationType\").parsePrivacyNotificationType(b.value);return!a.success?a:d(\"WAResultOrError\").makeResult({privacyPrivacyNotificationType:a.value})}g.parseNotificationPrivacyNotificationMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationStatusMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"status\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"dhash\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").contentString(a);return!a.success?a:d(\"WAResultOrError\").makeResult({dhash:b.value,elementValue:a.value})}g.parseNotificationStatusMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationStatusNoPayloadMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"status\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"action\",\"modify\");return!b.success?b:d(\"WAResultOrError\").makeResult({action:b.value})}g.parseNotificationStatusNoPayloadMixin=a}),98);\n__d(\"WASmaxInAccountSyncStatusNotificationType\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationStatusMixin\",\"WASmaxInAccountSyncNotificationStatusNoPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAccountSyncNotificationStatusMixin\").parseNotificationStatusMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationStatus\",value:b.value});var c=d(\"WASmaxInAccountSyncNotificationStatusNoPayloadMixin\").parseNotificationStatusNoPayloadMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"NotificationStatusNoPayload\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Status\",\"StatusNoPayload\"],[b,c])}g.parseStatusNotificationType=a}),98);\n__d(\"WASmaxInAccountSyncNotificationStatusNotificationMixin\",[\"WAResultOrError\",\"WASmaxInAccountSyncStatusNotificationType\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"status\");if(!b.success)return b;a=d(\"WASmaxInAccountSyncStatusNotificationType\").parseStatusNotificationType(b.value);return!a.success?a:d(\"WAResultOrError\").makeResult({statusStatusNotificationType:a.value})}g.parseNotificationStatusNotificationMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationTextStatusEmojiMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"emoji\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"content\");return!b.success?b:d(\"WAResultOrError\").makeResult({content:b.value})}g.parseNotificationTextStatusEmojiMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationTextStatusMixin\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationTextStatusEmojiMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"text_status\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"emoji\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"text\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrInt(a,\"ephemeral_duration_sec\");if(!e.success)return e;a=d(\"WASmaxParseUtils\").attrString(a,\"last_update_time\");if(!a.success)return a;b=d(\"WASmaxInAccountSyncNotificationTextStatusEmojiMixin\").parseNotificationTextStatusEmojiMixin(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult({text:c.value,ephemeralDurationSec:e.value,lastUpdateTime:a.value,emojiNotificationTextStatusEmojiMixin:b.value})}g.parseNotificationTextStatusMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationTextStatusNoPayloadMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"text_status\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"action\",\"modify\");return!b.success?b:d(\"WAResultOrError\").makeResult({action:b.value})}g.parseNotificationTextStatusNoPayloadMixin=a}),98);\n__d(\"WASmaxInAccountSyncTextStatusNotificationType\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationTextStatusMixin\",\"WASmaxInAccountSyncNotificationTextStatusNoPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAccountSyncNotificationTextStatusMixin\").parseNotificationTextStatusMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationTextStatus\",value:b.value});var c=d(\"WASmaxInAccountSyncNotificationTextStatusNoPayloadMixin\").parseNotificationTextStatusNoPayloadMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"NotificationTextStatusNoPayload\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"TextStatus\",\"TextStatusNoPayload\"],[b,c])}g.parseTextStatusNotificationType=a}),98);\n__d(\"WASmaxInAccountSyncNotificationTextStatusNotificationMixin\",[\"WAResultOrError\",\"WASmaxInAccountSyncTextStatusNotificationType\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"text_status\");if(!b.success)return b;a=d(\"WASmaxInAccountSyncTextStatusNotificationType\").parseTextStatusNotificationType(b.value);return!a.success?a:d(\"WAResultOrError\").makeResult({textStatusTextStatusNotificationType:a.value})}g.parseNotificationTextStatusNotificationMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationUsernameChangeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"username\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"username\");return!b.success?b:d(\"WAResultOrError\").makeResult({username:b.value})}g.parseNotificationUsernameChangeMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationUsernameDeletionMixin\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").assertTag(a,\"username\");return!a.success?a:d(\"WASmaxParseUtils\").voidSuccess}g.parseNotificationUsernameDeletionMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationUsernameNoPayloadMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"username\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"action\",\"modify\");return!b.success?b:d(\"WAResultOrError\").makeResult({action:b.value})}g.parseNotificationUsernameNoPayloadMixin=a}),98);\n__d(\"WASmaxInAccountSyncUsernameNotificationType\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationUsernameChangeMixin\",\"WASmaxInAccountSyncNotificationUsernameDeletionMixin\",\"WASmaxInAccountSyncNotificationUsernameNoPayloadMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAccountSyncNotificationUsernameNoPayloadMixin\").parseNotificationUsernameNoPayloadMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationUsernameNoPayload\",value:b.value});var c=d(\"WASmaxInAccountSyncNotificationUsernameChangeMixin\").parseNotificationUsernameChangeMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationUsernameChange\",value:c.value});var e=d(\"WASmaxInAccountSyncNotificationUsernameDeletionMixin\").parseNotificationUsernameDeletionMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"NotificationUsernameDeletion\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"UsernameNoPayload\",\"UsernameChange\",\"UsernameDeletion\"],[b,c,e])}g.parseUsernameNotificationType=a}),98);\n__d(\"WASmaxInAccountSyncNotificationUsernameNotificationMixin\",[\"WAResultOrError\",\"WASmaxInAccountSyncUsernameNotificationType\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"username\");if(!b.success)return b;a=d(\"WASmaxInAccountSyncUsernameNotificationType\").parseUsernameNotificationType(b.value);return!a.success?a:d(\"WAResultOrError\").makeResult({usernameUsernameNotificationType:a.value})}g.parseNotificationUsernameNotificationMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationType\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationBlocklistNotificationMixin\",\"WASmaxInAccountSyncNotificationDevicesNotificationMixin\",\"WASmaxInAccountSyncNotificationDisappearingModeNotificationMixin\",\"WASmaxInAccountSyncNotificationNoticeNotificationMixin\",\"WASmaxInAccountSyncNotificationPictureNotificationMixin\",\"WASmaxInAccountSyncNotificationPrivacyNotificationMixin\",\"WASmaxInAccountSyncNotificationStatusNotificationMixin\",\"WASmaxInAccountSyncNotificationTextStatusNotificationMixin\",\"WASmaxInAccountSyncNotificationUsernameNotificationMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAccountSyncNotificationBlocklistNotificationMixin\").parseNotificationBlocklistNotificationMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationBlocklistNotification\",value:b.value});var c=d(\"WASmaxInAccountSyncNotificationDevicesNotificationMixin\").parseNotificationDevicesNotificationMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationDevicesNotification\",value:c.value});var e=d(\"WASmaxInAccountSyncNotificationPictureNotificationMixin\").parseNotificationPictureNotificationMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationPictureNotification\",value:e.value});var f=d(\"WASmaxInAccountSyncNotificationPrivacyNotificationMixin\").parseNotificationPrivacyNotificationMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationPrivacyNotification\",value:f.value});var g=d(\"WASmaxInAccountSyncNotificationStatusNotificationMixin\").parseNotificationStatusNotificationMixin(a);if(g.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationStatusNotification\",value:g.value});var h=d(\"WASmaxInAccountSyncNotificationTextStatusNotificationMixin\").parseNotificationTextStatusNotificationMixin(a);if(h.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationTextStatusNotification\",value:h.value});var i=d(\"WASmaxInAccountSyncNotificationUsernameNotificationMixin\").parseNotificationUsernameNotificationMixin(a);if(i.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationUsernameNotification\",value:i.value});var j=d(\"WASmaxInAccountSyncNotificationDisappearingModeNotificationMixin\").parseNotificationDisappearingModeNotificationMixin(a);if(j.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationDisappearingModeNotification\",value:j.value});var k=d(\"WASmaxInAccountSyncNotificationNoticeNotificationMixin\").parseNotificationNoticeNotificationMixin(a);return k.success?d(\"WAResultOrError\").makeResult({name:\"NotificationNoticeNotification\",value:k.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"BlocklistNotification\",\"DevicesNotification\",\"PictureNotification\",\"PrivacyNotification\",\"StatusNotification\",\"TextStatusNotification\",\"UsernameNotification\",\"DisappearingModeNotification\",\"NoticeNotification\"],[b,c,e,f,g,h,i,j,k])}g.parseNotificationType=a}),98);\n__d(\"WASmaxInAccountSyncServerNotificationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"offline\",0,1024);return!a.success?a:d(\"WAResultOrError\").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);\n__d(\"WASmaxInAccountSyncNotificationRequest\",[\"WAResultOrError\",\"WASmaxInAccountSyncNotificationType\",\"WASmaxInAccountSyncServerNotificationMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrDeviceJid(a,\"from\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"account_sync\");if(!c.success)return c;var e=d(\"WASmaxInAccountSyncServerNotificationMixin\").parseServerNotificationMixin(a);if(!e.success)return e;a=d(\"WASmaxInAccountSyncNotificationType\").parseNotificationType(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:b.value,type:c.value},e.value,{notificationType:a.value}))}g.parseNotificationRequest=a}),98);\n__d(\"WASmaxOutAccountSyncNotificationClientAckMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrDeviceJid,a,[\"from\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").DEVICE_JID(c.value),\"class\":\"notification\",type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);\n__d(\"WASmaxOutAccountSyncNotificationResponseAck\",[\"WASmaxJsx\",\"WASmaxOutAccountSyncNotificationClientAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutAccountSyncNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a);return a}g.makeNotificationResponseAck=a}),98);\n__d(\"WASmaxAccountSyncNotificationRPC\",[\"WASmaxInAccountSyncNotificationRequest\",\"WASmaxOutAccountSyncNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAccountSyncNotificationRequest\").parseNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Notification\",{Request:b}));return{parsedRequest:b.value,makeNotificationResponseAck:function(){return d(\"WASmaxOutAccountSyncNotificationResponseAck\").makeNotificationResponseAck(a)}}}g.receiveNotificationRPC=a}),98);\n__d(\"WACreateHandleAccountSyncNotificationBranch\",[\"Promise\",\"WAResultOrError\",\"WASmaxAccountSyncNotificationRPC\",\"WAUnknownStanzaError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){var c=(a=a.accountSync)!=null?a:{};return function(a){a=d(\"WASmaxAccountSyncNotificationRPC\").receiveNotificationRPC(a);var e=a.parsedRequest.notificationType;a=a.makeNotificationResponseAck;switch(e.name){case\"NotificationBlocklistNotification\":return i(e.value.blocklistBlocklistNotificationType,c.handleBlocklistNotification,a);case\"NotificationDevicesNotification\":return j(e.value.devicesDevicesNotificationType,c.handleDevicesNotification,a)}return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}}function i(a,c,e){if(c==null)return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError);if(a.name===\"NotificationBlocklist\"){var f=a.value,g=f.dhash,i=f.prevDhash,j=f.itemAction;f=f.itemJid;return c({dhash:g,displayName:null,action:j,jid:f,prevDhash:i,makeAck:e}).then(d(\"WAResultOrError\").makeResult)}else{a.name;return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}}function j(a,c,e){if(c==null)return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError);if(a.name===\"NotificationDevices\"){var f=a.value,g=f.dhash,i=f.device;f=f.keyIndexList;return c({dhash:g,devices:i,keyIndexList:f,makeAck:e}).then(d(\"WAResultOrError\").makeResult)}else{a.name;return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}}g.createHandleAccountSyncNotification=a}),98);\n__d(\"WASmaxInUsyncCloudAPIGroupListMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"group\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrGroupJid(a,\"jid\");return!b.success?b:d(\"WAResultOrError\").makeResult({jid:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"groups\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"group\",1,1e4,h);return!a.success?a:d(\"WAResultOrError\").makeResult({groupsGroup:a.value})}g.parseCloudAPIGroupListGroupsGroup=h;g.parseCloudAPIGroupListMixin=a}),98);\n__d(\"WASmaxInUsyncNotificationAddDevicesNotificationMixin\",[\"WAResultOrError\",\"WASmaxInUsyncCloudAPIGroupListMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"device\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrDeviceJid(a,\"jid\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrDeviceJid,a,\"lid\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"key-index\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({jid:b.value,lid:c.value,keyIndex:a.value})}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"key-index-list\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"ts\",-1,void 0);if(!b.success)return b;a=d(\"WASmaxParseUtils\").contentBytesRange(a,0,100);return!a.success?a:d(\"WAResultOrError\").makeResult({ts:b.value,elementValue:a.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"add\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optionalChildWithTag(b.value,\"key-index-list\",i);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrString(b.value,\"device_hash\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,b.value,\"device_lid_hash\");if(!f.success)return f;a=d(\"WASmaxInUsyncCloudAPIGroupListMixin\").parseCloudAPIGroupListMixin(a);b=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"device\",0,1e3,h);return!b.success?b:d(\"WAResultOrError\").makeResult({addDeviceHash:e.value,addDeviceLidHash:f.value,cloudAPIGroupListMixin:a.success?a.value:null,addKeyIndexList:c.value,addDevice:b.value})}g.parseNotificationAddDevicesNotificationAddDevice=h;g.parseNotificationAddDevicesNotificationAddKeyIndexList=i;g.parseNotificationAddDevicesNotificationMixin=a}),98);\n__d(\"WASmaxInUsyncNotificationRemoveDevicesNotificationMixin\",[\"WAResultOrError\",\"WASmaxInUsyncCloudAPIGroupListMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"device\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrDeviceJid(a,\"jid\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrDeviceJid,a,\"lid\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"key-index\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({jid:b.value,lid:c.value,keyIndex:a.value})}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"key-index-list\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"ts\",-1,void 0);if(!b.success)return b;a=d(\"WASmaxParseUtils\").contentBytesRange(a,0,100);return!a.success?a:d(\"WAResultOrError\").makeResult({ts:b.value,elementValue:a.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"remove\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optionalChildWithTag(b.value,\"key-index-list\",i);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrString(b.value,\"device_hash\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,b.value,\"device_lid_hash\");if(!f.success)return f;a=d(\"WASmaxInUsyncCloudAPIGroupListMixin\").parseCloudAPIGroupListMixin(a);b=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"device\",0,1e3,h);return!b.success?b:d(\"WAResultOrError\").makeResult({removeDeviceHash:e.value,removeDeviceLidHash:f.value,cloudAPIGroupListMixin:a.success?a.value:null,removeKeyIndexList:c.value,removeDevice:b.value})}g.parseNotificationRemoveDevicesNotificationRemoveDevice=h;g.parseNotificationRemoveDevicesNotificationRemoveKeyIndexList=i;g.parseNotificationRemoveDevicesNotificationMixin=a}),98);\n__d(\"WASmaxInUsyncNotificationUpdateDevicesNotificationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"update\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"notify\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").attrString(b.value,\"hash\");return!b.success?b:d(\"WAResultOrError\").makeResult({notify:a.value,updateHash:b.value})}g.parseNotificationUpdateDevicesNotificationMixin=a}),98);\n__d(\"WASmaxInUsyncDevicesNotification\",[\"WAResultOrError\",\"WASmaxInUsyncNotificationAddDevicesNotificationMixin\",\"WASmaxInUsyncNotificationRemoveDevicesNotificationMixin\",\"WASmaxInUsyncNotificationUpdateDevicesNotificationMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInUsyncNotificationAddDevicesNotificationMixin\").parseNotificationAddDevicesNotificationMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationAddDevicesNotification\",value:b.value});var c=d(\"WASmaxInUsyncNotificationRemoveDevicesNotificationMixin\").parseNotificationRemoveDevicesNotificationMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationRemoveDevicesNotification\",value:c.value});var e=d(\"WASmaxInUsyncNotificationUpdateDevicesNotificationMixin\").parseNotificationUpdateDevicesNotificationMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"NotificationUpdateDevicesNotification\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"AddDevicesNotification\",\"RemoveDevicesNotification\",\"UpdateDevicesNotification\"],[b,c,e])}g.parseDevicesNotification=a}),98);\n__d(\"WASmaxInUsyncServerNotificationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"offline\",0,1024);return!a.success?a:d(\"WAResultOrError\").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);\n__d(\"WASmaxInUsyncNotificationRequest\",[\"WAResultOrError\",\"WASmaxInUsyncDevicesNotification\",\"WASmaxInUsyncServerNotificationMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"from\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"lid\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"devices\");if(!e.success)return e;var f=d(\"WASmaxInUsyncServerNotificationMixin\").parseServerNotificationMixin(a);if(!f.success)return f;a=d(\"WASmaxInUsyncDevicesNotification\").parseDevicesNotification(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:b.value,lid:c.value,type:e.value},f.value,{devicesNotification:a.value}))}g.parseNotificationRequest=a}),98);\n__d(\"WASmaxOutUsyncNotificationClientAckMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrUserJid,a,[\"from\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").USER_JID(c.value),\"class\":\"notification\",type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);\n__d(\"WASmaxOutUsyncNotificationResponseAck\",[\"WASmaxJsx\",\"WASmaxOutUsyncNotificationClientAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutUsyncNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a);return a}g.makeNotificationResponseAck=a}),98);\n__d(\"WASmaxUsyncNotificationRPC\",[\"WASmaxInUsyncNotificationRequest\",\"WASmaxOutUsyncNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInUsyncNotificationRequest\").parseNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Notification\",{Request:b}));return{parsedRequest:b.value,makeNotificationResponseAck:function(){return d(\"WASmaxOutUsyncNotificationResponseAck\").makeNotificationResponseAck(a)}}}g.receiveNotificationRPC=a}),98);\n__d(\"WACreateHandleDevicesNotificationBranch\",[\"Promise\",\"WAResultOrError\",\"WASmaxUsyncNotificationRPC\",\"WATimeUtils\",\"WAUnknownStanzaError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){a=(a=a.usync)!=null?a:{};var c=a.handleAddDeviceNotification,e=a.handleRemoveDeviceNotification,f=a.handleUpdateDeviceNotification;return function(a){a=d(\"WASmaxUsyncNotificationRPC\").receiveNotificationRPC(a);var g=a.parsedRequest,i=g.from,j=g.lid;g=g.devicesNotification;a=a.makeNotificationResponseAck;switch(g.name){case\"NotificationAddDevicesNotification\":var k=g.value,l=k.addDeviceHash,m=k.addDeviceLidHash,n=k.addDevice;k=k.addKeyIndexList;return(l=c==null?void 0:c({lid:j,from:i,makeAck:a,hash:l,lidHash:m,deviceList:n,keyIndexList:k==null?null:{ts:d(\"WATimeUtils\").castToUnixTime(k.ts),signedADVListBytes:k.elementValue}}).then(d(\"WAResultOrError\").makeResult))!=null?l:(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError);case\"NotificationRemoveDevicesNotification\":m=g.value;n=m.removeDevice;k=m.removeDeviceHash;l=m.removeDeviceLidHash;m=m.removeKeyIndexList;return(k=e==null?void 0:e({from:i,lid:j,makeAck:a,hash:k,lidHash:l,deviceList:n,keyIndexList:m==null?null:{ts:d(\"WATimeUtils\").castToUnixTime(m.ts),signedADVListBytes:m.elementValue}}).then(d(\"WAResultOrError\").makeResult))!=null?k:(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError);case\"NotificationUpdateDevicesNotification\":l=g.value.updateHash;return(n=f==null?void 0:f({from:i,lid:j,hash:l,makeAck:a}).then(d(\"WAResultOrError\").makeResult))!=null?n:(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}g.name}}g.createHandleDevicesNotification=a}),98);\n__d(\"WASmaxInPreKeysCloudAPIGroupListMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"group\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrGroupJid(a,\"jid\");return!b.success?b:d(\"WAResultOrError\").makeResult({jid:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"groups\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"group\",1,1e4,h);return!a.success?a:d(\"WAResultOrError\").makeResult({groupsGroup:a.value})}g.parseCloudAPIGroupListGroupsGroup=h;g.parseCloudAPIGroupListMixin=a}),98);\n__d(\"WASmaxInPreKeysDisplayNameMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrString(a,\"display_name\");return!a.success?a:d(\"WAResultOrError\").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);\n__d(\"WASmaxInPreKeysNotificationContactIDChangedLIDAttrMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrDeviceJid(a,\"lid\");return!b.success?b:d(\"WAResultOrError\").makeResult({lid:b.value})}g.parseNotificationContactIDChangedLIDAttrMixin=a}),98);\n__d(\"WASmaxInPreKeysNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup\",[\"WAResultOrError\",\"WASmaxInPreKeysDisplayNameMixin\",\"WASmaxInPreKeysNotificationContactIDChangedLIDAttrMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInPreKeysNotificationContactIDChangedLIDAttrMixin\").parseNotificationContactIDChangedLIDAttrMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NotificationContactIDChangedLIDAttr\",value:b.value});var c=d(\"WASmaxInPreKeysDisplayNameMixin\").parseDisplayNameMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"DisplayName\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"LIDAttr\",\"DisplayName\"],[b,c])}g.parseNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup=a}),98);\n__d(\"WASmaxInPreKeysServerNotificationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"offline\",0,1024);return!a.success?a:d(\"WAResultOrError\").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);\n__d(\"WASmaxInPreKeysNotificationContactIDChangedRequest\",[\"WAResultOrError\",\"WASmaxInPreKeysCloudAPIGroupListMixin\",\"WASmaxInPreKeysNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup\",\"WASmaxInPreKeysServerNotificationMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"identity\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrDeviceJid(a,\"from\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"encrypt\");if(!c.success)return c;var e=d(\"WASmaxInPreKeysServerNotificationMixin\").parseServerNotificationMixin(a);if(!e.success)return e;var f=d(\"WASmaxInPreKeysCloudAPIGroupListMixin\").parseCloudAPIGroupListMixin(a);a=d(\"WASmaxInPreKeysNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup\").parseNotificationContactIDChangedLIDAttrOrDisplayNameMixinGroup(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:b.value,type:c.value},e.value,{cloudAPIGroupListMixin:f.success?f.value:null,notificationContactIDChangedLIDAttrOrDisplayNameMixinGroup:a.success?a.value:null}))}g.parseNotificationContactIDChangedRequest=a}),98);\n__d(\"WASmaxOutPreKeysNotificationClientAckMixin\",[\"WASmaxInPreKeysEnums\",\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrJidEnum,a,[\"from\"],d(\"WASmaxInPreKeysEnums\").DEVICEJID_DOMAINJID);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").JID(c.value),\"class\":\"notification\",type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);\n__d(\"WASmaxOutPreKeysNotificationContactIDChangedResponseAck\",[\"WASmaxJsx\",\"WASmaxOutPreKeysNotificationClientAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutPreKeysNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a);return a}g.makeNotificationContactIDChangedResponseAck=a}),98);\n__d(\"WASmaxPreKeysNotificationContactIDChangedRPC\",[\"WASmaxInPreKeysNotificationContactIDChangedRequest\",\"WASmaxOutPreKeysNotificationContactIDChangedResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInPreKeysNotificationContactIDChangedRequest\").parseNotificationContactIDChangedRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"NotificationContactIDChanged\",{Request:b}));return{parsedRequest:b.value,makeNotificationContactIDChangedResponseAck:function(){return d(\"WASmaxOutPreKeysNotificationContactIDChangedResponseAck\").makeNotificationContactIDChangedResponseAck(a)}}}g.receiveNotificationContactIDChangedRPC=a}),98);\n__d(\"WASmaxInPreKeysNotificationDigestRequest\",[\"WAResultOrError\",\"WASmaxInPreKeysServerNotificationMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"digest\");if(!b.success)return b;b=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"encrypt\");if(!c.success)return c;a=d(\"WASmaxInPreKeysServerNotificationMixin\").parseServerNotificationMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:b.value,type:c.value},a.value))}g.parseNotificationDigestRequest=a}),98);\n__d(\"WASmaxOutPreKeysNotificationDigestResponseAck\",[\"WASmaxJsx\",\"WASmaxOutPreKeysNotificationClientAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutPreKeysNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a);return a}g.makeNotificationDigestResponseAck=a}),98);\n__d(\"WASmaxPreKeysNotificationDigestRPC\",[\"WASmaxInPreKeysNotificationDigestRequest\",\"WASmaxOutPreKeysNotificationDigestResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInPreKeysNotificationDigestRequest\").parseNotificationDigestRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"NotificationDigest\",{Request:b}));return{parsedRequest:b.value,makeNotificationDigestResponseAck:function(){return d(\"WASmaxOutPreKeysNotificationDigestResponseAck\").makeNotificationDigestResponseAck(a)}}}g.receiveNotificationDigestRPC=a}),98);\n__d(\"WASmaxInPreKeysNotificationLowCountRequest\",[\"WAResultOrError\",\"WASmaxInPreKeysServerNotificationMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"count\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"encrypt\");if(!e.success)return e;b=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"value\",0,100);if(!b.success)return b;a=d(\"WASmaxInPreKeysServerNotificationMixin\").parseServerNotificationMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:c.value,type:e.value,countValue:b.value},a.value))}g.parseNotificationLowCountRequest=a}),98);\n__d(\"WASmaxOutPreKeysNotificationLowCountResponseAck\",[\"WASmaxJsx\",\"WASmaxOutPreKeysNotificationClientAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutPreKeysNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a);return a}g.makeNotificationLowCountResponseAck=a}),98);\n__d(\"WASmaxPreKeysNotificationLowCountRPC\",[\"WASmaxInPreKeysNotificationLowCountRequest\",\"WASmaxOutPreKeysNotificationLowCountResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInPreKeysNotificationLowCountRequest\").parseNotificationLowCountRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"NotificationLowCount\",{Request:b}));return{parsedRequest:b.value,makeNotificationLowCountResponseAck:function(){return d(\"WASmaxOutPreKeysNotificationLowCountResponseAck\").makeNotificationLowCountResponseAck(a)}}}g.receiveNotificationLowCountRPC=a}),98);\n__d(\"WACreateHandleEncryptNotificationBranch\",[\"Promise\",\"WALogger\",\"WAResultOrError\",\"WASmaxDecisionTreeUtils\",\"WASmaxPreKeysNotificationContactIDChangedRPC\",\"WASmaxPreKeysNotificationDigestRPC\",\"WASmaxPreKeysNotificationLowCountRPC\",\"WATimeUtils\",\"WAUnknownStanzaError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"parseEncryptNotification notification without children\"]);i=function(){return a};return a}function a(a){a=(a=a.prekey)!=null?a:{};var c=a.handlePrekeyLowCountNotification,e=a.handlePrekeyDigestNotification,f=a.handlePrekeyContactIDChangedNotification;return function(a){var g=d(\"WASmaxDecisionTreeUtils\").firstChild(a);if(g.success===!1){d(\"WALogger\").ERROR(i());return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}g=g.value.tag;switch(g){case\"count\":if(c!=null){var j=d(\"WASmaxPreKeysNotificationLowCountRPC\").receiveNotificationLowCountRPC(a),k=j.makeNotificationLowCountResponseAck;j=j.parsedRequest;var l=j.t,m=j.offline;j=j.id;l=d(\"WATimeUtils\").castToUnixTime(l);return c({makeAck:k,id:j,offline:m,serverTs:l,encryptType:g}).then(d(\"WAResultOrError\").makeResult)}break;case\"digest\":if(e!=null){k=d(\"WASmaxPreKeysNotificationDigestRPC\").receiveNotificationDigestRPC(a);j=k.makeNotificationDigestResponseAck;m=k.parsedRequest;l=m.t;k=m.offline;m=m.id;l=d(\"WATimeUtils\").castToUnixTime(l);return e({makeAck:j,id:m,offline:k,serverTs:l,encryptType:g}).then(d(\"WAResultOrError\").makeResult)}break;case\"identity\":if(f!=null){j=d(\"WASmaxPreKeysNotificationContactIDChangedRPC\").receiveNotificationContactIDChangedRPC(a);m=j.makeNotificationContactIDChangedResponseAck;k=j.parsedRequest;l=k.t;a=k.offline;j=k.id;k=d(\"WATimeUtils\").castToUnixTime(l);return f({makeAck:m,id:j,offline:a,serverTs:k,encryptType:g}).then(d(\"WAResultOrError\").makeResult)}break}return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}}g.createHandleEncryptNotification=a}),98);\n__d(\"WAHandleFbDeviceChangeNotificationProtocol\",[\"WAICDCUtils\",\"WAResultOrError\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return a.dhash}function b(a){var b;b=((b=a.iCDCDirtyMixin)==null?void 0:b.dirty)===\"true\";var c=d(\"WATimeUtils\").castToUnixTime(a.ts),e=a.seq;a=d(\"WAICDCUtils\").decodeICDCInfo(a.elementValue);e=d(\"WAICDCUtils\").validateAndPrepareICDCFromNotification(e,b,c,a);return e==null?d(\"WAResultOrError\").makeError(\"icdc-validation-failure\"):d(\"WAResultOrError\").makeResult(e)}g.parseDhash=a;g.parseICDCFromServer=b}),98);\n__d(\"WASmaxInDevicesDeviceModelInfoMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"platform\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentString(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"model\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentString(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"platform\",h);if(!b.success)return b;a=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"model\",i);return!a.success?a:d(\"WAResultOrError\").makeResult({platform:b.value,model:a.value})}g.parseDeviceModelInfoPlatform=h;g.parseDeviceModelInfoModel=i;g.parseDeviceModelInfoMixin=a}),98);\n__d(\"WASmaxInDevicesDhashMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrString(a,\"dhash\");return!a.success?a:d(\"WAResultOrError\").makeResult({dhash:a.value})}g.parseDhashMixin=a}),98);\n__d(\"WASmaxInDevicesKeyDataMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").contentBytesRange(a,32,32);return!a.success?a:d(\"WAResultOrError\").makeResult({elementValue:a.value})}g.parseKeyDataMixin=a}),98);\n__d(\"WASmaxInDevicesIdentityKeyMixin\",[\"WASmaxInDevicesKeyDataMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"identity\");if(!a.success)return a;a=d(\"WASmaxInDevicesKeyDataMixin\").parseKeyDataMixin(a.value);return!a.success?a:a}g.parseIdentityKeyMixin=a}),98);\n__d(\"WASmaxInDevicesDeviceListMixin\",[\"WAResultOrError\",\"WASmaxInDevicesDeviceModelInfoMixin\",\"WASmaxInDevicesDhashMixin\",\"WASmaxInDevicesIdentityKeyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"device\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"id\",1,999);if(!b.success)return b;var c=d(\"WASmaxInDevicesIdentityKeyMixin\").parseIdentityKeyMixin(a);if(!c.success)return c;a=d(\"WASmaxInDevicesDeviceModelInfoMixin\").parseDeviceModelInfoMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({id:b.value},c.value,{deviceModelInfoMixin:a.success?a.value:null}))}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"devices\");if(!b.success)return b;b=d(\"WASmaxInDevicesDhashMixin\").parseDhashMixin(a);a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"device\",0,25,h);return!a.success?a:d(\"WAResultOrError\").makeResult({dhashMixin:b.success?b.value:null,device:a.value})}g.parseDeviceListDevice=h;g.parseDeviceListMixin=a}),98);\n__d(\"WASmaxInDevicesICDCDirtyMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"icdc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"dirty\",\"true\");return!b.success?b:d(\"WAResultOrError\").makeResult({dirty:b.value})}g.parseICDCDirtyMixin=a}),98);\n__d(\"WASmaxInDevicesICDCSeqMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrIntRange(a,\"seq\",0,2147483647);return!a.success?a:d(\"WAResultOrError\").makeResult({seq:a.value})}g.parseICDCSeqMixin=a}),98);\n__d(\"WASmaxInDevicesICDCSignedListMixin\",[\"WAResultOrError\",\"WASmaxInDevicesICDCSeqMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"icdc\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"ts\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").contentBytesRange(a,1,40072);if(!c.success)return c;a=d(\"WASmaxInDevicesICDCSeqMixin\").parseICDCSeqMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({ts:b.value,elementValue:c.value},a.value))}g.parseICDCSignedListMixin=a}),98);\n__d(\"WASmaxInDevicesICDCFromServerMixin\",[\"WAResultOrError\",\"WASmaxInDevicesICDCDirtyMixin\",\"WASmaxInDevicesICDCSignedListMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"icdc\");if(!b.success)return b;b=d(\"WASmaxInDevicesICDCSignedListMixin\").parseICDCSignedListMixin(a);if(!b.success)return b;a=d(\"WASmaxInDevicesICDCDirtyMixin\").parseICDCDirtyMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{iCDCDirtyMixin:a.success?a.value:null}))}g.parseICDCFromServerMixin=a}),98);\n__d(\"WASmaxInDevicesServerNotificationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"offline\",0,1024);return!a.success?a:d(\"WAResultOrError\").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);\n__d(\"WASmaxInDevicesChangeNotificationRequest\",[\"WAResultOrError\",\"WASmaxInDevicesDeviceListMixin\",\"WASmaxInDevicesICDCFromServerMixin\",\"WASmaxInDevicesServerNotificationMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"devices\");if(!b.success)return b;b=d(\"WASmaxInDevicesDeviceListMixin\").parseDeviceListMixin(a);return!b.success?b:b}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"icdc\");if(!b.success)return b;b=d(\"WASmaxInDevicesICDCFromServerMixin\").parseICDCFromServerMixin(a);return!b.success?b:b}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"devices\",h);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"icdc\",i);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"fbid:devices\");if(!e.success)return e;var f=d(\"WASmaxParseJid\").attrUserJid(a,\"from\");if(!f.success)return f;a=d(\"WASmaxInDevicesServerNotificationMixin\").parseServerNotificationMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({type:e.value,from:f.value},a.value,{devices:b.value,icdc:c.value}))}g.parseChangeNotificationRequestDevices=h;g.parseChangeNotificationRequestIcdc=i;g.parseChangeNotificationRequest=a}),98);\n__d(\"WASmaxOutDevicesNotificationClientAckMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrUserJid,a,[\"from\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").USER_JID(c.value),\"class\":\"notification\",type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);\n__d(\"WASmaxOutDevicesChangeNotificationResponseAck\",[\"WASmaxJsx\",\"WASmaxOutDevicesNotificationClientAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutDevicesNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a);return a}g.makeChangeNotificationResponseAck=a}),98);\n__d(\"WASmaxDevicesChangeNotificationRPC\",[\"WASmaxInDevicesChangeNotificationRequest\",\"WASmaxOutDevicesChangeNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInDevicesChangeNotificationRequest\").parseChangeNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"ChangeNotification\",{Request:b}));return{parsedRequest:b.value,makeChangeNotificationResponseAck:function(){return d(\"WASmaxOutDevicesChangeNotificationResponseAck\").makeChangeNotificationResponseAck(a)}}}g.receiveChangeNotificationRPC=a}),98);\n__d(\"WACreateHandleFbDeviceChangeNotificationBranch\",[\"WAHandleFbDeviceChangeNotificationProtocol\",\"WAJids\",\"WAResultOrError\",\"WASignalKeys\",\"WASmaxDevicesChangeNotificationRPC\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return function(b,c){var e;b=d(\"WASmaxDevicesChangeNotificationRPC\").receiveChangeNotificationRPC(b);var f=b.makeChangeNotificationResponseAck;b=b.parsedRequest;var g=b.from,h=b.devices,i=b.t,j=b.id,k=b.icdc;b=b.offline;e=((e=h==null?void 0:h.device)!=null?e:[]).map(function(a){var b;return{device:d(\"WAJids\").toDeviceJid(g,d(\"WAJids\").interpretAsDeviceId(a.id)),identity:d(\"WASignalKeys\").serializeIdentity(a.elementValue),platform:(b=a.deviceModelInfoMixin)==null?void 0:(b=b.platform)==null?void 0:b.elementValue,model:(b=a.deviceModelInfoMixin)==null?void 0:(a=b.model)==null?void 0:a.elementValue}});h=h==null?void 0:h.dhashMixin;k=k==null?null:d(\"WAHandleFbDeviceChangeNotificationProtocol\").parseICDCFromServer(k);return a({devices:e,userJid:g,offline:b,serverTs:d(\"WATimeUtils\").castToUnixTime(i),id:j,dhash:h==null?null:d(\"WAHandleFbDeviceChangeNotificationProtocol\").parseDhash(h),icdcInfo:(k==null?void 0:k.success)?k.value:null,makeAck:f,ctx:{cryptoManager:c}}).then(d(\"WAResultOrError\").makeResult)}}g.createHandleFbDeviceChangeNotification=a}),98);\n__d(\"WACreateHandleFbMultiwayNotificationBranch\",[\"WAResultOrError\",\"WASmaxMultiwaydMultiwayNotificationRPC\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return function(b){b=d(\"WASmaxMultiwaydMultiwayNotificationRPC\").receiveMultiwayNotificationRPC(b);var c=b.makeMultiwayNotificationResponseAck;b=b.parsedRequest;var e=b.from,f=b.multiwayTransactionId,g=b.multiwayBinaryVersion,h=b.multiwayElementValue,i=b.t,j=b.id;b=b.offline;return a({domainJid:e,multiwayTransactionId:f,multiwayBinaryVersion:g,multiwayElementValue:h,offline:b,serverTs:d(\"WATimeUtils\").castToUnixTime(i),id:j,makeAck:c}).then(d(\"WAResultOrError\").makeResult)}}g.createHandleFbMultiwayNotification=a}),98);\n__d(\"WASmaxInMessageRequestConnectedMixin\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"thread_actions\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"connected\");return!b.success?b:d(\"WASmaxParseUtils\").voidSuccess}g.parseConnectedMixin=a}),98);\n__d(\"WASmaxInMessageRequestFolderIDMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrInt(a,\"folder_id\");return!a.success?a:d(\"WAResultOrError\").makeResult({folderId:a.value})}g.parseFolderIDMixin=a}),98);\n__d(\"WASmaxInMessageRequestFolderMixin\",[\"WASmaxInMessageRequestFolderIDMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"thread_actions\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"folder\");if(!b.success)return b;a=d(\"WASmaxInMessageRequestFolderIDMixin\").parseFolderIDMixin(b.value);return!a.success?a:a}g.parseFolderMixin=a}),98);\n__d(\"WASmaxInMessageRequestServerNotificationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"offline\",0,1024);return!a.success?a:d(\"WAResultOrError\").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);\n__d(\"WASmaxInMessageRequestThreadNotificationRequest\",[\"WAResultOrError\",\"WASmaxInMessageRequestConnectedMixin\",\"WASmaxInMessageRequestFolderMixin\",\"WASmaxInMessageRequestServerNotificationMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"thread_actions\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"fbid:thread\");if(!c.success)return c;var e=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"to\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").attrString(b.value,\"thread_id\");if(!g.success)return g;var h=d(\"WASmaxInMessageRequestFolderMixin\").parseFolderMixin(b.value);b=d(\"WASmaxInMessageRequestConnectedMixin\").parseConnectedMixin(b.value);a=d(\"WASmaxInMessageRequestServerNotificationMixin\").parseServerNotificationMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({type:c.value,from:e.value,to:f.value,threadActionsThreadId:g.value,threadActionsFolderMixin:h.success?h.value:null,hasThreadActionsConnectedMixin:b.success},a.value))}g.parseThreadNotificationRequest=a}),98);\n__d(\"WASmaxOutMessageRequestNotificationClientAckMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrDomainJid,a,[\"from\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").DOMAIN_JID(c.value),\"class\":\"notification\",type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);\n__d(\"WASmaxOutMessageRequestThreadNotificationResponseAck\",[\"WASmaxJsx\",\"WASmaxOutMessageRequestNotificationClientAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutMessageRequestNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a);return a}g.makeThreadNotificationResponseAck=a}),98);\n__d(\"WASmaxMessageRequestThreadNotificationRPC\",[\"WASmaxInMessageRequestThreadNotificationRequest\",\"WASmaxOutMessageRequestThreadNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInMessageRequestThreadNotificationRequest\").parseThreadNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"ThreadNotification\",{Request:b}));return{parsedRequest:b.value,makeThreadNotificationResponseAck:function(){return d(\"WASmaxOutMessageRequestThreadNotificationResponseAck\").makeThreadNotificationResponseAck(a)}}}g.receiveThreadNotificationRPC=a}),98);\n__d(\"WACreateHandleFbThreadNotificationBranch\",[\"WAGlobals\",\"WAJids\",\"WAResultOrError\",\"WASmaxMessageRequestThreadNotificationRPC\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return function(b){b=d(\"WASmaxMessageRequestThreadNotificationRPC\").receiveThreadNotificationRPC(b);var c=b.makeThreadNotificationResponseAck;b=b.parsedRequest;var e=b.id,f=b.threadActionsThreadId,g=b.t,h=b.threadActionsFolderMixin,i=b.offline;b=b.hasThreadActionsConnectedMixin;var j;f.endsWith(\"@g.us\")?j=d(\"WAJids\").toGroupJid(f):j=d(\"WAGlobals\").getJidUtilsApi().toUserJid(f);return a({id:e,serverTs:d(\"WATimeUtils\").castToUnixTime(g),chatJid:j,offline:i,folderId:h==null?void 0:h.folderId,hasConnected:b,makeAck:c}).then(d(\"WAResultOrError\").makeResult)}}g.createHandleFbThreadNotification=a}),98);\n__d(\"WASmaxInGroupsServerNotificationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"offline\",0,1024);return!a.success?a:d(\"WAResultOrError\").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);\n__d(\"WASmaxInGroupsCommonNotificationMixin\",[\"WAResultOrError\",\"WASmaxInGroupsServerNotificationMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrGroupJid(a,\"from\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"w:gp2\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"notify\");if(!e.success)return e;a=d(\"WASmaxInGroupsServerNotificationMixin\").parseServerNotificationMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:b.value,type:c.value,notify:e.value},a.value))}g.parseCommonNotificationMixin=a}),98);\n__d(\"WASmaxInGroupsEnums\",[\"WAJids\"],(function(a,b,c,d,e,f,g){a={304:\"304\",419:\"419\"};b={403:\"403\",404:\"404\",406:\"406\",419:\"419\"};c={404:\"404\",406:\"406\"};e={404:\"404\",419:\"419\"};f={406:\"406\",500:\"500\"};var h={accept:\"accept\",auto_add:\"auto_add\",default_sub_group_admin_add:\"default_sub_group_admin_add\",general_chat_auto_add:\"general_chat_auto_add\",invite:\"invite\",invite_auto_add:\"invite_auto_add\",linked_group_join:\"linked_group_join\",sub_group_suggestion_approved:\"sub_group_suggestion_approved\"},i={accept:\"accept\",default_sub_group_promote:\"default_sub_group_promote\",invite:\"invite\",invite_auto_add:\"invite_auto_add\",linked_group_join:\"linked_group_join\"},j={account_setting:\"account_setting\",bulk_change:\"bulk_change\",chat_setting:\"chat_setting\"},k={admin:\"admin\",creator:\"creator\"},l={admin:\"admin\",superadmin:\"superadmin\"},m={approved:\"approved\",cancelled:\"cancelled\",rejected:\"rejected\"},n={delete_parent:\"delete_parent\",integrity_delete_parent:\"integrity_delete_parent\"},o={delete_parent:\"delete_parent\",integrity_delete_parent:\"integrity_delete_parent\",unlink_group:\"unlink_group\"},p={e2ee_migration:\"e2ee_migration\",regular:\"regular\",rtc:\"rtc\"},q={\"false\":\"false\",\"true\":\"true\"},r={image:\"image\",preview:\"preview\"},s={invite_link:\"invite_link\",linked_group_join:\"linked_group_join\",non_admin_add:\"non_admin_add\"},t={lid:\"lid\",pn:\"pn\"},u={parent_group:\"parent_group\",sibling_group:\"sibling_group\",sub_group:\"sub_group\"};d={validators:[d(\"WAJids\").validateDomainJid,d(\"WAJids\").validateGroupJid],typeName:\"DomainJid|GroupJid\"};g.ENUM_304_419=a;g.ENUM_403_404_406_419=b;g.ENUM_404_406=c;g.ENUM_404_419=e;g.ENUM_406_500=f;g.ENUM_ACCEPT_AUTOADD_DEFAULTSUBGROUPADMINADD_GENERALCHATAUTOADD_INVITE_INVITEAUTOADD_LINKEDGROUPJOIN_SUBGROUPSUGGESTIONAPPROVED=h;g.ENUM_ACCEPT_DEFAULTSUBGROUPPROMOTE_INVITE_INVITEAUTOADD_LINKEDGROUPJOIN=i;g.ENUM_ACCOUNTSETTING_BULKCHANGE_CHATSETTING=j;g.ENUM_ADMIN_CREATOR=k;g.ENUM_ADMIN_SUPERADMIN=l;g.ENUM_APPROVED_CANCELLED_REJECTED=m;g.ENUM_DELETEPARENT_INTEGRITYDELETEPARENT=n;g.ENUM_DELETEPARENT_INTEGRITYDELETEPARENT_UNLINKGROUP=o;g.ENUM_E2EEMIGRATION_REGULAR_RTC=p;g.ENUM_FALSE_TRUE=q;g.ENUM_IMAGE_PREVIEW=r;g.ENUM_INVITELINK_LINKEDGROUPJOIN_NONADMINADD=s;g.ENUM_LID_PN=t;g.ENUM_PARENTGROUP_SIBLINGGROUP_SUBGROUP=u;g.DOMAINJID_GROUPJID=d}),98);\n__d(\"WASmaxInGroupsGroupAddressingModeMixin\",[\"WAResultOrError\",\"WASmaxInGroupsEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrStringEnum(a,\"addressing_mode\",d(\"WASmaxInGroupsEnums\").ENUM_LID_PN);return!a.success?a:d(\"WAResultOrError\").makeResult({addressingMode:a.value})}g.parseGroupAddressingModeMixin=a}),98);\n__d(\"WASmaxInGroupsParticipantWithJidMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"jid\");return!b.success?b:d(\"WAResultOrError\").makeResult({jid:b.value})}g.parseParticipantWithJidMixin=a}),98);\n__d(\"WASmaxInGroupsParticipantWithLidMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"lid\");return!b.success?b:d(\"WAResultOrError\").makeResult({lid:b.value})}g.parseParticipantWithLidMixin=a}),98);\n__d(\"WASmaxInGroupsParticipantWithJidAndLidMixin\",[\"WAResultOrError\",\"WASmaxInGroupsParticipantWithJidMixin\",\"WASmaxInGroupsParticipantWithLidMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxInGroupsParticipantWithJidMixin\").parseParticipantWithJidMixin(a);if(!b.success)return b;a=d(\"WASmaxInGroupsParticipantWithLidMixin\").parseParticipantWithLidMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,a.value))}g.parseParticipantWithJidAndLidMixin=a}),98);\n__d(\"WASmaxInGroupsPhoneNumberMixin\",[\"WAResultOrError\",\"WASmaxParseJid\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseJid\").attrUserJid(a,\"phone_number\");return!a.success?a:d(\"WAResultOrError\").makeResult({phoneNumber:a.value})}g.parsePhoneNumberMixin=a}),98);\n__d(\"WASmaxInGroupsParticipantWithJidAndPnMixin\",[\"WAResultOrError\",\"WASmaxInGroupsParticipantWithJidMixin\",\"WASmaxInGroupsPhoneNumberMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxInGroupsParticipantWithJidMixin\").parseParticipantWithJidMixin(a);if(!b.success)return b;a=d(\"WASmaxInGroupsPhoneNumberMixin\").parsePhoneNumberMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,a.value))}g.parseParticipantWithJidAndPnMixin=a}),98);\n__d(\"WASmaxInGroupsDisplayNameMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrString(a,\"display_name\");return!a.success?a:d(\"WAResultOrError\").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);\n__d(\"WASmaxInGroupsParticipantWithJidContainingLidAndDisplayNameMixin\",[\"WAResultOrError\",\"WASmaxInGroupsDisplayNameMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"jid\");if(!b.success)return b;a=d(\"WASmaxInGroupsDisplayNameMixin\").parseDisplayNameMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({jid:b.value},a.value))}g.parseParticipantWithJidContainingLidAndDisplayNameMixin=a}),98);\n__d(\"WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin\",[\"WAResultOrError\",\"WASmaxInGroupsDisplayNameMixin\",\"WASmaxInGroupsParticipantWithJidAndLidMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxInGroupsParticipantWithJidAndLidMixin\").parseParticipantWithJidAndLidMixin(a);if(!b.success)return b;a=d(\"WASmaxInGroupsDisplayNameMixin\").parseDisplayNameMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,a.value))}g.parseParticipantWithJidLidAndDisplayNameMixin=a}),98);\n__d(\"WASmaxInGroupsParticipantMixins\",[\"WAResultOrError\",\"WASmaxInGroupsParticipantWithJidAndLidMixin\",\"WASmaxInGroupsParticipantWithJidAndPnMixin\",\"WASmaxInGroupsParticipantWithJidContainingLidAndDisplayNameMixin\",\"WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin\",\"WASmaxInGroupsParticipantWithJidMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin\").parseParticipantWithJidLidAndDisplayNameMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"ParticipantWithJidLidAndDisplayName\",value:b.value});var c=d(\"WASmaxInGroupsParticipantWithJidContainingLidAndDisplayNameMixin\").parseParticipantWithJidContainingLidAndDisplayNameMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"ParticipantWithJidContainingLidAndDisplayName\",value:c.value});var e=d(\"WASmaxInGroupsParticipantWithJidAndLidMixin\").parseParticipantWithJidAndLidMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"ParticipantWithJidAndLid\",value:e.value});var f=d(\"WASmaxInGroupsParticipantWithJidAndPnMixin\").parseParticipantWithJidAndPnMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"ParticipantWithJidAndPn\",value:f.value});var g=d(\"WASmaxInGroupsParticipantWithJidMixin\").parseParticipantWithJidMixin(a);return g.success?d(\"WAResultOrError\").makeResult({name:\"ParticipantWithJid\",value:g.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ParticipantWithJidLidAndDisplayName\",\"ParticipantWithJidContainingLidAndDisplayName\",\"ParticipantWithJidAndLid\",\"ParticipantWithJidAndPn\",\"ParticipantWithJid\"],[b,c,e,f,g])}g.parseParticipantMixins=a}),98);\n__d(\"WASmaxInGroupsParticipantMixin\",[\"WAResultOrError\",\"WASmaxInGroupsParticipantMixins\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxInGroupsParticipantMixins\").parseParticipantMixins(a);return!b.success?b:d(\"WAResultOrError\").makeResult({participantMixins:b.value})}g.parseParticipantMixin=a}),98);\n__d(\"WASmaxInGroupsParticipantNotAddressableMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"addressable\",\"false\");return!b.success?b:d(\"WAResultOrError\").makeResult({addressable:b.value})}g.parseParticipantNotAddressableMixin=a}),98);\n__d(\"WASmaxInGroupsParticipantPhoneNumberMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"participant\");if(!b.success)return b;a=d(\"WASmaxParseJid\").attrUserJid(a,\"participant_pn\");return!a.success?a:d(\"WAResultOrError\").makeResult({participant:b.value,participantPn:a.value})}g.parseParticipantPhoneNumberMixin=a}),98);\n__d(\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"meta\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,b.value,\"shadow\",\"true\");return!a.success?a:d(\"WAResultOrError\").makeResult({metaShadow:a.value})}g.parseShadowGroupNotificationIndicatorMixin=a}),98);\n__d(\"WASmaxInGroupsAddNotificationRequest\",[\"WAResultOrError\",\"WASmaxInGroupsCommonNotificationMixin\",\"WASmaxInGroupsEnums\",\"WASmaxInGroupsGroupAddressingModeMixin\",\"WASmaxInGroupsParticipantMixin\",\"WASmaxInGroupsParticipantNotAddressableMixin\",\"WASmaxInGroupsParticipantPhoneNumberMixin\",\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxInGroupsParticipantMixin\").parseParticipantMixin(a);if(!b.success)return b;a=d(\"WASmaxInGroupsParticipantNotAddressableMixin\").parseParticipantNotAddressableMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{participantNotAddressableMixin:a.success?a.value:null}))}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"add\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"participant\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrString(b.value,\"v_id\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,b.value,\"prev_v_id\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,b.value,\"reason\",d(\"WASmaxInGroupsEnums\").ENUM_ACCEPT_DEFAULTSUBGROUPPROMOTE_INVITE_INVITEAUTOADD_LINKEDGROUPJOIN);if(!g.success)return g;var i=d(\"WASmaxInGroupsCommonNotificationMixin\").parseCommonNotificationMixin(a);if(!i.success)return i;var j=d(\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\").parseShadowGroupNotificationIndicatorMixin(a),k=d(\"WASmaxInGroupsGroupAddressingModeMixin\").parseGroupAddressingModeMixin(a);a=d(\"WASmaxInGroupsParticipantPhoneNumberMixin\").parseParticipantPhoneNumberMixin(a);b=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"participant\",1,1024,h);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({participant:c.value,addVId:e.value,addPrevVId:f.value,addReason:g.value},i.value,{shadowGroupNotificationIndicatorMixin:j.success?j.value:null,groupAddressingModeMixin:k.success?k.value:null,participantPhoneNumberMixin:a.success?a.value:null,addParticipant:b.value}))}g.parseAddNotificationRequestAddParticipant=h;g.parseAddNotificationRequest=a}),98);\n__d(\"WASmaxOutGroupsNotificationClientAckMixin\",[\"WASmaxInGroupsEnums\",\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrJidEnum,a,[\"from\"],d(\"WASmaxInGroupsEnums\").DOMAINJID_GROUPJID);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").JID(c.value),\"class\":\"notification\",type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);\n__d(\"WASmaxOutGroupsAddNotificationResponseAck\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WASmaxOutGroupsNotificationClientAckMixin\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrUserJid,a,[\"participant\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);b=d(\"WASmaxOutGroupsNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",{participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").USER_JID,b.value)}),a);return b}g.makeAddNotificationResponseAck=a}),98);\n__d(\"WASmaxGroupsAddNotificationRPC\",[\"WASmaxInGroupsAddNotificationRequest\",\"WASmaxOutGroupsAddNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsAddNotificationRequest\").parseAddNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"AddNotification\",{Request:b}));return{parsedRequest:b.value,makeAddNotificationResponseAck:function(){return d(\"WASmaxOutGroupsAddNotificationResponseAck\").makeAddNotificationResponseAck(a)}}}g.receiveAddNotificationRPC=a}),98);\n__d(\"WASmaxInGroupsDeleteNotificationRequest\",[\"WAResultOrError\",\"WASmaxInGroupsCommonNotificationMixin\",\"WASmaxInGroupsEnums\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"delete\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"participant\");if(!c.success)return c;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,b.value,\"reason\",d(\"WASmaxInGroupsEnums\").ENUM_DELETEPARENT_INTEGRITYDELETEPARENT);if(!b.success)return b;a=d(\"WASmaxInGroupsCommonNotificationMixin\").parseCommonNotificationMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({participant:c.value,deleteReason:b.value},a.value))}g.parseDeleteNotificationRequest=a}),98);\n__d(\"WASmaxOutGroupsDeleteNotificationResponseAck\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WASmaxOutGroupsNotificationClientAckMixin\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrUserJid,a,[\"participant\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);b=d(\"WASmaxOutGroupsNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",{participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").USER_JID,b.value)}),a);return b}g.makeDeleteNotificationResponseAck=a}),98);\n__d(\"WASmaxGroupsDeleteNotificationRPC\",[\"WASmaxInGroupsDeleteNotificationRequest\",\"WASmaxOutGroupsDeleteNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsDeleteNotificationRequest\").parseDeleteNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"DeleteNotification\",{Request:b}));return{parsedRequest:b.value,makeDeleteNotificationResponseAck:function(){return d(\"WASmaxOutGroupsDeleteNotificationResponseAck\").makeDeleteNotificationResponseAck(a)}}}g.receiveDeleteNotificationRPC=a}),98);\n__d(\"WASmaxInGroupsDemoteNotificationRequest\",[\"WAResultOrError\",\"WASmaxInGroupsCommonNotificationMixin\",\"WASmaxInGroupsGroupAddressingModeMixin\",\"WASmaxInGroupsParticipantMixins\",\"WASmaxInGroupsParticipantPhoneNumberMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxInGroupsParticipantMixins\").parseParticipantMixins(a);return!b.success?b:d(\"WAResultOrError\").makeResult({participantMixins:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"demote\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").attrUserJid(a,\"participant\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrString(b.value,\"v_id\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,b.value,\"prev_v_id\");if(!f.success)return f;var g=d(\"WASmaxInGroupsCommonNotificationMixin\").parseCommonNotificationMixin(a);if(!g.success)return g;var i=d(\"WASmaxInGroupsGroupAddressingModeMixin\").parseGroupAddressingModeMixin(a);a=d(\"WASmaxInGroupsParticipantPhoneNumberMixin\").parseParticipantPhoneNumberMixin(a);b=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"participant\",1,19999,h);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({participant:c.value,demoteVId:e.value,demotePrevVId:f.value},g.value,{groupAddressingModeMixin:i.success?i.value:null,participantPhoneNumberMixin:a.success?a.value:null,demoteParticipant:b.value}))}g.parseDemoteNotificationRequestDemoteParticipant=h;g.parseDemoteNotificationRequest=a}),98);\n__d(\"WASmaxOutGroupsDemoteNotificationResponseAck\",[\"WASmaxJsx\",\"WASmaxOutGroupsNotificationClientAckMixin\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrUserJid,a,[\"participant\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);b=d(\"WASmaxOutGroupsNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",{participant:d(\"WAWap\").USER_JID(b.value)}),a);return b}g.makeDemoteNotificationResponseAck=a}),98);\n__d(\"WASmaxGroupsDemoteNotificationRPC\",[\"WASmaxInGroupsDemoteNotificationRequest\",\"WASmaxOutGroupsDemoteNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsDemoteNotificationRequest\").parseDemoteNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"DemoteNotification\",{Request:b}));return{parsedRequest:b.value,makeDemoteNotificationResponseAck:function(){return d(\"WASmaxOutGroupsDemoteNotificationResponseAck\").makeDemoteNotificationResponseAck(a)}}}g.receiveDemoteNotificationRPC=a}),98);\n__d(\"WASmaxInGroupsDedupAttrsMixin\",[\"WAResultOrError\",\"WASmaxInGroupsEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").attrString(a,\"key\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"create_ctx\",d(\"WASmaxInGroupsEnums\").ENUM_E2EEMIGRATION_REGULAR_RTC);return!a.success?a:d(\"WAResultOrError\").makeResult({key:b.value,createCtx:a.value})}g.parseDedupAttrsMixin=a}),98);\n__d(\"WASmaxInGroupsNamedSubjectMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrString(a,\"subject\");return!a.success?a:d(\"WAResultOrError\").makeResult({subject:a.value})}g.parseNamedSubjectMixin=a}),98);\n__d(\"WASmaxInGroupsUnnamedSubjectFallbackMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"subject\");return!a.success?a:d(\"WAResultOrError\").makeResult({subject:a.value})}g.parseUnnamedSubjectFallbackMixin=a}),98);\n__d(\"WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup\",[\"WAResultOrError\",\"WASmaxInGroupsNamedSubjectMixin\",\"WASmaxInGroupsUnnamedSubjectFallbackMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsNamedSubjectMixin\").parseNamedSubjectMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"NamedSubject\",value:b.value});var c=d(\"WASmaxInGroupsUnnamedSubjectFallbackMixin\").parseUnnamedSubjectFallbackMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"UnnamedSubjectFallback\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"NamedSubject\",\"UnnamedSubjectFallback\"],[b,c])}g.parseNamedSubjectOrUnnamedSubjectFallbackMixinGroup=a}),98);\n__d(\"WASmaxInGroupsGroupInfoAttributesMixin\",[\"WAResultOrError\",\"WASmaxInGroupsGroupAddressingModeMixin\",\"WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"group\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"id\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"creator\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"creator_pn\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").attrIntRange(a,\"creation\",0,void 0);if(!f.success)return f;var g=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"p_v_id\");if(!g.success)return g;var h=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"a_v_id\");if(!h.success)return h;var i=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"s_t\",0,void 0);if(!i.success)return i;var j=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"s_o\");if(!j.success)return j;var k=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"s_o_pn\");if(!k.success)return k;var l=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"open_thread_id\");if(!l.success)return l;var m=d(\"WASmaxInGroupsGroupAddressingModeMixin\").parseGroupAddressingModeMixin(a);a=d(\"WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup\").parseNamedSubjectOrUnnamedSubjectFallbackMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({id:b.value,creator:c.value,creatorPn:e.value,creation:f.value,pVId:g.value,aVId:h.value,sT:i.value,sO:j.value,sOPn:k.value,openThreadId:l.value,groupAddressingModeMixin:m.success?m.value:null,namedSubjectOrUnnamedSubjectFallbackMixinGroup:a.value})}g.parseGroupInfoAttributesMixin=a}),98);\n__d(\"WASmaxInGroupsGroupInfoDescriptionMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"description\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"body\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"id\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"participant\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"participant_pn\");if(!f.success)return f;a=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!a.success)return a;b=d(\"WASmaxParseUtils\").contentString(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult({id:c.value,participant:e.value,participantPn:f.value,t:a.value,bodyElementValue:b.value})}g.parseGroupInfoDescriptionMixin=a}),98);\n__d(\"WASmaxInGroupsGroupInfoParticipantAdminMixins\",[\"WAResultOrError\",\"WASmaxInGroupsParticipantWithJidAndLidMixin\",\"WASmaxInGroupsParticipantWithJidAndPnMixin\",\"WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin\",\"WASmaxInGroupsParticipantWithJidMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsParticipantWithJidLidAndDisplayNameMixin\").parseParticipantWithJidLidAndDisplayNameMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"ParticipantWithJidLidAndDisplayName\",value:b.value});var c=d(\"WASmaxInGroupsParticipantWithJidAndLidMixin\").parseParticipantWithJidAndLidMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"ParticipantWithJidAndLid\",value:c.value});var e=d(\"WASmaxInGroupsParticipantWithJidAndPnMixin\").parseParticipantWithJidAndPnMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"ParticipantWithJidAndPn\",value:e.value});var f=d(\"WASmaxInGroupsParticipantWithJidMixin\").parseParticipantWithJidMixin(a);return f.success?d(\"WAResultOrError\").makeResult({name:\"ParticipantWithJid\",value:f.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ParticipantWithJidLidAndDisplayName\",\"ParticipantWithJidAndLid\",\"ParticipantWithJidAndPn\",\"ParticipantWithJid\"],[b,c,e,f])}g.parseGroupInfoParticipantAdminMixins=a}),98);\n__d(\"WASmaxInGroupsGroupInfoParticipantAdminMixin\",[\"WAResultOrError\",\"WASmaxInGroupsEnums\",\"WASmaxInGroupsGroupInfoParticipantAdminMixins\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"type\",d(\"WASmaxInGroupsEnums\").ENUM_ADMIN_SUPERADMIN);if(!b.success)return b;a=d(\"WASmaxInGroupsGroupInfoParticipantAdminMixins\").parseGroupInfoParticipantAdminMixins(a);return!a.success?a:d(\"WAResultOrError\").makeResult({type:b.value,groupInfoParticipantAdminMixins:a.value})}g.parseGroupInfoParticipantAdminMixin=a}),98);\n__d(\"WASmaxInGroupsGroupInfoParticipantNonAdminMixin\",[\"WASmaxInGroupsParticipantMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxInGroupsParticipantMixin\").parseParticipantMixin(a);return!b.success?b:b}g.parseGroupInfoParticipantNonAdminMixin=a}),98);\n__d(\"WASmaxInGroupsGroupInfoParticipantMixins\",[\"WAResultOrError\",\"WASmaxInGroupsGroupInfoParticipantAdminMixin\",\"WASmaxInGroupsGroupInfoParticipantNonAdminMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsGroupInfoParticipantAdminMixin\").parseGroupInfoParticipantAdminMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"GroupInfoParticipantAdmin\",value:b.value});var c=d(\"WASmaxInGroupsGroupInfoParticipantNonAdminMixin\").parseGroupInfoParticipantNonAdminMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"GroupInfoParticipantNonAdmin\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"GroupInfoParticipantAdmin\",\"GroupInfoParticipantNonAdmin\"],[b,c])}g.parseGroupInfoParticipantMixins=a}),98);\n__d(\"WASmaxInGroupsGroupInfoParticipantMixin\",[\"WAResultOrError\",\"WASmaxInGroupsGroupInfoParticipantMixins\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxInGroupsGroupInfoParticipantMixins\").parseGroupInfoParticipantMixins(a);return!b.success?b:d(\"WAResultOrError\").makeResult({groupInfoParticipantMixins:b.value})}g.parseGroupInfoParticipantMixin=a}),98);\n__d(\"WASmaxInGroupsAdminAddModeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"member_add_mode\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literalContent(d(\"WASmaxParseUtils\").contentString,a,\"admin_add\");return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}g.parseAdminAddModeMixin=a}),98);\n__d(\"WASmaxInGroupsAllMembersAddModeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"member_add_mode\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literalContent(d(\"WASmaxParseUtils\").contentString,a,\"all_member_add\");return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}g.parseAllMembersAddModeMixin=a}),98);\n__d(\"WASmaxInGroupsUnknownAddModeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"member_add_mode\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentString(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}g.parseUnknownAddModeMixin=a}),98);\n__d(\"WASmaxInGroupsAdminOrAllMembersOrUnknownAddModeMixinGroup\",[\"WAResultOrError\",\"WASmaxInGroupsAdminAddModeMixin\",\"WASmaxInGroupsAllMembersAddModeMixin\",\"WASmaxInGroupsUnknownAddModeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsAdminAddModeMixin\").parseAdminAddModeMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"AdminAddMode\",value:b.value});var c=d(\"WASmaxInGroupsAllMembersAddModeMixin\").parseAllMembersAddModeMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"AllMembersAddMode\",value:c.value});var e=d(\"WASmaxInGroupsUnknownAddModeMixin\").parseUnknownAddModeMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"UnknownAddMode\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"AdminAddMode\",\"AllMembersAddMode\",\"UnknownAddMode\"],[b,c,e])}g.parseAdminOrAllMembersOrUnknownAddModeMixinGroup=a}),98);\n__d(\"WASmaxInGroupsGroupMemberAddModeMixin\",[\"WAResultOrError\",\"WASmaxInGroupsAdminOrAllMembersOrUnknownAddModeMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"member_add_mode\");if(!a.success)return a;a=d(\"WASmaxInGroupsAdminOrAllMembersOrUnknownAddModeMixinGroup\").parseAdminOrAllMembersOrUnknownAddModeMixinGroup(a.value);return!a.success?a:d(\"WAResultOrError\").makeResult({memberAddModeAdminOrAllMembersOrUnknownAddModeMixinGroup:a.value})}g.parseGroupMemberAddModeMixin=a}),98);\n__d(\"WASmaxInGroupsGroupJoinMembershipApprovalModeEnabledMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"group_join\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"state\",\"on\");return!b.success?b:d(\"WAResultOrError\").makeResult({state:b.value})}g.parseGroupJoinMembershipApprovalModeEnabledMixin=a}),98);\n__d(\"WASmaxInGroupsMembershipApprovalGroupJoinModeEnabledMixin\",[\"WASmaxInGroupsGroupJoinMembershipApprovalModeEnabledMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"membership_approval_mode\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"group_join\");if(!b.success)return b;a=d(\"WASmaxInGroupsGroupJoinMembershipApprovalModeEnabledMixin\").parseGroupJoinMembershipApprovalModeEnabledMixin(b.value);return!a.success?a:a}g.parseMembershipApprovalGroupJoinModeEnabledMixin=a}),98);\n__d(\"WASmaxInGroupsParentGroupDefaultMembershipApprovalModeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"parent\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"default_membership_approval_mode\",\"request_required\");return!b.success?b:d(\"WAResultOrError\").makeResult({defaultMembershipApprovalMode:b.value})}g.parseParentGroupDefaultMembershipApprovalModeMixin=a}),98);\n__d(\"WASmaxInGroupsGroupInfoMixin\",[\"WAResultOrError\",\"WASmaxInGroupsEnums\",\"WASmaxInGroupsGroupInfoAttributesMixin\",\"WASmaxInGroupsGroupInfoDescriptionMixin\",\"WASmaxInGroupsGroupInfoParticipantMixin\",\"WASmaxInGroupsGroupMemberAddModeMixin\",\"WASmaxInGroupsMembershipApprovalGroupJoinModeEnabledMixin\",\"WASmaxInGroupsParentGroupDefaultMembershipApprovalModeMixin\",\"WASmaxInGroupsParticipantNotAddressableMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxInGroupsGroupInfoParticipantMixin\").parseGroupInfoParticipantMixin(a);if(!b.success)return b;a=d(\"WASmaxInGroupsParticipantNotAddressableMixin\").parseParticipantNotAddressableMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{participantNotAddressableMixin:a.success?a.value:null}))}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"description\");if(!b.success)return b;b=d(\"WASmaxInGroupsGroupInfoDescriptionMixin\").parseGroupInfoDescriptionMixin(a);return d(\"WAResultOrError\").makeResult({groupInfoDescriptionMixin:b.success?b.value:null})}function j(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"parent\");if(!b.success)return b;b=d(\"WASmaxInGroupsParentGroupDefaultMembershipApprovalModeMixin\").parseParentGroupDefaultMembershipApprovalModeMixin(a);return d(\"WAResultOrError\").makeResult({parentGroupDefaultMembershipApprovalModeMixin:b.success?b.value:null})}function k(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"ephemeral\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"expiration\",0,2147483647);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"trigger\",d(\"WASmaxInGroupsEnums\").ENUM_ACCOUNTSETTING_BULKCHANGE_CHATSETTING);if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,a,\"initiated_by_me\",d(\"WASmaxInGroupsEnums\").ENUM_FALSE_TRUE);return!a.success?a:d(\"WAResultOrError\").makeResult({expiration:b.value,trigger:c.value,initiatedByMe:a.value})}function l(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"growth_locked\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"invite\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrIntRange(a,\"expiration\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({type:b.value,expiration:a.value})}function m(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"membership_approval_mode\");if(!b.success)return b;b=d(\"WASmaxInGroupsMembershipApprovalGroupJoinModeEnabledMixin\").parseMembershipApprovalGroupJoinModeEnabledMixin(a);return d(\"WAResultOrError\").makeResult({membershipApprovalGroupJoinModeEnabledMixin:b.success?b.value:null})}function n(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"linked_parent\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrGroupJid(a,\"jid\");return!b.success?b:d(\"WAResultOrError\").makeResult({jid:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"group\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"description\",i);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optionalChild(a,\"locked\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optionalChild(a,\"announcement\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"parent\",j);if(!f.success)return f;var g=d(\"WASmaxParseUtils\").optionalChild(a,\"no_frequently_forwarded\");if(!g.success)return g;var o=d(\"WASmaxParseUtils\").optionalChild(a,\"support\");if(!o.success)return o;var p=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"ephemeral\",k);if(!p.success)return p;var q=d(\"WASmaxParseUtils\").optionalChild(a,\"suspended\");if(!q.success)return q;var r=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"growth_locked\",l);if(!r.success)return r;var s=d(\"WASmaxParseUtils\").optionalChild(a,\"default_sub_group\");if(!s.success)return s;var t=d(\"WASmaxParseUtils\").optionalChild(a,\"shadow\");if(!t.success)return t;var u=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"membership_approval_mode\",m);if(!u.success)return u;var v=d(\"WASmaxParseUtils\").optionalChild(a,\"incognito\");if(!v.success)return v;var w=d(\"WASmaxParseUtils\").optionalChild(a,\"allow_admin_reports\");if(!w.success)return w;var x=d(\"WASmaxParseUtils\").optionalChild(a,\"allow_non_admin_sub_group_creation\");if(!x.success)return x;var y=d(\"WASmaxParseUtils\").optionalChild(a,\"general_chat\");if(!y.success)return y;var z=d(\"WASmaxParseUtils\").optionalChild(a,\"auto_add_disabled\");if(!z.success)return z;var A=d(\"WASmaxParseUtils\").optionalChild(a,\"group_history\");if(!A.success)return A;var B=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"linked_parent\",n);if(!B.success)return B;var C=d(\"WASmaxParseUtils\").optionalChild(a,\"capi\");if(!C.success)return C;var D=d(\"WASmaxParseUtils\").optionalLiteral(d(\"WASmaxParseUtils\").attrString,a,\"ack\",\"false\");if(!D.success)return D;var E=d(\"WASmaxInGroupsGroupInfoAttributesMixin\").parseGroupInfoAttributesMixin(a);if(!E.success)return E;var F=d(\"WASmaxInGroupsGroupMemberAddModeMixin\").parseGroupMemberAddModeMixin(a);a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"participant\",0,19999,h);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({ack:D.value},E.value,{groupMemberAddModeMixin:F.success?F.value:null,description:b.value,hasLocked:c.value!=null,hasAnnouncement:e.value!=null,parent:f.value,hasNoFrequentlyForwarded:g.value!=null,hasSupport:o.value!=null,ephemeral:p.value,hasSuspended:q.value!=null,growthLocked:r.value,hasDefaultSubGroup:s.value!=null,hasShadow:t.value!=null,membershipApprovalMode:u.value,hasIncognito:v.value!=null,hasAllowAdminReports:w.value!=null,hasAllowNonAdminSubGroupCreation:x.value!=null,hasGeneralChat:y.value!=null,hasAutoAddDisabled:z.value!=null,hasGroupHistory:A.value!=null,linkedParent:B.value,hasCapi:C.value!=null,participant:a.value}))}g.parseGroupInfoParticipant=h;g.parseGroupInfoDescription=i;g.parseGroupInfoParent=j;g.parseGroupInfoEphemeral=k;g.parseGroupInfoGrowthLocked=l;g.parseGroupInfoMembershipApprovalMode=m;g.parseGroupInfoLinkedParent=n;g.parseGroupInfoMixin=a}),98);\n__d(\"WASmaxInGroupsOptionalContextGroupMixin\",[\"WAResultOrError\",\"WASmaxParseJid\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseJid\").attrGroupJid(a,\"context_group_jid\");return!a.success?a:d(\"WAResultOrError\").makeResult({contextGroupJid:a.value})}g.parseOptionalContextGroupMixin=a}),98);\n__d(\"WASmaxInGroupsJoinNotificationRequest\",[\"WAResultOrError\",\"WASmaxInGroupsCommonNotificationMixin\",\"WASmaxInGroupsDedupAttrsMixin\",\"WASmaxInGroupsEnums\",\"WASmaxInGroupsGroupAddressingModeMixin\",\"WASmaxInGroupsGroupInfoMixin\",\"WASmaxInGroupsOptionalContextGroupMixin\",\"WASmaxInGroupsParticipantPhoneNumberMixin\",\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"create\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"group\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"participant\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optionalLiteral(d(\"WASmaxParseUtils\").attrString,b.value,\"type\",\"new\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,b.value,\"reason\",d(\"WASmaxInGroupsEnums\").ENUM_ACCEPT_AUTOADD_DEFAULTSUBGROUPADMINADD_GENERALCHATAUTOADD_INVITE_INVITEAUTOADD_LINKEDGROUPJOIN_SUBGROUPSUGGESTIONAPPROVED);if(!g.success)return g;var h=d(\"WASmaxParseUtils\").attrIntRange(c.value,\"size\",1,19999);if(!h.success)return h;c=d(\"WASmaxInGroupsGroupInfoMixin\").parseGroupInfoMixin(c.value);if(!c.success)return c;var i=d(\"WASmaxInGroupsOptionalContextGroupMixin\").parseOptionalContextGroupMixin(b.value);b=d(\"WASmaxInGroupsDedupAttrsMixin\").parseDedupAttrsMixin(b.value);var j=d(\"WASmaxInGroupsCommonNotificationMixin\").parseCommonNotificationMixin(a);if(!j.success)return j;var k=d(\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\").parseShadowGroupNotificationIndicatorMixin(a),l=d(\"WASmaxInGroupsGroupAddressingModeMixin\").parseGroupAddressingModeMixin(a);a=d(\"WASmaxInGroupsParticipantPhoneNumberMixin\").parseParticipantPhoneNumberMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({participant:e.value,createType:f.value,createReason:g.value,createGroupSize:h.value,createGroupGroupInfoMixin:c.value,createOptionalContextGroupMixin:i.success?i.value:null,createDedupAttrsMixin:b.success?b.value:null},j.value,{shadowGroupNotificationIndicatorMixin:k.success?k.value:null,groupAddressingModeMixin:l.success?l.value:null,participantPhoneNumberMixin:a.success?a.value:null}))}g.parseJoinNotificationRequest=a}),98);\n__d(\"WASmaxOutGroupsJoinNotificationResponseAck\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WASmaxOutGroupsNotificationClientAckMixin\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrUserJid,a,[\"participant\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);b=d(\"WASmaxOutGroupsNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",{participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").USER_JID,b.value)}),a);return b}g.makeJoinNotificationResponseAck=a}),98);\n__d(\"WASmaxGroupsJoinNotificationRPC\",[\"WASmaxInGroupsJoinNotificationRequest\",\"WASmaxOutGroupsJoinNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsJoinNotificationRequest\").parseJoinNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"JoinNotification\",{Request:b}));return{parsedRequest:b.value,makeJoinNotificationResponseAck:function(){return d(\"WASmaxOutGroupsJoinNotificationResponseAck\").makeJoinNotificationResponseAck(a)}}}g.receiveJoinNotificationRPC=a}),98);\n__d(\"WASmaxInGroupsMemberAddModeChangeNotificationRequest\",[\"WAResultOrError\",\"WASmaxInGroupsCommonNotificationMixin\",\"WASmaxInGroupsGroupAddressingModeMixin\",\"WASmaxInGroupsGroupMemberAddModeMixin\",\"WASmaxInGroupsParticipantPhoneNumberMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"participant\");if(!b.success)return b;var c=d(\"WASmaxInGroupsCommonNotificationMixin\").parseCommonNotificationMixin(a);if(!c.success)return c;var e=d(\"WASmaxInGroupsGroupMemberAddModeMixin\").parseGroupMemberAddModeMixin(a);if(!e.success)return e;var f=d(\"WASmaxInGroupsGroupAddressingModeMixin\").parseGroupAddressingModeMixin(a);a=d(\"WASmaxInGroupsParticipantPhoneNumberMixin\").parseParticipantPhoneNumberMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({participant:b.value},c.value,e.value,{groupAddressingModeMixin:f.success?f.value:null,participantPhoneNumberMixin:a.success?a.value:null}))}g.parseMemberAddModeChangeNotificationRequest=a}),98);\n__d(\"WASmaxOutGroupsMemberAddModeChangeNotificationResponseAck\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WASmaxOutGroupsNotificationClientAckMixin\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrUserJid,a,[\"participant\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);b=d(\"WASmaxOutGroupsNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",{participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").USER_JID,b.value)}),a);return b}g.makeMemberAddModeChangeNotificationResponseAck=a}),98);\n__d(\"WASmaxGroupsMemberAddModeChangeNotificationRPC\",[\"WASmaxInGroupsMemberAddModeChangeNotificationRequest\",\"WASmaxOutGroupsMemberAddModeChangeNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsMemberAddModeChangeNotificationRequest\").parseMemberAddModeChangeNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"MemberAddModeChangeNotification\",{Request:b}));return{parsedRequest:b.value,makeMemberAddModeChangeNotificationResponseAck:function(){return d(\"WASmaxOutGroupsMemberAddModeChangeNotificationResponseAck\").makeMemberAddModeChangeNotificationResponseAck(a)}}}g.receiveMemberAddModeChangeNotificationRPC=a}),98);\n__d(\"WASmaxInGroupsPromoteNotificationRequest\",[\"WAResultOrError\",\"WASmaxInGroupsCommonNotificationMixin\",\"WASmaxInGroupsGroupAddressingModeMixin\",\"WASmaxInGroupsParticipantMixins\",\"WASmaxInGroupsParticipantPhoneNumberMixin\",\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxInGroupsParticipantMixins\").parseParticipantMixins(a);return!b.success?b:d(\"WAResultOrError\").makeResult({participantMixins:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"promote\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"participant\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrString(b.value,\"v_id\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,b.value,\"prev_v_id\");if(!f.success)return f;var g=d(\"WASmaxInGroupsCommonNotificationMixin\").parseCommonNotificationMixin(a);if(!g.success)return g;var i=d(\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\").parseShadowGroupNotificationIndicatorMixin(a),j=d(\"WASmaxInGroupsGroupAddressingModeMixin\").parseGroupAddressingModeMixin(a);a=d(\"WASmaxInGroupsParticipantPhoneNumberMixin\").parseParticipantPhoneNumberMixin(a);b=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"participant\",1,19999,h);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({participant:c.value,promoteVId:e.value,promotePrevVId:f.value},g.value,{shadowGroupNotificationIndicatorMixin:i.success?i.value:null,groupAddressingModeMixin:j.success?j.value:null,participantPhoneNumberMixin:a.success?a.value:null,promoteParticipant:b.value}))}g.parsePromoteNotificationRequestPromoteParticipant=h;g.parsePromoteNotificationRequest=a}),98);\n__d(\"WASmaxOutGroupsPromoteNotificationResponseAck\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WASmaxOutGroupsNotificationClientAckMixin\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrUserJid,a,[\"participant\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);b=d(\"WASmaxOutGroupsNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",{participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").USER_JID,b.value)}),a);return b}g.makePromoteNotificationResponseAck=a}),98);\n__d(\"WASmaxGroupsPromoteNotificationRPC\",[\"WASmaxInGroupsPromoteNotificationRequest\",\"WASmaxOutGroupsPromoteNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsPromoteNotificationRequest\").parsePromoteNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"PromoteNotification\",{Request:b}));return{parsedRequest:b.value,makePromoteNotificationResponseAck:function(){return d(\"WASmaxOutGroupsPromoteNotificationResponseAck\").makePromoteNotificationResponseAck(a)}}}g.receivePromoteNotificationRPC=a}),98);\n__d(\"WASmaxInGroupsRemoveNotificationMemberMixin\",[\"WAResultOrError\",\"WASmaxInGroupsParticipantMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"participant\");if(!b.success)return b;b=d(\"WASmaxInGroupsParticipantMixin\").parseParticipantMixin(a);return!b.success?b:b}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"remove\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"v_id\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"prev_v_id\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"subject\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optionalLiteral(d(\"WASmaxParseUtils\").attrString,a,\"reason\",\"default_sub_group_demote\");if(!f.success)return f;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"participant\",1,1024,h);return!a.success?a:d(\"WAResultOrError\").makeResult({vId:b.value,prevVId:c.value,subject:e.value,reason:f.value,participant:a.value})}g.parseRemoveNotificationMemberParticipant=h;g.parseRemoveNotificationMemberMixin=a}),98);\n__d(\"WASmaxInGroupsRemoveNotificationNonMemberMixin\",[\"WAResultOrError\",\"WASmaxInGroupsParticipantMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"remove\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"participant\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"subject\");if(!a.success)return a;b=d(\"WASmaxInGroupsParticipantMixin\").parseParticipantMixin(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult({subject:a.value,participantParticipantMixin:b.value})}g.parseRemoveNotificationNonMemberMixin=a}),98);\n__d(\"WASmaxInGroupsRemoveNotificationOrRemoveNotificationNonMemberMixinGroup\",[\"WAResultOrError\",\"WASmaxInGroupsRemoveNotificationMemberMixin\",\"WASmaxInGroupsRemoveNotificationNonMemberMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsRemoveNotificationMemberMixin\").parseRemoveNotificationMemberMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"RemoveNotificationMember\",value:b.value});var c=d(\"WASmaxInGroupsRemoveNotificationNonMemberMixin\").parseRemoveNotificationNonMemberMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"RemoveNotificationNonMember\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Member\",\"NonMember\"],[b,c])}g.parseRemoveNotificationOrRemoveNotificationNonMemberMixinGroup=a}),98);\n__d(\"WASmaxInGroupsRemoveNotificationRequest\",[\"WAResultOrError\",\"WASmaxInGroupsCommonNotificationMixin\",\"WASmaxInGroupsGroupAddressingModeMixin\",\"WASmaxInGroupsParticipantPhoneNumberMixin\",\"WASmaxInGroupsRemoveNotificationOrRemoveNotificationNonMemberMixinGroup\",\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"remove\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,a,\"participant\");if(!c.success)return c;var e=d(\"WASmaxInGroupsCommonNotificationMixin\").parseCommonNotificationMixin(a);if(!e.success)return e;var f=d(\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\").parseShadowGroupNotificationIndicatorMixin(a),g=d(\"WASmaxInGroupsGroupAddressingModeMixin\").parseGroupAddressingModeMixin(a);a=d(\"WASmaxInGroupsParticipantPhoneNumberMixin\").parseParticipantPhoneNumberMixin(a);b=d(\"WASmaxInGroupsRemoveNotificationOrRemoveNotificationNonMemberMixinGroup\").parseRemoveNotificationOrRemoveNotificationNonMemberMixinGroup(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({participant:c.value},e.value,{shadowGroupNotificationIndicatorMixin:f.success?f.value:null,groupAddressingModeMixin:g.success?g.value:null,participantPhoneNumberMixin:a.success?a.value:null,removeRemoveNotificationOrRemoveNotificationNonMemberMixinGroup:b.value}))}g.parseRemoveNotificationRequest=a}),98);\n__d(\"WASmaxOutGroupsRemoveNotificationResponseAck\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WASmaxOutGroupsNotificationClientAckMixin\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrUserJid,a,[\"participant\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);b=d(\"WASmaxOutGroupsNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",{participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").USER_JID,b.value)}),a);return b}g.makeRemoveNotificationResponseAck=a}),98);\n__d(\"WASmaxGroupsRemoveNotificationRPC\",[\"WASmaxInGroupsRemoveNotificationRequest\",\"WASmaxOutGroupsRemoveNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsRemoveNotificationRequest\").parseRemoveNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"RemoveNotification\",{Request:b}));return{parsedRequest:b.value,makeRemoveNotificationResponseAck:function(){return d(\"WASmaxOutGroupsRemoveNotificationResponseAck\").makeRemoveNotificationResponseAck(a)}}}g.receiveRemoveNotificationRPC=a}),98);\n__d(\"WASmaxInGroupsSubjectChangeNotificationRequest\",[\"WAResultOrError\",\"WASmaxInGroupsCommonNotificationMixin\",\"WASmaxInGroupsGroupAddressingModeMixin\",\"WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup\",\"WASmaxInGroupsParticipantPhoneNumberMixin\",\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"subject\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").attrUserJid(a,\"participant\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrUserJid,b.value,\"s_o\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"s_t\",0,void 0);if(!f.success)return f;var g=d(\"WASmaxInGroupsCommonNotificationMixin\").parseCommonNotificationMixin(a);if(!g.success)return g;var h=d(\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\").parseShadowGroupNotificationIndicatorMixin(a),i=d(\"WASmaxInGroupsGroupAddressingModeMixin\").parseGroupAddressingModeMixin(a);a=d(\"WASmaxInGroupsParticipantPhoneNumberMixin\").parseParticipantPhoneNumberMixin(a);b=d(\"WASmaxInGroupsNamedSubjectOrUnnamedSubjectFallbackMixinGroup\").parseNamedSubjectOrUnnamedSubjectFallbackMixinGroup(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({participant:c.value,subjectSO:e.value,subjectST:f.value},g.value,{shadowGroupNotificationIndicatorMixin:h.success?h.value:null,groupAddressingModeMixin:i.success?i.value:null,participantPhoneNumberMixin:a.success?a.value:null,subjectNamedSubjectOrUnnamedSubjectFallbackMixinGroup:b.value}))}g.parseSubjectChangeNotificationRequest=a}),98);\n__d(\"WASmaxOutGroupsSubjectChangeNotificationResponseAck\",[\"WASmaxJsx\",\"WASmaxOutGroupsNotificationClientAckMixin\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrUserJid,a,[\"participant\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);b=d(\"WASmaxOutGroupsNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",{participant:d(\"WAWap\").USER_JID(b.value)}),a);return b}g.makeSubjectChangeNotificationResponseAck=a}),98);\n__d(\"WASmaxGroupsSubjectChangeNotificationRPC\",[\"WASmaxInGroupsSubjectChangeNotificationRequest\",\"WASmaxOutGroupsSubjectChangeNotificationResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInGroupsSubjectChangeNotificationRequest\").parseSubjectChangeNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"SubjectChangeNotification\",{Request:b}));return{parsedRequest:b.value,makeSubjectChangeNotificationResponseAck:function(){return d(\"WASmaxOutGroupsSubjectChangeNotificationResponseAck\").makeSubjectChangeNotificationResponseAck(a)}}}g.receiveSubjectChangeNotificationRPC=a}),98);\n__d(\"WASmaxInNotificationFallbackEnums\",[\"WAJids\"],(function(a,b,c,d,e,f,g){b={validators:[(a=d(\"WAJids\")).validateBroadcastJid,a.validateCallJid,a.validateDeviceJid,a.validateDomainJid,a.validateGroupJid,a.validateStatusJid,a.validateUserJid],typeName:\"BroadcastJid|CallJid|DeviceJid|DomainJid|GroupJid|StatusJid|UserJid\"};g.BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID=b}),98);\n__d(\"WASmaxInNotificationFallbackGenericNotificationRequest\",[\"WAResultOrError\",\"WASmaxInNotificationFallbackEnums\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrJidEnum,a,\"from\",d(\"WASmaxInNotificationFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrJidEnum,a,\"participant\",d(\"WASmaxInNotificationFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)return e;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"type\");return!a.success?a:d(\"WAResultOrError\").makeResult({id:b.value,from:c.value,participant:e.value,type:a.value})}g.parseGenericNotificationRequest=a}),98);\n__d(\"WASmaxOutNotificationFallbackGenericNotificationResponseAck\",[\"WASmaxAttrs\",\"WASmaxInNotificationFallbackEnums\",\"WASmaxJsx\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrJidEnum,a,[\"from\"],d(\"WASmaxInNotificationFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);var e=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrJidEnum,a,[\"participant\"],d(\"WASmaxInNotificationFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(e.error);a=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").JID,c.value),participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").JID,e.value),\"class\":\"notification\",type:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").CUSTOM_STRING,a.value)});return b}g.makeGenericNotificationResponseAck=a}),98);\n__d(\"WASmaxOutNotificationFallbackGenericNotificationResponseBadStanza\",[\"WASmaxAttrs\",\"WASmaxInNotificationFallbackEnums\",\"WASmaxJsx\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a,b){a=a.ackError;var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,b,[\"id\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);var e=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrJidEnum,b,[\"from\"],d(\"WASmaxInNotificationFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!e.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(e.error);var f=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrJidEnum,b,[\"participant\"],d(\"WASmaxInNotificationFallbackEnums\").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!f.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(f.error);b=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseUtils\").attrString,b,[\"type\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);c=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(c.value),to:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").JID,e.value),participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").JID,f.value),\"class\":\"notification\",type:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").CUSTOM_STRING,b.value),error:d(\"WAWap\").INT(a)});return c}g.makeGenericNotificationResponseBadStanza=a}),98);\n__d(\"WASmaxNotificationFallbackGenericNotificationRPC\",[\"WASmaxInNotificationFallbackGenericNotificationRequest\",\"WASmaxOutNotificationFallbackGenericNotificationResponseAck\",\"WASmaxOutNotificationFallbackGenericNotificationResponseBadStanza\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInNotificationFallbackGenericNotificationRequest\").parseGenericNotificationRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"GenericNotification\",{Request:b}));return{parsedRequest:b.value,makeGenericNotificationResponseBadStanza:function(b){return d(\"WASmaxOutNotificationFallbackGenericNotificationResponseBadStanza\").makeGenericNotificationResponseBadStanza(b,a)},makeGenericNotificationResponseAck:function(){return d(\"WASmaxOutNotificationFallbackGenericNotificationResponseAck\").makeGenericNotificationResponseAck(a)}}}g.receiveGenericNotificationRPC=a}),98);\n__d(\"WAParseGroupNotifications\",[\"WAJids\",\"WALogger\",\"WAResultOrError\",\"WASmaxDecisionTreeUtils\",\"WASmaxGroupsAddNotificationRPC\",\"WASmaxGroupsDeleteNotificationRPC\",\"WASmaxGroupsDemoteNotificationRPC\",\"WASmaxGroupsJoinNotificationRPC\",\"WASmaxGroupsMemberAddModeChangeNotificationRPC\",\"WASmaxGroupsPromoteNotificationRPC\",\"WASmaxGroupsRemoveNotificationRPC\",\"WASmaxGroupsSubjectChangeNotificationRPC\",\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\",\"WASmaxNotificationFallbackGenericNotificationRPC\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"parseMemberAddModeNotification: Unexpected memberAddMode \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"parseGroupNotification: Unknown notification \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"parseGroupNotification: Received group-dual-send notification\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"parseGroupNotification: Received node with no children\"]);k=function(){return a};return a}function a(a){var b=d(\"WASmaxDecisionTreeUtils\").firstChild(a);if(!b.success){d(\"WALogger\").ERROR(k());var c=d(\"WASmaxNotificationFallbackGenericNotificationRPC\").receiveGenericNotificationRPC(a),e=c.makeGenericNotificationResponseBadStanza;c=c.parsedRequest.id;return{action:{type:\"unknown\"},id:c,ack:function(){return e({ackError:487})}}}c=d(\"WASmaxInGroupsShadowGroupNotificationIndicatorMixin\").parseShadowGroupNotificationIndicatorMixin(a);if(c.success){d(\"WALogger\").WARN(j());c=d(\"WASmaxNotificationFallbackGenericNotificationRPC\").receiveGenericNotificationRPC(a);var f=c.makeGenericNotificationResponseBadStanza;c=c.parsedRequest.id;return{action:{type:\"unknown\"},id:c,ack:function(){return f({ackError:487})}}}c=b.value.tag;switch(c){case\"create\":return l(a);case\"add\":return n(a);case\"remove\":return o(a);case\"delete\":b=d(\"WASmaxGroupsDeleteNotificationRPC\").receiveDeleteNotificationRPC(a);var g=b.parsedRequest,h=g.participant,m=g.from,s=g.offline,u=g.t;g=g.id;b=b.makeDeleteNotificationResponseAck;return{action:{type:\"delete\",participant:h,groupJid:m},ack:b,offline:s,serverTs:d(\"WATimeUtils\").castToUnixTime(u),id:g};case\"promote\":return p(a);case\"demote\":return q(a);case\"subject\":return r(a);case\"member_add_mode\":h=t(a);if(h!=null)return h;break;default:d(\"WALogger\").ERROR(i(),c)}m=d(\"WASmaxNotificationFallbackGenericNotificationRPC\").receiveGenericNotificationRPC(a);var v=m.makeGenericNotificationResponseBadStanza;b=m.parsedRequest.id;return{action:{type:\"unknown\"},id:b,ack:function(){return v({ackError:487})}}}function l(a){a=d(\"WASmaxGroupsJoinNotificationRPC\").receiveJoinNotificationRPC(a);var b=a.parsedRequest,c=b.from,e=b.createGroupGroupInfoMixin,f=e.id,g=e.creator,h=e.creation,i=e.participant,j=e.namedSubjectOrUnnamedSubjectFallbackMixinGroup,k=e.sO,l=e.sT,m=e.pVId,n=e.description;e=e.groupMemberAddModeMixin;var o=b.createDedupAttrsMixin,p=b.createType,q=b.participant,r=b.t,t=b.offline;b=b.id;a=a.makeJoinNotificationResponseAck;n=n==null?void 0:n.groupInfoDescriptionMixin;k={jid:d(\"WAJids\").toGroupJid(f),creator:(f=g)!=null?f:void 0,creationTs:d(\"WATimeUtils\").castToUnixTime(h),participants:i.map(function(a){var b=a.groupInfoParticipantMixins;a=a.participantNotAddressableMixin;return d(\"WAResultOrError\").makeResult({addressable:(a==null?void 0:a.addressable)!==\"false\",type:b.name===\"GroupInfoParticipantAdmin\"?b.value.type:\"participant\",user:b.name===\"GroupInfoParticipantAdmin\"?b.value.groupInfoParticipantAdminMixins.value.jid:b.value.participantMixins.value.jid})}),subject:{content:j.value.subject,user:(g=k)!=null?g:void 0,ts:l==null?void 0:d(\"WATimeUtils\").castToUnixTime(l)},description:n==null?void 0:{id:n.id,content:n.bodyElementValue,user:n.participant,ts:d(\"WATimeUtils\").castToUnixTime(n.t)},participantVersion:(f=m)!=null?f:void 0,inviter:(h=q)!=null?h:void 0,memberAddMode:s(e==null?void 0:(i=e.memberAddModeAdminOrAllMembersOrUnknownAddModeMixinGroup)==null?void 0:(j=i.value)==null?void 0:j.elementValue)};g=d(\"WATimeUtils\").castToUnixTime(r);return{action:{type:\"join\",isNew:p===\"new\",isE2EEMigration:(o==null?void 0:o.createCtx)===\"e2ee_migration\",key:o==null?void 0:o.key,serverTs:d(\"WATimeUtils\").castToUnixTime(r),groupJid:c,group:k},serverTs:g,offline:t,ack:a,id:b}}function m(a){if(a===null)return;return a===\"invite\"?\"invite\":\"accept\"}function n(a){a=d(\"WASmaxGroupsAddNotificationRPC\").receiveAddNotificationRPC(a);var b=a.parsedRequest,c=b.from,e=b.participant,f=b.addVId,g=b.addPrevVId,h=b.addReason,i=b.addParticipant,j=b.offline,k=b.t;b=b.id;a=a.makeAddNotificationResponseAck;return{action:{type:\"add\",versionId:f,previousVersionId:g,reason:m(h),participants:i.map(function(a){return{user:a.participantMixins.value.jid,type:\"participant\",addressable:((a=a.participantNotAddressableMixin)==null?void 0:a.addressable)!==\"false\"}}),groupJid:c,participant:e},serverTs:d(\"WATimeUtils\").castToUnixTime(k),offline:j,ack:a,id:b}}function o(a){a=d(\"WASmaxGroupsRemoveNotificationRPC\").receiveRemoveNotificationRPC(a);var b=a.parsedRequest,c=b.offline,e=b.from,f=b.participant,g=b.t,h=b.id;b=b.removeRemoveNotificationOrRemoveNotificationNonMemberMixinGroup;a=a.makeRemoveNotificationResponseAck;var i=b.name===\"RemoveNotificationMember\"?b.value.participant.map(function(a){return{user:a.participantMixins.value.jid,type:\"nonparticipant\",addressable:!0}}):[{user:b.value.participantParticipantMixin.participantMixins.value.jid,type:\"nonparticipant\",addressable:!0}];return{action:{type:\"remove\",versionId:b.value.vId,previousVersionId:b.value.prevVId,participants:i,groupJid:e,participant:f},serverTs:d(\"WATimeUtils\").castToUnixTime(g),ack:a,offline:c,id:h}}function p(a){a=d(\"WASmaxGroupsPromoteNotificationRPC\").receivePromoteNotificationRPC(a);var b=a.parsedRequest,c=b.promoteVId,e=b.promotePrevVId,f=b.promoteParticipant,g=b.from,h=b.participant,i=b.offline,j=b.t;b=b.id;a=a.makePromoteNotificationResponseAck;return{action:{type:\"promote\",versionId:c,previousVersionId:e,participants:f.map(function(a){a=a.participantMixins.value.jid;return{user:a,type:\"admin\",addressable:!0}}),groupJid:g,participant:h},serverTs:d(\"WATimeUtils\").castToUnixTime(j),offline:i,ack:a,id:b}}function q(a){a=d(\"WASmaxGroupsDemoteNotificationRPC\").receiveDemoteNotificationRPC(a);var b=a.parsedRequest,c=b.demoteVId,e=b.demotePrevVId,f=b.demoteParticipant,g=b.from,h=b.participant,i=b.offline,j=b.t;b=b.id;a=a.makeDemoteNotificationResponseAck;return{action:{type:\"demote\",versionId:c,previousVersionId:e,participants:f.map(function(a){a=a.participantMixins.value.jid;return{user:a,type:\"participant\",addressable:!0}}),groupJid:g,participant:h},serverTs:d(\"WATimeUtils\").castToUnixTime(j),offline:i,ack:a,id:b}}function r(a){a=d(\"WASmaxGroupsSubjectChangeNotificationRPC\").receiveSubjectChangeNotificationRPC(a);var b=a.parsedRequest,c=b.subjectNamedSubjectOrUnnamedSubjectFallbackMixinGroup,e=b.subjectST,f=b.from,g=b.participant,h=b.offline,i=b.t;b=b.id;a=a.makeSubjectChangeNotificationResponseAck;return{action:{type:\"subject\",subject:c.name===\"NamedSubject\"?c.value.subject:null,ts:d(\"WATimeUtils\").castToUnixTime(e),groupJid:f,participant:g},serverTs:d(\"WATimeUtils\").castToUnixTime(i),ack:a,offline:h,id:b}}function s(a){if(a===\"admin_add\"||a===\"all_member_add\")return a}function t(a){a=d(\"WASmaxGroupsMemberAddModeChangeNotificationRPC\").receiveMemberAddModeChangeNotificationRPC(a);var b=a.parsedRequest,c=b.memberAddModeAdminOrAllMembersOrUnknownAddModeMixinGroup,e=b.from,f=b.offline,g=b.participant,i=b.t;b=b.id;a=a.makeMemberAddModeChangeNotificationResponseAck;var j=s(c.value.elementValue);if(j==null){d(\"WALogger\").ERROR(h(),c.value.elementValue);return}return{action:{type:\"memberAddMode\",memberAddMode:j,groupJid:e,participant:g},serverTs:d(\"WATimeUtils\").castToUnixTime(i),ack:a,offline:f,id:b}}g.parseGroupNotification=a}),98);\n__d(\"WACreateHandleGroupNotificationBranch\",[\"Promise\",\"WAParseGroupNotifications\",\"WAResultOrError\",\"WATagsLogger\",\"WAUnknownStanzaError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"start handling\"]);i=function(){return a};return a}var j=d(\"WATagsLogger\").TAGS([\"decision tree\",\"handleGroupNotification\"]);function a(a){a=(a=a.groupMessage)!=null?a:{};var c=a.handleGroupNotification;return function(a){j.LOG(i());if(c!=null){a=d(\"WAParseGroupNotifications\").parseGroupNotification(a);var e=a.action,f=a.ack,g=a.offline,k=a.serverTs;a=a.id;if(e.type!==\"unknown\")return c({makeAck:f,action:e,offline:g,serverTs:k,id:a}).then(d(\"WAResultOrError\").makeResult)}return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}}g.createHandleGroupNotification=a}),98);\n__d(\"WASmaxInAbPropsServerNotificationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"offline\",0,1024);return!a.success?a:d(\"WAResultOrError\").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);\n__d(\"WASmaxInAbPropsRefreshRequest\",[\"WAResultOrError\",\"WASmaxInAbPropsServerNotificationMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"abprops\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"server\");if(!c.success)return c;var e=d(\"WASmaxParseJid\").attrDeviceJid(a,\"from\");if(!e.success)return e;b=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"protocol\",1,10);if(!b.success)return b;a=d(\"WASmaxInAbPropsServerNotificationMixin\").parseServerNotificationMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({type:c.value,from:e.value,abpropsProtocol:b.value},a.value))}g.parseRefreshRequest=a}),98);\n__d(\"WASmaxOutAbPropsNotificationClientAckMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrDeviceJid,a,[\"from\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").DEVICE_JID(c.value),\"class\":\"notification\",type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);\n__d(\"WASmaxOutAbPropsRefreshResponseAck\",[\"WASmaxJsx\",\"WASmaxOutAbPropsNotificationClientAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutAbPropsNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a);return a}g.makeRefreshResponseAck=a}),98);\n__d(\"WASmaxAbPropsRefreshRPC\",[\"WASmaxInAbPropsRefreshRequest\",\"WASmaxOutAbPropsRefreshResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAbPropsRefreshRequest\").parseRefreshRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Refresh\",{Request:b}));return{parsedRequest:b.value,makeRefreshResponseAck:function(){return d(\"WASmaxOutAbPropsRefreshResponseAck\").makeRefreshResponseAck(a)}}}g.receiveRefreshRPC=a}),98);\n__d(\"WASmaxInClientLogServerNotificationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"offline\",0,1024);return!a.success?a:d(\"WAResultOrError\").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);\n__d(\"WASmaxInClientLogLogRequest\",[\"WAResultOrError\",\"WASmaxInClientLogServerNotificationMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"log\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"server\");if(!c.success)return c;var e=d(\"WASmaxParseJid\").attrDeviceJid(a,\"from\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,b.value,\"start_t\");if(!f.success)return f;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,b.value,\"end_t\");if(!b.success)return b;a=d(\"WASmaxInClientLogServerNotificationMixin\").parseServerNotificationMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({type:c.value,from:e.value,logStartT:f.value,logEndT:b.value},a.value))}g.parseLogRequest=a}),98);\n__d(\"WASmaxOutClientLogNotificationClientAckMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrDeviceJid,a,[\"from\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").DEVICE_JID(c.value),\"class\":\"notification\",type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);\n__d(\"WASmaxOutClientLogLogResponseAck\",[\"WASmaxJsx\",\"WASmaxOutClientLogNotificationClientAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutClientLogNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a);return a}g.makeLogResponseAck=a}),98);\n__d(\"WASmaxClientLogLogRPC\",[\"WASmaxInClientLogLogRequest\",\"WASmaxOutClientLogLogResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInClientLogLogRequest\").parseLogRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Log\",{Request:b}));return{parsedRequest:b.value,makeLogResponseAck:function(){return d(\"WASmaxOutClientLogLogResponseAck\").makeLogResponseAck(a)}}}g.receiveLogRPC=a}),98);\n__d(\"WASmaxInServerPropsServerNotificationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"offline\",0,1024);return!a.success?a:d(\"WAResultOrError\").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);\n__d(\"WASmaxInServerPropsTriggerRefreshDeviceFromMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrDeviceJid(a,\"from\");return!b.success?b:d(\"WAResultOrError\").makeResult({from:b.value})}g.parseTriggerRefreshDeviceFromMixin=a}),98);\n__d(\"WASmaxInServerPropsTriggerRefreshServerFromMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");return!b.success?b:d(\"WAResultOrError\").makeResult({from:b.value})}g.parseTriggerRefreshServerFromMixin=a}),98);\n__d(\"WASmaxInServerPropsTriggerRefreshUserFromDeprecatedMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"from\");return!b.success?b:d(\"WAResultOrError\").makeResult({from:b.value})}g.parseTriggerRefreshUserFromDeprecatedMixin=a}),98);\n__d(\"WASmaxInServerPropsTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup\",[\"WAResultOrError\",\"WASmaxInServerPropsTriggerRefreshDeviceFromMixin\",\"WASmaxInServerPropsTriggerRefreshServerFromMixin\",\"WASmaxInServerPropsTriggerRefreshUserFromDeprecatedMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInServerPropsTriggerRefreshServerFromMixin\").parseTriggerRefreshServerFromMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"TriggerRefreshServerFrom\",value:b.value});var c=d(\"WASmaxInServerPropsTriggerRefreshDeviceFromMixin\").parseTriggerRefreshDeviceFromMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"TriggerRefreshDeviceFrom\",value:c.value});var e=d(\"WASmaxInServerPropsTriggerRefreshUserFromDeprecatedMixin\").parseTriggerRefreshUserFromDeprecatedMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"TriggerRefreshUserFromDeprecated\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ServerFrom\",\"DeviceFrom\",\"UserFromDeprecated\"],[b,c,e])}g.parseTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup=a}),98);\n__d(\"WASmaxInServerPropsTriggerRefreshRequest\",[\"WAResultOrError\",\"WASmaxInServerPropsServerNotificationMixin\",\"WASmaxInServerPropsTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"props\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"server\");if(!b.success)return b;var c=d(\"WASmaxInServerPropsServerNotificationMixin\").parseServerNotificationMixin(a);if(!c.success)return c;a=d(\"WASmaxInServerPropsTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup\").parseTriggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({type:b.value},c.value,{triggerRefreshServerFromOrTriggerRefreshDeviceFromOrTriggerRefreshUserFromDeprecatedMixinGroup:a.value}))}g.parseTriggerRefreshRequest=a}),98);\n__d(\"WASmaxInServerPropsEnums\",[\"WAJids\"],(function(a,b,c,d,e,f,g){a={validators:[d(\"WAJids\").validateDeviceJid,d(\"WAJids\").validateDomainJid,d(\"WAJids\").validateUserJid],typeName:\"DeviceJid|DomainJid|UserJid\"};g.DEVICEJID_DOMAINJID_USERJID=a}),98);\n__d(\"WASmaxOutServerPropsNotificationClientAckMixin\",[\"WASmaxInServerPropsEnums\",\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrJidEnum,a,[\"from\"],d(\"WASmaxInServerPropsEnums\").DEVICEJID_DOMAINJID_USERJID);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),to:d(\"WAWap\").JID(c.value),\"class\":\"notification\",type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeNotificationClientAckMixin=a}),98);\n__d(\"WASmaxOutServerPropsTriggerRefreshResponseAck\",[\"WASmaxJsx\",\"WASmaxOutServerPropsNotificationClientAckMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutServerPropsNotificationClientAckMixin\").mergeNotificationClientAckMixin(d(\"WASmaxJsx\").smax(\"ack\",null),a);return a}g.makeTriggerRefreshResponseAck=a}),98);\n__d(\"WASmaxServerPropsTriggerRefreshRPC\",[\"WASmaxInServerPropsTriggerRefreshRequest\",\"WASmaxOutServerPropsTriggerRefreshResponseAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInServerPropsTriggerRefreshRequest\").parseTriggerRefreshRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"TriggerRefresh\",{Request:b}));return{parsedRequest:b.value,makeTriggerRefreshResponseAck:function(){return d(\"WASmaxOutServerPropsTriggerRefreshResponseAck\").makeTriggerRefreshResponseAck(a)}}}g.receiveTriggerRefreshRPC=a}),98);\n__d(\"WACreateHandleServerNotificationBranch\",[\"Promise\",\"WALogger\",\"WAResultOrError\",\"WASmaxAbPropsRefreshRPC\",\"WASmaxClientLogLogRPC\",\"WASmaxDecisionTreeUtils\",\"WASmaxServerPropsTriggerRefreshRPC\",\"WATimeUtils\",\"WAUnknownStanzaError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"parseServerNotification notification without children\"]);i=function(){return a};return a}function a(a){var c,e=(c=a.abprops)==null?void 0:c.handleAbPropsRefreshNotification,f=(c=a.clientLog)==null?void 0:c.handleClientLogNotification,g=(c=a.serverProps)==null?void 0:c.handleServerPropsRefreshNotification;return function(a){var c=d(\"WASmaxDecisionTreeUtils\").firstChild(a);if(c.success===!1){d(\"WALogger\").ERROR(i());return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}c=c.value.tag;switch(c){case\"abprops\":if(e!=null){c=d(\"WASmaxAbPropsRefreshRPC\").receiveRefreshRPC(a);var j=c.parsedRequest;c=c.makeRefreshResponseAck;return e({serverTs:d(\"WATimeUtils\").castToUnixTime(j.t),id:j.id,offline:j.offline,makeAck:c}).then(d(\"WAResultOrError\").makeResult)}break;case\"props\":if(g!=null){j=d(\"WASmaxServerPropsTriggerRefreshRPC\").receiveTriggerRefreshRPC(a);c=j.parsedRequest;j=j.makeTriggerRefreshResponseAck;return g({serverTs:d(\"WATimeUtils\").castToUnixTime(c.t),id:c.id,offline:c.offline,makeAck:j}).then(d(\"WAResultOrError\").makeResult)}break;case\"log\":if(f!=null){c=d(\"WASmaxClientLogLogRPC\").receiveLogRPC(a);j=c.parsedRequest;a=c.makeLogResponseAck;return f({serverTs:d(\"WATimeUtils\").castToUnixTime(j.t),id:j.id,offline:j.offline,makeAck:a}).then(d(\"WAResultOrError\").makeResult)}break}return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}}g.createHandleServerNotification=a}),98);\n__d(\"WASmaxInSyncdServerNotificationMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"offline\",0,1024);return!a.success?a:d(\"WAResultOrError\").makeResult({t:b.value,id:c.value,offline:a.value})}g.parseServerNotificationMixin=a}),98);\n__d(\"WASmaxInSyncdNewPatchRequest\",[\"WAResultOrError\",\"WASmaxInSyncdServerNotificationMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"collection\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"name\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrIntRange(a,\"version\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({name:b.value,version:a.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"notification\");if(!b.success)return b;b=d(\"WASmaxParseJid\").literalJid(d(\"WASmaxParseJid\").attrDomainJid,a,\"from\",\"s.whatsapp.net\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"server_sync\");if(!c.success)return c;var e=d(\"WASmaxInSyncdServerNotificationMixin\").parseServerNotificationMixin(a);if(!e.success)return e;a=d(\"WASmaxParseUtils\").mapChildrenWithTag(a,\"collection\",1,20,h);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:b.value,type:c.value},e.value,{collection:a.value}))}g.parseNewPatchRequestCollection=h;g.parseNewPatchRequest=a}),98);\n__d(\"WASmaxOutSyncdNewPatchResponseClientAck\",[\"WASmaxJsx\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrDomainJid,a,[\"from\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{\"class\":\"notification\",type:\"server_sync\",to:d(\"WAWap\").DOMAIN_JID(b.value),id:d(\"WAWap\").STANZA_ID(a.value)});return b}g.makeNewPatchResponseClientAck=a}),98);\n__d(\"WASmaxSyncdNewPatchRPC\",[\"WASmaxInSyncdNewPatchRequest\",\"WASmaxOutSyncdNewPatchResponseClientAck\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInSyncdNewPatchRequest\").parseNewPatchRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"NewPatch\",{Request:b}));return{parsedRequest:b.value,makeNewPatchResponseClientAck:function(){return d(\"WASmaxOutSyncdNewPatchResponseClientAck\").makeNewPatchResponseClientAck(a)}}}g.receiveNewPatchRPC=a}),98);\n__d(\"WACreateHandleServerSyncNotificationBranch\",[\"Promise\",\"WALogger\",\"WAResultOrError\",\"WASmaxSyncdNewPatchRPC\",\"WASyncdConst\",\"WATimeUtils\",\"WAUnknownStanzaError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleServerSyncNotification: Incorrect collection notification\"]);i=function(){return a};return a}function a(a){var c=(a=a.syncd)==null?void 0:a.handleSyncdNewPatchNotification;return function(a){if(c==null)return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError);a=d(\"WASmaxSyncdNewPatchRPC\").receiveNewPatchRPC(a);var e=a.parsedRequest,f=e.collection,g=e.offline,j=e.t;e=e.id;a=a.makeNewPatchResponseClientAck;f=new Map(f.map(function(a){var b=a.name;a=a.version;b=d(\"WASyncdConst\").CollectionName.cast(b);if(b==null)d(\"WALogger\").ERROR(i());else return[b,a]}).filter(Boolean));return c({makeAck:a,collections:f,offline:g,id:e,serverTs:d(\"WATimeUtils\").castToUnixTime(j)}).then(d(\"WAResultOrError\").makeResult)}}g.createHandleServerSyncNotification=a}),98);\n__d(\"WARuntimeError\",[\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return d(\"WAResultOrError\").makeError({type:\"runtime-error\",error:a})}g.runtimeError=a}),98);\n__d(\"WACreateHandleNotification\",[\"Promise\",\"WACreateHandleAccountSyncNotificationBranch\",\"WACreateHandleDevicesNotificationBranch\",\"WACreateHandleEncryptNotificationBranch\",\"WACreateHandleFbDeviceChangeNotificationBranch\",\"WACreateHandleFbMultiwayNotificationBranch\",\"WACreateHandleFbThreadNotificationBranch\",\"WACreateHandleGroupNotificationBranch\",\"WACreateHandleServerNotificationBranch\",\"WACreateHandleServerSyncNotificationBranch\",\"WAResultOrError\",\"WARuntimeError\",\"WASmaxNotificationFallbackGenericNotificationRPC\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WATagsLogger\",\"WAUnknownStanzaError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"runtime-error: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"runtime-error: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"received unknown notifcation: \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"start handling\"]);l=function(){return a};return a}var m={encrypt:\"encrypt\",\"w:gp2\":\"w:gp2\",server:\"server\",server_sync:\"server_sync\",\"fbid:devices\":\"fbid:devices\",\"fbid:thread\":\"fbid:thread\",\"fb:multiway\":\"fb:multiway\",mediaretry:\"mediaretry\",picture:\"picture\",business:\"business\",contacts:\"contacts\",devices:\"devices\",disappearing_mode:\"disappearing_mode\",status:\"status\",account_sync:\"account_sync\",pay:\"pay\",psa:\"psa\",privacy_token:\"privacy_token\",link_code_companion_reg:\"link_code_companion_reg\"},n=d(\"WATagsLogger\").TAGS([\"decision tree\",\"handleNotification\"]);function a(a){var c=d(\"WACreateHandleEncryptNotificationBranch\").createHandleEncryptNotification(a),e=d(\"WACreateHandleServerNotificationBranch\").createHandleServerNotification(a),f=d(\"WACreateHandleServerSyncNotificationBranch\").createHandleServerSyncNotification(a),g=d(\"WACreateHandleGroupNotificationBranch\").createHandleGroupNotification(a),o=d(\"WACreateHandleAccountSyncNotificationBranch\").createHandleAccountSyncNotification(a),p=d(\"WACreateHandleDevicesNotificationBranch\").createHandleDevicesNotification(a);return function(q,r,s){n.DEV(l());var t=d(\"WASmaxParseUtils\").attrStringEnum(q,\"type\",m);return(h||(h=b(\"Promise\"))).resolve().then(function(){if(!t.success)return d(\"WAUnknownStanzaError\").unknownStanzaError;var b=t.value;switch(b){case\"fbid:devices\":var h;h=(h=a.fb)==null?void 0:h.handleFbDeviceChangeNotification;if(h)return d(\"WACreateHandleFbDeviceChangeNotificationBranch\").createHandleFbDeviceChangeNotification(h)(q,s);break;case\"fbid:thread\":h=(h=a.fb)==null?void 0:h.handleFbThreadNotification;if(h)return d(\"WACreateHandleFbThreadNotificationBranch\").createHandleFbThreadNotification(h)(q);break;case\"fb:multiway\":h=(h=a.fb)==null?void 0:h.handleFbMultiwayNotification;if(h)return d(\"WACreateHandleFbMultiwayNotificationBranch\").createHandleFbMultiwayNotification(h)(q);break;case\"encrypt\":return c(q);case\"server\":return e(q);case\"server_sync\":return f(q);case\"w:gp2\":return g(q);case\"devices\":return p(q);case\"account_sync\":return o(q);case\"mediaretry\":break;case\"picture\":break;case\"business\":break;case\"contacts\":break;case\"disappearing_mode\":break;case\"status\":break;case\"pay\":break;case\"psa\":break;case\"privacy_token\":break;case\"link_code_companion_reg\":break;default:b}return d(\"WAUnknownStanzaError\").unknownStanzaError})[\"catch\"](function(a){return a instanceof d(\"WASmaxParsingFailure\").SmaxParsingFailure?d(\"WAUnknownStanzaError\").unknownStanzaError:d(\"WARuntimeError\").runtimeError(a)}).then(function(a){if(a.success)return a;var b=d(\"WASmaxNotificationFallbackGenericNotificationRPC\").receiveGenericNotificationRPC(q),c=b.makeGenericNotificationResponseAck;b=b.makeGenericNotificationResponseBadStanza;if(a.error.type===\"unknown-stanza\"){n.WARN(k(),q.toString());return d(\"WAResultOrError\").makeResult(b({ackError:487}))}else{a.error.type;n.WARN(j(),a.error.error.message);n.ERROR(i(),a.error.error);return d(\"WAResultOrError\").makeResult(c())}})}}g.createHandleNotification=a}),98);\n__d(\"WAMapMixinNameToReceiptType\",[],(function(a,b,c,d,e,f){\"use strict\";var g={SenderType:\"sender\",ReadType:\"read\",InactiveType:\"inactive\",ReadSelfType:\"read-self\"};function a(a){return g[a]}f.mapMixinNameToReceiptType=a}),66);\n__d(\"WAParseKeyBundleMixing\",[\"WAParsableXmlNode\",\"WASignalKeys\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a,b){return{regId:a,identity:d(\"WASignalKeys\").serializeIdentity(b.keysIdentityKeyMixin.elementValue),signedKey:{id:d(\"WAParsableXmlNode\").convertBytesToUint(b.keysSignedPreKeyMixin.skeyIdKeyIDMixin.elementValue,3),publicKey:d(\"WASignalKeys\").serializeIdentity(b.keysSignedPreKeyMixin.skeyValueKeyDataMixin.elementValue),signature:b.keysSignedPreKeyMixin.skeySignatureElementValue},oneTimeKey:null}}g.parseKeyBundleMixin=a}),98);\n__d(\"WATransformToRetryReceipt\",[\"WAParseKeyBundleMixing\",\"WASignalOther\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){var b=a.aggregate,c=a.retryMixin,e=a.recipient;a=a.offline;var f=c.keyBundleMixin,g=c.registrationElementValue,h=c.retryCount,i=c.retryId,j=c.retryT;c.retryV;c.type;c=d(\"WASignalOther\").castRegistrationIdFromBytes(g);return{stanzaId:b.stanzaId,retryStanzaId:i,receiptSender:b.receiptSender,retryCount:h,regId:c,offline:a,timestamp:d(\"WATimeUtils\").castToUnixTime(j),keys:f?d(\"WAParseKeyBundleMixing\").parseKeyBundleMixin(c,f):null,recipient:e}};g.transformToRetryReceipt=a}),98);\n__d(\"WACreateHandleGroupReceiptBranch\",[\"Promise\",\"WAMapMixinNameToReceiptType\",\"WAResultOrError\",\"WATagsLogger\",\"WATransformToRetryReceipt\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleGroupReceipt: receipt type \",\" is not handled yet\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"retry receipt not supported for aggregated messages\"]);j=function(){return a};return a}var k=d(\"WATagsLogger\").TAGS([\"decision tree\",\"handleGroupReceiptBranch\"]);function a(a){var c=a.handleGroupReceipt,e=a.handleGroupRetryReceipt;return function(a){var f=a.from,g=a.aggregate,l=a.receiptType,m=a.makeAck,n=a.offline,o=a.serverTs,p=a.recipient;a=a.socketId;f=f;n=(n=n)!=null?n:null;if(l==null){var q=p==null?\"@me\":p;if(c!=null)return c(babelHelpers[\"extends\"]({makeAck:m,author:q,chat:f,offline:n,serverTs:o},g,{receiptType:\"delivered\"})).then(d(\"WAResultOrError\").makeResult)}else{q=p==null?\"@me\":l.name===\"SenderType\"||l.name===\"ReadSelfType\"?\"@me\":p;switch(l.name){case\"ReadType\":case\"SenderType\":case\"InactiveType\":case\"ReadSelfType\":if(c!=null)return c(babelHelpers[\"extends\"]({makeAck:m,author:q,chat:f,offline:n,serverTs:o},g,{receiptType:d(\"WAMapMixinNameToReceiptType\").mapMixinNameToReceiptType(l.name)})).then(d(\"WAResultOrError\").makeResult);break;case\"Retry\":if(g.aggregatedType!==\"none\"){k.ERROR(j());return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(m()))}if(e!=null){g=d(\"WATransformToRetryReceipt\").transformToRetryReceipt({aggregate:g,retryMixin:l.value,recipient:p,offline:n});return e({receiptType:\"retry\",retryReceipt:g,makeAck:m,author:q,chat:f,offline:n,serverTs:o,socketId:a}).then(d(\"WAResultOrError\").makeResult)}break;case\"PlayedType\":case\"DeliverBizType\":case\"PlayedSelfType\":case\"ServerErrorType\":case\"DeliverLIDFeatureIncapableType\":case\"EngagedType\":case\"DeliverMdDowngradeType\":case\"ViewType\":case\"DeprecatedDeliveryType\":case\"UnknownType\":k.ERROR(i(),l.name);break;default:l.name}}return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(m()))}}g.createHandleGroupReceiptBranch=a}),98);\n__d(\"WACreateHandleIndividualReceiptBranch\",[\"Promise\",\"WAJids\",\"WAMapMixinNameToReceiptType\",\"WAResultOrError\",\"WATagsLogger\",\"WATransformToRetryReceipt\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleIndividualReceipt: receipt type \",\" is not handled yet\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"retry receipt not supported for aggregated messages\"]);j=function(){return a};return a}var k=d(\"WATagsLogger\").TAGS([\"decision tree\",\"handleIndividualMessageBranch\"]);function a(a){var c=a.handleIndividualReceipt,e=a.handleIndividualRetryReceipt;return function(a){var f=a.aggregate,g=a.receiptType,l=a.makeAck,m=a.offline,n=a.serverTs,o=a.recipient;a=a.socketId;m=(m=m)!=null?m:null;var p=f.receiptSender;p=o==null?d(\"WAJids\").extractUserJid(p):o;if(g==null){var q=o==null?\"@me\":o;if(c!=null)return c(babelHelpers[\"extends\"]({makeAck:l,author:q,chat:p,offline:m,serverTs:n},f,{receiptType:\"delivered\"})).then(d(\"WAResultOrError\").makeResult)}else{q=o==null?\"@me\":g.name===\"SenderType\"||g.name===\"ReadSelfType\"?\"@me\":o;switch(g.name){case\"ReadType\":case\"SenderType\":case\"InactiveType\":case\"ReadSelfType\":if(c!=null)return c(babelHelpers[\"extends\"]({makeAck:l,author:q,chat:p,offline:m,serverTs:n},f,{receiptType:d(\"WAMapMixinNameToReceiptType\").mapMixinNameToReceiptType(g.name)})).then(d(\"WAResultOrError\").makeResult);break;case\"Retry\":if(f.aggregatedType!==\"none\"){k.ERROR(j());return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(l()))}if(e!=null){f=d(\"WATransformToRetryReceipt\").transformToRetryReceipt({aggregate:f,retryMixin:g.value,recipient:o,offline:m});return e({receiptType:\"retry\",retryReceipt:f,makeAck:l,author:q,chat:p,offline:m,serverTs:n,socketId:a}).then(d(\"WAResultOrError\").makeResult)}break;case\"PlayedType\":case\"DeliverBizType\":case\"PlayedSelfType\":case\"ServerErrorType\":case\"DeliverLIDFeatureIncapableType\":case\"EngagedType\":case\"DeliverMdDowngradeType\":case\"ViewType\":case\"DeprecatedDeliveryType\":case\"UnknownType\":k.ERROR(i(),g.name);break;default:g.name}}return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(l()))}}g.createHandleIndividualReceiptBranch=a}),98);\n__d(\"WASmaxInReceiptAppDataPeerCategoryMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"category\",\"peer_appdata\");return!b.success?b:d(\"WAResultOrError\").makeResult({category:b.value})}g.parseAppDataPeerCategoryMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverAppDataPeerPeerDeliveryMixin\",[\"WASmaxInReceiptAppDataPeerCategoryMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptAppDataPeerCategoryMixin\").parseAppDataPeerCategoryMixin(a);return!b.success?b:b}g.parseDeliverAppDataPeerPeerDeliveryMixin=a}),98);\n__d(\"WASmaxInReceiptRetryTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"retry\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"retry\");if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrStanzaId(b.value,\"id\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"count\",1,256);if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optionalLiteral(d(\"WASmaxParseUtils\").attrString,b.value,\"v\",\"1\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"t\",0,void 0);if(!g.success)return g;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,b.value,\"error\",0,1024);return!b.success?b:d(\"WAResultOrError\").makeResult({type:a.value,retryId:c.value,retryCount:e.value,retryV:f.value,retryT:g.value,retryError:b.value})}g.parseRetryTypeMixin=a}),98);\n__d(\"WASmaxInReceiptAppDataPeerRetryTypeMixin\",[\"WAResultOrError\",\"WASmaxInReceiptAppDataPeerCategoryMixin\",\"WASmaxInReceiptRetryTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptRetryTypeMixin\").parseRetryTypeMixin(a);if(!b.success)return b;a=d(\"WASmaxInReceiptAppDataPeerCategoryMixin\").parseAppDataPeerCategoryMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,a.value))}g.parseAppDataPeerRetryTypeMixin=a}),98);\n__d(\"WASmaxInReceiptDeviceIdentityMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"device-identity\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentBytes(a.value);return!a.success?a:d(\"WAResultOrError\").makeResult({deviceIdentityElementValue:a.value})}g.parseDeviceIdentityMixin=a}),98);\n__d(\"WASmaxInReceiptKeyDataMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").contentBytesRange(a,32,32);return!a.success?a:d(\"WAResultOrError\").makeResult({elementValue:a.value})}g.parseKeyDataMixin=a}),98);\n__d(\"WASmaxInReceiptIdentityKeyMixin\",[\"WASmaxInReceiptKeyDataMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"identity\");if(!a.success)return a;a=d(\"WASmaxInReceiptKeyDataMixin\").parseKeyDataMixin(a.value);return!a.success?a:a}g.parseIdentityKeyMixin=a}),98);\n__d(\"WASmaxInReceiptKeyTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"type\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentLiteralBytes(a.value,new Uint8Array([5]));return!a.success?a:d(\"WAResultOrError\").makeResult({typeElementValue:a.value})}g.parseKeyTypeMixin=a}),98);\n__d(\"WASmaxInReceiptKeyIDMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"id\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentBytesRange(a,3,3);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}g.parseKeyIDMixin=a}),98);\n__d(\"WASmaxInReceiptPreKeyMixin\",[\"WAResultOrError\",\"WASmaxInReceiptKeyDataMixin\",\"WASmaxInReceiptKeyIDMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"key\");if(!a.success)return a;var b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a.value,\"id\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a.value,\"value\");if(!a.success)return a;b=d(\"WASmaxInReceiptKeyIDMixin\").parseKeyIDMixin(b.value);if(!b.success)return b;a=d(\"WASmaxInReceiptKeyDataMixin\").parseKeyDataMixin(a.value);return!a.success?a:d(\"WAResultOrError\").makeResult({keyIdKeyIDMixin:b.value,keyValueKeyDataMixin:a.value})}g.parsePreKeyMixin=a}),98);\n__d(\"WASmaxInReceiptSignedPreKeyMixin\",[\"WAResultOrError\",\"WASmaxInReceiptKeyDataMixin\",\"WASmaxInReceiptKeyIDMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"skey\");if(!a.success)return a;var b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a.value,\"id\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a.value,\"value\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a.value,\"signature\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentBytesRange(a.value,64,64);if(!a.success)return a;b=d(\"WASmaxInReceiptKeyIDMixin\").parseKeyIDMixin(b.value);if(!b.success)return b;c=d(\"WASmaxInReceiptKeyDataMixin\").parseKeyDataMixin(c.value);return!c.success?c:d(\"WAResultOrError\").makeResult({skeySignatureElementValue:a.value,skeyIdKeyIDMixin:b.value,skeyValueKeyDataMixin:c.value})}g.parseSignedPreKeyMixin=a}),98);\n__d(\"WASmaxInReceiptKeyBundleMixin\",[\"WAResultOrError\",\"WASmaxInReceiptDeviceIdentityMixin\",\"WASmaxInReceiptIdentityKeyMixin\",\"WASmaxInReceiptKeyTypeMixin\",\"WASmaxInReceiptPreKeyMixin\",\"WASmaxInReceiptSignedPreKeyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"keys\");if(!b.success)return b;a=d(\"WASmaxInReceiptKeyTypeMixin\").parseKeyTypeMixin(b.value);if(!a.success)return a;var c=d(\"WASmaxInReceiptIdentityKeyMixin\").parseIdentityKeyMixin(b.value);if(!c.success)return c;var e=d(\"WASmaxInReceiptSignedPreKeyMixin\").parseSignedPreKeyMixin(b.value);if(!e.success)return e;var f=d(\"WASmaxInReceiptPreKeyMixin\").parsePreKeyMixin(b.value);if(!f.success)return f;b=d(\"WASmaxInReceiptDeviceIdentityMixin\").parseDeviceIdentityMixin(b.value);return d(\"WAResultOrError\").makeResult({keysKeyTypeMixin:a.value,keysIdentityKeyMixin:c.value,keysSignedPreKeyMixin:e.value,keysPreKeyMixin:f.value,keysDeviceIdentityMixin:b.success?b.value:null})}g.parseKeyBundleMixin=a}),98);\n__d(\"WASmaxInReceiptRegistrationIDMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"registration\");if(!a.success)return a;a=d(\"WASmaxParseUtils\").contentBytesRange(a.value,4,4);return!a.success?a:d(\"WAResultOrError\").makeResult({registrationElementValue:a.value})}g.parseRegistrationIDMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverAppDataPeerPeerRetryMixin\",[\"WAResultOrError\",\"WASmaxInReceiptAppDataPeerRetryTypeMixin\",\"WASmaxInReceiptKeyBundleMixin\",\"WASmaxInReceiptRegistrationIDMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptAppDataPeerRetryTypeMixin\").parseAppDataPeerRetryTypeMixin(a);if(!b.success)return b;var c=d(\"WASmaxInReceiptRegistrationIDMixin\").parseRegistrationIDMixin(a);if(!c.success)return c;a=d(\"WASmaxInReceiptKeyBundleMixin\").parseKeyBundleMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,c.value,{keyBundleMixin:a.success?a.value:null}))}g.parseDeliverAppDataPeerPeerRetryMixin=a}),98);\n__d(\"WASmaxInReceiptPeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup\",[\"WAResultOrError\",\"WASmaxInReceiptDeliverAppDataPeerPeerDeliveryMixin\",\"WASmaxInReceiptDeliverAppDataPeerPeerRetryMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptDeliverAppDataPeerPeerRetryMixin\").parseDeliverAppDataPeerPeerRetryMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverAppDataPeerPeerRetry\",value:b.value});var c=d(\"WASmaxInReceiptDeliverAppDataPeerPeerDeliveryMixin\").parseDeliverAppDataPeerPeerDeliveryMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"DeliverAppDataPeerPeerDelivery\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"PeerRetry\",\"PeerDelivery\"],[b,c])}g.parsePeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup=a}),98);\n__d(\"WASmaxInReceiptDeliverAppDataPeerRequest\",[\"WAResultOrError\",\"WASmaxInReceiptPeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").attrDeviceJid(a,\"from\");if(!c.success)return c;a=d(\"WASmaxInReceiptPeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup\").parsePeerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult({id:b.value,from:c.value,peerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup:a.value})}g.parseDeliverAppDataPeerRequest=a}),98);\n__d(\"WASmaxOutReceiptDeliverAppDataPeerResponseSuccess\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrDeviceJid,a,[\"from\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),\"class\":\"receipt\",to:d(\"WAWap\").DEVICE_JID(c.value),type:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").CUSTOM_STRING,a.value)});return b}g.makeDeliverAppDataPeerResponseSuccess=a}),98);\n__d(\"WASmaxReceiptDeliverAppDataPeerRPC\",[\"WASmaxInReceiptDeliverAppDataPeerRequest\",\"WASmaxOutReceiptDeliverAppDataPeerResponseSuccess\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptDeliverAppDataPeerRequest\").parseDeliverAppDataPeerRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"DeliverAppDataPeer\",{Request:b}));return{parsedRequest:b.value,makeDeliverAppDataPeerResponseSuccess:function(){return d(\"WASmaxOutReceiptDeliverAppDataPeerResponseSuccess\").makeDeliverAppDataPeerResponseSuccess(a)}}}g.receiveDeliverAppDataPeerRPC=a}),98);\n__d(\"WACreateHandlePeerAppdataReceiptBranch\",[\"Promise\",\"WAParseKeyBundleMixing\",\"WAResultOrError\",\"WASignalOther\",\"WASmaxReceiptDeliverAppDataPeerRPC\",\"WATagsLogger\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Peer appdata receipt is not handled.\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"start...\"]);j=function(){return a};return a}var k=d(\"WATagsLogger\").TAGS([\"decision tree\",\"handlePeerAppdataReceiptBranch\"]);function a(a){var c=a.handlePeerAppdataReceipt,e=a.handlePeerAppdataRetryReceipt;return function(a,f){k.DEV(j());a=d(\"WASmaxReceiptDeliverAppDataPeerRPC\").receiveDeliverAppDataPeerRPC(a);var g=a.parsedRequest,l=g.id,m=g.from;g=g.peerDeliverAppDataPeerRetryOrDeliverAppDataPeerDeliveryMixinGroup;a=a.makeDeliverAppDataPeerResponseSuccess;switch(g.name){case\"DeliverAppDataPeerPeerDelivery\":if(c!=null)return c({receiptType:\"delivered\",stanzaId:l,receiptSender:m,makeAck:a}).then(d(\"WAResultOrError\").makeResult);break;case\"DeliverAppDataPeerPeerRetry\":if(e!=null){var n=g.value,o=n.keyBundleMixin,p=n.registrationElementValue,q=n.retryCount,r=n.retryId,s=n.retryT;n=n.category;p=d(\"WASignalOther\").castRegistrationIdFromBytes(p);return e({receiptType:\"retry\",category:n,retryReceipt:{stanzaId:l,retryStanzaId:r,receiptSender:m,retryCount:q,regId:p,timestamp:d(\"WATimeUtils\").castToUnixTime(s),keys:o?d(\"WAParseKeyBundleMixing\").parseKeyBundleMixin(p,o):null},makeAck:a,socketId:f}).then(d(\"WAResultOrError\").makeResult)}break;default:g.name}k.WARN(i());return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(a()))}}g.createHandlePeerAppdataReceiptBranch=a}),98);\n__d(\"WASmaxInReceiptPeerMessageTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"peer_msg\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parsePeerMessageTypeMixin=a}),98);\n__d(\"WASmaxInReceiptSingleMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");return!b.success?b:d(\"WAResultOrError\").makeResult({id:b.value})}g.parseSingleMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverPeerDeliveryMixin\",[\"WAResultOrError\",\"WASmaxInReceiptPeerMessageTypeMixin\",\"WASmaxInReceiptSingleMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptSingleMixin\").parseSingleMixin(a);if(!b.success)return b;a=d(\"WASmaxInReceiptPeerMessageTypeMixin\").parsePeerMessageTypeMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,a.value))}g.parseDeliverPeerDeliveryMixin=a}),98);\n__d(\"WASmaxInReceiptHSMErrorTypeMixin\",[\"WAResultOrError\",\"WASmaxInReceiptEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"error\");if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"type\",d(\"WASmaxInReceiptEnums\").ENUM_HSMENVELOPEMISMATCH_STRUCTUREUNAVAILABLE);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,b.value,\"reason\",d(\"WASmaxInReceiptEnums\").ENUM_1002_1007_1008);if(!e.success)return e;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrStringEnum,b.value,\"sub_type\",d(\"WASmaxInReceiptEnums\").ENUM_CONTENT_TITLE);return!b.success?b:d(\"WAResultOrError\").makeResult({type:a.value,errorType:c.value,errorReason:e.value,errorSubType:b.value})}g.parseHSMErrorTypeMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverPeerErrorMixin\",[\"WAResultOrError\",\"WASmaxInReceiptHSMErrorTypeMixin\",\"WASmaxInReceiptSingleMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptSingleMixin\").parseSingleMixin(a);if(!b.success)return b;a=d(\"WASmaxInReceiptHSMErrorTypeMixin\").parseHSMErrorTypeMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,a.value))}g.parseDeliverPeerErrorMixin=a}),98);\n__d(\"WASmaxInReceiptPeerCategoryMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"category\",\"peer\");return!b.success?b:d(\"WAResultOrError\").makeResult({category:b.value})}g.parsePeerCategoryMixin=a}),98);\n__d(\"WASmaxInReceiptPeerRetryTypeMixin\",[\"WAResultOrError\",\"WASmaxInReceiptPeerCategoryMixin\",\"WASmaxInReceiptRetryTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptRetryTypeMixin\").parseRetryTypeMixin(a);if(!b.success)return b;a=d(\"WASmaxInReceiptPeerCategoryMixin\").parsePeerCategoryMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,a.value))}g.parsePeerRetryTypeMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverPeerPeerRetryMixin\",[\"WAResultOrError\",\"WASmaxInReceiptKeyBundleMixin\",\"WASmaxInReceiptPeerRetryTypeMixin\",\"WASmaxInReceiptRegistrationIDMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptPeerRetryTypeMixin\").parsePeerRetryTypeMixin(a);if(!b.success)return b;var c=d(\"WASmaxInReceiptRegistrationIDMixin\").parseRegistrationIDMixin(a);if(!c.success)return c;a=d(\"WASmaxInReceiptKeyBundleMixin\").parseKeyBundleMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,c.value,{keyBundleMixin:a.success?a.value:null}))}g.parseDeliverPeerPeerRetryMixin=a}),98);\n__d(\"WASmaxInReceiptHistorySyncTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"hist_sync\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseHistorySyncTypeMixin=a}),98);\n__d(\"WASmaxInReceiptOfflineMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrIntRange(a,\"offline\",0,12);return!a.success?a:d(\"WAResultOrError\").makeResult({offline:a.value})}g.parseOfflineMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverPeerReadMixin\",[\"WAResultOrError\",\"WASmaxInReceiptHistorySyncTypeMixin\",\"WASmaxInReceiptOfflineMixin\",\"WASmaxInReceiptSingleMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptSingleMixin\").parseSingleMixin(a);if(!b.success)return b;var c=d(\"WASmaxInReceiptHistorySyncTypeMixin\").parseHistorySyncTypeMixin(a);if(!c.success)return c;a=d(\"WASmaxInReceiptOfflineMixin\").parseOfflineMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,c.value,{offlineMixin:a.success?a.value:null}))}g.parseDeliverPeerReadMixin=a}),98);\n__d(\"WASmaxInReceiptEncryptMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"encrypt\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"enc_p\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"enc_iv\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").contentBytesRange(a.value,1,600);if(!a.success)return a;b=d(\"WASmaxParseUtils\").contentBytesRange(b.value,12,12);return!b.success?b:d(\"WAResultOrError\").makeResult({encryptEncPElementValue:a.value,encryptEncIvElementValue:b.value})}g.parseEncryptMixin=a}),98);\n__d(\"WASmaxInReceiptRmrBroadcastDeprecatedMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"rmr\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrBroadcastJid(a,\"jid\");return!b.success?b:d(\"WAResultOrError\").makeResult({jid:b.value})}g.parseRmrBroadcastDeprecatedMixin=a}),98);\n__d(\"WASmaxInReceiptRmrBroadcastMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"rmr\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrBroadcastJid(a,\"jid\");if(!b.success)return b;a=d(\"WASmaxParseJid\").attrUserJid(a,\"participant\");return!a.success?a:d(\"WAResultOrError\").makeResult({jid:b.value,participant:a.value})}g.parseRmrBroadcastMixin=a}),98);\n__d(\"WASmaxInReceiptRmrGroupDeprecatedMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"rmr\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrGroupJid(a,\"jid\");return!b.success?b:d(\"WAResultOrError\").makeResult({jid:b.value})}g.parseRmrGroupDeprecatedMixin=a}),98);\n__d(\"WASmaxInReceiptRmrGroupMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"rmr\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrGroupJid(a,\"jid\");if(!b.success)return b;a=d(\"WASmaxParseJid\").attrUserJid(a,\"participant\");return!a.success?a:d(\"WAResultOrError\").makeResult({jid:b.value,participant:a.value})}g.parseRmrGroupMixin=a}),98);\n__d(\"WASmaxInReceiptRmrIndividualDeprecatedMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"rmr\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"jid\");if(!b.success)return b;a=d(\"WASmaxParseJid\").attrUserJid(a,\"participant\");return!a.success?a:d(\"WAResultOrError\").makeResult({jid:b.value,participant:a.value})}g.parseRmrIndividualDeprecatedMixin=a}),98);\n__d(\"WASmaxInReceiptRmrIndividualMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"rmr\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"jid\");return!b.success?b:d(\"WAResultOrError\").makeResult({jid:b.value})}g.parseRmrIndividualMixin=a}),98);\n__d(\"WASmaxInReceiptServerErrorRmrTypes\",[\"WAResultOrError\",\"WASmaxInReceiptRmrBroadcastDeprecatedMixin\",\"WASmaxInReceiptRmrBroadcastMixin\",\"WASmaxInReceiptRmrGroupDeprecatedMixin\",\"WASmaxInReceiptRmrGroupMixin\",\"WASmaxInReceiptRmrIndividualDeprecatedMixin\",\"WASmaxInReceiptRmrIndividualMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptRmrBroadcastMixin\").parseRmrBroadcastMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"RmrBroadcast\",value:b.value});var c=d(\"WASmaxInReceiptRmrGroupMixin\").parseRmrGroupMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"RmrGroup\",value:c.value});var e=d(\"WASmaxInReceiptRmrIndividualDeprecatedMixin\").parseRmrIndividualDeprecatedMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"RmrIndividualDeprecated\",value:e.value});var f=d(\"WASmaxInReceiptRmrIndividualMixin\").parseRmrIndividualMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"RmrIndividual\",value:f.value});var g=d(\"WASmaxInReceiptRmrGroupDeprecatedMixin\").parseRmrGroupDeprecatedMixin(a);if(g.success)return d(\"WAResultOrError\").makeResult({name:\"RmrGroupDeprecated\",value:g.value});var h=d(\"WASmaxInReceiptRmrBroadcastDeprecatedMixin\").parseRmrBroadcastDeprecatedMixin(a);return h.success?d(\"WAResultOrError\").makeResult({name:\"RmrBroadcastDeprecated\",value:h.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"RmrBroadcast\",\"RmrGroup\",\"RmrIndividualDeprecated\",\"RmrIndividual\",\"RmrGroupDeprecated\",\"RmrBroadcastDeprecated\"],[b,c,e,f,g,h])}g.parseServerErrorRmrTypes=a}),98);\n__d(\"WASmaxInReceiptServerErrorTypeMixin\",[\"WAResultOrError\",\"WASmaxInReceiptEncryptMixin\",\"WASmaxInReceiptEnums\",\"WASmaxInReceiptServerErrorRmrTypes\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"rmr\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"from_me\",d(\"WASmaxInReceiptEnums\").ENUM_FALSE_TRUE);if(!b.success)return b;a=d(\"WASmaxInReceiptServerErrorRmrTypes\").parseServerErrorRmrTypes(a);return!a.success?a:d(\"WAResultOrError\").makeResult({fromMe:b.value,serverErrorRmrTypes:a.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"rmr\",h);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"server-error\");if(!c.success)return c;a=d(\"WASmaxInReceiptEncryptMixin\").parseEncryptMixin(a);return d(\"WAResultOrError\").makeResult({type:c.value,encryptMixin:a.success?a.value:null,rmr:b.value})}g.parseServerErrorTypeRmr=h;g.parseServerErrorTypeMixin=a}),98);\n__d(\"WASmaxInReceiptPeerServerErrorTypeMixin\",[\"WAResultOrError\",\"WASmaxInReceiptPeerCategoryMixin\",\"WASmaxInReceiptServerErrorTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptServerErrorTypeMixin\").parseServerErrorTypeMixin(a);if(!b.success)return b;a=d(\"WASmaxInReceiptPeerCategoryMixin\").parsePeerCategoryMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,a.value))}g.parsePeerServerErrorTypeMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverPeerServerErrorMixin\",[\"WAResultOrError\",\"WASmaxInReceiptPeerServerErrorTypeMixin\",\"WASmaxInReceiptSingleMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptSingleMixin\").parseSingleMixin(a);if(!b.success)return b;a=d(\"WASmaxInReceiptPeerServerErrorTypeMixin\").parsePeerServerErrorTypeMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,a.value))}g.parseDeliverPeerServerErrorMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverPeerReceiptType\",[\"WAResultOrError\",\"WASmaxInReceiptDeliverPeerDeliveryMixin\",\"WASmaxInReceiptDeliverPeerErrorMixin\",\"WASmaxInReceiptDeliverPeerPeerRetryMixin\",\"WASmaxInReceiptDeliverPeerReadMixin\",\"WASmaxInReceiptDeliverPeerServerErrorMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptDeliverPeerPeerRetryMixin\").parseDeliverPeerPeerRetryMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverPeerPeerRetry\",value:b.value});var c=d(\"WASmaxInReceiptDeliverPeerReadMixin\").parseDeliverPeerReadMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverPeerRead\",value:c.value});var e=d(\"WASmaxInReceiptDeliverPeerServerErrorMixin\").parseDeliverPeerServerErrorMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverPeerServerError\",value:e.value});var f=d(\"WASmaxInReceiptDeliverPeerErrorMixin\").parseDeliverPeerErrorMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverPeerError\",value:f.value});var g=d(\"WASmaxInReceiptDeliverPeerDeliveryMixin\").parseDeliverPeerDeliveryMixin(a);return g.success?d(\"WAResultOrError\").makeResult({name:\"DeliverPeerDelivery\",value:g.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"PeerRetry\",\"Read\",\"ServerError\",\"Error\",\"Delivery\"],[b,c,e,f,g])}g.parseDeliverPeerReceiptType=a}),98);\n__d(\"WASmaxInReceiptDeliverPeerRequest\",[\"WAResultOrError\",\"WASmaxInReceiptDeliverPeerReceiptType\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!b.success)return b;var c=d(\"WASmaxParseJid\").attrDeviceJid(a,\"from\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"t\",0,void 0);if(!e.success)return e;a=d(\"WASmaxInReceiptDeliverPeerReceiptType\").parseDeliverPeerReceiptType(a);return!a.success?a:d(\"WAResultOrError\").makeResult({id:b.value,from:c.value,t:e.value,deliverPeerReceiptType:a.value})}g.parseDeliverPeerRequest=a}),98);\n__d(\"WASmaxOutReceiptDeliverPeerResponseSuccess\",[\"WASmaxJsx\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrDeviceJid,a,[\"from\"]);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);a=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),\"class\":\"receipt\",to:d(\"WAWap\").DEVICE_JID(c.value),type:d(\"WAWap\").CUSTOM_STRING(a.value)});return b}g.makeDeliverPeerResponseSuccess=a}),98);\n__d(\"WASmaxReceiptDeliverPeerRPC\",[\"WASmaxInReceiptDeliverPeerRequest\",\"WASmaxOutReceiptDeliverPeerResponseSuccess\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptDeliverPeerRequest\").parseDeliverPeerRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"DeliverPeer\",{Request:b}));return{parsedRequest:b.value,makeDeliverPeerResponseSuccess:function(){return d(\"WASmaxOutReceiptDeliverPeerResponseSuccess\").makeDeliverPeerResponseSuccess(a)}}}g.receiveDeliverPeerRPC=a}),98);\n__d(\"WASmaxInReceiptMessageAggregatedMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"user\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrDeviceJid(a,\"jid\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({jid:b.value,t:a.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"participants\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrStanzaId(b.value,\"key\");if(!c.success)return c;b=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"user\",1,1024,h);return!b.success?b:d(\"WAResultOrError\").makeResult({id:a.value,participantsKey:c.value,participantsUser:b.value})}g.parseMessageAggregatedParticipantsUser=h;g.parseMessageAggregatedMixin=a}),98);\n__d(\"WASmaxInReceiptInactiveTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"inactive\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseInactiveTypeMixin=a}),98);\n__d(\"WASmaxInReceiptPlayedSelfTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"played-self\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parsePlayedSelfTypeMixin=a}),98);\n__d(\"WASmaxInReceiptPlayedTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"played\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parsePlayedTypeMixin=a}),98);\n__d(\"WASmaxInReceiptReadSelfTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"read-self\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseReadSelfTypeMixin=a}),98);\n__d(\"WASmaxInReceiptReadTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"read\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseReadTypeMixin=a}),98);\n__d(\"WASmaxInReceiptSenderTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"sender\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseSenderTypeMixin=a}),98);\n__d(\"WASmaxInReceiptUnknownTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"type\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseUnknownTypeMixin=a}),98);\n__d(\"WASmaxInReceiptMessageAggregatedStyleReceiptType\",[\"WAResultOrError\",\"WASmaxInReceiptInactiveTypeMixin\",\"WASmaxInReceiptPlayedSelfTypeMixin\",\"WASmaxInReceiptPlayedTypeMixin\",\"WASmaxInReceiptReadSelfTypeMixin\",\"WASmaxInReceiptReadTypeMixin\",\"WASmaxInReceiptSenderTypeMixin\",\"WASmaxInReceiptUnknownTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptSenderTypeMixin\").parseSenderTypeMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"SenderType\",value:b.value});var c=d(\"WASmaxInReceiptInactiveTypeMixin\").parseInactiveTypeMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"InactiveType\",value:c.value});var e=d(\"WASmaxInReceiptReadTypeMixin\").parseReadTypeMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"ReadType\",value:e.value});var f=d(\"WASmaxInReceiptReadSelfTypeMixin\").parseReadSelfTypeMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"ReadSelfType\",value:f.value});var g=d(\"WASmaxInReceiptPlayedTypeMixin\").parsePlayedTypeMixin(a);if(g.success)return d(\"WAResultOrError\").makeResult({name:\"PlayedType\",value:g.value});var h=d(\"WASmaxInReceiptPlayedSelfTypeMixin\").parsePlayedSelfTypeMixin(a);if(h.success)return d(\"WAResultOrError\").makeResult({name:\"PlayedSelfType\",value:h.value});var i=d(\"WASmaxInReceiptUnknownTypeMixin\").parseUnknownTypeMixin(a);return i.success?d(\"WAResultOrError\").makeResult({name:\"UnknownType\",value:i.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"SenderType\",\"InactiveType\",\"ReadType\",\"ReadSelfType\",\"PlayedType\",\"PlayedSelfType\",\"UnknownType\"],[b,c,e,f,g,h,i])}g.parseMessageAggregatedStyleReceiptType=a}),98);\n__d(\"WASmaxInReceiptRecipientMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"recipient\");return!b.success?b:d(\"WAResultOrError\").makeResult({recipient:b.value})}g.parseRecipientMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverMessageAggregatedStyleMixin\",[\"WAResultOrError\",\"WASmaxInReceiptEnums\",\"WASmaxInReceiptMessageAggregatedMixin\",\"WASmaxInReceiptMessageAggregatedStyleReceiptType\",\"WASmaxInReceiptRecipientMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrJidEnum(a,\"from\",d(\"WASmaxInReceiptEnums\").BROADCASTJID_GROUPJID_NEWSLETTERJID_STATUSJID);if(!b.success)return b;var c=d(\"WASmaxInReceiptRecipientMixin\").parseRecipientMixin(a),e=d(\"WASmaxInReceiptMessageAggregatedMixin\").parseMessageAggregatedMixin(a);if(!e.success)return e;a=d(\"WASmaxInReceiptMessageAggregatedStyleReceiptType\").parseMessageAggregatedStyleReceiptType(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:b.value,recipientMixin:c.success?c.value:null},e.value,{messageAggregatedStyleReceiptType:a.success?a.value:null}))}g.parseDeliverMessageAggregatedStyleMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverBizRolesMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"actual_actors\",0,100);if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"host_storage\",0,100);if(!c.success)return c;b=d(\"WASmaxParseUtils\").attrIntRange(b.value,\"privacy_mode_ts\",0,void 0);return!b.success?b:d(\"WAResultOrError\").makeResult({bizActualActors:a.value,bizHostStorage:c.value,bizPrivacyModeTs:b.value})}g.parseDeliverBizRolesMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverPaidConversationAggregatedMixin\",[\"WAResultOrError\",\"WASmaxInReceiptEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"delivery_context\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"optimization_goal\",d(\"WASmaxInReceiptEnums\").ENUM_DELIVERY_NOOPTIMIZATION);return!b.success?b:d(\"WAResultOrError\").makeResult({optimizationGoal:b.value})}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"source_url\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentString(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function j(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"referral\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"source_url\",i);if(!b.success)return b;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"source_type\");return!a.success?a:d(\"WAResultOrError\").makeResult({sourceType:a.value,sourceUrl:b.value})}function k(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"origin\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"referral\",j);if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrString(a,\"type\");return!a.success?a:d(\"WAResultOrError\").makeResult({type:a.value,referral:b.value})}function l(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"item\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"delivery_context\",h);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"origin\",k);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").attrString(a,\"paid_convo_id\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").attrStringEnum(a,\"pricing_model\",d(\"WASmaxInReceiptEnums\").ENUM_CBP_NBP);if(!g.success)return g;var i=d(\"WASmaxParseUtils\").attrStringEnum(a,\"billable\",d(\"WASmaxInReceiptEnums\").ENUM_FALSE_TRUE);if(!i.success)return i;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"pricing_category\");return!a.success?a:d(\"WAResultOrError\").makeResult({id:e.value,paidConvoId:f.value,pricingModel:g.value,billable:i.value,pricingCategory:a.value,deliveryContext:b.value,origin:c.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").flattenedChildWithTag(b.value,\"paid_messaging\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").mapChildrenWithTag(a.value,\"item\",0,128e3,l);return!b.success?b:d(\"WAResultOrError\").makeResult({bizPaidMessagingItem:b.value})}g.parseDeliverPaidConversationAggregatedBizPaidMessagingItemDeliveryContext=h;g.parseDeliverPaidConversationAggregatedBizPaidMessagingItemOriginReferralSourceUrl=i;g.parseDeliverPaidConversationAggregatedBizPaidMessagingItemOriginReferral=j;g.parseDeliverPaidConversationAggregatedBizPaidMessagingItemOrigin=k;g.parseDeliverPaidConversationAggregatedBizPaidMessagingItem=l;g.parseDeliverPaidConversationAggregatedMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverSenderPNMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"sender_pn\");return!b.success?b:d(\"WAResultOrError\").makeResult({senderPn:b.value})}g.parseDeliverSenderPNMixin=a}),98);\n__d(\"WASmaxInReceiptBroadcastMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrBroadcastJid(a,\"from\");if(!b.success)return b;a=d(\"WASmaxParseJid\").attrDeviceJid(a,\"participant\");return!a.success?a:d(\"WAResultOrError\").makeResult({from:b.value,participant:a.value})}g.parseBroadcastMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverStatusMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrStatusJid(a,\"from\");if(!b.success)return b;a=d(\"WASmaxParseJid\").attrDeviceJid(a,\"participant\");return!a.success?a:d(\"WAResultOrError\").makeResult({from:b.value,participant:a.value})}g.parseDeliverStatusMixin=a}),98);\n__d(\"WASmaxInReceiptGroupMixin\",[\"WAResultOrError\",\"WASmaxInReceiptEnums\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrGroupJid(a,\"from\");if(!b.success)return b;a=d(\"WASmaxParseJid\").attrJidEnum(a,\"participant\",d(\"WASmaxInReceiptEnums\").DEVICEJID_DEVICEJID);return!a.success?a:d(\"WAResultOrError\").makeResult({from:b.value,participant:a.value})}g.parseGroupMixin=a}),98);\n__d(\"WASmaxInReceiptIndividualMixin\",[\"WAResultOrError\",\"WASmaxInReceiptEnums\",\"WASmaxInReceiptRecipientMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrJidEnum(a,\"from\",d(\"WASmaxInReceiptEnums\").DEVICEJID_DEVICEJID);if(!b.success)return b;a=d(\"WASmaxInReceiptRecipientMixin\").parseRecipientMixin(a);return d(\"WAResultOrError\").makeResult({from:b.value,recipientMixin:a.success?a.value:null})}g.parseIndividualMixin=a}),98);\n__d(\"WASmaxInReceiptIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup\",[\"WAResultOrError\",\"WASmaxInReceiptBroadcastMixin\",\"WASmaxInReceiptDeliverStatusMixin\",\"WASmaxInReceiptGroupMixin\",\"WASmaxInReceiptIndividualMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptIndividualMixin\").parseIndividualMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"Individual\",value:b.value});var c=d(\"WASmaxInReceiptGroupMixin\").parseGroupMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"Group\",value:c.value});var e=d(\"WASmaxInReceiptDeliverStatusMixin\").parseDeliverStatusMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverStatus\",value:e.value});var f=d(\"WASmaxInReceiptBroadcastMixin\").parseBroadcastMixin(a);return f.success?d(\"WAResultOrError\").makeResult({name:\"Broadcast\",value:f.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Individual\",\"Group\",\"Status\",\"Broadcast\"],[b,c,e,f])}g.parseIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup=a}),98);\n__d(\"WASmaxInReceiptSenderAggregatedDeliverMixin\",[\"WAResultOrError\",\"WASmaxInReceiptDeprecatedEditMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"item\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!b.success)return b;a=d(\"WASmaxInReceiptDeprecatedEditMixin\").parseDeprecatedEditMixin(a);return d(\"WAResultOrError\").makeResult({id:b.value,deprecatedEditMixin:a.success?a.value:null})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"list\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"item\",0,128e3,h);return!b.success?b:d(\"WAResultOrError\").makeResult({id:a.value,listItem:b.value})}g.parseSenderAggregatedDeliverListItem=h;g.parseSenderAggregatedDeliverMixin=a}),98);\n__d(\"WASmaxInReceiptDeprecatedDeliveryTypeMixin\",[\"WAResultOrError\",\"WASmaxInReceiptEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"type\",d(\"WASmaxInReceiptEnums\").ENUM_DELIVER_DELIVERY);return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseDeprecatedDeliveryTypeMixin=a}),98);\n__d(\"WASmaxInReceiptViewTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"view\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseViewTypeMixin=a}),98);\n__d(\"WASmaxInReceiptSenderAggregatedStyleReceiptType\",[\"WAResultOrError\",\"WASmaxInReceiptDeprecatedDeliveryTypeMixin\",\"WASmaxInReceiptInactiveTypeMixin\",\"WASmaxInReceiptPlayedSelfTypeMixin\",\"WASmaxInReceiptPlayedTypeMixin\",\"WASmaxInReceiptReadSelfTypeMixin\",\"WASmaxInReceiptReadTypeMixin\",\"WASmaxInReceiptUnknownTypeMixin\",\"WASmaxInReceiptViewTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptInactiveTypeMixin\").parseInactiveTypeMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"InactiveType\",value:b.value});var c=d(\"WASmaxInReceiptReadTypeMixin\").parseReadTypeMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"ReadType\",value:c.value});var e=d(\"WASmaxInReceiptReadSelfTypeMixin\").parseReadSelfTypeMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"ReadSelfType\",value:e.value});var f=d(\"WASmaxInReceiptPlayedTypeMixin\").parsePlayedTypeMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"PlayedType\",value:f.value});var g=d(\"WASmaxInReceiptPlayedSelfTypeMixin\").parsePlayedSelfTypeMixin(a);if(g.success)return d(\"WAResultOrError\").makeResult({name:\"PlayedSelfType\",value:g.value});var h=d(\"WASmaxInReceiptViewTypeMixin\").parseViewTypeMixin(a);if(h.success)return d(\"WAResultOrError\").makeResult({name:\"ViewType\",value:h.value});var i=d(\"WASmaxInReceiptDeprecatedDeliveryTypeMixin\").parseDeprecatedDeliveryTypeMixin(a);if(i.success)return d(\"WAResultOrError\").makeResult({name:\"DeprecatedDeliveryType\",value:i.value});var j=d(\"WASmaxInReceiptUnknownTypeMixin\").parseUnknownTypeMixin(a);return j.success?d(\"WAResultOrError\").makeResult({name:\"UnknownType\",value:j.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"InactiveType\",\"ReadType\",\"ReadSelfType\",\"PlayedType\",\"PlayedSelfType\",\"ViewType\",\"DeprecatedDeliveryType\",\"UnknownType\"],[b,c,e,f,g,h,i,j])}g.parseSenderAggregatedStyleReceiptType=a}),98);\n__d(\"WASmaxInReceiptDeliverSenderAggregatedStyleMixin\",[\"WAResultOrError\",\"WASmaxInReceiptDeliverBizRolesMixin\",\"WASmaxInReceiptDeliverPaidConversationAggregatedMixin\",\"WASmaxInReceiptDeliverSenderPNMixin\",\"WASmaxInReceiptIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup\",\"WASmaxInReceiptRecipientMixin\",\"WASmaxInReceiptSenderAggregatedDeliverMixin\",\"WASmaxInReceiptSenderAggregatedStyleReceiptType\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptRecipientMixin\").parseRecipientMixin(a);var c=d(\"WASmaxInReceiptSenderAggregatedDeliverMixin\").parseSenderAggregatedDeliverMixin(a);if(!c.success)return c;var e=d(\"WASmaxInReceiptDeliverPaidConversationAggregatedMixin\").parseDeliverPaidConversationAggregatedMixin(a),f=d(\"WASmaxInReceiptDeliverBizRolesMixin\").parseDeliverBizRolesMixin(a),g=d(\"WASmaxInReceiptDeliverSenderPNMixin\").parseDeliverSenderPNMixin(a),h=d(\"WASmaxInReceiptIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup\").parseIndividualOrGroupOrDeliverStatusOrBroadcastMixinGroup(a);if(!h.success)return h;a=d(\"WASmaxInReceiptSenderAggregatedStyleReceiptType\").parseSenderAggregatedStyleReceiptType(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({recipientMixin:b.success?b.value:null},c.value,{deliverPaidConversationAggregatedMixin:e.success?e.value:null,deliverBizRolesMixin:f.success?f.value:null,deliverSenderPNMixin:g.success?g.value:null,individualOrGroupOrDeliverStatusOrBroadcastMixinGroup:h.value,senderAggregatedStyleReceiptType:a.success?a.value:null}))}g.parseDeliverSenderAggregatedStyleMixin=a}),98);\n__d(\"WASmaxInReceiptIndividualWithRecipientMixin\",[\"WAResultOrError\",\"WASmaxInReceiptRecipientMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrDeviceJid(a,\"from\");if(!b.success)return b;a=d(\"WASmaxInReceiptRecipientMixin\").parseRecipientMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({from:b.value},a.value))}g.parseIndividualWithRecipientMixin=a}),98);\n__d(\"WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup\",[\"WAResultOrError\",\"WASmaxInReceiptBroadcastMixin\",\"WASmaxInReceiptDeliverStatusMixin\",\"WASmaxInReceiptGroupMixin\",\"WASmaxInReceiptIndividualWithRecipientMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptIndividualWithRecipientMixin\").parseIndividualWithRecipientMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"IndividualWithRecipient\",value:b.value});var c=d(\"WASmaxInReceiptGroupMixin\").parseGroupMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"Group\",value:c.value});var e=d(\"WASmaxInReceiptDeliverStatusMixin\").parseDeliverStatusMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverStatus\",value:e.value});var f=d(\"WASmaxInReceiptBroadcastMixin\").parseBroadcastMixin(a);return f.success?d(\"WAResultOrError\").makeResult({name:\"Broadcast\",value:f.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"IndividualWithRecipient\",\"Group\",\"Status\",\"Broadcast\"],[b,c,e,f])}g.parseIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup=a}),98);\n__d(\"WASmaxInReceiptDeliverSenderAggregatedStyleSenderTypeMixin\",[\"WAResultOrError\",\"WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup\",\"WASmaxInReceiptSenderAggregatedDeliverMixin\",\"WASmaxInReceiptSenderTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptSenderAggregatedDeliverMixin\").parseSenderAggregatedDeliverMixin(a);if(!b.success)return b;var c=d(\"WASmaxInReceiptSenderTypeMixin\").parseSenderTypeMixin(a);if(!c.success)return c;a=d(\"WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup\").parseIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,c.value,{individualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup:a.value}))}g.parseDeliverSenderAggregatedStyleSenderTypeMixin=a}),98);\n__d(\"WASmaxInReceiptNewsletterDeliverMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrNewsletterJid(a,\"from\");if(!b.success)return b;a=d(\"WASmaxParseJid\").attrDeviceJid(a,\"participant\");return!a.success?a:d(\"WAResultOrError\").makeResult({from:b.value,participant:a.value})}g.parseNewsletterDeliverMixin=a}),98);\n__d(\"WASmaxInReceiptSenderAggregatedDeliverServerIDMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"item\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"server_id\",99,2147476647);return!b.success?b:d(\"WAResultOrError\").makeResult({serverId:b.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"list\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStanzaId(a,\"id\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").mapChildrenWithTag(b.value,\"item\",0,128e3,h);return!b.success?b:d(\"WAResultOrError\").makeResult({id:a.value,listItem:b.value})}g.parseSenderAggregatedDeliverServerIDListItem=h;g.parseSenderAggregatedDeliverServerIDMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverSenderAggregatedStyleViewTypeMixin\",[\"WAResultOrError\",\"WASmaxInReceiptNewsletterDeliverMixin\",\"WASmaxInReceiptSenderAggregatedDeliverServerIDMixin\",\"WASmaxInReceiptViewTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptNewsletterDeliverMixin\").parseNewsletterDeliverMixin(a);if(!b.success)return b;var c=d(\"WASmaxInReceiptSenderAggregatedDeliverServerIDMixin\").parseSenderAggregatedDeliverServerIDMixin(a);if(!c.success)return c;a=d(\"WASmaxInReceiptViewTypeMixin\").parseViewTypeMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,c.value,a.value))}g.parseDeliverSenderAggregatedStyleViewTypeMixin=a}),98);\n__d(\"WASmaxInReceiptSingleStyleChatType\",[\"WAResultOrError\",\"WASmaxInReceiptBroadcastMixin\",\"WASmaxInReceiptDeliverStatusMixin\",\"WASmaxInReceiptGroupMixin\",\"WASmaxInReceiptIndividualMixin\",\"WASmaxInReceiptNewsletterDeliverMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptIndividualMixin\").parseIndividualMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"Individual\",value:b.value});var c=d(\"WASmaxInReceiptGroupMixin\").parseGroupMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"Group\",value:c.value});var e=d(\"WASmaxInReceiptDeliverStatusMixin\").parseDeliverStatusMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverStatus\",value:e.value});var f=d(\"WASmaxInReceiptBroadcastMixin\").parseBroadcastMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"Broadcast\",value:f.value});var g=d(\"WASmaxInReceiptNewsletterDeliverMixin\").parseNewsletterDeliverMixin(a);return g.success?d(\"WAResultOrError\").makeResult({name:\"NewsletterDeliver\",value:g.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"Individual\",\"Group\",\"Status\",\"Broadcast\",\"NewsletterDeliver\"],[b,c,e,f,g])}g.parseSingleStyleChatType=a}),98);\n__d(\"WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"error\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,b.value,\"type\",\"feature-incapable\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:a.value,errorType:b.value})}g.parseDeliverFeatureIncapableErrorTypeMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverBizFeatureIncapableTypeWithReasonMixin\",[\"WAResultOrError\",\"WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(b.value,\"reason\");if(!b.success)return b;a=d(\"WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin\").parseDeliverFeatureIncapableErrorTypeMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({bizReason:b.value},a.value))}g.parseDeliverBizFeatureIncapableTypeWithReasonMixin=a}),98);\n__d(\"WASmaxInReceiptOrderStatusErrorTypeMixin\",[\"WAResultOrError\",\"WASmaxInReceiptEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"error\");if(!a.success)return a;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,b.value,\"type\",\"order-status-update-failed\");if(!b.success)return b;c=d(\"WASmaxParseUtils\").attrStringEnum(c.value,\"reason\",d(\"WASmaxInReceiptEnums\").ENUM_CANCELLATIONFAILED_INVALIDTRANSITION);return!c.success?c:d(\"WAResultOrError\").makeResult({type:a.value,errorType:b.value,bizReason:c.value})}g.parseOrderStatusErrorTypeMixin=a}),98);\n__d(\"WASmaxInReceiptBizErrorType\",[\"WAResultOrError\",\"WASmaxInReceiptDeliverBizFeatureIncapableTypeWithReasonMixin\",\"WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin\",\"WASmaxInReceiptHSMErrorTypeMixin\",\"WASmaxInReceiptOrderStatusErrorTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptDeliverBizFeatureIncapableTypeWithReasonMixin\").parseDeliverBizFeatureIncapableTypeWithReasonMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverBizFeatureIncapableTypeWithReason\",value:b.value});var c=d(\"WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin\").parseDeliverFeatureIncapableErrorTypeMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverFeatureIncapableErrorType\",value:c.value});var e=d(\"WASmaxInReceiptHSMErrorTypeMixin\").parseHSMErrorTypeMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"HSMErrorType\",value:e.value});var f=d(\"WASmaxInReceiptOrderStatusErrorTypeMixin\").parseOrderStatusErrorTypeMixin(a);return f.success?d(\"WAResultOrError\").makeResult({name:\"OrderStatusErrorType\",value:f.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"BizFeatureIncapableTypeWithReason\",\"FeatureIncapableErrorType\",\"HSMErrorType\",\"OrderStatusErrorType\"],[b,c,e,f])}g.parseBizErrorType=a}),98);\n__d(\"WASmaxInReceiptDeliverBizTypeMixin\",[\"WAResultOrError\",\"WASmaxInReceiptBizErrorType\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptBizErrorType\").parseBizErrorType(a);return!b.success?b:d(\"WAResultOrError\").makeResult({bizErrorType:b.value})}g.parseDeliverBizTypeMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverLIDFeatureIncapableTypeMixin\",[\"WAResultOrError\",\"WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,b.value,\"type\",\"feature-incapable\");if(!c.success)return c;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,b.value,\"reason\",\"lid\");if(!b.success)return b;a=d(\"WASmaxInReceiptDeliverFeatureIncapableErrorTypeMixin\").parseDeliverFeatureIncapableErrorTypeMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({errorType:c.value,errorReason:b.value},a.value))}g.parseDeliverLIDFeatureIncapableTypeMixin=a}),98);\n__d(\"WASmaxInReceiptRoiTemplateSourceMixin\",[\"WAResultOrError\",\"WASmaxInReceiptEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"biz\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrStringEnum(a,\"source\",d(\"WASmaxInReceiptEnums\").ENUM_BODYLINK_CTACALL_CTAURL_MEDIADOC_MEDIAIMAGE_MEDIAVIDEO_QUICKREPLY);return!b.success?b:d(\"WAResultOrError\").makeResult({source:b.value})}g.parseRoiTemplateSourceMixin=a}),98);\n__d(\"WASmaxInReceiptEngagedTypeMixin\",[\"WAResultOrError\",\"WASmaxInReceiptRoiTemplateSourceMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"biz\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"engaged\");if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrString(b.value,\"value\");if(!c.success)return c;b=d(\"WASmaxInReceiptRoiTemplateSourceMixin\").parseRoiTemplateSourceMixin(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult({type:a.value,bizValue:c.value,bizRoiTemplateSourceMixin:b.value})}g.parseEngagedTypeMixin=a}),98);\n__d(\"WASmaxInReceiptRetryMixin\",[\"WAResultOrError\",\"WASmaxInReceiptKeyBundleMixin\",\"WASmaxInReceiptRegistrationIDMixin\",\"WASmaxInReceiptRetryTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptRetryTypeMixin\").parseRetryTypeMixin(a);if(!b.success)return b;var c=d(\"WASmaxInReceiptRegistrationIDMixin\").parseRegistrationIDMixin(a);if(!c.success)return c;a=d(\"WASmaxInReceiptKeyBundleMixin\").parseKeyBundleMixin(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,c.value,{keyBundleMixin:a.success?a.value:null}))}g.parseRetryMixin=a}),98);\n__d(\"WASmaxInReceiptSingleStyleReceiptType\",[\"WAResultOrError\",\"WASmaxInReceiptDeliverBizTypeMixin\",\"WASmaxInReceiptDeliverLIDFeatureIncapableTypeMixin\",\"WASmaxInReceiptEngagedTypeMixin\",\"WASmaxInReceiptInactiveTypeMixin\",\"WASmaxInReceiptPlayedSelfTypeMixin\",\"WASmaxInReceiptPlayedTypeMixin\",\"WASmaxInReceiptReadSelfTypeMixin\",\"WASmaxInReceiptReadTypeMixin\",\"WASmaxInReceiptRetryMixin\",\"WASmaxInReceiptServerErrorTypeMixin\",\"WASmaxInReceiptUnknownTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptServerErrorTypeMixin\").parseServerErrorTypeMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"ServerErrorType\",value:b.value});var c=d(\"WASmaxInReceiptInactiveTypeMixin\").parseInactiveTypeMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"InactiveType\",value:c.value});var e=d(\"WASmaxInReceiptReadTypeMixin\").parseReadTypeMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"ReadType\",value:e.value});var f=d(\"WASmaxInReceiptReadSelfTypeMixin\").parseReadSelfTypeMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"ReadSelfType\",value:f.value});var g=d(\"WASmaxInReceiptPlayedTypeMixin\").parsePlayedTypeMixin(a);if(g.success)return d(\"WAResultOrError\").makeResult({name:\"PlayedType\",value:g.value});var h=d(\"WASmaxInReceiptPlayedSelfTypeMixin\").parsePlayedSelfTypeMixin(a);if(h.success)return d(\"WAResultOrError\").makeResult({name:\"PlayedSelfType\",value:h.value});var i=d(\"WASmaxInReceiptRetryMixin\").parseRetryMixin(a);if(i.success)return d(\"WAResultOrError\").makeResult({name:\"Retry\",value:i.value});var j=d(\"WASmaxInReceiptDeliverLIDFeatureIncapableTypeMixin\").parseDeliverLIDFeatureIncapableTypeMixin(a);if(j.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverLIDFeatureIncapableType\",value:j.value});var k=d(\"WASmaxInReceiptDeliverBizTypeMixin\").parseDeliverBizTypeMixin(a);if(k.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverBizType\",value:k.value});var l=d(\"WASmaxInReceiptEngagedTypeMixin\").parseEngagedTypeMixin(a);if(l.success)return d(\"WAResultOrError\").makeResult({name:\"EngagedType\",value:l.value});var m=d(\"WASmaxInReceiptUnknownTypeMixin\").parseUnknownTypeMixin(a);return m.success?d(\"WAResultOrError\").makeResult({name:\"UnknownType\",value:m.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ServerErrorType\",\"InactiveType\",\"ReadType\",\"ReadSelfType\",\"PlayedType\",\"PlayedSelfType\",\"Retry\",\"LIDFeatureIncapableType\",\"BizType\",\"EngagedType\",\"UnknownType\"],[b,c,e,f,g,h,i,j,k,l,m])}g.parseSingleStyleReceiptType=a}),98);\n__d(\"WASmaxInReceiptDeliverSingleStyleMixin\",[\"WAResultOrError\",\"WASmaxInReceiptDeliverBizRolesMixin\",\"WASmaxInReceiptDeliverPaidConversationAggregatedMixin\",\"WASmaxInReceiptDeliverSenderPNMixin\",\"WASmaxInReceiptRecipientMixin\",\"WASmaxInReceiptSingleMixin\",\"WASmaxInReceiptSingleStyleChatType\",\"WASmaxInReceiptSingleStyleReceiptType\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptRecipientMixin\").parseRecipientMixin(a);var c=d(\"WASmaxInReceiptSingleMixin\").parseSingleMixin(a);if(!c.success)return c;var e=d(\"WASmaxInReceiptDeliverPaidConversationAggregatedMixin\").parseDeliverPaidConversationAggregatedMixin(a),f=d(\"WASmaxInReceiptDeliverBizRolesMixin\").parseDeliverBizRolesMixin(a),g=d(\"WASmaxInReceiptDeliverSenderPNMixin\").parseDeliverSenderPNMixin(a),h=d(\"WASmaxInReceiptSingleStyleChatType\").parseSingleStyleChatType(a);if(!h.success)return h;a=d(\"WASmaxInReceiptSingleStyleReceiptType\").parseSingleStyleReceiptType(a);return d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({recipientMixin:b.success?b.value:null},c.value,{deliverPaidConversationAggregatedMixin:e.success?e.value:null,deliverBizRolesMixin:f.success?f.value:null,deliverSenderPNMixin:g.success?g.value:null,singleStyleChatType:h.value,singleStyleReceiptType:a.success?a.value:null}))}g.parseDeliverSingleStyleMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverMdDowngradeTypeMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"md-downgrade\");return!b.success?b:d(\"WAResultOrError\").makeResult({type:b.value})}g.parseDeliverMdDowngradeTypeMixin=a}),98);\n__d(\"WASmaxInReceiptSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup\",[\"WAResultOrError\",\"WASmaxInReceiptDeliverMdDowngradeTypeMixin\",\"WASmaxInReceiptRetryMixin\",\"WASmaxInReceiptSenderTypeMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptSenderTypeMixin\").parseSenderTypeMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"SenderType\",value:b.value});var c=d(\"WASmaxInReceiptDeliverMdDowngradeTypeMixin\").parseDeliverMdDowngradeTypeMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverMdDowngradeType\",value:c.value});var e=d(\"WASmaxInReceiptRetryMixin\").parseRetryMixin(a);return e.success?d(\"WAResultOrError\").makeResult({name:\"Retry\",value:e.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"SenderType\",\"MdDowngradeType\",\"Retry\"],[b,c,e])}g.parseSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup=a}),98);\n__d(\"WASmaxInReceiptDeliverSingleStyleWithRecipientMixin\",[\"WAResultOrError\",\"WASmaxInReceiptDeliverSenderPNMixin\",\"WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup\",\"WASmaxInReceiptSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup\",\"WASmaxInReceiptSingleMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxInReceiptSingleMixin\").parseSingleMixin(a);if(!b.success)return b;var c=d(\"WASmaxInReceiptDeliverSenderPNMixin\").parseDeliverSenderPNMixin(a),e=d(\"WASmaxInReceiptIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup\").parseIndividualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup(a);if(!e.success)return e;a=d(\"WASmaxInReceiptSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup\").parseSenderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},b.value,{deliverSenderPNMixin:c.success?c.value:null,individualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup:e.value,senderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup:a.value}))}g.parseDeliverSingleStyleWithRecipientMixin=a}),98);\n__d(\"WASmaxInReceiptReceiptStyles\",[\"WAResultOrError\",\"WASmaxInReceiptDeliverMessageAggregatedStyleMixin\",\"WASmaxInReceiptDeliverSenderAggregatedStyleMixin\",\"WASmaxInReceiptDeliverSenderAggregatedStyleSenderTypeMixin\",\"WASmaxInReceiptDeliverSenderAggregatedStyleViewTypeMixin\",\"WASmaxInReceiptDeliverSingleStyleMixin\",\"WASmaxInReceiptDeliverSingleStyleWithRecipientMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptDeliverMessageAggregatedStyleMixin\").parseDeliverMessageAggregatedStyleMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverMessageAggregatedStyle\",value:b.value});var c=d(\"WASmaxInReceiptDeliverSenderAggregatedStyleSenderTypeMixin\").parseDeliverSenderAggregatedStyleSenderTypeMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverSenderAggregatedStyleSenderType\",value:c.value});var e=d(\"WASmaxInReceiptDeliverSenderAggregatedStyleViewTypeMixin\").parseDeliverSenderAggregatedStyleViewTypeMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverSenderAggregatedStyleViewType\",value:e.value});var f=d(\"WASmaxInReceiptDeliverSenderAggregatedStyleMixin\").parseDeliverSenderAggregatedStyleMixin(a);if(f.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverSenderAggregatedStyle\",value:f.value});var g=d(\"WASmaxInReceiptDeliverSingleStyleWithRecipientMixin\").parseDeliverSingleStyleWithRecipientMixin(a);if(g.success)return d(\"WAResultOrError\").makeResult({name:\"DeliverSingleStyleWithRecipient\",value:g.value});var h=d(\"WASmaxInReceiptDeliverSingleStyleMixin\").parseDeliverSingleStyleMixin(a);return h.success?d(\"WAResultOrError\").makeResult({name:\"DeliverSingleStyle\",value:h.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"MessageAggregatedStyle\",\"SenderAggregatedStyleSenderType\",\"SenderAggregatedStyleViewType\",\"SenderAggregatedStyle\",\"SingleStyleWithRecipient\",\"SingleStyle\"],[b,c,e,f,g,h])}g.parseReceiptStyles=a}),98);\n__d(\"WASmaxInReceiptToAgentParticipantMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"participant\");return!b.success?b:d(\"WAResultOrError\").makeResult({participant:b.value})}g.parseToAgentParticipantMixin=a}),98);\n__d(\"WASmaxInReceiptToProxyAccountMixin\",[\"WAResultOrError\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseJid\").attrUserJid(a,\"actual_to\");return!b.success?b:d(\"WAResultOrError\").makeResult({actualTo:b.value})}g.parseToProxyAccountMixin=a}),98);\n__d(\"WASmaxInReceiptDeliverRequest\",[\"WAResultOrError\",\"WASmaxInReceiptDeprecatedEditMixin\",\"WASmaxInReceiptOfflineMixin\",\"WASmaxInReceiptReceiptStyles\",\"WASmaxInReceiptToAgentParticipantMixin\",\"WASmaxInReceiptToProxyAccountMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"receipt\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxInReceiptOfflineMixin\").parseOfflineMixin(a),e=d(\"WASmaxInReceiptDeprecatedEditMixin\").parseDeprecatedEditMixin(a),f=d(\"WASmaxInReceiptToProxyAccountMixin\").parseToProxyAccountMixin(a),g=d(\"WASmaxInReceiptToAgentParticipantMixin\").parseToAgentParticipantMixin(a);a=d(\"WASmaxInReceiptReceiptStyles\").parseReceiptStyles(a);return!a.success?a:d(\"WAResultOrError\").makeResult({t:b.value,offlineMixin:c.success?c.value:null,deprecatedEditMixin:e.success?e.value:null,toProxyAccountMixin:f.success?f.value:null,toAgentParticipantMixin:g.success?g.value:null,receiptStyles:a.value})}g.parseDeliverRequest=a}),98);\n__d(\"WASmaxOutReceiptDeliverResponseSuccess\",[\"WASmaxAttrs\",\"WASmaxInReceiptEnums\",\"WASmaxJsx\",\"WASmaxParseJid\",\"WASmaxParseReference\",\"WASmaxParseUtils\",\"WASmaxParsingFailure\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseUtils\").attrStanzaId,a,[\"id\"]);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(b.error);var c=d(\"WASmaxParseReference\").attrFromReference(d(\"WASmaxParseJid\").attrJidEnum,a,[\"from\"],d(\"WASmaxInReceiptEnums\").DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_NEWSLETTERJID_STATUSJID);if(!c.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(c.error);var e=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseUtils\").attrString,a,[\"type\"]);if(!e.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(e.error);var f=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrJidEnum,a,[\"participant\"],d(\"WASmaxInReceiptEnums\").DEVICEJID_USERJID_DEVICEJID);if(!f.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(f.error);a=d(\"WASmaxParseReference\").optionalAttrFromReference(d(\"WASmaxParseJid\").attrUserJid,a,[\"recipient\"]);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(a.error);b=d(\"WASmaxJsx\").smax(\"ack\",{id:d(\"WAWap\").STANZA_ID(b.value),\"class\":\"receipt\",to:d(\"WAWap\").JID(c.value),type:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").CUSTOM_STRING,e.value),participant:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").JID,f.value),recipient:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").USER_JID,a.value)});return b}g.makeDeliverResponseSuccess=a}),98);\n__d(\"WASmaxReceiptDeliverRPC\",[\"WASmaxInReceiptDeliverRequest\",\"WASmaxOutReceiptDeliverResponseSuccess\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInReceiptDeliverRequest\").parseDeliverRequest(a);if(!b.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Deliver\",{Request:b}));return{parsedRequest:b.value,makeDeliverResponseSuccess:function(){return d(\"WASmaxOutReceiptDeliverResponseSuccess\").makeDeliverResponseSuccess(a)}}}g.receiveDeliverRPC=a}),98);\n__d(\"WACreateHandleReceipt\",[\"Promise\",\"WACreateHandleGroupReceiptBranch\",\"WACreateHandleIndividualReceiptBranch\",\"WACreateHandlePeerAppdataReceiptBranch\",\"WAJids\",\"WAResultOrError\",\"WASmaxReceiptDeliverPeerRPC\",\"WASmaxReceiptDeliverRPC\",\"WATagsLogger\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" server aggregated receipt is not supported\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(['<receipt category=\"peer\"> is not supported yet.']);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"start handling...\"]);k=function(){return a};return a}var l=d(\"WATagsLogger\").TAGS([\"decision tree\",\"handleReceipt\"]);function a(a){var c,e=d(\"WACreateHandleIndividualReceiptBranch\").createHandleIndividualReceiptBranch({handleIndividualReceipt:(c=a.individualMessage)==null?void 0:c.handleIndividualReceipt,handleIndividualRetryReceipt:(c=a.individualMessage)==null?void 0:c.handleIndividualRetryReceipt}),f=d(\"WACreateHandleGroupReceiptBranch\").createHandleGroupReceiptBranch({handleGroupReceipt:(c=a.groupMessage)==null?void 0:c.handleGroupReceipt,handleGroupRetryReceipt:(c=a.groupMessage)==null?void 0:c.handleGroupRetryReceipt}),g=d(\"WACreateHandlePeerAppdataReceiptBranch\").createHandlePeerAppdataReceiptBranch({handlePeerAppdataReceipt:(c=a.appdataMessage)==null?void 0:c.handlePeerAppdataReceipt,handlePeerAppdataRetryReceipt:(c=a.appdataMessage)==null?void 0:c.handlePeerAppdataRetryReceipt});function m(a){var c=a.singleReceiptMixin,g=a.makeAck,i=a.offline,j=a.serverTs;a=a.socketId;var k=c.singleStyleChatType,l=c.singleStyleReceiptType,m=c.id,n=c.recipientMixin;c.deliverBizRolesMixin;c.deliverPaidConversationAggregatedMixin;switch(k.name){case\"Individual\":return e({aggregate:{aggregatedType:\"none\",stanzaId:m,receiptSender:k.value.from},receiptType:l,makeAck:g,offline:i,serverTs:j,recipient:n==null?void 0:n.recipient,socketId:a});case\"Group\":return f({from:k.value.from,aggregate:{aggregatedType:\"none\",stanzaId:m,receiptSender:k.value.participant},receiptType:l,makeAck:g,offline:i,serverTs:j,recipient:n==null?void 0:n.recipient,socketId:a});case\"DeliverStatus\":break;case\"Broadcast\":break;case\"NewsletterDeliver\":break;default:k.name}return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(g()))}function n(a){var c=a.aggregateReceiptMixin,g=a.makeAck,i=a.offline,j=a.serverTs;a=a.socketId;var k=c.recipientMixin,l=c.id,m=c.listItem,n=c.individualOrGroupOrDeliverStatusOrBroadcastMixinGroup,o=c.senderAggregatedStyleReceiptType;c.deliverBizRolesMixin;c.deliverPaidConversationAggregatedMixin;c=[l].concat(m.map(function(a){return a.id}));switch(n.name){case\"Individual\":return e({aggregate:{aggregatedType:\"sender\",receiptSender:n.value.from,stanzaIds:c},receiptType:o,makeAck:g,offline:i,serverTs:j,recipient:k==null?void 0:k.recipient,socketId:a});case\"Group\":return f({from:n.value.from,aggregate:{aggregatedType:\"sender\",stanzaIds:c,receiptSender:n.value.participant},receiptType:o,makeAck:g,offline:i,serverTs:j,recipient:k==null?void 0:k.recipient,socketId:a});case\"DeliverStatus\":break;case\"Broadcast\":break}return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(g()))}return function(a,c){l.DEV(k());if(a.attrs.category===\"peer\"){l.ERROR(j());var o=d(\"WASmaxReceiptDeliverPeerRPC\").receiveDeliverPeerRPC(a);o=o.makeDeliverPeerResponseSuccess;return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(o()))}if(a.attrs.category===\"peer_appdata\")return g(a,c);o=d(\"WASmaxReceiptDeliverRPC\").receiveDeliverRPC(a);a=o.parsedRequest;var p=a.t,q=a.receiptStyles;a=a.offlineMixin;o=o.makeDeliverResponseSuccess;p=d(\"WATimeUtils\").castToUnixTime(p);a=a==null?void 0:a.offline;switch(q.name){case\"DeliverMessageAggregatedStyle\":var r=q.value,s=r.from,t=r.recipientMixin,u=r.id,v=r.participantsUser;r=r.messageAggregatedStyleReceiptType;var w=d(\"WAJids\").validateGroupJid(s);if(w==null){l.ERROR(i(),s);break}return f({aggregate:{aggregatedType:\"server\",stanzaId:u,receiptSenders:v.map(function(a){var b=a.jid;a=a.t;return{device:b,ts:d(\"WATimeUtils\").castToUnixTime(a)}})},from:w,receiptType:r,makeAck:o,offline:a,serverTs:p,recipient:t==null?void 0:t.recipient,socketId:c});case\"DeliverSenderAggregatedStyleSenderType\":s=q.value;u=s.individualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup;v=s.id;w=s.type;r=s.listItem;w;t={value:{type:w},name:\"SenderType\"};s=[v].concat(r.map(function(a){return a.id}));switch(u.name){case\"Group\":return f({aggregate:{aggregatedType:\"sender\",stanzaIds:s,receiptSender:u.value.participant},from:u.value.from,receiptType:t,makeAck:o,offline:a,serverTs:p,recipient:null,socketId:c});case\"Broadcast\":break;case\"DeliverStatus\":break;case\"IndividualWithRecipient\":return e({aggregate:{aggregatedType:\"sender\",receiptSender:u.value.from,stanzaIds:s},receiptType:t,makeAck:o,offline:a,serverTs:p,recipient:u.value.recipient,socketId:c})}break;case\"DeliverSenderAggregatedStyle\":return n({aggregateReceiptMixin:q.value,makeAck:o,serverTs:p,offline:a,socketId:c});case\"DeliverSingleStyleWithRecipient\":w=q.value;v=w.id;r=w.senderTypeOrDeliverMdDowngradeTypeOrRetryMixinGroup;s=w.individualWithRecipientOrGroupOrDeliverStatusOrBroadcastMixinGroup;switch(s.name){case\"IndividualWithRecipient\":return e({aggregate:{aggregatedType:\"none\",receiptSender:s.value.from,stanzaId:v},receiptType:r,makeAck:o,offline:a,serverTs:p,recipient:s.value.recipient,socketId:c});case\"Group\":return f({from:s.value.from,aggregate:{aggregatedType:\"none\",stanzaId:v,receiptSender:s.value.participant},receiptType:r,makeAck:o,offline:a,serverTs:p,recipient:null,socketId:c});case\"DeliverStatus\":break;case\"Broadcast\":break;default:s.name}break;case\"DeliverSingleStyle\":return m({singleReceiptMixin:q.value,makeAck:o,serverTs:p,offline:a,socketId:c})}return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(o()))}}g.createHandleReceipt=a}),98);\n__d(\"WASmaxInStreamErrorEnums\",[],(function(a,b,c,d,e,f){a={appdata:\"appdata\",call:\"call\",message:\"message\",notification:\"notification\",receipt:\"receipt\"};f.ENUM_APPDATA_CALL_MESSAGE_NOTIFICATION_RECEIPT=a}),66);\n__d(\"WASmaxInStreamErrorAckKickRequest\",[\"WAResultOrError\",\"WASmaxInStreamErrorEnums\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"stream:error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"ack\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStringEnum(b.value,\"class\",d(\"WASmaxInStreamErrorEnums\").ENUM_APPDATA_CALL_MESSAGE_NOTIFICATION_RECEIPT);if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrString(b.value,\"type\");if(!c.success)return c;b=d(\"WASmaxParseUtils\").attrStanzaId(b.value,\"id\");return!b.success?b:d(\"WAResultOrError\").makeResult({ackClass:a.value,ackType:c.value,ackId:b.value})}g.parseAckKickRequest=a}),98);\n__d(\"WASmaxStreamErrorAckKickRPC\",[\"WASmaxInStreamErrorAckKickRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInStreamErrorAckKickRequest\").parseAckKickRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"AckKick\",{Request:a}));return{parsedRequest:a.value}}g.receiveAckKickRPC=a}),98);\n__d(\"WASmaxInStreamErrorBadMacRequest\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"stream:error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"bad-mac\");return!b.success?b:d(\"WASmaxParseUtils\").voidSuccess}g.parseBadMacRequest=a}),98);\n__d(\"WASmaxStreamErrorBadMacRPC\",[\"WASmaxInStreamErrorBadMacRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInStreamErrorBadMacRequest\").parseBadMacRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"BadMac\",{Request:a}));return{parsedRequest:a.value}}g.receiveBadMacRPC=a}),98);\n__d(\"WASmaxInStreamErrorCodeRequest\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"stream:error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"code\");return!b.success?b:d(\"WAResultOrError\").makeResult({code:b.value})}g.parseCodeRequest=a}),98);\n__d(\"WASmaxStreamErrorCodeRPC\",[\"WASmaxInStreamErrorCodeRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInStreamErrorCodeRequest\").parseCodeRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Code\",{Request:a}));return{parsedRequest:a.value}}g.receiveCodeRPC=a}),98);\n__d(\"WASmaxInStreamErrorConflictRequest\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"stream:error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"conflict\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"code\");if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrString(b.value,\"type\");if(!c.success)return c;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,b.value,\"reason\");return!b.success?b:d(\"WAResultOrError\").makeResult({code:a.value,conflictType:c.value,conflictReason:b.value})}g.parseConflictRequest=a}),98);\n__d(\"WASmaxStreamErrorConflictRPC\",[\"WASmaxInStreamErrorConflictRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInStreamErrorConflictRequest\").parseConflictRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Conflict\",{Request:a}));return{parsedRequest:a.value}}g.receiveConflictRPC=a}),98);\n__d(\"WASmaxInStreamErrorPingKickRequest\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"stream:error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"ping\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrStanzaId(b.value,\"id\");return!a.success?a:d(\"WAResultOrError\").makeResult({pingId:a.value})}g.parsePingKickRequest=a}),98);\n__d(\"WASmaxStreamErrorPingKickRPC\",[\"WASmaxInStreamErrorPingKickRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInStreamErrorPingKickRequest\").parsePingKickRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"PingKick\",{Request:a}));return{parsedRequest:a.value}}g.receivePingKickRPC=a}),98);\n__d(\"WASmaxInStreamErrorXMLNotWellFormedRequest\",[\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"stream:error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"xml-not-well-formed\");return!b.success?b:d(\"WASmaxParseUtils\").voidSuccess}g.parseXMLNotWellFormedRequest=a}),98);\n__d(\"WASmaxStreamErrorXMLNotWellFormedRPC\",[\"WASmaxInStreamErrorXMLNotWellFormedRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInStreamErrorXMLNotWellFormedRequest\").parseXMLNotWellFormedRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"XMLNotWellFormed\",{Request:a}));return{parsedRequest:a.value}}g.receiveXMLNotWellFormedRPC=a}),98);\n__d(\"WACreateHandleStreamError\",[\"Promise\",\"WAResultOrError\",\"WASmaxDecisionTreeUtils\",\"WASmaxStreamErrorAckKickRPC\",\"WASmaxStreamErrorBadMacRPC\",\"WASmaxStreamErrorCodeRPC\",\"WASmaxStreamErrorConflictRPC\",\"WASmaxStreamErrorPingKickRPC\",\"WASmaxStreamErrorXMLNotWellFormedRPC\",\"WAUnknownStanzaError\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){var c=a.md,e=a.streamError;return function(a){var f=d(\"WASmaxDecisionTreeUtils\").firstChild(a);if(f.success){f=f.value;switch(f.tag){case\"ack\":f=d(\"WASmaxStreamErrorAckKickRPC\").receiveAckKickRPC(a);f=f.parsedRequest;return e.handleAckKick(f).then(d(\"WAResultOrError\").makeResult);case\"ping\":f=d(\"WASmaxStreamErrorPingKickRPC\").receivePingKickRPC(a);f=f.parsedRequest;return e.handlePingKick(f).then(d(\"WAResultOrError\").makeResult);case\"xml-not-well-formed\":d(\"WASmaxStreamErrorXMLNotWellFormedRPC\").receiveXMLNotWellFormedRPC(a);return e.handleXmlNotWellFormed().then(d(\"WAResultOrError\").makeResult);case\"bad-mac\":d(\"WASmaxStreamErrorBadMacRPC\").receiveBadMacRPC(a);return e.handleBadMac().then(d(\"WAResultOrError\").makeResult);case\"conflict\":f=d(\"WASmaxStreamErrorConflictRPC\").receiveConflictRPC(a);f=f.parsedRequest;return e.handleConflict(f).then(d(\"WAResultOrError\").makeResult);default:return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}}else{f=d(\"WASmaxStreamErrorCodeRPC\").receiveCodeRPC(a);a=f.parsedRequest;f=a.code;switch(f){case\"515\":a=c==null?void 0:c.handleRegistrateCompanionSuccess;if(a!=null)return a().then(d(\"WAResultOrError\").makeResult);break;case\"516\":a=c==null?void 0:c.handleRegistrateCompanionFailure;if(a!=null)return a().then(d(\"WAResultOrError\").makeResult);break;default:return e.handleStreamErrorCode({code:f}).then(d(\"WAResultOrError\").makeResult)}return(h||(h=b(\"Promise\"))).resolve(d(\"WAUnknownStanzaError\").unknownStanzaError)}}}g.createHandleStreamError=a}),98);\n__d(\"WASmaxInLoginDisplayNameMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxParseUtils\").attrString(a,\"display_name\");return!a.success?a:d(\"WAResultOrError\").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);\n__d(\"WASmaxInLoginSuccessRequest\",[\"WAResultOrError\",\"WASmaxInLoginDisplayNameMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"success\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"t\",0,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrIntRange(a,\"props\",0,void 0);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"abprops\",0,void 0);if(!e.success)return e;var f=d(\"WASmaxParseUtils\").attrString(a,\"location\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"shard_count\",0,4095);if(!g.success)return g;var h=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"creation\",0,void 0);if(!h.success)return h;var i=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,a,\"companion_enc_static\");if(!i.success)return i;var j=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseJid\").attrDeviceJid,a,\"lid\");if(!j.success)return j;a=d(\"WASmaxInLoginDisplayNameMixin\").parseDisplayNameMixin(a);return d(\"WAResultOrError\").makeResult({t:b.value,props:c.value,abprops:e.value,location:f.value,shardCount:g.value,creation:h.value,companionEncStatic:i.value,lid:j.value,displayNameMixin:a.success?a.value:null})}g.parseSuccessRequest=a}),98);\n__d(\"WASmaxLoginSuccessRPC\",[\"WASmaxInLoginSuccessRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxInLoginSuccessRequest\").parseSuccessRequest(a);if(!a.success)throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Success\",{Request:a}));return{parsedRequest:a.value}}g.receiveSuccessRPC=a}),98);\n__d(\"WACreateHandleSuccess\",[\"Promise\",\"WAResultOrError\",\"WASmaxLoginSuccessRPC\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){var c=(a=a.login)==null?void 0:a.handleLoginSuccess;return function(a){if(c!=null){a=d(\"WASmaxLoginSuccessRPC\").receiveSuccessRPC(a);a=a.parsedRequest;var e=a.t,f=a.props,g=a.abprops,i=a.location,j=a.shardCount,k=a.creation,l=a.companionEncStatic,m=a.lid;a=a.displayNameMixin;return c({timestamp:d(\"WATimeUtils\").castToUnixTime(e),props:f,abprops:g,location:i,shardCount:j,creation:k,companionEncStatic:l,lid:m,displayName:a==null?void 0:a.displayName}).then(d(\"WAResultOrError\").makeResult)}return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeResult(\"NO_ACK\"))}}g.createHandleSuccess=a}),98);\n__d(\"WAHandleDecisionTreeResult\",[\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[\",\"] unexpected-runtime-error: \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[\",\"] runtime-error \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"unrecognized stanza: \",\"\"]);j=function(){return a};return a}function a(a,b){var c=d(\"WATagsLogger\").TAGS([\"decision tree\"]);return b.then(function(b){if(b.success)return b.value;else if(b.error.type===\"unknown-stanza\"){c.ERROR(j(),a);return\"NO_ACK\"}else{b.error.type;c.ERROR(i(),a.tag,b.error.error);return\"NO_ACK\"}})[\"catch\"](function(b){c.ERROR(h(),a.tag,b);return\"NO_ACK\"})}g.handleDecisionTreeResult=a}),98);\n__d(\"WAOneQueueHandler\",[\"WAGlobals\",\"WAHandleDecisionTreeResult\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return function(b,c){var e={offline:b.attrs.offline?parseInt(b.attrs.offline,10):null,serverTs:b.attrs.t?d(\"WATimeUtils\").castToUnixTime(parseInt(b.attrs.t,10)):null,tag:b.tag};return d(\"WAGlobals\").getWaOneQueue().handleStanza(function(e){return d(\"WAHandleDecisionTreeResult\").handleDecisionTreeResult(b,a(b,c,e))},e)}}g.handleWithOneQueue=a}),98);\n__d(\"WAServerRPC\",[\"Promise\",\"WACreateHandleAppdata\",\"WACreateHandleChatState\",\"WACreateHandleErrorStanza\",\"WACreateHandleFailure\",\"WACreateHandleInfoBulletin\",\"WACreateHandleIq\",\"WACreateHandleMessage\",\"WACreateHandleNotification\",\"WACreateHandleReceipt\",\"WACreateHandleStreamError\",\"WACreateHandleSuccess\",\"WAHandleDecisionTreeResult\",\"WAOneQueueHandler\",\"WAServerRPCLogger\",\"WAStanzaRootTag\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received unsupported stanza: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unsupported stanza: \",\"\"]);j=function(){return a};return a}function a(a){var c=d(\"WACreateHandleInfoBulletin\").createHandleInfoBulletin(a),e=d(\"WACreateHandleStreamError\").createHandleStreamError(a),f=d(\"WACreateHandleFailure\").createHandleFailure(a),g=d(\"WACreateHandleSuccess\").createHandleSuccess(a),k=d(\"WACreateHandleMessage\").createHandleMessage(a),l=d(\"WACreateHandleIq\").createHandleIq(a),m=d(\"WACreateHandleChatState\").createHandleChatState(a),n=d(\"WACreateHandleErrorStanza\").createHandleErrorStanza(a),o=d(\"WACreateHandleNotification\").createHandleNotification(a),p=d(\"WACreateHandleAppdata\").createHandleAppdata(a),q=d(\"WACreateHandleReceipt\").createHandleReceipt(a);a=function(a,r){switch(a.tag){case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.MESSAGE:return d(\"WAOneQueueHandler\").handleWithOneQueue(k)(a,r);case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.NOTIFICATION:return d(\"WAOneQueueHandler\").handleWithOneQueue(o)(a,r);case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.RECEIPT:return d(\"WAOneQueueHandler\").handleWithOneQueue(q)(a,r);case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.CHATSTATE:return d(\"WAHandleDecisionTreeResult\").handleDecisionTreeResult(a,m(a));case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.APPDATA:return d(\"WAOneQueueHandler\").handleWithOneQueue(p)(a,r);case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.FAILURE:return d(\"WAHandleDecisionTreeResult\").handleDecisionTreeResult(a,f(a));case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.STREAM_ERROR:return d(\"WAHandleDecisionTreeResult\").handleDecisionTreeResult(a,e(a));case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.IQ:return d(\"WAHandleDecisionTreeResult\").handleDecisionTreeResult(a,l(a));case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.IB:return d(\"WAHandleDecisionTreeResult\").handleDecisionTreeResult(a,c(a));case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.ERROR:return d(\"WAHandleDecisionTreeResult\").handleDecisionTreeResult(a,n(a));case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.SUCCESS:return d(\"WAHandleDecisionTreeResult\").handleDecisionTreeResult(a,g(a));case d(\"WAStanzaRootTag\").STANZA_ROOT_TAG.XML_STREAM_END:return(h||(h=b(\"Promise\"))).resolve(\"NO_ACK\");default:d(\"WAServerRPCLogger\").logger.WARN(j(),a);d(\"WAServerRPCLogger\").logger.ERROR(i(),a.tag);return(h||(h=b(\"Promise\"))).resolve(\"NO_ACK\")}};return{handleStanza:a}}g.makeServerRPC=a}),98);\n__d(\"MAWServerRPC\",[\"MAWHandleAbPropsRefreshNotification\",\"MAWHandleAppdataMessage\",\"MAWHandleChatState\",\"MAWHandleFailure\",\"MAWHandleFbDeviceChangeNotification\",\"MAWHandleFbMultiwayNotification\",\"MAWHandleFbThreadNotification\",\"MAWHandleGroupNotification\",\"MAWHandleGroupReceipt\",\"MAWHandleGroupRetryReceipt\",\"MAWHandleIncomingMsgV2\",\"MAWHandleIndividualRetryReceipt\",\"MAWHandleLoginSuccess\",\"MAWHandlePeerAppdataReceipt\",\"MAWHandlePeerAppdataRetryReceipt\",\"MAWHandleSpam\",\"MAWHandleThreadMetadata\",\"Promise\",\"WAHandleErrorStanza\",\"WAHandleInfoBulletin\",\"WAHandlePrekeyContactIDChangedNotification\",\"WAHandlePrekeyDigestNotification\",\"WAHandlePrekeyLowCountNotification\",\"WAHandleReceipt\",\"WAHandleServerPing\",\"WAHandleStreamError\",\"WAHandleSyncdDirtyBit\",\"WALogger\",\"WAServerRPC\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Peer messages are not supported\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Broadcast messages are not supported\"]);j=function(){return a};return a}function a(){var a;return d(\"WAServerRPC\").makeServerRPC({abprops:{handleAbPropsRefreshNotification:d(\"MAWHandleAbPropsRefreshNotification\").handleAbPropsRefreshNotification},accountSync:null,appdataMessage:{handleAppdataMessage:d(\"MAWHandleAppdataMessage\").handleAppdataMessage,handlePeerAppdataReceipt:d(\"MAWHandlePeerAppdataReceipt\").handlePeerAppdataReceipt,handlePeerAppdataRetryReceipt:d(\"MAWHandlePeerAppdataRetryReceipt\").handlePeerAppdataRetryReceipt},broadcast:{handleBroadcastMessage:function(a){a=a.makeAck;d(\"WALogger\").ERROR(j());return(h||(h=b(\"Promise\"))).resolve(a())}},clientLog:null,comms:{handleEdgeRoutingInfo:d(\"WAHandleInfoBulletin\").handleEdgeRoutingInfo,handleServerPing:d(\"WAHandleServerPing\").handleServerPing},error:{handleErrorStanza:d(\"WAHandleErrorStanza\").handleErrorStanza,handleSmaxErrorStanza:d(\"WAHandleErrorStanza\").handleSmaxErrorStanza},fb:{handleFbDeviceChangeNotification:d(\"MAWHandleFbDeviceChangeNotification\").handleFbDeviceChangeNotification,handleFbMultiwayNotification:d(\"MAWHandleFbMultiwayNotification\").handleFbMultiwayNotification,handleFbThreadNotification:d(\"MAWHandleFbThreadNotification\").handleFbThreadNotification},groupMessage:{handleGroupChatState:d(\"MAWHandleChatState\").handleGroupChatState,handleGroupDirtyBit:null,handleGroupMessage:d(\"MAWHandleIncomingMsgV2\").handleGroupMessage,handleGroupNotification:d(\"MAWHandleGroupNotification\").handleGroupNotification,handleGroupReceipt:d(\"MAWHandleGroupReceipt\").handleGroupReceipt,handleGroupRetryReceipt:d(\"MAWHandleGroupRetryReceipt\").handleGroupRetryReceipt},individualMessage:{handleIndividualChatState:d(\"MAWHandleChatState\").handleIndividualChatState,handleIndividualMessage:d(\"MAWHandleIncomingMsgV2\").handleIncomingIndividualMsg,handleIndividualReceipt:d(\"WAHandleReceipt\").handleIndividualReceipt,handleIndividualRetryReceipt:d(\"MAWHandleIndividualRetryReceipt\").handleIndividualRetryReceipt},login:{handleLoginFailure:d(\"MAWHandleFailure\").handleLoginFailure,handleLoginSuccess:d(\"MAWHandleLoginSuccess\").handleLoginSuccess},md:null,newsletter:null,offline:{handleOfflineEnd:d(\"WAHandleInfoBulletin\").handleOfflineEnd,handleOfflineStart:d(\"WAHandleInfoBulletin\").handleOfflineStart,handleThreadMetadata:d(\"MAWHandleThreadMetadata\").handleThreadMetadata},peerMessage:{handlePeerMessage:function(a){a=a.makeAck;d(\"WALogger\").ERROR(i());return(h||(h=b(\"Promise\"))).resolve(a())}},prekey:{handlePrekeyContactIDChangedNotification:d(\"WAHandlePrekeyContactIDChangedNotification\").handlePrekeyContactIDChangedNotification,handlePrekeyDigestNotification:d(\"WAHandlePrekeyDigestNotification\").handlePrekeyDigestNotification,handlePrekeyLowCountNotification:d(\"WAHandlePrekeyLowCountNotification\").handlePrekeyLowCountNotification},presence:null,serverProps:null,spam:{handleSpam:d(\"MAWHandleSpam\").handleSpam},status:null,streamError:{handleAckKick:(a=d(\"WAHandleStreamError\")).handleAckKick,handleBadMac:a.handleBadMac,handleConflict:a.handleConflict,handlePingKick:a.handlePingKick,handleStreamErrorCode:a.handleStreamErrorCode,handleXmlNotWellFormed:a.handleXmlNotWellFormed},syncd:{handleSyncdDirtyBit:d(\"WAHandleSyncdDirtyBit\").handleSyncdDirtyBit,handleSyncdNewPatchNotification:null},usync:null})}g.makeServerRPC=a}),98);\n__d(\"MAWGroupInfoStore\",[\"MAWBridgeTypesCreators\",\"MAWDbThreadTxns\",\"MAWDexieCastToPromise\",\"MAWDexieTable\",\"MAWFolderTypes\",\"MAWGetOrCreateThreadTxns\",\"MAWIndexedDb\",\"MAWLoadMsgsTxns\",\"MAWLoadThreadsTxns\",\"MAWThreadManagementTxns\",\"MAWTransactionMode\",\"WAResultOrError\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a){return a!=null&&typeof a===\"object\"&&a.groupStatus!=null&&typeof a.groupStatus===\"string\"?a.groupStatus:void 0}function i(a){return a!=null&&typeof a===\"object\"&&a.clientThreadKey!=null&&typeof a.clientThreadKey===\"string\"?a.clientThreadKey:void 0}function j(a){return a!=null&&typeof a===\"object\"&&a.folder!=null&&typeof a.folder===\"number\"?a.folder:void 0}function k(a){return a!=null&&typeof a===\"object\"&&a.updateParticipantMedatadata!=null&&typeof a.updateParticipantMedatadata===\"boolean\"?a.updateParticipantMedatadata:void 0}function l(a){return a===null?{}:a}a=function(){function a(a){var b=this;this.get=function(a,c){c=j(c);return d(\"MAWDexieCastToPromise\").dexieCastToPromise(d(\"MAWThreadManagementTxns\").getOrRepairGroupThread(b.db,a,c).then(function(a){return a!=null?a:null}).then(function(a){return a==null?d(\"WAResultOrError\").makeError(\"missing_group\"):d(\"MAWLoadThreadsTxns\").loadContentsForThreads(b.db,[a.thread],1,null,\"getGroupInfoStore\").then(function(){return a.groupInfo}).then(function(a){return d(\"WAResultOrError\").makeResult(m(a))})}))};this.create=function(a,c){var e=h(c)===\"added\"?d(\"WATimeUtils\").millisTime():d(\"WATimeUtils\").castUnixTimeToMillisTime(a.creationTs);return d(\"MAWDexieCastToPromise\").dexieCastToPromise(d(\"MAWGetOrCreateThreadTxns\").getOrCreateThread(b.db,{clientThreadKey:i(c),createTs:e,description:\"MAWGroupInfoStore-create\",folder:d(\"MAWFolderTypes\").FOLDER_ID.INBOX,jid:a.jid}).then(function(c){var e=c.created,f=c.thread,g=n(a,f.chatId);return b.db.groupInfo.put(g).then(function(){d(\"MAWIndexedDb\").afterTransaction({tag:\"GroupInfoUpdated\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdatedGroupInfo(g)})}).then(function(){return f.newestMsg!=null?d(\"MAWLoadMsgsTxns\").loadMsgsAndMediaFromOffset(b.db,f.chatId,f.jid,f.newestMsg,10,!0):d(\"MAWDexieTable\").dexieResolve()}).then(function(){return f.archived===!0?d(\"MAWDbThreadTxns\").unarchiveThreads(b.db,[f.chatId]):d(\"MAWDexieTable\").dexieResolve()}).then(function(){return e?d(\"WAResultOrError\").makeResult(g.groupJid):d(\"WAResultOrError\").makeError(\"existing\")})}))};this[\"delete\"]=function(a){return d(\"MAWDexieCastToPromise\").dexieCastToPromise(d(\"MAWDexieTable\").dexieAll([b.db.threads.get({jid:a}),b.db.groupInfo[\"delete\"](a)]).then(function(a){a=a[0];return a==null?d(\"WAResultOrError\").makeError(\"missing_group\"):d(\"MAWDexieTable\").dexieAll([b.db.threads[\"delete\"](a.chatId),b.db.participants.where(\"threadId\").equals(a.chatId)[\"delete\"]()]).then(function(){return d(\"WAResultOrError\").makeResult()})}))};this.update=function(a,c,e){return d(\"MAWDexieCastToPromise\").dexieCastToPromise(b.db.threads.get({jid:a}).then(function(f){return f==null?d(\"WAResultOrError\").makeError(\"missing_group\"):b.db.groupInfo.get(a).then(function(a){if(a==null)return d(\"WAResultOrError\").makeError(\"missing_group\");a=m(a);a=c(a);var g=n(a,f.chatId);return b.db.groupInfo.put(g).then(function(){d(\"MAWIndexedDb\").afterTransaction({tag:\"GroupInfoUpdated\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdatedGroupInfo(g)});k(e)===!0&&d(\"MAWIndexedDb\").afterTransaction({tag:\"UpdateE2EEMetadataParticipants\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdateE2EEMetadataParticipants(f.jid,f.chatId)});return d(\"WAResultOrError\").makeResult()})})}))};this.clear=function(){return d(\"MAWDexieCastToPromise\").dexieCastToPromise(b.db.groupInfo.clear())};this.db=a}var b=a.prototype;b.has=function(a){return d(\"MAWDexieCastToPromise\").dexieCastToPromise(this.db.groupInfo.get(a).then(function(a){return a!=null?!0:!1}))};return a}();a.tableLocks={chunk:(b=d(\"MAWTransactionMode\")).READONLY,groupInfo:b.READWRITE,groupInvites:b.READONLY,media:b.READONLY,messages:b.READONLY,participants:b.READWRITE,reactions:b.READONLY,threads:b.READWRITE,xma:b.READONLY};function m(a){return babelHelpers[\"extends\"]({jid:a.groupJid},l(a.creator!=null?{creator:a.creator}:null),{creationTs:a.creationTs},l(a.participantVersion!=null?{participantVersion:a.participantVersion}:null),{inviter:a.inviter,memberAddMode:a.memberAddMode,subject:babelHelpers[\"extends\"]({content:a.name},l(a.nameOwner!=null?{user:a.nameOwner}:null),l(a.nameTs!=null?{ts:a.nameTs}:null))})}function n(a,b){var c=a.subject.content;c!=null&&c.length===0&&(c=void 0);return{creationTs:a.creationTs,creator:a.creator,groupJid:a.jid,inviter:a.inviter,memberAddMode:a.memberAddMode,name:c,nameOwner:a.subject.user,nameTs:a.subject.ts,participantVersion:a.participantVersion,threadId:b}}g.MAWGroupInfoStore=a}),98);\n__d(\"MAWGetExpiredMsgs\",[\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b=d(\"WATimeUtils\").unixTime();return a.messages.where(\"messageDeleteTs\").belowOrEqual(b).toArray().then(function(a){return a.map(function(a){var b=a.author,c=a.externalId;a=a.threadJid;return a==null?null:{author:b,chat:a,externalId:c}}).filter(Boolean)})}g.getExpiredMsgs=a}),98);\n__d(\"MAWMessageStore\",[\"I64\",\"MAWAckLevel\",\"MAWAuthor\",\"MAWBridgeMsg\",\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDbThread\",\"MAWDexieCastToPromise\",\"MAWDexieTable\",\"MAWFolderTypes\",\"MAWGetExpiredMsgs\",\"MAWIndexedDb\",\"MAWLocalizationUtils\",\"MAWMsgType\",\"MAWThreadFetchAndEmitTxns\",\"MAWTransactionMode\",\"MAWWriteMsgTxns\",\"WAJids\",\"WALogger\",\"WAResultOrError\",\"WATimeUtils\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Successfully deleted: \",\" reactions rows.\"]);i=function(){return a};return a}function j(a){if(a!=null&&typeof a===\"object\"&&a.optimisticMsg!=null){a=a.optimisticMsg;if(typeof a.msgId===\"string\"&&typeof a.ts===\"number\")return{msgId:a.msgId,ts:a.ts}}return void 0}function k(a){return a!=null&&typeof a===\"object\"&&a.openMessageOtid!=null&&typeof a.openMessageOtid===\"string\"?a.openMessageOtid:void 0}function l(a){if(a!=null&&typeof a===\"object\"&&a.folder!=null&&typeof a.folder===\"number\")if(a.folder===d(\"MAWFolderTypes\").FOLDER_ID.INBOX)return d(\"MAWFolderTypes\").FOLDER_ID.INBOX;else if(a.folder===d(\"MAWFolderTypes\").FOLDER_ID.PENDING)return d(\"MAWFolderTypes\").FOLDER_ID.PENDING;else if(a.folder===d(\"MAWFolderTypes\").FOLDER_ID.OTHER)return d(\"MAWFolderTypes\").FOLDER_ID.OTHER;else if(a.folder===d(\"MAWFolderTypes\").FOLDER_ID.ARCHIVED)return d(\"MAWFolderTypes\").FOLDER_ID.ARCHIVED;return null}a=function(){function a(a){this.db=a}var b=a.prototype;b.create=function(a,b){var e=this,f=j(b),g=k(b);b=l(b);return d(\"MAWDexieCastToPromise\").dexieCastToPromise(d(\"MAWThreadFetchAndEmitTxns\").fetchAndEmitThread(this.db,a.id.chat,b,void 0,\"MAWMessageStore_DEPRECATED-create\").then(function(b){if(b==null)return d(\"WAResultOrError\").makeError({type:\"missing_thread\"});var i=b.thread;if(a.type===d(\"MAWMsgType\").MSG_TYPE.TEXT){b=void 0;a.ephemeralSetting!=null&&(b={ephemeralExpirationInSec:a.ephemeralSetting.expirationTs,ephemeralLastUpdatedOrSetTimestamp:a.ephemeralSetting.updatedTs});b={ack:a.ack,altIndex:void 0,author:a.id.author,ephemeralSetting:b,externalId:a.id.externalId,forwardingScore:a.forwardingScore,isForwarded:a.forwardingScore>0,msgContent:{content:((b=a.msgContent)==null?void 0:b.content)||\"\"},thread:i.chatId,threadJid:i.jid,ts:a.ts,type:d(\"MAWMsgType\").MSG_TYPE.TEXT};return d(\"MAWWriteMsgTxns\").writeMsg(e.db,b,i,{openMessageOtid:g,optimisticMsg:f}).then(function(){return d(\"WAResultOrError\").makeResult()})}else if(a.type===d(\"MAWMsgType\").MSG_TYPE.ICDC_ALERT){b={ack:a.ack,altIndex:void 0,author:a.id.author,externalId:a.id.externalId,msgContent:{adminType:a.msgContent.adminType,authorName:a.msgContent.authorName},thread:i.chatId,threadJid:i.jid,ts:a.ts,type:d(\"MAWMsgType\").MSG_TYPE.ICDC_ALERT};return d(\"MAWWriteMsgTxns\").writeMsg(e.db,b,i,{openMessageOtid:g,optimisticMsg:f}).then(function(){a.hasUnknownName&&!d(\"WAJids\").isAuthorMe(a.id.author)&&!d(\"WAJids\").isAuthorSystem(a.id.author)&&(d(\"MAWIndexedDb\").afterTransaction({tag:\"SyncContacts\",value:[d(\"WAJids\").userIdFromJid(a.id.author)]}),d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadBumpedServer\",value:{description:\"MAWMessageStore_DEPRECATED-create\",isCurrentDeviceSendingMsg:!1,lastActivityTs:d(\"WATimeUtils\").castUnixTimeToMillisTime(a.ts),lastMsgExternalId:(h||(h=d(\"I64\"))).of_string_opt(a.id.externalId),threadId:i.chatId,threadJid:i.jid}}));return d(\"WAResultOrError\").makeResult()})}else if(a.type===d(\"MAWMsgType\").MSG_TYPE.ADMIN){b={ack:a.ack,altIndex:void 0,author:d(\"WAJids\").AUTHOR_SYSTEM,externalId:a.id.externalId,msgContent:babelHelpers[\"extends\"]({},a.msgContent,{version:d(\"MAWLocalizationUtils\").isAdminMsgNormalized(a.msgContent.adminType)?1:0}),thread:i.chatId,threadJid:i.jid,ts:a.ts,type:a.type};return d(\"MAWWriteMsgTxns\").writeMsg(e.db,b,i).then(function(){return d(\"WAResultOrError\").makeResult()})}throw c(\"err\")(\"non renderable store not implemented yet\")}))};b.get=function(a){return d(\"MAWDexieCastToPromise\").dexieCastToPromise(d(\"MAWDexieTable\").dexieAll([this.db.threads.get({jid:a.chat}),this.db.messages.where(\"externalId\").equals(a.externalId).toArray()]).then(function(b){var c,e=b[0];b=b[1];if(e==null)return d(\"MAWDexieTable\").dexieResolve(null);b=b.find(function(b){return b.thread===e.chatId&&b.author===a.author});return b==null||b.type!==\"Text\"?d(\"MAWDexieTable\").dexieResolve(null):d(\"MAWDexieTable\").dexieResolve({ack:b.ack,forwardingScore:(c=b.forwardingScore)!=null?c:0,id:a,msgContent:{content:b.msgContent.content},ts:b.ts,type:b.type})}))};b.update=function(a){var b=this;return d(\"MAWDexieCastToPromise\").dexieCastToPromise(d(\"MAWDexieTable\").dexieAll([this.db.threads.get({jid:a.id.chat}),this.db.messages.where(\"externalId\").equals(a.id.externalId).toArray()]).then(function(c){var e=c[0];c=c[1];if(e==null)return d(\"MAWDexieTable\").dexieResolve(d(\"WAResultOrError\").makeError(\"missing\"));var f=c.find(function(b){return b.thread===e.chatId&&b.author===a.id.author});if(f==null||f.type!==\"Text\")return d(\"MAWDexieTable\").dexieResolve(d(\"WAResultOrError\").makeError(\"missing\"));c=f.ack<d(\"MAWAckLevel\").ACK.sent;f.ack=a.ack;f.ts=a.ts;f.serverTs=a.sentTs;var g=void 0;a.ephemeralSetting!=null&&(g={ephemeralExpirationInSec:a.ephemeralSetting.expirationTs,ephemeralLastUpdatedOrSetTimestamp:a.ephemeralSetting.updatedTs});f.ephemeralSetting=g;g=a.sentTs;var i=g==null?g:d(\"WATimeUtils\").castUnixTimeToMillisTime(g);g=i!=null&&c?b.db.threads.put(babelHelpers[\"extends\"]({},e,{lastReadMsgTs:i,newestMsgTs:i,threadOrder:d(\"MAWDbThread\").craftThreadOrder(i,e.jid)})).then(function(){f.altIndex!==d(\"MAWDbMsg\").SPAM_ALT_INDEX&&f.altIndex!==d(\"MAWDbMsg\").FUTUREPROOF_SPAM_ALT_INDEX&&d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadBumpedServer\",value:{description:\"MAWMessageStore_DEPRECATED-update\",isCurrentDeviceSendingMsg:!1,lastActivityTs:i,lastMsgExternalId:(h||(h=d(\"I64\"))).of_string_opt(a.id.externalId),threadId:e.chatId,threadJid:e.jid}})}):d(\"MAWDexieTable\").dexieResolve();return d(\"MAWDexieTable\").dexieAll([b.db.messages.put(f),g]).then(function(){var a=null;d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgUpdated\",value:d(\"MAWBridgeMsg\").createBridgeMsg(f,void 0,a)});return d(\"WAResultOrError\").makeResult()})}))};b.deleteReactionsForMsg=function(a){var b=this;return d(\"MAWDexieCastToPromise\").dexieCastToPromise(this.db.reactions.where(\"reactToExternalId\").equals(a.externalId).filter(function(b){return d(\"MAWAuthor\").getAuthorUserJid(b.reactToAuthor)===d(\"MAWAuthor\").getAuthorUserJid(a.author)&&b.threadJid===a.chat}).toArray().then(function(a){return b.db.reactions.bulkDelete(a.map(function(a){return a.rowId}))}))};b.bulkGetExpiredMsgIds=function(){return d(\"MAWDexieCastToPromise\").dexieCastToPromise(d(\"MAWGetExpiredMsgs\").getExpiredMsgs(this.db))};b.bulkDelete=function(a){var b=this,c=d(\"MAWDexieTable\").dexieAll(a.map(function(a){var c=a.author,e=a.chat;a=a.externalId;var f=d(\"MAWAuthor\").getAuthorUserJid(c);return b.db.reactions.where(\"reactToExternalId\").equals(a).filter(function(a){return d(\"MAWAuthor\").getAuthorUserJid(a.reactToAuthor)===f&&a.threadJid===e}).toArray()})).then(function(a){return a.flat()}).then(function(a){d(\"WALogger\").LOG(i(),a.length);return b.db.reactions.bulkDelete(a.map(function(a){return a.rowId}))});return d(\"MAWDexieCastToPromise\").dexieCastToPromise(d(\"MAWDbMsgTxns\").getMsgsByProtocolMsgId(this.db,a).then(function(a){var e=a.map(function(a){return a.rowId});return d(\"MAWDexieTable\").dexieAll([b.db.messages.bulkDelete(e),c]).then(function(){return e.length})}))};b.bulkGetInGroup=function(a){return d(\"MAWDexieCastToPromise\").dexieCastToPromise(this.db.messages.where(\"threadJid\").equals(a).toArray()).then(function(b){return b==null||b.length===0?[]:b.map(function(b){return{author:b.author,chat:a,externalId:b.externalId}})})};return a}();a.tableLocks={chunk:(b=d(\"MAWTransactionMode\")).READONLY,contacts:b.READONLY,groupInfo:b.READWRITE,groupInvites:b.READONLY,media:b.READONLY,messages:b.READWRITE,participants:b.READWRITE,reactions:b.READWRITE,threads:b.READWRITE,xma:b.READONLY};g.MAWMessageStore_DEPRECATED_DO_NOT_USE=a}),98);\n__d(\"MAWParticipantsStore\",[\"MAWBridgeParticipants\",\"MAWBridgeTypesCreators\",\"MAWDbParticipant\",\"MAWDbParticipantTxns\",\"MAWDbThreadTxns\",\"MAWDexieCastToPromise\",\"MAWDexieTable\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAArrayGroupBy\",\"WAArrayZip\",\"WAResultOrError\",\"WAResultOrErrorUtils\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){var b=this;this.bulkGetInGroup=function(a){return d(\"MAWDexieCastToPromise\").dexieCastToPromise(b.db.threads.get({jid:a}).then(function(a){return a!=null?d(\"MAWDbParticipantTxns\").getParticipantsInThread(b.db,a.jid).then(function(b){return d(\"WAResultOrError\").makeResult(b.map(function(b){return h(b,a.jid)}))}):d(\"WAResultOrError\").makeError(\"missing_group\")}))};this.bulkPut=function(a){return d(\"MAWDexieCastToPromise\").dexieCastToPromise(k(b.db,a.map(function(a){a=a.chatJid;return a})).then(function(b){return d(\"WAResultOrErrorUtils\").unpackValues(a.map(function(a){var c=b.get(a.chatJid);return c==null?d(\"WAResultOrError\").makeError():d(\"WAResultOrError\").makeResult({chatId:c,participant:a,participantId:d(\"MAWDbParticipant\").craftParticipantId__DEPRECATED(c,a.user)})}))}).then(function(a){return b.db.participants.bulkGet(a.map(function(a){a=a.participantId;return a})).then(function(b){return d(\"WAArrayZip\").zip(a,b).map(function(a){var b=a[0],c=b.chatId;b=b.participant;a=a[1];return{chatId:c,dbParticipantToPut:babelHelpers[\"extends\"]({deliveredWatermarkTs:d(\"WATimeUtils\").castToUnixTime(0),lastReadWatermarkTs:d(\"WATimeUtils\").castToUnixTime(0)},a,i(b,c)),existed:a!=null,participant:b}})})}).then(function(a){var c=a.map(function(a){a=a.dbParticipantToPut;return babelHelpers[\"extends\"]({},a)});return b.db.participants.bulkPut(c).then(function(){return l(b.db,a)})}))};this.bulkDelete=function(a,c){c=c||{};var e=c.remover,f=d(\"WAArrayGroupBy\").groupBy(a.map(function(a,b){return{index:b,key:a}}),function(a){a=a.key;return a.groupJid});c=f.map(function(a){a=a[0];return a});return d(\"MAWDexieCastToPromise\").dexieCastToPromise(k(b.db,c).then(function(a){return f.flatMap(function(b){var c=b[0];b=b[1];return b.map(function(b){var e=b.index;b=b.key;var f=a.get(c);return f==null?d(\"WAResultOrError\").makeError({index:e,message:\"missing_group\"}):d(\"WAResultOrError\").makeResult({chatId:f,groupJid:c,index:e,participantId:d(\"MAWDbParticipant\").craftParticipantId__DEPRECATED(f,b.userJid),participantKey:[c,b.userJid],userJid:b.userJid})})})}).then(function(a){var c=d(\"WAResultOrErrorUtils\").unpackValues(a),e=d(\"WAResultOrErrorUtils\").unpackErrors(a).map(function(a){return d(\"WAResultOrError\").makeError(a)});a=c.map(function(a){a=a.participantId;return a});return b.db.participants.bulkGet(a).then(function(a){return d(\"WAArrayZip\").zip(c,a).map(function(a){var b=a[0];a=a[1];return a==null?d(\"WAResultOrError\").makeError({index:b.index,message:\"missing_participant\"}):d(\"WAResultOrError\").makeResult(b)}).concat(e)})}).then(function(a){var c=d(\"WAResultOrErrorUtils\").unpackValues(a),f=c.map(function(a){a=a.participantKey;return a}),g=d(\"WAArrayGroupBy\").groupBy(c,function(a){a=a.chatId;return a}).map(function(a){var b=a[0];a=a[1];return[b,a.map(function(a){var b=a.groupJid;a=a.userJid;return{groupJid:b,userJid:a}})]});return d(\"MAWDbParticipantTxns\").bulkDeleteParticipants(b.db,f).then(function(){return m(b.db,g,e)}).then(function(){return a})}).then(function(a){return a.map(function(a){return a.success?{index:a.value.index,result:d(\"WAResultOrError\").makeResult()}:{index:a.error.index,result:d(\"WAResultOrError\").makeError(a.error.message)}}).sort(function(a,b){a=a.index;b=b.index;return a-b}).map(function(a){a=a.result;return a})}))};this.clear=function(){return d(\"MAWDexieCastToPromise\").dexieCastToPromise(b.db.participants.clear())};this.db=a};a.tableLocks={participants:d(\"MAWTransactionMode\").READWRITE,threads:d(\"MAWTransactionMode\").READWRITE};function h(a,b){var c=a.addressable!=null?{addressable:a.addressable}:null;return babelHelpers[\"extends\"]({chatJid:b,type:a.type,user:a.userJid},c)}function i(a,b){return{addressable:a.addressable,id:d(\"MAWDbParticipant\").craftParticipantId__DEPRECATED(b,a.user),threadId:b,threadJid:a.chatJid,type:a.type,userJid:a.user}}function j(a){return a.map(function(a){return a.user}).filter(function(a){return a===d(\"MAWGlobals\").getMyUserJid()||a===\"@me\"}).length>0}function k(a,b){var c=a.threads;return d(\"MAWDexieTable\").dexieAll(b.map(function(a){return c.get({jid:a})})).then(function(a){return new Map(a.filter(Boolean).map(function(a){var b=a.chatId;a=a.jid;return[a,b]}))})}function l(a,b){var c=b.filter(function(a){a=a.existed;return!a}).map(function(a){var b=a.chatId;a=a.participant;return{chatId:b,participant:a}});c=d(\"WAArrayGroupBy\").groupBy(c,function(a){a=a.chatId;return a}).map(function(a){var b=a[0];a=a[1];return[b,a.map(function(a){a=a.participant;return a})]});b.forEach(function(a){a=a.dbParticipantToPut;d(\"MAWIndexedDb\").afterTransaction({tag:\"ParticipantUpdated\",value:d(\"MAWBridgeParticipants\").createBridgeParticipant(a)})});b=c.filter(function(a){a[0];a=a[1];return j(a)}).map(function(a){a=a[0];return a});return d(\"MAWDbThreadTxns\").subscribeToThreads(a,b)}function m(a,b,c){b=Array.from(b);b.forEach(function(a){var b=a[0];a=a[1];return a.forEach(function(a){a=a.groupJid;return d(\"MAWIndexedDb\").afterTransaction({tag:\"UpdateE2EEMetadataParticipants\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdateE2EEMetadataParticipants(a,b)})})});var e=new Set(b.filter(function(a){a[0];a=a[1];return a.some(function(a){a=a.userJid;return a===d(\"MAWGlobals\").getMyUserJid()&&(c===d(\"MAWGlobals\").getMyUserJid()||c===\"@me\")})}).map(function(a){a=a[0];return a}));b=new Set(b.filter(function(a){a[0];a=a[1];return a.some(function(a){a=a.userJid;return a!==c&&(a===d(\"MAWGlobals\").getMyUserJid()||a===\"@me\")})}).filter(function(a){a=a[0];return!e.has(a)}).map(function(a){a=a[0];return a}));return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbThreadTxns\").archiveThreads(a,Array.from(e),!0),d(\"MAWDbThreadTxns\").unsubscribeFromThreads(a,Array.from(b))])}g.MAWParticipantsStore=a}),98);\n__d(\"MAWPendingReceiptsStore\",[\"MAWDexieCastToPromise\",\"MAWTransactionMode\",\"WAMsg\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){function a(a){this.db=a}var b=a.prototype;b.create=function(a){return d(\"MAWDexieCastToPromise\").dexieCastToPromise(this.db.pendingReceipts.put({author:a.id.author,deliveryReceipts:a.deliveryReceipts,externalId:a.id.externalId,id:d(\"WAMsg\").craftWAMsgIdString(a.id),readReceipts:a.readReceipts,thread:a.id.chat}).then(function(){}))};b.get=function(a){a=d(\"WAMsg\").craftWAMsgIdString(a);return d(\"MAWDexieCastToPromise\").dexieCastToPromise(this.db.pendingReceipts.get(a).then(function(a){return a==null?null:{deliveryReceipts:a.deliveryReceipts,id:{author:a.author,chat:a.thread,externalId:a.externalId},readReceipts:a.readReceipts}}))};b[\"delete\"]=function(a){a=d(\"WAMsg\").craftWAMsgIdString(a);return d(\"MAWDexieCastToPromise\").dexieCastToPromise(this.db.pendingReceipts[\"delete\"](a))};return a}();a.tableLocks={pendingStanzas:d(\"MAWTransactionMode\").READWRITE};g.MAWPendingReceiptsStore=a}),98);\n__d(\"MAWRunInTransaction\",[\"MAWGroupInfoStore\",\"MAWIndexedDb\",\"MAWMessageStore\",\"MAWParticipantsStore\",\"MAWPendingReceiptsStore\",\"MAWTransactionMode\",\"dexie_maw\"],(function(a,b,c,d,e,f,g){\"use strict\";var h={GroupInfoStore:d(\"MAWGroupInfoStore\").MAWGroupInfoStore.tableLocks,MessagesStore:d(\"MAWMessageStore\").MAWMessageStore_DEPRECATED_DO_NOT_USE.tableLocks,ParticipantsStore:d(\"MAWParticipantsStore\").MAWParticipantsStore.tableLocks,PendingReceiptsStore:d(\"MAWPendingReceiptsStore\").MAWPendingReceiptsStore.tableLocks};a=function(a,b,e){var f=[];for(var g in a)a[g]===!0&&f.push(g);g=f.reduce(function(a,b){b=h[b];b=Object.entries(b);for(var c=0;c<b.length;c++){var e=b[c],f=e[0];e=e[1];if(a[f]===d(\"MAWTransactionMode\").READWRITE)continue;a[f]=e}return a},{});g=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor(g,(f=e)!=null?f:\"runInTransaction\",function(e){return function(){var f={CollectionVersionStore:null,GroupInfoStore:a.GroupInfoStore===!0?new(d(\"MAWGroupInfoStore\").MAWGroupInfoStore)(e):null,MessagesStore:a.MessagesStore===!0?new(d(\"MAWMessageStore\").MAWMessageStore_DEPRECATED_DO_NOT_USE)(e):null,MissingKeyStore:null,ParticipantsStore:a.ParticipantsStore===!0?new(d(\"MAWParticipantsStore\").MAWParticipantsStore)(e):null,PendingMutationStore:null,PendingReceiptsStore:a.PendingReceiptsStore===!0?new(d(\"MAWPendingReceiptsStore\").MAWPendingReceiptsStore)(e):null,SyncActionStore:null,SyncKeyStore:null};return new(c(\"dexie_maw\").Promise)(function(a){a(b(f))})}});return g()};g.runInTransaction=a}),98);\n__d(\"WASmaxInDevicesNonRetryableIQErrorMixin\",[\"WASmaxInDevicesIQErrorBadRequestMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxInDevicesIQErrorBadRequestMixin\").parseIQErrorBadRequestMixin(a);return!b.success?b:b}g.parseNonRetryableIQErrorMixin=a}),98);\n__d(\"WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup\",[\"WAResultOrError\",\"WASmaxInDevicesNonRetryableIQErrorMixin\",\"WASmaxInDevicesRetryableIQErrorMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInDevicesRetryableIQErrorMixin\").parseRetryableIQErrorMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"RetryableIQError\",value:b.value});var c=d(\"WASmaxInDevicesNonRetryableIQErrorMixin\").parseNonRetryableIQErrorMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"NonRetryableIQError\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"RetryableIQError\",\"NonRetryableIQError\"],[b,c])}g.parseRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup=a}),98);\n__d(\"WASmaxInDevicesFetchSelfResponseError\",[\"WAResultOrError\",\"WASmaxInDevicesIQErrorResponseMixin\",\"WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInDevicesIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup\").parseRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup(c.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{errorRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup:b.value}))}g.parseFetchSelfResponseError=a}),98);\n__d(\"WASmaxInDevicesDeviceInfoMixin\",[\"WAResultOrError\",\"WASmaxInDevicesIdentityKeyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"platform\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentString(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"manufacturer\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentString(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function j(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"model\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentString(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function k(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"seen\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentInt(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function l(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"creation\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentInt(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function m(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"ip\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentString(a);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function n(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"location\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"latitude\");if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"longitude\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").contentString(a);return!a.success?a:d(\"WAResultOrError\").makeResult({latitude:b.value,longitude:c.value,elementValue:a.value})}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"device\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"platform\",h);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"manufacturer\",i);if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"model\",j);if(!e.success)return e;var f=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"seen\",k);if(!f.success)return f;var g=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"creation\",l);if(!g.success)return g;var o=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"ip\",m);if(!o.success)return o;var p=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"location\",n);if(!p.success)return p;var q=d(\"WASmaxParseUtils\").attrIntRange(a,\"id\",1,999);if(!q.success)return q;a=d(\"WASmaxInDevicesIdentityKeyMixin\").parseIdentityKeyMixin(a);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({id:q.value},a.value,{platform:b.value,manufacturer:c.value,model:e.value,seen:f.value,creation:g.value,ip:o.value,location:p.value}))}g.parseDeviceInfoPlatform=h;g.parseDeviceInfoManufacturer=i;g.parseDeviceInfoModel=j;g.parseDeviceInfoSeen=k;g.parseDeviceInfoCreation=l;g.parseDeviceInfoIp=m;g.parseDeviceInfoLocation=n;g.parseDeviceInfoMixin=a}),98);\n__d(\"WASmaxInDevicesFetchSelfResponseSuccess\",[\"WAResultOrError\",\"WASmaxInDevicesDeviceInfoMixin\",\"WASmaxInDevicesIQResultResponseMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"device\");if(!b.success)return b;b=d(\"WASmaxInDevicesDeviceInfoMixin\").parseDeviceInfoMixin(a);return!b.success?b:b}function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"self\");if(!c.success)return c;a=d(\"WASmaxInDevicesIQResultResponseMixin\").parseIQResultResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxParseUtils\").mapChildrenWithTag(c.value,\"device\",1,25,h);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{selfDevice:b.value}))}g.parseFetchSelfResponseSuccessSelfDevice=h;g.parseFetchSelfResponseSuccess=a}),98);\n__d(\"WASmaxOutDevicesBaseIQGetRequestMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(){var a=d(\"WASmaxJsx\").smax(\"iq\",{id:d(\"WAWap\").generateId(),type:\"get\"});return a}function a(a){var b=h();return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);\n__d(\"WASmaxOutDevicesFetchSelfRequest\",[\"WASmaxJsx\",\"WASmaxOutDevicesBaseIQGetRequestMixin\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(){var a=d(\"WASmaxOutDevicesBaseIQGetRequestMixin\").mergeBaseIQGetRequestMixin(d(\"WASmaxJsx\").smax(\"iq\",{to:d(\"WAWap\").S_WHATSAPP_NET,xmlns:\"fbid:devices\"},d(\"WASmaxJsx\").smax(\"self\",null)));return a}g.makeFetchSelfRequest=a}),98);\n__d(\"WASmaxDevicesFetchSelfRPC\",[\"WAComms\",\"WASmaxInDevicesFetchSelfResponseError\",\"WASmaxInDevicesFetchSelfResponseSuccess\",\"WASmaxOutDevicesFetchSelfRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a){var c,e,f,g;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:c=d(\"WASmaxOutDevicesFetchSelfRequest\").makeFetchSelfRequest();h.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(c,a));case 3:e=h.sent;f=d(\"WASmaxInDevicesFetchSelfResponseSuccess\").parseFetchSelfResponseSuccess(e,c);if(!f.success){h.next=7;break}return h.abrupt(\"return\",{name:\"FetchSelfResponseSuccess\",value:f.value});case 7:g=d(\"WASmaxInDevicesFetchSelfResponseError\").parseFetchSelfResponseError(e,c);if(!g.success){h.next=10;break}return h.abrupt(\"return\",{name:\"FetchSelfResponseError\",value:g.value});case 10:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"FetchSelf\",{Success:f,Error:g}));case 11:case\"end\":return h.stop()}},null,this)}g.sendFetchSelfRPC=a}),98);\n__d(\"MAWGetCurrentUserDeviceList\",[\"MAWGlobals\",\"WAAssertUnreachable\",\"WAGlobals\",\"WAJids\",\"WALogger\",\"WAPersistedJobManager\",\"WASignalKeys\",\"WASmaxDevicesFetchSelfRPC\",\"WATimeUtils\",\"asyncToGeneratorRuntime\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Two devices were detected as isCurrentDevice in getCurrentUserDeviceList\"]);h=function(){return a};return a}function i(a,b){if(a.isCurrentDevice&&b.isCurrentDevice){d(\"WALogger\").ERROR(h());return 0}if(a.isCurrentDevice)return-1;if(b.isCurrentDevice)return 1;if(a.lastSeen!=null&&b.lastSeen==null)return-1;if(a.lastSeen==null&&b.lastSeen!=null)return 1;if(a.lastSeen!=null&&b.lastSeen!=null){a=a.lastSeen;b=b.lastSeen;return b.getTime()-a.getTime()}return 0}a=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=(yield d(\"WASmaxDevicesFetchSelfRPC\").sendFetchSelfRPC());switch(a.name){case\"FetchSelfResponseError\":var b=a.value.errorRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup;switch(b.name){case\"RetryableIQError\":var e=b.value.backoff;if(e!=null)throw new(d(\"WAPersistedJobManager\").RetryOnBackoff)({algo:{delay:e,type:\"constant\"},jitter:0});else throw new(d(\"WAPersistedJobManager\").RetryOnBackoff)({algo:{first:d(\"WATimeUtils\").HOUR_MILLISECONDS\/60,type:\"exponential\"},jitter:.1});default:b.name;e=b.value.code;throw c(\"err\")(\"Failed with an error code \"+e)}case\"FetchSelfResponseSuccess\":var f=d(\"WAJids\").extractDeviceId(d(\"WAGlobals\").getMyDeviceJid());return a.value.selfDevice.map(function(a){var b=a.creation,c=a.elementValue,e=a.id,g=a.ip,h=a.location,i=a.manufacturer,j=a.model,k=a.platform;a=a.seen;return{creationTime:b==null?null:d(\"WATimeUtils\").toDate(d(\"WATimeUtils\").castToUnixTime(b.elementValue)),id:d(\"WAJids\").interpretAsDeviceId(e),identityKey:d(\"WASignalKeys\").serializeIdentity(c),ipAddress:(b=g==null?void 0:g.elementValue)!=null?b:null,isCurrentDevice:e===f,lastSeen:a==null?null:d(\"WATimeUtils\").toDate(d(\"WATimeUtils\").castToUnixTime(a.elementValue)),latitude:h==null?null:parseFloat(h.latitude),location:(c=h==null?void 0:h.elementValue)!=null?c:null,longitude:h==null?null:parseFloat(h.longitude),manufacturer:(g=i==null?void 0:i.elementValue)!=null?g:null,model:(b=j==null?void 0:j.elementValue)!=null?b:null,platform:(e=k==null?void 0:k.elementValue)!=null?e:null}}).sort(i);default:return c(\"WAAssertUnreachable\")(a.name)}});return function(){return a.apply(this,arguments)}}();e=d(\"MAWGlobals\").getPersistedJobsApi().definePersistedJob().finalStep(\"getCurrentUserDeviceList\",a).end();g.getCurrentUserDeviceList=e}),98);\n__d(\"MAWGetMsgIdByProtocolMsgId\",[\"MAWDbMsgTxns\",\"MAWDbReactionsTxns\",\"MAWDbUnrenderedMsgTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWMsgType\",\"MAWTransactionMode\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:(a=d(\"MAWTransactionMode\")).READONLY,reactions:a.READONLY,threads:a.READONLY,unrenderedMessages:a.READONLY},\"getMsgIdByProtocolMsgId\",function(a){return function(b){return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbMsgTxns\").maybeGetMsgResultByProtocolMsgId(a,b),d(\"MAWDbReactionsTxns\").maybeGetReactionByProtocolMsgId(a,b),d(\"MAWDbUnrenderedMsgTxns\").maybeGetUnrenderedMsgByProtocolMsgId(a,b)]).then(function(a){var b=a[0],c=a[1];a=a[2];if(b.success)return d(\"WAResultOrError\").makeResult(b.value.msgId);else if(c!=null)return d(\"WAResultOrError\").makeResult(c.reactionId);else if(a.success&&a.value.type===d(\"MAWMsgType\").MSG_TYPE.DELETE_FOR_ME)return d(\"WAResultOrError\").makeResult(a.value.msgId);var e=\"missing_msg_in_db\";b=b.error;a=a.error;if(b===\"missing_msg\"&&c==null&&a===\"missing_unrendered_msg\")e=\"missing_all_db_msg\";else if(b===\"missing_thread_msg\"&&a===\"missing_thread_unrendered_msg\")e=\"missing_all_thread\";else if(b===\"missing_thread_msg\"||a===\"missing_thread_unrendered_msg\"){e=b+\"__\"+((c=a)!=null?c:\"unrenderedMsgResultNoError\")}return d(\"WAResultOrError\").makeError(e)})}});g.getMsgIdByProtocolMsgId=b}),98);\n__d(\"MAWGetThreadsInfoApi\",[\"MAWDbChatId\",\"MAWDbThreadTxns\",\"MAWIndexedDb\",\"MAWReStoreTiming\",\"MAWRestoreDbState\",\"MAWTransactionMode\",\"WALogger\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getThreadIdByDeduplicationKey \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getThreadIdByJid \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getThreadIdByJid \",\"\"]);j=function(){return a};return a}a=d(\"MAWRestoreDbState\").isUsingShim()?d(\"MAWReStoreTiming\").measureDuration(\"getThreadIdByJid\",function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){d(\"WALogger\").DEV(j(),b);a=(yield a.table(\"e2ee_threads\").index(\"jid\").get(b));return a==null?null:d(\"MAWDbChatId\").convertToChatId(a.chatId)});return function(b,c){return a.apply(this,arguments)}}()):d(\"MAWIndexedDb\").makeMsgrTransactor({threads:d(\"MAWTransactionMode\").READONLY},\"getThreadIdByJid\",function(a){return function(b){d(\"WALogger\").DEV(i(),b);return d(\"MAWDbThreadTxns\").getThreadByJid(a,b).then(function(a){return a.success?a.value.chatId:null})}});c=d(\"MAWIndexedDb\").makeMsgrTransactor({threads:d(\"MAWTransactionMode\").READONLY},\"getThreadIdByDeduplicationKey\",function(a){return function(b){d(\"WALogger\").DEV(h(),b);return d(\"MAWDbThreadTxns\").getThreadByDeduplicationKey(a,b).then(function(a){return a.success?{chatId:a.value.chatId,jid:a.value.jid}:null})}});g.getThreadIdByJid=a;g.getThreadIdByDeduplicationKey=c}),98);\n__d(\"MAWMsgUtil\",[\"MAWDbMsgTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,media:a.READONLY,messages:a.READWRITE,xma:a.READONLY},\"updateSystemAckWithTxn\",function(a){return function(b,c){return d(\"MAWDbMsgTxns\").updateSystemAck(a,b,c).then(function(){})}});g.updateSystemAckWithTxn=b}),98);\n__d(\"MAWWriteOutgoingMsgApi\",[\"MAWAckLevel\",\"MAWAuthor\",\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDbRavenActionTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWLoadReplyMediaTxns\",\"MAWMsgType\",\"MAWTransactionMode\",\"MAWVault\",\"MAWWriteMsgTxns\",\"WAArmadilloXMA.pb\",\"WAAssertUnreachable\",\"WAJids\",\"WALogger\",\"WAStanzaUtils\",\"WATimeUtils\",\"err\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"msgToQuotedMsg: Unsupported message type \",\"\"]);h=function(){return a};return a}b=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,ephemeralSettings:a.READWRITE,groupInfo:a.READONLY,identity:a.READONLY,media:a.READONLY,messages:a.READWRITE,participants:a.READONLY,receipts:a.READWRITE,threads:a.READWRITE,unrenderedMessages:a.READWRITE,xma:a.READONLY},\"writeOutgoingMsg\",function(a){return function(b,e,f,g,h){g.content!=null&&(g.content=d(\"MAWVault\").vault(g.content));return d(\"MAWDexieTable\").dexieAll([a.threads.get({jid:e}),a.messages.where(\"externalId\").equals(b).toArray(),i(a,g.quote,e),d(\"MAWDbRavenActionTxns\").maybeGetRavenMsgQueryByProtocolMsgId(a,g.ravenProtocolMsgId,h)]).then(function(e){var i=e[0],l=e[1],n=e[2];e=e[3];if(i==null)return{type:\"missing_thread\"};l=l.find(function(a){return a.thread===i.chatId&&a.author===d(\"WAJids\").AUTHOR_ME});if(l!=null)return l.ack>=d(\"MAWAckLevel\").ACK.sent?{msgId:l.msgId,protocolMsgId:{author:d(\"WAJids\").AUTHOR_ME,chat:i.jid,externalId:l.externalId},type:\"already_sent\"}:{msgId:l.msgId,protocolMsgId:{author:d(\"WAJids\").AUTHOR_ME,chat:i.jid,externalId:l.externalId},type:\"not_sent\"};else{if(!d(\"MAWDbMsg\").isUnrenderedMsgType(h)){l={ack:d(\"MAWAckLevel\").ACK.clock,altIndex:void 0,author:d(\"WAJids\").AUTHOR_ME,ephemeralSetting:g.ephemeralSetting,externalId:b,isForwarded:g.isForwarded,specialTextSize:g.specialTextSize,thread:i.chatId,threadJid:i.jid,ts:f};var o=j(h,l,g,n),p=g.isFirstMsg,q=g.openMessageOtid,r=g.openMessageParticipantCount,s=g.optimisticMsg,t=g.participantCount;l=d(\"MAWLoadReplyMediaTxns\").getReplyMediaForMsgQuote(a,o).then(function(b){return d(\"MAWWriteMsgTxns\").writeMsg(a,o,i,{isCurrentDeviceSendingMsg:!0,isFirstMsg:p,isOutgoing:!0,openMessageOtid:q,openMessageParticipantCount:r,optimisticMsg:s,participantCount:t,quotedReplyAttachmentMeta:b,skipLocalThreadBump:c(\"gkx\")(\"23996\")})})}else{n={ack:d(\"MAWAckLevel\").ACK.clock,author:d(\"WAJids\").AUTHOR_ME,externalId:b,thread:i.chatId,threadJid:i.jid,ts:f};n=k(h,n,g,e==null?void 0:e.externalId);l=d(\"MAWWriteMsgTxns\").writeUnrenderedMsg(a,n,i)}return l.then(function(c){return m(a,h,i.jid,f).then(function(){return{msgId:c.msgId,protocolMsgId:{author:d(\"WAJids\").AUTHOR_ME,chat:i.jid,externalId:b},type:\"not_sent\"}})})}})}});function i(a,b,c){return b==null?d(\"MAWDexieTable\").dexieResolve(null):d(\"MAWDbMsgTxns\").maybeGetMsgByProtocolMsgId(a,b).then(function(b){return b==null?null:a.threads.get(b.thread).then(function(a){var e=b?l(b):null;b.messageExpirationTs!=null&&b.messageExpirationTs<d(\"WATimeUtils\").unixTime()&&e!=null&&(e=babelHelpers[\"extends\"]({},e,{mediaId:void 0,msgContent:void 0,type:d(\"MAWMsgType\").MSG_TYPE.EXPIRED_EPHEMERAL,xmaMessageType:void 0}));if(a==null||a.jid===c)return{content:e,remoteJid:null};a=d(\"WAJids\").interpretAndValidateJid(a.jid);a=a.jidType===\"group\"?a.groupJid:null;return{content:e,remoteJid:a}})})}function j(a,b,e,f){if(d(\"MAWDbMsg\").isUnrenderedMsgType(a))throw c(\"err\")(\"getNewMsg called for wrong message type \"+a);var g,h;if(e.quote!=null&&(f==null?void 0:f.content)!=null){var i;h=f==null?void 0:(i=f.content)==null?void 0:i.externalId;g={content:f==null?void 0:f.content,remoteJid:(i=f==null?void 0:f.remoteJid)!=null?i:void 0}}f=babelHelpers[\"extends\"]({},b,{quote:g,quoteExternalId:h});switch(a){case\"Text\":return babelHelpers[\"extends\"]({},f,{msgContent:{content:e.content!=null?e.content:\"\",mentionedJids:e.mentionedJids},type:d(\"MAWMsgType\").MSG_TYPE.TEXT});case\"Image\":return babelHelpers[\"extends\"]({},f,{type:d(\"MAWMsgType\").MSG_TYPE.IMAGE});case\"Video\":return babelHelpers[\"extends\"]({},f,{type:d(\"MAWMsgType\").MSG_TYPE.VIDEO});case\"Ptt\":return babelHelpers[\"extends\"]({},f,{type:d(\"MAWMsgType\").MSG_TYPE.PTT});case\"Gif\":return babelHelpers[\"extends\"]({},f,{type:d(\"MAWMsgType\").MSG_TYPE.GIF});case\"Sticker\":return babelHelpers[\"extends\"]({},f,{type:d(\"MAWMsgType\").MSG_TYPE.STICKER});case\"DocumentFile\":return babelHelpers[\"extends\"]({},f,{type:d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE});case\"XMA\":if(e.xmaMessageType==null)throw c(\"err\")(\"XMA Message Missing xmaMessageType\");i=e.content!=null&&e.xmaMessageType===d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE?e.content:\"\";return babelHelpers[\"extends\"]({},f,{msgContent:{content:i},type:d(\"MAWMsgType\").MSG_TYPE.XMA,xmaMessageType:e.xmaMessageType});case\"EditAction\":throw c(\"err\")(\"EditAction is not supported yet\");case\"BumpExistingMessage\":throw c(\"err\")(\"BumpExistingMessage is not supported yet\");case\"Revoked\":case\"DeleteForMe\":case\"Ciphertext\":case\"Futureproof\":case\"Unavailable\":case\"Admin\":case\"ExpiredEphemeral\":case\"EphemeralSettingAdmin\":case\"EphemeralScreenshotAction\":case\"AlertICDC\":case\"GroupInvite\":case\"Reaction\":case\"Raven\":case\"RavenAction\":throw c(\"err\")(\"Should not be writing ciphertext, futureproof, unsent, admin,\\n        ephemeral setting messages, ephemeral screenshot action, group invite messages\");default:throw c(\"WAAssertUnreachable\")(a)}}function k(a,b,e,f){if(!d(\"MAWDbMsg\").isUnrenderedMsgType(a))throw c(\"err\")(\"getNewUnrenderedMsg called for wrong message type \"+a);switch(a){case\"EphemeralSyncResponse\":if(e.ephemeralSetting==null)throw c(\"err\")(\"Ephemeral Sync Response without ephemeral settings\");return babelHelpers[\"extends\"]({},b,{ephemeralSetting:e.ephemeralSetting,type:d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE});case\"EphemeralSettingChangeFromCurrentDevice\":var g;if(e.ephemeralSetting==null)throw c(\"err\")(\"Ephemeral Setting Change without ephemeral settings\");return babelHelpers[\"extends\"]({},b,{ephemeralSetting:e.ephemeralSetting,isEphemeralSettingReset:(g=e.isEphemeralSettingReset)!=null?g:!1,type:d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE});case\"GroupInvite\":g=d(\"WAJids\").interpretAsGroupJid(b.threadJid);if(g==null)throw c(\"err\")(\"Group Invite without valid group jid\");if(e.invitedParticipantUserJid==null)throw c(\"err\")(\"Group Invite without invited user jid\");return babelHelpers[\"extends\"]({},b,{groupName:e.groupName==null?void 0:e.groupName,invitedParticipantUserJid:e.invitedParticipantUserJid,type:d(\"MAWMsgType\").MSG_TYPE.GROUP_INVITE});case\"SenderKeyDistribution\":return babelHelpers[\"extends\"]({},b,{type:d(\"MAWMsgType\").MSG_TYPE.SK_DISTRIBUTION});case\"RavenAction\":if(f==null)throw c(\"err\")(\"Raven Action without Raven Message External Id\");if(e.actionType==null)throw c(\"err\")(\"Raven Action without Action Type\");return babelHelpers[\"extends\"]({},b,{actionType:e.actionType,ravenActionToMsgExternalId:d(\"WAStanzaUtils\").toStanzaId(f),type:d(\"MAWMsgType\").MSG_TYPE.RAVEN_ACTION});case\"EditAction\":throw c(\"err\")(\"Edit action not implemented yet\");default:throw c(\"WAAssertUnreachable\")(a)}}function l(a){var b={author:d(\"MAWAuthor\").getAuthorUserJid(a.author)||d(\"WAJids\").AUTHOR_ME,externalId:a.externalId,mediaId:a.mediaId,msgId:a.msgId,specialTextSize:a.specialTextSize,ts:a.ts,xmaMessageType:a.xmaMessageType};switch(a.type){case d(\"MAWMsgType\").MSG_TYPE.IMAGE:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.IMAGE});case d(\"MAWMsgType\").MSG_TYPE.VIDEO:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.VIDEO});case d(\"MAWMsgType\").MSG_TYPE.PTT:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.PTT});case d(\"MAWMsgType\").MSG_TYPE.TEXT:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.TEXT});case d(\"MAWMsgType\").MSG_TYPE.STICKER:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.STICKER});case d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE});case d(\"MAWMsgType\").MSG_TYPE.GIF:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.GIF});case d(\"MAWMsgType\").MSG_TYPE.XMA:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.XMA,xmaMessageType:a.xmaMessageType});case d(\"MAWMsgType\").MSG_TYPE.REVOKED:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.UNAVAILABLE});default:d(\"WALogger\").ERROR(h(),a.type);throw c(\"err\")(\"Trying to reply to a message type that does not support replies\")}}function m(a,b,c,e){if(b===d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE)return d(\"WAJids\").switchOnMsgrChatJidType(c,{group:function(){return d(\"MAWDexieTable\").dexieResolve()},user:function(b){return a.ephemeralSettings.get({userJid:b}).then(function(b){var c;if(b==null)return d(\"MAWDexieTable\").dexieResolve();b.ephemeralSyncResponseBackoffInfo={syncResponseRetries:((c=(c=b.ephemeralSyncResponseBackoffInfo)==null?void 0:c.syncResponseRetries)!=null?c:0)+1,syncResponseSentTs:e};return a.ephemeralSettings.put(b)}).then(function(){})}});return b===d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE?d(\"WAJids\").switchOnMsgrChatJidType(c,{group:function(){return d(\"MAWDexieTable\").dexieResolve()},user:function(b){return a.ephemeralSettings.get({userJid:b}).then(function(b){if(b==null||b.ephemeralSyncResponseBackoffInfo==null)return d(\"MAWDexieTable\").dexieResolve();b.ephemeralSyncResponseBackoffInfo=void 0;return a.ephemeralSettings.put(b).then(function(){})})}}):d(\"MAWDexieTable\").dexieResolve()}g.writeOutgoingMsg=b}),98);\n__d(\"MAWSendMediaMsg\",[\"FBLogger\",\"MAWAckLevel\",\"MAWAsConsumerApplication\",\"MAWBridgeTypesCreators\",\"MAWBridgeUpload\",\"MAWCastToMsgrServerMediaType\",\"MAWDbChunkTxns\",\"MAWDbMedia\",\"MAWDbMediaTxns\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWFrontendMediaUtils\",\"MAWGetMsgIdByProtocolMsgId\",\"MAWGetThreadsInfoApi\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWJobDefinitions\",\"MAWMediaBackupTxns\",\"MAWMediaManagementTxns\",\"MAWMediaUtils\",\"MAWMsgType\",\"MAWMsgUtil\",\"MAWOptimisticUploadManager\",\"MAWQplProxy\",\"MAWStartMediaUploaQplFlow\",\"MAWTransactionMode\",\"MAWWriteOutgoingMsgApi\",\"Promise\",\"WACryptoSha256\",\"WAJids\",\"WAJobOrchestratorTypes\",\"WALogger\",\"WAMediaUtils\",\"WASendMsgUtilV2\",\"WASortedLists\",\"WAUploadMedia\",\"asyncToGeneratorRuntime\",\"err\",\"isInstamadilloEB\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to upload media: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[MAWSendMediaMsg] - msgId mismatch between put msg and got msg\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to send media: \",\" - missing thread\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAWSendMediaMsg - begin writing \",\" media msg\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Chat \",\": \",\" is received in job\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Missing required args for media backup in send media\"]);n=function(){return a};return a}function o(a,b){return p.apply(this,arguments)}function p(){p=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){var e=a.args,f=a.attachmentType,g=a.chatJid,h=a.externalId;a=a.file;d(\"WALogger\").LOG(m(),g,a.name);f=d(\"MAWFrontendMediaUtils\").getMediaTypeAndServerMediaTypeFromBlob(a.type,void 0,f);var i=f.mediaType;f=f.serverMediaType;var j;switch(i){case d(\"MAWDbMedia\").MEDIA_TYPE.IMAGE:j=d(\"MAWMsgType\").MSG_TYPE.IMAGE;break;case d(\"MAWDbMedia\").MEDIA_TYPE.VIDEO:j=d(\"MAWMsgType\").MSG_TYPE.VIDEO;break;case d(\"MAWDbMedia\").MEDIA_TYPE.PTT:j=d(\"MAWMsgType\").MSG_TYPE.PTT;break;case d(\"MAWDbMedia\").MEDIA_TYPE.GIF:j=d(\"MAWMsgType\").MSG_TYPE.GIF;break;case d(\"MAWDbMedia\").MEDIA_TYPE.STICKER:j=d(\"MAWMsgType\").MSG_TYPE.STICKER;break;case d(\"MAWDbMedia\").MEDIA_TYPE.DOCUMENT_FILE:j=d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE;break;default:c(\"FBLogger\")(\"labyrinth_web\",\"unsupported_media\").mustfix(\"unsupported media type\");throw c(\"err\")(\"Expected media msg type\")}d(\"WALogger\").LOG(l(),j);yield d(\"WASendMsgUtilV2\").getDevicesBeforeSend(g,\"SendMediaMsg\");h=(yield d(\"MAWWriteOutgoingMsgApi\").writeOutgoingMsg(h,g,b,e,j));if(h.type===\"missing_thread\"){d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(25313175,\"1551\"),\"writing_media_to_db_failed\",{instanceKey:e.s2sInstanceKey});d(\"WALogger\").LOG(k(),a.name);throw c(\"err\")(\"Failed to write msg to DB\")}return[h,{mediaType:i,serverMediaType:f}]});return p.apply(this,arguments)}function q(a,b,c,d,e){return r.apply(this,arguments)}function r(){r=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,e,f,g){f=b.mediaType;b=b.serverMediaType;var h=g.args;g.attachmentType;var k=g.chatJid;g.externalId;g=g.file;var l=d(\"MAWCastToMsgrServerMediaType\").castToMsgrServerMediaType(b);if(!l){c(\"FBLogger\")(\"labyrinth_web\",\"unsupported_media\").mustfix(\"unsupported media type\");d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(25313175,\"1551\"),\"failed_media_unsupported_type\",{instanceKey:h.s2sInstanceKey});throw c(\"err\")(\"Media type unsupported: \"+((l=b)!=null?l:\"\"))}l=(yield d(\"MAWGetMsgIdByProtocolMsgId\").getMsgIdByProtocolMsgId(a.protocolMsgId));if(!l.success){d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(25313175,\"1551\"),\"failed_media_msgid_missing_in_db\",{instanceKey:h.s2sInstanceKey});throw c(\"err\")(\"Message missing in db\")}l.value!==a.msgId&&d(\"WALogger\").ERROR(j());l=a.msgId;var m=(yield s(f,h)),n=(yield d(\"MAWGetThreadsInfoApi\").getThreadIdByJid(k));if(n==null){d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(25313175,\"1551\"),\"failed_media_missing_thread\",{instanceKey:h.s2sInstanceKey});throw c(\"err\")(\"Missing thread with jid: \"+k)}yield w(h.jpegThumbnail);yield u(n,k,a.protocolMsgId,g,e,void 0,void 0,f,m,h.offlineAttachmentId);n=d(\"MAWOptimisticUploadManager\").getOptimisticUploadManager();f=n.get(e);m=f==null?void 0:f.optimisticUploadPromise;var o=m!=null;d(\"MAWQplProxy\").sendQPLBoolAnnotationThroughBridge(c(\"qpl\")._(25313175,\"1551\"),\"isOptimisticUpload\",o,h.s2sInstanceKey);d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(25313175,\"1551\"),\"uploading_media_to_backend\",{instanceKey:h.s2sInstanceKey});var p;m!=null&&(p=(yield m),p.success||d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(25313175,\"1551\"),\"optimistic_upload_failure\",{annotations:{string:{optimisticUploadError:p.error}},instanceKey:h.s2sInstanceKey}));if(p==null||!p.success){p==null&&d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(25313175,\"1551\"),\"upload_media_when_no_existing_optimistic_upload\",{instanceKey:h.s2sInstanceKey});o=(yield d(\"MAWStartMediaUploaQplFlow\").startMediaUploaQplFlow({chatJid:k,fileSize:g.size,serverMediaType:b,uploadEntry:\"sendMediaMsg\"}));p=(yield d(\"WAUploadMedia\").uploadMedia({chatJid:k,filename:b===\"document\"?g.name:void 0,hash:e,mediaTypeDetails:{mediaType:b,type:\"regular\"},protocolMsgId:a.protocolMsgId,size:g.size,uploadMediaFlow:o}))}if(!p.success){d(\"WALogger\").LOG(i(),g.name);d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(25313175,\"1551\"),\"failed_upload_media_to_backend\",{instanceKey:h.s2sInstanceKey});return d(\"MAWMsgUtil\").updateSystemAckWithTxn(l,d(\"MAWAckLevel\").ACK.failed)}d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(25313175,\"1551\"),\"successful_upload_media_to_backend\",{instanceKey:h.s2sInstanceKey});yield y(e,l,k,a.protocolMsgId.externalId,(m=p.value)==null?void 0:m.objectId,b);yield d(\"MAWGlobals\").getJobManager().waitUntilPersisted(d(\"MAWJobDefinitions\").createStartJobInfo(\"sendWrittenMsg\",{protocolMsgId:a.protocolMsgId,s2sInstanceKey:h.s2sInstanceKey,scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.UI_ACTION},type:\"message\"}));n[\"delete\"](e);(f==null?void 0:f.previewPlaintextHash)!=null&&n[\"delete\"](f.previewPlaintextHash)});return r.apply(this,arguments)}function s(a,b){return t.apply(this,arguments)}function t(){t=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){var c=b.jpegThumbnail!=null?d(\"WAMediaUtils\").toPlaintextHash(yield d(\"WACryptoSha256\").sha256(b.jpegThumbnail)):void 0;a={validatedAudioInfo:a===\"Ptt\"&&b.duration!=null?{duration:b.duration,mimetype:d(\"MAWAsConsumerApplication\").AUDIO_MIME_TYPE,played:!1}:null,validatedDocumentFileInfo:a===\"DocumentFile\"&&b.filename!=null?{filename:b.filename,mimetype:d(\"MAWAsConsumerApplication\").FILE_MIME_TYPE}:null,validatedImageInfo:a===\"Image\"?{height:b.height,jpegThumbnail:b.jpegThumbnail,jpegThumbnailHeight:b.jpegThumbnailHeight,jpegThumbnailWidth:b.jpegThumbnailWidth,thumbnailPlaintextHash:d(\"MAWGlobals\").getConfig().isSaveThumbnailAsChunkEnabled()?c:void 0,width:b.width}:a===\"Gif\"||a===\"Sticker\"?{height:b.height,jpegThumbnailHeight:b.height,jpegThumbnailWidth:b.width,width:b.width}:null,validatedVideoInfo:a===\"Video\"?{duration:b.duration,height:b.height,jpegThumbnail:b.jpegThumbnail,jpegThumbnailHeight:b.jpegThumbnailHeight,jpegThumbnailWidth:b.jpegThumbnailWidth,mimetype:d(\"MAWAsConsumerApplication\").VIDEO_MIME_TYPE,thumbnailPlaintextHash:d(\"MAWGlobals\").getConfig().isSaveThumbnailAsChunkEnabled()?c:void 0,width:b.width}:null};return a});return t.apply(this,arguments)}a=d(\"MAWGlobals\").getPersistedJobsApi().definePersistedJob().finalStep(\"sendMediaMsg\",function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,e){d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(25313175,\"1551\"),\"received_media_in_wajob\",{instanceKey:a.args.s2sInstanceKey});b=(yield o(a,e.jobStartTime));e=b[0];b=b[1];var f=(yield d(\"MAWMediaUtils\").genBlobHashes(a.file)),g=f[0];f=f[1];yield q(e,b,g,f,a)});return function(b,c,d){return a.apply(this,arguments)}}()).end();function u(a,b,c,d,e,f,g,h,i,j){return v.apply(this,arguments)}function v(){v=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,c,e,f,g,h,i,j,k){var l,m=(yield d(\"WAMediaUtils\").blobToArrayBuffer(e));return d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(l=d(\"MAWTransactionMode\")).READWRITE,media:l.READWRITE,mediaBackup:l.READWRITE,messages:l.READWRITE,unrenderedMessages:l.READWRITE},\"attachHashAndSaveMedia\",function(l){return function(){return d(\"MAWDexieTable\").dexieAll([d(\"MAWMediaManagementTxns\").attachHashToMediaMsg(l,c,f,g,h,i,e.size,j,!1),d(\"MAWDbChunkTxns\").getOrCreateMediaChunk(l,f,m,e.type)]).then(function(c){c=c[0];d(\"MAWIndexedDb\").afterTransaction({tag:\"NewMedia\",value:d(\"MAWBridgeTypesCreators\").createBridgeMedia(a,b,c,!0,void 0,void 0,k)})})}})()});return v.apply(this,arguments)}function w(a){return x.apply(this,arguments)}function x(){x=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(!d(\"MAWGlobals\").getConfig().isSaveThumbnailAsChunkEnabled())return(h||(h=b(\"Promise\"))).resolve();if(a==null)return(h||(h=b(\"Promise\"))).resolve();var c=d(\"WAMediaUtils\").toPlaintextHash(yield d(\"WACryptoSha256\").sha256(a));return d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:d(\"MAWTransactionMode\").READWRITE},\"maybeStorePreviewMediaChunk\",function(b){return function(){return d(\"MAWDbChunkTxns\").getOrCreateMediaChunk(b,c,a,\"image\/jpeg\").then(function(){return d(\"MAWDexieTable\").dexieResolve()})}})()});return x.apply(this,arguments)}function y(a,e,f,g,i,j){var k=d(\"MAWOptimisticUploadManager\").getOptimisticUploadManager(),l=k.get(a),m=l==null?void 0:l.mediaEntry;if(l==null)return(h||(h=b(\"Promise\"))).resolve();k.set(a,babelHelpers[\"extends\"]({},l,{msgId:e}));return m==null?(h||(h=b(\"Promise\"))).resolve():d(\"MAWIndexedDb\").makeMsgrTransactor({media:d(\"MAWTransactionMode\").READWRITE,mediaBackup:d(\"MAWTransactionMode\").READWRITE,threads:d(\"MAWTransactionMode\").READONLY},\"maybePersistMediaEntry\",function(b){return function(){return d(\"MAWDbMediaTxns\").maybeGetMediaFromPlaintextHash(b,a).then(function(a){if(a){var h=babelHelpers[\"extends\"]({},a,{mediaEntries:a.mediaEntries.set(e,m),msgIds:d(\"WASortedLists\").addToSet(a.msgIds,e)});i!=null&&(h=babelHelpers[\"extends\"]({},h,{objectId:d(\"WAMediaUtils\").stringToDeliveryObjectId(i)}));var k=d(\"WAMediaUtils\").decodeMediaEntryData(m);return b.media.update(a.mediaId,h).then(function(c){return i!=null?d(\"MAWMediaBackupTxns\").linkMediaBackup(b,a.mediaId,e,d(\"WAMediaUtils\").stringToDeliveryObjectId(i)):d(\"MAWDexieTable\").dexieResolve()}).then(function(){var a=d(\"MAWCastToMsgrServerMediaType\").castToMsgrServerMediaType(j),e=k.mediaKeyTimestamp;if(i!=null&&a!=null&&e!=null&&!c(\"isInstamadilloEB\")())return d(\"MAWDbThreadTxns\").getThreadByJid(b,f).then(function(b){b.success&&a!==\"document\"&&d(\"MAWIndexedDb\").afterTransaction({tag:\"UploadAttachment\",value:d(\"MAWBridgeUpload\").createBridgeUploadAttachment(b.value.chatId,i,a,g,d(\"MAWGlobals\").getConfig().productTypeForEBAttachments,d(\"WAJids\").threadIdForChatJid(f),f,e)})});else d(\"WALogger\").WARN(n())})}else throw c(\"err\")(\"media should already exist upon this point\")})}})()}g.writeToDb=o;g.saveAndPassOff=q;g.sendMediaMsg=a;g.maybePersistMediaEntry=y}),98);\n__d(\"MAWMessageReceiveReliabilityLogger\",[\"MAWExternalId\",\"MAWGetStorageQplAnnotations\",\"MAWGlobals\",\"MAWQplProxy\",\"WAGlobals\",\"WAJids\",\"WALogger\",\"WAMapContentTypeToFbType\",\"WAPREList\",\"WAPREMetrics\",\"WATimeUtils\",\"promiseDone\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"start decrypt\"]);h=function(){return a};return a}var i=new Map(),j=new Map();function a(a){a.subscribe(function(a){switch(a.type){case\"new-message\":var b=o(a.commonMessageBase,a.msg,a.id);c(\"promiseDone\")(d(\"MAWGetStorageQplAnnotations\").getStorageQplAnnotations().then(function(a){b.addAnnotations(a)}));i.set(a.id,b);var e=[];a.msg.type===\"Available\"?e.push(a.msg.encType):a.msg.type===\"SingleEnc\"?e.push(a.msg.enc.encType):a.msg.type===\"DualEnc\"&&e.push(a.msg.senderKeyDistributionEnc.encType,a.msg.senderKeyMessageEnc.encType);b.addPoint(\"wa-receive-message\",{string_array:{encTypes:e}});a.msg.type===\"Unavailable\"&&n(b);return;case\"unavailable-reaction\":e=i.get(a.id);if(e==null)return;e.endFail(\"drop_unavailable_reaction_msg\");i[\"delete\"](a.id);return;case\"decrypt-start\":d(\"WALogger\").DEV(h());m(a);break;case\"decrypt-skdm-done\":var f;e={bool:{skdmSuccess:!!a.result.success},string:{skdmError:(e=a.result.error)!=null?e:\"\"}};(f=i.get(a.id))==null?void 0:f.addPoint(\"skdm-done\",e);(f=j.get(a.id))==null?void 0:f.addPoint(\"skdm-done\",e);break;case\"decrypt-fail\":l(a.errorResult,a.id);break;case\"decrypt-end\":k(a.id);break;case\"duplicated-msg\":(f=i.get(a.id))==null?void 0:f.addPoint(\"errDuplicateMsg_with_msg_\"+a.duplicationType,{string:{decryptResult:a.duplicationType===\"exist\"||a.duplicationType===\"in-stanzaQueue\"?\"SUCCESS\":\"errDuplicateMsg\"}});if(a.duplicationType===\"exist\"||a.duplicationType===\"in-stanzaQueue\"){(e=i.get(a.id))==null?void 0:e.endSuccess();i[\"delete\"](a.id)}break;case\"persist-start\":(f=i.get(a.id))==null?void 0:f.addPoint(\"message_protocol_queue_persist_start\");break;case\"persist-end\":(e=i.get(a.id))==null?void 0:e.addPoint(\"message_protocol_queue_persist_end\");i[\"delete\"](a.id);break;case\"persist-fail\":(f=i.get(a.id))==null?void 0:f.endFail(\"message_protocol_queue_persist_fail\");i[\"delete\"](a.id);break;case\"issue-retry\":(e=i.get(a.id))==null?void 0:e.addPoint(\"process_retries\");d(\"MAWGlobals\").getOfflineResumeStats().addRetriesTrack(1);break;case\"franking-drop\":(f=i.get(a.id))==null?void 0:f.endFail(\"drop_franking_invalid_msg\");i[\"delete\"](a.id);break;case\"invisible-msg-done\":(e=i.get(a.id))==null?void 0:e.endSuccess();i[\"delete\"](a.id);break;default:a;return}})}function k(a){var b;(b=j.get(a))==null?void 0:b.endSuccess();j[\"delete\"](a);b=i.get(a);if(b==null)return;a=(a=d(\"MAWGlobals\").getOfflineResumeStats().getDetails())!=null?a:{};var c=a.expectedCount;a=a.expectedMessage;c={\"int\":{mailboxMessagesSize:(a=a)!=null?a:0,mailboxSize:(a=c)!=null?a:0},string:{decryptResult:\"SUCCESS\"}};b.addPoint(\"decrypt_end\",c)}function l(a,b){var c=a.error;a=a.payload;if(c===\"errDuplicateMsg\"){var e;(e=j.get(b))==null?void 0:e.addPoint(c);(e=j.get(b))==null?void 0:e.endSuccess()}else{(e=j.get(b))==null?void 0:e.endFail(c)}j[\"delete\"](b);d(\"MAWGlobals\").getOfflineResumeStats().addDecryptionError();e=i.get(b);if(e==null)return;b=(b=d(\"MAWGlobals\").getOfflineResumeStats().getDetails())!=null?b:{};var f=b.expectedCount;b=b.expectedMessage;b={\"int\":{mailboxMessagesSize:(b=b)!=null?b:0,mailboxSize:(b=f)!=null?b:0},string:{decryptResult:c,payload:a==null?void 0:(f=a.message)==null?void 0:f.toString==null?void 0:f.toString()}};e.addPoint(\"decrypt_failure\",b);e.addPoint(\"decrypt_end\")}function m(a){var b=a.commonMessageBase,c=a.id,e=a.msg,f=[],g=0;e.type===\"Available\"?(f.push(e.encType),g=e.ciphertext.byteLength):e.type===\"SingleEnc\"?(f.push(e.enc.encType),g=e.enc.ciphertext.byteLength):(e.type,f.push(e.senderKeyDistributionEnc.encType,e.senderKeyMessageEnc.encType),g=e.senderKeyDistributionEnc.ciphertext.byteLength+e.senderKeyMessageEnc.ciphertext.byteLength);(a=i.get(a.id))==null?void 0:a.addPoint(\"decrypt_start\",{\"int\":{ciphertextByteLength:g}});a=d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.MESSAGE_DECRYPTION,{bool:{hideDecryptError:b.hideDecryptionFailure,isGroup:e.type!==\"Available\",isMultiDomainReg:d(\"WAGlobals\").getConfig().isDeviceRegistrationDomainUniquenessEnabled(),isPeerDevice:d(\"WAJids\").isAuthorMe(e.author),useIncreasedSignalFutureMessagesMax:d(\"WAGlobals\").getConfig().getSignalFutureMessagesMax()>2e3,useLongSessionDrop:d(\"WAGlobals\").getConfig().useLongSessionDrop(),useUpdatedSenderKeySession:d(\"WAGlobals\").getConfig().useUpdatedSenderKeySession()},\"int\":{msgId:c,offlineCount:b.offline,retryCount:e.retryCount,signalFutureMessagesMax:d(\"WAGlobals\").getConfig().getSignalFutureMessagesMax()},string:{e2eePlatform:d(\"MAWExternalId\").getPlatform(b.stanzaId),jid:e.chat,queue:b.offline!=null?\"offline\":\"online\",type:f[0],userHash:d(\"WAGlobals\").getConfig().isEmployee()&&d(\"WAGlobals\").getConfig().isUseridAnnotationEnabled()?d(\"WAJids\").extractUserId(d(\"WAGlobals\").getMyUserJid()).slice(-5):null},string_array:{encTypes:f}},void 0);j.set(c,a)}function n(a){var b;b=(b=d(\"MAWGlobals\").getOfflineResumeStats().getDetails())!=null?b:{};var c=b.expectedCount;b=b.expectedMessage;a.addPoint(\"unavailable-message\",{\"int\":{mailboxMessagesSize:(a=b)!=null?a:0,mailboxSize:(b=c)!=null?b:0},string:{decryptedMsgType:\"UnavailableMsg\",decryptResult:\"SUCCESS\"}})}function o(a,b,e){b={bool:{waDanglingQueue:d(\"WAGlobals\").getConfig().waDanglingQueue()},\"int\":{messageAge:d(\"WATimeUtils\").unixTime()-a.serverTs,msgId:e,offlineDelivery:a.offline},string:{jid:b.chat,msgType:d(\"WAMapContentTypeToFbType\").mapContentTypeToFbType(b.contentType),queueType:a.offline!=null?\"offline\":\"online\",threadType:\"device\",userHash:d(\"WAGlobals\").getConfig().isEmployee()&&d(\"WAGlobals\").getConfig().isUseridAnnotationEnabled()?d(\"WAJids\").extractUserId(d(\"WAGlobals\").getMyUserJid()).slice(-5):null}};return d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(1056840931,\"814\"),b,e)}g.subscribeToIncomingMessageEvents=a}),98);\n__d(\"MAWCreateJobNotImplemented\",[\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" not implemented for MAW\"]);h=function(){return a};return a}function a(a){return[{info:function(b,c){return{code:function(){d(\"WALogger\").WARN(h(),a)},requirements:null}},stepName:\"NOT_IMPLEMENTED\"}]}g.createNotImplementedJob=a}),98);\n__d(\"MAWMediaTypeAttribute\",[\"MAWMsgType\",\"WAAssertUnreachable\",\"WAWap\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){if(a==null)return d(\"WAWap\").DROP_ATTR;switch(a.type){case d(\"MAWMsgType\").MSG_TYPE.IMAGE:return\"image\";case d(\"MAWMsgType\").MSG_TYPE.VIDEO:return\"video\";case d(\"MAWMsgType\").MSG_TYPE.PTT:return\"ptt\";case d(\"MAWMsgType\").MSG_TYPE.GIF:return\"gif\";case d(\"MAWMsgType\").MSG_TYPE.STICKER:return\"sticker\";case d(\"MAWMsgType\").MSG_TYPE.XMA:return\"xma-image\";case d(\"MAWMsgType\").MSG_TYPE.DOCUMENT_FILE:return\"document\";case d(\"MAWMsgType\").MSG_TYPE.TEXT:case d(\"MAWMsgType\").MSG_TYPE.FUTUREPROOF:case d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT:case d(\"MAWMsgType\").MSG_TYPE.UNAVAILABLE:case d(\"MAWMsgType\").MSG_TYPE.EXPIRED_EPHEMERAL:case d(\"MAWMsgType\").MSG_TYPE.REVOKED:case d(\"MAWMsgType\").MSG_TYPE.ADMIN:case d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d(\"MAWMsgType\").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d(\"MAWMsgType\").MSG_TYPE.ICDC_ALERT:case d(\"MAWMsgType\").MSG_TYPE.GROUP_INVITE:case d(\"MAWMsgType\").MSG_TYPE.RAVEN:case d(\"MAWMsgType\").MSG_TYPE.EDIT_ACTION:case d(\"MAWMsgType\").MSG_TYPE.BUMP_EXISTING_MESSAGE:return d(\"WAWap\").DROP_ATTR;default:return c(\"WAAssertUnreachable\")(a.type)}}g.getMediaTypeAttribute=a}),98);\n__d(\"MAWSpamReportUtils\",[\"I64\",\"LSIntEnum\",\"MAWAsMessageApplication\",\"MAWGlobals\",\"MAWMediaTypeAttribute\",\"MAWMediaUtils\",\"MAWMsgType\",\"WAJids\",\"WAMsgApplication.pb\",\"WAWap\",\"encodeProtobuf\",\"err\",\"justknobx\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i;function a(a,b,c,e){var f,g=(h||(h=d(\"I64\"))).to_string(a.timestampMs),j=a.isUnsent?d(\"WAWap\").CUSTOM_STRING(\"1\"):d(\"WAWap\").CUSTOM_STRING(\"0\"),k=d(\"WAWap\").DROP_ATTR,l,m,n=d(\"WAWap\").DROP_ATTR;f=(f=a==null?void 0:a.text)!=null?f:null;if((h||(h=d(\"I64\"))).equal(a.displayedContentTypes,(i||(i=d(\"LSIntEnum\"))).ofNumber(131072))&&f!==null)f=new TextEncoder().encode(f),l=d(\"WAWap\").DROP_ATTR,m=d(\"WAWap\").CUSTOM_STRING(\"3\");else if((h||(h=d(\"I64\"))).equal(a.displayedContentTypes,(i||(i=d(\"LSIntEnum\"))).ofNumber(65536)))f=null,l=d(\"WAWap\").DROP_ATTR,m=d(\"WAWap\").DROP_ATTR;else if((h||(h=d(\"I64\"))).equal(a.displayedContentTypes,(i||(i=d(\"LSIntEnum\"))).ofNumber(256))||a.isUnsent){var o=d(\"MAWAsMessageApplication\").asMessageApplicationLSDb(a);f=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAMsgApplication.pb\").MessageApplicationSpec,o).readByteArray();l=\"text\";m=d(\"WAWap\").CUSTOM_STRING(\"3\");n=a.isUnsent?d(\"WAWap\").CUSTOM_STRING(\"7\"):d(\"WAWap\").DROP_ATTR}else{o=d(\"MAWAsMessageApplication\").asMessageApplicationLSDb(a);f=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAMsgApplication.pb\").MessageApplicationSpec,o).readByteArray();l=\"text\";m=d(\"WAWap\").CUSTOM_STRING(\"3\")}return d(\"WAWap\").wap(\"message\",{edit:n,from:c!=null?d(\"WAWap\").GROUP_JID(c):e!=null?d(\"WAWap\").USER_JID(e):d(\"WAWap\").DROP_ATTR,id:d(\"WAWap\").CUSTOM_STRING(a.messageId),participant:e!=null?d(\"WAWap\").USER_JID(e):d(\"WAWap\").DROP_ATTR,t:d(\"WAWap\").CUSTOM_STRING(g),to:b!=null?d(\"WAWap\").USER_JID(b):d(\"WAWap\").DROP_ATTR,type:l,unsent:j},d(\"WAWap\").wap(\"raw\",{mediatype:k,v:m},f))}function j(a){var b;if(((b=a.reportingMeta)==null?void 0:b.reportingContent)!=null){return{content:(b=a.reportingMeta)==null?void 0:b.reportingContent,shouldIgnoreFranking:!1}}b=(b=a.serverTs)!=null?b:a.ts;return b<=1708459984?{content:null,shouldIgnoreFranking:!0}:{content:null,shouldIgnoreFranking:!1}}function b(a,b,c,d,e,f,g,h){var i=[];i.push(k(a,b,d,e,f,g,h));if(c!=null)for(var a=c,c=Array.isArray(a),j=0,a=c?a:a[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var l;if(c){if(j>=a.length)break;l=a[j++]}else{j=a.next();if(j.done)break;l=j.value}l=l;i.push(k(l,b,d,e,f,g,h))}return i}function k(a,b,e,f,g,h,i){i=i?d(\"WAWap\").CUSTOM_STRING(\"1\"):d(\"WAWap\").CUSTOM_STRING(\"0\");var k=a.type===d(\"MAWMsgType\").MSG_TYPE.REVOKED?d(\"WAWap\").CUSTOM_STRING(\"1\"):d(\"WAWap\").CUSTOM_STRING(\"0\"),l=d(\"WAWap\").DROP_ATTR,m,n,o,p,q=d(\"WAWap\").DROP_ATTR,r=!1;if(a.editMsgHistoryId!=null){if(a.editExternalId==null)return null;p=a.editExternalId;o=(a.editTs*1e3).toString();var s=d(\"MAWAsMessageApplication\").asEditMessageApplication(a);m=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAMsgApplication.pb\").MessageApplicationSpec,s).readByteArray();s=\"text\";n=d(\"WAWap\").CUSTOM_STRING(\"3\")}else if(a.type===d(\"MAWMsgType\").MSG_TYPE.FUTUREPROOF){var t;m=new Uint8Array(a.msgContent.protobuf);o=(((t=a.serverTs)!=null?t:a.ts)*1e3).toString();s=d(\"WAWap\").DROP_ATTR;n=d(\"WAWap\").CUSTOM_STRING(\"3\");p=a.externalId}else if(a.type===d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT){o=(((t=a.serverTs)!=null?t:a.ts)*1e3).toString();m=null;s=d(\"WAWap\").DROP_ATTR;n=d(\"WAWap\").DROP_ATTR;p=a.externalId}else if(a.type===d(\"MAWMsgType\").MSG_TYPE.REVOKED||a.type===d(\"MAWMsgType\").MSG_TYPE.DELETE_FOR_ME){t=d(\"MAWAsMessageApplication\").deletedMsgAsMessageApplicationForSpamReporting(a);if(t==null)return null;m=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAMsgApplication.pb\").MessageApplicationSpec,t).readByteArray();s=\"text\";n=d(\"WAWap\").CUSTOM_STRING(\"3\");p=a.externalId;q=a.type===d(\"MAWMsgType\").MSG_TYPE.REVOKED?d(\"WAWap\").CUSTOM_STRING(\"7\"):d(\"WAWap\").DROP_ATTR;b!=null&&(l=d(\"MAWMediaUtils\").getServerMediaTypeFromMediaType(b.mediaType));if(!h){t=j(a);t.content!=null&&(m=t.content);r=t.shouldIgnoreFranking}o=a.originalTs!=null?(a.originalTs*1e3).toString():(((t=a.serverTs)!=null?t:a.ts)*1e3).toString()}else{if(!h){t=j(a);t.content!=null&&(m=t.content);r=t.shouldIgnoreFranking}if(h||m==null){t=d(\"MAWAsMessageApplication\").asMessageApplication(a,b);m=d(\"encodeProtobuf\").encodeProtobuf(d(\"WAMsgApplication.pb\").MessageApplicationSpec,t).readByteArray()}a.type===\"Image\"||a.type===\"Ptt\"||a.type===\"Video\"||a.type===\"Gif\"?s=\"media\":s=\"text\";n=d(\"WAWap\").CUSTOM_STRING(\"3\");l=d(\"MAWMediaTypeAttribute\").getMediaTypeAttribute(a);o=(((h=a.serverTs)!=null?h:a.ts)*1e3).toString();p=a.externalId}b=null;if(d(\"MAWGlobals\").getConfig().isFrankingEnabled()&&((t=a.reportingMeta)==null?void 0:t.frankingTag)!=null&&((h=a.reportingMeta)==null?void 0:h.reportingTag)!=null&&!r){b=d(\"WAWap\").wap(\"franking\",null,d(\"WAWap\").wap(\"franking_tag\",null,(t=a.reportingMeta)==null?void 0:t.frankingTag),d(\"WAWap\").wap(\"reporting_tag\",null,(h=a.reportingMeta)==null?void 0:h.reportingTag))}(a.type===d(\"MAWMsgType\").MSG_TYPE.REVOKED||a.type===d(\"MAWMsgType\").MSG_TYPE.DELETE_FOR_ME)&&c(\"justknobx\")._(\"1753\")&&(b=null);return d(\"WAWap\").wap(\"message\",{edit:q,from:f!=null?d(\"WAWap\").GROUP_JID(f):g!=null?d(\"WAWap\").USER_JID(g):d(\"WAWap\").DROP_ATTR,id:d(\"WAWap\").CUSTOM_STRING(p),participant:g!=null?d(\"WAWap\").USER_JID(g):d(\"WAWap\").DROP_ATTR,selected:i,t:d(\"WAWap\").CUSTOM_STRING(o),to:e!=null?d(\"WAWap\").USER_JID(e):d(\"WAWap\").DROP_ATTR,type:s,unsent:k},d(\"WAWap\").wap(\"raw\",{mediatype:l,v:n},m),b)}function e(a){var b;a.author===d(\"WAJids\").AUTHOR_ME?b=d(\"MAWGlobals\").getMyUserJid():b=d(\"WAJids\").authorAsUserJid(a.author);if(b==null)throw c(\"err\")(\"Impossible message author\");return b}function f(a,b){a.author===d(\"WAJids\").AUTHOR_ME?a=b:a=d(\"MAWGlobals\").getMyUserJid();if(a==null)throw c(\"err\")(\"Impossible message recipient\");return a}g.formatLSDbMsgForSpamReport=a;g.getformattedMsgsForSpamReport=b;g.getAuthorAsJidForSpam=e;g.getRecipientAsJidForSpam=f}),98);\n__d(\"MAWGetAppDataApi\",[\"MAWAckLevel\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Trying to send appdata with no permitted identities\"]);h=function(){return a};return a}a=d(\"MAWIndexedDb\").makeMsgrTransactor({appData:d(\"MAWTransactionMode\").READWRITE},\"getAppData\",function(a){return function(b){return a.appData.get({externalId:b}).then(function(b){if(b==null)return{type:\"missing\"};else if(b.permittedIdentitiesPerDevice.size===0){d(\"WALogger\").ERROR(h());return a.appData[\"delete\"](b.appDataId).then(function(){return{type:\"missing\"}})}else if(b.ack>=d(\"MAWAckLevel\").ACK.sent)return{appData:b.contents,permittedIdentitiesPerDevice:b.permittedIdentitiesPerDevice,sendPartial:!0,type:\"already_sent\"};else return{appData:b.contents,permittedIdentitiesPerDevice:b.permittedIdentitiesPerDevice,sendPartial:b.sendPartial===!0,type:\"not_sent\"}})}});g.getAppData=a}),98);\n__d(\"MAWGetAppDataForResendApi\",[\"MAWDbIdentityTxns\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"MAWUpdateDevicesForUserApi\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Trying to resend appdata with no permitted identities\"]);h=function(){return a};return a}a=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor({appData:d(\"MAWTransactionMode\").READWRITE,identity:d(\"MAWTransactionMode\").READONLY},\"getAppDataForResend\",function(a){return function(b){return a.appData.get({externalId:b}).then(function(b){return b==null?{type:\"missing\"}:d(\"MAWUpdateDevicesForUserApi\").getAllDeviceJidsForUser(a,d(\"MAWGlobals\").getMyUserJid()).then(function(a){var c=d(\"MAWGlobals\").getMyDeviceJid();return a.filter(function(a){return c!==a&&!b.recipientDevices.has(a)&&!b.permittedIdentitiesPerDevice.has(a)})}).then(function(b){return d(\"MAWDbIdentityTxns\").getIdentitiesForDevices(a,b)}).then(function(c){if(c.size===0)if(b.permittedIdentitiesPerDevice.size===0){d(\"WALogger\").ERROR(h());return a.appData[\"delete\"](b.appDataId).then(function(){return{type:\"missing\"}})}else return{appData:b.contents,permittedIdentitiesPerDevice:c,sendPartial:!0,type:\"already_sent\"};var e=new Map([].concat(Array.from(b.permittedIdentitiesPerDevice),Array.from(c))),f=new Set([].concat(Array.from(b.recipientDevices),Array.from(e.keys())));return a.appData.update(b.appDataId,{permittedIdentitiesPerDevice:e,recipientDevices:f}).then(function(){return{appData:b.contents,permittedIdentitiesPerDevice:c,sendPartial:!0,type:\"not_sent\"}})})})}});g.getAppDataForResend=a}),98);\n__d(\"MAWGetAppDataForRetryApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=30*d(\"WATimeUtils\").DAY_SECONDS;a=d(\"MAWIndexedDb\").makeMsgrTransactor({appData:d(\"MAWTransactionMode\").READONLY},\"getAppDataForRetry\",function(a){return function(b,c){return a.appData.get({externalId:b}).then(function(a){if(a==null)return{type:\"missing\"};var b=a.permittedIdentitiesPerDevice.get(c);return b==null||!d(\"WATimeUtils\").happenedWithin(a.ts,h)?{type:\"unauthorized\"}:{appData:a.contents,deviceIdentity:b,permittedIdentitiesPerDevice:a.permittedIdentitiesPerDevice,type:\"unacked\"}})}});g.getAppDataForRetry=a}),98);\n__d(\"MAWMarkAppDataDroppedApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({appData:d(\"MAWTransactionMode\").READWRITE},\"markAppDataDropped\",function(a){return function(b){return a.appData.get({externalId:b}).then(function(b){if(b!=null)return a.appData[\"delete\"](b.appDataId)})}});g.markAppDataDropped=a}),98);\n__d(\"MAWMarkAppDataSendFailedApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({appData:d(\"MAWTransactionMode\").READWRITE},\"markAppDataSendFailed\",function(a){return function(b){return a.appData.where(\"externalId\").equals(b)[\"delete\"]().then(function(){})}});g.markAppDataSendFailed=a}),98);\n__d(\"MAWMarkAppDataSentApi\",[\"MAWAckLevel\",\"MAWDbAppDataTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({appData:d(\"MAWTransactionMode\").READWRITE},\"markAppDataSent\",function(a){return function(b){return d(\"MAWDbAppDataTxns\").updateAppDataSystemAck(a,b,d(\"MAWAckLevel\").ACK.sent).then(function(){})}});g.markAppDataSent=a}),98);\n__d(\"MAWWriteAppDataRetryApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({appData:d(\"MAWTransactionMode\").READWRITE},\"writeAppDataRetry\",function(a){return function(b,c,d){return a.appData.get({externalId:b}).then(function(b){if(b==null)return;var e=b.permittedIdentitiesPerDevice,f=e.get(c);if(f==null)return;f.baseKey=d;e.set(c,f);return a.appData.update(b.appDataId,{permittedIdentitiesPerDevice:e}).then(function(){})})}});g.writeAppDataRetry=a}),98);\n__d(\"MAWArchiveThreadApi\",[\"MAWDbThreadTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({threads:d(\"MAWTransactionMode\").READWRITE},\"archiveThread\",function(a){return function(b){return d(\"MAWDbThreadTxns\").archiveThreads(a,[b],!1).then(function(){})}});g.archiveThread=a}),98);\n__d(\"MAWBackfillThreadsForOccamadilloApi\",[\"MAWBridgeThread\",\"MAWDbAppMeta\",\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[Occamadillo] Backfilled \",\" threads\"]);h=function(){return a};return a}a=d(\"MAWIndexedDb\").makeMsgrTransactor({appMeta:d(\"MAWTransactionMode\").READWRITE,messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"backfillThreadsForOccamadillo\",function(a){return function(){return a.appMeta.get(d(\"MAWDbAppMeta\").AppMetaKeysEnum.isBackfilledForOccamadillo).then(function(b){return(b==null?void 0:b.value.isBackfilledForOccamadillo)===!0?d(\"MAWDexieTable\").dexieResolve():a.threads.toArray().then(function(b){b.forEach(function(b){return d(\"MAWDbMsgTxns\").getIsThreadEmpty(a,b).then(function(a){a||d(\"MAWIndexedDb\").afterTransaction({tag:\"VerifyThreadExists\",value:d(\"MAWBridgeThread\").createBridgeThread(b,void 0,void 0,\"backfillThreadsForOccamadillo\")})})});return a.appMeta.put({key:d(\"MAWDbAppMeta\").AppMetaKeysEnum.isBackfilledForOccamadillo,value:{isBackfilledForOccamadillo:!0}}).then(function(){d(\"WALogger\").LOG(h(),b.length)})})})}});g.backfillThreadsForOccamadillo=a}),98);\n__d(\"MAWBulkCreateThread\",[\"MAWDexieTable\",\"MAWGetOrCreateThreadTxns\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWLoadThreadsTxns\",\"MAWThreadManagementTxns\",\"MAWTransactionMode\",\"WAJids\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READWRITE,editMsgHistory:a.READONLY,groupInfo:a.READWRITE,media:a.READWRITE,messages:a.READWRITE,participants:a.READWRITE,reactions:a.READONLY,threads:a.READWRITE,xma:a.READONLY},\"bulkCreateThreadByJid\",function(a){return function(b){b=b.threads;return d(\"MAWDexieTable\").dexieAllSettled(b.map(function(b){var c=b.authoritativeThreadKey,e=b.chatJid,f=b.lastActivityTimestampMs,g=b.lastReadWatermarkTimestampMs,h=b.numOfMsgsToLoad,i=d(\"WATimeUtils\").castToMillisTime(f),j=d(\"WATimeUtils\").castToMillisTime(g),k=d(\"MAWGlobals\").getMyUserJid();return d(\"WAJids\").switchOnMsgrChatJidType(e,{group:function(b){return d(\"MAWGetOrCreateThreadTxns\").getOrCreateThread(a,{authoritativeThreadKey:c,description:\"createThreadThroughMI\",jid:b,lastActivityTimestamp:i,lastReadWatermarkTimestamp:j})},user:function(b){return d(\"MAWThreadManagementTxns\").getOrSetupOneToOneThread(a,{authoritativeThreadKey:c,lastActivityTimestamp:i,lastReadWatermarkTimestamp:j,userJid:b})}}).then(function(b){var c=d(\"WAJids\").interpretAsGroupJid(b.thread.jid),e=c!=null;c=b.thread?b.thread:b;return d(\"MAWDexieTable\").dexieAll([d(\"MAWLoadThreadsTxns\").loadParticipantsAndMsgs(a,b.created&&e,c,(c=h)!=null?c:1)]).then(function(a){a=a[0];a=e&&(b.created||a.length===0||a.some(function(a){return a.addressable!==!0}));e&&d(\"MAWIndexedDb\").afterTransaction({tag:\"GroupInviteLoaded\",value:{actorId:d(\"WAJids\").extractUserId(k),threadId:b.thread.chatId,threadJid:b.thread.jid}});return{chatId:b.thread.chatId,chatJid:b.thread.jid,isCreated:b.created,shouldQueryForGroup:a}})})}))}});g.bulkCreateThread=b}),98);\n__d(\"MAWChangeSecurityAlertSettingApi\",[\"MAWDbMsgTypeVersionTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({appMeta:d(\"MAWTransactionMode\").READWRITE},\"changeSecurityAlertSetting\",function(a){return function(b){return d(\"MAWDbMsgTypeVersionTxns\").updateSecurityAlertValueForContact(a,b)}});g.changeSecurityAlertSetting=a}),98);\n__d(\"MAWChangeSecurityAlertSettingForSelfApi\",[\"MAWDbMsgTypeVersionTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({appMeta:d(\"MAWTransactionMode\").READWRITE},\"changeSecurityAlertSettingForSelf\",function(a){return function(b){return d(\"MAWDbMsgTypeVersionTxns\").updateSecurityAlertValueForSelf(a,b)}});g.changeSecurityAlertSettingForSelf=a}),98);\n__d(\"MAWCheckIfShowOpenMessageHistoryApi\",[\"MAWIndexedDb\",\"MAWLocalizationType\",\"MAWMsgType\",\"MAWTimeUtils\",\"MAWTransactionMode\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"checkIfShowOpenMessageHistory\",function(a){return function(b,c){return a.threads.get(b).then(function(b){if(b==null||b.isMigratedLocally!=null&&b.isMigratedLocally)return!0;b=a.messages.where([\"threadJid\",\"sortOrderMs\"]).between([b.jid,0],[b.jid,d(\"MAWTimeUtils\").MAX_TIMESTAMP],!0,!0).filter(function(a){return!(a.type===d(\"MAWMsgType\").MSG_TYPE.ADMIN&&((a=a.msgContent)==null?void 0:a.adminType)===d(\"MAWLocalizationType\").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION)}).first();return b.then(function(a){return a==null?!0:a.ts>d(\"WATimeUtils\").castMilliSecondsToUnixTime(c)})})}});g.checkIfShowOpenMessageHistory=a}),98);\n__d(\"MAWCompareThreadParticipantsApi\",[\"MAWDbParticipantTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=function(a,b){a=new Set(a);for(var c=0;c<b.length;c++){var d=b[c];if(!a.has(d))return!1;a[\"delete\"](d)}return a.size===0};a=d(\"MAWIndexedDb\").makeMsgrTransactor({participants:d(\"MAWTransactionMode\").READWRITE},\"compareThreadParticipants\",function(a){return function(b,c){return d(\"MAWDbParticipantTxns\").getParticipantsInThread(a,c.groupJid).then(function(a){a=a.map(function(a){return a.userJid.split(\"@\")[0]});var c=b;return h(a,c)})}});g.compareThreadParticipants=a}),98);\n__d(\"MAWCompleteUndoThreadCutoverApi\",[\"MAWAdminWriteCutoverThreadMsgTxn\",\"MAWDbThreadTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"UpdateAdminMessageAfterUndoCutover failed to get the thread\"]);h=function(){return a};return a}b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE},\"completeUndoThreadCutover\",function(a){return function(b){b=b.threadJid;return d(\"MAWDbThreadTxns\").getThreadByJid(a,b).then(function(b){if(!b.success){d(\"WALogger\").WARN(h());return}b=b.value;if(b.isMigratedLocally===!0)return d(\"MAWDbThreadTxns\").markCutoverThreadAsNotMigratedLocally(a,b).then(function(b){return d(\"MAWAdminWriteCutoverThreadMsgTxn\").revertCutoverThreadAdminMsg(a,b).then(function(){return d(\"MAWAdminWriteCutoverThreadMsgTxn\").writeRollbackCutoverAdminMsg(a,b)})})})}});g.completeUndoThreadCutover=b}),98);\n__d(\"MAWCreateThreadApi\",[\"FBLogger\",\"MAWIndexedDb\",\"MAWJids\",\"MAWThreadManagementTxns\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,participants:a.READWRITE,reactions:a.READONLY,threads:a.READWRITE},\"createThread\",function(a){return function(b,e,f){return d(\"MAWThreadManagementTxns\").getOrSetupOneToOneThread(a,{offlineThreadingId:e,userJid:d(\"MAWJids\").toUserJid(b)}).then(function(a){var b=a.created;a=a.thread;b===!1&&c(\"FBLogger\")(\"messenger_e2ee_web\").warn(\"Got unexpected existing thread in create thread API for threadjid %s, description: %s\",a.jid,f);return{chatId:a.chatId,created:b,jid:a.jid}})}});g.createThread=b}),98);\n__d(\"MAWDeleteThreadApi\",[\"MAWIndexedDb\",\"MAWThreadManagementTxns\",\"MAWTransactionMode\",\"WALogger\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Successfully deleted thread \",\"\"]);h=function(){return a};return a}b=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor({chunk:(a=d(\"MAWTransactionMode\")).READWRITE,deletedMessages:a.READWRITE,groupInfo:a.READWRITE,groupInvites:a.READWRITE,media:a.READWRITE,messages:a.READWRITE,participants:a.READWRITE,pendingStanzas:a.READWRITE,reactions:a.READWRITE,receipts:a.READWRITE,threads:a.READWRITE,unrenderedMessages:a.READWRITE},\"deleteThread\",function(a){return function(b){return a.threads.get(b).then(function(e){if(e==null)throw c(\"err\")(\"There was no thread to delete in local delete thread\");return d(\"MAWThreadManagementTxns\").deleteAllThreadData(a,e).then(function(){d(\"WALogger\").LOG(h(),b)})})}});g.deleteThread=b}),98);\n__d(\"MAWDyiGetThreadList\",[\"MAWDexieTable\",\"MAWDyiBatchRestoreDataSync\",\"MAWEBBackendQPLUtils\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"Random\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({dyiBatch:d(\"MAWTransactionMode\").READWRITE},\"dyiGetThreadList\",function(a){return function(b,c){a.dyiBatch.clear();d(\"MAWEBBackendQPLUtils\").logDyiE2EGetThreadList(c,b.length);b=b.reduce(function(b,e){return b.then(function(b){b=d(\"Random\").uint32();return a.dyiBatch.add({isThread:!0,numMessages:0,numMessagesRestored:0,oldestTs:0,qplFlowDescriptor:0,qplInstanceKeyE2E:c,qplInstanceKeyForThread:b,threadId:e})})},a.dyiBatch.add({isThread:!0,numMessages:0,numMessagesRestored:0,numThreadsRestored:0,oldestTs:0,qplFlowDescriptor:1,qplInstanceKeyE2E:c})).then(function(){var b=a.dyiBatch.toArray().then(function(a){a.forEach(function(a){var b=a.threadId;if(b!=null){a=d(\"MAWEBBackendQPLUtils\").startDYIBackupRestoreQplUserFlow(b,a.qplInstanceKeyForThread);d(\"MAWDyiBatchRestoreDataSync\").restoreMessagesForThread(b,-1,a,c)}})});d(\"MAWDexieTable\").dexieResolve(b)});return b.then(function(){return d(\"MAWDexieTable\").dexieResolve()})}});g.dyiGetThreadList=a}),98);\n__d(\"MAWFetchThreadMessageCountApi\",[\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"fetchArmadilloThreadMessageCount\",function(a){return function(a){return d(\"MAWDexieTable\").dexieResolve(0)}});g.fetchArmadilloThreadMessageCount=a}),98);\n__d(\"MAWGetAllMessageIdsAndRangesForThreadApi\",[\"MAWDbMsg\",\"MAWIndexedDb\",\"MAWMsgType\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=1e3,i={hasMoreAfter:!1,hasMoreBefore:!1,maxSortOrder:\"0\",minSortOrder:\"0\",msgIdsAndCorrespondingSortOrders:[]};function j(a){var b=a.ephemeralSetting,c=a.serverTs;a=a.type;return d(\"MAWMsgType\").isEBSupportedMsgType(a)&&c!=null&&!(b!=null&&b.ephemeralExpirationInSec>0)}a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"getAllMessageIdsAndRangesForThread\",function(a){return function(b,c){var e=Math.min(h,c);return a.threads.where(\"jid\").startsWith(b).first().then(function(b){return b!=null?a.messages.where([\"threadJid\",\"sortOrderMs\"]).between([b.jid,0],[b.jid,Number.MAX_SAFE_INTEGER]).filter(function(a){return j(a)}).reverse().limit(e).toArray().then(function(a){if(a.length===0)return i;var c=a.map(function(a){return[a.msgId,\"\"+d(\"MAWDbMsg\").getSortOrderWithFallback(a)]}),f=c[c.length-1],g=c[0];a=c.length===e&&a[a.length-1].msgId!==(b==null?void 0:b.oldestMsg);f=f[1];g=g[1];return{hasMoreAfter:!1,hasMoreBefore:a,maxSortOrder:g,minSortOrder:f,msgIdsAndCorrespondingSortOrders:c}}):i})[\"catch\"](function(){return i})}});g.getAllMessageIdsAndRangesForThread=a}),98);\n__d(\"MAWGetBlobDataUrlByMediaIdApi\",[\"FBLogger\",\"MAWIndexedDb\",\"MAWMaybeWithTimeout\",\"MAWMediaDownloadManager\",\"MAWTimedJob\",\"MAWTransactionMode\",\"Promise\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getBlobDataUrlByMediaIdDbCall cannot find media with mediaId: \",\", from \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getBlobDataUrlByMediaIdDbCall cannot find chunk with mediaId: \",\", from \",\"\"]);j=function(){return a};return a}a=function(a,e){return k(a,e).then(function(f){var g=f[0];f=f[1];if(f==null&&g===\"found_media_need_blob\")return d(\"MAWMaybeWithTimeout\").maybeWithTimeout(new(h||(h=b(\"Promise\")))(function(b){d(\"MAWMediaDownloadManager\").setToMediaDownloadManager(a,b)}).then(function(a){return a}),d(\"MAWTimedJob\").DEFAULT_TIMEOUT_MS,function(){d(\"WALogger\").ERROR(j(),a,e);throw c(\"FBLogger\")(\"mpf_web_foundations\").mustfixThrow(\"Failed to getBlobDataUrlByMediaId in time. mediaId is %s, from \"+e,a,e)});else if(f==null)throw c(\"FBLogger\")(\"mpf_web_foundations\").mustfixThrow(\"Failed to getBlobDataUrlByMediaId because media is not in the media db. mediaId is %s, from %s\",a,e);else return f})};var k=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:d(\"MAWTransactionMode\").READONLY,media:d(\"MAWTransactionMode\").READONLY},\"getBlobDataUrlByMediaId\",function(a){return function(b,c){return a.media.get(b).then(function(e){if(e==null){d(\"WALogger\").ERROR(i(),b,c);return[\"missing_media\",null]}return a.chunk.where(\"hashedPlaintextHash\").equals(e.hashedPlaintextHash).first().then(function(a){return a==null?[\"found_media_need_blob\",null]:[\"found_media_and_blob\",new Blob([a.blobData],{type:a.mimetype})]})})}});g.getBlobDataUrlByMediaId=a}),98);\n__d(\"MAWGetBlobDataUrlByXMAIdApi\",[\"MAWGetBlobDataUrlByMediaIdApi\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WALogger\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getMediaIdByXMAIdDbCall does not have valid information type - \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getMediaIdByXMAIdDbCall cannot find xma with xmaId \",\" and info type \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getBlobDataUrlByXMAId cannot find mediaId for xmaId \",\" and info type \",\"\"]);j=function(){return a};return a}a=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){var c=(yield k(a,b));if(c==null){d(\"WALogger\").WARN(j(),a,b);return}return d(\"MAWGetBlobDataUrlByMediaIdApi\").getBlobDataUrlByMediaId(c,\"getBlobDataUrlByXMAId\")});return function(b,c){return a.apply(this,arguments)}}();var k=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:d(\"MAWTransactionMode\").READONLY,media:d(\"MAWTransactionMode\").READONLY,xma:d(\"MAWTransactionMode\").READONLY},\"getMediaIdByXMAIdDbCall\",function(a){return function(b,c){return a.xma.get(b).then(function(a){if(a==null){d(\"WALogger\").ERROR(i(),b,c);return}var e;switch(c){case\"preview\":e=a.defaultPreviewMediaId;break;case\"header\":e=a.headerMediaId;break;case\"favicon\":e=a.faviconMediaId;break;default:d(\"WALogger\").ERROR(h(),c);return}return e})}});g.getBlobDataUrlByXMAId=a}),98);\n__d(\"MAWGetGroupSuperAdminApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({participants:d(\"MAWTransactionMode\").READONLY},\"getGroupSuperAdmin\",function(a){return function(b){return a.participants.where(\"threadId\").equals(b).filter(function(a){return a.type===\"superadmin\"}).first().then(function(a){if(a)return d(\"WAJids\").extractUserId(a.userJid);else return null})}});g.getGroupSuperAdmin=a}),98);\n__d(\"MAWGetIdentityKeys\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"SignalDbTypes\",\"WALogger\",\"WASignalKeys\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] \",\"\"]);h=function(){return a};return a}var i=\"IdentityKey was null\";a=d(\"MAWIndexedDb\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READONLY},\"getIdentityKeys\",function(a){return function(){return a.meta.get(d(\"SignalDbTypes\").MetaKeysEnum.identityKeyPair).then(function(a){a=a==null?void 0:a.value.identityKeyPair;if(a==null){d(\"WALogger\").ERROR(h(),i);throw c(\"err\")(i)}var b=d(\"WASignalKeys\").serializePubKey(a);a=a.privateKey;return{identityPrivateKey:a,identityPublicKey:b}})}});g.errNullKey=i;g.getIdentityKeys=a}),98);\n__d(\"MAWGetLatestThreadIdsApi\",[\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] getLatestThreadIds complete, threads count: \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] getLatestThreadIds started\"]);i=function(){return a};return a}a=d(\"MAWIndexedDb\").makeMsgrTransactor({threads:d(\"MAWTransactionMode\").READONLY},\"getLatestThreadIds\",function(a){return function(b){d(\"WALogger\").LOG(i());b=a.threads.orderBy(\"threadOrder\").reverse().limit(b).toArray();return b.then(function(a){var b=[];a.forEach(function(a){b.push(a.jid.split(\"@\")[0])});d(\"WALogger\").LOG(h(),b.length);return d(\"MAWDexieTable\").dexieResolve(b)})}});g.getLatestThreadIds=a}),98);\n__d(\"MAWGetMaybeNextNonAdminMsgSortOrderMsApi\",[\"MAWDbMsgTxns\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWRestoreMsgsTxns\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"getMaybeNextNonAdminMsgSortOrderMs\",function(a){return function(b,c){return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbMsgTxns\").maybeGetMsg(a,c),d(\"MAWDbThreadTxns\").getThread(a,b)]).then(function(b){var c=b[0];b=b[1];var e=0;if(d(\"MAWRestoreMsgsTxns\").isE2eeOrCutoverAdminMsg(c)&&b.success&&c!=null)return d(\"MAWRestoreMsgsTxns\").getNextMsgBasedOnSortOrderMs(a,b.value,c==null?void 0:c.msgId).then(function(a){a!=null&&a.sortOrderMs!=null&&(e=a.sortOrderMs);return{minMsgTimestampMs:e}});else c!=null&&c.sortOrderMs!=null&&(e=c.sortOrderMs);return{minMsgTimestampMs:e}})}});g.getMaybeNextNonAdminMsgSortOrderMs=a}),98);\n__d(\"MAWGetSecureThreadTotalCount\",[\"MAWIndexedDb\",\"MAWReStoreTiming\",\"MAWRestoreDbState\",\"MAWTransactionMode\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWRestoreDbState\").isUsingShim()?d(\"MAWReStoreTiming\").measureDuration(\"getSecureThreadTotalCount\",function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b=0;a=a.table(\"e2ee_threads\").keys(new WeakMap());var c=(yield a.next());while(!c.done)b++,c=(yield a.next());return b});return function(b){return a.apply(this,arguments)}}()):d(\"MAWIndexedDb\").makeMsgrTransactor({threads:d(\"MAWTransactionMode\").READONLY},\"getSecureThreadTotalCount\",function(a){return function(){return a.threads.count()}});g.getSecureThreadTotalCount=a}),98);\n__d(\"MAWGetSecurityAlertSettingApi\",[\"MAWDbMsgTypeVersionTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({appMeta:d(\"MAWTransactionMode\").READONLY},\"getSecurityAlertSetting\",function(a){return function(){return d(\"MAWDbMsgTypeVersionTxns\").getSecuritySettingForContact(a)}});g.getSecurityAlertSetting=a}),98);\n__d(\"MAWGetSecurityAlertSettingForSelfAndContactApi\",[\"MAWDbAppMeta\",\"MAWDbMsgTypeVersionTxns\",\"MAWIndexedDb\",\"MAWReStoreTiming\",\"MAWRestoreDbState\",\"MAWTransactionMode\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWRestoreDbState\").isUsingShim()?d(\"MAWReStoreTiming\").measureDuration(\"getSecurityAlertSettingForSelfAndContact\",function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b;b=(b=(b=(yield a.table(\"e2ee_appMeta\").get(d(\"MAWDbAppMeta\").AppMetaKeysEnum.allowSecurityAlert)))==null?void 0:b.value.allowSecurityAlert)!=null?b:!1;a=(a=(a=(yield a.table(\"e2ee_appMeta\").get(d(\"MAWDbAppMeta\").AppMetaKeysEnum.allowSecurityAlertForSelf)))==null?void 0:a.value.allowSecurityAlertForSelf)!=null?a:!0;return{allowSecurityAlertForContact:b,allowSecurityAlertForSelf:a}});return function(b){return a.apply(this,arguments)}}()):d(\"MAWIndexedDb\").makeMsgrTransactor({appMeta:d(\"MAWTransactionMode\").READONLY},\"getSecurityAlertSettingForSelfAndContact\",function(a){return function(){return d(\"MAWDbMsgTypeVersionTxns\").maybeBulkGetSecuritySetting(a)}});g.getSecurityAlertSettingForSelfAndContact=a}),98);\n__d(\"MAWGetThreadDevicesInfoApi\",[\"MAWIndexedDb\",\"MAWJids\",\"MAWSignalUtils\",\"MAWTransactionMode\",\"WAJids\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({identity:d(\"MAWTransactionMode\").READONLY},\"getThreadDevicesInfo\",function(a){return function(b){b=b.fbid;b=d(\"MAWJids\").toUserJid(b);return a.identity.where(\"userJid\").equals(b).toArray().then(function(a){return a.map(function(a){return{deviceId:d(\"WAJids\").extractDeviceId(a.deviceJid),firstSeenTs:a.firstSeenTs!=null?d(\"WATimeUtils\").toDate(a.firstSeenTs):null,identityKey:d(\"MAWSignalUtils\").getHexRepresentation(a.identity)}})})}});g.getThreadDevicesInfo=a}),98);\n__d(\"MAWGetThreadParticipantFBIDsApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"isStringNullOrEmpty\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({participants:d(\"MAWTransactionMode\").READONLY},\"getThreadParticipantFBIDs\",function(a){return function(b){b=b.chatId;return a.participants.where(\"threadId\").equals(b).toArray().then(function(a){return a.map(function(a){return a.userJid.split(\"@msgr\")[0]}).filter(function(a){return!c(\"isStringNullOrEmpty\")(a)})})}});g.getThreadParticipantFBIDs=a}),98);\n__d(\"blobToDataUri\",[\"Promise\",\"err\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){var d,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:d=new FileReader();e=new(h||(h=b(\"Promise\")))(function(a,b){d.onloadend=a,d.onerror=b});d.readAsDataURL(a);g.next=5;return b(\"regeneratorRuntime\").awrap(e);case 5:f=d.result;if(!(typeof f!==\"string\")){g.next=8;break}throw c(\"err\")('Unexpected result type \"%s\" when reading Blob as DataURL.',f instanceof ArrayBuffer?\"ArrayBuffer\":typeof f);case 8:return g.abrupt(\"return\",f);case 9:case\"end\":return g.stop()}},null,this)}g[\"default\"]=a}),98);\n__d(\"MAWGetThumbnailBlobDataUrlByMediaIdApi\",[\"MAWDbChunkTxns\",\"MAWDbMedia\",\"MAWDbMediaTxns\",\"MAWIndexedDb\",\"MAWMaybeWithTimeout\",\"MAWMediaPreviewDownloadManager\",\"MAWTransactionMode\",\"Promise\",\"WAResultOrError\",\"WATagsLogger\",\"asyncToGeneratorRuntime\",\"blobToDataUri\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Chunk missing for thumbnail despite having a thumbnailPlaintextHash in the media table\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getImageThumbnail: returning generated jpegThumbnail from chunk\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getImageThumbnail: unable to generate jpegThumbnail as chunk is missing\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"cannot find thumbnail to download\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"cannot find thumbnail to download with mediaId: \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Found jpegThumbnail entry for \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No media found for \",\"\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Get thumbnail blob for \",\"\"]);p=function(){return a};return a}var q=d(\"WATagsLogger\").TAGS([\"getThumbnailBlobDataUrlByMediaId\"]);a=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){q.LOG(p(),a);var b=(yield t(a));if(b==null){q.WARN(o(),a);return null}var e=(yield v(b));if(e.success===!0){q.LOG(n(),a);return c(\"blobToDataUri\")(e.value)}a=e.error;switch(a){case\"missing_jpeg_thumbnail\":if(b.mediaType===d(\"MAWDbMedia\").MEDIA_TYPE.IMAGE||b.mediaType===d(\"MAWDbMedia\").MEDIA_TYPE.VIDEO){e=(yield r(b));if(e!=null)return c(\"blobToDataUri\")(e);if((b==null?void 0:b.mediaType)===d(\"MAWDbMedia\").MEDIA_TYPE.VIDEO)return null;a=(yield s(b));return a==null?null:c(\"blobToDataUri\")(a)}return null;case\"invalid_media\":return null}});return function(b){return a.apply(this,arguments)}}();var r=function(a){var c=d(\"MAWMediaPreviewDownloadManager\").getMediaPreviewDownloadingResolvable(a.plaintextHash);return c==null?(h||(h=b(\"Promise\"))).resolve(null):d(\"MAWMaybeWithTimeout\").maybeWithTimeout(c.promise,1e4,function(){q.WARN(m(),a.mediaId);q.ERROR(l());return null})},s=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(e=d(\"MAWTransactionMode\")).READONLY,media:e.READONLY},\"generateThumbnailFromMediaChunk\",function(a){return function(b){return d(\"MAWDbChunkTxns\").maybeGetChunkFromHash(a,b.hashedPlaintextHash).then(function(a){if(a==null){q.ERROR(k());return}q.WARN(j());return new Blob([a.blobData],{type:a.mimetype})})}}),t=d(\"MAWIndexedDb\").makeMsgrTransactor({media:e.READONLY},\"getFullMedia\",function(a){return function(b){return d(\"MAWDbMediaTxns\").maybeGetMediaFromMediaId(a,b)}}),u=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:e.READONLY},\"getChunkForThumbnail\",function(a){return function(b){return d(\"MAWDbChunkTxns\").maybeGetChunkByPlaintextHash(a,b)}}),v=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=w(a);if(a.success===!1)return a;a=a.value;var b=a.jpegThumbnail;a=a.thumbnailPlaintextHash;if(a!=null){a=(yield u(a));if(a!=null)return d(\"WAResultOrError\").makeResult(new Blob([a.blobData],{type:a.mimetype}));else q.ERROR(i())}return b!=null?d(\"WAResultOrError\").makeResult(new Blob([b],{type:\"image\/jpeg\"})):d(\"WAResultOrError\").makeError(\"missing_jpeg_thumbnail\")});return function(b){return a.apply(this,arguments)}}(),w=function(a){var b,c=null,e=null;switch(a.mediaType){case d(\"MAWDbMedia\").MEDIA_TYPE.IMAGE:c=(b=a.validatedImageInfo)==null?void 0:b.jpegThumbnail;e=(b=a.validatedImageInfo)==null?void 0:b.thumbnailPlaintextHash;break;case d(\"MAWDbMedia\").MEDIA_TYPE.VIDEO:c=(b=a.validatedVideoInfo)==null?void 0:b.jpegThumbnail;e=(b=a.validatedVideoInfo)==null?void 0:b.thumbnailPlaintextHash;break;default:return d(\"WAResultOrError\").makeError(\"invalid_media\")}return d(\"WAResultOrError\").makeResult({jpegThumbnail:c,thumbnailPlaintextHash:e})};g.getThumbnailBlobDataUrlByMediaId=a}),98);\n__d(\"MAWGetWAIDevices\",[\"WADevicesState\",\"WAGlobals\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){return h.apply(this,arguments)}function h(){h=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b=a.users;yield d(\"WADevicesState\").getDevicesState().waitForUserDevices(b,\"getWAIDevices\");return d(\"WAGlobals\").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return a.storage.bulkLoadIdentities(b)},{afterInit:!0,flush:!1,operationType:\"maw_load_identities\"}).then(function(a){var b=new Map();for(a of a){var c=a[0],d=a[1];b.set(c,Array.from(d.keys()))}return b})});return h.apply(this,arguments)}g.getWAIDevices=a}),98);\n__d(\"MAWGetWorkerHeartbeatApi\",[\"MAWGetWorkerStatusApi\",\"Promise\",\"WAResolvable\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=new(d(\"WAResolvable\").Resolvable)();d(\"MAWGetWorkerStatusApi\").onWorkerStateChange(function(a){var b=a.value;a.success&&(b==null?void 0:b.startup)===\"success\"&&!i.resolveWasCalled()&&i.resolve(!0)});a=function(){return(h||(h=b(\"Promise\"))).resolve(!0)};g.getWorkerHeartbeat=a}),98);\n__d(\"MAWInsertAdminMessageInCutoverThreadsApi\",[\"MAWAdminWriteCutoverThreadMsgTxn\",\"MAWDbThreadTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE},\"insertAdminMessageInCutoverThreads\",function(a){return function(b){var c=b.openThreadId,e=b.threadJid;b=b.traceId;return d(\"MAWAdminWriteCutoverThreadMsgTxn\").writeCutoverThreadAdminMsg(a,e,c,b).then(function(b){b=b.needsMarkThreadAsMigrated;if(b)return d(\"MAWDbThreadTxns\").markCutoverThreadAsMigratedLocally(a,e)}).then(function(){return!0})}});g.insertAdminMessageInCutoverThreads=b}),98);\n__d(\"MAWLoadMediaApi\",[\"MAWDbChunkTxns\",\"MAWDbMediaTxns\",\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWMediaAfterTxns\",\"MAWTransactionMode\",\"WALogger\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Unable to load media for thread. ThreadId \",\" does not exist\"]);h=function(){return a};return a}var i=20;b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,media:a.READONLY,messages:a.READONLY,threads:a.READONLY},\"loadMoreMedia\",function(a){return function(b){var c=b.earliestLoadedMediaTs,e=b.threadId,f=b.threadJid;return a.threads.get(e).then(function(b){if(b==null)throw d(\"WALogger\").ERROR(h(),e);b=d(\"MAWDbMsgTxns\").IS_SORT_ORDER_COMPARISON_ENABLED?a.messages.where([\"threadJid\",\"sortOrderMs\"]).between([b.jid,d(\"MAWDbMsg\").MIN_MSG_SORT_ORDER],[b.jid,c]):a.messages.where(\"msgId\").between(d(\"MAWDbMsg\").msgIdsInChatLowerBound(b.chatId),d(\"MAWDbMsg\").craftMsgId(b.chatId,c));return b.filter(function(a){var b=d(\"WATimeUtils\").unixTime(),c=d(\"MAWDbMsg\").isMediaMsg(a);a=a.messageExpirationTs==null||a.messageExpirationTs>b;return c&&a}).limit(i).reverse().toArray()}).then(function(b){var c,g=b.length===i,h=b[b.length-1];c=d(\"MAWDbMsgTxns\").IS_SORT_ORDER_COMPARISON_ENABLED?(c=h==null?void 0:h.sortOrderMs)!=null?c:d(\"MAWDbMsg\").MIN_MSG_SORT_ORDER:h?d(\"MAWDbMsg\").getInChatMsgIdFromMsgId(h.msgId):0;d(\"MAWIndexedDb\").afterTransaction({tag:\"NewMediaRange\",value:{earliestLoadedMediaTs:c,hasMoreBefore:g,threadId:e,threadJid:f}});return d(\"MAWDbMediaTxns\").getMsgMediaPairFromMsgs(a,b).then(function(b){d(\"MAWDexieTable\").dexieAll(b.map(function(b){var c=b[0],e=b[1];return d(\"MAWDbChunkTxns\").hasMediaChunk(a,e.hashedPlaintextHash).then(function(a){d(\"MAWMediaAfterTxns\").handleNewMediaAfterTxn(c,e,a)})}))})})}});g.loadMoreMedia=b}),98);\n__d(\"MAWMarkBackupAsCompleted\",[\"MAWSharedEbUploadQueue\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){a=a.queueId;var b=d(\"MAWSharedEbUploadQueue\").ebUploadQueue();return b.ack([a])}g.markBackupAsCompleted=a}),98);\n__d(\"MAWMarkThreadAsUnreadApi\",[\"MAWBridgeThread\",\"MAWDbMsgTxns\",\"MAWIndexedDb\",\"MAWTimeUtils\",\"MAWTransactionMode\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READWRITE},\"markThreadAsUnread\",function(a){return function(b){return a.threads.get(b).then(function(c){if(c==null)return;return d(\"MAWDbMsgTxns\").getThreadNewestMessageTsBySortOrder(a,c).then(function(e){var f=d(\"MAWTimeUtils\").ensureValidMillisTime(e),g=d(\"WATimeUtils\").castToMillisTime(0);if(f==null||e===g)return;return a.threads.update(b,{lastReadMsg:null,lastReadMsgTs:g}).then(function(a){a===1&&d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadTimestampsUpdated\",value:d(\"MAWBridgeThread\").createBridgeThreadTimestampsUpdated(c.jid,b,g,f)})})})})}});g.markThreadAsUnread=a}),98);\n__d(\"MAWPreEstablishSessionApi\",[\"WAPreEstablishOutgoingSessionForGroup\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a,b){return d(\"WAPreEstablishOutgoingSessionForGroup\").maybePreEstablishOutgoingSession(a,b)};g.preEstablishSession=a}),98);\n__d(\"MAWPredistributeSKDMApi\",[\"MAWSendSenderKeyDistributionMsg\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a,b){return d(\"MAWSendSenderKeyDistributionMsg\").maybePreEstablishSessionsAndSendSenderKeyDistributionMsg(a,b)};g.predistributeSKDM=a}),98);\n__d(\"WASmaxOutChatstateComposingMixin\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.hasComposingMediaAudio;a=d(\"WASmaxJsx\").smax(\"chatstate\",null,d(\"WASmaxJsx\").smax(\"composing\",{media:d(\"WASmaxAttrs\").OPTIONAL_LITERAL(\"audio\",a)}));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeComposingMixin=a}),98);\n__d(\"WASmaxOutChatstatePausedMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(){var a=d(\"WASmaxJsx\").smax(\"chatstate\",null,d(\"WASmaxJsx\").smax(\"paused\",null));return a}function a(a){var b=h();return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergePausedMixin=a}),98);\n__d(\"WASmaxOutChatstateComposingOrPausedMixinGroup\",[\"WASmaxMixinGroupExhaustiveError\",\"WASmaxOutChatstateComposingMixin\",\"WASmaxOutChatstatePausedMixin\"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.composing)return d(\"WASmaxOutChatstateComposingMixin\").mergeComposingMixin(a,b.composing);if(b.isPaused)return d(\"WASmaxOutChatstatePausedMixin\").mergePausedMixin(a);throw new(d(\"WASmaxMixinGroupExhaustiveError\").SmaxMixinGroupExhaustiveError)()}g.mergeComposingOrPausedMixinGroup=a}),98);\n__d(\"WASmaxOutChatstateInternalTestMixin\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.testConfig;a=d(\"WASmaxJsx\").smax(\"smax$any\",null,d(\"WASmaxJsx\").smax(\"test\",{config:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").CUSTOM_STRING,a)}));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeInternalTestMixin=a}),98);\n__d(\"WASmaxOutChatstateClientNotificationRequest\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutChatstateComposingOrPausedMixinGroup\",\"WASmaxOutChatstateInternalTestMixin\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=a.chatstateTo,c=a.internalTestMixinArgs;a=a.composingOrPausedMixinGroupArgs;b=d(\"WASmaxOutChatstateComposingOrPausedMixinGroup\").mergeComposingOrPausedMixinGroup(d(\"WASmaxMixins\").optionalMerge(d(\"WASmaxOutChatstateInternalTestMixin\").mergeInternalTestMixin,d(\"WASmaxJsx\").smax(\"chatstate\",{to:d(\"WAWap\").JID(b)}),c),a);return b}g.makeClientNotificationRequest=a}),98);\n__d(\"WASmaxChatstateClientNotificationRPC\",[\"WAComms\",\"WASmaxOutChatstateClientNotificationRequest\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a){var c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:c=d(\"WASmaxOutChatstateClientNotificationRequest\").makeClientNotificationRequest(a);e.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").castSmaxStanza(c));case 3:case\"end\":return e.stop()}},null,this)}g.sendClientNotificationRPC=a}),98);\n__d(\"WASendChatStateProtocol\",[\"WALogger\",\"WASmaxChatstateClientNotificationRPC\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"sendChatStateProtocol Sending \",\" to \",\"\"]);h=function(){return a};return a}function a(a,b){d(\"WALogger\").LOG(h(),b,a);var c;b===\"idle\"?c={isPaused:!0}:(b,c={composing:{hasComposingMediaAudio:b===\"recording_audio\"}});return d(\"WASmaxChatstateClientNotificationRPC\").sendClientNotificationRPC({chatstateTo:a,composingOrPausedMixinGroupArgs:c})}g.sendChatStateProtocol=a}),98);\n__d(\"MAWSendChatStateFromComposerApi\",[\"FBLogger\",\"MAWDbThreadTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WASendChatStateProtocol\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({threads:d(\"MAWTransactionMode\").READONLY},\"sendChatStateFromComposer\",function(a){return function(b){var e=b.state;b=b.threadId;return d(\"MAWDbThreadTxns\").getThread(a,b).then(function(a){if(!a.success)return;a=a.value.jid;d(\"WASendChatStateProtocol\").sendChatStateProtocol(a,e)[\"catch\"](function(a){return c(\"FBLogger\")(a).mustfix(\"Caught while sending chat state from composer.\")})})}});g.sendChatStateFromComposer=a}),98);\n__d(\"MAWSetEphemeralSettingsOfPeerFromMIApi\",[\"MAWDbGroupInfoTxns\",\"MAWDexieTable\",\"MAWEphemeralSettingsTxns\",\"MAWGetOrCreateThreadTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAJids\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,contacts:a.READWRITE,ephemeralSettings:a.READWRITE,existingUsers:a.READWRITE,groupInfo:a.READWRITE,groupInvites:a.READONLY,media:a.READONLY,messages:a.READWRITE,participants:a.READWRITE,reactions:a.READWRITE,threads:a.READWRITE,xma:a.READONLY},\"handleAndWriteIncomingEphemeralSetting\",function(a){return function(b,c,e,f,g,h,i){var j=d(\"WAJids\").interpretAsGroupJid(c);j=d(\"MAWDexieTable\").dexieAll([d(\"MAWGetOrCreateThreadTxns\").getExistingThread(a,c),j!=null?d(\"MAWDbGroupInfoTxns\").getGroupInfo(a,j):d(\"MAWDexieTable\").dexieResolve()]);return j.then(function(b){var e=b[0];b=b[1];if(e!=null)return{created:!1,thread:e};b=b==null?void 0:(e=b.value)==null?void 0:e.creationTs;return d(\"MAWGetOrCreateThreadTxns\").getOrCreateThread(a,{createTs:b==null?null:d(\"WATimeUtils\").castUnixTimeToMillisTime(b),description:\"handleAndWriteIncomingEphemeralSetting\",jid:c})}).then(function(c){c=c.thread;return d(\"MAWEphemeralSettingsTxns\").handleAndWriteIncomingEphemeralSetting(a,b,null,e,f,g,c,i,null,h)})}});b=function(a){var b=a.author,c=a.chatJid,d=a.ephemeralExpirationInSec,e=a.ephemeralLastUpdatedOrSetTimestamp,f=a.fromWAI,g=a.isEphemeralSettingReset;a=a.serverTs;return h(b,c,d,e,g,f,a).then(function(){return{success:!0}})};g.setEphemeralSettingsFromMI=b}),98);\n__d(\"MAWUnarchiveThreadApi\",[\"MAWDbThreadTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({threads:d(\"MAWTransactionMode\").READWRITE},\"unarchiveThread\",function(a){return function(b){return d(\"MAWDbThreadTxns\").unarchiveThreads(a,[b]).then(function(){})}});g.unarchiveThread=a}),98);\n__d(\"MAWUpdateLSThreadFromGroupInfoApi\",[\"MAWBridgeTypesCreators\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({groupInfo:d(\"MAWTransactionMode\").READWRITE},\"updateLSThreadFromGroupInfo\",function(a){return function(b){return a.groupInfo.get(b).then(function(a){a!=null&&d(\"MAWIndexedDb\").afterTransaction({tag:\"GroupInfoUpdated\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdatedGroupInfo(a)})})}});g.updateLSThreadFromGroupInfo=a}),98);\n__d(\"MAWUpdateThreadMuteSettingApi\",[\"MAWBridgeTypesCreators\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({threads:d(\"MAWTransactionMode\").READWRITE},\"updateThreadMuteSetting\",function(a){return function(b){var c=b.muteDuration,e=b.threadId,f=b.threadJid,g=c!==0&&c!==-1?d(\"WATimeUtils\").futureUnixTime(c)*1e3:c;return a.threads.update(e,{muteExpireTimeMs:g}).then(function(){d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadUpdated\",value:d(\"MAWBridgeTypesCreators\").createBridgeUpdatedThread({muteExpireTimeMs:g,threadId:e,threadJid:f})})})}});g.updateThreadMuteSetting=a}),98);\n__d(\"MAWWriteAdminMessageForDualThreadCutoverApi\",[\"MAWDbThreadTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"mawAdminWriteDualThreadCutoverMsgTxns\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE},\"writeAdminMessageForDualThreadCutover\",function(a){return function(b){var e=b.chatJid;b=b.cutoverTimestampMs;return c(\"mawAdminWriteDualThreadCutoverMsgTxns\")(a,e,b).then(function(b){b=b.needsMarkThreadAsMigrated;if(b)return d(\"MAWDbThreadTxns\").markCutoverThreadAsMigratedLocally(a,e)})}});g.writeAdminMessageForDualThreadCutover=b}),98);\n__d(\"MAWWriteAdminMessageForThreadHotlikeCustomizationApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"MAWWriteThreadHotlikeCustomizationAdminMsgTxns\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE},\"writeAdminMessageForThreadHotlikeCustomization\",function(a){return function(b){var c=b.actorFbid,e=b.chatId,f=b.serverAuthoritativeTimestampMs;b=b.threadIcon;return d(\"MAWWriteThreadHotlikeCustomizationAdminMsgTxns\").writeThreadHotlikeCustomizationAdminMsg(a,c,b,e,f)}});g.writeAdminMessageForThreadHotlikeCustomization=b}),98);\n__d(\"MAWWriteAdminMessageForThreadNicknameCustomizationApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"MAWWriteThreadNicknameCustomizationAdminMsgTxns\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE},\"writeAdminMessageForThreadNicknameCustomization\",function(a){return function(b){var c=b.actorFbid,e=b.chatId,f=b.nickName,g=b.participantId;b=b.serverAuthoritativeTimestampMs;return d(\"MAWWriteThreadNicknameCustomizationAdminMsgTxns\").writeThreadNicknameCustomizationAdminMsg(a,c,e,f,g,b)}});g.writeAdminMessageForThreadNicknameCustomization=b}),98);\n__d(\"MAWWriteAdminMessageForThreadPhotoCustomizationApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"MAWWriteThreadPhotoCustomizationAdminMsgTxns\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE},\"writeAdminMessageForThreadPhotoCustomization\",function(a){return function(b){var c=b.actorFbid,e=b.chatId;b=b.serverAuthoritativeTimestampMs;return d(\"MAWWriteThreadPhotoCustomizationAdminMsgTxns\").writeThreadPhotoCustomizationAdminMsg(a,c,e,b)}});g.writeAdminMessageForThreadPhotoCustomization=b}),98);\n__d(\"MAWWriteAdminMessageForThreadThemeCustomizationApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"MAWWriteThreadThemeCustomizationAdminMsgTxns\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE},\"writeAdminMessageForThreadThemeCustomization\",function(a){return function(b){var c=b.actorFbid,e=b.chatId,f=b.serverAuthoritativeTimestampMs,g=b.themeEmoji;b=b.themeNameWithSubtitle;return d(\"MAWWriteThreadThemeCustomizationAdminMsgTxns\").writeThreadThemeCustomizationAdminMsg(a,c,g,b,e,f)}});g.writeAdminMessageForThreadThemeCustomization=b}),98);\n__d(\"MAWWriteLSDBToPersistedEBTables\",[\"FBLogger\",\"MAWErrorObject\",\"MAWPersistedEBLSDB\",\"Promise\",\"WALogger\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] InvalidStateError: [\",\"], retrying to establish a new connection\"]);i=function(){return a};return a}var j=1;function a(a){return k.apply(this,arguments)}function k(){k=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){try{yield d(\"MAWPersistedEBLSDB\").getEBLSDB().flush(a,{upgrade:!1})}catch(f){var e=d(\"MAWErrorObject\").getErrorObject(f);if((e==null?void 0:e.name)===\"InvalidStateError\"&&j===1){j-=1;d(\"WALogger\").WARN(i(),f.message);yield d(\"MAWPersistedEBLSDB\").makeEBLSDB();yield d(\"MAWPersistedEBLSDB\").getEBLSDB().flush(a,{upgrade:!1});return(h||(h=b(\"Promise\"))).resolve()}c(\"FBLogger\")(\"labyrinth_web\").catching(f).mustfix(\"Failed to flush EB LSDB\");return(h||(h=b(\"Promise\"))).reject()}});return k.apply(this,arguments)}g.writeLSDBToPersistedEBTables=a}),98);\n__d(\"MAWFlushCacheToDbApi\",[\"Promise\"],(function(a,b,c,d,e,f){\"use strict\";var g;function a(){return(g||(g=b(\"Promise\"))).resolve()}f.flushCacheToDb=a}),66);\n__d(\"MAWBulkPutContactsApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({contacts:d(\"MAWTransactionMode\").READWRITE},\"bulkPutContacts\",function(a){return function(b){b=b.map(function(a){return{contactJid:a.contactJid,dhash:a.dhash,icdcFails:a.icdcFails,icdcInfo:a.icdcInfo,lastSyncTs:a.lastSyncTs}});return a.contacts.bulkPut(b).then(function(){})}});g.bulkPutContacts=a}),98);\n__d(\"MAWLoadContactsApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({contacts:d(\"MAWTransactionMode\").READONLY},\"loadContacts\",function(a){return function(b){return a.contacts.bulkGet(b).then(function(a){return new Map(a.filter(Boolean).map(function(a){return[a.contactJid,{contactJid:a.contactJid,dhash:a.dhash,icdcFails:a.icdcFails,icdcInfo:a.icdcInfo,lastSyncTs:a.lastSyncTs}]}))})}});g.loadContacts=a}),98);\n__d(\"MAWLoadIdentitiesApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({identity:d(\"MAWTransactionMode\").READONLY},\"loadIdentities\",function(a){return function(b){return a.identity.where(\"userJid\").equals(b).toArray().then(function(a){return new Map(a.filter(Boolean).map(function(a){return[a.deviceJid,a.identity]}))})}});b=d(\"MAWIndexedDb\").makeSignalTransactor({identity:d(\"MAWTransactionMode\").READONLY},\"bulkLoadIdentities\",function(a){return function(b){return a.identity.where(\"userJid\").anyOf(b).toArray().then(function(a){return a.filter(Boolean).reduce(function(a,b){var c=a.get(b.userJid);c==null&&(c=new Map());c.set(b.deviceJid,b.identity);a.set(b.userJid,c);return a},new Map())})}});g.loadIdentities=a;g.bulkLoadIdentities=b}),98);\n__d(\"MAWSessionApi\",[\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WABase64\",\"WACryptoManager\",\"WACryptoUtils\",\"WALogger\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAWSessionApi -- identity in session table is different with identity table \",\", \",\"  with context: \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAWSessionApi -- identity in session table is different with identity table with context: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAWSessionApi -- missing identity\"]);j=function(){return a};return a}a=d(\"MAWIndexedDb\").makeSignalTransactor({identity:d(\"MAWTransactionMode\").READONLY,session:d(\"MAWTransactionMode\").READONLY},\"loadSession\",function(a){return function(b,e){return d(\"MAWDexieTable\").dexieAll([a.session.get({id:b}),a.identity.get({deviceJid:b})]).then(function(a){var b=a[0];a=a[1];if(b==null)return null;b=d(\"WACryptoManager\").decodeSession(b.session);a==null?d(\"WALogger\").ERROR(j()):d(\"WACryptoUtils\").uint8ArraysEqual(a.identity,b.remote.pubKey)||(d(\"WALogger\").ERROR(i(),e),c(\"gkx\")(\"23958\")&&c(\"gkx\")(\"23959\")&&d(\"WALogger\").ERROR(h(),d(\"WABase64\").encodeB64(a.identity),d(\"WABase64\").encodeB64(b.remote.pubKey),e));return b})}});b=d(\"MAWIndexedDb\").makeSignalTransactor({session:d(\"MAWTransactionMode\").READONLY},\"bulkLoadSession\",function(a){return function(b){return a.session.bulkGet(b).then(k)}});function k(a){return a.reduce(function(a,b){if(b==null)return a;var c=d(\"WACryptoManager\").decodeSession(b.session);a.set(b.id,c);return a},new Map())}g.loadSession=a;g.bulkLoadSession=b}),98);\n__d(\"MAWLoadICDCApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({contacts:d(\"MAWTransactionMode\").READONLY},\"loadICDC\",function(a){return function(b){return a.contacts.get(b).then(function(a){return(a=a==null?void 0:a.icdcInfo)!=null?a:null})}});g.loadICDC=a}),98);\n__d(\"MAWLoadLastSyncTsApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({contacts:d(\"MAWTransactionMode\").READONLY},\"loadLastSyncTs\",function(a){return function(b){return a.contacts.get(b).then(function(a){return(a=a==null?void 0:a.lastSyncTs)!=null?a:null})}});g.loadLastSyncTs=a}),98);\n__d(\"MAWGetDeviceChangeAlertsByOptionsApi\",[\"MAWDbGetDeviceChangeAlertsByOptionsTxn\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({deviceChangeAlerts:d(\"MAWTransactionMode\").READWRITE},\"getDeviceChangeAlertsByOptions\",function(a){return function(b){return d(\"MAWDbGetDeviceChangeAlertsByOptionsTxn\").getDeviceChangeAlertsByOptionsTxn(a,b)}});g.getDeviceChangeAlertsByOptions=a}),98);\n__d(\"MAWUpdateDeviceChangeAlertsApi\",[\"MAWDbGetUnArchivedDeviceChangeAlertsCountTxn\",\"MAWDbUpdateDeviceChangeAlertsTxn\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({deviceChangeAlerts:d(\"MAWTransactionMode\").READWRITE},\"updateDeviceChangeAlerts\",function(a){return function(b){return d(\"MAWDbUpdateDeviceChangeAlertsTxn\").updateDeviceChangeAlertsTxn(a,b).then(function(b){return d(\"MAWDbGetUnArchivedDeviceChangeAlertsCountTxn\").getUnArchivedDeviceChangeAlertsCountTxn(a).then(function(){return b})})}});g.updateDeviceChangeAlerts=a}),98);\n__d(\"MAWGetAllThreadsAsJsonApi\",[\"MAWAckLevel\",\"MAWDbChunkTxns\",\"MAWDbGroupInfoTxns\",\"MAWDbMedia\",\"MAWDbMediaTxns\",\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDbParticipantTxns\",\"MAWDbReactionsTxns\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWMsgType\",\"MAWTransactionMode\",\"MAWVault\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=function(a,b,c,d){return[{uri:a!=null?\"messages\/inbox\/\"+b+\"\/\"+c+\"\/\"+d[a.toString()]:\"\"}]},i=function(a,b,c,e){switch(a.type){case d(\"MAWMsgType\").MSG_TYPE.TEXT:return{common:b,content:d(\"MAWVault\").unvault(a.msgContent.content),jsonType:\"text\"};case d(\"MAWMsgType\").MSG_TYPE.IMAGE:return{common:b,jsonType:\"photo\",photos:h(a.mediaId,c,\"photos\",e)};case d(\"MAWMsgType\").MSG_TYPE.VIDEO:return{common:b,jsonType:\"video\",videos:h(a.mediaId,c,\"videos\",e)};case d(\"MAWMsgType\").MSG_TYPE.PTT:return{audio_files:h(a.mediaId,c,\"audio\",e),common:b,jsonType:\"audio\"};case d(\"MAWMsgType\").MSG_TYPE.GIF:return{common:b,gifs:h(a.mediaId,c,\"gifs\",e),jsonType:\"gif\"};case d(\"MAWMsgType\").MSG_TYPE.STICKER:return{common:b,jsonType:\"sticker\",sticker:{uri:a.mediaId!=null?\"messages\/stickers_used\/\"+e[a.mediaId.toString()]:\"\"}};default:return null}},j=function(a,b,c,d){var e=\"\";a=a.filter(function(a){return a.userJid.toString()!==b}).map(function(a){return a.userJid.toString()});if(d.success){d=d.value.name;if(d!=null)e=d;else switch(a.length){case 2:e=a[0]+\"and\"+a[1];break;case 3:e=\"\"+a[0]+a[1]+\"and\"+a[2];break;case 4:e=\"\"+a[0]+a[1]+a[2]+\"and1other\";break;default:e=\"\"+a[0]+a[1]+a[2]+\"and\"+(a.length-3)+\"others\"}}else e=a[0];return e==null?\"unknown_user_\"+c:e.toLowerCase().replace(\/ \/g,\"\")+(\"_\"+c)},k=function(a,b){var c=d(\"MAWGlobals\").getMyUserJid().toString(),e=b.chatId,f=b.jid,g={audio:{},gifs:{},messages:[],participants:[],photos:{},stickers:{},threadName:\"\",videos:{}},h=b.newestMsg!=null?b.newestMsg:d(\"MAWDbMsg\").craftMsgId(e,0);return d(\"MAWDexieTable\").dexieAll([a.messages.where(\"threadJid\").equals(f).count()]).then(function(b){b=b[0];return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbParticipantTxns\").getParticipantsInThread(a,f),d(\"MAWDbMsgTxns\").getMsgsFromOffset(a,e,h,b,!0,!1),d(\"MAWDbGroupInfoTxns\").getGroupInfo(a,d(\"WAJids\").toGroupJid(f))])}).then(function(b){var f=b[0],h=b[1].msgs,k=b[2],l=h.filter(function(a){return a.ephemeralSetting==null}),m={},n={},o={},p={};b=l.filter(function(a){return a.mediaId!=null});return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbMediaTxns\").getMediaFromMsgs(a,b),d(\"MAWDbReactionsTxns\").getReactionsFromMessages(a,l)]).then(function(b){var h=b[0];b=b[1];b.forEach(function(a){var b=a.author,c=a.reaction;a=a.reactToMsgId;if(a!=null&&c!=null){a=a.toString();a in p||(p[a]=[]);p[a].push({actor:b,reaction:c})}});return d(\"MAWDexieTable\").dexieAll(h.map(function(b){var c=b.hashedPlaintextHash,e=b.mediaId.toString();m[e]=c.toString();o[c.toString()]={mediaId:e,mediaType:b.mediaType};return d(\"MAWDbChunkTxns\").maybeGetChunkFromHash(a,c)})).then(function(a){a.filter(Boolean).forEach(function(a){var b=a.mimetype.split(\"\/\");b[0];b=b[1];var c=a.hashedPlaintextHash.toString();b=c+\".\"+b;c=o[c];var e=c.mediaId;c=c.mediaType;n[e]=b;switch(c){case d(\"MAWDbMedia\").MEDIA_TYPE.GIF:g.gifs[b]=a.blobData;break;case d(\"MAWDbMedia\").MEDIA_TYPE.IMAGE:g.photos[b]=a.blobData;break;case d(\"MAWDbMedia\").MEDIA_TYPE.STICKER:g.stickers[b]=a.blobData;break;case d(\"MAWDbMedia\").MEDIA_TYPE.VIDEO:g.videos[b]=a.blobData;break;case d(\"MAWDbMedia\").MEDIA_TYPE.PTT:g.audio[b]=a.blobData;break;default:break}});g.threadName=j(f,c,e,k);l.forEach(function(a){var b={is_unsent:a.ack<d(\"MAWAckLevel\").ACK.sent,sender_name:a.author,timestamp:a.ts,type:a.type},c=a.msgId.toString();c in p&&(b=babelHelpers[\"extends\"]({},b,{reactions:p[c]}));c=i(a,b,g.threadName,n);c!=null&&g.messages.push(c)});return g})})})};b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READONLY,participants:a.READONLY,reactions:a.READONLY,threads:a.READWRITE,xma:a.READONLY},\"getAllThreadsAsJson\",function(a){return function(){var b={};return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbThreadTxns\").getAllThreadsForUser(a,d(\"MAWGlobals\").getMyUserJid())]).then(function(c){c=c[0];return d(\"MAWDexieTable\").dexieAll(c.map(function(b){return k(a,b)})).then(function(a){a.forEach(function(a){b[a.threadName]=a});return b})})}});g.getAllThreadsAsJson=b}),98);\n__d(\"MAWHandleMediaDownloadAndRestoreApi\",[\"MAWDbMediaTxns\",\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWEBBackendQPLUtils\",\"MAWIndexedDb\",\"MAWMediaManagementTxns\",\"MAWTransactionMode\",\"WAJids\",\"WAMediaUtils\",\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] media entry missing from the db\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] message not found. isMsgIdNull: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web][MAWHandleMediaDownloadAndRestoreApi] media entries missing from the db\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web][MAWHandleMediaDownloadAndRestoreApi] media entry missing for msgId\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web][MAWHandleMediaDownloadAndRestoreApi] thread jid or author is missing from the db\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web][MAWHandleMediaDownloadAndRestoreApi] media backup row missing from the db\"]);m=function(){return a};return a}a=function(a,b){var c=d(\"WAMediaUtils\").stringToDeliveryObjectId(a);return d(\"MAWIndexedDb\").makeMsgrTransactor({media:d(\"MAWTransactionMode\").READWRITE,mediaBackup:d(\"MAWTransactionMode\").READWRITE,messages:d(\"MAWTransactionMode\").READWRITE},\"writeCdnUrlAndBakeDownloadPayload\",function(a){return function(){return n(a,c,b)}})()};function n(a,b,c,e){var f;b=d(\"MAWDbMediaTxns\").maybeGetMediaBackupRowFromObjectId(a,b).then(function(b){b==null&&(d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"mi_media_restore\"]).ERROR(m()),d(\"MAWEBBackendQPLUtils\").logMediaRestoreFromMIQPLPoint(e,\"no_media_backup_row\"));f=b;return d(\"MAWDbMediaTxns\").maybeGetMediaFromMediaId(a,(b=f)==null?void 0:b.mediaId)});return b.then(function(b){if(b!=null){var g,m=(g=f)==null?void 0:g.msgId;return d(\"MAWDbMsgTxns\").maybeGetMsg(a,m).then(function(f){if(m!=null&&f!=null){var g=b==null?void 0:b.mediaEntries;if(g!=null){g=g.get(m);if(g!=null){var h=b.hashedPlaintextHash;return o(a,g,c,h,m).then(function(a){var g=f.threadJid,i=f.author,j=b.mediaType;if(g!=null&&!d(\"WAJids\").isAuthorSystem(i)){d(\"MAWEBBackendQPLUtils\").logMediaRestoreFromMIQPLPoint(e,\"create_media_download_metadata\");return p(b,j,f.externalId,h,g,i,c,(j=a)!=null?j:void 0)}else d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"mi_media_restore\"]).ERROR(l()),d(\"MAWEBBackendQPLUtils\").logMediaRestoreFromMIQPLPoint(e,\"no_thread_jid_or_author\")})}else d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"mi_media_restore\"]).ERROR(k()),d(\"MAWEBBackendQPLUtils\").logMediaRestoreFromMIQPLPoint(e,\"no_media_entry_for_msgId\")}else d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"mi_media_restore\"]).ERROR(j()),d(\"MAWEBBackendQPLUtils\").logMediaRestoreFromMIQPLPoint(e,\"no_media_entries\")}else{g=m==null;d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"mi_media_restore\"]).ERROR(i(),g);d(\"MAWEBBackendQPLUtils\").logMediaRestoreFromMIQPLPoint(e,\"no_message_for_media\",{bool:{isMsgIdNull:g}})}})}else d(\"WATagsLogger\").TAGS([\"labyrinth_web\",\"mi_media_restore\"]).ERROR(h());return d(\"MAWDexieTable\").dexieResolve()})}function o(a,b,c,e,f){b=d(\"WAMediaUtils\").decodeMediaEntryData(b);var g=b.directPath;b=d(\"WAMediaUtils\").encodeMediaEntryWithUpdatedPath(b,c);return d(\"MAWMediaManagementTxns\").updateMediaWithEncodedMediaEntryData(a,e,f,b).then(function(){return g})}function p(a,b,c,d,e,f,g,h){var i=a.plaintextHash;if(b===\"Video\"){var j,k,l,m,n;j=(j=a.validatedVideoInfo)==null?void 0:j.width;k=(k=a.validatedVideoInfo)==null?void 0:k.height;l=(l=a.validatedVideoInfo)==null?void 0:l.jpegThumbnailWidth;m=(m=a.validatedVideoInfo)==null?void 0:m.jpegThumbnailHeight;n=(n=a.validatedVideoInfo)==null?void 0:n.duration;return{author:f,directPath:g,externalId:c,hashedPlaintextHash:d,height:k,mediaPlayableDuration:n,mediaType:b,oldDirectPath:h,plaintextHash:i,previewContentHeight:m,previewContentWidth:l,threadJId:e,width:j}}else if(b===\"Image\"||b===\"Sticker\"||b===\"Gif\"){n=(k=a.validatedImageInfo)==null?void 0:k.width;l=(m=a.validatedImageInfo)==null?void 0:m.height;k=(j=a.validatedImageInfo)==null?void 0:j.jpegThumbnailWidth;j=(m=a.validatedImageInfo)==null?void 0:m.jpegThumbnailHeight;return{author:f,directPath:g,externalId:c,hashedPlaintextHash:d,height:l,mediaType:b,oldDirectPath:h,plaintextHash:i,previewContentHeight:j,previewContentWidth:k,threadJId:e,width:n}}else if(b===\"Ptt\"){l=(m=a.validatedAudioInfo)==null?void 0:m.duration;return{author:f,directPath:g,externalId:c,hashedPlaintextHash:d,mediaPlayableDuration:l,mediaType:b,oldDirectPath:h,plaintextHash:i,threadJId:e}}}g.writeCdnUrlAndBakeDownloadPayload=a;g.writeCdnUrlAndBakeDownloadPayloadTxn=n}),98);\n__d(\"MAWGetAllMediaIdsForXMAMsgApi\",[\"MAWDbXMATxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({xma:d(\"MAWTransactionMode\").READONLY},\"getAllMediaIdsForXMAMsg\",function(a){return function(b){var c=new Map();b=b.map(function(b){return d(\"MAWDbXMATxns\").maybeGetXMAFromProtocolMsgId(a,b).then(function(a){var d,e=(d=c.get(b))!=null?d:new Set();a!=null&&(a.faviconMediaId!=null&&e.add(a.faviconMediaId),a.headerMediaId!=null&&e.add(a.headerMediaId),a.previewMediaIds!=null&&a.previewMediaIds.forEach(function(a){return e.add(a)}));c.set(b,e)})});return d(\"MAWDexieTable\").dexieAll(b).then(function(a){return c})}});g.getAllMediaIdsForXMAMsg=a}),98);\n__d(\"MAWGetThreadJidByChatId\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({threads:d(\"MAWTransactionMode\").READONLY},\"getThreadJidByChatId\",function(a){return function(b){return a.threads.get(b).then(function(a){return a==null?void 0:a.jid})}});g.getThreadJidByChatId=a}),98);\n__d(\"MAWUploadRetroactiveMessageBatchApi\",[\"$InternalEnum\",\"LSDataTraceCheckPoint\",\"LSDataTraceType\",\"LSIntEnum\",\"MAWBridge\",\"MAWBridgeUpload\",\"MAWCastToMsgrServerMediaType\",\"MAWDbMediaTxns\",\"MAWDbMsg\",\"MAWDbMsgUtil\",\"MAWEBUploadTrackingUtils\",\"MAWGetAllMediaIdsForXMAMsgApi\",\"MAWGetThreadJidByChatId\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWQplProxy\",\"MAWTraceUtils\",\"MAWTransactionMode\",\"MAWUploadMessagesBackup\",\"Promise\",\"WAJids\",\"WALogger\",\"gkx\",\"promiseDone\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] retroactive backups not enabled, can't upload message batch\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth_web] error uploading retroactive message batch: \",\";\"]);k=function(){return a};return a}var l=b(\"$InternalEnum\")({ATTACHMENT:\"attachment\",MSG_METADATA:\"msg_metadata\"}),m=d(\"MAWIndexedDb\").makeMsgrTransactor({retroactiveBackupsState:d(\"MAWTransactionMode\").READWRITE},\"updateRetroactiveBackupsStore\",function(a){return function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];return n.apply(void 0,[a].concat(c))}});function n(a,b,c,d){if(c===\"delete\")return a.retroactiveBackupsState[\"delete\"](b).then(function(){});else return a.retroactiveBackupsState.update(b,{msgId:d,threadId:b}).then(function(){})}var o=d(\"MAWIndexedDb\").makeMsgrTransactor({media:d(\"MAWTransactionMode\").READONLY},\"bulkGetRetroactiveMedia\",function(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d(\"MAWDbMediaTxns\").bulkGetMedias.apply(void 0,[a].concat(c))}});function p(a,e,f,g){return e==null?(i||(i=b(\"Promise\"))).resolve():o(Array.from(f.keys())).then(function(b){return b.filter(Boolean).forEach(function(b){var i,j=b.mediaId;i=(i=f.get(j))==null?void 0:i.externalId;j=(j=f.get(j))==null?void 0:j.msgId;var k=d(\"MAWTraceUtils\").startNewTrace((h||(h=d(\"LSIntEnum\"))).ofNumber(c(\"LSDataTraceType\").ENCRYPTED_BACKUPS_MEDIA_BACKUP),d(\"MAWTraceUtils\").CONTEXT_MEDIA_BACKUP);d(\"MAWTraceUtils\").recordCheckpointForTrace(k,h.ofNumber(c(\"LSDataTraceCheckPoint\").LABYRINTH_WEB_RETROACTIVE_BACKUPS_START_UPLOAD_MEDIA),[],!1);j=d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(521480458,\"1218\"),{\"int\":{chatId:a},string:{msgId:j,uploadType:l.ATTACHMENT}});j.addPoint(\"retroactive_attachment_upload_start\");var m=b==null?void 0:b.objectId,n=d(\"MAWCastToMsgrServerMediaType\").castClientMediaTypeToServerMediaType(b==null?void 0:b.mediaType,g);if(b!=null&&i!=null&&m!=null&&e!=null&&n!=null&&n!==\"document\"){m=[{tag:\"UploadAttachment\",value:d(\"MAWBridgeUpload\").createBridgeUploadAttachment(a,m,n,i,d(\"MAWGlobals\").getConfig().productTypeForEBAttachments,d(\"WAJids\").threadIdForChatJid(e),e,b.ts,k)}];d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"uiUpdate\",{events:m});j.endSuccess()}else e==null?(d(\"MAWTraceUtils\").recordCheckpointForTrace(k,(h||(h=d(\"LSIntEnum\"))).ofNumber(c(\"LSDataTraceCheckPoint\").LABYRINTH_WEB_RETROACTIVE_BACKUPS_UPLOAD_MEDIA_ERROR),[],!1),j.endFail(\"retroactive_attachments_upload_error_null_chatjid\")):(d(\"MAWTraceUtils\").recordCheckpointForTrace(k,(h||(h=d(\"LSIntEnum\"))).ofNumber(c(\"LSDataTraceCheckPoint\").LABYRINTH_WEB_RETROACTIVE_BACKUPS_UPLOAD_MEDIA_ERROR),[],!1),j.endFail(\"retroactive_attachments_upload_error_null_media\"))})})}function q(a,b){var c=new Map();for(var a=a.entries(),d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];var h=b.get(g);if(h!=null)for(var f=f,i=Array.isArray(f),j=0,f=i?f:f[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var k;if(i){if(j>=f.length)break;k=f[j++]}else{j=f.next();if(j.done)break;k=j.value}k=k;var l={externalId:g.externalId,msgId:h};c.set(k,l)}}return c}function r(a){var b=Date.now();return a.filter(function(a){a=a.serverTs;if(a!=null){var c=b\/1e3;return c-a<30*24*3600}else return!1})}function s(a,c,e){var f=d(\"MAWGetThreadJidByChatId\").getThreadJidByChatId(e),g=f.then(function(b){return p(e,b,a,!1)});f=f.then(function(a){return c.size===0?(i||(i=b(\"Promise\"))).resolve():d(\"MAWGetAllMediaIdsForXMAMsgApi\").getAllMediaIdsForXMAMsg(Array.from(c.keys())).then(function(b){b=q(b,c);return p(e,a,b,!0)})});return(i||(i=b(\"Promise\"))).all([g,f]).then(function(){})}function t(a,e){var f=new Map(),g=new Map(),h=r(e).map(function(b){var e=b.msgId,h=d(\"MAWDbMsg\").isMediaMsg(b)?l.ATTACHMENT:l.MSG_METADATA;e=d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(521480458,\"1218\"),{\"int\":{chatId:a},string:{msgId:e,uploadType:h}});e.addPoint(\"retroactive_message_upload_start\");if(d(\"MAWDbMsg\").isMediaMsg(b)&&b.mediaId!=null)f.set(b.mediaId,{externalId:b.externalId,msgId:b.msgId});else if(d(\"MAWDbMsg\").isXMAMsg(b)){h=d(\"MAWDbMsgUtil\").getProtocolMsgIdFromDbMsg(b);h!=null&&g.set(h,b.msgId)}return e});h.forEach(function(a){return a.addPoint(\"retroactive_message_upload_calling_upload_unique_message\")});if(e.length===1)c(\"promiseDone\")(m(a,\"delete\"));else{var j=e[e.length-1].msgId;c(\"promiseDone\")(m(a,\"update\",j))}var n=new Map();e.forEach(function(a){var b=d(\"MAWEBUploadTrackingUtils\").genInstanceKeyOnly();n.set(a.externalId,b);d(\"MAWEBUploadTrackingUtils\").startUploadTracking(a.externalId,a.type,\"retroactive\",b)});j=d(\"MAWUploadMessagesBackup\").uploadUniqueMessage(e,void 0,!0,void 0,n).then(function(){h.forEach(function(a){a.endSuccess()})});e=s(f,g,a);return(i||(i=b(\"Promise\"))).all([e,j]).then(function(){})[\"catch\"](function(a){d(\"WALogger\").ERROR(k(),a)})}a=function(a,e){if(c(\"gkx\")(\"23914\"))return t(a,e);d(\"WALogger\").WARN(j());return(i||(i=b(\"Promise\"))).resolve()};g.getMessagesAndUploadBatchSeparateTx=t;g.uploadRetroactiveMessageBatch=a}),98);\n__d(\"MAWDeleteExpiredMsgsApi\",[\"MAWDbMsg\",\"MAWDbReactionsTxns\",\"MAWDbXMATxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWJidUtils\",\"MAWTransactionMode\",\"WAArmadilloXMA.pb\",\"WALogger\",\"WASortedLists\",\"WATimeUtils\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Successfully deleted: \",\" XMA rows\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Successfully deleted: \",\" media rows, \",\" chunk rows.\"]);i=function(){return a};return a}function j(a,b){return a.media.bulkGet(b.map(function(a){return a[0]})).then(function(e){var f=[],g=[];e.forEach(function(a,c){if(a!=null){var e=b[c][1];a.msgIds=d(\"WASortedLists\").filter(a.msgIds,function(a){return a!==e});a.mediaEntries[\"delete\"](e);a.msgIds.length===0&&a.mediaEntries.size===0&&(a.hashedPlaintextHash!=null&&f.push(a.hashedPlaintextHash),g.push(a.mediaId))}});e=a.media.bulkDelete(g);var h=f.length>0?a.chunk.where(\"hashedPlaintextHash\").anyOf(f)[\"delete\"]():d(\"MAWDexieTable\").dexieResolve(),j=c(\"gkx\")(\"23919\")&&g.length>0?a.mediaBackup.where(\"mediaId\").anyOf(g)[\"delete\"]():d(\"MAWDexieTable\").dexieResolve();return d(\"MAWDexieTable\").dexieAll([e,h,j]).then(function(){d(\"WALogger\").LOG(i(),g.length,f.length)})})}function k(a,b){var c=[],e=b.map(function(b){return d(\"MAWDbXMATxns\").maybeGetXMAFromProtocolMsgId(a,b[0])});return d(\"MAWDexieTable\").dexieAll(e).then(function(e){e.forEach(function(a,d){if(a!=null){var e=b[d][1];a.faviconMediaId!=null&&c.push([a.faviconMediaId,e]);a.headerMediaId!=null&&c.push([a.headerMediaId,e]);if(a.previewMediaIds!=null){(d=a.previewMediaIds)==null?void 0:d.forEach(function(a){c.push([a,e])})}}});e=a.xma.bulkDelete(e.filter(Boolean).map(function(a){a=a.xmaId;return a}));var f=j(a,c);return d(\"MAWDexieTable\").dexieAll([f,e]).then(function(){d(\"WALogger\").LOG(h(),b.length)})})}b=d(\"MAWIndexedDb\").makeSignalTransactor({receipts:(a=d(\"MAWTransactionMode\")).READWRITE},\"deleteReceipts\",function(a){return function(b){return a.receipts.where(\"waMsgId\").anyOf(b)[\"delete\"]().then(function(){})}});e=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:a.READWRITE,media:a.READWRITE,mediaBackup:a.READWRITE,messages:a.READWRITE,reactions:a.READWRITE,xma:a.READWRITE},\"deleteExpiredMsgs\",function(a){return function(){var b=d(\"WATimeUtils\").unixTime();return a.messages.where(\"messageDeleteTs\").belowOrEqual(b).toArray().then(function(b){var c=[],e=[],f=[],g=[],h=[],i=[];b.forEach(function(a){a.mediaId!=null&&c.push([a.mediaId,a.msgId]);if(d(\"MAWDbMsg\").isXMAMsg(a)){var b=d(\"MAWJidUtils\").maybeToProtocolMsgId(a.author,a.threadJid,a.externalId);b!=null&&i.push([b,a.msgId])}if(a.quote!=null&&a.quote.content.xmaMessageType===d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY){b=d(\"MAWJidUtils\").maybeToProtocolMsgId(a.author,a.threadJid,a.quote.content.externalId);b!=null&&i.push([b,a.msgId])}e.push(a.msgId);f.push(d(\"MAWDbMsg\").getWAMsgId(a));g.push({author:a.author,chatId:a.thread,externalId:a.externalId});h.push(a.rowId)});b=a.messages.bulkDelete(h);var l=j(a,c),m=k(a,i),n=d(\"MAWDbReactionsTxns\").deleteReactionsByUniqueMsgIdentifiers(a,g);return d(\"MAWDexieTable\").dexieAll([b,n,l,m]).then(function(){return d(\"MAWDexieTable\").dexieResolve(f)})})}});g.deleteOrUpdateMediaAndChunkForExpiredMsgs=j;g.deleteOrUpdateXMAForExpiredMsgs=k;g.deleteReceipts=b;g.deleteExpiredMsgs=e}),98);\n__d(\"MAWGetEphemeralSettingsApi\",[\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAJids\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Received invalid chat jid for getting ephemeral settings\"]);h=function(){return a};return a}a=d(\"MAWIndexedDb\").makeMsgrTransactor({ephemeralSettings:d(\"MAWTransactionMode\").READONLY},\"getEphemeralSettings\",function(a){return function(b){b=d(\"WAJids\").interpretAsUserJid(b);if(b==null){d(\"WALogger\").ERROR(h());return d(\"MAWDexieTable\").dexieResolve()}return a.ephemeralSettings.get({userJid:b}).then(function(a){return a==null?void 0:a.ephemeralSetting})}});g.getEphemeralSettings=a}),98);\n__d(\"MAWGetNextDeletionTsApi\",[\"MAWIndexedDb\",\"MAWReStoreTiming\",\"MAWRestoreDbState\",\"MAWTransactionMode\",\"ReQL\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWRestoreDbState\").isUsingShim()?d(\"MAWReStoreTiming\").measureDuration(\"getNextDeletionTs\",function(a){return d(\"ReQL\").firstAsync(d(\"ReQL\").fromTableAscending(a.tables.e2ee_messages.index(\"messageDeleteTs\"),[\"messageDeleteTs\"]).map(function(a){return a.messageDeleteTs}))}):d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"getNextDeletionTs\",function(a){return function(){return a.messages.orderBy(\"messageDeleteTs\").first().then(function(a){return a==null?void 0:a.messageDeleteTs})}});g.getNextDeletionTs=a}),98);\n__d(\"MAWGetNextExpirationTsApi\",[\"MAWIndexedDb\",\"MAWReStoreTiming\",\"MAWRestoreDbState\",\"MAWTransactionMode\",\"ReQL\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWRestoreDbState\").isUsingShim()?d(\"MAWReStoreTiming\").measureDuration(\"getNextExpirationTs\",function(a){var b=d(\"WATimeUtils\").unixTime();return d(\"ReQL\").firstAsync(d(\"ReQL\").fromTableAscending(a.tables.e2ee_messages.index(\"messageExpirationTs\"),[\"messageExpirationTs\"]).bounds({gte:[b]}).map(function(a){a=a.messageExpirationTs;return a}))}):d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"getNextExpirationTs\",function(a){return function(){var b=d(\"WATimeUtils\").unixTime();return a.messages.orderBy(\"messageExpirationTs\").filter(function(a){return a.messageExpirationTs!=null?a.messageExpirationTs>b:!1}).first().then(function(a){return a==null?void 0:a.messageExpirationTs})}});g.getNextExpirationTs=a}),98);\n__d(\"MAWRemoveExpiredMsgsFromUIApi\",[\"MAWBridgeTypesCreators\",\"MAWBridgeXMA\",\"MAWDbMsg\",\"MAWDbXMATxns\",\"MAWDexieTable\",\"MAWEphemeralMsgTxns\",\"MAWIndexedDb\",\"MAWJidUtils\",\"MAWMsgType\",\"MAWTransactionMode\",\"MAWUpdateQuotedMsgTxns\",\"MAWXMAUtils\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({groupInfo:(a=d(\"MAWTransactionMode\")).READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE,xma:a.READONLY},\"removeExpiredMsgsFromUI\",function(a){return function(){return a.messages.where(\"messageExpirationTs\").belowOrEqual(d(\"WATimeUtils\").unixTime()).filter(function(a){return a.ephemeralMsgDisappeared!==!0}).toArray().then(function(b){if(b.length===0)return 0;var c=b.reduce(function(a,b){var c;c=(c=a.get(b.thread))!=null?c:new Set();c.add(b.msgId);a.set(b.thread,c);return a},new Map()),e=b.map(function(a){return babelHelpers[\"extends\"]({},a,{ephemeralMsgDisappeared:!0})}),f=a.messages.bulkPut(e);b=b.map(function(b){return d(\"MAWUpdateQuotedMsgTxns\").disassociateQuotedMsg(a,b.thread,b.externalId,b.author,d(\"MAWMsgType\").MSG_TYPE.EXPIRED_EPHEMERAL)});return d(\"MAWDexieTable\").dexieAll([f,d(\"MAWEphemeralMsgTxns\").updateThreadsOnMessagesExpiredFromUi(a,c)].concat(b)).then(function(){var b=[];e.forEach(function(c){d(\"MAWIndexedDb\").afterTransaction({tag:\"DeleteMessages\",value:d(\"MAWBridgeTypesCreators\").createBridgeDeleteMessages(c.thread,c.threadJid,[c])});if(d(\"MAWDbMsg\").isMediaMsg(c)){var e=c.mediaId;e!=null&&d(\"MAWIndexedDb\").afterTransaction({tag:\"MediaExpired\",value:{mediaId:e,msgId:c.msgId,threadId:c.thread,threadJid:c.threadJid}})}d(\"MAWXMAUtils\").isXMAShare(c.xmaMessageType)&&b.push(d(\"MAWDbXMATxns\").maybeGetXMAFromProtocolMsgId(a,d(\"MAWJidUtils\").maybeToProtocolMsgId(c.author,c.threadJid,c.externalId)).then(function(a){a!=null&&d(\"MAWIndexedDb\").afterTransaction({tag:\"XMAShareExpired\",value:d(\"MAWBridgeXMA\").createBridgeXMAShareExpired(c,a.xmaId)})}))});return d(\"MAWDexieTable\").dexieAll(b).then(function(a){return e.length})})})}});g.removeExpiredMsgsFromUI=b}),98);\n__d(\"MAWUpdateEphemeralityOnMarkMsgsFromOtherAsReadApi\",[\"MAWEphemeralMsgTxns\",\"MAWIndexedDb\",\"MAWLoggerUtils\",\"MAWTransactionMode\",\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"updateEphemeralityOnMarkMsgsFromOtherAsRead \",\"\"]);h=function(){return a};return a}a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READWRITE,threads:d(\"MAWTransactionMode\").READONLY,xma:d(\"MAWTransactionMode\").READONLY},\"updateEphemeralityOnMarkMsgsFromOtherAsRead\",function(a){return function(b,c){d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.Ephemeral,d(\"MAWLoggerUtils\").Tag.Countdown,d(\"MAWLoggerUtils\").Tag.OnRead]).LOG(h(),b.map(function(a){return a.externalId}));b=b.map(function(a){return{msgId:a,ts:c}});return d(\"MAWEphemeralMsgTxns\").bulkMarkEphemeralMessageAsRead(a,b)}});g.updateEphemeralityOnMarkMsgsFromOtherAsRead=a}),98);\n__d(\"MAWWriteAdminMessageForEphemeralSettingsChange\",[\"MAWDbGroupInfoTxns\",\"MAWDexieTable\",\"MAWEphemeralAdminMsgBuildTxns\",\"MAWGetOrCreateThreadTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAJids\",\"WALogger\",\"WAResultOrError\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Cannot create a thread for message after missing thread creation attempt\"]);h=function(){return a};return a}a=6*d(\"WATimeUtils\").HOUR_SECONDS;c=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(b=d(\"MAWTransactionMode\")).READONLY,ephemeralSettings:b.READWRITE,groupInfo:b.READWRITE,groupInvites:b.READONLY,media:b.READONLY,messages:b.READWRITE,participants:b.READWRITE,reactions:b.READONLY,threads:b.READWRITE,xma:b.READONLY},\"writeAdminMessageForEphemeralSettingsChange\",function(a){return function(b){var c=b.author,e=b.chatJid,f=b.expirationInSec,g=b.isEphemeralSettingReset,i=b.isTurningOnEphemeralSetting,j=b.serverTs;b=d(\"WAJids\").interpretAsGroupJid(e);b=d(\"MAWDexieTable\").dexieAll([d(\"MAWGetOrCreateThreadTxns\").getExistingThread(a,e),b!=null?d(\"MAWDbGroupInfoTxns\").getGroupInfo(a,b):d(\"MAWDexieTable\").dexieResolve()]);return b.then(function(b){var c=b[0];b=b[1];if(c!=null)return{created:!1,thread:c};b=b==null?void 0:(c=b.value)==null?void 0:c.creationTs;return d(\"MAWGetOrCreateThreadTxns\").getOrCreateThread(a,{createTs:b==null?null:d(\"WATimeUtils\").castUnixTimeToMillisTime(b),description:\"writeAdminMessageForEphemeralSettingsChange\",jid:e})}).then(function(b){b=b==null?void 0:b.thread;if(b==null){d(\"WALogger\").ERROR(h());return d(\"WAResultOrError\").makeError({type:\"no_thread\"})}return d(\"MAWEphemeralAdminMsgBuildTxns\").writeEphemeralSettingAdminMsg(a,c,f,j,b,i,g,null)}).then(function(){})}});g.REVOKE_CONTENT_EXPIRATION_IN_SEC=a;g.writeAdminMessageForEphemeralSettingsChange=c}),98);\n__d(\"MAWBulkSetRotateSenderKeyToTrueApi\",[\"MAWDbPersonalSenderKeyStatusTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({personalSenderKeyStatuses:d(\"MAWTransactionMode\").READWRITE},\"bulkSetRotateSenderKeyToTrue\",function(a){return function(b){return d(\"MAWDbPersonalSenderKeyStatusTxns\").bulkSetRotateSenderKeyToTrueTxn(a,b).then(function(){})}});g.bulkSetRotateSenderKeyToTrue=a}),98);\n__d(\"MAWDeleteGroupsApi\",[\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWGroupManagementTxns\",\"MAWIndexedDb\",\"MAWThreadTypes\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor(d(\"MAWThreadTypes\").ThreadRelatedTablesPermissions,\"deleteGroups\",function(a){return function(b){return d(\"MAWDexieTable\").dexieAll(b.map(function(b){var c=b.group;return d(\"MAWDbThreadTxns\").getThreadByJid(a,c).then(function(b){return!b.success?d(\"WAResultOrError\").makeError(\"Missing group thread id\"):d(\"MAWGroupManagementTxns\").deleteGroup(a,c,b.value)})})).then(function(){})}});g.deleteGroups=a}),98);\n__d(\"MAWGetGroupInviteApi\",[\"MAWDbGroupInviteTxns\",\"MAWDbThreadTxns\",\"MAWIndexedDb\",\"MAWLowLevelApiTypes\",\"MAWTransactionMode\",\"WAJids\",\"WALogger\",\"WAResultOrError\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getGroupInvite returned an expired group invite from \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getGroupInvite did not find the group invite from \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getGroupInvite failed to interpret \",\" as a group jid\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getGroupInvite failed to get the thread \",\"\"]);k=function(){return a};return a}a=d(\"MAWIndexedDb\").makeMsgrTransactor({groupInvites:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"getGroupInvite\",function(a){return function(b,c,e){return d(\"MAWDbThreadTxns\").getThread(a,b).then(function(f){var g;if(!f.success){d(\"WALogger\").DEV(k(),b);return d(\"WAResultOrError\").makeError(d(\"MAWLowLevelApiTypes\").GET_GROUP_INVITE_ERROR.MISSING_GROUP)}var l=d(\"WAJids\").interpretAsGroupJid((g=f.value)==null?void 0:g.jid);if(l==null){d(\"WALogger\").DEV(j(),(g=f.value)==null?void 0:g.jid);return d(\"WAResultOrError\").makeError(d(\"MAWLowLevelApiTypes\").GET_GROUP_INVITE_ERROR.MISSING_GROUP)}return d(\"MAWDbGroupInviteTxns\").maybeGetGroupInvite(a,l,e).then(function(a){if(a==null){d(\"WALogger\").DEV(i(),c);return d(\"WAResultOrError\").makeError(d(\"MAWLowLevelApiTypes\").GET_GROUP_INVITE_ERROR.MISSING_GROUP_INVITE)}if(!d(\"WATimeUtils\").isInFuture(a.inviteExpirationTs)){d(\"WALogger\").DEV(h(),c);return d(\"WAResultOrError\").makeError(d(\"MAWLowLevelApiTypes\").GET_GROUP_INVITE_ERROR.EXPIRED_GROUP_INVITE)}return d(\"WAResultOrError\").makeResult({groupInvite:a,groupJid:l})})})}});g.getGroupInvite=a}),98);\n__d(\"MAWGetSenderKeyStatusApi\",[\"MAWDbPersonalSenderKeyStatusTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({personalSenderKeyStatuses:d(\"MAWTransactionMode\").READWRITE},\"getSenderKeyStatus\",function(a){return function(b){return a.personalSenderKeyStatuses.get(b).then(function(c){c!=null?c=d(\"MAWDexieTable\").dexieResolve(c):c=d(\"MAWDbPersonalSenderKeyStatusTxns\").putNewPersonalSenderKeyStatus(a,b);return c.then(function(a){var b=a.hasSenderKey,c=a.rotateSenderKey,d=a.senderKeyId;a=a.senderKeyTs;return{hasSenderKey:b,rotateSenderKey:c,senderKeyId:d,ts:a}})})}});g.getSenderKeyStatus=a}),98);\n__d(\"MAWLoadSenderKeySessionApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"SignalDbTypes\",\"WACryptoManager\",\"WAJids\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({senderKeySessions:d(\"MAWTransactionMode\").READONLY},\"loadSenderKeySession\",function(a){return function(b,c){var e=d(\"WAJids\").extractUserJid(c);c=d(\"WAJids\").extractDeviceId(c);b=d(\"SignalDbTypes\").buildSenderKeySessionId(b,e,c);return a.senderKeySessions.get({id:b}).then(function(a){if(a==null)return d(\"WAResultOrError\").makeError(\"errLoadSenderKeySession\");a=d(\"WACryptoManager\").decodeSenderKeySession(a.record);return d(\"WAResultOrError\").makeResult(a)})}});g.loadSenderKeySession=a}),98);\n__d(\"MAWMarkParticipantNeedsKeyApi\",[\"MAWDbGroupInfoTxns\",\"MAWDbParticipantTxns\",\"MAWDbPersonalSenderKeyStatusTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAJids\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrAndSignalTransactor({groupInfo:d(\"MAWTransactionMode\").READONLY,participants:d(\"MAWTransactionMode\").READONLY,personalSenderKeyStatuses:d(\"MAWTransactionMode\").READWRITE},\"markParticipantNeedsKey\",function(a){return function(b,c){return d(\"MAWDbGroupInfoTxns\").getGroupInfo(a,b).then(function(e){if(!e.success)return d(\"WAResultOrError\").makeError(\"missing\");e=e.value;return d(\"MAWDbParticipantTxns\").getParticipant(a,e.threadId,d(\"WAJids\").extractUserJid(c)).then(function(e){return!e.success?d(\"WAResultOrError\").makeError(\"missing\"):d(\"MAWDbPersonalSenderKeyStatusTxns\").removeDevicesToMultiplePersonalSenderKeyStatuses(a,[b],[c]).then(function(){return d(\"WAResultOrError\").makeResult()})})})}});g.markParticipantNeedsKey=a}),98);\n__d(\"MAWMarkSenderKeyAsRotatedApi\",[\"MAWDbPersonalSenderKeyStatusTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({personalSenderKeyStatuses:d(\"MAWTransactionMode\").READWRITE},\"markSEnderKeyAsRotated\",function(a){return function(b,c,e){return d(\"MAWDbPersonalSenderKeyStatusTxns\").updateSenderKeyStatusAsRotated(a,b,c,e).then(function(){})}});g.markSenderKeyAsRotated=a}),98);\n__d(\"MAWMarkSenderKeyAsSentApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({personalSenderKeyStatuses:d(\"MAWTransactionMode\").READWRITE},\"markSenderKeyAsSent\",function(a){return function(b,c,d){return a.personalSenderKeyStatuses.get(b).then(function(b){if(b==null)return;if(b.senderKeyId!=c)return;d.forEach(function(a){b.hasSenderKey.add(a)});return a.personalSenderKeyStatuses.put(b).then(function(){})})}});g.markSenderKeyAsSent=a}),98);\n__d(\"MAWRemoveGroupInvitesApi\",[\"MAWDbGroupInviteTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"removeGroupInvites deleted \",\" record(s) from \",\" for \",\"\"]);h=function(){return a};return a}a=d(\"MAWIndexedDb\").makeMsgrTransactor({groupInvites:d(\"MAWTransactionMode\").READWRITE},\"removeGroupInvites\",function(a){return function(b,c){return d(\"MAWDbGroupInviteTxns\").deleteGroupInvitesByThreadAndInvitedParticipant(a,b,c).then(function(a){d(\"WALogger\").DEV(h(),a,b,c)})}});g.removeGroupInvites=a}),98);\n__d(\"MAWWriteGroupInviteApi\",[\"MAWDbGroupInfoTxns\",\"MAWDbParticipant\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWLowLevelApiTypes\",\"MAWThreadFetchAndEmitTxns\",\"MAWTransactionMode\",\"MAWWriteGroupInviteTxns\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,editMsgHistory:a.READONLY,groupInfo:a.READWRITE,groupInvites:a.READWRITE,media:a.READONLY,messages:a.READWRITE,participants:a.READWRITE,reactions:a.READONLY,threads:a.READWRITE,xma:a.READONLY},\"writeGroupInvite\",function(a){return function(b,c){var e=d(\"MAWDbGroupInfoTxns\").getGroupInfo(a,b);return d(\"MAWDexieTable\").dexieAll([d(\"MAWThreadFetchAndEmitTxns\").fetchAndEmitThread(a,b,void 0,void 0,\"writeGroupInvite\"),e]).then(function(e){var f=e[0],g=e[1];if(f==null||!g.success)return d(\"WAResultOrError\").makeError(d(\"MAWLowLevelApiTypes\").WRITE_GROUP_INVITE_ERROR.MISSING_GROUP);e=d(\"MAWDbParticipant\").craftParticipantId__DEPRECATED(f.thread.chatId,c.invitedParticipantUserJid);e={inviteCode:c.inviteCode,invitedParticipantId:e,inviteeJid:c.invitedParticipantUserJid,inviteExpirationTs:c.expiration,inviterJid:c.inviterUserJid,threadJid:f.thread.jid};return d(\"MAWWriteGroupInviteTxns\").writeGroupInvite(a,e,b).then(function(a){if(a===d(\"MAWLowLevelApiTypes\").WRITE_GROUP_INVITE_ERROR.MISSING_GROUP)return d(\"WAResultOrError\").makeError(d(\"MAWLowLevelApiTypes\").WRITE_GROUP_INVITE_ERROR.MISSING_GROUP);else if(a===d(\"MAWLowLevelApiTypes\").WRITE_GROUP_INVITE_ERROR.EXISTING_GROUP_INVITE)return d(\"WAResultOrError\").makeError(d(\"MAWLowLevelApiTypes\").WRITE_GROUP_INVITE_ERROR.EXISTING_GROUP_INVITE);return d(\"WAResultOrError\").makeResult(g==null?void 0:(a=g.value)==null?void 0:a.name)})})}});g.writeGroupInvite=b}),98);\n__d(\"MAWConvertCreateGroupResultApi\",[\"MAWDbGroupInfoTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({groupInfo:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"convertCreateGroupResult\",function(a){return function(b){return d(\"MAWDbGroupInfoTxns\").getGroupInfo(a,b.jid).then(function(b){if(!b.success)throw c(\"err\")(\"Tried to convert a createGroup result for a group that has not persisted in the DB\");return a.threads.get(b.value.threadId).then(function(a){if(a==null)throw c(\"err\")(\"Tried to convert a createGroup result for a group but its thread is not in DB\");return{chatJid:a.jid,type:\"msgr\"}})})}});g.convertCreateGroupResult=a}),98);\n__d(\"WAJobBuilder\",[\"Promise\",\"WAPersistedJobManager\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=function(){function a(a){this.steps=a}var b=a.prototype;b.step=function(a,b){return this.$1(a,typeof b===\"function\"?{code:b}:b)};b.$1=function(b,c){var e=c.stopRetryIf,f=c.requirements;c=c.code;f=k(f,c,e);if(e){var g=e.timePassedSeconds;c=e.appCrashed;var h=e.onStopRetry;h=k(null,l(h),e);g!=null&&(f=j(function(a,b,c){a=c.jobStartTime;return d(\"WATimeUtils\").happenedWithin(a,g)},f,h));c&&(f=j(function(a,b,c){a=c.afterCrash;return!a},f,h))}return new a([].concat(this.steps,[{stepName:b,info:f}]))};b.finalStep=function(a,b){var c=this.step(a,b);return{end:function(){return c.steps}}};return a}();function a(){return new i([])}function j(a,b,c){return function(d,e,f){return a(d,e,f)?b(d,e,f):c(d,e,f)}}function k(a,b,c){var d={requirements:a,code:b,stopRetryIf:c};return function(){return d}}function l(a){return function(c,e,f){return(h||(h=b(\"Promise\"))).resolve(a(c,e,f)).then(function(a){return a instanceof d(\"WAPersistedJobManager\").InterruptJob?a:new(d(\"WAPersistedJobManager\").InterruptJob)(a)})}}g.JobBuilder=i;g.definePersistedJob=a}),98);\n__d(\"MAWDefinePersistedJob\",[\"MAWGlobals\",\"Promise\",\"WAJobBuilder\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;c={definePersistedJob:function(){return d(\"WAJobBuilder\").definePersistedJob()}};function a(a){var c=d(\"MAWGlobals\").getJobManager();Object.keys(a).forEach(function(d){var e=a[d];c.addPersistedJobImplementation(d,function(){return(h||(h=b(\"Promise\"))).resolve(e)})})}g.persistedJobsApi=c;g.setMsgrJobImplementations=a}),98);\n__d(\"MAWJobPersistenceAccessorsApi\",[\"MAWJobActionsV2\",\"MAWSignalIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){var a,b,c;return{deletePersistedJob:(a=d(\"MAWSignalIndexedDb\")).makeSignalMsgrTransactor(\"jobs\",(b=d(\"MAWTransactionMode\")).READWRITE,\"deletePersistedJob\")((c=d(\"MAWJobActionsV2\")).deletePersistedJob),loadAllJobs:a.makeSignalMsgrTransactor(\"jobs\",b.READONLY,\"loadAllJobs\")(c.readAllPersistedJobs),maybeCreateJob:a.makeSignalMsgrTransactor(\"jobs\",b.READWRITE,\"maybeCreateJob\")(c.maybeCreateJob),readPersistedJob:a.makeSignalMsgrTransactor(\"jobs\",b.READONLY,\"readPersistedJob\")(c.readPersistedJob),updatePersistedJob:a.makeSignalMsgrTransactor(\"jobs\",b.READWRITE,\"updatePersistedJob\")(c.updatePersistedJob)}}g.getJobPersistenceAccessors=a}),98);\n__d(\"MAWLoadAllJobsApi\",[\"MAWJobActionsV2\",\"MAWSignalIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWSignalIndexedDb\").makeSignalMsgrTransactor(\"jobs\",d(\"MAWTransactionMode\").READONLY,\"loadAllJobs\")(d(\"MAWJobActionsV2\").readAllPersistedJobs);g.loadAllJobs=a}),98);\n__d(\"MAWGetDownloadableThumbnailForMediaApi\",[\"MAWOptimisticUploadManager\",\"WALogger\",\"WAMediaUtils\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"GetDownloadableThumbnail - previewEntry optimistedPromise rejected with \",\"\"]);h=function(){return a};return a}a=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){a=d(\"MAWOptimisticUploadManager\").getOptimisticUploadManager().get(a);if(a==null)return null;a=a.previewPlaintextHash;if(a==null)return null;var b=d(\"MAWOptimisticUploadManager\").getOptimisticUploadManager().get(a);if(b==null)return null;try{yield b.optimisticUploadPromise}catch(a){d(\"WALogger\").ERROR(h(),a);return null}a=(b=d(\"MAWOptimisticUploadManager\").getOptimisticUploadManager().get(a))==null?void 0:b.mediaEntry;if(a==null)return null;b=d(\"WAMediaUtils\").decodeMediaEntryData(a);a=b.directPath;var c=b.fileEncSha256,e=b.fileSha256,f=b.mediaKey,g=b.mediaKeyTimestamp;b=b.objectId;return{directPath:a,fileEncSha256:c,fileSha256:e,mediaKey:f,mediaKeyTimestamp:g,objectId:b}});return function(b){return a.apply(this,arguments)}}();g.getDownloadableThumbnailForMedia=a}),98);\n__d(\"MAWGetMediaByObjectId\",[\"MAWDbMediaTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAMediaUtils\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({media:d(\"MAWTransactionMode\").READONLY,mediaBackup:d(\"MAWTransactionMode\").READONLY},\"getMediaByObjectId\",function(a){return function(b){return d(\"MAWDbMediaTxns\").maybeGetMediaFromObjectId(a,d(\"WAMediaUtils\").stringToDeliveryObjectId(b)).then(function(a){return!a?d(\"WAResultOrError\").makeError(\"media-not-found\"):d(\"WAResultOrError\").makeResult(a)})}});b=d(\"MAWIndexedDb\").makeMsgrTransactor({mediaBackup:d(\"MAWTransactionMode\").READONLY},\"getMediaBackupByObjectId\",function(a){return function(b){return d(\"MAWDbMediaTxns\").maybeGetMediaBackupRowFromObjectId(a,d(\"WAMediaUtils\").stringToDeliveryObjectId(b)).then(function(a){return!a?d(\"WAResultOrError\").makeError(\"mediaBackup-not-found\"):d(\"WAResultOrError\").makeResult(a)})}});g.getMediaByObjectId=a;g.getMediaBackupByObjectId=b}),98);\n__d(\"MAWGetMediaKnownEntriesApi\",[\"MAWDbMediaTxns\",\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAJids\",\"WAMsgMap\",\"WAResultOrError\",\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Message missing in messages table for given msgId for plaintextHash \",\". Skipping...\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No existing media entry found for plaintextHash \",\". Returning new MsgMap.\"]);i=function(){return a};return a}var j=d(\"WATagsLogger\").TAGS([\"GetMediaKnownEntries\"]);a=d(\"MAWIndexedDb\").makeMsgrTransactor({media:d(\"MAWTransactionMode\").READONLY,messages:d(\"MAWTransactionMode\").READONLY},\"getMediaKnownEntries\",function(a){return function(b){return k(a,b)}});function k(a,b){return d(\"MAWDbMediaTxns\").maybeGetMediaFromPlaintextHash(a,b).then(function(c){if(!c){j.LOG(i(),b);return d(\"WAResultOrError\").makeError(\"no-media-entry-by-plaintext-hash\")}var e=Array.from(c.mediaEntries.keys());return d(\"MAWDexieTable\").dexieAll(e.map(function(b){return d(\"MAWDbMsgTxns\").maybeGetMsgListByMsgId_I_KNOW_WHAT_I_AM_DOING(a,b)})).then(function(a){a=a.map(function(a){return a.find(function(a){return(a==null?void 0:a.mediaId)===c.mediaId})});var f=[];a=a.reduce(function(a,g,i){if(!g){j.WARN(h(),b);f.push(e[i]);return a}i=c.mediaEntries.get(g.msgId);var k=g.author,l=g.threadJid;i&&!d(\"WAJids\").isAuthorSystem(k)&&l!=null&&a.set({author:k,chat:l,externalId:g.externalId},i);return a},new(d(\"WAMsgMap\").MsgMap)());return{missingMessages:f,msgMap:a,numEntries:e.length}}).then(d(\"WAResultOrError\").makeResult)})}g.getMediaKnownEntries=a;g.getMediaKnownEntriesTxn=k}),98);\n__d(\"MAWGetOrCreateMediaKnownEntriesApi\",[\"MAWGetMediaKnownEntriesApi\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAMsgMap\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({media:d(\"MAWTransactionMode\").READONLY,messages:d(\"MAWTransactionMode\").READONLY},\"getMediaKnownEntries\",function(a){return function(b){return d(\"MAWGetMediaKnownEntriesApi\").getMediaKnownEntriesTxn(a,b).then(function(a){if(a.success===!1)return new(d(\"WAMsgMap\").MsgMap)();else return a.value.msgMap})}});g.getOrCreateMediaKnownEntries=a}),98);\n__d(\"MAWHandleMediaPreviewDownloadApi\",[\"MAWBridgeTypesCreators\",\"MAWDbChunkTxns\",\"MAWDbMediaTxns\",\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWLoggerUtils\",\"MAWMediaPreviewDownloadManager\",\"MAWTransactionMode\",\"WACryptoSha256\",\"WAMediaUtils\",\"WAResultOrError\",\"WATagsLogger\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Main media for preview is null. Type: \",\"\"]);h=function(){return a};return a}var i=d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.MediaDownload,d(\"MAWLoggerUtils\").Tag.MessageReceive,d(\"MAWLoggerUtils\").Tag.MediaPreview]);a=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,c,e){var f=d(\"WAMediaUtils\").toPlaintextHash(yield d(\"WACryptoSha256\").sha256(b)),g=d(\"MAWMediaPreviewDownloadManager\").getMediaPreviewDownloadingResolvable(a);g!=null&&(g.resolve(new Blob([b],{type:\"image\/jpeg\"})),d(\"MAWMediaPreviewDownloadManager\").removeMediaPreviewDownloadingResolvable(a));return j(a,f,b,c,e)});return function(b,c,d,e){return a.apply(this,arguments)}}();var j=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(c=d(\"MAWTransactionMode\")).READWRITE,media:c.READWRITE,messages:c.READONLY,threads:c.READONLY},\"handleMediaPreviewDownload\",function(a){return function(b,c,e,f,g){return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbMediaTxns\").maybeGetMediaFromPlaintextHash(a,b),d(\"MAWDbMsgTxns\").maybeGetMsgByProtocolMsgId(a,g),k(a,c,e)]).then(function(b){var g=b[0],j=b[1];b[2];if(g==null){i.WARN(h(),f);return d(\"WAResultOrError\").makeError(\"missing-media-on-save\")}switch(f){case\"image\":a.media.update(g.mediaId,babelHelpers[\"extends\"]({},g,{validatedImageInfo:babelHelpers[\"extends\"]({},g.validatedImageInfo,{jpegThumbnail:e,thumbnailPlaintextHash:d(\"MAWGlobals\").getConfig().isSaveThumbnailAsChunkEnabled()?c:void 0})}));break;case\"video\":a.media.update(g.mediaId,babelHelpers[\"extends\"]({},g,{validatedVideoInfo:babelHelpers[\"extends\"]({},g.validatedVideoInfo,{jpegThumbnail:e,thumbnailPlaintextHash:d(\"MAWGlobals\").getConfig().isSaveThumbnailAsChunkEnabled()?c:void 0})}));break;default:f;break}b=g.msgIds.map(d(\"MAWDbMsg\").getThreadIdFromMsgId);return a.threads.bulkGet(b).then(function(a){a.forEach(function(a){a!=null&&d(\"MAWIndexedDb\").afterTransaction({tag:\"NewMedia\",value:d(\"MAWBridgeTypesCreators\").createBridgeMedia(a.chatId,a.jid,g,!0,j==null?void 0:j.sortOrderMs)})});return d(\"WAResultOrError\").makeResult()})})}});function k(a,b,c){return!d(\"MAWGlobals\").getConfig().isSaveThumbnailAsChunkEnabled()?d(\"MAWDexieTable\").dexieResolve():d(\"MAWDbChunkTxns\").getOrCreateMediaChunk(a,b,c,\"image\/jpeg\").then(function(){return d(\"MAWDexieTable\").dexieResolve()})}g.handleMediaPreviewDownload=a}),98);\n__d(\"MAWUpdateMediaEntryForOptimisticUploadApi\",[\"MAWGlobals\",\"MAWOptimisticUploadManager\",\"MAWUpdateMediaEntryForMsgApi\",\"asyncToGeneratorRuntime\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,e,f){var g=d(\"MAWOptimisticUploadManager\").getOptimisticUploadManager(),h=g.get(a),i=h==null?void 0:h.msgId,j=b();if(i!=null){i=(yield d(\"MAWGlobals\").getDbImpls().getProtocolMsgIdByMsgId(i));i&&(yield d(\"MAWUpdateMediaEntryForMsgApi\").updateMediaEntryForMsg(a,i,b,e,f))}else{if(!h)throw c(\"err\")(\"Cannot update mediaEntry without both uploadEntry and msgId\");g.set(a,babelHelpers[\"extends\"]({},h,{mediaEntry:j}))}return});return function(b,c,d,e){return a.apply(this,arguments)}}();g.updateMediaEntryForOptimisticUpload=a}),98);\n__d(\"MAWDebugMsg\",[\"MAWBridgeMsg\",\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWLocalizationType\",\"MAWLocalizationUtils\",\"MAWMsgType\",\"MAWTransactionMode\",\"MAWTransactor\",\"WATimeUtils\",\"gkx\",\"qex\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWTransactor\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,participants:a.READONLY,threads:a.READWRITE},\"writeDebugMsg\",function(a){return function(b,e,f){return!c(\"gkx\")(\"23958\")?d(\"MAWDexieTable\").dexieResolve():d(\"MAWDbThreadTxns\").getThreadByJid(a,b).then(function(b){if(!b.success)return;var g=b.value;return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbMsgTxns\").getThreadNewestMessageBySortOrderOrCache(a,g),d(\"MAWDbMsgTxns\").getThreadNewestMessageTsBySortOrder(a,g),(f==null?void 0:f.decryptionError)===\"errDuplicateMsg\"?d(\"MAWDbMsgTxns\").maybeGetMsgByProtocolMsgId(a,f.protocolMsgId).then(function(a){if(a==null)return\", no existing message\";return a.type===d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT?\", existing ciphertext message\":\",  existing message\"}):d(\"MAWDexieTable\").dexieResolve(\"\"),d(\"MAWDbMsgTxns\").getNextMsgIdNumberForThread(a,g)]).then(function(a){var b=a[0],f=a[1],h=a[2];a=a[3];a=d(\"MAWDbMsg\").craftDebugMsgId(g.chatId,a-1);f=d(\"WATimeUtils\").castToMillisTime(((b=(b=b==null?void 0:b.sortOrderMs)!=null?b:f)!=null?b:0)+1);b=d(\"MAWLocalizationUtils\").buildUnstoredDbAdminMsg({adminMsgContent:[\"[fb-only][DEBUG]: \"+(e+h)],adminType:d(\"MAWLocalizationType\").LOCALIZATION_TYPE.DEBUG_MSG,version:0},g.chatId,g.jid);c(\"qex\")._(\"1210\")!==!0&&d(\"MAWIndexedDb\").afterTransaction({tag:\"NewMsg\",value:d(\"MAWBridgeMsg\").createBridgeMsg(babelHelpers[\"extends\"]({},b,{msgId:a,sortOrderMs:f}))})})})}});g.writeDebugMsg=b}),98);\n__d(\"MAWGetLastMsgsInChatForSpamReportApi\",[\"MAWDbEditMsgHistoryTxns\",\"MAWDbMediaTxns\",\"MAWDbMsg\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWJidUtils\",\"MAWMsgType\",\"MAWTransactionMode\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({editMsgHistory:(a=d(\"MAWTransactionMode\")).READONLY,media:a.READONLY,messages:a.READONLY,threads:a.READONLY,unrenderedMessages:a.READONLY},\"getLastMsgsInChatForSpamReport\",function(a){return function(b,e){return e===0?d(\"MAWDexieTable\").dexieResolve([]):a.threads.get({jid:b}).then(function(b){if(b==null)throw c(\"err\")(\"Missing thread\");b=b.jid;var f=h(a,b,e);return a.messages.where(\"[threadJid+sortOrderMs]\").between([b,Number.MIN_SAFE_INTEGER],[b,Number.MAX_SAFE_INTEGER],!1,!1).filter(function(a){return d(\"MAWDbMsg\").isContentMsg(a)}).reverse().limit(e).toArray().then(function(a){return f.then(function(b){return b.concat(a)})}).then(function(a){return a.sort(function(a,b){return a.msgId<b.msgId?-1:a.msgId>b.msgId?1:0}).slice(0,e)}).then(function(b){return d(\"MAWDexieTable\").dexieAll(b.map(function(b){return d(\"MAWDbMediaTxns\").getAndCheckMediaFromMsg(a,b).then(function(a){return{mediaInfo:a.success?a.value:null,msg:b}}).then(function(b){var c=d(\"MAWJidUtils\").toProtocolMsgId(b.msg);return c!==null?d(\"MAWDbEditMsgHistoryTxns\").maybeGetEditMsgHistoryFromProtocolMsgId(a,c).then(function(a){a=a.sort(function(a,b){return b.editTs-a.editTs}).slice(1);return babelHelpers[\"extends\"]({},b,{editHistory:a})}):b})}))})})}});function h(a,b,c){return a.unrenderedMessages.where(\"threadJid\").equals(b).filter(function(a){return a.type===d(\"MAWMsgType\").MSG_TYPE.DELETE_FOR_ME}).reverse().limit(c).toArray().then(function(a){var b=[];a.forEach(function(a){a.type===d(\"MAWMsgType\").MSG_TYPE.DELETE_FOR_ME&&b.push(a)});return b})}g.getLastMsgsInChatForSpamReport=b}),98);\n__d(\"MAWGetNextDeleteDFMContentTs\",[\"MAWIndexedDb\",\"MAWReStoreTiming\",\"MAWRestoreDbState\",\"MAWTransactionMode\",\"ReQL\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWRestoreDbState\").isUsingShim()?d(\"MAWReStoreTiming\").measureDuration(\"getNextDeleteDFMContentTs\",function(a){var b=d(\"WATimeUtils\").unixTime();return d(\"ReQL\").firstAsync(d(\"ReQL\").fromTableAscending(a.tables.e2ee_unrenderedMessages.index(\"messageDeleteForMeTs\")).bounds({gte:[b]}).map(function(a){return a.messageDeleteForMeTs}))}):d(\"MAWIndexedDb\").makeMsgrTransactor({unrenderedMessages:d(\"MAWTransactionMode\").READONLY},\"getNextDeleteDFMContentTs\",function(a){return function(){var b=d(\"WATimeUtils\").unixTime();return a.unrenderedMessages.orderBy(\"messageDeleteForMeTs\").filter(function(a){return(a==null?void 0:a.messageDeleteForMeTs)!=null?a.messageDeleteForMeTs>=b:!1}).first().then(function(a){return a==null?void 0:a.messageDeleteForMeTs})}});g.getNextDeleteDFMContentTs=a}),98);\n__d(\"MAWGetNextDeletePendingStanzaTs\",[\"MAWIndexedDb\",\"MAWReStoreTiming\",\"MAWRestoreDbState\",\"MAWTransactionMode\",\"ReQL\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWRestoreDbState\").isUsingShim()?d(\"MAWReStoreTiming\").measureDuration(\"getNextDeletePendingStanzaTs\",function(a){var b=d(\"WATimeUtils\").unixTime();return d(\"ReQL\").firstAsync(d(\"ReQL\").fromTableAscending(a.tables.e2ee_pendingStanzas.index(\"deleteTs\"),[\"deleteTs\"]).bounds({gte:[b]}).map(function(a){a=a.deleteTs;return a}))}):d(\"MAWIndexedDb\").makeMsgrTransactor({pendingStanzas:d(\"MAWTransactionMode\").READONLY},\"getNextDeletePendingStanzaTs\",function(a){return function(){var b=d(\"WATimeUtils\").unixTime();return a.pendingStanzas.orderBy(\"deleteTs\").filter(function(a){return a.deleteTs!=null?a.deleteTs>b:!1}).first().then(function(a){return a==null?void 0:a.deleteTs})}});g.getNextDeletePendingStanzaTs=a}),98);\n__d(\"MAWGetNextDeleteUnsendContentTs\",[\"MAWIndexedDb\",\"MAWReStoreTiming\",\"MAWRestoreDbState\",\"MAWTransactionMode\",\"ReQL\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWRestoreDbState\").isUsingShim()?d(\"MAWReStoreTiming\").measureDuration(\"getNextDeleteUnsendContentTs\",function(a){var b=d(\"WATimeUtils\").unixTime();return d(\"ReQL\").firstAsync(d(\"ReQL\").fromTableAscending(a.tables.e2ee_messages.index(\"unsendMsgContentDeleteTs\"),[\"unsendMsgContentDeleteTs\"]).bounds({gte:[b]}).map(function(a){return a.unsendMsgContentDeleteTs}))}):d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"getNextDeleteUnsendContentTs\",function(a){return function(){var b=d(\"WATimeUtils\").unixTime();return a.messages.orderBy(\"unsendMsgContentDeleteTs\").filter(function(a){return(a==null?void 0:a.unsendMsgContentDeleteTs)!=null?a.unsendMsgContentDeleteTs>=b:!1}).first().then(function(a){return a==null?void 0:a.unsendMsgContentDeleteTs})}});g.getNextDeleteUnsendContentTs=a}),98);\n__d(\"MAWGetNextExpiredXMATs\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({xma:d(\"MAWTransactionMode\").READONLY},\"getNextDeleteUnsendContentTs\",function(a){return function(){var b=d(\"WATimeUtils\").unixTime();return a.xma.orderBy(\"targetExpiringAtSec\").filter(function(a){return(a==null?void 0:a.targetExpiringAtSec)!=null?a.targetExpiringAtSec>=b:!1}).first().then(function(a){return a==null?void 0:a.targetExpiringAtSec})}});g.getNextExpiredXMATs=a}),98);\n__d(\"MAWGetProtocolMsgIdByMediaMsgId\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"getProtocolMsgIdByMediaMsgId\",function(a){return function(b){return a.messages.get({msgId:b}).then(function(b){return b==null?null:a.threads.get(b.thread).then(function(a){if(a==null)return null;return d(\"WAJids\").isAuthorSystem(b.author)?null:{author:b.author,chat:a.jid,externalId:b.externalId}})})}});g.getProtocolMsgIdByMediaMsgId=a}),98);\n__d(\"MAWGetProtocolMsgIdByMsgId\",[\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:(a=d(\"MAWTransactionMode\")).READONLY,reactions:a.READONLY,threads:a.READONLY,unrenderedMessages:a.READONLY},\"getProtocolMsgByMsgId\",function(a){return function(b){return d(\"MAWDexieTable\").dexieAll([a.messages.get({msgId:b}),a.unrenderedMessages.get({msgId:b}),a.reactions.get({reactionId:b})]).then(function(b){var c=b[0],e=b[1];b=b[2];if(b!=null)if(d(\"WAJids\").isAuthorSystem(b.author))return null;else return{author:b.author,chat:b.threadJid,externalId:b.externalId};var f=c||e;return f==null?null:a.threads.get(f.thread).then(function(a){if(a==null)return null;return d(\"WAJids\").isAuthorSystem(f.author)?null:{author:f.author,chat:a.jid,externalId:f.externalId}})})}});g.getProtocolMsgIdByMsgId=b}),98);\n__d(\"MAWHandleReachabilityErrorAdminMsgApi\",[\"MAWAdminMsgTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"handleReachabilityErrorAdminMsg: chat \",\"\"]);h=function(){return a};return a}b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,threads:a.READWRITE},\"handleReachabilityErrorAdminMsg\",function(a){return function(b){d(\"WALogger\").DEV(h(),b);return d(\"MAWAdminMsgTxns\").writeReachabilityErrorAdminMsg(a,b).then(function(){})}});g.handleReachabilityErrorAdminMsg=b}),98);\n__d(\"MAWModifyRavenMsgApi\",[\"MAWDbRavenActionTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READWRITE,threads:d(\"MAWTransactionMode\").READWRITE,unrenderedMessages:d(\"MAWTransactionMode\").READWRITE},\"modifyRavenMsg\",function(a){return function(b){if(b==null)throw c(\"err\")(\"modifyRavenMsg called with invalid ravenProtocolMsgId\");var e=b.chat;b=b.externalId;return a.messages.where(\"externalId\").equals(b).filter(function(a){return a.threadJid===e}).first().then(function(b){return d(\"MAWDbRavenActionTxns\").modifyRavenMsgWithActionMsg(a,b)}).then(function(){})}});g.modifyRavenMsg=a}),98);\n__d(\"MAWProcessSpamMsgApi\",[\"ArmadilloDataTraceType\",\"I64\",\"MAWBridgeMsg\",\"MAWBridgeTrace\",\"MAWBridgeTypesCreators\",\"MAWCalculateBumpTimestampMs\",\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDbThreadTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWMsgType\",\"MAWThreadSnippetBuildTxns\",\"MAWTransactionMode\",\"WALogger\",\"WATimeUtils\",\"gkx\",\"qex\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"processSpamMsgs: \",\" for thread \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"processSpamMsgs thread for \",\" no longer exists\"]);j=function(){return a};return a}a=d(\"MAWIndexedDb\").makeMsgrTransactor({groupInfo:d(\"MAWTransactionMode\").READONLY,messages:d(\"MAWTransactionMode\").READWRITE,threads:d(\"MAWTransactionMode\").READWRITE},\"processSpamMsgs\",function(a){return function(){return d(\"MAWDbMsgTxns\").getSpamMsgs(a).then(function(b){d(\"MAWDexieTable\").dexieAll(b.map(function(b){var e=b.thread;return d(\"MAWDbThreadTxns\").getThread(a,e).then(function(c){if(!c.success){d(\"WALogger\").WARN(j(),e);return[void 0,void 0,void 0]}c=c.value;d(\"WALogger\").DEV(i(),b.rowId,c.chatId);b.type===d(\"MAWMsgType\").MSG_TYPE.FUTUREPROOF?b.altIndex=d(\"MAWDbMsg\").FUTUREPROOF_ALT_INDEX:b.altIndex=void 0;return d(\"MAWDexieTable\").dexieAll([a.messages.put(b),d(\"MAWDexieTable\").dexieResolve(c),d(\"MAWThreadSnippetBuildTxns\").buildThreadSnippet(a,b,c)])}).then(function(a){a[0];var f=a[1];a=a[2];if(!f)return;var g=f.jid,i=f.lastReadMsgTs,j=f.newestMsgTs;d(\"MAWIndexedDb\").afterTransaction({tag:\"StartTrace\",value:d(\"MAWBridgeTrace\").createBridgeStartTraceData(b,g,d(\"ArmadilloDataTraceType\").armadilloMessageSend)});c(\"qex\")._(\"1210\")!==!0&&d(\"MAWIndexedDb\").afterTransaction({tag:\"NewMsg\",value:d(\"MAWBridgeMsg\").createBridgeMsg(b)});if(a!=null)if(!c(\"gkx\")(\"23996\"))d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadBumped\",value:d(\"MAWBridgeTypesCreators\").createBridgeBumpedThread(b.thread,b.threadJid,j!=null?j:d(\"WATimeUtils\").castUnixTimeToMillisTime(b.ts),i,a.snippetType,a.snippetParams,a.snippetSenderContactId,\"processSpamMsgs\",b.externalId)});else{i=d(\"MAWCalculateBumpTimestampMs\").calculateBumpTimestampMs((g=j)!=null?g:d(\"WATimeUtils\").castUnixTimeToMillisTime(b.ts),(h||(h=d(\"I64\"))).of_string_opt(b.externalId));d(\"MAWIndexedDb\").afterTransaction({tag:\"ThreadBumpedV2\",value:d(\"MAWBridgeTypesCreators\").createBridgeBumpedThreadV2({bumpTimestampMs:i,description:\"processSpamMsgs\",isMessageAuthorMe:!1,skipServerThreadBump:!0,snippetParams:a.snippetParams,snippetSenderContactId:a.snippetSenderContactId,snippetType:a.snippetType,threadId:b.thread,threadJid:b.threadJid})})}f.oldestMsg==null&&d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgsLoaded\",value:d(\"MAWBridgeTypesCreators\").createBridgeMsgsLoadedInfo(e,b.threadJid,[b],!0,!1,!1)})})}))})}});g.processSpamMsgs=a}),98);\n__d(\"MAWRemoveExpiredDFMMsgsContent\",[\"MAWDbEditMsgHistoryTxns\",\"MAWDeleteExpiredMsgsApi\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWJidUtils\",\"MAWMsgType\",\"MAWTransactionMode\",\"MAWXMAUtils\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READWRITE,editMsgHistory:a.READWRITE,media:a.READWRITE,mediaBackup:a.READWRITE,unrenderedMessages:a.READWRITE,xma:a.READWRITE},\"removeExpiredDFMMsgsContent\",function(a){return function(){var b=d(\"WATimeUtils\").unixTime();return a.unrenderedMessages.where(\"messageDeleteForMeTs\").belowOrEqual(b).toArray().then(function(b){var c=b.map(function(a){if(a.mediaId!=null)return[a.mediaId,a.msgId]}).filter(Boolean),e=b.map(function(a){if(a.type===d(\"MAWMsgType\").MSG_TYPE.DELETE_FOR_ME)return babelHelpers[\"extends\"]({},a,{mediaId:void 0,msgContent:void 0,quote:void 0,serverTs:void 0,xmaMessageType:void 0})}).filter(Boolean),f=b.map(function(a){var b;b=(b=a.quote)==null?void 0:b.content;if(d(\"MAWXMAUtils\").isXMAShare(a.xmaMessageType)&&a.externalId!=null){var c=d(\"MAWJidUtils\").maybeToProtocolMsgId(a.author,a.threadJid,a.externalId);if(c!=null)return[c,a.msgId]}else if(b!=null&&d(\"MAWXMAUtils\").isXMAStoryReply(b.xmaMessageType)){c=d(\"MAWJidUtils\").maybeToProtocolMsgId(b.author,a.threadJid,b.externalId);if(c!=null)return[c,a.msgId]}}).filter(Boolean),g=b.map(function(a){return[a.externalId,a.threadJid]});return d(\"MAWDexieTable\").dexieAll([d(\"MAWDeleteExpiredMsgsApi\").deleteOrUpdateXMAForExpiredMsgs(a,f),d(\"MAWDeleteExpiredMsgsApi\").deleteOrUpdateMediaAndChunkForExpiredMsgs(a,c),d(\"MAWDbEditMsgHistoryTxns\").deleteExpiredEditMsgHistory(a,g),a.unrenderedMessages.bulkPut(e)]).then(function(){return d(\"MAWDexieTable\").dexieResolve(b.length)})})}});g.removeExpiredDFMMsgsContent=b}),98);\n__d(\"MAWRemoveExpiredPendingStanzas\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({pendingStanzas:d(\"MAWTransactionMode\").READWRITE},\"removeExpiredPendingStanzas\",function(a){return function(){var b=d(\"WATimeUtils\").unixTime();return a.pendingStanzas.where(\"deleteTs\").belowOrEqual(b).toArray().then(function(b){var c=b.map(function(a){return a.rowId});return a.pendingStanzas.bulkDelete(c).then(function(){return c.length})})}});g.removeExpiredPendingStanzas=a}),98);\n__d(\"MAWRemoveExpiredUnsendMsgsContent\",[\"MAWDbEditMsgHistoryTxns\",\"MAWDeleteExpiredMsgsApi\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWJidUtils\",\"MAWMsgType\",\"MAWTransactionMode\",\"MAWXMAUtils\",\"WAArmadilloXMA.pb\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READWRITE,editMsgHistory:a.READWRITE,media:a.READWRITE,mediaBackup:a.READWRITE,messages:a.READWRITE,xma:a.READWRITE},\"removeExpiredUnsendMsgsContent\",function(a){return function(){return h(a)}});function h(a){var b=d(\"WATimeUtils\").unixTime();return a.messages.where(\"unsendMsgContentDeleteTs\").belowOrEqual(b).toArray().then(function(b){var c=b.map(function(a){if(a.mediaId!=null)return[a.mediaId,a.msgId]}).filter(Boolean),e=b.map(function(a){if(a.type===d(\"MAWMsgType\").MSG_TYPE.REVOKED)return babelHelpers[\"extends\"]({},a,{mediaId:void 0,msgContent:void 0,quote:void 0,reportingMeta:void 0,xmaMessageType:void 0})}).filter(Boolean),f=b.map(function(a){if(d(\"MAWXMAUtils\").isXMAShare(a.xmaMessageType)&&a.revokedExternalId!=null){var b=d(\"MAWJidUtils\").maybeToProtocolMsgId(a.author,a.threadJid,a.revokedExternalId);if(b!=null)return[b,a.msgId]}else if(a.quote!=null&&a.quote.content.xmaMessageType===d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY){b=d(\"MAWJidUtils\").maybeToProtocolMsgId(a.quote.content.author,a.threadJid,a.quote.content.externalId);if(b!=null)return[b,a.msgId]}}).filter(Boolean),g=b.map(function(a){return[a.externalId,a.threadJid]});return d(\"MAWDexieTable\").dexieAll([d(\"MAWDeleteExpiredMsgsApi\").deleteOrUpdateXMAForExpiredMsgs(a,f),d(\"MAWDeleteExpiredMsgsApi\").deleteOrUpdateMediaAndChunkForExpiredMsgs(a,c),d(\"MAWDbEditMsgHistoryTxns\").deleteExpiredEditMsgHistory(a,g),a.messages.bulkPut(e)]).then(function(){return d(\"MAWDexieTable\").dexieResolve(b.length)})})}g.removeExpiredUnsendMsgsContent=b;g.removeExpiredUnsendMsgsContentTxn=h}),98);\n__d(\"MAWRemoveExpiredXMAMsgsContentApi\",[\"MAWBridgeMsg\",\"MAWBridgeXMA\",\"MAWDbMsgTxns\",\"MAWDeleteExpiredMsgsApi\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"MAWXMAExpirationTxns\",\"MAWXMAUtils\",\"WALogger\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"XMAId is null when handling tombstone, something went wrong\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Trying to expire an non-story share XMA in XMA Cleaner\"]);i=function(){return a};return a}b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READWRITE,media:a.READWRITE,mediaBackup:a.READWRITE,messages:a.READWRITE,xma:a.READWRITE},\"removeExpiredXMAMsgsContent\",function(a){return function(){var b=d(\"WATimeUtils\").unixTime();return a.xma.where(\"targetExpiringAtSec\").belowOrEqual(b).filter(function(a){return a.isTombstoned!=null&&!a.isTombstoned||a.isTombstoned==null}).toArray().then(function(b){var c=[],e=new Map(),f=[],g=[],h=[];b.forEach(function(a){d(\"MAWXMAUtils\").isXMAShare(a.targetType)&&!d(\"MAWXMAUtils\").isXMAStoryShare(a.targetType)&&d(\"WALogger\").ERROR(i());var b=a.msgId;if(b==null)return;d(\"MAWXMAUtils\").isXMAStoryShare(a.targetType)&&(e.set(b,a.xmaId),f.push({author:a.author,chat:a.threadJid,externalId:a.externalId}));d(\"MAWXMAUtils\").isXMAStoryReply(a.targetType)&&(g.push(b),a.associatedMessageId!=null&&h.push(a.associatedMessageId));var j=a.previewMediaIds;j!=null&&j.forEach(function(a){c.push([a,b])});a.faviconMediaId!=null&&c.push([a.faviconMediaId,b]);a.headerMediaId!=null&&c.push([a.headerMediaId,b])});var l=b.map(function(a){return d(\"MAWXMAUtils\").buildTombstonedDbXMA(a)}),m=Array.from(e.keys());return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbMsgTxns\").bulkUpdateDbMsgXMAExpired(a,[].concat(m,g)),d(\"MAWXMAExpirationTxns\").getXMAShareReplyMsgsToUpdate(a,f),d(\"MAWXMAExpirationTxns\").updateExpiredStoryReplyMsg(a,h),d(\"MAWDeleteExpiredMsgsApi\").deleteOrUpdateMediaAndChunkForExpiredMsgs(a,c),a.xma.bulkPut(l)]).then(function(a){var c=a[0],f=a[1];a=a[2];j(c,e,f);k(a);return d(\"MAWDexieTable\").dexieResolve(b.length)})})}});function j(a,b,c){a.forEach(function(a){if(!d(\"MAWXMAUtils\").isXMAStoryShare(a.xmaMessageType))return;d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgUpdated\",value:d(\"MAWBridgeMsg\").createBridgeMsg(a)});var c=b.get(a.msgId);if(c==null){d(\"WALogger\").ERROR(h());return}d(\"MAWIndexedDb\").afterTransaction({tag:\"XMAShareTombstoned\",value:d(\"MAWBridgeXMA\").createBridgeXMAShareTombstoned(a,c)})}),c.forEach(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgUpdated\",value:d(\"MAWBridgeMsg\").createBridgeMsg(a,void 0,void 0)})})}function k(a){a.map(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"MsgUpdated\",value:d(\"MAWBridgeMsg\").createBridgeMsg(a)})})}g.removeExpiredXMAMsgsContent=b}),98);\n__d(\"MAWWriteLocalXMAMsgApi\",[\"MAWAckLevel\",\"MAWAuthor\",\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWMsgType\",\"MAWTransactionMode\",\"MAWVault\",\"MAWWriteMsgTxns\",\"WAJids\",\"WALogger\",\"WATimeUtils\",\"err\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"msgToQuotedMsg-XMA: Unsupported message type \",\"\"]);h=function(){return a};return a}b=d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(a=d(\"MAWTransactionMode\")).READONLY,groupInfo:a.READONLY,media:a.READONLY,messages:a.READWRITE,participants:a.READONLY,threads:a.READWRITE,unrenderedMessages:a.READWRITE,xma:a.READONLY},\"writeLocalXMAMsg\",function(a){return function(b,e,f,g,h){g.content!=null&&(g.content=d(\"MAWVault\").vault(g.content));return d(\"MAWDexieTable\").dexieAll([a.threads.get({jid:e}),a.messages.where(\"externalId\").equals(b).toArray(),i(a,g.quote,e)]).then(function(e){var i=e[0],k=e[1];e=e[2];if(i==null)return{type:\"missing_thread\"};k=k.find(function(a){return a.thread===i.chatId&&a.author===h});if(k!=null)return{protocolMsgId:{author:h,chat:i.jid,externalId:k.externalId},type:\"already_sent\"};else{k={ack:d(\"MAWAckLevel\").ACK.clock,altIndex:void 0,author:h,ephemeralSetting:g.ephemeralSetting,externalId:b,isForwarded:g.isForwarded,specialTextSize:g.specialTextSize,thread:i.chatId,threadJid:i.jid,ts:f};k=j(k,g,e);e=g.isFirstMsg;var l=g.openMessageOtid,m=g.openMessageParticipantCount,n=g.optimisticMsg,o=g.participantCount;return d(\"MAWWriteMsgTxns\").writeMsg(a,k,i,{isCurrentDeviceSendingMsg:!0,isFirstMsg:e,isOutgoing:!0,openMessageOtid:l,openMessageParticipantCount:m,optimisticMsg:n,participantCount:o,skipLocalThreadBump:c(\"gkx\")(\"23996\")}).then(function(){return{protocolMsgId:{author:h,chat:i.jid,externalId:b},type:\"sent\"}})}})}});function i(a,b,c){return b==null?d(\"MAWDexieTable\").dexieResolve(null):d(\"MAWDbMsgTxns\").maybeGetMsgByProtocolMsgId(a,b).then(function(b){return b==null?null:a.threads.get(b.thread).then(function(a){var e=b?k(b):null;b.messageExpirationTs!=null&&b.messageExpirationTs<d(\"WATimeUtils\").unixTime()&&e!=null&&(e=babelHelpers[\"extends\"]({},e,{mediaId:void 0,msgContent:void 0,type:d(\"MAWMsgType\").MSG_TYPE.EXPIRED_EPHEMERAL,xmaMessageType:void 0}));if(a==null||a.jid===c)return{content:e,remoteJid:null};a=d(\"WAJids\").interpretAndValidateJid(a.jid);a=a.jidType===\"group\"?a.groupJid:null;return{content:e,remoteJid:a}})})}function j(a,b,e){var f,g;if(b.quote!=null&&(e==null?void 0:e.content)!=null){var h;g=e==null?void 0:(h=e.content)==null?void 0:h.externalId;f={content:e==null?void 0:e.content,remoteJid:(h=e==null?void 0:e.remoteJid)!=null?h:void 0}}if(b.xmaMessageType==null)throw c(\"err\")(\"XMA Message Missing xmaMessageType\");return babelHelpers[\"extends\"]({},a,{quote:f,quoteExternalId:g,type:d(\"MAWMsgType\").MSG_TYPE.XMA,xmaMessageType:b.xmaMessageType})}function k(a){var b={author:d(\"MAWAuthor\").getAuthorUserJid(a.author)||d(\"WAJids\").AUTHOR_ME,externalId:a.externalId,mediaId:a.mediaId,msgId:a.msgId,specialTextSize:a.specialTextSize,ts:a.ts,xmaMessageType:a.xmaMessageType};switch(a.type){case d(\"MAWMsgType\").MSG_TYPE.IMAGE:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.IMAGE});case d(\"MAWMsgType\").MSG_TYPE.VIDEO:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.VIDEO});case d(\"MAWMsgType\").MSG_TYPE.PTT:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.PTT});case d(\"MAWMsgType\").MSG_TYPE.TEXT:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.TEXT});case d(\"MAWMsgType\").MSG_TYPE.STICKER:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.STICKER});case d(\"MAWMsgType\").MSG_TYPE.GIF:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.GIF});case d(\"MAWMsgType\").MSG_TYPE.XMA:return babelHelpers[\"extends\"]({},b,{msgContent:a.msgContent,type:d(\"MAWMsgType\").MSG_TYPE.XMA,xmaMessageType:a.xmaMessageType});default:d(\"WALogger\").ERROR(h(),a.type);throw c(\"err\")(\"Trying to reply to a message type that does not support replies\")}}g.writeLocalXMAMsg=b}),98);\n__d(\"MAWWriteMsgRetryApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAMsg\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({receipts:d(\"MAWTransactionMode\").READWRITE},\"writeMsgRetry\",function(a){return function(b,c,e){return h(a,d(\"WAMsg\").craftWAMsgIdString({author:b.author,chat:b.chat,externalId:b.externalId}),c,e)}});function h(a,b,c,d){return a.receipts.get({waMsgId:b}).then(function(b){if(b==null||b.permittedIdentitiesPerDevice==null)return;var e=b.permittedIdentitiesPerDevice,f=e.get(c);if(f==null)return;f.baseKey=d;e.set(c,f);return a.receipts.update(b.msgId,{permittedIdentitiesPerDevice:e}).then(function(){})})}g.writeMsgRetry=a}),98);\n__d(\"MAWWriteMsgRetryCountApi\",[\"MAWTransactionMode\",\"MAWTransactor\",\"WAMsg\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWTransactor\").makeSignalTransactor({receipts:d(\"MAWTransactionMode\").READWRITE},\"writeMsgRetryCount\",function(a){return function(b,c,e){return h(a,d(\"WAMsg\").craftWAMsgIdString({author:b.author,chat:b.chat,externalId:b.externalId}),c,e)}});function h(a,b,c,d){return a.receipts.get({waMsgId:b}).then(function(b){var e;if(b==null||d==null)return;e=(e=b.retryCountsPerDevice)!=null?e:new Map();e.set(c,d);return a.receipts.update(b.msgId,{retryCountsPerDevice:e}).then(function(){})})}g.writeMsgRetryCount=a}),98);\n__d(\"MAWGetMetaApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READONLY},\"getMeta\",function(a){return function(){return a.meta.bulkGet([\"certificateChain\",\"deviceId\",\"identityKeyPair\",\"abProps\",\"edgeInfo\",\"clockSkew\",\"authKeyPair\"]).then(function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5];a=a[6];return{abProps:e==null?void 0:(e=e.value)==null?void 0:e.abProps,authKeyPair:a==null?void 0:(e=a.value)==null?void 0:e.authKeyPair,certificateChain:b==null?void 0:(a=b.value)==null?void 0:a.certificateChain,clockSkew:g==null?void 0:(e=g.value)==null?void 0:e.clockSkew,deviceId:c==null?void 0:(b=c.value)==null?void 0:b.deviceId,edgeInfo:f==null?void 0:(a=f.value)==null?void 0:a.edgeInfo,identityKeyPair:d==null?void 0:(g=d.value)==null?void 0:g.identityKeyPair}})}});g.getMeta=a}),98);\n__d(\"MAWSetMetaApi\",[\"MAWBridge\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READWRITE},\"getMeta\",function(a){return function(b){return d(\"MAWDexieTable\").dexieAll(Object.entries(b).map(function(b){var c=b[0],e=b[1];return a.meta.put({key:c,value:(b={},b[c]=e,b)}).then(function(){c===\"clockSkew\"&&typeof e===\"number\"&&d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"uiUpdate\",{events:[{tag:\"ClockSkewUpdated\",value:e}]})})})).then(function(){})}});g.setMeta=a}),98);\n__d(\"MAWDeletePreKeyGenerationsApi\",[\"MAWDbPrekeyTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAGetPrekeyIdsInRange\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Attempting to delete non-existent prekey generation\"]);h=function(){return a};return a}a=d(\"MAWIndexedDb\").makeSignalTransactor({prekey:d(\"MAWTransactionMode\").READWRITE,prekeyGeneration:d(\"MAWTransactionMode\").READWRITE},\"deletePreKeyGenerations\",function(a){return function(b){return a.prekeyGeneration.bulkGet(b).then(function(c){var e=[];c.forEach(function(a){if(a==null){d(\"WALogger\").WARN(h());return}d(\"WAGetPrekeyIdsInRange\").getPrekeyIdsInRange(a.startingId,a.endingId).forEach(function(a){e.push(a)})});c=a.prekeyGeneration.bulkDelete(b);var f=d(\"MAWDbPrekeyTxns\").bulkDeletePreKeys(a,e);return d(\"MAWDexieTable\").dexieAll([c,f]).then(function(){})})}});g.deletePreKeyGenerations=a}),98);\n__d(\"MAWGetLastPreKeyGenerationIdApi\",[\"MAWDbMetaTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READONLY},\"getLastPreKeyGenerationId\",function(a){return function(){var b=d(\"MAWDbMetaTxns\").maybeGetLastPrekeyId(a),e=d(\"MAWDbMetaTxns\").maybeGetLastPrekeyGenerationId(a);return d(\"MAWDexieTable\").dexieAll([b,e]).then(function(a){var b=a[0];a=a[1];if(b==null&&a!=null||b!=null&&a==null)throw c(\"err\")(\"Last prekey id and Last prekey generation id should both be non-null\");if(b!=null&&a!=null)return{lastGenerationId:a,lastPreKeyId:b};else return null})}});g.getLastPreKeyGenerationId=a}),98);\n__d(\"MAWGetPreKeyGenerationsTimestampsApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({prekeyGeneration:d(\"MAWTransactionMode\").READONLY},\"getPreKeyGenerationsTimestamps\",function(a){return function(){return a.prekeyGeneration.toArray().then(function(a){return a.map(function(a){return{id:a.generationId,timestamp:a.createdTs}})})}});g.getPreKeyGenerationsTimestamps=a}),98);\n__d(\"MAWLoadLatestSignedPreKeyApi\",[\"MAWDbSignedPrekeyTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READONLY,signedPrekey:d(\"MAWTransactionMode\").READONLY},\"loadLatestSignedPreKey\",function(a){return function(){return d(\"MAWDbSignedPrekeyTxns\").getLatestSignedPreKey(a)}});g.loadLatestSignedPreKey=a}),98);\n__d(\"MAWLoadOneTimePreKeyApi\",[\"MAWIndexedDb\",\"MAWODSProxy\",\"MAWTransactionMode\",\"WAOdsEnums\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({prekey:d(\"MAWTransactionMode\").READONLY},\"loadOneTimePreKey\",function(a){return function(b){return a.prekey.get(b).then(function(a){if(a==null)d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.GET_PREKEY,key:\"miss_prekey_in_db\"});else return a.encoded})}});g.loadOneTimePreKey=a}),98);\n__d(\"MAWLoadPreKeysApi\",[\"MAWCompareIdentity\",\"MAWDbMetaTxns\",\"MAWDbPrekeyTxns\",\"MAWDbSignedPrekeyTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWLoggerUtils\",\"MAWTransactionMode\",\"WASignalSignatures\",\"WATagsLogger\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No last prekey generation id\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to deserialize signed prekey\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to get latest signed prekey\"]);j=function(){return a};return a}var k=d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.SignedPrekey]);b=d(\"MAWIndexedDb\").makeSignalTransactor({identity:(a=d(\"MAWTransactionMode\")).READONLY,meta:a.READONLY,prekey:a.READONLY,prekeyGeneration:a.READONLY,signedPrekey:a.READONLY},\"loadPreKeys\",function(a){return function(b){return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbSignedPrekeyTxns\").getLatestSignedPreKey(a),d(\"MAWCompareIdentity\").compareIdentityDexie(a)]).then(function(e){e=e[0];if(!e.success){var f;k.ERROR(j());throw(f=e.error)!=null?f:c(\"err\")(\"Failed to get latest signed prekey\")}var g=d(\"WASignalSignatures\").deserializeSignedPreKey(e.value);if(g==null){k.ERROR(i());throw c(\"err\")(\"Failed to deserialize signed prekey\")}f=b!=null?d(\"MAWDexieTable\").dexieResolve(b):d(\"MAWDbMetaTxns\").maybeGetLastPrekeyGenerationId(a);return f.then(function(b){if(b==null){k.ERROR(h());throw c(\"err\")(\"No last prekey generation id\")}return d(\"MAWDbPrekeyTxns\").getPrekeysForGeneration(a,b).then(function(a){return{preKeys:a,signedPreKey:g}})})})}});g.loadPreKeys=b}),98);\n__d(\"MAWLoadSignedPreKeyApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({signedPrekey:d(\"MAWTransactionMode\").READONLY},\"loadSignedPreKey\",function(a){return function(b){return a.signedPrekey.get(b).then(function(a){return a==null?void 0:a.encoded})}});g.loadSignedPreKey=a}),98);\n__d(\"MAWSaveOneTimePreKeyApi\",[\"MAWDbMetaTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"SignalDbTypes\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READWRITE,prekey:d(\"MAWTransactionMode\").READWRITE},\"saveOneTimePreKey\",function(a){return function(b){return d(\"MAWDbMetaTxns\").maybeGetLastPrekeyId(a).then(function(c){return c==null?d(\"WAResultOrError\").makeError(\"missing_last_prekey\"):d(\"MAWDexieTable\").dexieAll([a.prekey.put(babelHelpers[\"extends\"]({},b,{isDeleted:!1})),a.meta.put({key:d(\"SignalDbTypes\").MetaKeysEnum.lastPrekeyId,value:{lastPrekeyId:b.keyId}})]).then(function(){return d(\"WAResultOrError\").makeResult()})})}});g.saveOneTimePreKey=a}),98);\n__d(\"MAWSavePreKeysGenerationApi\",[\"MAWDbMetaTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"SignalDbTypes\",\"WACryptoManager\",\"WAResultOrError\",\"WATimeUtils\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READWRITE,prekey:d(\"MAWTransactionMode\").READWRITE,prekeyGeneration:d(\"MAWTransactionMode\").READWRITE},\"savePreKeysGeneration\",function(a){return function(b){return d(\"MAWDbMetaTxns\").maybeGetLastPrekeyGenerationId(a).then(function(e){if(b.length===0)throw c(\"err\")(\"Keys provided to savePreKeysGeneration cannot be empty\");var f=d(\"WACryptoManager\").castToPreKeyGenerationId(((e=e)!=null?e:0)+1);e=b[0].keyId;var g=b[b.length-1].keyId,h=b.map(function(a){return babelHelpers[\"extends\"]({},a,{isDeleted:!1})});h=a.prekey.bulkPut(h);var i=a.meta.bulkPut([{key:d(\"SignalDbTypes\").MetaKeysEnum.lastPrekeyId,value:{lastPrekeyId:g}},{key:d(\"SignalDbTypes\").MetaKeysEnum.lastPrekeyGenerationId,value:{lastPrekeyGenerationId:f}}]);g=a.prekeyGeneration.put({createdTs:d(\"WATimeUtils\").unixTime(),endingId:g,generationId:f,startingId:e});return d(\"MAWDexieTable\").dexieAll([h,i,g]).then(function(){return d(\"WAResultOrError\").makeResult(f)})})}});g.savePreKeysGeneration=a}),98);\n__d(\"MAWSaveSignedPreKeyIfNewApi\",[\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"SignalDbTypes\",\"WASignalSignatures\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READWRITE,signedPrekey:d(\"MAWTransactionMode\").READWRITE},\"saveSignedPreKeyIfNew\",function(a){return function(b,c){return a.signedPrekey.get(b).then(function(e){if(e!=null){e=d(\"WASignalSignatures\").deserializeSignedPreKey(e.encoded);if(e!=null)return{key:e,type:\"duplicate\"}}e=a.signedPrekey.put({encoded:c,keyId:b});var f=a.meta.put({key:d(\"SignalDbTypes\").MetaKeysEnum.lastSignedPrekeyId,value:{lastSignedPrekeyId:b}});return d(\"MAWDexieTable\").dexieAll([e,f]).then(function(){return{type:\"success\"}})})}});g.saveSignedPreKeyIfNew=a}),98);\n__d(\"MAWGetUnreadMsgsApi\",[\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAJids\",\"WAMsgType\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"getUnreadMsgs\",function(a){return function(b,c,e){e===void 0&&(e=!1);return a.threads.get({jid:b}).then(function(f){if(f==null)return{type:\"missing\"};var g=f.lastReadMsgTs!=null?d(\"MAWDexieTable\").dexieResolve(d(\"WATimeUtils\").fromMillisTime(f.lastReadMsgTs)):d(\"MAWDbMsgTxns\").maybeGetMsg(a,f.lastReadMsg).then(function(a){return a==null?null:d(\"MAWDbMsg\").getSortOrderWithFallback(a)});return g.then(function(g){return g==null?{type:\"none\"}:d(\"MAWDexieTable\").dexieAll([d(\"MAWDbMsgTxns\").getMsgsNeedingRetroactiveReadReceiptsUpTo(a,f.chatId,g,c),d(\"MAWDbMsgTxns\").maybeGetMsg(a,f.lastReadMsgReceiptSent),d(\"MAWDbMsgTxns\").maybeGetMsg(a,f.oldestMsg)]).then(function(f){var k=f[0],l=f[1];f=f[2];var m=c-k.length,n=m>0&&(l==null||g>d(\"MAWDbMsg\").getSortOrderWithFallback(l)),o=h(k,b,e),p=l==null;l=(l=l)!=null?l:f;return l==null||!n?k.length===0?{type:\"none\"}:i(k,o,b,c,g):j(a,d(\"MAWDbMsg\").getSortOrderWithFallback(l),g,p,m,b,e).then(function(a){return i([].concat(k,a.nextMsgs),[].concat(o,a.unreadNextMsgs),b,c,g)})})})})}});function h(a,b,c){var e=[];a.forEach(function(a){var f=a.author,g=a.externalId,h=a.type;a=((a=(a=a.ephemeralSetting)==null?void 0:a.ephemeralExpirationInSec)!=null?a:0)>0;h=h!==d(\"WAMsgType\").MSG_TYPE.CIPHERTEXT&&h!==d(\"WAMsgType\").MSG_TYPE.UNAVAILABLE&&h!==d(\"WAMsgType\").MSG_TYPE.FUTUREPROOF;!d(\"WAJids\").isAuthorMe(f)&&!d(\"WAJids\").isAuthorSystem(f)&&h&&(!c||a)&&e.push({author:f,chat:b,externalId:g})});return e}function i(a,b,c,e,f){if(a.length===0||b.length===0)return{type:\"none\"};var g=d(\"MAWDbMsg\").getSortOrderWithFallback(a[a.length-1]),h=b[b.length-1];return{loadedUpTo:{author:h.author,chat:c,externalId:h.externalId},maybeMore:g<f&&a.length===e,type:\"found\",unreadMsgs:b}}function j(a,b,c,d,e,f,g){return a.messages.where([\"threadJid\",\"sortOrderMs\"]).between([f,b],[f,c],d,!0).limit(e).toArray().then(function(i){var j=h(i,f,g);return j.length===0?a.messages.where([\"threadJid\",\"sortOrderMs\"]).between([f,b],[f,c],d,!0).toArray().then(function(a){return{nextMsgs:a.slice(0,e),unreadNextMsgs:h(a,f,g).slice(0,e)}}):{nextMsgs:i,unreadNextMsgs:j}})}g.getUnreadMsgs=a}),98);\n__d(\"MAWGetUnreadMsgsApi__DONOTUSE\",[\"MAWDbMsgTxns\",\"MAWIndexedDb\",\"MAWMsgType\",\"MAWTransactionMode\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"getUnreadMsgs\",function(a){return function(b,c,e){e===void 0&&(e=!1);return a.threads.get({jid:b}).then(function(f){if(f==null)return{type:\"missing\"};var g=d(\"MAWDbMsgTxns\").maybeGetMsg(a,f.lastReadMsg);return g.then(function(g){if(f.lastReadMsg==null)return{type:\"none\"};var k=(g=g==null?void 0:g.msgId)!=null?g:f.lastReadMsg;return d(\"MAWDbMsgTxns\").getMsgsNeedingRetroactiveReadReceiptsUpTo__DONOTUSE(a,f.chatId,k).then(function(d){var g=f.lastReadMsgReceiptSent,l=f.oldestMsg,m=c-d.length,n=m>0&&(g==null||k>g),o=h(d,b,e);if(l==null||!n)return d.length===0?{type:\"none\"}:i(d,o,b,c,k);n=g==null;g=(g=g)!=null?g:l;return j(a,g,k,n,m,b,e).then(function(a){return i([].concat(d,a.nextMsgs),[].concat(o,a.unreadNextMsgs),b,c,k)})})})})}});function h(a,b,c){var e=[];a.forEach(function(a){var f=a.author,g=a.externalId,h=a.type;a=((a=(a=a.ephemeralSetting)==null?void 0:a.ephemeralExpirationInSec)!=null?a:0)>0;h=h!==d(\"MAWMsgType\").MSG_TYPE.CIPHERTEXT&&h!==d(\"MAWMsgType\").MSG_TYPE.UNAVAILABLE&&h!==d(\"MAWMsgType\").MSG_TYPE.FUTUREPROOF;!d(\"WAJids\").isAuthorMe(f)&&!d(\"WAJids\").isAuthorSystem(f)&&h&&(!c||a)&&e.push({author:f,chat:b,externalId:g})});return e}function i(a,b,c,d,e){if(a.length===0||b.length===0)return{type:\"none\"};var f=a[a.length-1],g=b[b.length-1];return{loadedUpTo:{author:g.author,chat:c,externalId:g.externalId},maybeMore:f.msgId!==e&&a.length===d,type:\"found\",unreadMsgs:b}}function j(a,b,c,d,e,f,g){return a.messages.where(\"msgId\").between(b,c,d,!0).limit(e).toArray().then(function(i){var j=h(i,f,g);return j.length===0?a.messages.where(\"msgId\").between(b,c,d,!0).toArray().then(function(a){return{nextMsgs:a.slice(0,e),unreadNextMsgs:h(a,f,g).slice(0,e)}}):{nextMsgs:i,unreadNextMsgs:j}})}g.getUnreadMsgs__DONOTUSE=a}),98);\n__d(\"MAWLoadReceiptApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAMsg\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({receipts:d(\"MAWTransactionMode\").READONLY},\"loadReceipt\",function(a){return function(b){var c=d(\"WAMsg\").craftWAMsgIdString(b);return a.receipts.get({waMsgId:c}).then(function(a){var c;return a==null?d(\"WAResultOrError\").makeError(\"missing-receipt\"):d(\"WAResultOrError\").makeResult({id:b,permittedIdentitiesPerDevice:(c=a.permittedIdentitiesPerDevice)!=null?c:new Map(),recipientDevices:a.recipientDevices,statusTsPerUser:a.statusTsPerUser})})}});g.loadReceipt=a}),98);\n__d(\"MAWMarkReadReceiptsSentUpToApi\",[\"MAWDbMsg\",\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWODSProxy\",\"MAWTransactionMode\",\"WAOdsEnums\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READWRITE,threads:d(\"MAWTransactionMode\").READWRITE},\"markReadReceiptsSentUpTo\",function(a){return function(b,c){i(\"success\");return d(\"MAWDexieTable\").dexieAll([a.threads.get({jid:b}),d(\"MAWDbMsgTxns\").maybeGetMsgByProtocolMsgId(a,c)]).then(function(b){var c=b[0],e=b[1];if(c==null){i(\"missingThread\");return{type:\"missing_thread\"}}else if(e==null){i(\"invalidMsg\");return{type:\"invalid_msg\"}}var f=d(\"MAWDbMsg\").getSortOrderWithFallback(e);return(d(\"MAWDbMsgTxns\").IS_SORT_ORDER_COMPARISON_ENABLED?d(\"MAWDbMsgTxns\").clearRetroactiveReadReceiptStatusFromMsgsUpTo(a,c.chatId,f):d(\"MAWDbMsgTxns\").clearRetroactiveReadReceiptStatusFromMsgsUpTo__DONOTUSE(a,c.chatId,e.msgId)).then(function(){if(e.thread!==c.chatId){i(\"invalidMsg\");return{type:\"invalid_msg\"}}var b=c.lastReadMsgReceiptSent;if(d(\"MAWDbMsgTxns\").IS_SORT_ORDER_COMPARISON_ENABLED&&b!=null)return a.messages.get({msgId:b}).then(function(b){if(b!=null&&f<d(\"MAWDbMsg\").getSortOrderWithFallback(b)){i(\"unchanged\");return{type:\"unchanged\"}}return h(a,c,e.msgId)});if(!d(\"MAWDbMsgTxns\").IS_SORT_ORDER_COMPARISON_ENABLED&&b!=null&&e.msgId<b){i(\"unchanged\");return{type:\"unchanged\"}}return h(a,c,e.msgId)})})}});function h(a,b,c){return a.threads.put(babelHelpers[\"extends\"]({},b,{lastReadMsgReceiptSent:c})).then(function(){i(\"updateLastReadMsgReceiptSent\");return{type:\"success\"}})}function i(a){d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.SEND_READ_RECEIPTS,key:a})}g.markReadReceiptsSentUpTo=a}),98);\n__d(\"MAWMarkThreadAsReadUpToApi\",[\"MAWDbMsgTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWMarkThreadAsReadTxns\",\"MAWTransactionMode\",\"WATimeUtils\",\"gkx\",\"qex\"],(function(a,b,c,d,e,f,g){\"use strict\";var h={folder:null,isReadReceiptExpectedToBeSent:!1,type:\"missing\"};a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READWRITE,threads:d(\"MAWTransactionMode\").READWRITE},\"markThreadAsReadUpTo\",function(a){return function(b,e){return a.threads.get({jid:b}).then(function(b){return b==null?h:i(a,b).then(function(e){var f=e.newestMsgId;e=e.newestMsgTs;if(f==null||e==null)return h;var g=c(\"gkx\")(\"23964\")||c(\"gkx\")(\"2916\");return d(\"MAWMarkThreadAsReadTxns\").markThreadAsReadUpToMsgSortOrderMs(a,b.jid,f,e,g).then(function(a){return babelHelpers[\"extends\"]({},a,{folder:b.folder})})})})}});function i(a,b){var e=c(\"qex\")._(\"867\");return e===!1?d(\"MAWDexieTable\").dexieResolve({newestMsgId:b.newestMsg,newestMsgTs:b.newestMsgTs}):d(\"MAWDbMsgTxns\").getThreadNewestMessageBySortOrder(a,b.jid).then(function(a){var b=a==null?void 0:a.msgId;a=(a==null?void 0:a.sortOrderMs)==null?null:d(\"WATimeUtils\").castToMillisTime(a.sortOrderMs);return{newestMsgId:b,newestMsgTs:a}})}g.markThreadAsReadUpTo=a}),98);\n__d(\"MAWSaveReceiptApi\",[\"MAWDbMsg\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAMsg\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeSignalTransactor({receipts:d(\"MAWTransactionMode\").READWRITE},\"saveReceipt\",function(a){return function(b){return a.receipts.put({msgId:d(\"MAWDbMsg\").stanzaIdToMsgId(b.id.externalId),permittedIdentitiesPerDevice:b.permittedIdentitiesPerDevice,recipientDevices:b.recipientDevices,statusTsPerUser:b.statusTsPerUser,waMsgId:d(\"WAMsg\").craftWAMsgIdString(b.id)}).then(function(){})}});g.saveReceipt=a}),98);\n__d(\"MAWTaskScheduleApi\",[\"MAWIndexedDb\",\"MAWReStoreTiming\",\"MAWRestoreDbState\",\"MAWTransactionMode\",\"Promise\",\"WALogger\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"setTaskScheduledTime \",\" \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getTaskScheduledTime \",\"\"]);j=function(){return a};return a}var k=new Map(),l=d(\"MAWRestoreDbState\").isUsingShim()?d(\"MAWReStoreTiming\").measureDuration(\"getTasksScheduledTime\",function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b){a=(yield a.table(\"e2ee_tasks\").get(b));return a==null?null:a.scheduledTime});return function(b,c){return a.apply(this,arguments)}}()):d(\"MAWIndexedDb\").makeSignalTransactor({tasks:d(\"MAWTransactionMode\").READONLY},\"getTasksScheduledTime\",function(a){return function(b){return a.tasks.get(b).then(function(a){return a==null?null:a.scheduledTime})}});f=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){d(\"WALogger\").DEV(j(),a);if(k.has(a))return(h||(h=b(\"Promise\"))).resolve(k.get(a));var c=(yield l(a));c!=null&&k.set(a,c);return c});return function(b){return a.apply(this,arguments)}}();var m=d(\"MAWIndexedDb\").makeSignalTransactor({tasks:d(\"MAWTransactionMode\").READWRITE},\"setTaskScheduledTime\",function(a){return function(b,c){d(\"WALogger\").DEV(i(),b,c);k.set(b,c);return a.tasks.put({scheduledTime:c,taskName:b}).then(function(){})}});function a(){return k}function c(a,b){k.set(a,b)}function e(){k.clear()}g.getTaskScheduledTime=f;g.setTaskScheduledTime=m;g.getTaskScheduleCache=a;g.setTaskScheduleCache=c;g.clearTaskScheduleCache=e}),98);\n__d(\"MAWSentBytesCacheApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";c=(a=d(\"MAWIndexedDb\")).makeSignalTransactor({sentBytesCache:(b=d(\"MAWTransactionMode\")).READWRITE},\"deleteSentBytes\",function(a){return function(b){return a.sentBytesCache.bulkDelete(b)}});e=a.makeSignalTransactor({sentBytesCache:b.READONLY},\"loadExpired\",function(a){return function(b){return a.sentBytesCache.where(\"ts\").belowOrEqual(b).toArray().then(function(a){return a.map(function(a){return a.waMsgId})})}});f=a.makeSignalTransactor({sentBytesCache:b.READONLY},\"loadSentBytes\",function(a){return function(b){return a.sentBytesCache.bulkGet(b).then(function(a){return a.filter(Boolean)})}});d=a.makeSignalTransactor({sentBytesCache:b.READWRITE},\"saveSentBytes\",function(a){return function(b){return a.sentBytesCache.put(b).then(function(){})}});a={deleteSentBytes:c,loadExpired:e,loadSentBytes:f,saveSentBytes:d};g.sentBytesCacheApi=a}),98);\n__d(\"MAWBulkSaveSignalDataApi\",[\"MAWDbIdentityTxns\",\"MAWDbPrekeyTxns\",\"MAWDbSenderKeySessionTxns\",\"MAWDbSessionTxns\",\"MAWDexieTable\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"SignalDbTypes\",\"WAArrayZip\",\"WACryptoManager\",\"WAJids\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";b=d(\"MAWIndexedDb\").makeSignalTransactor({contacts:(a=d(\"MAWTransactionMode\")).READWRITE,identity:a.READWRITE,prekey:a.READWRITE,senderKeySessions:a.READWRITE,session:a.READWRITE},\"bulkSaveSignalData\",function(a){return function(b){var c=b.dhashUpdate,e=b.icdcUpdate,f=b.identityRemove,g=b.identityUpdate,i=b.preKeyRemove,k=b.senderKeySessionUpdate,l=b.sessionRemove;b=b.sessionUpdate;b=b.map(function(a){var b=a.id;a=a.updated;return{id:b,session:d(\"WACryptoManager\").encodeSession(a)}});var m=[],n=[];k.forEach(function(a){var b=a.author,c=a.groupId;a=a.updated;var e=d(\"WAJids\").extractUserJid(b);b=d(\"WAJids\").extractDeviceId(b);var f=d(\"SignalDbTypes\").buildSenderKeySessionId(c,e,b);n.push({deviceId:b,groupJid:c,id:f,record:d(\"WACryptoManager\").encodeSenderKeySession(a),userJid:e})});return d(\"MAWDexieTable\").dexieAll([a.session.bulkDelete(l),a.identity.bulkDelete(f),j(a,e),d(\"MAWDbSessionTxns\").bulkSaveSessions(a,b),d(\"MAWDbSenderKeySessionTxns\").bulkPutSenderKeySessions(a,n),h(a,g,c),d(\"MAWDbPrekeyTxns\").bulkDeletePreKeys(a,i.map(function(a){a=a.id;return a}))]).then(function(){return d(\"WAResultOrError\").makeResult(m)})}});function h(a,b,c){if(b.length===0)return d(\"MAWDexieTable\").dexieResolve([]);b=b.map(function(a){var b=a.id;a=a.identity;return{deviceJid:b,identity:a,userJid:d(\"WAJids\").extractUserJid(b)}});return d(\"MAWDexieTable\").dexieAll([d(\"MAWDbIdentityTxns\").bulkPutIdentities(a,b),d(\"MAWDbIdentityTxns\").invalidateDhash(a,b.map(function(a){return a.userJid})).then(function(){return i(a,c)})]).then(function(){return[]})}function i(a,b){return b.length===0?d(\"MAWDexieTable\").dexieResolve():a.contacts.bulkGet(b.map(function(a){a=a.id;return a})).then(function(a){return d(\"WAArrayZip\").zip(b,a).map(function(a){var b=a[0].dhash;a=a[1];return a==null?null:babelHelpers[\"extends\"]({},a,{dhash:b})})}).then(function(b){return a.contacts.bulkPut(b.filter(Boolean))})}function j(a,b){return b.length===0?d(\"MAWDexieTable\").dexieResolve():a.contacts.bulkGet(b.map(function(a){a=a.id;return a})).then(function(a){return d(\"WAArrayZip\").zip(b,a).map(function(a){var b=a[0].icdc;a=a[1];return a==null?null:babelHelpers[\"extends\"]({},a,{icdcInfo:b})})}).then(function(b){return a.contacts.bulkPut(b.filter(Boolean))})}g.bulkSaveSignalData=b}),98);\n__d(\"MAWGetThreadInfoForDeletionApi\",[\"MAWDbMsgTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WALogger\",\"WATimeUtils\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\"\"]);h=function(){return a};return a}a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"getThreadInfoForDeletion\",function(a){return function(b){return a.threads.get(b).then(function(b){if(b==null){var e=\"Thread was null when getting thread for deletion\";d(\"WALogger\").ERROR(h(),e);throw c(\"err\")(e)}return d(\"MAWDbMsgTxns\").getThreadNewestMessageTsBySortOrder(a,b).then(function(a){return{chatJid:b.jid,newestMsgTs:(a=d(\"WATimeUtils\").castMillisTimeToUnixTime(a))!=null?a:void 0}})})}});g.getThreadInfoForDeletion=a}),98);\n__d(\"MAWGetThreadLastMessageAuthoritativeTsApi\",[\"MAWDbMsgTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"getThreadLastMessageAuthoritativeTs\",function(a){return function(b){return a.threads.get({authoritativeThreadKey:b}).then(function(b){if(b==null)return;return d(\"MAWDbMsgTxns\").getThreadNewestMessageByServerTs(a,b.chatId).then(function(a){if(a!=null&&a.serverTs!=null)return d(\"WATimeUtils\").castUnixTimeToMillisTime(a.serverTs)})})}});g.getThreadLastMessageAuthoritativeTs=a}),98);\n__d(\"MAWGetThreadLastMessageTsApi\",[\"MAWDbMsgTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"getThreadLastMessageTs\",function(a){return function(b){return a.threads.get({authoritativeThreadKey:b}).then(function(b){if(b==null)return;return d(\"MAWDbMsgTxns\").getThreadNewestMessageBySortOrder(a,b.jid).then(function(a){return a==null?null:d(\"WATimeUtils\").castUnixTimeToMillisTime((a=a.serverTs)!=null?a:d(\"WATimeUtils\").castToUnixTime(0))})})}});g.getThreadLastMessageTs=a}),98);\n__d(\"MAWGetThreadLastNumMessagesByServerTsApi\",[\"MAWDbMsgTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"getThreadLastNumMessagesByServerTs\",function(a){return function(b,c){return a.threads.get({authoritativeThreadKey:b}).then(function(b){return b==null?[]:d(\"MAWDbMsgTxns\").getThreadNewestNumMessagesByServerTs(a,b.chatId,c)})}});g.getThreadLastNumMessagesByServerTs=a}),98);\n__d(\"MAWGetThreadLastNumMessagesBySortOrderApi\",[\"MAWDbMsgTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"getThreadLastNumMessagesBySortOrder\",function(a){return function(b,c){return a.threads.get({authoritativeThreadKey:b}).then(function(b){return b==null?[]:d(\"MAWDbMsgTxns\").getThreadNewestNumMessagesBySortOrder(a,b.jid,c)})}});g.getThreadLastNumMessagesBySortOrder=a}),98);\n__d(\"MAWLoadRecentParticipantsApi\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"WAJids\"],(function(a,b,c,d,e,f,g){\"use strict\";a=d(\"MAWIndexedDb\").makeMsgrTransactor({threads:d(\"MAWTransactionMode\").READONLY},\"loadRecentParticipants\",function(a){return function(b,c){return a.threads.orderBy(\"threadOrder\").filter(function(a){return d(\"WAJids\").interpretAsGroupJid(a.jid)==null}).reverse().limit(b).toArray().then(function(a){var b=[];a.forEach(function(a){a=d(\"WAJids\").interpretAsUserJid(a.jid);a!=null&&a!==c&&b.push(a)});return new Set(b)})}});g.loadRecentParticipants=a}),98);\n__d(\"MAWLoadThreadParticipantsApi\",[\"MAWDbParticipantTxns\",\"MAWIndexedDb\",\"MAWTransactionMode\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAWLoadThreadParticipantsApi -- loadThreadParticipants -- there is no thread in db\"]);h=function(){return a};return a}a=d(\"MAWIndexedDb\").makeMsgrTransactor({participants:d(\"MAWTransactionMode\").READONLY,threads:d(\"MAWTransactionMode\").READONLY},\"loadThreadParticipants\",function(a){return function(b){return a.threads.get({jid:b}).then(function(b){if(b==null){d(\"WALogger\").ERROR(h());return[]}return d(\"MAWDbParticipantTxns\").getParticipantsInThread(a,b.jid).then(function(a){return a.map(function(a){return a.userJid})})})}});g.loadThreadParticipants=a}),98);\n__d(\"MAWEbRestoreQueue\",[\"MAWPersistedQueueApi\",\"WAGlobals\",\"WAPersistedQueue\",\"WAPromiseQueue\",\"WATagsLogger\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to write to ebRestoreQueue \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"EB Restore Queue is already initialized\"]);i=function(){return a};return a}var j=d(\"WATagsLogger\").TAGS([\"EbRestoreQueue\"]),k=null;function l(){return k==null?m():k}function m(){k!=null&&j.ERROR(i());var a=d(\"WAPersistedQueue\").initPersistedQueue(\"ebRestoreQueue\",d(\"MAWPersistedQueueApi\").dexieApiForPersistedQueue());k=a;return a}function a(a){if(!d(\"WAGlobals\").getConfig().useEbRestoreQueue())return;var b=l();a.forEach(function(a){void b.write(babelHelpers[\"extends\"]({failAcks:0},a))});b.flush()[\"catch\"](function(a){j.ERROR(h(),a)})}function c(){if(!d(\"WAGlobals\").getConfig().useEbUploadQueue())return;var a=l();a.subscribe(function(a){a.type===\"flush\"&&void o()})}var n=new(d(\"WAPromiseQueue\").PromiseQueue)();function o(){return n.enqueue(b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){}))}g.ebRestoreQueue=l;g.initEbRestoreQueue=m;g.putMsgsToEbRestore=a;g.listenForEbRestoreQueue=c;g.restoreEBMsgs=o}),98);\n__d(\"MAWEbUploadQueue\",[\"MAWDbMsgUtil\",\"MAWEBUploadTrackingUtils\",\"MAWGetMsgByProtocolIdApi\",\"MAWGlobals\",\"MAWSharedEbUploadEntity\",\"MAWSharedEbUploadQueue\",\"MAWUploadMessagesBackup\",\"Promise\",\"WAGlobals\",\"WAJids\",\"WAMsgMap\",\"WAPromiseQueue\",\"WAScheduleAfterOfflineResume\",\"WAShiftTimer\",\"WATimeUtils\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"upload failed: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth-web] upload queue query got \",\" messages\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[labyrinth-web] upload queue uploading \",\" messages\"]);k=function(){return a};return a}var l=new(d(\"WAShiftTimer\").ShiftTimer)(function(){void s(!0)}),m=15e3;function n(a){d(\"WAScheduleAfterOfflineResume\").scheduleAfterOfflineResume({code:function(){l.onOrAfter(a);return(h||(h=b(\"Promise\"))).resolve()},id:\"eb-upload-queue-scheduler\"})}function a(){if(!d(\"MAWGlobals\").getConfig().useEbUploadQueue())return;n(m);var a=d(\"MAWSharedEbUploadQueue\").ebUploadQueue();a.subscribe(function(a){a.type===\"flush\"&&void s(!1)})}var o=d(\"WATimeUtils\").MINUTE_MILLISECONDS*5;function p(a){return Math.min(o*Math.pow(2,a),d(\"WATimeUtils\").DAY_MILLISECONDS)}function q(a){return a.uploadStatus!==d(\"MAWSharedEbUploadEntity\").EbUploadStatus.NEEDS_BACKUP?a.failAcks+1:0}var r=new(d(\"WAPromiseQueue\").PromiseQueue)();function s(a){return r.enqueue(b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=d(\"MAWSharedEbUploadQueue\").ebUploadQueue(),b=(yield a.read());if(b.length===0){n(o);return}try{var c=b.filter(function(a){return a.uploadStatus===d(\"MAWSharedEbUploadEntity\").EbUploadStatus.NEEDS_BACKUP||(a.uploadStatus===d(\"MAWSharedEbUploadEntity\").EbUploadStatus.NEEDS_BACKUP_RETRY||a.uploadStatus===d(\"MAWSharedEbUploadEntity\").EbUploadStatus.UPLOADING)&&a.failTsMs+p(q(a))>d(\"WATimeUtils\").millisTime()});d(\"MAWSharedEbUploadQueue\").logger.LOG(k(),c.length);var e=new(d(\"WAMsgMap\").MsgMap)(c.map(function(a){var b=a.originalMsgProtocolId;if(b!=null){b={author:d(\"WAGlobals\").getMyUserJid()===b.author?d(\"WAJids\").AUTHOR_ME:b.author,chat:b.chat,externalId:b.externalId};return[b,a]}return[a.msgId,a]})),f=(yield d(\"MAWGetMsgByProtocolIdApi\").getMsgsByProtocolMsgIdsTxn(e.keys()));d(\"MAWSharedEbUploadQueue\").logger.LOG(j(),f.length);var g=new Map(),h=[];f.forEach(function(a){var b=d(\"MAWDbMsgUtil\").getProtocolMsgIdFromDbMsg(a);if(b==null)return;var c=e.get(b);if(c==null)return;var f=d(\"MAWEBUploadTrackingUtils\").genInstanceKeyForUploadQueue(b,q(c));g.set(b.externalId,f);c.uploadStatus===d(\"MAWSharedEbUploadEntity\").EbUploadStatus.NEEDS_BACKUP?d(\"MAWEBUploadTrackingUtils\").addPoint(f,\"upload_tracking_queue_pickup\"):d(\"MAWEBUploadTrackingUtils\").maybeStartTrackingForUploadQueue(b,\"uploadretry\",q(c),a.type);h.push(c)});yield a.ack(h.map(function(a){return a.queueId}).filter(Boolean),function(a){return babelHelpers[\"extends\"]({},a,{failAcks:q(a),uploadStatus:d(\"MAWSharedEbUploadEntity\").EbUploadStatus.UPLOADING})});c=c.flatMap(function(a){var b=a.backupActionType,c=a.msgId,d=a.originalMsgProtocolId,e=a.protobuf,f=a.queueId,g=a.senderId,h=a.serverTs;a=a.supplementalKey;return{backupActionType:b,msgId:c,originalMsgProtocolId:d,protobuf:e,queueId:f,senderId:g,serverTs:h,supplementalKey:a}});yield d(\"MAWUploadMessagesBackup\").uploadMessageFromUploadQueue(f,g,c)}catch(c){d(\"MAWSharedEbUploadQueue\").logger.ERROR(i(),c),yield a.failAck(b.map(function(a){return a.queueId}),function(a){return babelHelpers[\"extends\"]({},a,{failTsMs:d(\"WATimeUtils\").millisTime(),uploadStatus:d(\"MAWSharedEbUploadEntity\").EbUploadStatus.NEEDS_BACKUP_RETRY})})}finally{n(o)}}))}function c(a,b){return t.apply(this,arguments)}function t(){t=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,c){c=(yield d(\"MAWSharedEbUploadQueue\").ebUploadQueue().read());c=c.filter(function(b){return b.uploadStatus===d(\"MAWSharedEbUploadEntity\").EbUploadStatus.UPLOADING&&d(\"MAWEBUploadTrackingUtils\").genInstanceKeyForUploadQueue(b.msgId,b.failAcks)===a});if(c.length===0)return;yield d(\"MAWSharedEbUploadQueue\").ebUploadQueue().ack(c.map(function(a){return a.queueId}));return(h||(h=b(\"Promise\"))).resolve()});return t.apply(this,arguments)}g.listenForEbUploadQueueFlush=a;g.uploadEBMsgs=s;g.ackWithInstanceKey=c}),98);\n__d(\"MAWPreKeysCleaner\",[\"WACryptoManagerUtils\",\"WAGlobals\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=60*d(\"WATimeUtils\").DAY_SECONDS;function a(){return d(\"WAGlobals\").getWaOneQueue().enqueue(function(a){var b=a.cryptoManager;return d(\"WACryptoManagerUtils\").getPreKeyGenerationsTimestamps(b).then(function(a){a=i(a);if(a.length>0)return d(\"WACryptoManagerUtils\").deletePreKeyGenerations(a,b)})},{afterInit:!0,flush:!0,operationType:\"clear_expired_prekeys\"})}function i(a){var b=[];for(var c=0;c+2<a.length;++c)d(\"WATimeUtils\").happenedWithin(a[c+2].timestamp,h)||b.push(a[c].id);return b}g.EXPIRATION_SECONDS=h;g.clearExpiredPreKeys=a}),98);\n__d(\"WATaskScheduler\",[\"Promise\",\"WAErr\",\"WALogger\",\"WAPromiseBackoffs\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"startScheduler invoked\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Task \",\" failed, try again later: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Task \",\" will try again later\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Task \",\" complete, waiting \",\"\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Task \",\" complete, deactivating\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Firing task \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Scheduling task \",\" in \",\"ms\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Task \",\" deactivated\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Tried to start task \",\" before registering its implementation\"]);q=function(){return a};return a}var r=\"no_reschedule\",s=function(){function a(a){this.$1=!1,this.$2={},this.$3={},this.$4={},this.$5=new Map(),this.$6=a.scheduledTimeResolver}var c=a.prototype;c.$7=function(a){var c=this,e=this.$5.get(a);if(e==null){d(\"WALogger\").ERROR(q(),a).devConsole(\"start-task-without-impl\");return}this.$6.get(a).then(function(f){var g=f==null,i=!g&&f===d(\"WATimeUtils\").DEFAULT_UNIXTIME;if(i){d(\"WALogger\").LOG(p(),a);return}i=f==null?0:f*1e3-d(\"WATimeUtils\").unixTimeMs();i=Math.max(0,i);i=Math.min(i,~(1<<31));d(\"WALogger\").LOG(o(),a,i);c.$4[a]=setTimeout(function(){delete c.$4[a],d(\"WALogger\").LOG(n(),a),e(g).then(function(e){if(e===\"no_reschedule\")return new(h||(h=b(\"Promise\")))(function(){});var f;e===d(\"WATimeUtils\").DEFAULT_UNIXTIME?(d(\"WALogger\").LOG(m(),a),delete c.$3[a],f=d(\"WATimeUtils\").DEFAULT_UNIXTIME):e>=0?(d(\"WALogger\").LOG(l(),a,e),delete c.$3[a],f=d(\"WATimeUtils\").futureUnixTime(e)):(d(\"WALogger\").LOG(k(),a),f=c.$8(a));return c.$6.set(a,f)}).then(function(){c.$7(a),c.$2[a]&&(c.$2[a].forEach(function(a){return a()}),delete c.$2[a])})[\"catch\"](function(b){d(\"WALogger\").LOG(j(),a,b);return c.$6.set(a,c.$8(a)).then(function(){c.$7(a)})})},i)})};c.$8=function(a){this.$3[a]||(this.$3[a]=d(\"WAPromiseBackoffs\").createTimer({jitter:.1,max:d(\"WATimeUtils\").HOUR_SECONDS*1e3,algo:{type:\"fibonacci\",first:1e3,second:2e3}}));return d(\"WATimeUtils\").futureUnixTime(Math.round(this.$3[a]()\/1e3))};c.$9=function(a,b){this.$2[a]||(this.$2[a]=[]),this.$2[a].push(b)};c.awaitTaskPromise=function(a){var c=this;return new(h||(h=b(\"Promise\")))(function(b){c.$9(a,b)})};c.reschedule=function(a,b){this.$1?(this.$6.set(a,b),this.$4[a]!=null&&clearTimeout(this.$4[a]),this.$7(a)):this.$6.set(a,b)};c.registerTask=function(a,b){this.$1||(this.$1=!0),this.$5.set(a,b),this.$7(a)};c.getScheduledTime=function(a){return this.$6.get(a)};return a}(),t=null;function a(a){d(\"WALogger\").LOG(i()),t||(t=new s(a))}function e(a){var b=y(\"awaitTaskPromise\");return b.awaitTaskPromise(a)}function u(a,b){var c=y(\"reschedule\");c.reschedule(a,b)}function f(a){u(a,d(\"WATimeUtils\").unixTime())}function v(a){u(a,d(\"WATimeUtils\").DEFAULT_UNIXTIME)}function w(a){var b=y(\"getScheduledTime\");return b.getScheduledTime(a)}function x(a,b){var c=y(\"registerTask\");c.registerTask(a,b)}function y(a){if(t)return t;else throw c(\"WAErr\")(\"TaskScheduler::\"+a+\" called before startScheduler\")}g.DO_NOT_RESCHEDULE=r;g.startScheduler=a;g.awaitTaskPromise=e;g.reschedule=u;g.rescheduleNow=f;g.deactivate=v;g.getScheduledTime=w;g.registerTask=x}),98);\n__d(\"cleanupErroneousEphemeralSettingsS401595\",[\"MAWIndexedDb\",\"MAWTransactionMode\",\"Promise\",\"WATagsLogger\",\"WATimeUtils\",\"asyncToGeneratorRuntime\",\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Finished updating \",\" erroneous ephemeral messages.\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Updating \",\" msgs with messageExpirationTs > 0 and messageDeleteTs == messageExpirationTs\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Fetching all erroneous ephemeral msgs with messageExpirationTs > 0 and messageDeleteTs == messageExpirationTs\"]);k=function(){return a};return a}var l=d(\"WATagsLogger\").TAGS([\"CleanupErroneousEphemeralSettingsS401595\"]),m=d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READONLY},\"getAllErroneousEphemeralMsgsS401595\",function(a){return function(){l.LOG(k());return a.messages.where(\"messageExpirationTs\").above(d(\"WATimeUtils\").castToUnixTime(0)).filter(function(a){return a.messageExpirationTs!=null&&a.messageDeleteTs!=null&&a.messageExpirationTs===a.messageDeleteTs}).toArray()}}),n=function(a){if(a.length===0)return;var b=a.map(function(a){var b,c=a.ephemeralSetting;b=a==null?void 0:(b=a.ephemeralSetting)==null?void 0:b.ephemeralExpirationInSec;if(c==null||b==null)return a;c=d(\"WATimeUtils\").futureUnixTime(b,a.ts);return babelHelpers[\"extends\"]({},a,{messageExpirationTs:c})});l.LOG(j(),b.length);return d(\"MAWIndexedDb\").makeMsgrTransactor({messages:d(\"MAWTransactionMode\").READWRITE},\"tryUpdateEphemeralMsgsS401595\",function(a){return function(){return a.messages.bulkPut(b).then(function(){return b.length})}})()};a=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){if(!c(\"gkx\")(\"263\"))return(h||(h=b(\"Promise\"))).resolve();var a=(yield m());a=(yield n(a));l.LOG(i(),a)});return function(){return a.apply(this,arguments)}}();g.cleanupErroneousEphemeralSettingsS401595=a}),98);\n__d(\"MAWTaskDefinitions\",[\"MAWAbProps\",\"MAWDbTasks\",\"MAWDeleteOldLogsFromDisk\",\"MAWGlobals\",\"MAWJobDefinitions\",\"MAWLoggingSwitches\",\"MAWPreKeysCleaner\",\"MAWRotateCAT\",\"Promise\",\"WAJobOrchestratorTypes\",\"WALogger\",\"WASyncdDisabled\",\"WATagsLogger\",\"WATaskScheduler\",\"WATimeUtils\",\"asyncToGeneratorRuntime\",\"cleanupErroneousEphemeralSettingsS401595\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to reprocess revoked messages: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to reprocess revoked messages: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to notify \",\" contacts of device change\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Notified \",\" contacts of device change\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"requestAllSyncdMissingKeys skip first run\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncdSyncAllCollections skip first run\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"rotateCAT skip first run\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"DeleteExpiredPreKeys skip first run\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"RotateKeyTask skip first run\"]);r=function(){return a};return a}var s=27*(c=d(\"WATimeUtils\")).DAY_SECONDS,t=7*c.DAY_SECONDS,u=c.DAY_SECONDS\/2,v=c.HOUR_SECONDS*6,w=c.MINUTE_SECONDS*5,x=c.MINUTE_SECONDS*5,y=Object.keys(d(\"MAWDbTasks\").Tasks);function z(){return{scheduledTimeResolver:{get:function(a){return d(\"MAWGlobals\").getDbImpls().getTaskScheduledTime(a)},set:function(a,b){return d(\"MAWGlobals\").getDbImpls().setTaskScheduledTime(a,b)}}}}function a(a){d(\"WATaskScheduler\").startScheduler(z()),y.forEach(function(b){var c=A(b,a);d(\"WATaskScheduler\").registerTask(b,c)})}function A(a,c){switch(a){case\"rotateKey\":return function(a){a?(d(\"WALogger\").LOG(r()),a=(h||(h=b(\"Promise\"))).resolve()):a=c.then(function(){return d(\"MAWGlobals\").getJobManager().waitUntilCompletedNonPersisted(d(\"MAWJobDefinitions\").createStartJobInfo(\"rotateSignedPreKey\",{uniqueJob:!0}))});return a.then(function(){return s})};case\"syncAbProps\":return function(a){var b=!a;return c.then(function(){return d(\"MAWGlobals\").getJobManager().waitUntilCompletedNonPersisted(d(\"MAWJobDefinitions\").createStartJobInfo(\"syncAbProps\",{sendHash:b})).then(function(){return d(\"MAWAbProps\").getRefreshSecs()})})};case\"deleteExpiredKeys\":return function(a){a?(d(\"WALogger\").LOG(q()),a=(h||(h=b(\"Promise\"))).resolve()):a=d(\"MAWPreKeysCleaner\").clearExpiredPreKeys();return a.then(function(){return t})};case\"rotateCAT\":return function(a){a?(d(\"WALogger\").LOG(p()),a=(h||(h=b(\"Promise\"))).resolve()):a=d(\"MAWRotateCAT\").tryRotateCAT();return a.then(function(){return u})};case\"generatePrekeys\":return function(a){a?a=d(\"MAWGlobals\").getJobManager().waitUntilCompletedNonPersisted(d(\"MAWJobDefinitions\").createStartJobInfo(\"generateAndUploadPreKeys\",{reason:\"on start\",scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.UI_ACTION},uniqueJob:!0})):a=(h||(h=b(\"Promise\"))).resolve();return a.then(function(){return d(\"WATimeUtils\").DEFAULT_UNIXTIME})};case\"queryGroups\":return function(a){return(h||(h=b(\"Promise\"))).resolve().then(function(){return d(\"WATimeUtils\").DEFAULT_UNIXTIME})};case\"syncdSyncAllCollections\":return function(a){a||d(\"WASyncdDisabled\").isSyncdDisabled()?(d(\"WALogger\").LOG(o()),a=(h||(h=b(\"Promise\"))).resolve()):a=d(\"MAWGlobals\").getJobManager().waitUntilCompletedNonPersisted(d(\"MAWJobDefinitions\").jobSerializers.syncdSyncAllCollections({priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW}));return a.then(function(){return d(\"WATimeUtils\").DAY_SECONDS})};case\"requestAllSyncdMissingKeys\":return function(a){a||d(\"WASyncdDisabled\").isSyncdDisabled()?(d(\"WALogger\").LOG(n()),a=(h||(h=b(\"Promise\"))).resolve()):a=d(\"MAWGlobals\").getJobManager().waitUntilCompletedNonPersisted(d(\"MAWJobDefinitions\").jobSerializers.requestAllSyncdMissingKeys({priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW}));return a.then(function(){return v})};case\"notifyDeviceRegistration\":return function(a){if(!a)return(h||(h=b(\"Promise\"))).resolve(d(\"WATimeUtils\").DEFAULT_UNIXTIME);a=d(\"MAWGlobals\").getMyUserJid();return d(\"MAWGlobals\").getDbImpls().loadRecentParticipants(d(\"MAWGlobals\").getConfig().maxUsersForNotifyDeviceChange(),a).then(function(a){var b=d(\"WATagsLogger\").TAGS([\"notifyDeviceRegistration\"]);return d(\"MAWGlobals\").getJobManager().waitUntilCompletedNonPersisted(d(\"MAWJobDefinitions\").createStartJobInfo(\"notifyDeviceChange\",{uniqueJob:!0,users:a})).then(function(){b.LOG(m(),a.size)})[\"catch\"](function(c){b.LOG(l(),a.size),b.ERROR(k(),c)})}).then(function(){return d(\"WATimeUtils\").DEFAULT_UNIXTIME})};case\"cleanupExcessiveLogs\":return function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(!d(\"MAWLoggingSwitches\").removeLoggingFromBridge)return d(\"WATimeUtils\").DEFAULT_UNIXTIME;a?yield d(\"MAWDeleteOldLogsFromDisk\").deleteOldLogsOnStartup():yield d(\"MAWDeleteOldLogsFromDisk\").deleteOldLogs();return w});return function(b){return a.apply(this,arguments)}}();case\"reprocessRevokeStanzasS397680\":return function(a){return!a?(h||(h=b(\"Promise\"))).resolve(d(\"WATimeUtils\").DEFAULT_UNIXTIME):d(\"MAWGlobals\").getJobManager().waitUntilCompletedNonPersisted(d(\"MAWJobDefinitions\").createStartJobInfo(\"rerevokeMsgs\",{})).then(function(){})[\"catch\"](function(a){d(\"WATagsLogger\").TAGS([\"RevokeReprocessing\"]).ERROR(j(),a)}).then(function(){return d(\"WATimeUtils\").DEFAULT_UNIXTIME})};case\"cleanupErroneousEphemeralSettingsS401595\":return function(a){return!a?(h||(h=b(\"Promise\"))).resolve(d(\"WATimeUtils\").DEFAULT_UNIXTIME):d(\"cleanupErroneousEphemeralSettingsS401595\").cleanupErroneousEphemeralSettingsS401595().then(function(){return d(\"WATimeUtils\").DEFAULT_UNIXTIME})[\"catch\"](function(a){d(\"WATagsLogger\").TAGS([\"CleanupError\"]).ERROR(i(),a);return x})}}}g.ROTATE_SIGNED_PRE_KEY_TIMESPAN=s;g.DELETE_EXPIRED_KEYS_TIMESPAN=t;g.ROTATE_CAT_TIMESPAN=u;g.DO_NOT_RESCHEDULE=c.DEFAULT_UNIXTIME;g.SYNCD_SYNC_ALL_COLLECTIONS_TIMESPAN=c.DAY_SECONDS;g.SYNCD_REQUEST_ALL_MISSING_KEYS_TIMESPAN=v;g.CLEANUP_EXCESSIVE_LOGS=w;g.RETRY_CLEANUP=x;g.TASK_TYPES=y;g.getSchedulerOptions=z;g.registerTasks=a;g.getTaskExecution=A}),98);\n__d(\"MAWTransactionsConfig\",[],(function(a,b,c,d,e,f){\"use strict\";a={setContacts:function(){return!0}};f.transactions=a}),66);\n__d(\"MAWWebWorkerLogger\",[\"MAWAbProps\",\"MAWBridge\",\"MAWConsoleLogger\",\"MAWKillSwitches\",\"MAWLeakDetection\",\"MAWLoggingSwitches\",\"MAWSaveLogToDisk\",\"WAJids\",\"WATagsLogger\",\"asyncToGeneratorRuntime\",\"err\",\"fb-error\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=2;function a(){d(\"WATagsLogger\").initializeWaLogger(i)}var i={debug:function(a,b,c){d(\"MAWConsoleLogger\").logToConsole(\"log\",a,b,c)},devConsole:function(a,b,c,e){for(var f=arguments.length,g=new Array(f>4?f-4:0),h=4;h<f;h++)g[h-4]=arguments[h];switch(a){case\"DEV\":d(\"MAWConsoleLogger\").logToConsole.apply(void 0,[\"log\",b,c,e].concat(g));break;case\"DEV_XMPP\":d(\"MAWConsoleLogger\").logToConsole.apply(void 0,[\"log\",b,c,e].concat(g));break;case\"LOG\":d(\"MAWConsoleLogger\").logToConsole.apply(void 0,[\"info\",b,c,e].concat(g));break;case\"WARN\":d(\"MAWConsoleLogger\").logToConsole.apply(void 0,[\"warn\",b,c,e].concat(g));break;case\"ERROR\":d(\"MAWConsoleLogger\").logToConsole.apply(void 0,[\"error\",b,c,e].concat(g));break;case\"CATCHING\":d(\"MAWConsoleLogger\").logToConsole.apply(void 0,[\"error\",b,c,e].concat(g));break}},error:function(a,b,e){a=d(\"MAWLeakDetection\").maybeReplaceVaultedString(a);e?m(a,b,e):m(\"webworker\",b,c(\"err\")(d(\"WAJids\").maybeSanitizeLogLineText(a)));d(\"MAWConsoleLogger\").logToConsole(\"error\",a,b)},info:function(a,b){k(\"log\",a,b),d(\"MAWConsoleLogger\").logToConsole(\"info\",a,b)},logRestricted:function(a,b){k(\"logRestricted\",a,b),d(\"MAWConsoleLogger\").logToConsole(\"log\",a,b)},warn:function(a,b){k(\"warn\",a,b),d(\"MAWConsoleLogger\").logToConsole(\"warn\",a,b)}};function j(){try{return d(\"MAWAbProps\").getAbProp(\"msgrw_logger_entries\")}catch(a){return d(\"MAWAbProps\").getAbDefault(\"msgrw_logger_entries\")}}function k(a,b,c){if(d(\"MAWLoggingSwitches\").removeLoggingFromBridge){d(\"MAWSaveLogToDisk\").saveLogEntry(\"worker\",d(\"MAWSaveLogToDisk\").formatLog({date:Date.now(),logLevel:a,logString:b,tags:c}));return}d(\"MAWKillSwitches\").isServerLoggingDisabled||d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"log\",{logLevel:a,logString:b,tags:c},!0)}function e(){return l.apply(this,arguments)}function l(){l=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){yield d(\"MAWSaveLogToDisk\").forceCachedLogEntryPersist()});return l.apply(this,arguments)}function m(a,b,e){var f=0;if(e.taalOpcodes!=null){var g;(g=e.taalOpcodes)==null?void 0:g.forEach(function(a){a===c(\"fb-error\").TAALOpcode.PREVIOUS_FRAME&&f++})}else f=h;d(\"MAWLoggingSwitches\").removeLoggingFromBridge&&d(\"MAWSaveLogToDisk\").saveLogEntry(\"worker\",d(\"MAWSaveLogToDisk\").formatErrorForLogging(a,b,e,f,j(),e.stack));d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"logError\",{entriesToReport:j(),framesToPop:f,logString:a,message:e.message,stack:e.stack,tags:b},!0)}g.setupWebWorkerWaLogger=a;g.flushLogs=e}),98);\n__d(\"MAWSaveRTCCallXMAMsg\",[\"MAWAckLevel\",\"MAWBridgeXMA\",\"MAWDexieTable\",\"MAWExternalId\",\"MAWFrontendMediaUtils\",\"MAWGlobals\",\"MAWIndexedDb\",\"MAWMediaManagementTxns\",\"MAWMediaUtils\",\"MAWMsgUtil\",\"MAWOptimisticUploadManager\",\"MAWSendMediaMsg\",\"MAWStartMediaUploaQplFlow\",\"MAWTransactionMode\",\"MAWWriteLocalXMAMsgApi\",\"MAWXMAManagementTxns\",\"Promise\",\"WAArmadilloXMA.pb\",\"WALogger\",\"WAMediaUtils\",\"WAUploadMedia\",\"asyncToGeneratorRuntime\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to upload media xma\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAWSaveRTCCallXMAMsg - Missing thread with jid: \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAWSaveRTCCallXMAMsg - Message missing in db\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to send xma - missing thread\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"MAWSaveRTCCallXMAMsg - XMAMessageType is null\"]);m=function(){return a};return a}a=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){var b=a.args,c=a.author,e=a.chatJid,f=a.faviconFile,g=a.ts;a=a.xmaArgs;var h=b.xmaMessageType;if(h==null){d(\"WALogger\").ERROR(m());return}g=(yield d(\"MAWWriteLocalXMAMsgApi\").writeLocalXMAMsg(d(\"MAWExternalId\").generateExternalId(),e,g,b,c));if(g.type===\"missing_thread\"){d(\"WALogger\").ERROR(l());return}b=(yield d(\"MAWGlobals\").getDbImpls().getMsgIdByProtocolMsgId(g.protocolMsgId));if(!b.success){d(\"WALogger\").ERROR(k());return}c=b.value;b=(yield d(\"MAWGlobals\").getDbImpls().getThreadIdByJid(e));if(b==null){d(\"WALogger\").ERROR(j(),e);return}a=babelHelpers[\"extends\"]({},a,{overlayIconGlyph:(a=a.overlayIconGlyph)!=null?a:d(\"WAArmadilloXMA.pb\").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE});f=(yield q(f,c,h,b,g.protocolMsgId,a));h=d(\"MAWOptimisticUploadManager\").getOptimisticUploadManager();b=(yield p(f,e,g.protocolMsgId,h));if(!(b==null?void 0:b.uploadResult.success)){d(\"WALogger\").ERROR(i());return d(\"MAWMsgUtil\").updateSystemAckWithTxn(c,d(\"MAWAckLevel\").ACK.failed)}a=b.uploadResult;f=b.media;yield d(\"MAWSendMediaMsg\").maybePersistMediaEntry(f.plaintextHash,c,e,g.protocolMsgId.externalId,a==null?void 0:(c=a.value)==null?void 0:c.objectId,d(\"MAWMediaUtils\").getServerMediaTypeFromMediaType(f.mediaType,\"xma-media\"));h[\"delete\"](b.media.plaintextHash)});return function(b){return a.apply(this,arguments)}}();function n(a,b,c,d,e,f){return o.apply(this,arguments)}function o(){o=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,c,e,f,g){g=g.get(a);g=g==null?void 0:g.optimisticUploadPromise;if(g!=null)return g;g=(yield d(\"MAWStartMediaUploaQplFlow\").startMediaUploaQplFlow({chatJid:b,fileSize:f,serverMediaType:e,uploadEntry:\"saveRTCCallXMAMsg\"}));return d(\"WAUploadMedia\").uploadMedia({chatJid:b,hash:a,mediaTypeDetails:{mediaType:e,type:\"regular\"},protocolMsgId:c,size:f,uploadMediaFlow:g})});return o.apply(this,arguments)}function p(a,c,e,f){if(a==null)return(h||(h=b(\"Promise\"))).resolve();var g=d(\"MAWMediaUtils\").getServerMediaTypeFromMediaType(a.mediaType,\"xma-media\");return n(a.plaintextHash,c,e,g,a.size,f).then(function(b){return{media:a,uploadResult:b}})}function q(a,b,c,d,e,f){return r.apply(this,arguments)}function r(){r=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,c,d,e,f){a=(yield s(a));return u(b,a,c,d,e,f)});return r.apply(this,arguments)}function s(a){return t.apply(this,arguments)}function t(){t=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a){if(a==null)return a;var b=a.file,e=d(\"MAWFrontendMediaUtils\").getMediaTypeAndServerMediaTypeFromBlob(b.type),f=e.mediaType;e=e.serverMediaType;var g=(yield d(\"MAWMediaUtils\").genBlobHashes(b)),h=g[0];g=g[1];if(f!==\"Image\")throw c(\"err\")(\"Expected Image when sending XMA share\");var i=(yield d(\"WAMediaUtils\").blobToArrayBuffer(b));return{blobArrayBuffer:i,file:b,hashedPlaintextHash:g,mediaInfo:{validatedAudioInfo:null,validatedDocumentFileInfo:null,validatedImageInfo:{height:a.height,width:a.width},validatedVideoInfo:null},mediaType:f,plaintextHash:h,serverMediaType:e}});return t.apply(this,arguments)}function u(a,b,c,e,f,g){var h;return d(\"MAWIndexedDb\").makeMsgrTransactor({chunk:(h=d(\"MAWTransactionMode\")).READWRITE,media:h.READWRITE,mediaBackup:h.READWRITE,messages:h.READWRITE,unrenderedMessages:h.READWRITE,xma:h.READWRITE},\"saveRTCXMAMediaAndMetadata\",function(h){return function(){var i=new Map();if(b!=null){var j=i.get(b.plaintextHash);j==null&&i.set(b.plaintextHash,d(\"MAWMediaManagementTxns\").attachHashAndSaveMedia(h,f,b.blobArrayBuffer,b.plaintextHash,void 0,void 0,b.mediaType,b.mediaInfo,b.file,!1))}j=Array.from(i.values());return d(\"MAWDexieTable\").dexieAll(j).then(function(i){i=i.reduce(function(a,b){return a.set(b.plaintextHash,b)},new Map());var j=b!=null?i.get(b.plaintextHash):void 0;return d(\"MAWXMAManagementTxns\").saveXMA(h,void 0,void 0,j==null?void 0:j.mediaId,c,a,void 0,f,g).then(function(a){d(\"MAWIndexedDb\").afterTransaction({tag:\"NewXMA\",value:d(\"MAWBridgeXMA\").createBridgeXMA(e,j,a)});return j})})}})()}g.saveRTCCallXMAMsg=a}),98);\n__d(\"WARemoveCurrentDevice\",[\"WAGetCurrentUserDeviceInfoApi\",\"WAGlobals\",\"WAJobDefinitions\",\"WAJobOrchestratorTypes\",\"WAJobs\",\"WALogger\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"There is no stored user info, it was already deleted or this job was called twice, possibly from another tab\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"removeCurrentDevice called for current device\"]);i=function(){return a};return a}a=function(){var a,c,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:d(\"WALogger\").DEV(i());g.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGetCurrentUserDeviceInfoApi\").getCurrentUserDeviceInfo());case 3:a=g.sent;if(!(a==null)){g.next=7;break}d(\"WALogger\").WARN(h());return g.abrupt(\"return\",!0);case 7:c=a.deviceId,e=a.identityKey;g.next=10;return b(\"regeneratorRuntime\").awrap(d(\"WAJobs\").getJobManager().waitUntilCompleted(d(\"WAJobDefinitions\").createStartJobInfo(\"removeDevice\",{deviceId:c,identity:e,scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH}})));case 10:f=g.sent;if(!f){g.next=15;break}g.next=14;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getDbImpls().clearSignalAndTempStores());case 14:return g.abrupt(\"return\",!0);case 15:return g.abrupt(\"return\",!1);case 16:case\"end\":return g.stop()}},null,this)};g.removeCurrentDevice=a}),98);\n__d(\"MAWCommonLowLevelApiBridgeHandlers\",[\"MAWArchiveThreadApi\",\"MAWBackfillThreadsForOccamadilloApi\",\"MAWBulkCreateThread\",\"MAWChangeSecurityAlertSettingApi\",\"MAWChangeSecurityAlertSettingForSelfApi\",\"MAWCheckIfShowOpenMessageHistoryApi\",\"MAWClearSignalAndTempStores\",\"MAWCompareThreadParticipantsApi\",\"MAWCompleteUndoThreadCutoverApi\",\"MAWCreateThreadApi\",\"MAWCreateThreadThroughMI\",\"MAWDeleteThreadApi\",\"MAWDyiGetThreadList\",\"MAWEbUploadQueue\",\"MAWEncryptedBackupsStateManager\",\"MAWEphemeralSettingsCache\",\"MAWFTSDataSync\",\"MAWFetchThreadMessageCountApi\",\"MAWGetAllMessageIdsAndRangesForThreadApi\",\"MAWGetAllThreadsAsJsonApi\",\"MAWGetBlobDataUrlByMediaIdApi\",\"MAWGetBlobDataUrlByXMAIdApi\",\"MAWGetDeviceChangeAlertsByOptionsApi\",\"MAWGetEphemeralSettingsApi\",\"MAWGetGroupSuperAdminApi\",\"MAWGetIdentityKeys\",\"MAWGetLatestThreadIdsApi\",\"MAWGetMaybeNextNonAdminMsgSortOrderMsApi\",\"MAWGetProtocolMsgIdByMediaMsgId\",\"MAWGetProtocolMsgIdByMsgId\",\"MAWGetSecureThreadTotalCount\",\"MAWGetSecurityAlertSettingApi\",\"MAWGetSecurityAlertSettingForSelfAndContactApi\",\"MAWGetThreadDevicesInfoApi\",\"MAWGetThreadJidByChatId\",\"MAWGetThreadLastMessageAuthoritativeTsApi\",\"MAWGetThreadLastMessageTsApi\",\"MAWGetThreadLastNumMessagesByServerTsApi\",\"MAWGetThreadLastNumMessagesBySortOrderApi\",\"MAWGetThreadParticipantFBIDsApi\",\"MAWGetThreadsInfoApi\",\"MAWGetThumbnailBlobDataUrlByMediaIdApi\",\"MAWGetWAIDevices\",\"MAWGetWorkerHeartbeatApi\",\"MAWGetWorkerStatusApi\",\"MAWGlobals\",\"MAWInsertAdminMessageInCutoverThreadsApi\",\"MAWLoadMediaApi\",\"MAWLoadMsgsApi\",\"MAWLoadThreadsTxns\",\"MAWMarkBackupAsCompleted\",\"MAWMarkThreadAsUnreadApi\",\"MAWOptimisticUploadMedia\",\"MAWPreEstablishSessionApi\",\"MAWPredistributeSKDMApi\",\"MAWRestoreMsgsTxns\",\"MAWSaveRTCCallXMAMsg\",\"MAWSendChatStateFromComposerApi\",\"MAWSetEphemeralSettingsFromFrontendApi\",\"MAWSetEphemeralSettingsOfPeerFromMIApi\",\"MAWUnarchiveThreadApi\",\"MAWUpdateDeviceChangeAlertsApi\",\"MAWUpdateLSThreadFromGroupInfoApi\",\"MAWUpdateThreadMuteSettingApi\",\"MAWWriteAdminMessageForDualThreadCutoverApi\",\"MAWWriteAdminMessageForEphemeralSettingsChange\",\"MAWWriteAdminMessageForThreadHotlikeCustomizationApi\",\"MAWWriteAdminMessageForThreadNicknameCustomizationApi\",\"MAWWriteAdminMessageForThreadPhotoCustomizationApi\",\"MAWWriteAdminMessageForThreadThemeCustomizationApi\",\"MAWWriteLSDBToPersistedEBTables\",\"Promise\",\"WAGetCurrentUserDeviceInfoApi\",\"WALogger\",\"WARemoveCurrentDevice\",\"cr:7062\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[messenger_e2ee_web] Handler not implemented and should not be used outside Instamadillo\"]);i=function(){return a};return a}a={ackWithInstanceKey:function(a){return d(\"MAWEbUploadQueue\").ackWithInstanceKey(a.instanceKey,a.success)},archiveThread:function(a){return d(\"MAWArchiveThreadApi\").archiveThread(a.threadId)},backfillThreadsForOccamadillo:function(){return d(\"MAWBackfillThreadsForOccamadilloApi\").backfillThreadsForOccamadillo()},bulkCreateThread:function(a){return d(\"MAWBulkCreateThread\").bulkCreateThread(a)},changeSecurityAlertSetting:function(a){return d(\"MAWChangeSecurityAlertSettingApi\").changeSecurityAlertSetting(a.isEnableAlert)},changeSecurityAlertSettingForSelf:function(a){return d(\"MAWChangeSecurityAlertSettingForSelfApi\").changeSecurityAlertSettingForSelf(a.isEnableSelfAlert)},checkForDecryptionFailuresToPointRestore:function(){return d(\"MAWRestoreMsgsTxns\").checkForDecryptionFailuresToPointRestore()},checkIfGroupParticipant:function(a){return d(\"MAWLoadThreadsTxns\").checkIfGroupParticipant(a)},checkIfShowOpenMessageHistory:function(a){return d(\"MAWCheckIfShowOpenMessageHistoryApi\").checkIfShowOpenMessageHistory(a.chatId,a.timestampMs)},clearSignalAndTempStores:function(a){return d(\"MAWClearSignalAndTempStores\").clearSignalAndTempStores()},compareThreadParticipants:function(a){return d(\"MAWCompareThreadParticipantsApi\").compareThreadParticipants(a.participantIds,a.existingGroup)},completeUndoThreadCutover:function(a){return d(\"MAWCompleteUndoThreadCutoverApi\").completeUndoThreadCutover(a)},createThread:function(a){return d(\"MAWCreateThreadApi\").createThread(a.contactFbid,a.threadKey,a.description)},createThreadThroughMI:function(a){return d(\"MAWCreateThreadThroughMI\").createThreadThroughMI(a)},deleteThread:function(a){return d(\"MAWDeleteThreadApi\").deleteThread(a.threadId)},dyiGetThreadList:function(a){return d(\"MAWDyiGetThreadList\").dyiGetThreadList(a.threadJids,a.qplInstanceKeyE2E)},fetchArmadilloThreadMessageCount:function(a){return d(\"MAWFetchThreadMessageCountApi\").fetchArmadilloThreadMessageCount(a.threadId)},getAllMessageIdsAndRangesForThread:function(a){return d(\"MAWGetAllMessageIdsAndRangesForThreadApi\").getAllMessageIdsAndRangesForThread(a.chatJid,a.limit)},getAllThreadsAsJson:function(){return d(\"MAWGetAllThreadsAsJsonApi\").getAllThreadsAsJson()},getBlobDataUrlByMediaId:function(a){return d(\"MAWGetBlobDataUrlByMediaIdApi\").getBlobDataUrlByMediaId(a.mediaId,a.description)},getBlobDataUrlByXMAId:function(a){return d(\"MAWGetBlobDataUrlByXMAIdApi\").getBlobDataUrlByXMAId(a.xmaId,a.infoType)},getCurrentUserDeviceInfo:function(){return d(\"WAGetCurrentUserDeviceInfoApi\").getCurrentUserDeviceInfo()},getDeviceChangeAlertsByOptions:function(a){return d(\"MAWGetDeviceChangeAlertsByOptionsApi\").getDeviceChangeAlertsByOptions(a.options)},getEphemeralSettings:function(a){return d(\"MAWGetEphemeralSettingsApi\").getEphemeralSettings(a.threadId)},getGroupSuperAdmin:function(a){return d(\"MAWGetGroupSuperAdminApi\").getGroupSuperAdmin(a.threadId)},getIdentityKeys:function(a){return d(\"MAWGetIdentityKeys\").getIdentityKeys()},getLatestThreadIds:function(a){return d(\"MAWGetLatestThreadIdsApi\").getLatestThreadIds(a.numThreads)},getMaybeNextNonAdminMsgSortOrderMs:function(a){return d(\"MAWGetMaybeNextNonAdminMsgSortOrderMsApi\").getMaybeNextNonAdminMsgSortOrderMs(a.threadId,a.mayBeAdminMsgId)},getProtocolMsgIdByMediaMsgId:function(a){return d(\"MAWGetProtocolMsgIdByMediaMsgId\").getProtocolMsgIdByMediaMsgId(a.msgId)},getProtocolMsgIdByMsgId:function(a){return d(\"MAWGetProtocolMsgIdByMsgId\").getProtocolMsgIdByMsgId(a.msgId)},getSecureThreadTotalCount:function(a){return d(\"MAWGetSecureThreadTotalCount\").getSecureThreadTotalCount()},getSecurityAlertSetting:function(a){return d(\"MAWGetSecurityAlertSettingApi\").getSecurityAlertSetting()},getSecurityAlertSettingForSelfAndContact:function(a){return d(\"MAWGetSecurityAlertSettingForSelfAndContactApi\").getSecurityAlertSettingForSelfAndContact()},getThreadDevicesInfo:function(a){return d(\"MAWGetThreadDevicesInfoApi\").getThreadDevicesInfo(a)},getThreadIdByChatJid:function(a){return d(\"MAWGetThreadsInfoApi\").getThreadIdByJid(a.chatJid)},getThreadIdByDeduplicationKey:function(a){return d(\"MAWGetThreadsInfoApi\").getThreadIdByDeduplicationKey(a.deduplicationKey)},getThreadJidByChatId:function(a){return d(\"MAWGetThreadJidByChatId\").getThreadJidByChatId(a.threadId)},getThreadLastMessageAuthoritativeTs:function(a){return d(\"MAWGetThreadLastMessageAuthoritativeTsApi\").getThreadLastMessageAuthoritativeTs(a.threadKey)},getThreadLastMessageTs:function(a){return d(\"MAWGetThreadLastMessageTsApi\").getThreadLastMessageTs(a.threadKey)},getThreadLastNumMessagesByServerTs:function(a){return d(\"MAWGetThreadLastNumMessagesByServerTsApi\").getThreadLastNumMessagesByServerTs(a.threadKey,a.numMsgs)},getThreadLastNumMessagesBySortOrder:function(a){return d(\"MAWGetThreadLastNumMessagesBySortOrderApi\").getThreadLastNumMessagesBySortOrder(a.threadKey,a.numMsgs)},getThreadParticipantFBIDs:function(a){return d(\"MAWGetThreadParticipantFBIDsApi\").getThreadParticipantFBIDs(a)},getThumbnailBlobDataUrlByMediaId:function(a){return d(\"MAWGetThumbnailBlobDataUrlByMediaIdApi\").getThumbnailBlobDataUrlByMediaId(a.mediaId)},getWAIDevices:function(a){return d(\"MAWGetWAIDevices\").getWAIDevices(a)},getWorkerHeartbeat:function(){return d(\"MAWGetWorkerHeartbeatApi\").getWorkerHeartbeat()},getWorkerStatus:function(){return d(\"MAWGetWorkerStatusApi\").getWorkerStatus()},handleInstamadilloDYIRangeQueryRestore:function(){d(\"WALogger\").WARN(i());return(h||(h=b(\"Promise\"))).resolve()},insertAdminMessageInCutoverThreads:function(a){return d(\"MAWInsertAdminMessageInCutoverThreadsApi\").insertAdminMessageInCutoverThreads(a)},loadMoreMedia:function(a){return d(\"MAWLoadMediaApi\").loadMoreMedia(a)},loadMoreMsgs:function(a){return d(\"MAWLoadMsgsApi\").loadMsgs(a.threadId,a.chatJid,a.offsetMsgId,a.numMsgs,a.direction)},markBackupAsCompleted:function(a){return d(\"MAWMarkBackupAsCompleted\").markBackupAsCompleted(a)},markThreadAsUnread:function(a){return d(\"MAWMarkThreadAsUnreadApi\").markThreadAsUnread(a.threadId)},maw_load_msgs:function(a){return d(\"MAWLoadMsgsApi\").loadMsgsFromTs(a.chatJid,a.numMsgs,a.direction,a.sortOrderMs,a.includeOriginalMsg,a.msgId,a.config)},optimisticUploadMedia:function(a){return d(\"MAWOptimisticUploadMedia\").optimisticUploadMedia(a)},predistributeSKDM:function(a){return d(\"MAWPredistributeSKDMApi\").predistributeSKDM(a.groupJid,a.userJids)},preEstablishSession:function(a){return d(\"MAWPreEstablishSessionApi\").preEstablishSession(a.groupJid,a.userJids)},relaySubscribe:function(a){return b(\"cr:7062\")==null?void 0:b(\"cr:7062\").relaySubscribe(a)},relayUnsubscribe:function(a){return b(\"cr:7062\")==null?void 0:b(\"cr:7062\").relayUnsubscribe(a)},removeCurrentDevice:function(){return d(\"WARemoveCurrentDevice\").removeCurrentDevice()},saveActiveThread:function(a){return d(\"MAWGlobals\").setMAWActiveChatThreadKey(a.threadKey)},saveRTCCallXMAMsg:function(a){return d(\"MAWSaveRTCCallXMAMsg\").saveRTCCallXMAMsg(a)},search:function(a){return d(\"MAWFTSDataSync\").search(a)},sendChatStateFromComposer:function(a){return d(\"MAWSendChatStateFromComposerApi\").sendChatStateFromComposer(a)},setEncryptedBackupsState:function(a){return d(\"MAWEncryptedBackupsStateManager\").setEncryptedBackupsState(a.newState)},setEphemeralSettingCache:function(a){return d(\"MAWEphemeralSettingsCache\").setEphemeralSettingCache(a.jid,a.settings)},setEphemeralSettingsFromFrontend:function(a){return d(\"MAWSetEphemeralSettingsFromFrontendApi\").setEphemeralSettingsFromFrontend(a)},setEphemeralSettingsFromMI:function(a){return d(\"MAWSetEphemeralSettingsOfPeerFromMIApi\").setEphemeralSettingsFromMI(a)},unarchiveThread:function(a){return d(\"MAWUnarchiveThreadApi\").unarchiveThread(a.threadId)},updateDeviceChangeAlerts:function(a){return d(\"MAWUpdateDeviceChangeAlertsApi\").updateDeviceChangeAlerts(a.alert)},updateLSThreadFromGroupInfo:function(a){return d(\"MAWUpdateLSThreadFromGroupInfoApi\").updateLSThreadFromGroupInfo(a.groupJid)},updateThreadMuteSetting:function(a){return d(\"MAWUpdateThreadMuteSettingApi\").updateThreadMuteSetting(a)},writeAdminMessageForDualThreadCutover:function(a){return d(\"MAWWriteAdminMessageForDualThreadCutoverApi\").writeAdminMessageForDualThreadCutover(a)},writeAdminMessageForEphemeralSettingsChange:function(a){return d(\"MAWWriteAdminMessageForEphemeralSettingsChange\").writeAdminMessageForEphemeralSettingsChange(a)},writeAdminMessageForThreadHotlikeCustomization:function(a){return d(\"MAWWriteAdminMessageForThreadHotlikeCustomizationApi\").writeAdminMessageForThreadHotlikeCustomization(a)},writeAdminMessageForThreadNicknameCustomization:function(a){return d(\"MAWWriteAdminMessageForThreadNicknameCustomizationApi\").writeAdminMessageForThreadNicknameCustomization(a)},writeAdminMessageForThreadPhotoCustomization:function(a){return d(\"MAWWriteAdminMessageForThreadPhotoCustomizationApi\").writeAdminMessageForThreadPhotoCustomization(a)},writeAdminMessageForThreadThemeCustomization:function(a){return d(\"MAWWriteAdminMessageForThreadThemeCustomizationApi\").writeAdminMessageForThreadThemeCustomization(a)},writeLSDBToPersistedEBTables:function(a){return d(\"MAWWriteLSDBToPersistedEBTables\").writeLSDBToPersistedEBTables(a.changeSet)}};g.commonBridgeHandlers=a}),98);\n__d(\"MAWCommonLowLevelApiLogWrapper\",[\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Fail: \",\", \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"End: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Start: \",\"\"]);j=function(){return a};return a}var k=d(\"WATagsLogger\").TAGS([\"LLA\"]);function a(a){Object.keys(a).forEach(function(b){var c=a[b];a[b]=function(){k.LOG(j(),b);return c.apply(void 0,arguments).then(function(a){k.LOG(i(),b);return a})[\"catch\"](function(a){k.WARN(h(),b,a);throw a})}});return a}g.lowLevelApiLogWrapper=a}),98);\n__d(\"MAWCommonLowLevelApiDbCallbacks\",[\"MAWBulkGetAppDataForRetryApi\",\"MAWBulkPutContactsApi\",\"MAWBulkSetRotateSenderKeyToTrueApi\",\"MAWClearSignalAndTempStores\",\"MAWCommonLowLevelApiLogWrapper\",\"MAWCreateGroupApi\",\"MAWDbMsgTxns\",\"MAWDebugMsg\",\"MAWDeleteExpiredMsgsApi\",\"MAWDeleteGroupsApi\",\"MAWFlushCacheToDbApi\",\"MAWGetAllThreadsAsJsonApi\",\"MAWGetAppDataApi\",\"MAWGetAppDataForResendApi\",\"MAWGetAppDataForRetryApi\",\"MAWGetDownloadableThumbnailForMediaApi\",\"MAWGetGroupInviteApi\",\"MAWGetLastMsgsInChatForSpamReportApi\",\"MAWGetMediaByObjectId\",\"MAWGetMediaPlaintextApi\",\"MAWGetMetaApi\",\"MAWGetMsgIdByProtocolMsgId\",\"MAWGetNextDeleteDFMContentTs\",\"MAWGetNextDeletePendingStanzaTs\",\"MAWGetNextDeleteUnsendContentTs\",\"MAWGetNextDeletionTsApi\",\"MAWGetNextExpirationTsApi\",\"MAWGetNextExpiredXMATs\",\"MAWGetOrCreateMediaKnownEntriesApi\",\"MAWGetProtocolMsgIdByMediaMsgId\",\"MAWGetProtocolMsgIdByMsgId\",\"MAWGetSenderKeyStatusApi\",\"MAWGetThreadInfoForDeletionApi\",\"MAWGetThreadJidByChatId\",\"MAWGetThreadLastMessageAuthoritativeTsApi\",\"MAWGetThreadLastMessageTsApi\",\"MAWGetThreadLastNumMessagesByServerTsApi\",\"MAWGetThreadLastNumMessagesBySortOrderApi\",\"MAWGetThreadsInfoApi\",\"MAWGetUnreadMsgsApi\",\"MAWGetUnreadMsgsApi__DONOTUSE\",\"MAWGetWorkerHeartbeatApi\",\"MAWGetWorkerStatusApi\",\"MAWHandleConnectedAdminMsgApi\",\"MAWHandleEncryptedBackupsSecretsApi\",\"MAWHandleMediaDownloadAndRestoreApi\",\"MAWHandleMediaDownloadApi\",\"MAWHandleMediaPreviewBeforeDownloadApi\",\"MAWHandleMediaPreviewDownloadApi\",\"MAWHandleReachabilityErrorAdminMsgApi\",\"MAWLinkReactionsToMsgsApi\",\"MAWLoadContactsApi\",\"MAWLoadReceiptApi\",\"MAWLoadRecentParticipantsApi\",\"MAWLoadThreadParticipantsApi\",\"MAWMarkAppDataDroppedApi\",\"MAWMarkAppDataSendFailedApi\",\"MAWMarkAppDataSentApi\",\"MAWMarkParticipantNeedsKeyApi\",\"MAWMarkReadReceiptsSentUpToApi\",\"MAWMarkSenderKeyAsRotatedApi\",\"MAWMarkSenderKeyAsSentApi\",\"MAWMarkThreadAsReadUpToApi\",\"MAWModifyRavenMsgApi\",\"MAWPreEstablishSessionApi\",\"MAWPredistributeSKDMApi\",\"MAWProcessSpamMsgApi\",\"MAWRemoveExpiredDFMMsgsContent\",\"MAWRemoveExpiredMsgsFromUIApi\",\"MAWRemoveExpiredPendingStanzas\",\"MAWRemoveExpiredUnsendMsgsContent\",\"MAWRemoveExpiredXMAMsgsContentApi\",\"MAWRemoveGroupInvitesApi\",\"MAWSaveReceiptApi\",\"MAWSetMetaApi\",\"MAWTaskScheduleApi\",\"MAWTransactor\",\"MAWUpdateEphemeralityOnMarkMsgsFromOtherAsReadApi\",\"MAWUpdateMediaEntryForMsgApi\",\"MAWUpdateMediaEntryForOptimisticUploadApi\",\"MAWUpdateThreadFolderApi\",\"MAWUploadRetroactiveMessageBatchApi\",\"MAWWriteAppDataRetryApi\",\"MAWWriteGroupInviteApi\",\"MAWWriteMetaSyncsApi\",\"MAWWriteMsgRetryApi\",\"MAWWriteMsgRetryCountApi\",\"MAWWriteOutgoingMsgApi\",\"Promise\",\"WAResultOrError\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;a=d(\"MAWCommonLowLevelApiLogWrapper\").lowLevelApiLogWrapper({bulkGetAppDataForRetry:d(\"MAWBulkGetAppDataForRetryApi\").bulkGetAppDataForRetry,bulkPutContacts:d(\"MAWBulkPutContactsApi\").bulkPutContacts,bulkSetRotateSenderKeyToTrue:d(\"MAWBulkSetRotateSenderKeyToTrueApi\").bulkSetRotateSenderKeyToTrue,clearSignalAndTempStores:d(\"MAWClearSignalAndTempStores\").clearSignalAndTempStores,createGroup:d(\"MAWCreateGroupApi\").createGroup,createGroups:d(\"MAWCreateGroupApi\").createGroups,deleteExpiredMsgs:d(\"MAWDeleteExpiredMsgsApi\").deleteExpiredMsgs,deleteGroups:d(\"MAWDeleteGroupsApi\").deleteGroups,downloadSyncBlob:function(){throw c(\"err\")(\"not implemented\")},flushCacheToDb:d(\"MAWFlushCacheToDbApi\").flushCacheToDb,getAllThreadsAsJson:d(\"MAWGetAllThreadsAsJsonApi\").getAllThreadsAsJson,getAppData:d(\"MAWGetAppDataApi\").getAppData,getAppDataForResend:d(\"MAWGetAppDataForResendApi\").getAppDataForResend,getAppDataForRetry:d(\"MAWGetAppDataForRetryApi\").getAppDataForRetry,getDeviceFingerprint:function(){throw c(\"err\")(\"not implemented\")},getDownloadableThumbnailForMedia:d(\"MAWGetDownloadableThumbnailForMediaApi\").getDownloadableThumbnailForMedia,getGroupInvite:d(\"MAWGetGroupInviteApi\").getGroupInvite,getLastMsgsInChatForSpamReport:d(\"MAWGetLastMsgsInChatForSpamReportApi\").getLastMsgsInChatForSpamReport,getMediaByObjectId:d(\"MAWGetMediaByObjectId\").getMediaByObjectId,getMediaKnownEntries:d(\"MAWGetOrCreateMediaKnownEntriesApi\").getOrCreateMediaKnownEntries,getMediaMsgForRedownload:function(){return(h||(h=b(\"Promise\"))).resolve(d(\"WAResultOrError\").makeError(\"message-not-found\"))},getMediaPlaintext:d(\"MAWGetMediaPlaintextApi\").getMediaPlaintext,getMeta:d(\"MAWGetMetaApi\").getMeta,getMsgIdByProtocolMsgId:d(\"MAWGetMsgIdByProtocolMsgId\").getMsgIdByProtocolMsgId,getNextDeleteDFMContentTs:d(\"MAWGetNextDeleteDFMContentTs\").getNextDeleteDFMContentTs,getNextDeletePendingStanzaTs:d(\"MAWGetNextDeletePendingStanzaTs\").getNextDeletePendingStanzaTs,getNextDeleteUnsendContentTs:d(\"MAWGetNextDeleteUnsendContentTs\").getNextDeleteUnsendContentTs,getNextDeletionTs:d(\"MAWGetNextDeletionTsApi\").getNextDeletionTs,getNextExpirationTs:d(\"MAWGetNextExpirationTsApi\").getNextExpirationTs,getNextExpiredXMATs:d(\"MAWGetNextExpiredXMATs\").getNextExpiredXMATs,getProtocolMsgIdByMediaMsgId:d(\"MAWGetProtocolMsgIdByMediaMsgId\").getProtocolMsgIdByMediaMsgId,getProtocolMsgIdByMsgId:d(\"MAWGetProtocolMsgIdByMsgId\").getProtocolMsgIdByMsgId,getSenderKeyStatus:d(\"MAWGetSenderKeyStatusApi\").getSenderKeyStatus,getTaskScheduledTime:d(\"MAWTaskScheduleApi\").getTaskScheduledTime,getThreadIdByJid:d(\"MAWGetThreadsInfoApi\").getThreadIdByJid,getThreadInfoForDeletion:d(\"MAWGetThreadInfoForDeletionApi\").getThreadInfoForDeletion,getThreadJidByChatId:d(\"MAWGetThreadJidByChatId\").getThreadJidByChatId,getThreadLastMessageAuthoritativeTs:d(\"MAWGetThreadLastMessageAuthoritativeTsApi\").getThreadLastMessageAuthoritativeTs,getThreadLastMessageTs:d(\"MAWGetThreadLastMessageTsApi\").getThreadLastMessageTs,getThreadLastNumMessagesByServerTs:d(\"MAWGetThreadLastNumMessagesByServerTsApi\").getThreadLastNumMessagesByServerTs,getThreadLastNumMessagesBySortOrder:d(\"MAWGetThreadLastNumMessagesBySortOrderApi\").getThreadLastNumMessagesBySortOrder,getUnreadMsgs:d(\"MAWDbMsgTxns\").IS_SORT_ORDER_COMPARISON_ENABLED?d(\"MAWGetUnreadMsgsApi\").getUnreadMsgs:d(\"MAWGetUnreadMsgsApi__DONOTUSE\").getUnreadMsgs__DONOTUSE,getWorkerHeartbeat:d(\"MAWGetWorkerHeartbeatApi\").getWorkerHeartbeat,getWorkerStatus:d(\"MAWGetWorkerStatusApi\").getWorkerStatus,handleConnectedAdminMsg:d(\"MAWHandleConnectedAdminMsgApi\").handleConnectedAdminMsg,handleEncryptedBackupsSecret:d(\"MAWHandleEncryptedBackupsSecretsApi\").handleEncryptedBackupsSecret,handleMediaDownload:d(\"MAWHandleMediaDownloadApi\").handleMediaDownload,handleMediaPreviewBeforeDownload:d(\"MAWHandleMediaPreviewBeforeDownloadApi\").handleMediaPreviewBeforeDownload,handleMediaPreviewDownload:d(\"MAWHandleMediaPreviewDownloadApi\").handleMediaPreviewDownload,handleReachabilityErrorAdminMsg:d(\"MAWHandleReachabilityErrorAdminMsgApi\").handleReachabilityErrorAdminMsg,handleSyncBeforeApplyPatch:function(){throw c(\"err\")(\"not implemented\")},handleSyncCompleted:function(){throw c(\"err\")(\"not implemented\")},handleSyncDelayApplyingPatchUntilUIUnblocks:function(){throw c(\"err\")(\"not implemented\")},handleSyncdFatal:function(){throw c(\"err\")(\"not implemented\")},linkReactionsToMsgs:d(\"MAWLinkReactionsToMsgsApi\").linkReactionsToMsgs,loadContacts:d(\"MAWLoadContactsApi\").loadContacts,loadReceipt:d(\"MAWLoadReceiptApi\").loadReceipt,loadRecentParticipants:d(\"MAWLoadRecentParticipantsApi\").loadRecentParticipants,loadThreadParticipants:d(\"MAWLoadThreadParticipantsApi\").loadThreadParticipants,markAppDataDropped:d(\"MAWMarkAppDataDroppedApi\").markAppDataDropped,markAppDataSendFailed:d(\"MAWMarkAppDataSendFailedApi\").markAppDataSendFailed,markAppDataSent:d(\"MAWMarkAppDataSentApi\").markAppDataSent,markParticipantNeedsKey:d(\"MAWMarkParticipantNeedsKeyApi\").markParticipantNeedsKey,markReadReceiptsSentUpTo:d(\"MAWMarkReadReceiptsSentUpToApi\").markReadReceiptsSentUpTo,markSenderKeyAsRotated:d(\"MAWMarkSenderKeyAsRotatedApi\").markSenderKeyAsRotated,markSenderKeyAsSent:d(\"MAWMarkSenderKeyAsSentApi\").markSenderKeyAsSent,markThreadAsReadUpTo:d(\"MAWMarkThreadAsReadUpToApi\").markThreadAsReadUpTo,modifyRavenMsg:d(\"MAWModifyRavenMsgApi\").modifyRavenMsg,predistributeSKDM:d(\"MAWPredistributeSKDMApi\").predistributeSKDM,preEstablishSession:d(\"MAWPreEstablishSessionApi\").preEstablishSession,printSyncdLog:function(){return(h||(h=b(\"Promise\"))).resolve()},processSpamMsgs:d(\"MAWProcessSpamMsgApi\").processSpamMsgs,removeExpiredDFMMsgsContent:d(\"MAWRemoveExpiredDFMMsgsContent\").removeExpiredDFMMsgsContent,removeExpiredMsgsFromUI:d(\"MAWRemoveExpiredMsgsFromUIApi\").removeExpiredMsgsFromUI,removeExpiredPendingStanzas:d(\"MAWRemoveExpiredPendingStanzas\").removeExpiredPendingStanzas,removeExpiredUnsendMsgsContent:d(\"MAWRemoveExpiredUnsendMsgsContent\").removeExpiredUnsendMsgsContent,removeExpiredXMAMsgsContent:d(\"MAWRemoveExpiredXMAMsgsContentApi\").removeExpiredXMAMsgsContent,removeGroupInvites:d(\"MAWRemoveGroupInvitesApi\").removeGroupInvites,runInBulkTransaction:d(\"MAWTransactor\").runInBulkTransaction,saveReceipt:d(\"MAWSaveReceiptApi\").saveReceipt,sendSyncdKeyRequest:function(){throw c(\"err\")(\"not implemented\")},sendSyncdKeyRotation:function(){throw c(\"err\")(\"not implemented\")},setMeta:d(\"MAWSetMetaApi\").setMeta,setTaskScheduledTime:d(\"MAWTaskScheduleApi\").setTaskScheduledTime,updateEphemeralityOnMarkMsgsFromOtherAsRead:d(\"MAWUpdateEphemeralityOnMarkMsgsFromOtherAsReadApi\").updateEphemeralityOnMarkMsgsFromOtherAsRead,updateMediaEntryForMsg:d(\"MAWUpdateMediaEntryForMsgApi\").updateMediaEntryForMsg,updateMediaEntryForOptimisticUpload:d(\"MAWUpdateMediaEntryForOptimisticUploadApi\").updateMediaEntryForOptimisticUpload,updateThreadFolder:d(\"MAWUpdateThreadFolderApi\").updateThreadFolder,uploadRetroactiveMessageBatch:d(\"MAWUploadRetroactiveMessageBatchApi\").uploadRetroactiveMessageBatch,uploadSyncExternalPatch:function(){throw c(\"err\")(\"not implemented\")},writeAppDataRetry:d(\"MAWWriteAppDataRetryApi\").writeAppDataRetry,writeCdnUrlAndBakeDownloadPayload:d(\"MAWHandleMediaDownloadAndRestoreApi\").writeCdnUrlAndBakeDownloadPayload,writeDebugMsg:d(\"MAWDebugMsg\").writeDebugMsg,writeGroupInvite:d(\"MAWWriteGroupInviteApi\").writeGroupInvite,writeMetaSyncs:d(\"MAWWriteMetaSyncsApi\").writeMetaSyncs,writeMsgRetry:d(\"MAWWriteMsgRetryApi\").writeMsgRetry,writeMsgRetryCount:d(\"MAWWriteMsgRetryCountApi\").writeMsgRetryCount,writeOutgoingMsg:d(\"MAWWriteOutgoingMsgApi\").writeOutgoingMsg,writeSyncdLog:function(){return(h||(h=b(\"Promise\"))).resolve()}});g.dbCallbacks=a}),98);\n__d(\"MAWSharedOfflineResumeStats\",[\"$InternalEnum\",\"MAWQplProxy\",\"WAGlobals\",\"WAPREList\",\"WATagsLogger\",\"WATimeUtils\",\"WAWaterFlow\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"New mailbox age is \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"New mailbox age is \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Waterflow should start before the start of the processing\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Possible stuck reason: \",\"\"]);k=function(){return a};return a}var l=d(\"WATagsLogger\").TAGS([\"offline-resume\"]),m=500,n=200;a=b(\"$InternalEnum\").Mirrored([\"OFFLINE\",\"ONLINE\"]);var o=b(\"$InternalEnum\").Mirrored([\"WA_CLIENT_INFRA\",\"WA_CLIENT_INFRA_DUPLICATED_START\",\"WA_CLIENT_CONNECTION_DROPPED\",\"WA_PASSIVE_MODE\",\"WA_PASSIVE_MODE_FAIL\",\"MAW_POISON_QUEUE\",\"MAW_INFRA\",\"MAW_EARLY_FLUSH\",\"MAW_BLOCKING_PRIORITY\",\"MAW_LOW_PRIORITY\",\"STUCK\",\"EB_EARLY\",\"EB_EARLY_RECEIPTS\",\"EB_MESSAGE\",\"EB_LOWPRI\",\"EB_ALL\",\"EB_ONLINE\",\"EB_SNIPPET\"]);e=function(){function a(a,b,c,e){this.$1=0,this.$3=c,this.$2=d(\"WAWaterFlow\").makeWaterflow(\"offline-resume\",d(\"WAPREList\").PRE_METRIC.OFFLINE_QUEUE),this.$6(a),this.$7(),this.$8(b),this.$9(e),this.$4=Math.round(d(\"WATimeUtils\").performanceAbsoluteNow()\/1e3)}var b=a.prototype;b.$8=function(a){var b=this;a.subscribe(function(a){switch(a.type){case\"passive-mode-start\":b.$2.isOnGoing()||b.$2.startMetric();b.$2.startPoint(o.WA_PASSIVE_MODE,{passiveModeAcks:a.count});b.$10(\"passive\");break;case\"passive-mode-end\":b.$2.endPoint(o.WA_PASSIVE_MODE);b.$10(\"passive-end\");break;default:a.type,b.$2.addPoint(o.WA_PASSIVE_MODE_FAIL),b.$10(\"passive-end\")}})};b.$9=function(a){var b=this;a.subscribe(function(a){switch(a.type){case\"new-message\":if(a.commonMessageBase.offline==null)return;b.addWAMessage();b.$10(\"wa\");break}})};b.$6=function(a){var b=this;a.subscribe(function(a){switch(a.type){case\"offline-start\":b.$11(a.offlineStats);b.$10(\"wa\");break;case\"offline-end\":b.$2.isOnGoing()&&(b.$2.endPoint(o.WA_CLIENT_INFRA),b.$10(\"maw\"));break;case\"offline-entity\":b.$12(a.serverTs,a.offline);b.$10(\"wa\");break;case\"offline-processed\":b.$13(a.count);b.$10(\"wa\");break;case\"connection-lost\":b.$2.addPoint(o.WA_CLIENT_CONNECTION_DROPPED);b.$10(\"wa\");break;default:a}})};b.$10=function(a,b){var c=this;b===void 0&&(b=15e3);clearTimeout(this.$5);this.$2.isOnGoing()&&(this.$5=setTimeout(function(){l.WARN(k(),a),c.$2.isOnGoing()&&c.$2.addPoint(o.STUCK,{stuckReason:a})},b))};b.$14=function(){clearTimeout(this.$5)};b.$7=function(){var a=this;this.$3.subscribe(function(b){switch(b.type){case\"maw-infra-start\":a.$2.isOnGoing()||a.$2.startMetric();b.count!=null&&a.$2.annotate({mawExpectedCount:b.count});a.$10(\"maw\");a.$2.startPoint(o.MAW_INFRA);break;case\"maw-infra-end\":a.$2.endPoint(o.MAW_INFRA);a.$14();b.success?a.$2.endSuccess():a.$2.endFail(\"fail\");break;case\"maw-early-flush\":a.$15(b.stage,b.participantsRaceCondition);a.$10(\"maw\");break;case\"maw-low-priority\":a.$16(b.stage);a.$10(\"maw\");break;case\"maw-blocking-priority\":a.$17(b.stage);a.$10(\"maw\");break;case\"eb\":b.stage===\"start\"?a.$2.startPoint(b.offlineStage):a.$2.endPoint(b.offlineStage);break;case\"maw-dangling-entities\":a.$2.annotate({mawDanglingEntities:b.count});break;case\"maw-stale-queue-items\":a.$2.addPoint(o.MAW_POISON_QUEUE,{waStaleQueueCount:b.count,waStaleQueueDBErrors:b.dbErrors,waStaleQueueDBVersions:b.dbVersions});break;default:b}})};b.addWAMessage=function(){this.$2.isOnGoing()&&(this.$2.reAnnotate(function(a){a=a.waMessage;return{waMessage:(a=a)!=null?a:0+1}}),this.$10(\"wa\"))};b.addMAWEntity=function(a){this.$2.isOnGoing()&&(this.$2.reAnnotate(function(b){b=b.mawProcessedCount;return{mawProcessedCount:((b=b)!=null?b:0)+a}}),this.$10(\"maw\"))};b.$16=function(a){d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(1056839232,\"112\"),\"worker_offline_queue_non_messages_\"+a);if(a===\"start\"){this.$2.startPoint(o.MAW_LOW_PRIORITY);return}a;this.$2.endPoint(o.MAW_LOW_PRIORITY)};b.$17=function(a){d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(1056839232,\"112\"),\"worker_offline_queue_messages_\"+a);if(a===\"start\"){this.$2.startPoint(o.MAW_BLOCKING_PRIORITY);return}a;this.$2.endPoint(o.MAW_BLOCKING_PRIORITY)};b.$15=function(a,b){d(\"MAWQplProxy\").sendQplPointThroughBridge(c(\"qpl\")._(1056839232,\"112\"),\"worker_offline_queue_priority_messages_\"+a);if(a===\"start\"){this.$2.startPoint(o.MAW_EARLY_FLUSH,{participantsRaceCondition:(b=b)!=null?b:!1});return}a;this.$2.endPoint(o.MAW_EARLY_FLUSH)};b.$11=function(a){var b=Math.floor(a.count\/m),c=Math.floor(a.message\/n);this.$2.isOnGoing()?this.$2.addPoint(o.WA_CLIENT_INFRA_DUPLICATED_START):(this.$1++,this.$2.startMetric(),this.$4=Math.round(d(\"WATimeUtils\").performanceAbsoluteNow()\/1e3));this.$2.startPoint(o.WA_CLIENT_INFRA,{batchSize:d(\"WAGlobals\").getConfig().batchSize(),expectedAppdata:a.appdata,expectedCount:a.count,expectedMessage:a.message,expectedNotification:a.notification,expectedReceipt:a.receipt,messageBucket:\"[\"+c*n+\"-\"+(c+1)*n+\")\",offlineResumeCount:this.$1,stanzaBucket:\"[\"+b*m+\"-\"+(b+1)*m+\")\",useIncreasedSignalFutureMessagesMax:d(\"WAGlobals\").getConfig().getSignalFutureMessagesMax()>2e3,waDanglingQueue:d(\"WAGlobals\").getConfig().waDanglingQueue()})};b.getDetails=function(){var a;return((a=this.$2)==null?void 0:a.getAnnotations())||{}};b.$13=function(a){var b;(b=this.$2)==null?void 0:b.reAnnotate(function(b){return{waProcessed:((b=b.waProcessed)!=null?b:0)+a}})};b.addRuntimeErrorDuringOffflineQueue=function(){if(this.$2.isOnGoing()){var a;(a=this.$2)==null?void 0:a.reAnnotate(function(a){return{runtimeErrors:(a=a.runtimeErrors)!=null?a:0+1}})}};b.addDecryptionError=function(){if(this.$2.isOnGoing()){var a;(a=this.$2)==null?void 0:a.reAnnotate(function(a){return{decryptErrors:(a=a.decryptErrors)!=null?a:0+1}})}};b.addRetriesTrack=function(a){if(this.$2.isOnGoing()){var b;(b=this.$2)==null?void 0:b.reAnnotate(function(b){return{retries:(b=b.retries)!=null?b:0+a}})}};b.$12=function(a,b){var c=this;if(!this.$2.isOnGoing()){l.ERROR(j());return}var d=this.$2;d.reAnnotate(function(d){var e=d.mailboxAgeSec,f=d.maxOffline;d=d.waDownloaded;e=e;e==null&&a!=null&&(e=c.$4-a,l.LOG(i(),e));e!=null&&a!=null&&(c.$4-a>e&&(e=c.$4-a,l.LOG(h(),e)));return{mailboxAgeSec:e,maxOffline:Math.max((e=f)!=null?e:0,b),waDownloaded:((f=d)!=null?f:0)+1}})};return a}();g.OfflineMode=a;g.OfflineStages=o;g.MAWSharedOfflineResumeStats=e}),98);\n__d(\"MAWDeleteDanglingParticipantsStartupJob\",[\"MAWDbVersion\",\"MAWIndexedDb\",\"MAWODSProxy\",\"MAWQplProxy\",\"MAWTransactionMode\",\"WALogger\",\"WAOdsEnums\",\"asyncToGeneratorRuntime\",\"gkx\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[Delete Dangling Participants] \",\"\"]);h=function(){return a};return a}function i(a){d(\"WALogger\").LOG(h(),a)}var j=d(\"MAWIndexedDb\").makeMsgrTransactor({participants:d(\"MAWTransactionMode\").READWRITE,threads:d(\"MAWTransactionMode\").READONLY},\"deleteDanglingParticipantsStartupJob\",function(a){return function(){return a.threads.toArray().then(function(b){return a.participants.where(\"threadJid\").noneOf(b.map(function(a){return a.jid}))[\"delete\"]()})}});a={run:function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){if(c(\"gkx\")(\"24027\")){i(\"Starting job...\");d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.MAW_DELETE_DANGLING_PARTICIPANTS,key:\"start\"});var a=(yield d(\"MAWDbVersion\").getDBVersion());if(a!=null&&a>=85){var b;i(\"\"+((b=a)!=null?b:\"null\"));b=(yield d(\"MAWQplProxy\").measurePerfInQPL(c(\"qpl\")._(25310776,\"6155\"),\"startup_job:delete_dangling_participants\",j));d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.MAW_DELETE_DANGLING_PARTICIPANTS,key:b>0?\"deleted\":\"good\"});i(\"Found and deleted \"+b+\" dangling participants\")}else{i(\"Expected DBVersion >= 85, but got \"+((b=a)!=null?b:\"null\")+\" instead\");d(\"MAWODSProxy\").odsBumpEntityKey({entity:d(\"WAOdsEnums\").Entity.MAW_DELETE_DANGLING_PARTICIPANTS,key:\"db_version_not_ready\"})}}});function e(){return a.apply(this,arguments)}return e}()};e=a;g[\"default\"]=e}),98);\n__d(\"MAWStartupJob\",[\"MAWDeleteDanglingParticipantsStartupJob\",\"Promise\",\"asyncToGeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=[c(\"MAWDeleteDanglingParticipantsStartupJob\")];function a(){return j.apply(this,arguments)}function j(){j=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){yield (h||(h=b(\"Promise\"))).all(i.map(function(a){return a.run()}))});return j.apply(this,arguments)}g.runMAWStartupJobs=a}),98);\n__d(\"MAWCommonBridgeErrorTransport\",[\"MAWBridge\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){d(\"MAWBridge\").getBridge().fireAndForget(\"event\",\"fbErrorProxy\",a)}g.log=a}),98);\n__d(\"MAWCommonWebWorkerErrorLogging\",[\"Env\",\"ErrorGuard\",\"ErrorPubSub\",\"ErrorSetup\",\"JSErrorLoggingConfig\",\"MAWCommonBridgeErrorTransport\",\"SiteData\",\"getErrorSafe\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i,j;function a(){var a;(h||(h=c(\"ErrorGuard\"))).skipGuardGlobal((i||(i=c(\"Env\"))).nocatch);c(\"ErrorSetup\").setup({appId:c(\"JSErrorLoggingConfig\").appId,client_revision:c(\"SiteData\").client_revision,extra:c(\"JSErrorLoggingConfig\").extra,loggingFramework:\"worker\",projectBlocklist:c(\"JSErrorLoggingConfig\").projectBlocklist,report_source:c(\"JSErrorLoggingConfig\").report_source,report_source_ref:c(\"JSErrorLoggingConfig\").report_source_ref,sample_weight:(a=c(\"JSErrorLoggingConfig\").sampleWeight)!=null?a:0,site_category:\"armadillo-worker\"},d(\"MAWCommonBridgeErrorTransport\").log);self.addEventListener(\"unhandledrejection\",function(a){a=a.reason;(j||(j=c(\"ErrorPubSub\"))).reportError(c(\"getErrorSafe\")(a))})}c(\"ErrorSetup\").preSetup();g.init=a}),98);\n__d(\"MAWCommonWorkerActions\",[\"MAWIndexedDb\",\"MAWJids\",\"MAWTransactionMode\",\"SignalDbTypes\",\"WAJids\",\"WALogger\",\"unrecoverableViolation\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"worker: got db data\"]);h=function(){return a};return a}function i(a){return a.meta.bulkGet([(a=d(\"SignalDbTypes\")).MetaKeysEnum.fbid,a.MetaKeysEnum.deviceId,a.MetaKeysEnum.cat,a.MetaKeysEnum.regId,a.MetaKeysEnum.identityKeyPair,a.MetaKeysEnum.authKeyPair]).then(function(a){var b=a[0],e=a[1],f=a[2],g=a[3],i=a[4];a=a[5];d(\"WALogger\").LOG(h());b=b==null?void 0:b.value.fbid;e=e==null?void 0:e.value.deviceId;f=f==null?void 0:f.value.cat;g=g==null?void 0:g.value.regId;i=i==null?void 0:i.value.identityKeyPair;a=a==null?void 0:a.value.authKeyPair;if(b==null)throw c(\"unrecoverableViolation\")(\"fbid not set\",\"messenger_e2ee_web\");if(e==null)throw c(\"unrecoverableViolation\")(\"deviceId not set\",\"messenger_e2ee_web\");if(f==null)throw c(\"unrecoverableViolation\")(\"fbCat not set\",\"messenger_e2ee_web\");if(g==null||i==null)throw c(\"unrecoverableViolation\")(\"regInfo not set\",\"messenger_e2ee_web\");return{deviceJid:d(\"WAJids\").toDeviceJid(d(\"MAWJids\").toUserJid(b),e),fbCat:f.encrypted_serialized_cat,regInfo:{authKeyPair:a,regId:g,staticKeyPair:i},userJid:d(\"MAWJids\").toUserJid(b)}})}function a(){return d(\"MAWIndexedDb\").makeSignalTransactor({meta:d(\"MAWTransactionMode\").READONLY},\"loadAllRegistrationMeta\",function(a){return function(){return i(a)}})()}g.loadAllRegistrationMetaInTransaction=a}),98);\n__d(\"MAWCompareWorkerSetupArgs\",[\"FBLogger\",\"WACryptoUtils\",\"err\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(a,b){if((a==null?void 0:a.prefixAndSuffix)!==(b==null?void 0:b.prefixAndSuffix))return!1;a=a==null?void 0:a.encryptionKey;b=b==null?void 0:b.encryptionKey;if(a==null&&b==null)return!0;if(a==null&&b!=null||a!=null&&b==null)return!1;if(a==null||b==null)throw c(\"err\")(\"encryptionKeyA and encryptionKeyB cannot be null at this point\");return d(\"WACryptoUtils\").arrayBuffersEqual(a,b)}function a(a,b){if(a.sessionId!==b.sessionId){c(\"FBLogger\")(\"mpf_web_foundations\").warn(\"[MAWCompareWorkerSetupArgs] Session id has changed. Worker session id: %s, Frontend session id: %s\",a.sessionId,b.sessionId);return!0}return b.fbId!==a.fbId||!h(b.vaultMaterials,a.vaultMaterials)}g.didWorkerSetupArgsChange=a}),98);\n__d(\"MAWCommonMainWebWorker\",[\"BrowserLockManager\",\"EBSMGating\",\"MAWBridge\",\"MAWCommonWebWorkerErrorLogging\",\"MAWCommonWorkerActions\",\"MAWCompareWorkerSetupArgs\",\"MAWDataSyncQueue\",\"MAWDbInitIndexedDb\",\"MAWDbInitReStore\",\"MAWDeleteOldLogsFromDisk\",\"MAWDeviceRegistrationInitWorker\",\"MAWDeviceRegistrationTypes\",\"MAWEBSwitch\",\"MAWFTSIndexedDb\",\"MAWGetDbVersion\",\"MAWHMACKey\",\"MAWLoggingSwitches\",\"MAWPersistedEBLSDB\",\"MAWQplProxy\",\"MAWRestoreDbBackwardMigration\",\"MAWRestoreDbState\",\"MAWSignalIndexedDb\",\"MAWStartupJob\",\"MAWVaultMaterials\",\"MAWWebWorkerLogger\",\"MWSetupDBEncryption\",\"Promise\",\"WACrossWorkerPortal\",\"WADevToolsBridge\",\"WALogger\",\"WAResultOrError\",\"WorkerMessagePort\",\"WorkerSelf\",\"asyncToGeneratorRuntime\",\"cr:7116\",\"cr:8390\",\"err\",\"gkx\",\"memoizeOneWithArgs\",\"pageID\",\"promiseDone\",\"qpl\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Missing DevTool port. Not able to setup DevTool\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No action required for setup.\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Worker requires a reboot to upgrade\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Worker has already gone through initialization before.\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"worker receive invalid message: \",\"\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Worker should not run initWorker() more than once.\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to migrate back to dexie from restore: \",\"\"]);o=function(){return a};return a}var p=(e=b(\"cr:8390\"))==null?void 0:e.dbInit;d(\"MAWWebWorkerLogger\").setupWebWorkerWaLogger();d(\"MAWCommonWebWorkerErrorLogging\").init();var q,r=null,s=!1;f=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var e;e=a.call(this,b,c)||this;e.onmessage=null;d(\"WorkerSelf\").init(babelHelpers.assertThisInitialized(e));e.$BridgeAdaptor$p_1=b;e.onUnhandledMessage.add(function(a){e.onmessage&&e.onmessage({data:a})});return e}var c=b.prototype;c.getBridgePort=function(){return this};return b}(d(\"WorkerMessagePort\").WorkerSyncedMessagePort);var t=function(a,b){return d(\"MAWQplProxy\").measurePerfInQPL(c(\"qpl\")._(25310776,\"6155\"),\"backend_\"+a,b)};d(\"MWSetupDBEncryption\").setPerformanceMeasurementTool(t);var u=function(){var a=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a,b=d(\"MAWRestoreDbState\").getTargetDbState()===\"restore\"||c(\"gkx\")(\"23906\")?d(\"MAWDbInitReStore\").dbInit:d(\"MAWDbInitIndexedDb\").dbInit;a=(a=p)!=null?a:b;b=!1;try{b=(yield d(\"MAWRestoreDbBackwardMigration\").migrateToDexieFromRestore())}catch(a){d(\"WALogger\").ERROR(o(),a)}if(b)return d(\"MAWDbInitIndexedDb\").dbInit();else return a()});return function(){return a.apply(this,arguments)}}(),v=c(\"memoizeOneWithArgs\")(b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){yield t(\"make_signal_and_ear\",function(){return(h||(h=b(\"Promise\"))).all([d(\"MAWSignalIndexedDb\").makeSignalDB(),d(\"MWSetupDBEncryption\").init(),d(\"MAWFTSIndexedDb\").makeFTSDB()])});if(d(\"EBSMGating\").isPersistedEBTableEnabled()&&!d(\"EBSMGating\").isEBSMV2Enabled()){var a=d(\"MAWQplProxy\").startQplUserFlow(c(\"qpl\")._(521478580,\"1409\"),{bool:{eb_switch:c(\"MAWEBSwitch\").isEnabled()},\"int\":{timestamp:Date.now()}});try{yield t(\"make_eblsdb\",function(){return d(\"MAWPersistedEBLSDB\").makeEBLSDB()})}catch(b){a.endFail(\"Initialisation failed when calling makeEBLSDB with error \"+b)}a.endSuccess()}yield t(\"make_db\",u);c(\"promiseDone\")(d(\"MAWStartupJob\").runMAWStartupJobs());return c(\"BrowserLockManager\")!=null?t(\"request_maw_registration_lock\",function(){return new(h||(h=b(\"Promise\")))(function(a,d){c(\"promiseDone\")(c(\"BrowserLockManager\").request(\"maw_registration_lock\",b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){try{var b=(yield w());a(b)}catch(a){d(a)}})))})}):w()})),w=c(\"memoizeOneWithArgs\")(b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(){var a=(yield t(\"init_device_reg_overall\",function(){return d(\"MAWDeviceRegistrationInitWorker\").initDeviceRegistration()})),e=a.message;a=a.registrationState;if(a===d(\"MAWDeviceRegistrationTypes\").RegistrationStatesEnum.failed)throw c(\"err\")(\"registration_failed: \"+e);a=(yield (h||(h=b(\"Promise\"))).all([t(\"load_reg_in_txn\",function(){return d(\"MAWCommonWorkerActions\").loadAllRegistrationMetaInTransaction()}),t(\"gen_insert_hmac\",function(){return d(\"MAWHMACKey\").generateAndInsertHMACKey()})]));e=a[0];a=a[1];return{hmacKey:a,regData:e}}));function x(){var a=d(\"MAWBridge\").getBridge();a=d(\"WACrossWorkerPortal\").attachPortal(a,[\"event\",\"threadEvent\"],function(a,b){var c=a.length>0?a[a.length-1]:null;c!=null&&c.type===\"request\"&&c.content.name===\"uiUpdate\"&&c.content.arg.events&&b.type===\"request\"&&b.content.name===\"uiUpdate\"?Array.prototype.push.apply(c.content.arg.events,b.content.arg.events):a.push(b);return a},c(\"pageID\"));return a}function y(a,b,c,d,e){return z.apply(this,arguments)}function z(){z=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(a,b,e,f,g){f=f==null?yield v():yield f;var h=f.hmacKey;f=f.regData;void g(f,h,d(\"MAWBridge\").getBridge(),a(f.regInfo),b);d(\"MAWLoggingSwitches\").removeLoggingFromBridge&&void d(\"MAWDeleteOldLogsFromDisk\").deleteOldLogsOnStartup();if(c(\"gkx\")(\"3282\"))if(e==null)d(\"WALogger\").ERROR(i());else{g=d(\"WACrossWorkerPortal\").attachPortal(d(\"WADevToolsBridge\").getDevToolBridge(),[\"devtool\"],function(a,b){a.push(b);return a},c(\"pageID\"));g.setPort(e)}});return z.apply(this,arguments)}function A(a){try{var b=x();b.setPort(a.getBridgePort());if(c(\"BrowserLockManager\")!=null)return d(\"WAResultOrError\").makeResult(v())}catch(a){return d(\"WAResultOrError\").makeError(a)}return d(\"WAResultOrError\").makeResult(null)}function a(a,e,f,g){if(s){d(\"WALogger\").WARN(n());return}a.addMessageListener(\"force-flush-data\",function(){self.dispatchEvent(new CustomEvent(\"force-flush-logs\")),c(\"promiseDone\")(d(\"MAWDataSyncQueue\").forceFlushDataSyncQueue())});a.addMessageListener(\"force-flush-logs-only\",function(){self.dispatchEvent(new CustomEvent(\"force-flush-logs\"))});var h=c(\"gkx\")(\"652\")||c(\"gkx\")(\"1159\"),i=h?d(\"WAResultOrError\").makeResult(null):A(a);a.addMessageListener(\"worker-setup\",function(){var n=b(\"asyncToGeneratorRuntime\").asyncToGenerator(function*(n){if(n!=null&&n.type!==\"worker-setup\"){d(\"WALogger\").WARN(m(),n);return}a.postMessage({setupHash:n.setupHash,type:\"worker-setup-ack\"});if(r!=null){var o=r;if(!f.isSharedWorkerContext())throw c(\"err\")(\"only shared workers can perform re-init!\");d(\"WALogger\").DEV(l());o=d(\"MAWCompareWorkerSetupArgs\").didWorkerSetupArgsChange(o,n.content);o?(d(\"WALogger\").DEV(k()),a.postMessage({action:\"reboot-required\",setupHash:n.setupHash,status:\"already-setup\",type:\"worker-setup\"}),self.close()):(q!=null&&(yield q),d(\"WALogger\").DEV(j()),a.postMessage({action:\"no-action\",setupHash:n.setupHash,status:\"already-setup\",type:\"worker-setup\"}));return}c(\"gkx\")(\"652\")&&d(\"MAWGetDbVersion\").setArmadilloDbVersionForTest(n.content.testDbVersion);c(\"gkx\")(\"1159\")&&d(\"MAWRestoreDbState\").setTargetDbState(n.content.testDbMigrationState);h&&(i=A(a));if(!i.success){a.postMessage({msg:(o=i.payload)==null?void 0:o.message,setupHash:n.setupHash,status:\"failure\",type:\"worker-setup\"});return}r=n.content;try{q=y(e,f,n.content.devToolMessageChannelPort2,i.value,g);yield q;o=n.content.vaultMaterials;if(c(\"gkx\")(\"23909\")){if(o==null||o.encryptionKey==null||o.prefixAndSuffix==null)throw c(\"err\")(\"Vault materials was null in worker setup\");d(\"MAWVaultMaterials\").initializeVaultMaterials(o)}b(\"cr:7116\")==null?void 0:b(\"cr:7116\")();a.postMessage({setupHash:n.setupHash,status:\"success\",type:\"worker-setup\"})}catch(b){c(\"gkx\")(\"23986\")&&c(\"promiseDone\")(d(\"MAWWebWorkerLogger\").flushLogs());a.postMessage({msg:b.message,setupHash:n.setupHash,status:\"failure\",type:\"worker-setup\"});throw b}});return function(a){return n.apply(this,arguments)}}());s=!0}g.BridgeAdaptor=f;g.performDeviceRegistration=w;g.initWorker=a}),98);\n__d(\"getOrchestratorVersion\",[\"qex\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){var a;return(a=c(\"qex\")._(\"263\"))!=null?a:\"default\"}g[\"default\"]=a}),98);\n__d(\"isUseridAnnotationEnabled\",[\"gkx\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){return c(\"gkx\")(\"24163\")}g[\"default\"]=a}),98);\n__d(\"WADebugTools\",[\"WADevToolsDebugFns\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){self.Debug==null&&(self.Debug={});var b=function(b){var c=a[b];self.Debug[c.name]=function(){return c.execute.apply(c,arguments)}};for(var c in a)b(c);d(\"WADevToolsDebugFns\").registerDebugFnsToDevTool(a)}g.initDebugFunctions=a}),98);\n__d(\"WASmaxInAbPropsIQErrorBadRequestMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"bad-request\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",400);return!a.success?a:d(\"WAResultOrError\").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);\n__d(\"WASmaxInAbPropsIQErrorFeatureNotImplementedMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"feature-not-implemented\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",501);return!a.success?a:d(\"WAResultOrError\").makeResult({text:b.value,code:a.value})}g.parseIQErrorFeatureNotImplementedMixin=a}),98);\n__d(\"WASmaxInAbPropsIQErrorBadRequestOrFeatureNotImplementedMixinGroup\",[\"WAResultOrError\",\"WASmaxInAbPropsIQErrorBadRequestMixin\",\"WASmaxInAbPropsIQErrorFeatureNotImplementedMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAbPropsIQErrorBadRequestMixin\").parseIQErrorBadRequestMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"IQErrorBadRequest\",value:b.value});var c=d(\"WASmaxInAbPropsIQErrorFeatureNotImplementedMixin\").parseIQErrorFeatureNotImplementedMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"IQErrorFeatureNotImplemented\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"IQErrorBadRequest\",\"IQErrorFeatureNotImplemented\"],[b,c])}g.parseIQErrorBadRequestOrFeatureNotImplementedMixinGroup=a}),98);\n__d(\"WASmaxInAbPropsIQErrorResponseMixin\",[\"WAResultOrError\",\"WASmaxParseReference\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"id\"]);if(!c.success)return c;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"id\",c.value);if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"to\"]);if(!c.success)return c;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"from\",c.value);if(!b.success)return b;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"error\");return!c.success?c:d(\"WAResultOrError\").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);\n__d(\"WASmaxInAbPropsGetExperimentConfigResponseErrorNoRetry\",[\"WAResultOrError\",\"WASmaxInAbPropsIQErrorBadRequestOrFeatureNotImplementedMixinGroup\",\"WASmaxInAbPropsIQErrorResponseMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInAbPropsIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInAbPropsIQErrorBadRequestOrFeatureNotImplementedMixinGroup\").parseIQErrorBadRequestOrFeatureNotImplementedMixinGroup(c.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{errorIQErrorBadRequestOrFeatureNotImplementedMixinGroup:b.value}))}g.parseGetExperimentConfigResponseErrorNoRetry=a}),98);\n__d(\"WASmaxInAbPropsIQErrorInternalServerErrorMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"internal-server-error\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,a,\"code\",500);return!a.success?a:d(\"WAResultOrError\").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);\n__d(\"WASmaxInAbPropsGetExperimentConfigResponseErrorRetry\",[\"WAResultOrError\",\"WASmaxInAbPropsIQErrorInternalServerErrorMixin\",\"WASmaxInAbPropsIQErrorResponseMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;c=d(\"WASmaxInAbPropsIQErrorInternalServerErrorMixin\").parseIQErrorInternalServerErrorMixin(c.value);if(!c.success)return c;a=d(\"WASmaxInAbPropsIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({errorIQErrorInternalServerErrorMixin:c.value},a.value))}g.parseGetExperimentConfigResponseErrorRetry=a}),98);\n__d(\"WASmaxInAbPropsExperimentConfigMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"prop\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"config_code\",1,void 0);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").attrString(a,\"config_value\");if(!c.success)return c;a=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,a,\"config_expo_key\",0,void 0);return!a.success?a:d(\"WAResultOrError\").makeResult({configCode:b.value,configValue:c.value,configExpoKey:a.value})}g.parseExperimentConfigMixin=a}),98);\n__d(\"WASmaxInAbPropsSamplingConfigMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"prop\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrIntRange(a,\"event_code\",1,void 0);if(!b.success)return b;a=d(\"WASmaxParseUtils\").attrIntRange(a,\"sampling_weight\",-1e4,1e4);return!a.success?a:d(\"WAResultOrError\").makeResult({eventCode:b.value,samplingWeight:a.value})}g.parseSamplingConfigMixin=a}),98);\n__d(\"WASmaxInAbPropsExperimentOrSamplingConfigMixinGroup\",[\"WAResultOrError\",\"WASmaxInAbPropsExperimentConfigMixin\",\"WASmaxInAbPropsSamplingConfigMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInAbPropsExperimentConfigMixin\").parseExperimentConfigMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"ExperimentConfig\",value:b.value});var c=d(\"WASmaxInAbPropsSamplingConfigMixin\").parseSamplingConfigMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"SamplingConfig\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"ExperimentConfig\",\"SamplingConfig\"],[b,c])}g.parseExperimentOrSamplingConfigMixinGroup=a}),98);\n__d(\"WASmaxInAbPropsIQResultResponseMixin\",[\"WAResultOrError\",\"WASmaxParseReference\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"id\"]);if(!c.success)return c;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"id\",c.value);if(!c.success)return c;c=d(\"WASmaxParseReference\").attrStringFromReference(b,[\"to\"]);if(!c.success)return c;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"from\",c.value);if(!b.success)return b;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"type\",\"result\");return!c.success?c:d(\"WAResultOrError\").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);\n__d(\"WASmaxInAbPropsGetExperimentConfigResponseSuccess\",[\"WAResultOrError\",\"WASmaxInAbPropsExperimentOrSamplingConfigMixinGroup\",\"WASmaxInAbPropsIQResultResponseMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"prop\");if(!b.success)return b;b=d(\"WASmaxInAbPropsExperimentOrSamplingConfigMixinGroup\").parseExperimentOrSamplingConfigMixinGroup(a);return!b.success?b:d(\"WAResultOrError\").makeResult({experimentOrSamplingConfigMixinGroup:b.value})}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"erid\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").contentBytesRange(a,1,100);return!b.success?b:d(\"WAResultOrError\").makeResult({elementValue:b.value})}function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"props\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"erid\",i);if(!e.success)return e;var f=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,c.value,\"protocol\",\"1\");if(!f.success)return f;var g=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,c.value,\"ab_key\");if(!g.success)return g;var j=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrString,c.value,\"hash\");if(!j.success)return j;var k=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,c.value,\"refresh\",0,void 0);if(!k.success)return k;var l=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrIntRange,c.value,\"refresh_id\",0,void 0);if(!l.success)return l;a=d(\"WASmaxInAbPropsIQResultResponseMixin\").parseIQResultResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxParseUtils\").mapChildrenWithTag(c.value,\"prop\",0,Infinity,h);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({propsProtocol:f.value,propsAbKey:g.value,propsHash:j.value,propsRefresh:k.value,propsRefreshId:l.value},a.value,{erid:e.value,propsProp:b.value}))}g.parseGetExperimentConfigResponseSuccessPropsProp=h;g.parseGetExperimentConfigResponseSuccessErid=i;g.parseGetExperimentConfigResponseSuccess=a}),98);\n__d(\"WASmaxOutAbPropsBaseIQGetRequestMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(){var a=d(\"WASmaxJsx\").smax(\"iq\",{id:d(\"WAWap\").generateId(),type:\"get\"});return a}function a(a){var b=h();return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);\n__d(\"WASmaxOutAbPropsGetExperimentConfigRequest\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WASmaxOutAbPropsBaseIQGetRequestMixin\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){a=a.propsHash;a=d(\"WASmaxOutAbPropsBaseIQGetRequestMixin\").mergeBaseIQGetRequestMixin(d(\"WASmaxJsx\").smax(\"iq\",{xmlns:\"abt\",to:d(\"WAWap\").S_WHATSAPP_NET},d(\"WASmaxJsx\").smax(\"props\",{protocol:\"1\",hash:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").CUSTOM_STRING,a)})));return a}g.makeGetExperimentConfigRequest=a}),98);\n__d(\"WASmaxAbPropsGetExperimentConfigRPC\",[\"WAComms\",\"WASmaxInAbPropsGetExperimentConfigResponseErrorNoRetry\",\"WASmaxInAbPropsGetExperimentConfigResponseErrorRetry\",\"WASmaxInAbPropsGetExperimentConfigResponseSuccess\",\"WASmaxOutAbPropsGetExperimentConfigRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d(\"WASmaxOutAbPropsGetExperimentConfigRequest\").makeGetExperimentConfigRequest(a);j.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(e,c));case 3:f=j.sent;g=d(\"WASmaxInAbPropsGetExperimentConfigResponseSuccess\").parseGetExperimentConfigResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt(\"return\",{name:\"GetExperimentConfigResponseSuccess\",value:g.value});case 7:h=d(\"WASmaxInAbPropsGetExperimentConfigResponseErrorNoRetry\").parseGetExperimentConfigResponseErrorNoRetry(f,e);if(!h.success){j.next=10;break}return j.abrupt(\"return\",{name:\"GetExperimentConfigResponseErrorNoRetry\",value:h.value});case 10:i=d(\"WASmaxInAbPropsGetExperimentConfigResponseErrorRetry\").parseGetExperimentConfigResponseErrorRetry(f,e);if(!i.success){j.next=13;break}return j.abrupt(\"return\",{name:\"GetExperimentConfigResponseErrorRetry\",value:i.value});case 13:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"GetExperimentConfig\",{Success:g,ErrorNoRetry:h,ErrorRetry:i}));case 14:case\"end\":return j.stop()}},null,this)}g.sendGetExperimentConfigRPC=a}),98);\n__d(\"WAGetAbPropsProtocol\",[\"WALogger\",\"WAResultOrError\",\"WASmaxAbPropsGetExperimentConfigRPC\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getAbPropsProtocol failed \",\"\"]);h=function(){return a};return a}function a(a){var c,e,f,g,j,k,l,m,n,o,p;return b(\"regeneratorRuntime\").async(function(q){while(1)switch(q.prev=q.next){case 0:q.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WASmaxAbPropsGetExperimentConfigRPC\").sendGetExperimentConfigRPC({propsHash:a}));case 2:c=q.sent;if(!(c.name===\"GetExperimentConfigResponseSuccess\")){q.next=7;break}e=c.value,f=e.propsAbKey,g=e.propsHash,j=e.propsRefresh,k=e.propsRefreshId,l=e.propsProp,m=e.erid;n=i(l),o=n.newProps,p=n.samplingConfigs;return q.abrupt(\"return\",d(\"WAResultOrError\").makeResult({abKey:f,hash:g,refresh:j,refreshId:k,props:o,samplingConfigs:p,erid:m==null?void 0:m.elementValue}));case 7:d(\"WALogger\").WARN(h(),c.value);return q.abrupt(\"return\",d(\"WAResultOrError\").makeError());case 9:case\"end\":return q.stop()}},null,this)}function i(a){var b=[],c=[];a.forEach(function(a){a=a.experimentOrSamplingConfigMixinGroup;if(a.name===\"ExperimentConfig\"){var d;b.push({configCode:a.value.configCode,configValue:a.value.configValue,configExpoKey:(d=a.value.configExpoKey)==null?void 0:d.toString()})}else a.name===\"SamplingConfig\"&&c.push({eventCode:a.value.eventCode,samplingWeight:a.value.samplingWeight})});return{newProps:b,samplingConfigs:c}}g.getAbPropsProtocol=a}),98);\n__d(\"WAAbPropsSync\",[\"WAAbProps\",\"WAAbPropsHelpers\",\"WAGetAbPropsProtocol\",\"WALogger\",\"WAPromiseManagement\",\"WAResultOrError\",\"WATimeUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"WAAbProps.update: updating ab configs\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"WAAbProps.update: detected no hash\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"syncAbProps: detected no hash\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"fetchAbProps failed\"]);k=function(){return a};return a}c=d(\"WAPromiseManagement\").cacheWhilePending(function(){return\"abProps\"},a);function a(a){var b=a.sendHash;b=b===void 0?!0:b;var c=a.eventFlow;c==null?void 0:c.addPoint(\"sync_ab_props\",{bool:{sendHash:b}});return b==null||b===!1?l(null,c):d(\"WAAbProps\").getHash().then(function(a){return l(a,c)})}e=a;function l(a,c){var e,f,g,h,i,l,n,o,p;return b(\"regeneratorRuntime\").async(function(q){while(1)switch(q.prev=q.next){case 0:c==null?void 0:c.addPoint(\"fetch_ab_props\");q.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAGetAbPropsProtocol\").getAbPropsProtocol(a));case 3:e=q.sent;if(e.success){q.next=8;break}d(\"WALogger\").ERROR(k());q.next=15;break;case 8:f=e.value,g=f.abKey,h=f.hash,i=f.refresh,l=f.props;n=d(\"WAAbPropsHelpers\").parseAbProps(d(\"WAAbProps\").getConfig(),l);c==null?void 0:c.addPoint(\"save_ab_props\");q.next=13;return b(\"regeneratorRuntime\").awrap(m(g,h,i,n));case 13:o=q.sent,o.success===!1&&(o.error,d(\"WALogger\").LOG(j()));case 15:q.next=17;return b(\"regeneratorRuntime\").awrap(d(\"WAAbProps\").getRefreshSecs());case 17:p=q.sent;return q.abrupt(\"return\",{seconds:p});case 19:case\"end\":return q.stop()}},null,this)}function m(a,c,e,f){var g,j,k,l,m,n,o,p,q,r,s,t,u;return b(\"regeneratorRuntime\").async(function(v){while(1)switch(v.prev=v.next){case 0:v.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAAbProps\").getAbProps());case 2:k=v.sent;l={abKey:(g=a)!=null?g:k.abKey,hash:(j=c)!=null?j:k.hash,refresh:d(\"WAAbPropsHelpers\").maybeUpdateRefresh(e),lastSyncTime:d(\"WATimeUtils\").unixTime(),propValues:k.propValues,propExpoKeys:k.propExpoKeys,internalExpoKeys:k.internalExpoKeys,expoKeyStr:k.expoKeyStr};if(!(c==null)){v.next=9;break}v.next=7;return b(\"regeneratorRuntime\").awrap(d(\"WAAbProps\").setAbProps(l));case 7:d(\"WALogger\").LOG(i());return v.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"noHash\"));case 9:d(\"WALogger\").LOG(h());m=f.values,n=f.expoKeys;o=d(\"WAAbPropsHelpers\").maybeUpdatePropValues(m,k.propValues,d(\"WAAbProps\").getConfig());p=d(\"WAAbPropsHelpers\").maybeUpdateExpoKeys(n,k.propExpoKeys,d(\"WAAbProps\").getConfig()),q=p.propExpoKeys,r=p.expoKeysToDelete;u=d(\"WAAbPropsHelpers\").maybeUpdateInternalExpoKeys(r,k.internalExpoKeys);u!=null&&(s=u.internalExpoKeys,t=u.expoKeyStr);v.next=17;return b(\"regeneratorRuntime\").awrap(d(\"WAAbProps\").setAbProps(babelHelpers[\"extends\"]({},l,{propValues:o,propExpoKeys:q,internalExpoKeys:s,expoKeyStr:t})));case 17:return v.abrupt(\"return\",d(\"WAResultOrError\").makeResult());case 18:case\"end\":return v.stop()}},null,this)}g.syncAbProps=c;g.syncAbPropsDebug=e}),98);\n__d(\"WAMetrics\",[\"Promise\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(){var a=d(\"WATimeUtils\").performanceAbsoluteNow();return new(h||(h=b(\"Promise\")))(function(b){setTimeout(function(){b(d(\"WATimeUtils\").performanceAbsoluteNow()-a)},0)})}g.getEventLoopDelay=a}),98);\n__d(\"WAOfflineBatchIb\",[\"WADeprecatedSendIq\",\"WAWap\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){d(\"WADeprecatedSendIq\").deprecatedCastStanza(d(\"WAWap\").wap(\"ib\",null,d(\"WAWap\").wap(\"offline_batch\",{count:d(\"WAWap\").INT(a)})))}g.sendBatchRequestIb=a}),98);\n__d(\"WAPullMode\",[\"WAGlobals\",\"WAOfflineBatchIb\",\"WAServerRPCLogger\",\"WAShiftTimer\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Request next batch: \",\". Total requested amount: \",\". Downloaded: \",\". Processed: \",\". Next batch on \",\"\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" processed < \",\" next batch check\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" downloaded > \",\" expected\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Already requested next batch\"]);k=function(){return a};return a}var l=0,m=100,n=d(\"WAServerRPCLogger\").logger.TAGS([\"PullMode\"]);a=function(){function a(){var a=this;this.$1=!1;this.$2=0;this.$3=0;this.$4=0;this.$5=0;this.$6=0;this.$7=new(d(\"WAShiftTimer\").ShiftTimer)(function(){a.$8()})}var b=a.prototype;b.offlineStart=function(a){this.clear(),this.$5=a,this.$9()};b.$10=function(){this.$7.cancel(),this.$7.onOrAfter(l)};b.stanzaReceived=function(){this.$1=!1,this.$4++,this.$10()};b.$9=function(){d(\"WAOfflineBatchIb\").sendBatchRequestIb(d(\"WAGlobals\").getConfig().batchSize()),this.$1=!0,this.$3+=d(\"WAGlobals\").getConfig().batchSize(),this.$2=this.$3-m};b.$8=function(){if(this.$1){n.LOG(k());return}if(this.$4>=this.$5){n.LOG(j(),this.$4,this.$5);return}if(this.$6<this.$2){n.LOG(i(),this.$6,this.$2);return}this.$9();n.LOG(h(),d(\"WAGlobals\").getConfig().batchSize(),this.$3,this.$4,this.$6,this.$2)};b.stanzaProcessed=function(){this.$6++,this.$10()};b.clear=function(){this.$7.cancel(),this.$2=0,this.$4=0,this.$5=0,this.$6=0,this.$3=0,this.$1=!1};return a}();g.PullMode=a}),98);\n__d(\"WAOneQueue\",[\"Promise\",\"WACastStanzas\",\"WAComms\",\"WADanglingQueue\",\"WAGlobals\",\"WAMetrics\",\"WAOfflineUtils\",\"WAPREList\",\"WAPREMetrics\",\"WAPubSub\",\"WAPullMode\",\"WAResolvable\",\"WAScheduleAfterOfflineResume\",\"WAShiftTimer\",\"WATagsLogger\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Error while casting ack: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Cast stanzas \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Acking\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Flushing protocol queue\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Processing stanza with tag \",\" is done\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Processing stanza with tag \",\"\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Drop offline queue as per loosing connection\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Offline queue end\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Offline queue end received while the connection gets dropped\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Error while processing: \",\"\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Execution of \",\" is done.\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Execution of \",\"\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Timeout while processing \",\" offline: \",\". Tag: \",\", status: \",\"\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Enqueuing \",\" offline: \",\" queue size: \",\".\"]);v=function(){return a};return a}var w=6e4,x=1e4,y=d(\"WATagsLogger\").TAGS([\"OneQueue\"]);a=function(){function a(a){var c=this,e=a.mode,f=a.cryptoManager;a=a.flushables;this.$1=d(\"WAPubSub\").simplePubSub();this.$2=(h||(h=b(\"Promise\"))).resolve();this.$3=[];this.$4=[];this.$8=0;this.$9={};this.$10=[];this.$11=0;this.$14=[];this.$5=e;this.$13=f;this.$14=a;this.$7=new(d(\"WAPullMode\").PullMode)();this.$6=new(d(\"WAShiftTimer\").ShiftTimer)(function(){c.$15({operationType:\"flush_by_timer\"},function(a){return c.$16(a).then(function(){return a.endSuccess()})}).then(function(){})[\"catch\"](function(a){throw a})})}var c=a.prototype;c.$15=function(a,c){var e=this,f=d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.ONE_QUEUE,{string:{operationType:a.operationType},\"int\":{size:this.$8,serverOfflineSize:this.$11}});void d(\"WAMetrics\").getEventLoopDelay().then(function(a){f.isActive()&&f.addPoint(\"measure_event_loop_delay\",{\"int\":{eventLoopDelay:a}})});var g=this.$8++;y.LOG(v(),a.operationType,this.$5!==d(\"WAOfflineUtils\").ServerRPCMode.ONLINE,g);f.addPoint(\"enqueueing_start\");var i=\"enqueueing\",j=setTimeout(function(){var b;f.addPoint(\"enqueueing_timeout\");y.ERROR(u(),a.operationType,e.$5!==d(\"WAOfflineUtils\").ServerRPCMode.ONLINE,(b=a.stanzaHandlerProps)==null?void 0:b.tag,i)},x);return new(h||(h=b(\"Promise\")))(function(b,g){e.$2=e.$2.then(function(){f.addPoint(\"enqueueing_end\");i=\"execution\";f.addPoint(\"execution_start\",{bool:{offline:e.$5!==d(\"WAOfflineUtils\").ServerRPCMode.ONLINE}});y.LOG(t(),a.operationType);B(f,function(){return f.addPoint(\"execution_end\")});return c(f)}).then(function(c){y.LOG(s(),a.operationType),b(c)})[\"catch\"](function(a){z(f,a),y.ERROR(r(),a),g(a)})[\"finally\"](function(){e.$8--,clearTimeout(j)})})};c.subscribe=function(a){return this.$1.subscribe(a)};c.getMode=function(){return this.$5};c.handleStanza=function(a,b){var c=this,d=this.$12;return this.$15({operationType:\"process_stanza\",stanzaHandlerProps:b},function(e){return c.$17(e,a,b,d)}).then(function(){return\"NO_ACK\"})};c.offlineStart=function(a){if(a.count===0)return;this.$5=d(\"WAOfflineUtils\").ServerRPCMode.OFFLINE_RESUME;this.$1.publish({type:\"offline-start\",offlineStats:a});this.$11=a.count;this.$6.onOrAfter(w);this.$7.offlineStart(a.count)};c.offlineEnd=function(){var a=this;return this.$15({operationType:\"offline_end\"},function(b){var c;if(a.$12!==((c=d(\"WAComms\").getComms())==null?void 0:c.socketId)){y.LOG(q());a.$6.cancel();a.$7.clear();return a.$16(b).then(function(){return b.endSuccess()})}y.LOG(p());a.$6.cancel();a.$7.clear();return a.$16(b).then(function(){a.$5=d(\"WAOfflineUtils\").ServerRPCMode.ONLINE,void d(\"WADanglingQueue\").danglingQueueClear(),d(\"WAScheduleAfterOfflineResume\").flushPostponedActions(),a.$1.publish({type:\"offline-end\"}),b.endSuccess()})}).then(function(){var b=a.$10;a.$10=[];b.forEach(function(a){return a()})})};c.newConnection=function(){var a;this.$12=(a=d(\"WAComms\").getComms())==null?void 0:a.socketId};c.connectionDropped=function(){var a=this;return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:y.WARN(o());this.$12=null;this.$7.clear();c.next=5;return b(\"regeneratorRuntime\").awrap(this.$15({operationType:\"flush_on_connection_drop\"},function(b){return a.$16(b).then(function(){return b.endSuccess()})}));case 5:this.$1.publish({type:\"connection-lost\"}),d(\"WAScheduleAfterOfflineResume\").flushPostponedActions();case 7:case\"end\":return c.stop()}},null,this)};c.$18=function(){return this.$5===d(\"WAOfflineUtils\").ServerRPCMode.OFFLINE_RESUME?d(\"WAGlobals\").getConfig().batchSize():1};c.$19=function(a,b){a!=null&&(this.$1.publish({type:\"offline-entity\",serverTs:b,offline:a}),this.$7.stanzaReceived(),this.$6.cancel(),this.$6.onOrAfter(w))};c.$17=function(a,c,d,e){var f=this,g=d.tag,i=d.offline;d=d.serverTs;this.$19(i,d);y.LOG(n(),g);a.addPoint(\"handling_stanza_start\",{string:{stanza_tag:g}});this.$9[g]=((i=this.$9[g])!=null?i:0)+1;return(h||(h=b(\"Promise\"))).resolve(c(this.$13)).then(function(b){a.addPoint(\"handling_stanza_end\");y.LOG(m(),g);!A(b)?f.$3.push({response:b,socketId:e}):(a.addPoint(\"pending_ack_start\"),B(a,function(){return a.addPoint(\"pending_ack_end\")}),f.$3.push({response:b,socketId:e,eventFlow:a}));return b}).then(function(b){return f.$20(a).then(function(){f.$7.stanzaProcessed(),A(b)||a.endSuccess()})})};c.$20=function(a){return this.$3.length>=this.$18()?this.$16(a):(h||(h=b(\"Promise\"))).resolve()};c.$16=function(a){var c=this;y.LOG(l());var e=0,f=Object.entries(this.$9).reduce(function(a,b){var c=b[0];b=b[1];e+=b;return babelHelpers[\"extends\"]({},a,(a={},a[\"flush_\"+c]=b,a))},{});this.$9={};a.addPoint(\"flushing_start\",{\"int\":babelHelpers[\"extends\"]({},f,{flush_total:e})});B(a,function(){return a.addPoint(\"flushing_end\")});return this.$14.reduce(function(b,d){return b.then(function(){return d.flush({cryptoManager:c.$13},y,a)})},(h||(h=b(\"Promise\"))).resolve()).then(function(){y.LOG(k());return c.$21()})[\"finally\"](function(){c.$5===d(\"WAOfflineUtils\").ServerRPCMode.OFFLINE_RESUME&&c.$1.publish({type:\"offline-processed\",count:e})})};c.isPendingAcksEmpty=function(){return this.$3.length===0&&this.$4.length===0};c.$21=function(){var a;return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:a=[].concat(this.$4,this.$3);y.LOG(j(),a.length);this.$3=[];this.$4=[];c.prev=4;c.next=7;return b(\"regeneratorRuntime\").awrap(d(\"WACastStanzas\").castStanzasByCategories(a,{send:!0,store:d(\"WAGlobals\").getConfig().waDanglingQueue()&&this.$5===d(\"WAOfflineUtils\").ServerRPCMode.OFFLINE_RESUME}));case 7:c.next=14;break;case 9:c.prev=9;c.t0=c[\"catch\"](4);y.ERROR(i(),c.t0.toString());a.forEach(function(a){a=a.eventFlow;(a==null?void 0:a.isActive())&&z(a,c.t0)});throw c.t0;case 14:return c.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve());case 15:case\"end\":return c.stop()}},null,this,[[4,9]])};c.enqueue=function(a,c){var e=this,f=c.operationType,g=c.flush;c=c.afterInit;c=c===void 0?!1:c;var h=function(){return e.$15({operationType:f},function(c){return a({cryptoManager:e.$13}).then(function(a){return b(\"regeneratorRuntime\").async(function(d){while(1)switch(d.prev=d.next){case 0:if(!g){d.next=3;break}d.next=3;return b(\"regeneratorRuntime\").awrap(e.$16(c));case 3:c.endSuccess();return d.abrupt(\"return\",a);case 5:case\"end\":return d.stop()}},null,this)})})};if(c&&this.$5!==d(\"WAOfflineUtils\").ServerRPCMode.ONLINE){var i=new(d(\"WAResolvable\").Resolvable)();this.$10.push(function(){h().then(function(a){return i.resolve(a)})[\"catch\"](function(a){return i.reject(a)})});return i.promise}return h()};return a}();function z(a,b){a==null?void 0:a.endFail(\"error\",{string:{error:\"\"+b.toString()}})}function A(a){return!(a===\"NO_ACK\"||a===\"CLOSE_SOCKET\")}function B(a,b){var c=a.endSuccess;a.endSuccess=function(a){b(),c(a)}}g.logger=y;g.WAOneQueue=a}),98);\n__d(\"WAJobPriorityBucket\",[\"WAJobOrchestratorTypes\",\"WALogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Assertion failed::markJobTaskDone found jobId: \",\" in scheduled tasks\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Assertion failed::markJobTaskPending found jobId: \",\" in pending tasks\"]);i=function(){return a};return a}a=function(){function a(a){this.tasks=[];this.pendingTasks=[];this.lastJobStartedTimestampMs=null;this.jobMaxConcurrency=(a=a.jobMaxConcurrencyMap)!=null?a:{}}var b=a.prototype;b.updateConfig=function(a){this.jobMaxConcurrency=(a=a.jobMaxConcurrencyMap)!=null?a:{}};b.getStats=function(){return[].concat(this.tasks,this.pendingTasks).reduce(function(a,b){var c;c=(c=a[b.jobName])!=null?c:0;a[b.jobName]=c+1;return a},{})};b.next=function(){var a=this;if(this.tasks.length===0)return null;var b=this.pendingTasks.reduce(function(a,b){var c;c=(c=a.get(b.jobName))!=null?c:0;a.set(b.jobName,c+1);return a},new Map()),c=this.tasks.filter(function(c){var e;return((e=b.get(c.jobName))!=null?e:0)<((e=a.jobMaxConcurrency[c.jobName])!=null?e:d(\"WAJobOrchestratorTypes\").DEFAULT_CONCURRENCY)});return c.length>0?[c[0]]:null};b.add=function(a,b,c,d){c={jobId:c,jobInfo:b,jobName:a,run:d};this.tasks.push(c);return c};b.markJobTaskPending=function(a){this.pendingTasks.includes(function(b){return b.jobId===a.jobId})&&d(\"WALogger\").ERROR(i(),a.jobId).sendLogs(\"JobOrchestrator::markJobTaskPending\"),this.lastJobStartedTimestampMs=Date.now(),this.pendingTasks.push(a),this.tasks=this.tasks.filter(function(b){return b.jobId!==a.jobId})};b.markJobTaskDone=function(a){this.pendingTasks=this.pendingTasks.filter(function(b){return b.jobId!==a}),this.tasks.includes(function(b){return b.jobId===a})&&d(\"WALogger\").ERROR(h(),a).sendLogs(\"JobOrchestrator::markJobTaskDone\")};b.count=function(){return this.tasks.length};b.pendingCount=function(){return this.pendingTasks.length};b.clearWaitingTasks=function(){this.tasks=[]};b.clear=function(){this.tasks=[],this.pendingTasks=[]};b.getLastJobStartedTimestamp=function(){return this.lastJobStartedTimestampMs};return a}();b=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.next=function(){var a=this,b,c;if(this.tasks.length===0)return null;var d=this.pendingTasks.reduce(function(a,b){var c;c=(c=a.get(b.jobName))!=null?c:0;a.set(b.jobName,c+1);return a},new Map()),e=this.tasks.filter(function(b){var c;return((c=d.get(b.jobName))!=null?c:0)<((c=a.jobMaxConcurrency[b.jobName])!=null?c:1)});if(e.length===0)return null;b=(b=this.jobMaxConcurrency[e[0].jobName])!=null?b:1;c=(c=d.get(e[0].jobName))!=null?c:0;if(b>1&&c<b){var f=e.filter(function(a){return a.jobName===e[0].jobName});b=Math.min(f.length,b-c);return f.slice(0,b)}return[e[0]]};return b}(a);g.BaseJobBucket=a;g.LowJobBucket=b}),98);\n__d(\"WAConcurrentBucketJobQueue\",[\"Promise\",\"WABase64\",\"WACustomError\",\"WAErr\",\"WAJobOrchestratorTypes\",\"WAJobPriorityBucket\",\"WALogger\",\"WAMetrics\",\"WANullthrows\",\"WAPromiseTimeout\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[job-orchestator]: \",\" exceeding the timeout, release the thread.\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[job-orchestator]: updated WAConcurrentBucketJobQueue config\"]);j=function(){return a};return a}var k=30,l=new Map([[d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH,5],[d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW,1]]);a=function(){function a(){this.$1=!1,this.$2=0,this.$3=0,this.$4=0,this.$5=new Map(),this.$6=new Map(),this.$7=new Map(),this.$9=0}var e=a.prototype;e.init=function(a,b){var e,f,g;if(this.$1)throw c(\"WAErr\")(\"WAConcurrentBucketJobQueue has already initialized\");this.$4=(e=a==null?void 0:a.bestEffortWaitTimeoutSec)!=null?e:k;this.$2=a.maxConcurrency;this.$3=a.maxConcurrency;this.$8=b;this.$7=this.$11(a==null?void 0:a.jobPrioritiesQuota);this.$6=new Map(this.$7);this.$5=new Map();this.$9=Date.now();b=new(d(\"WAJobPriorityBucket\").BaseJobBucket)({jobMaxConcurrencyMap:(e=a.maxConcurrencyPerJob)!=null?e:{}});e=new(d(\"WAJobPriorityBucket\").LowJobBucket)({jobMaxConcurrencyMap:(e=a.maxConcurrencyPerJob)!=null?e:{}});f=new(d(\"WAJobPriorityBucket\").LowJobBucket)({jobMaxConcurrencyMap:(f=a.maxConcurrencyPerJob)!=null?f:{}});g=new(d(\"WAJobPriorityBucket\").BaseJobBucket)({jobMaxConcurrencyMap:(g=a.maxConcurrencyPerJob)!=null?g:{}});a=new(d(\"WAJobPriorityBucket\").BaseJobBucket)({jobMaxConcurrencyMap:(a=a.maxConcurrencyPerJob)!=null?a:{}});this.$5.set(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.UI_ACTION,b);this.$5.set(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH,b);this.$5.set(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.OFFLINE,g);this.$5.set(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HISTORY_SYNC,a);this.$5.set(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW,e);this.$5.set(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.BEST_EFFORT,f);this.$1=!0};e.updateConfig=function(a){this.$3+=a.maxConcurrency-this.$2,this.$2=a.maxConcurrency,this.$5.forEach(function(b){return b.updateConfig({jobMaxConcurrencyMap:(b=a.maxConcurrencyPerJob)!=null?b:{}})}),this.$7=this.$11(a==null?void 0:a.jobPrioritiesQuota),d(\"WALogger\").LOG(j())};e.isInitialized=function(){return this.$1};e.clearQueue=function(){if(!this.$1)throw c(\"WAErr\")(\"WAConcurrentBucketJobQueue not initialized\");this.$5.forEach(function(a){return a.clear()})};e.clearQueueByPriority=function(a){if(!this.$1)throw c(\"WAErr\")(\"WAConcurrentBucketJobQueue not initialized\");(a=this.$5.get(a))==null?void 0:a.clearWaitingTasks()};e.getIntStats=function(){var a=this,b=function(b){var c;b=a.$5.get(b);return((c=b==null?void 0:b.count())!=null?c:0)+((c=b==null?void 0:b.pendingCount())!=null?c:0)};return{highPriorityBucketSize:b(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH),lowPriorityBucketSize:b(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW),bestEffortPriorityBucketSize:b(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.BEST_EFFORT)}};e.getStringStats=function(){var a=this,b=function(b){var c=(b=(b=a.$5.get(b))==null?void 0:b.getStats())!=null?b:{};b=Object.keys(c).reduce(function(a,b){var d=a[0];a=a[1];var e=c[b];return e>d?[e,b]:[d,a]},[0,null]);b=b[1];return b};return{highPriorityMaxJob:b(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH),lowPriorityMaxJob:b(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW),bestEffortPriorityMaxJob:b(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.BEST_EFFORT)}};e.enqueue=function(a,e,f,g){var i,j=this;if(!this.$1)return(h||(h=b(\"Promise\"))).reject(c(\"WAErr\")(\"WAConcurrentBucketJobQueue not initialized\"));var k,l,m=new(h||(h=b(\"Promise\")))(function(a,b){k=a,l=b}),n=babelHelpers[\"extends\"]({priority:d(\"WAJobOrchestratorTypes\").DEFAULT_JOB_PRIORITY},f),o=this.getJobBucketByType(n.priority);if(!o)return(h||(h=b(\"Promise\"))).reject(c(\"WAErr\")(\"WAConcurrentBucketJobQueue no bucket for job with name \"+a+\" was found.\"));void d(\"WAMetrics\").getEventLoopDelay().then(function(a){(g==null?void 0:g.isActive())&&(g==null?void 0:g.addPoint(\"measure_event_loop_delay\",{\"int\":{eventLoopDelay:a}}))});g==null?void 0:g.addPoint(\"scheduling_job\",{string:babelHelpers[\"extends\"]({},this.getStringStats(),{priority:n.priority}),\"int\":babelHelpers[\"extends\"]({},this.getIntStats(),{maxTimeoutMs:(i=f==null?void 0:f.maxTimeoutMs)!=null?i:0})});var p=n.priority+\"-\"+a+\"-\"+((i=f==null?void 0:f.jobId)!=null?i:d(\"WABase64\").randomBase64(8));i=o.add(a,n,p,function(){var a;return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.prev=0;j.$8.logJobStarted(p);c.next=4;return b(\"regeneratorRuntime\").awrap(j.$12(e(),f==null?void 0:f.maxTimeoutMs));case 4:a=c.sent;j.$8.logJobCompleted(p);k(a);c.next=13;break;case 9:c.prev=9,c.t0=c[\"catch\"](0),c.t0 instanceof d(\"WACustomError\").TimeoutError?j.$8.logJobTimeout(p):j.$8.logJobError(p),l(c.t0);case 13:case\"end\":return c.stop()}},null,this,[[0,9]])});this.$8.logJobCreated({jobId:p,jobName:a,jobPriority:n.priority,pendingJobsCount:o.count()});f&&f.priority===d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.UI_ACTION&&void this.$13(i);this.$14();return m};e.getAvailableThreadsCount=function(){return this.$3};e.getJobQuotaConfig=function(){return this.$7};e.getRemainingJobCountMap=function(){return this.$6};e.getJobBucketByType=function(a){return this.$5.get(a)};e.getSnapshot=function(a){a=this.getJobBucketByType(a);return!a?null:a.getStats()};e.$11=function(a){var b;!a?b=new Map(l):b=new Map(a);b.set(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.BEST_EFFORT,0);return b};e.$15=function(a){return(a=this.$6.get(a))!=null?a:0};e.$16=function(){this.$6=new Map(this.$7)};e.$17=function(a){var b=this;a===void 0&&(a=!0);var c=0,e=null,f=0;this.$5.forEach(function(a,d){c+=a==null?void 0:a.count();f+=b.$15(d);if(e!=null)return;a.count()>0&&b.$15(d)>0&&(e=a)});var g=e==null||f===0;g&&this.$16();if(this.$18(c,g))return this.getJobBucketByType(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.BEST_EFFORT);return e==null&&a?this.$17(!1):e};e.$18=function(a,b){var c=this;function e(a,b){var c=Date.now();return a>c?!1:c-a<b*1e3}function f(a,b){a=Math.ceil(a-Date.now())+b*1e3;return a>0?a:0}var g=this.getJobBucketByType(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.BEST_EFFORT);a=a-((a=g==null?void 0:g.count())!=null?a:0);var h=g==null?void 0:g.getLastJobStartedTimestamp();if((g==null?void 0:g.count())===0)return!1;if(h==null&&e(this.$9,this.$4)){if(this.$10==null){g=f(this.$9,this.$4);this.$10=setTimeout(function(){c.$14(),c.$10=null},g)}return!1}return a>0&&h!=null&&e(h,this.$4)?!1:b};e.$19=function(a){a=this.$20(a);return c(\"WANullthrows\")(this.$5.get(a))};e.$20=function(a){var b=a.split(\"-\")[0];b=d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.cast(b);if(!b)throw c(\"WAErr\")(\"ConcurrentBucketQueue cannot extract known job priority type from id: \"+a);return b};e.$21=function(a){a=this.$20(a);this.$15(a)>0?this.$6.set(a,this.$15(a)-1):this.$6.set(a,0)};e.$14=function(){var a=this;while(this.$3>0){var b=this.$17();b=b==null?void 0:b.next();if(b==null)break;b.forEach(function(b){a.$21(b.jobId),void a.$13(b)})}};e.$12=function(a,b){return b!==void 0?d(\"WAPromiseTimeout\").promiseTimeout(a,b):a};e.$13=function(a){var c=this,e,f,g,h,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:e=this.$19(a.jobId);this.$3--;e.markJobTaskPending(a);f=a.run,g=a.jobId,h=a.jobName;k.prev=4;k.next=7;return b(\"regeneratorRuntime\").awrap(this.$12(f(),((j=a.jobInfo)==null?void 0:j.maxTimeoutMs)===void 0?d(\"WAJobOrchestratorTypes\").DEFAULT_JOB_TIMEOUT_MS:void 0));case 7:k.next=17;break;case 9:k.prev=9;k.t0=k[\"catch\"](4);if(!(k.t0 instanceof d(\"WACustomError\").TimeoutError)){k.next=16;break}this.$8.logJobTimeout(g);d(\"WALogger\").LOG(i(),h);k.next=17;break;case 16:throw k.t0;case 17:k.prev=17;this.$3++;e.markJobTaskDone(g);this.$3>0&&setTimeout(function(){return c.$14()},0);return k.finish(17);case 22:case\"end\":return k.stop()}},null,this,[[4,9,17,22]])};return a}();g.WAConcurrentBucketJobQueue=a}),98);\n__d(\"WAConcurrentPreemptiveJobQueue\",[\"Promise\",\"WACustomError\",\"WAErr\",\"WAHex\",\"WAJobOrchestratorTypes\",\"WALogger\",\"WAPromiseTimeout\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Assertion failed::markJobTaskDone found jobId: \",\" in scheduled tasks\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Assertion failed::markJobTaskPending found jobId: \",\" in pending tasks\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[job-orchestator]: \",\" exceeding the timeout, release the thread.\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[job-orchestator]: updated ConcurrentPreemptiveJobQueue config\"]);l=function(){return a};return a}a=function(){function a(){this.$1=!1,this.$2=0,this.$3=0,this.$4={},this.$5=[],this.$6=[]}var e=a.prototype;e.init=function(a,b){if(this.$1)throw c(\"WAErr\")(\"ConcurrentPreemptiveJobQueue has already initialized\");this.$2=a.maxConcurrency;this.$3=a.maxConcurrency;this.$4=(a=a.maxConcurrencyPerJob)!=null?a:{};this.$7=b;this.$1=!0};e.updateConfig=function(a){this.$3+=a.maxConcurrency-this.$2;this.$2=a.maxConcurrency;this.$4=(a=a.maxConcurrencyPerJob)!=null?a:{};d(\"WALogger\").LOG(l())};e.isInitialized=function(){return this.$1};e.clearQueueByPriority=function(a){if(!this.$1)throw c(\"WAErr\")(\"ConcurrentPreemptiveJobQueue not initialized\");this.$5=this.$5.filter(function(b){return((b=b.jobInfo)==null?void 0:b.priority)!==a})};e.clearQueue=function(){if(!this.$1)throw c(\"WAErr\")(\"ConcurrentPreemptiveJobQueue not initialized\");this.$5=[];this.$6=[]};e.enqueue=function(a,e,f){var g,i=this;if(!this.$1)return(h||(h=b(\"Promise\"))).reject(c(\"WAErr\")(\"ConcurrentPreemptiveJobQueue not initialized\"));var j,k,l=new(h||(h=b(\"Promise\")))(function(a,b){j=a,k=b}),m=babelHelpers[\"extends\"]({priority:d(\"WAJobOrchestratorTypes\").DEFAULT_JOB_PRIORITY},f),n=(g=f==null?void 0:f.jobId)!=null?g:d(\"WAHex\").randomHex(8).substr(0,64);g=this.$8(a,m,n,function(){var a;return b(\"regeneratorRuntime\").async(function(c){while(1)switch(c.prev=c.next){case 0:c.prev=0;i.$7.logJobStarted(n);c.next=4;return b(\"regeneratorRuntime\").awrap(i.$9(e(),f==null?void 0:f.maxTimeoutMs));case 4:a=c.sent;i.$7.logJobCompleted(n);j(a);c.next=13;break;case 9:c.prev=9,c.t0=c[\"catch\"](0),c.t0 instanceof d(\"WACustomError\").TimeoutError?i.$7.logJobTimeout(n):i.$7.logJobError(n),k(c.t0);case 13:case\"end\":return c.stop()}},null,this,[[0,9]])});f&&f.priority===d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.UI_ACTION&&this.$10(g);this.$11();return l};e.getAvailableThreadsCount=function(){return this.$3};e.getJobMaxConcurrency=function(){return this.$4};e.getSnapshot=function(a){};e.$11=function(){while(this.$3>0){var a=this.$12();if(a==null)break;this.$10(a)}};e.$9=function(a,b){return b!==void 0?d(\"WAPromiseTimeout\").promiseTimeout(a,b):a};e.$10=function(a){var c=this,e,f,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:this.$3--;this.$13(a);e=a.run,f=a.jobId,g=a.jobName;i.prev=3;i.next=6;return b(\"regeneratorRuntime\").awrap(this.$9(e(),((h=a.jobInfo)==null?void 0:h.maxTimeoutMs)===void 0?d(\"WAJobOrchestratorTypes\").DEFAULT_JOB_TIMEOUT_MS:void 0));case 6:i.next=16;break;case 8:i.prev=8;i.t0=i[\"catch\"](3);if(!(i.t0 instanceof d(\"WACustomError\").TimeoutError)){i.next=15;break}this.$7.logJobTimeout(f);d(\"WALogger\").LOG(k(),g);i.next=16;break;case 15:throw i.t0;case 16:i.prev=16;this.$3++;this.$14(f);setTimeout(function(){return c.$11()},0);return i.finish(16);case 21:case\"end\":return i.stop()}},null,this,[[3,8,16,21]])};e.$8=function(a,b,c,d){d={jobId:c,jobInfo:b,jobName:a,run:d};this.$7.logJobCreated({jobId:c,jobName:a,jobPriority:b.priority,pendingJobsCount:this.$5.length});this.$5.push(d);return d};e.$13=function(a){this.$6.includes(function(b){return b.jobId===a.jobId})&&d(\"WALogger\").ERROR(j(),a.jobId).sendLogs(\"JobOrchestrator::markJobTaskPending\"),this.$6.push(a),this.$5=this.$5.filter(function(b){return b.jobId!==a.jobId})};e.$14=function(a){this.$6=this.$6.filter(function(b){return b.jobId!==a}),this.$5.includes(function(b){return b.jobId===a})&&d(\"WALogger\").ERROR(i(),a).sendLogs(\"JobOrchestrator::markJobTaskDone\")};e.$12=function(){var a=this;if(this.$5.length===0)return null;var b=this.$6.reduce(function(a,b){var c;c=(c=a.get(b.jobName))!=null?c:0;a.set(b.jobName,c+1);return a},new Map()),c=this.$5.filter(function(c){var d;return((d=b.get(c.jobName))!=null?d:0)<((d=a.$4[c.jobName])!=null?d:1)});return c[0]};return a}();g.WAConcurrentPreemptiveJobQueue=a}),98);\n__d(\"WADefaultJobNoQueue\",[\"WAErr\",\"WAHex\",\"WAJobOrchestratorTypes\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){function a(){this.$2=!1}var e=a.prototype;e.init=function(a,b){if(this.$2)throw c(\"WAErr\")(\"DefaultNoQueue has already initialized\");this.$1=b;this.$2=!0};e.updateConfig=function(a){};e.isInitialized=function(){return this.$2};e.clearQueue=function(){};e.clearQueueByPriority=function(a){};e.getSnapshot=function(){throw c(\"WAErr\")(\"getSnapshot is not implemented for DefaultNoQueue\")};e.enqueue=function(a,c,e){var f,g,h,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:h=(f=e==null?void 0:e.jobId)!=null?f:d(\"WAHex\").randomHex(8).substr(0,64);this.$1.logJobCreated({jobId:h,jobName:a,jobPriority:(g=e==null?void 0:e.priority)!=null?g:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW,pendingJobsCount:0});j.prev=2;this.$1.logJobStarted(h);j.next=6;return b(\"regeneratorRuntime\").awrap(c());case 6:i=j.sent;this.$1.logJobCompleted(h);return j.abrupt(\"return\",i);case 11:j.prev=11;j.t0=j[\"catch\"](2);this.$1.logJobError(h);throw j.t0;case 15:case\"end\":return j.stop()}},null,this,[[2,11]])};return a}();g.WADefaultJobNoQueue=a}),98);\n__d(\"WAOrchestratorJobStatsLogger\",[\"WABaseGlobals\",\"WAPREList\",\"WAPREMetrics\"],(function(a,b,c,d,e,f,g){\"use strict\";var h=function(){function a(a,b,c){this.jobName=a,this.pendingJobsCount=c,this.jobPriority=b}var b=a.prototype;b.logJobAdded=function(){this.webcJobAddedT=Date.now(),this.eventFlow=d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.WA_JOBS_ORCHESTRATOR,{string:{name:this.jobName,jobPriority:this.jobPriority,orchestratorVersion:d(\"WABaseGlobals\").getConfig().orchestratorVersion()},\"int\":{pendingJobsCount:this.pendingJobsCount,addedAt:this.webcJobAddedT}})};b.logJobStarted=function(){this.webcJobStartedT=Date.now(),this.eventFlow.addPoint(\"start_job\",{\"int\":{startedAt:this.webcJobStartedT}})};b.logJobCompleted=function(a){this.webcJobCompletedT=Date.now();this.jobResultType=a;var b={\"int\":{pendingJobsCount:this.pendingJobsCount,completedAt:this.webcJobCompletedT}};a===\"completed\"?this.eventFlow.endSuccess(b):this.eventFlow.endFail(a,b)};return a}();a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.logJobCreated=function(a){var b=a.jobName,c=a.jobId,d=a.jobPriority;a=a.pendingJobsCount;b=new h(b,d,a);b.logJobAdded();this.$1.set(c,b)};b.logJobStarted=function(a){a=this.$1.get(a);a==null?void 0:a.logJobStarted()};b.logJobCompleted=function(a){this.$2(a,\"completed\")};b.logJobError=function(a){this.$2(a,\"error\")};b.logJobTimeout=function(a){this.$2(a,\"timeout\")};b.logJobAborted=function(a){this.$2(a,\"aborted\")};b.$2=function(a,b){var c=this.$1.get(a);c==null?void 0:c.logJobCompleted(b);this.$1[\"delete\"](a)};return a}();g.JobInfoEvent=h;g.JobStatsLogger=a}),98);\n__d(\"WAOrchestrator\",[\"WABaseGlobals\",\"WAConcurrentBucketJobQueue\",\"WAConcurrentPreemptiveJobQueue\",\"WADefaultJobNoQueue\",\"WAJobOrchestratorTypes\",\"WAOrchestratorJobStatsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(){var a={maxConcurrency:1},b=\"default\",c={},e=a,f=new(d(\"WAOrchestratorJobStatsLogger\").JobStatsLogger)();return function(g,i){var j;g===void 0&&(g=!1);g=g?b:d(\"WABaseGlobals\").getConfig().orchestratorVersion();j=(j=d(\"WABaseGlobals\").getConfig().orchestratorConfig())!=null?j:a;var k;i==null?void 0:i.addPoint(\"get_orchestrator\",{string:{orchestrator:g},\"int\":{maxConcurrency:j.maxConcurrency,highPriorityQuota:(i=(i=j.jobPrioritiesQuota)==null?void 0:i.get(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH))!=null?i:0,lowPriorityQuota:(i=(i=j.jobPrioritiesQuota)==null?void 0:i.get(d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW))!=null?i:0}});if(c[g]){h(e,j)&&(e=j,c[g].updateConfig(j));return c[g]}switch(g){case\"preemptive\":k=new(d(\"WAConcurrentPreemptiveJobQueue\").WAConcurrentPreemptiveJobQueue)();break;case\"bucket\":k=new(d(\"WAConcurrentBucketJobQueue\").WAConcurrentBucketJobQueue)();break;default:k=new(d(\"WADefaultJobNoQueue\").WADefaultJobNoQueue)();break}k.init(j,f);c[g]=k;e=j;return k}}function h(a,b){var c;if(a.maxConcurrency!==b.maxConcurrency)return!0;if(((c=a.jobPrioritiesQuota)==null?void 0:c.size)!==((c=b.jobPrioritiesQuota)==null?void 0:c.size))return!0;return Object.keys((c=a.maxConcurrencyPerJob)!=null?c:{}).length!==Object.keys((c=b.maxConcurrencyPerJob)!=null?c:{}).length?!0:JSON.stringify(a)!==JSON.stringify(b)}g.getInstanceDelegate=a}),98);\n__d(\"WaJobInMemoryAccessors\",[\"Promise\",\"WAHex\",\"WATimeUtils\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(){var a=-1,c=new Map();return{deletePersistedJob:function(a){return(h||(h=b(\"Promise\"))).resolve(c[\"delete\"](a))},loadAllJobs:function(){return(h||(h=b(\"Promise\"))).resolve(Array.from(c.values()))},maybeCreateJob:function(e){var f,g=JSON.stringify([e.type,(f=e.uniqKey)!=null?f:d(\"WAHex\").randomHex(32)]),i={backedOffCount:0,current:e.args,original:e.args,startTime:d(\"WATimeUtils\").unixTime(),step:\"$unstarted\",stepFirstStartTime:null,stepHardStartCountAfterTimeout:0,stepUnexpectedErrorCount:0,type:e.type,uniqKey:g,version:e.version,waitUntil:null,scheduleConfig:e.scheduleConfig};f=function(){var d=a--,e=babelHelpers[\"extends\"]({},i,{jobId:d});c.set(d,e);return(h||(h=b(\"Promise\"))).resolve({id:d,newlyCreated:!0})};if(e.uniqKey!=null){e=Array.from(c.values()).filter(function(a){return a.uniqKey===g});if(e.length===0)return f();var j=null;e.forEach(function(a){a.step!==\"$finished\"?j=a:c[\"delete\"](a.jobId)});return j!=null?(h||(h=b(\"Promise\"))).resolve({id:j.jobId,newlyCreated:!1}):f()}return f()},readPersistedJob:function(a){a=c.get(a);return(h||(h=b(\"Promise\"))).resolve(a&&babelHelpers[\"extends\"]({},a))},updatePersistedJob:function(a){return(h||(h=b(\"Promise\"))).resolve(c.set(a.jobId,babelHelpers[\"extends\"]({},a)))}}}g.getJobInMemoryAccessors=a}),98);\n__d(\"WAPersistedJobManagerV2\",[\"Promise\",\"WABaseGlobals\",\"WAErr\",\"WAJids\",\"WAJobOrchestratorTypes\",\"WAJobRequirement\",\"WALogger\",\"WAOrchestrator\",\"WAPREList\",\"WAPREMetrics\",\"WAPersistedJobManager\",\"WAPromiseBackoffs\",\"WAResolvable\",\"WATimeUtils\",\"WaJobInMemoryAccessors\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" waiting on \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" halting because of \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": running in persisted mode\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": running in forced non-persisted mode\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": running in persisted mode\"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": running in forced non-persisted mode\"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": running in persisted mode\"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": running in forced non-persisted mode\"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" has been loaded and is marked as deprecated\"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose([\"addPersistedJobImplementation called twice for \",\"\"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose([\"onJobStarted for \",\" threw exception \",\"\"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": \",\" step not found\"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\" failed with error \",\"\"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose([\"onJobFinished for \",\" threw exception \",\"\"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": finished job\"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": Unhandled exception: \",\"\"]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": Unhandled exception. Tried \",\" times\"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": RetryOnBackoff\"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": delaying until \",\"\"]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": trim wait from \",\" to \",\"\"]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No implementation for \",\".\",\"\"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": removing completed, expired job from db\"]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": skew detected, adjusting accordingly\"]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Running deprecated job \",\"\"]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No implementation for deprecated \",\", job deleted\"]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose([\"No implementation for \",\". Maybe it should have been put to the deprecated list?\"]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": InterruptJob\"]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": running step\"]);J=function(){return a};return a}function K(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Persisted job missing for given ID\"]);K=function(){return a};return a}function L(){var a=babelHelpers.taggedTemplateLiteralLoose([\"[JOB MANAGER] Restarting job with the same id\"]);L=function(){return a};return a}function M(){var a=babelHelpers.taggedTemplateLiteralLoose([\"\",\": stuck on the step \",\", aborting the job\"]);M=function(){return a};return a}var N=1;function O(a){var b=a.code,c=a.annotations;c=c===void 0?{}:c;a=a.eventFlow;var d=a===void 0?P(c):a;return b(d).then(function(a){d.endSuccess();return a})[\"catch\"](function(a){d.endFail(\"error\",{string:{error:\"\"+a}});throw a})}function P(a){a===void 0&&(a={});return d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.WA_JOB_MANAGER,babelHelpers[\"extends\"]({},a,{string:babelHelpers[\"extends\"]({},(a=(a=a)==null?void 0:a.string)!=null?a:{},{userHash:d(\"WABaseGlobals\").getConfig().isEmployee()&&d(\"WABaseGlobals\").getConfig().isUseridAnnotationEnabled()?d(\"WAJids\").extractUserId(d(\"WABaseGlobals\").getMyUserJid()).slice(-5):null})}))}a=function(){function a(a){var c=this,e=a.isRestartAfterCrash,f=a.accessors,g=a.unfinishedJobEntries;this.getOrchestratorDelegate=d(\"WAOrchestrator\").getInstanceDelegate();this.activeJobs=new Map();this.implementationLoaders=new Map();this.implementations=new Map();this.stepBlockers=new WeakMap();this.accessors=f;this.isRestartAfterCrash=e||!1;this.listeners=a.listeners;this.deprecatedJobs=a.deprecatedJobs;this.inMemoryAccessors=d(\"WaJobInMemoryAccessors\").getJobInMemoryAccessors();this.offlineQueueMode=!0;a.offlineQueueCompletePromise!=null?a.offlineQueueCompletePromise.promise[\"finally\"](function(){c.offlineQueueMode=!1}):this.offlineQueueMode=!1;this.initialJobsPromise=g.then(function(a){var e=[],f=[];a.forEach(function(a){a.stepHardStartCountAfterTimeout>=5?e.push(a):f.push(a)});return(h||(h=b(\"Promise\"))).all(e.map(function(a){d(\"WALogger\").ERROR(M(),R(a),a.step).devConsole(Q(a)).sendLogs(\"job-stuck-\"+a.type);return c.accessors.deletePersistedJob(a.jobId)})).then(function(){f.forEach(function(a){var b=c.$1(a.jobId);if(b.alreadyActive===!0){d(\"WALogger\").ERROR(L());return}b.deferred.resolve(O({code:function(b){return c.$2(a,c.accessors,{eventFlow:b})},annotations:{string:{name:a.type},bool:{offlineQueueMode:c.offlineQueueMode}}}))})})})}var e=a.prototype;e.$3=function(a,e,f){var g,h,i;return b(\"regeneratorRuntime\").async(function(j){while(1)switch(j.prev=j.next){case 0:f===void 0&&(f={});h=this.$1(a);(g=f.eventFlow)==null?void 0:g.addPoint(\"start_load_and_run\",{bool:{skipped:h.alreadyActive}});if(!(h.alreadyActive===!0)){j.next=5;break}return j.abrupt(\"return\",h.deferred);case 5:j.next=7;return b(\"regeneratorRuntime\").awrap(e.readPersistedJob(a));case 7:i=j.sent;if(!(i==null)){j.next=11;break}d(\"WALogger\").ERROR(K()).sendLogs(\"missing-job-entry\");throw c(\"WAErr\")(\"Persisted job missing for given ID \"+a);case 11:h.deferred.resolve(this.$2(i,e,f));return j.abrupt(\"return\",h.deferred.promise);case 13:case\"end\":return j.stop()}},null,this)};e.$2=function(a,b,c){var e;c===void 0&&(c={});(e=c.eventFlow)==null?void 0:e.addPoint(\"enqueueing_job\",{string:{name:a.type}});return this.getOrchestratorDelegate(((e=a.scheduleConfig)==null?void 0:e.priority)===d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.SKIP,c.eventFlow).enqueue(a.type,this.$4(a,b,c),a.scheduleConfig,c.eventFlow)};e.$5=function(a,b,c){var d=this;c===void 0&&(c={});return b.maybeCreateJob(a).then(function(a){var e;a=a.id;(e=c.eventFlow)==null?void 0:e.addPoint(\"job_persisted\",{\"int\":{jobId:a},bool:{nonPersisted:b===d.inMemoryAccessors}});return a})};e.$1=function(a){var b=this.activeJobs.get(a);if(b!=null)return{alreadyActive:!0,deferred:b};b=new(d(\"WAResolvable\").Resolvable)();this.activeJobs.set(a,b.promise);return{alreadyActive:!1,deferred:b}};e.$4=function(a,b,c){var d=this;return function(){return d.$6(a,b,c)}};e.$7=function(a){var b=this.implementations,c=this.implementationLoaders,d=b.get(a);if(d)return d;d=c.get(a);if(!d)return null;c=d();b.set(a,c);return c};e.$8=function(a,c){if(c==null||c.length===0)return(h||(h=b(\"Promise\"))).resolve();var e=this.stepBlockers,f=e.get(c);f==null&&(f=d(\"WAJobRequirement\").joinRequirements(c.map(function(a){return a()}),T),e.set(c,f));return f(a)};e.$9=function(a,b,c,e,f){var g,h=this;f===void 0&&(f={});var i=a.step;(g=f.eventFlow)==null?void 0:g.addPoint(\"start_step\");var j=b.findIndex(function(a){return a.stepName===i});g=b[j].info(a.current,a.original,U(a,this.isRestartAfterCrash));var k=g.requirements,l=g.code;g=this.$8(a,k);e&&(g=g.then(e));return g.then(function(){var b;d(\"WALogger\").LOG(J(),S(a));(b=f.eventFlow)==null?void 0:b.addPoint(\"run_step\");return l(a.current,a.original,U(a,h.isRestartAfterCrash,f.eventFlow))}).then(function(e){var g;(g=f.eventFlow)==null?void 0:g.addPoint(\"step_is_complete\");if(e instanceof d(\"WAPersistedJobManager\").InterruptJob){d(\"WALogger\").LOG(I(),S(a));return e.result}g=j+1;if(g>=b.length)return e;g=b[g];a.step=g.stepName;a.current=e;a.stepHardStartCountAfterTimeout=0;a.stepFirstStartTime=d(\"WATimeUtils\").unixTime();a.stepUnexpectedErrorCount=0;a.waitUntil=null;a.backedOffCount=0;return c.updatePersistedJob(a).then(function(){return h.$9(a,b,c,void 0,f)})})};e.$6=function(a,c,e){var f,g,i=this,j,k,l,m,n,o,p,q,r,I,J,K,L,M,O;return b(\"regeneratorRuntime\").async(function(P){while(1)switch(P.prev=P.next){case 0:e===void 0&&(e={});j=this.activeJobs,k=this.deprecatedJobs,l=this.listeners,m=l.onJobFinished,n=l.onJobStarted;(f=e.eventFlow)==null?void 0:f.addPoint(\"run_job\");P.next=5;return b(\"regeneratorRuntime\").awrap(this.$7(a.type));case 5:o=P.sent;p=k[a.type];if(o){P.next=23;break}if(p){P.next=15;break}d(\"WALogger\").ERROR(H(),a.type).sendLogs(\"missing-job-implementation\");P.next=12;return b(\"regeneratorRuntime\").awrap(c.deletePersistedJob(a.jobId));case 12:return P.abrupt(\"return\",null);case 15:if(!(p===\"NOOP\")){P.next=20;break}d(\"WALogger\").WARN(G(),a.type);P.next=19;return b(\"regeneratorRuntime\").awrap(c.deletePersistedJob(a.jobId));case 19:return P.abrupt(\"return\",null);case 20:P.next=22;return b(\"regeneratorRuntime\").awrap(p());case 22:o=P.sent;case 23:q=o;p&&d(\"WALogger\").LOG(F(),a.type);r=(g=a.stepFirstStartTime)!=null?g:d(\"WATimeUtils\").unixTime();a.stepFirstStartTime=r;a.stepUnexpectedErrorCount=a.stepUnexpectedErrorCount||0;a.backedOffCount=a.backedOffCount||0;if(!(a.step===d(\"WAPersistedJobManager\").FINISHED_JOB)){P.next=46;break}I=a.waitUntil;J=d(\"WATimeUtils\").secondsUntil(r);if(!(I!=null&&d(\"WATimeUtils\").isInFuture(I)&&J>0)){P.next=40;break}d(\"WALogger\").LOG(E(),Q(a));I=d(\"WATimeUtils\").castToUnixTime(I-J);if(!d(\"WATimeUtils\").isInFuture(I)){P.next=40;break}a.stepFirstStartTime=d(\"WATimeUtils\").castToUnixTime(r-J);a.waitUntil=I;P.next=40;return b(\"regeneratorRuntime\").awrap(c.updatePersistedJob(a));case 40:if(!(I==null||!d(\"WATimeUtils\").isInFuture(I))){P.next=44;break}d(\"WALogger\").LOG(D(),Q(a));P.next=44;return b(\"regeneratorRuntime\").awrap(c.deletePersistedJob(a.jobId));case 44:j[\"delete\"](a.jobId);return P.abrupt(\"return\",a.current);case 46:K=a.step!==d(\"WAPersistedJobManager\").UNSTARTED_JOB?o.find(function(b){return b.stepName===a.step}):o[0];if(K){P.next=52;break}d(\"WALogger\").ERROR(C(),a.type,a.step).sendLogs(\"missing-job-step\");P.next=51;return b(\"regeneratorRuntime\").awrap(c.deletePersistedJob(a.jobId));case 51:return P.abrupt(\"return\",null);case 52:a.step=K.stepName;L=function f(){var g=a.waitUntil,j=(h||(h=b(\"Promise\"))).resolve();if(g!=null){var k=d(\"WATimeUtils\").futureUnixTime(d(\"WATimeUtils\").DAY_SECONDS);g>k?(d(\"WALogger\").LOG(B(),S(a),g,k),a.waitUntil=k,j=c.updatePersistedJob(a).then(function(){return d(\"WATimeUtils\").delayUntil(k)})):(d(\"WALogger\").LOG(A(),S(a),g),j=d(\"WATimeUtils\").delayUntil(g))}return j.then(function(){var b=function(){a.waitUntil=null;d(\"WATimeUtils\").happenedWithin(r,d(\"WATimeUtils\").DAY_SECONDS)||a.stepHardStartCountAfterTimeout++;return c.updatePersistedJob(a)};return i.$9(a,q,c,b,e)[\"catch\"](function(b){if(b instanceof d(\"WAPersistedJobManager\").RetryOnBackoff){var g;d(\"WALogger\").LOG(z(),S(a));(g=e.eventFlow)==null?void 0:g.addPoint(\"retry_on_backoff\");g=d(\"WAPromiseBackoffs\").getDelay(++a.backedOffCount,b.backoffOptions);a.waitUntil=d(\"WATimeUtils\").futureUnixTime(Math.ceil(g\/1e3));a.stepHardStartCountAfterTimeout>0&&--a.stepHardStartCountAfterTimeout;return c.updatePersistedJob(a).then(f)}else{if(a.stepUnexpectedErrorCount<N){(g=e.eventFlow)==null?void 0:g.addPoint(\"retry_on_unexpected_error\");d(\"WALogger\").WARN(y(),S(a),a.stepUnexpectedErrorCount);d(\"WALogger\").WARN(x(),S(a),b);a.stepUnexpectedErrorCount++;return c.updatePersistedJob(a).then(f)}throw b}})})};M=L();O=M.then(function(e){var f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:d(\"WALogger\").LOG(w(),S(a));f=null;try{f=m(a.jobId,a.type,a.original,e)}catch(b){d(\"WALogger\").ERROR(v(),a.type,b).sendLogs(\"onJobFinished-threw\")}if(!(f!=null&&f>0)){g.next=12;break}a.waitUntil=d(\"WATimeUtils\").futureUnixTime(Math.ceil(f\/1e3));a.step=d(\"WAPersistedJobManager\").FINISHED_JOB;a.current=e;a.stepFirstStartTime=d(\"WATimeUtils\").unixTime();g.next=10;return b(\"regeneratorRuntime\").awrap(c.updatePersistedJob(a));case 10:g.next=15;break;case 12:g.next=14;return b(\"regeneratorRuntime\").awrap(c.deletePersistedJob(a.jobId));case 14:j[\"delete\"](a.jobId);case 15:case\"end\":return g.stop()}},null,this)},function(e){var f,g;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:d(\"WALogger\").ERROR(u(),a.type,e).sendLogs(\"job-threw-exception-\"+a.type);f=q.find(function(b){return b.stepName===a.step});if(f){h.next=6;break}d(\"WALogger\").ERROR(t(),a.type,a.step);h.next=10;break;case 6:g=f.info(a.current,a.original,U(a,i.isRestartAfterCrash));if(!(g.stopRetryIf!=null)){h.next=10;break}h.next=10;return b(\"regeneratorRuntime\").awrap(g.stopRetryIf.onStopRetry(a.current,a.original,U(a,i.isRestartAfterCrash)));case 10:h.next=12;return b(\"regeneratorRuntime\").awrap(c.deletePersistedJob(a.jobId));case 12:j[\"delete\"](a.jobId);case 13:case\"end\":return h.stop()}},null,this)});try{n(a.jobId,a.type,a.original)}catch(b){d(\"WALogger\").ERROR(s(),a.type,b).sendLogs(\"onJobStarted-threw\")}return P.abrupt(\"return\",O.then(function(){return M}));case 58:case\"end\":return P.stop()}},null,this)};e.addPersistedJobImplementation=function(a,b){var c=this.implementationLoaders,e=this.deprecatedJobs;if(c.has(a)){d(\"WALogger\").ERROR(r(),a).sendLogs(\"repeat-job-loader\");return}e&&e[a]&&d(\"WALogger\").DEV(q(),a);c.set(a,b)};e.fireAndForget=function(a){var c=this,e=d(\"WABaseGlobals\").getConfig().ignoreForceNonPersistedJobList()||[];if(e.indexOf(a.type)===-1){d(\"WALogger\").LOG(p(),a.type);this.fireAndForgetNonPersisted(a);return}d(\"WALogger\").LOG(o(),a.type);O({code:function(d){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:e={eventFlow:d};f.next=3;return b(\"regeneratorRuntime\").awrap(c.initialJobsPromise);case 3:d.addPoint(\"initial_jobs_promise_fulfilled\");return f.abrupt(\"return\",c.$5(a,c.accessors,e).then(function(a){return c.$3(a,c.accessors,e)}));case 5:case\"end\":return f.stop()}},null,this)},annotations:{string:{name:a.type},bool:{offlineQueueMode:this.offlineQueueMode}}})};e.waitUntilPersisted=function(a){var c=this,e,f;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:e=d(\"WABaseGlobals\").getConfig().ignoreForceNonPersistedJobList()||[];if(!(e.indexOf(a.type)===-1)){g.next=5;break}d(\"WALogger\").LOG(n(),a.type);this.fireAndForgetNonPersisted(a);return g.abrupt(\"return\",(h||(h=b(\"Promise\"))).resolve());case 5:d(\"WALogger\").LOG(m(),a.type);f=P({string:{name:a.type},bool:{offlineQueueMode:this.offlineQueueMode}});g.next=9;return b(\"regeneratorRuntime\").awrap(this.initialJobsPromise);case 9:f.addPoint(\"initial_jobs_promise_fulfilled\");return g.abrupt(\"return\",this.$5(a,this.accessors,{eventFlow:f}).then(function(a){O({code:function(b){b={eventFlow:b};return c.$3(a,c.accessors,b)},eventFlow:f})})[\"catch\"](function(a){f.endFail(\"error\",{string:{error:\"\"+a}});throw a}));case 11:case\"end\":return g.stop()}},null,this)};e.waitUntilCompleted=function(a){var c=this,e=d(\"WABaseGlobals\").getConfig().ignoreForceNonPersistedJobList()||[];if(e.indexOf(a.type)===-1){d(\"WALogger\").LOG(l(),a.type);return this.waitUntilCompletedNonPersisted(a)}d(\"WALogger\").LOG(k(),a.type);return O({code:function(d){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:e={eventFlow:d};f.next=3;return b(\"regeneratorRuntime\").awrap(c.initialJobsPromise);case 3:d.addPoint(\"initial_jobs_promise_fulfilled\");return f.abrupt(\"return\",c.$5(a,c.accessors,e).then(function(a){return c.$3(a,c.accessors,e)}));case 5:case\"end\":return f.stop()}},null,this)},annotations:{string:{name:a.type},bool:{offlineQueueMode:this.offlineQueueMode}}})};e.fireAndForgetNonPersisted=function(a){var c=this;O({code:function(d){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:e={eventFlow:d};f.next=3;return b(\"regeneratorRuntime\").awrap(c.initialJobsPromise);case 3:d.addPoint(\"initial_jobs_promise_fulfilled\");return f.abrupt(\"return\",c.$5(a,c.inMemoryAccessors,e).then(function(a){return c.$3(a,c.inMemoryAccessors,e)}));case 5:case\"end\":return f.stop()}},null,this)},annotations:{string:{name:a.type},bool:{offlineQueueMode:this.offlineQueueMode}}})};e.waitUntilCompletedNonPersisted=function(a){var c=this;return O({code:function(d){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:e={eventFlow:d};f.next=3;return b(\"regeneratorRuntime\").awrap(c.initialJobsPromise);case 3:d.addPoint(\"initial_jobs_promise_fulfilled\");return f.abrupt(\"return\",c.$5(a,c.inMemoryAccessors,e).then(function(a){return c.$3(a,c.inMemoryAccessors,e)}));case 5:case\"end\":return f.stop()}},null,this)},annotations:{string:{name:a.type},bool:{offlineQueueMode:this.offlineQueueMode}}})};return a}();function Q(a){return\"Job[\"+a.jobId+\"] (\"+a.type+\")\"}function R(a){return\"[Job \"+a.type+\"] \"}function S(a){return\"Job[\"+a.jobId+\"] (\"+a.type+\".\"+a.step+\")\"}function T(a,b,c){a===\"unsatisfiable\"?d(\"WALogger\").LOG(j(),S(c),b):a===\"unsatisfied\"?d(\"WALogger\").LOG(i(),S(c),b):a}function U(a,b,c){b===void 0&&(b=!1);return{jobStartTime:a.startTime,afterCrash:b,interruptJob:V,eventFlow:c}}function V(a){return new(d(\"WAPersistedJobManager\").InterruptJob)(a)}g.PersistedJobManager=a}),98);\n__d(\"WASmaxInDevicesFetchResponseError\",[\"WAResultOrError\",\"WASmaxInDevicesIQErrorResponseMixin\",\"WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInDevicesIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup\").parseRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup(c.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{errorRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup:b.value}))}g.parseFetchResponseError=a}),98);\n__d(\"WASmaxInDevicesFetchNonRetryableUserErrorMixin\",[\"WASmaxInDevicesIQErrorItemNotFoundMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxInDevicesIQErrorItemNotFoundMixin\").parseIQErrorItemNotFoundMixin(a);return!b.success?b:b}g.parseFetchNonRetryableUserErrorMixin=a}),98);\n__d(\"WASmaxInDevicesFetchRetryableUserErrorMixin\",[\"WAResultOrError\",\"WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup\").parseIQErrorInternalServerErrorOrServiceUnavailableMixinGroup(a);return!b.success?b:d(\"WAResultOrError\").makeResult({iQErrorInternalServerErrorOrServiceUnavailableMixinGroup:b.value})}g.parseFetchRetryableUserErrorMixin=a}),98);\n__d(\"WASmaxInDevicesFetchOrFetchNonRetryableUserErrorMixinGroup\",[\"WAResultOrError\",\"WASmaxInDevicesFetchNonRetryableUserErrorMixin\",\"WASmaxInDevicesFetchRetryableUserErrorMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInDevicesFetchRetryableUserErrorMixin\").parseFetchRetryableUserErrorMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"FetchRetryableUserError\",value:b.value});var c=d(\"WASmaxInDevicesFetchNonRetryableUserErrorMixin\").parseFetchNonRetryableUserErrorMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"FetchNonRetryableUserError\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"RetryableUserError\",\"NonRetryableUserError\"],[b,c])}g.parseFetchOrFetchNonRetryableUserErrorMixinGroup=a}),98);\n__d(\"WASmaxInDevicesFetchUserResponseFailureMixin\",[\"WAResultOrError\",\"WASmaxInDevicesFetchOrFetchNonRetryableUserErrorMixinGroup\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"user\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!b.success)return b;a=d(\"WASmaxParseJid\").attrUserJid(a,\"jid\");if(!a.success)return a;b=d(\"WASmaxInDevicesFetchOrFetchNonRetryableUserErrorMixinGroup\").parseFetchOrFetchNonRetryableUserErrorMixinGroup(b.value);return!b.success?b:d(\"WAResultOrError\").makeResult({jid:a.value,errorFetchOrFetchNonRetryableUserErrorMixinGroup:b.value})}g.parseFetchUserResponseFailureMixin=a}),98);\n__d(\"WASmaxInDevicesFetchUserResponseSuccessMixin\",[\"WAResultOrError\",\"WASmaxInDevicesDeviceListMixin\",\"WASmaxInDevicesICDCFromServerMixin\",\"WASmaxParseJid\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"devices\");if(!b.success)return b;b=d(\"WASmaxInDevicesDeviceListMixin\").parseDeviceListMixin(a);return!b.success?b:b}function i(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"icdc\");if(!b.success)return b;b=d(\"WASmaxInDevicesICDCFromServerMixin\").parseICDCFromServerMixin(a);return!b.success?b:b}function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"user\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"devices\",h);if(!b.success)return b;var c=d(\"WASmaxParseUtils\").optionalChildWithTag(a,\"icdc\",i);if(!c.success)return c;a=d(\"WASmaxParseJid\").attrUserJid(a,\"jid\");return!a.success?a:d(\"WAResultOrError\").makeResult({jid:a.value,devices:b.value,icdc:c.value})}g.parseFetchUserResponseSuccessDevices=h;g.parseFetchUserResponseSuccessIcdc=i;g.parseFetchUserResponseSuccessMixin=a}),98);\n__d(\"WASmaxInDevicesUserResponseFetchFailureOrFetchSuccessMixinGroup\",[\"WAResultOrError\",\"WASmaxInDevicesFetchUserResponseFailureMixin\",\"WASmaxInDevicesFetchUserResponseSuccessMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInDevicesFetchUserResponseFailureMixin\").parseFetchUserResponseFailureMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"FetchUserResponseFailure\",value:b.value});var c=d(\"WASmaxInDevicesFetchUserResponseSuccessMixin\").parseFetchUserResponseSuccessMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"FetchUserResponseSuccess\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"UserResponseFailure\",\"UserResponseSuccess\"],[b,c])}g.parseUserResponseFetchFailureOrFetchSuccessMixinGroup=a}),98);\n__d(\"WASmaxInDevicesFetchUserResponseMixin\",[\"WAResultOrError\",\"WASmaxInDevicesUserResponseFetchFailureOrFetchSuccessMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"user\");if(!b.success)return b;b=d(\"WASmaxInDevicesUserResponseFetchFailureOrFetchSuccessMixinGroup\").parseUserResponseFetchFailureOrFetchSuccessMixinGroup(a);return!b.success?b:d(\"WAResultOrError\").makeResult({userResponseFetchFailureOrFetchSuccessMixinGroup:b.value})}g.parseFetchUserResponseMixin=a}),98);\n__d(\"WASmaxInDevicesFetchResponseSuccess\",[\"WAResultOrError\",\"WASmaxInDevicesFetchUserResponseMixin\",\"WASmaxInDevicesIQResultResponseMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function h(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"user\");if(!b.success)return b;b=d(\"WASmaxInDevicesFetchUserResponseMixin\").parseFetchUserResponseMixin(a);return!b.success?b:b}function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"users\");if(!c.success)return c;a=d(\"WASmaxInDevicesIQResultResponseMixin\").parseIQResultResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxParseUtils\").mapChildrenWithTag(c.value,\"user\",0,25,h);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{usersUser:b.value}))}g.parseFetchResponseSuccessUsersUser=h;g.parseFetchResponseSuccess=a}),98);\n__d(\"WASmaxOutDevicesDhashMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyDhash;a=d(\"WASmaxJsx\").smax(\"smax$any\",{dhash:d(\"WAWap\").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeDhashMixin=a}),98);\n__d(\"WASmaxOutDevicesICDCSeqMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.anySeq;a=d(\"WASmaxJsx\").smax(\"smax$any\",{seq:d(\"WAWap\").INT(a)});return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeICDCSeqMixin=a}),98);\n__d(\"WASmaxOutDevicesFetchRequest\",[\"WASmaxChildren\",\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutDevicesBaseIQGetRequestMixin\",\"WASmaxOutDevicesDhashMixin\",\"WASmaxOutDevicesICDCSeqMixin\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.userJid,c=a.dhashMixinArgs;a=a.iCDCSeqMixinArgs;b=d(\"WASmaxMixins\").optionalMerge(d(\"WASmaxOutDevicesICDCSeqMixin\").mergeICDCSeqMixin,d(\"WASmaxMixins\").optionalMerge(d(\"WASmaxOutDevicesDhashMixin\").mergeDhashMixin,d(\"WASmaxJsx\").smax(\"user\",{jid:d(\"WAWap\").USER_JID(b)}),c),a);return b}function a(a){a=a.userArgs;a=d(\"WASmaxOutDevicesBaseIQGetRequestMixin\").mergeBaseIQGetRequestMixin(d(\"WASmaxJsx\").smax(\"iq\",{to:d(\"WAWap\").S_WHATSAPP_NET,xmlns:\"fbid:devices\"},d(\"WASmaxJsx\").smax(\"users\",null,d(\"WASmaxChildren\").REPEATED_CHILD(h,a,1,25))));return a}g.makeFetchRequestUsersUser=h;g.makeFetchRequest=a}),98);\n__d(\"WASmaxDevicesFetchRPC\",[\"WAComms\",\"WASmaxInDevicesFetchResponseError\",\"WASmaxInDevicesFetchResponseSuccess\",\"WASmaxOutDevicesFetchRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:e=d(\"WASmaxOutDevicesFetchRequest\").makeFetchRequest(a);i.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(e,c));case 3:f=i.sent;g=d(\"WASmaxInDevicesFetchResponseSuccess\").parseFetchResponseSuccess(f,e);if(!g.success){i.next=7;break}return i.abrupt(\"return\",{name:\"FetchResponseSuccess\",value:g.value});case 7:h=d(\"WASmaxInDevicesFetchResponseError\").parseFetchResponseError(f,e);if(!h.success){i.next=10;break}return i.abrupt(\"return\",{name:\"FetchResponseError\",value:h.value});case 10:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Fetch\",{Success:g,Error:h}));case 11:case\"end\":return i.stop()}},null,this)}g.sendFetchRPC=a}),98);\n__d(\"WASmaxInDevicesNotifyResponseError\",[\"WAResultOrError\",\"WASmaxInDevicesIQErrorResponseMixin\",\"WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInDevicesIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup\").parseRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup(c.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{errorRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup:b.value}))}g.parseNotifyResponseError=a}),98);\n__d(\"WASmaxInDevicesNotifyResponseSuccess\",[\"WASmaxInDevicesIQResultResponseMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxInDevicesIQResultResponseMixin\").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseNotifyResponseSuccess=a}),98);\n__d(\"WASmaxOutDevicesNotifyRequest\",[\"WASmaxChildren\",\"WASmaxJsx\",\"WASmaxOutDevicesBaseIQSetRequestMixin\",\"WAWap\"],(function(a,b,c,d,e,f,g){function h(a){a=a.userJid;a=d(\"WASmaxJsx\").smax(\"user\",{jid:d(\"WAWap\").USER_JID(a)});return a}function a(a){a=a.userArgs;a=d(\"WASmaxOutDevicesBaseIQSetRequestMixin\").mergeBaseIQSetRequestMixin(d(\"WASmaxJsx\").smax(\"iq\",{to:d(\"WAWap\").S_WHATSAPP_NET,xmlns:\"fbid:devices\"},d(\"WASmaxJsx\").smax(\"users\",null,d(\"WASmaxChildren\").REPEATED_CHILD(h,a,1,25))));return a}g.makeNotifyRequestUsersUser=h;g.makeNotifyRequest=a}),98);\n__d(\"WASmaxDevicesNotifyRPC\",[\"WAComms\",\"WASmaxInDevicesNotifyResponseError\",\"WASmaxInDevicesNotifyResponseSuccess\",\"WASmaxOutDevicesNotifyRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h;return b(\"regeneratorRuntime\").async(function(i){while(1)switch(i.prev=i.next){case 0:e=d(\"WASmaxOutDevicesNotifyRequest\").makeNotifyRequest(a);i.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(e,c));case 3:f=i.sent;g=d(\"WASmaxInDevicesNotifyResponseSuccess\").parseNotifyResponseSuccess(f,e);if(!g.success){i.next=7;break}return i.abrupt(\"return\",{name:\"NotifyResponseSuccess\",value:g.value});case 7:h=d(\"WASmaxInDevicesNotifyResponseError\").parseNotifyResponseError(f,e);if(!h.success){i.next=10;break}return i.abrupt(\"return\",{name:\"NotifyResponseError\",value:h.value});case 10:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Notify\",{Success:g,Error:h}));case 11:case\"end\":return i.stop()}},null,this)}g.sendNotifyRPC=a}),98);\n__d(\"WASmaxInPreKeysRequestErrors\",[\"WAResultOrError\",\"WASmaxInPreKeysIQErrorFallbackClientMixin\",\"WASmaxInPreKeysIQErrorNotAcceptableMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInPreKeysIQErrorNotAcceptableMixin\").parseIQErrorNotAcceptableMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"IQErrorNotAcceptable\",value:b.value});var c=d(\"WASmaxInPreKeysIQErrorFallbackClientMixin\").parseIQErrorFallbackClientMixin(a);return c.success?d(\"WAResultOrError\").makeResult({name:\"IQErrorFallbackClient\",value:c.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"IQErrorNotAcceptable\",\"IQErrorFallbackClient\"],[b,c])}g.parseRequestErrors=a}),98);\n__d(\"WASmaxInPreKeysRotateSignedResponseRequestError\",[\"WAResultOrError\",\"WASmaxInPreKeysIQErrorResponseMixin\",\"WASmaxInPreKeysRequestErrors\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInPreKeysIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInPreKeysRequestErrors\").parseRequestErrors(c.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{errorRequestErrors:b.value}))}g.parseRotateSignedResponseRequestError=a}),98);\n__d(\"WASmaxInPreKeysRotateSignedResponseServerError\",[\"WAResultOrError\",\"WASmaxInPreKeysIQErrorResponseMixin\",\"WASmaxInPreKeysServerErrors\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInPreKeysIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInPreKeysServerErrors\").parseServerErrors(c.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{errorServerErrors:b.value}))}g.parseRotateSignedResponseServerError=a}),98);\n__d(\"WASmaxInPreKeysRotateSignedResponseSuccess\",[\"WASmaxInPreKeysIQResultResponseMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxInPreKeysIQResultResponseMixin\").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseRotateSignedResponseSuccess=a}),98);\n__d(\"WASmaxInPreKeysRotateSignedResponseValidationError\",[\"WAResultOrError\",\"WASmaxInPreKeysIQErrorResponseMixin\",\"WASmaxInPreKeysIdentityKeyMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").attrString(c.value,\"text\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").attrIntRange(c.value,\"code\",400,499);if(!f.success)return f;c=d(\"WASmaxInPreKeysIdentityKeyMixin\").parseIdentityKeyMixin(c.value);if(!c.success)return c;a=d(\"WASmaxInPreKeysIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);return!a.success?a:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({errorText:e.value,errorCode:f.value,errorIdentityKeyMixin:c.value},a.value))}g.parseRotateSignedResponseValidationError=a}),98);\n__d(\"WASmaxOutPreKeysKeyDataMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyElementValue;a=d(\"WASmaxJsx\").smax(\"smax$any\",null,a);return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeKeyDataMixin=a}),98);\n__d(\"WASmaxOutPreKeysKeyIDMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.idElementValue;a=d(\"WASmaxJsx\").smax(\"id\",null,a);return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeKeyIDMixin=a}),98);\n__d(\"WASmaxOutPreKeysSignedPreKeyMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutPreKeysKeyDataMixin\",\"WASmaxOutPreKeysKeyIDMixin\"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.keyIDMixinArgs,e=a.keyDataMixinArgs;a=a.signatureElementValue;c=(b=d(\"WASmaxJsx\")).smax(\"smax$any\",null,b.smax(\"skey\",null,d(\"WASmaxOutPreKeysKeyIDMixin\").mergeKeyIDMixin(b.smax(\"id\",null),c),d(\"WASmaxOutPreKeysKeyDataMixin\").mergeKeyDataMixin(b.smax(\"value\",null),e),b.smax(\"signature\",null,a)));return c}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeSignedPreKeyMixin=a}),98);\n__d(\"WASmaxOutPreKeysRotateSignedRequest\",[\"WASmaxJsx\",\"WASmaxOutPreKeysClientRequestMixin\",\"WASmaxOutPreKeysSignedPreKeyMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=a.signedPreKeyMixinArgs;a=d(\"WASmaxOutPreKeysClientRequestMixin\").mergeClientRequestMixin(d(\"WASmaxJsx\").smax(\"iq\",{type:\"set\"},d(\"WASmaxOutPreKeysSignedPreKeyMixin\").mergeSignedPreKeyMixin(d(\"WASmaxJsx\").smax(\"rotate\",null),a)));return a}g.makeRotateSignedRequest=a}),98);\n__d(\"WASmaxPreKeysRotateSignedRPC\",[\"WAComms\",\"WASmaxInPreKeysRotateSignedResponseRequestError\",\"WASmaxInPreKeysRotateSignedResponseServerError\",\"WASmaxInPreKeysRotateSignedResponseSuccess\",\"WASmaxInPreKeysRotateSignedResponseValidationError\",\"WASmaxOutPreKeysRotateSignedRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:e=d(\"WASmaxOutPreKeysRotateSignedRequest\").makeRotateSignedRequest(a);k.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(e,c));case 3:f=k.sent;g=d(\"WASmaxInPreKeysRotateSignedResponseSuccess\").parseRotateSignedResponseSuccess(f,e);if(!g.success){k.next=7;break}return k.abrupt(\"return\",{name:\"RotateSignedResponseSuccess\",value:g.value});case 7:h=d(\"WASmaxInPreKeysRotateSignedResponseValidationError\").parseRotateSignedResponseValidationError(f,e);if(!h.success){k.next=10;break}return k.abrupt(\"return\",{name:\"RotateSignedResponseValidationError\",value:h.value});case 10:i=d(\"WASmaxInPreKeysRotateSignedResponseRequestError\").parseRotateSignedResponseRequestError(f,e);if(!i.success){k.next=13;break}return k.abrupt(\"return\",{name:\"RotateSignedResponseRequestError\",value:i.value});case 13:j=d(\"WASmaxInPreKeysRotateSignedResponseServerError\").parseRotateSignedResponseServerError(f,e);if(!j.success){k.next=16;break}return k.abrupt(\"return\",{name:\"RotateSignedResponseServerError\",value:j.value});case 16:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"RotateSigned\",{Success:g,ValidationError:h,RequestError:i,ServerError:j}));case 17:case\"end\":return k.stop()}},null,this)}g.sendRotateSignedRPC=a}),98);\n__d(\"WASmaxInPreKeysSetVnameFailureBadRequestMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"bad-request\");return!b.success?b:d(\"WAResultOrError\").makeResult({text:b.value})}g.parseSetVnameFailureBadRequestMixin=a}),98);\n__d(\"WASmaxInPreKeysSetVnameFailureFallbackMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").attrString(a,\"text\");return!b.success?b:d(\"WAResultOrError\").makeResult({text:b.value})}g.parseSetVnameFailureFallbackMixin=a}),98);\n__d(\"WASmaxInPreKeysSetVnameFailureInternalServerErrorMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"internal-server-error\");return!b.success?b:d(\"WAResultOrError\").makeResult({text:b.value})}g.parseSetVnameFailureInternalServerErrorMixin=a}),98);\n__d(\"WASmaxInPreKeysSetVnameFailureNotAcceptableMixin\",[\"WAResultOrError\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxParseUtils\").assertTag(a,\"error\");if(!b.success)return b;b=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"violation\");if(!b.success)return b;a=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrString,a,\"text\",\"not-acceptable\");if(!a.success)return a;var c=d(\"WASmaxParseUtils\").attrString(b.value,\"reason\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrInt,b.value,\"max\");if(!e.success)return e;b=d(\"WASmaxParseUtils\").optional(d(\"WASmaxParseUtils\").attrInt,b.value,\"length\");return!b.success?b:d(\"WAResultOrError\").makeResult({text:a.value,violationReason:c.value,violationMax:e.value,violationLength:b.value})}g.parseSetVnameFailureNotAcceptableMixin=a}),98);\n__d(\"WASmaxInPreKeysVnameFailures\",[\"WAResultOrError\",\"WASmaxInPreKeysSetVnameFailureBadRequestMixin\",\"WASmaxInPreKeysSetVnameFailureFallbackMixin\",\"WASmaxInPreKeysSetVnameFailureInternalServerErrorMixin\",\"WASmaxInPreKeysSetVnameFailureNotAcceptableMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a){var b=d(\"WASmaxInPreKeysSetVnameFailureNotAcceptableMixin\").parseSetVnameFailureNotAcceptableMixin(a);if(b.success)return d(\"WAResultOrError\").makeResult({name:\"SetVnameFailureNotAcceptable\",value:b.value});var c=d(\"WASmaxInPreKeysSetVnameFailureBadRequestMixin\").parseSetVnameFailureBadRequestMixin(a);if(c.success)return d(\"WAResultOrError\").makeResult({name:\"SetVnameFailureBadRequest\",value:c.value});var e=d(\"WASmaxInPreKeysSetVnameFailureInternalServerErrorMixin\").parseSetVnameFailureInternalServerErrorMixin(a);if(e.success)return d(\"WAResultOrError\").makeResult({name:\"SetVnameFailureInternalServerError\",value:e.value});var f=d(\"WASmaxInPreKeysSetVnameFailureFallbackMixin\").parseSetVnameFailureFallbackMixin(a);return f.success?d(\"WAResultOrError\").makeResult({name:\"SetVnameFailureFallback\",value:f.value}):d(\"WASmaxParseUtils\").errorMixinDisjunction(a,[\"VnameFailureNotAcceptable\",\"VnameFailureBadRequest\",\"VnameFailureInternalServerError\",\"VnameFailureFallback\"],[b,c,e,f])}g.parseVnameFailures=a}),98);\n__d(\"WASmaxInPreKeysSetResponsePreKeySuccessVnameFailure\",[\"WAResultOrError\",\"WASmaxInPreKeysIQErrorResponseMixin\",\"WASmaxInPreKeysVnameFailures\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;var e=d(\"WASmaxParseUtils\").flattenedChildWithTag(c.value,\"error\");if(!e.success)return e;var f=d(\"WASmaxParseUtils\").attrString(c.value,\"text\");if(!f.success)return f;c=d(\"WASmaxParseUtils\").literal(d(\"WASmaxParseUtils\").attrInt,c.value,\"code\",207);if(!c.success)return c;var g=d(\"WASmaxParseUtils\").attrIntRange(e.value,\"code\",400,599);if(!g.success)return g;a=d(\"WASmaxInPreKeysIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInPreKeysVnameFailures\").parseVnameFailures(e.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({errorText:f.value,errorCode:c.value,errorErrorCode:g.value},a.value,{errorErrorVnameFailures:b.value}))}g.parseSetResponsePreKeySuccessVnameFailure=a}),98);\n__d(\"WASmaxInPreKeysSetResponseRequestError\",[\"WAResultOrError\",\"WASmaxInPreKeysIQErrorResponseMixin\",\"WASmaxInPreKeysRequestErrors\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInPreKeysIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInPreKeysRequestErrors\").parseRequestErrors(c.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{errorRequestErrors:b.value}))}g.parseSetResponseRequestError=a}),98);\n__d(\"WASmaxInPreKeysSetResponseServerError\",[\"WAResultOrError\",\"WASmaxInPreKeysIQErrorResponseMixin\",\"WASmaxInPreKeysServerErrors\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxParseUtils\").flattenedChildWithTag(a,\"error\");if(!c.success)return c;a=d(\"WASmaxInPreKeysIQErrorResponseMixin\").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d(\"WASmaxInPreKeysServerErrors\").parseServerErrors(c.value);return!b.success?b:d(\"WAResultOrError\").makeResult(babelHelpers[\"extends\"]({},a.value,{errorServerErrors:b.value}))}g.parseSetResponseServerError=a}),98);\n__d(\"WASmaxInPreKeysSetResponseSuccess\",[\"WASmaxInPreKeysIQResultResponseMixin\",\"WASmaxParseUtils\"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d(\"WASmaxParseUtils\").assertTag(a,\"iq\");if(!c.success)return c;c=d(\"WASmaxInPreKeysIQResultResponseMixin\").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseSetResponseSuccess=a}),98);\n__d(\"WASmaxOutPreKeysIdentityKeyMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutPreKeysKeyDataMixin\"],(function(a,b,c,d,e,f,g){function h(a){a=d(\"WASmaxJsx\").smax(\"smax$any\",null,d(\"WASmaxOutPreKeysKeyDataMixin\").mergeKeyDataMixin(d(\"WASmaxJsx\").smax(\"identity\",null),a));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeIdentityKeyMixin=a}),98);\n__d(\"WASmaxOutPreKeysKeyTypeMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(){var a=d(\"WASmaxJsx\").smax(\"smax$any\",null,d(\"WASmaxJsx\").smax(\"type\",null,new Uint8Array([5])));return a}function a(a){var b=h();return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeKeyTypeMixin=a}),98);\n__d(\"WASmaxOutPreKeysPreKeyListMixin\",[\"WASmaxChildren\",\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutPreKeysKeyDataMixin\",\"WASmaxOutPreKeysKeyIDMixin\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.keyIDMixinArgs;a=a.keyDataMixinArgs;b=d(\"WASmaxJsx\").smax(\"key\",null,d(\"WASmaxOutPreKeysKeyIDMixin\").mergeKeyIDMixin(d(\"WASmaxJsx\").smax(\"id\",null),b),d(\"WASmaxOutPreKeysKeyDataMixin\").mergeKeyDataMixin(d(\"WASmaxJsx\").smax(\"value\",null),a));return b}function i(a){a=a.keyArgs;a=d(\"WASmaxJsx\").smax(\"smax$any\",null,d(\"WASmaxJsx\").smax(\"list\",null,d(\"WASmaxChildren\").REPEATED_CHILD(h,a,0,2e4)));return a}function a(a,b){b=i(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.makePreKeyListListKey=h;g.mergePreKeyListMixin=a}),98);\n__d(\"WASmaxOutPreKeysRegistrationIDMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.registrationElementValue;a=d(\"WASmaxJsx\").smax(\"smax$any\",null,d(\"WASmaxJsx\").smax(\"registration\",null,a));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeRegistrationIDMixin=a}),98);\n__d(\"WASmaxOutPreKeysVerifiedNameMixin\",[\"WASmaxJsx\",\"WASmaxMixins\"],(function(a,b,c,d,e,f,g){function h(a){a=a.verifiedNameElementValue;a=d(\"WASmaxJsx\").smax(\"smax$any\",null,d(\"WASmaxJsx\").smax(\"verified_name\",null,a));return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeVerifiedNameMixin=a}),98);\n__d(\"WASmaxOutPreKeysIdentityKeyBundleMixin\",[\"WASmaxJsx\",\"WASmaxMixins\",\"WASmaxOutPreKeysIdentityKeyMixin\",\"WASmaxOutPreKeysKeyTypeMixin\",\"WASmaxOutPreKeysPreKeyListMixin\",\"WASmaxOutPreKeysRegistrationIDMixin\",\"WASmaxOutPreKeysSignedPreKeyMixin\",\"WASmaxOutPreKeysVerifiedNameMixin\"],(function(a,b,c,d,e,f,g){function h(a){var b=a.verifiedNameMixinArgs;a=d(\"WASmaxMixins\").optionalMerge(d(\"WASmaxOutPreKeysVerifiedNameMixin\").mergeVerifiedNameMixin,d(\"WASmaxOutPreKeysKeyTypeMixin\").mergeKeyTypeMixin(d(\"WASmaxOutPreKeysSignedPreKeyMixin\").mergeSignedPreKeyMixin(d(\"WASmaxOutPreKeysPreKeyListMixin\").mergePreKeyListMixin(d(\"WASmaxOutPreKeysIdentityKeyMixin\").mergeIdentityKeyMixin(d(\"WASmaxOutPreKeysRegistrationIDMixin\").mergeRegistrationIDMixin(d(\"WASmaxJsx\").smax(\"smax$any\",null),a),a),a),a)),b);return a}function a(a,b){b=h(b);return d(\"WASmaxMixins\").mergeStanzas(a,b)}g.mergeIdentityKeyBundleMixin=a}),98);\n__d(\"WASmaxOutPreKeysSetRequest\",[\"WASmaxJsx\",\"WASmaxOutPreKeysClientRequestMixin\",\"WASmaxOutPreKeysIdentityKeyBundleMixin\"],(function(a,b,c,d,e,f,g){function a(a){a=d(\"WASmaxOutPreKeysIdentityKeyBundleMixin\").mergeIdentityKeyBundleMixin(d(\"WASmaxOutPreKeysClientRequestMixin\").mergeClientRequestMixin(d(\"WASmaxJsx\").smax(\"iq\",{type:\"set\"})),a);return a}g.makeSetRequest=a}),98);\n__d(\"WASmaxPreKeysSetRPC\",[\"WAComms\",\"WASmaxInPreKeysSetResponsePreKeySuccessVnameFailure\",\"WASmaxInPreKeysSetResponseRequestError\",\"WASmaxInPreKeysSetResponseServerError\",\"WASmaxInPreKeysSetResponseSuccess\",\"WASmaxOutPreKeysSetRequest\",\"WASmaxParsingFailure\",\"WASmaxRpcUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:e=d(\"WASmaxOutPreKeysSetRequest\").makeSetRequest(a);k.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").sendSmaxStanza(e,c));case 3:f=k.sent;g=d(\"WASmaxInPreKeysSetResponseSuccess\").parseSetResponseSuccess(f,e);if(!g.success){k.next=7;break}return k.abrupt(\"return\",{name:\"SetResponseSuccess\",value:g.value});case 7:h=d(\"WASmaxInPreKeysSetResponsePreKeySuccessVnameFailure\").parseSetResponsePreKeySuccessVnameFailure(f,e);if(!h.success){k.next=10;break}return k.abrupt(\"return\",{name:\"SetResponsePreKeySuccessVnameFailure\",value:h.value});case 10:i=d(\"WASmaxInPreKeysSetResponseRequestError\").parseSetResponseRequestError(f,e);if(!i.success){k.next=13;break}return k.abrupt(\"return\",{name:\"SetResponseRequestError\",value:i.value});case 13:j=d(\"WASmaxInPreKeysSetResponseServerError\").parseSetResponseServerError(f,e);if(!j.success){k.next=16;break}return k.abrupt(\"return\",{name:\"SetResponseServerError\",value:j.value});case 16:throw new(d(\"WASmaxParsingFailure\").SmaxParsingFailure)(d(\"WASmaxRpcUtils\").errorMessageRpcParsing(\"Set\",{Success:g,PreKeySuccessVnameFailure:h,RequestError:i,ServerError:j}));case 17:case\"end\":return k.stop()}},null,this)}g.sendSetRPC=a}),98);\n__d(\"WASmaxOutPresenceAvailabilityRequest\",[\"WASmaxAttrs\",\"WASmaxJsx\",\"WAWap\"],(function(a,b,c,d,e,f,g){function a(a){var b=a.presenceType;a=a.presenceName;b=d(\"WASmaxJsx\").smax(\"presence\",{type:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").CUSTOM_STRING,b),name:d(\"WASmaxAttrs\").OPTIONAL(d(\"WAWap\").CUSTOM_STRING,a)});return b}g.makeAvailabilityRequest=a}),98);\n__d(\"WASmaxPresenceAvailabilityRPC\",[\"WAComms\",\"WASmaxOutPresenceAvailabilityRequest\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){function a(a){var c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:c=d(\"WASmaxOutPresenceAvailabilityRequest\").makeAvailabilityRequest(a);e.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WAComms\").castSmaxStanza(c));case 3:case\"end\":return e.stop()}},null,this)}g.sendAvailabilityRPC=a}),98);\n__d(\"WAComputeAndUploadICDCInfo\",[\"WABase64\",\"WADeprecatedSendIq\",\"WADeprecatedWapParser\",\"WADevicesState\",\"WAGlobals\",\"WAICDCUtils\",\"WAIdentityUtils\",\"WAJobDefinitions\",\"WAJobOrchestratorTypes\",\"WAJobs\",\"WALogger\",\"WAWap\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Cannot update ICDC for user, because of \",\" server response\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Loading identities fails with error: \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"computeAndUploadICDCInfo called \",\"\"]);j=function(){return a};return a}var k=new(c(\"WADeprecatedWapParser\"))(\"parseUploadICDCInfoResponse\",function(a){a.assertTag(\"iq\"),a.assertFromServer(),a.assertAttr(\"type\",\"result\")});a=function(a){var c,e,f,g,l,m,n,o,p,q,r,s,t;return b(\"regeneratorRuntime\").async(function(u){while(1)switch(u.prev=u.next){case 0:c=a.reason,e=a.caller,f=a.sequence;d(\"WALogger\").LOG(j(),f);u.prev=2;u.next=5;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getWaOneQueue().enqueue(function(e){var f,c,a;return b(\"regeneratorRuntime\").async(function(g){while(1)switch(g.prev=g.next){case 0:f=e.cryptoManager;g.next=3;return b(\"regeneratorRuntime\").awrap(f.storage.loadIdentities(d(\"WAGlobals\").getMyUserJid()));case 3:c=g.sent;a=f.regInfo;return g.abrupt(\"return\",{regInfo:a,identities:Array.from(c.values())});case 6:case\"end\":return g.stop()}},null,this)},{operationType:\"icdc_load_identities\",flush:!1,afterInit:!0}));case 5:g=u.sent;u.next=11;break;case 8:u.prev=8,u.t0=u[\"catch\"](2),d(\"WALogger\").ERROR(i(),u.t0.toString());case 11:if(!(g==null)){u.next=13;break}return u.abrupt(\"return\");case 13:l=g,m=l.regInfo,n=l.identities;o=d(\"WAICDCUtils\").computeICDCInfoForUpload(m.staticKeyPair,f,n,c,e),p=o.icdcInfo,q=o.encodedSignedICDC;u.next=17;return b(\"regeneratorRuntime\").awrap(d(\"WAIdentityUtils\").computeIdentitiesHash(n));case 17:r=u.sent;s=d(\"WAWap\").wap(\"iq\",{id:d(\"WAWap\").generateId(),to:d(\"WAWap\").S_WHATSAPP_NET,type:\"set\",xmlns:\"fbid:devices\"},d(\"WAWap\").wap(\"icdc\",{ihash:d(\"WAWap\").CUSTOM_STRING(d(\"WABase64\").encodeB64(r)),seq:d(\"WAWap\").INT(p.seq),ts:d(\"WAWap\").INT(p.timestamp)},q));u.next=21;return b(\"regeneratorRuntime\").awrap(d(\"WADeprecatedSendIq\").deprecatedSendIq(s,k));case 21:t=u.sent;if(!t.success){u.next=27;break}u.next=25;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return a.storage.saveICDC(d(\"WAGlobals\").getMyUserJid(),{sequence:p.seq,timestamp:p.timestamp,devices:p.devices,signingDeviceIndex:p.signingDeviceIndex,dirty:!1})},{operationType:\"save_icdc\",flush:!0,afterInit:!0}));case 25:u.next=35;break;case 27:if(!(t.errorCode===406||t.errorCode===500)){u.next=34;break}u.next=30;return b(\"regeneratorRuntime\").awrap(d(\"WADevicesState\").getDevicesState().reset([d(\"WAGlobals\").getMyUserJid()]));case 30:u.next=32;return b(\"regeneratorRuntime\").awrap(d(\"WAJobs\").getJobManager().waitUntilPersisted(d(\"WAJobDefinitions\").createStartJobInfo(\"getDevices\",{ignoreDhash:!1,reason:\"compute-Upload-icdc\",scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.LOW},users:new Set().add(d(\"WAGlobals\").getMyUserJid())})));case 32:u.next=35;break;case 34:d(\"WALogger\").WARN(h(),t.errorCode);case 35:case\"end\":return u.stop()}},null,this,[[2,8]])};e=d(\"WAJobs\").getPersistedJobsApi().definePersistedJob().finalStep(\"computeAndUploadICDCInfo\",a).end();g.computeAndUploadICDCInfo=e}),98);\n__d(\"WAMakeSignedPreKeyMixin\",[\"WAWap\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b={idElementValue:d(\"WAWap\").BIG_ENDIAN_CONTENT(a.id,3)},c={anyElementValue:a.keyPair.publicKey};a=a.signature;return{keyIDMixinArgs:b,keyDataMixinArgs:c,signatureElementValue:a}}g.makeSignedPreKeyMixin=a}),98);\n__d(\"WAGenerateAndUploadPreKeysProtocol\",[\"WACryptoManager\",\"WAGetKeysForUpload\",\"WAGlobals\",\"WAMakeSignedPreKeyMixin\",\"WAPromiseRetryLoop\",\"WAResultOrError\",\"WARetryUtils\",\"WASmaxPreKeysSetRPC\",\"WATagsLogger\",\"WAWap\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Got unexpected error: \",\", will retry after backoff\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Got Malformed upload keys IQ on upload pre keys attempt\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Keys are successfully uploaded\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Attempt to upload keys\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to generate prekeys with error \",\" details: \",\"}\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"About to upload pre keys\"]);m=function(){return a};return a}var n=d(\"WATagsLogger\").TAGS([\"generateAndUploadPreKeysProtocol\"]);function a(){var a,c,e,f,g,p,q,r,s;return b(\"regeneratorRuntime\").async(function(t){while(1)switch(t.prev=t.next){case 0:t.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getWaOneQueue().enqueue(function(a){var c,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:c=a.cryptoManager;f.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WACryptoManager\").generatePreKeys(c));case 3:e=f.sent;if(e.success){f.next=6;break}return f.abrupt(\"return\",e);case 6:n.LOG(m()).devConsole(\"generation \"+e.value);return f.abrupt(\"return\",d(\"WAGetKeysForUpload\").getKeysForUpload(c,e.value));case 8:case\"end\":return f.stop()}},null,this)},{operationType:\"generate_prekeys\",flush:!0,afterInit:!0}));case 2:a=t.sent;if(!(a.success===!1)){t.next=6;break}n.ERROR(l(),a.error,(c=(e=a.payload)==null?void 0:e.toString())!=null?c:\"none\");return t.abrupt(\"return\",d(\"WAResultOrError\").makeError(\"generate-prekey-error\",a.payload));case 6:f=a.value,g=f.regInfo,p=f.preKeys,q=f.signedPreKey;r=babelHelpers[\"extends\"]({registrationElementValue:d(\"WAWap\").BIG_ENDIAN_CONTENT(g.regId),anyElementValue:g.staticKeyPair.publicKey,keyArgs:p.map(o)},d(\"WAMakeSignedPreKeyMixin\").makeSignedPreKeyMixin(q));s=new(d(\"WAPromiseRetryLoop\").PromiseRetryLoop)({name:\"uploadKeys\",timer:d(\"WARetryUtils\").FIBONACCI_BACKOFF,code:function(a){var c;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:n.LOG(k());e.next=3;return b(\"regeneratorRuntime\").awrap(d(\"WASmaxPreKeysSetRPC\").sendSetRPC(r));case 3:c=e.sent;e.t0=c.name;e.next=e.t0===\"SetResponseSuccess\"?7:e.t0===\"SetResponseRequestError\"?10:13;break;case 7:n.LOG(j());a(d(\"WAResultOrError\").makeResult({preKeys:p}));return e.abrupt(\"return\");case 10:n.WARN(i());a(d(\"WAResultOrError\").makeError(\"request-error\"));return e.abrupt(\"return\");case 13:c.name,n.WARN(h(),c.name);case 15:case\"end\":return e.stop()}},null,this)}});s.start();return t.abrupt(\"return\",s.promise());case 11:case\"end\":return t.stop()}},null,this)}function o(a){var b={idElementValue:d(\"WAWap\").BIG_ENDIAN_CONTENT(a.id,3)};a={anyElementValue:a.keyPair.publicKey};return{keyIDMixinArgs:b,keyDataMixinArgs:a}}g.generateAndUploadPreKeysProtocol=a}),98);\n__d(\"WAGenerateAndUploadPreKeys\",[\"MAWLoggerUtils\",\"WABridge\",\"WAErr\",\"WAGenerateAndUploadPreKeysProtocol\",\"WAJobs\",\"WAOdsEnums\",\"WATagsLogger\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Failed to generate and upload prekeys with error \",\": \",\"}\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"About to generate and upload pre keys\"]);i=function(){return a};return a}var j=d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.PrekeyGenerateAndUpload,d(\"MAWLoggerUtils\").Tag.SignedPrekey]);a=d(\"WAJobs\").getPersistedJobsApi().definePersistedJob().finalStep(\"generateAndUploadPreKeys\",{code:function(a,b,e){b=a.reason;(a=e.eventFlow)==null?void 0:a.addPoint(\"generate_prekeys_execution\",{string:{reason:b}});j.LOG(i());return d(\"WAGenerateAndUploadPreKeysProtocol\").generateAndUploadPreKeysProtocol().then(function(a){if(a.success){d(\"WABridge\").getBridge().fireAndForget(\"event\",\"odsBumpEntityKey\",{entity:d(\"WAOdsEnums\").Entity.PREKEY_UPLOAD,key:\"success\",amount:a.value.preKeys.length},!0);return}var b=a.error;if(b===\"request-error\"){d(\"WABridge\").getBridge().fireAndForget(\"event\",\"odsBumpEntityKey\",{entity:d(\"WAOdsEnums\").Entity.PREKEY_UPLOAD,key:\"malformed\"},!0);throw c(\"WAErr\")(\"Malformed upload keys IQ\")}b;j.ERROR(h(),b,(b=a.payload)==null?void 0:b.message)})}}).end();g.generateAndUploadPreKeys=a}),98);\n__d(\"WARotateSignedPreKeyProtocol\",[\"WACryptoManager\",\"WAErrorMessage\",\"WAGlobals\",\"WAHandleFailureUtils\",\"WAMakeSignedPreKeyMixin\",\"WAResultOrError\",\"WASmaxPreKeysRotateSignedRPC\",\"WATagsLogger\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"successfully rotated new skey\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"ServerError: \",\" \",\"\"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([\"RequestError: \",\" \",\"\"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([\"ValidationError: \",\" \",\"\"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose([\"generated skey. Start rotating skey...\"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([\"start generating skey...\"]);m=function(){return a};return a}var n=d(\"WATagsLogger\").TAGS([\"rotateSignedPreKeyProtocol\"]);function a(){var a,c,e,f,g,o,p,q,r,s,t;return b(\"regeneratorRuntime\").async(function(u){while(1)switch(u.prev=u.next){case 0:n.LOG(m());u.prev=1;u.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return d(\"WACryptoManager\").generateSignedPreKey(a)},{operationType:\"generate_signed_prekey\",flush:!0,afterInit:!0}));case 4:a=u.sent;n.LOG(l());u.next=8;return b(\"regeneratorRuntime\").awrap(d(\"WASmaxPreKeysRotateSignedRPC\").sendRotateSignedRPC({signedPreKeyMixinArgs:d(\"WAMakeSignedPreKeyMixin\").makeSignedPreKeyMixin(a)}));case 8:c=u.sent;u.t0=c.name;u.next=u.t0===\"RotateSignedResponseValidationError\"?12:u.t0===\"RotateSignedResponseRequestError\"?15:u.t0===\"RotateSignedResponseServerError\"?19:23;break;case 12:e=c.value,f=e.errorCode,g=e.errorText,o=e.errorIdentityKeyMixin;n.ERROR(k(),f,g);return u.abrupt(\"return\",d(\"WAResultOrError\").makeError({type:\"validation-error\",identity:o.elementValue}));case 15:p=c.value.errorRequestErrors.value.code;q=c.value.errorRequestErrors.name;n.ERROR(j(),p,q);return u.abrupt(\"return\",d(\"WAResultOrError\").makeError({type:\"request-error\"}));case 19:r=c.value.errorServerErrors.value.code;s=c.value.errorServerErrors.name;n.ERROR(i(),r,s);return u.abrupt(\"return\",d(\"WAResultOrError\").makeError({type:\"server-error\"}));case 23:c.name;n.LOG(h());return u.abrupt(\"return\",d(\"WAResultOrError\").makeResult());case 26:u.next=36;break;case 28:u.prev=28;u.t1=u[\"catch\"](1);t=d(\"WAErrorMessage\").maybeGetMessageFromError(u.t1);if(!t.includes(\"No lastSignedPrekeyId and registration\")){u.next=35;break}u.next=34;return b(\"regeneratorRuntime\").awrap(d(\"WAHandleFailureUtils\").reregisterPhone());case 34:return u.abrupt(\"return\",d(\"WAResultOrError\").makeError({type:\"no-prekey-reregistered\"}));case 35:throw u.t1;case 36:case\"end\":return u.stop()}},null,this,[[1,28]])}g.rotateSignedPreKeyProtocol=a}),98);\n__d(\"WARotateSignedPreKey\",[\"MAWLoggerUtils\",\"WAErr\",\"WAJobDefinitions\",\"WAJobOrchestratorTypes\",\"WAJobs\",\"WARotateSignedPreKeyProtocol\",\"WATagsLogger\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"rotateSignedPreKey failed.\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Signed prekey failed server validation. need to upload all keys.\"]);i=function(){return a};return a}var j=d(\"WATagsLogger\").TAGS([d(\"MAWLoggerUtils\").Tag.SignedPrekeyRotation,d(\"MAWLoggerUtils\").Tag.SignedPrekey]);a=d(\"WAJobs\").getPersistedJobsApi().definePersistedJob().finalStep(\"rotateSignedPreKey\",function(){var a;return b(\"regeneratorRuntime\").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WARotateSignedPreKeyProtocol\").rotateSignedPreKeyProtocol());case 2:a=e.sent;if(!(a.success||a.error.type===\"no-prekey-reregistered\")){e.next=5;break}return e.abrupt(\"return\");case 5:if(!(a.error.type===\"validation-error\")){e.next=8;break}j.ERROR(i());return e.abrupt(\"return\",d(\"WAJobs\").getJobManager().waitUntilPersisted(d(\"WAJobDefinitions\").createStartJobInfo(\"generateAndUploadPreKeys\",{scheduleConfig:{priority:d(\"WAJobOrchestratorTypes\").JOB_PRIORITY.HIGH},reason:\"signed prekey failed server validation\",uniqueJob:!0})));case 8:j.ERROR(h());throw c(\"WAErr\")(\"rotateSignedPreKey RPC failed: \"+a.error.type);case 10:case\"end\":return e.stop()}},null,this)}).end();g.rotateSignedPreKey=a}),98);\n__d(\"WASyncAbProps\",[\"WAAbPropsSync\",\"WAJobs\",\"WALogger\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Syncing ABProps\"]);h=function(){return a};return a}a=d(\"WAJobs\").getPersistedJobsApi().definePersistedJob().finalStep(\"syncAbProps\",{code:function(a,c,e){return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:c=a.sendHash;d(\"WALogger\").LOG(h());f.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WAAbPropsSync\").syncAbProps({sendHash:c,eventFlow:e==null?void 0:e.eventFlow}));case 4:case\"end\":return f.stop()}},null,this)}}).end();g.syncAbProps=a}),98);\n__d(\"WAQueryGroups\",[\"Promise\",\"WAErr\",\"WAGetDevices\",\"WAGlobals\",\"WAJobs\",\"WAQueryGroup\",\"WATimeUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){var e,f,g,i,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:e={groups:[]};if(!(a.type===\"all\")){k.next=10;break}k.next=4;return b(\"regeneratorRuntime\").awrap(d(\"WAQueryGroup\").queryAllGroups());case 4:f=k.sent;if(!(f.success===!1)){k.next=7;break}throw c(\"WAErr\")(\"Failed to parse queryAllGroup response with error \"+JSON.stringify(f.error));case 7:e=f.value;k.next=15;break;case 10:a.type;k.next=13;return b(\"regeneratorRuntime\").awrap((h||(h=b(\"Promise\"))).all(a.groups.map(function(a){var e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WAQueryGroup\").queryGroup(a));case 2:e=f.sent;if(!(e.success===!1)){f.next=5;break}throw c(\"WAErr\")(\"Failed to parse queryGroup response with error \"+JSON.stringify(e.error));case 5:return f.abrupt(\"return\",e.value);case 6:case\"end\":return f.stop()}},null,this)})));case 13:g=k.sent,e={groups:g};case 15:k.next=17;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getDbImpls().createGroups(e.groups.map(function(a){return{groupStatus:\"queried\",groupToCreate:a,serverTs:d(\"WATimeUtils\").unixTime(),extras:void 0,folder:void 0,key:void 0}})));case 17:k.next=19;return b(\"regeneratorRuntime\").awrap(d(\"WAJobs\").getJobResultConvertersImpls().convertQueryGroupsResult==null?void 0:d(\"WAJobs\").getJobResultConvertersImpls().convertQueryGroupsResult(e.groups));case 19:i=k.sent;j=new Set();e.groups.forEach(function(a){return a.participants.forEach(function(a){a.success?j.add(a.value.user):j.add(a.error.user)})});k.next=24;return b(\"regeneratorRuntime\").awrap(d(\"WAGetDevices\").fetchAndSaveDevices(j,\"query-groups\"));case 24:return k.abrupt(\"return\",i||{type:\"default\",groups:e.groups});case 25:case\"end\":return k.stop()}},null,this)}e=d(\"WAJobs\").getPersistedJobsApi().definePersistedJob().finalStep(\"queryGroups\",a).end();g.queryGroupsImpl=a;g.queryGroups=e}),98);\n__d(\"WADeviceUpdateUtils\",[\"Promise\",\"WAGlobals\",\"WAICDCUtils\",\"WAJobDefinitions\",\"WAJobs\",\"WALogger\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"Update user devices signal and DB\"]);i=function(){return a};return a}function a(a){var c,e,f,g,j;return b(\"regeneratorRuntime\").async(function(k){while(1)switch(k.prev=k.next){case 0:if(!(a.length===0)){k.next=2;break}return k.abrupt(\"return\");case 2:c=[];k.next=5;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getWaOneQueue().enqueue(function(e){var f=e.cryptoManager;d(\"WALogger\").LOG(i());return(h||(h=b(\"Promise\"))).all(a.map(function(a){var b;c.push({contactJid:a.jid,dhash:a.dhash,lastSyncTs:a.lastSyncTs,icdcInfo:(b=a.icdcInfo)!=null?b:void 0});return f.storage.updateUserDevicesInfo([a])}))},{operationType:\"get_devices\",flush:!0,afterInit:!0}));case 5:k.next=7;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getDbImpls().bulkPutContacts(c));case 7:e=d(\"WAGlobals\").getMyUserJid();f=a.find(function(a){return a.jid===e});if(!(f!=null)){k.next=15;break}g=f.icdcInfo;if(!(g==null||d(\"WAICDCUtils\").isICDCIndexInvalid(g)||(g==null?void 0:g.dirty))){k.next=15;break}g==null?j=\"empty\":g.dirty?j=\"dirty\":j=\"invalidIndex\";k.next=15;return b(\"regeneratorRuntime\").awrap(d(\"WAJobs\").getJobManager().waitUntilPersisted(d(\"WAJobDefinitions\").jobSerializers.computeAndUploadICDCInfo(j,\"get_devices\",g==null?void 0:g.sequence)));case 15:case\"end\":return k.stop()}},null,this)}g.updateUsersDevicesSignalAndDB=a}),98);\n__d(\"WAFetchFbDevicesProtocol\",[\"Promise\",\"WAArrayChunk\",\"WAErr\",\"WAGlobals\",\"WAHandleFbDeviceChangeNotificationProtocol\",\"WAJids\",\"WAResultOrError\",\"WASignalKeys\",\"WASmaxDevicesFetchRPC\",\"WATimeUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";var h,i=25;function a(a,e){var f,g,k;return b(\"regeneratorRuntime\").async(function(l){while(1)switch(l.prev=l.next){case 0:if(!(a.length===0)){l.next=2;break}return l.abrupt(\"return\",new Map());case 2:f=d(\"WAArrayChunk\").chunk(a,i);if(!e){l.next=7;break}l.t0=new Map();l.next=10;break;case 7:l.next=9;return b(\"regeneratorRuntime\").awrap(d(\"WAGlobals\").getDbImpls().loadContacts(a).then(function(b){var a=new Map();b.forEach(function(b){b&&b.dhash!=null&&a.set(b.contactJid,b.dhash)});return a}));case 9:l.t0=l.sent;case 10:g=l.t0;k=new Map(a.map(function(a){return[a,d(\"WAResultOrError\").makeResult({type:\"dhash-match\"})]}));return l.abrupt(\"return\",(h||(h=b(\"Promise\"))).all(f.map(function(a){return d(\"WASmaxDevicesFetchRPC\").sendFetchRPC({userArgs:a.map(function(a){var b=g.get(a);b=b!=null?{anyDhash:b}:null;return{userJid:a,dhashMixinArgs:b}})}).then(function(a){if(a.name===\"FetchResponseError\")throw c(\"WAErr\")(\"Failed to fetch user devices\");return a.value.usersUser.map(function(a){a=a.userResponseFetchFailureOrFetchSuccessMixinGroup;if(a.name===\"FetchUserResponseFailure\"){k.set(a.value.jid,d(\"WAResultOrError\").makeError());return}a=a.value;var b=a.jid,c=a.devices;a=a.icdc;k.set(b,d(\"WAResultOrError\").makeResult(j(b,c,a,d(\"WATimeUtils\").unixTime())))})})})).then(function(){return k}));case 13:case\"end\":return l.stop()}},null,this)}function e(a){return Array.from(a.values()).flatMap(function(a){return a.success&&a.value.type!==\"dhash-match\"?[a.value]:[]})}function j(a,b,c,e){e===void 0&&(e=null);var f=[],g=null;if(b){f=b.device.map(function(a){var b;return{id:d(\"WAJids\").interpretAsDeviceId(a.id),identity:d(\"WASignalKeys\").serializeIdentity(a.elementValue),platform:(b=a.deviceModelInfoMixin)==null?void 0:(b=b.platform)==null?void 0:b.elementValue,model:(b=a.deviceModelInfoMixin)==null?void 0:(a=b.model)==null?void 0:a.elementValue}});g=(b=b.dhashMixin)==null?void 0:b.dhash}b=null;if(c){c=d(\"WAHandleFbDeviceChangeNotificationProtocol\").parseICDCFromServer(c);b=c.success?c.value:null}return{jid:a,devices:f,lastSyncTs:d(\"WATimeUtils\").unixTime(),dhash:g,icdcInfo:b,notificationTs:e}}g.fetchFbDevicesProtocol=a;g.extractUserDevicesInfo=e}),98);\n__d(\"WAFetchAndSaveDevices\",[\"WADeviceUpdateUtils\",\"WAFetchFbDevicesProtocol\",\"WALogger\",\"WAPREList\",\"WAPREMetrics\",\"WAResultOrError\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getDevices -> update devices signal\"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([\"getDevices called for users \",\"\"]);i=function(){return a};return a}function a(a,b){b===void 0&&(b=!1);return j(a,b)}function j(a,b){b===void 0&&(b=!1);d(\"WALogger\").LOG(i(),Array.from(a));var c=d(\"WAPREMetrics\").startMetric(d(\"WAPREList\").PRE_METRIC.GET_DEVICES);return d(\"WAFetchFbDevicesProtocol\").fetchFbDevicesProtocol(Array.from(a),b).then(function(a){d(\"WALogger\").LOG(h());return d(\"WADeviceUpdateUtils\").updateUsersDevicesSignalAndDB(d(\"WAFetchFbDevicesProtocol\").extractUserDevicesInfo(a)).then(function(){c.addPoint(\"user_devices_signal_and_db_updated\");return new Map(Array.from(a.keys()).map(function(a){return[a,d(\"WAResultOrError\").makeResult()]}))})}).then(function(a){c.endSuccess();return a})[\"catch\"](function(a){c.endFail(\"fail\");throw a})}g.fetchAndSaveDevicesWithResults=a}),98);\n__d(\"WANotifyDeviceChange\",[\"WAErr\",\"WAGlobals\",\"WAJobs\",\"WALogger\",\"WAPersistedJobManager\",\"WASmaxDevicesNotifyRPC\",\"WATimeUtils\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";function h(){var a=babelHelpers.taggedTemplateLiteralLoose([\"The maximum number of users that can be notified is \",\"\"]);h=function(){return a};return a}a=d(\"WAJobs\").getPersistedJobsApi().definePersistedJob().finalStep(\"notifyDeviceChange\",function(a){a=a.users;if(a.size===0)return;var b=d(\"WAGlobals\").getConfig().maxUsersForNotifyDeviceChange(),c=Array.from(a);a.size>b&&(d(\"WALogger\").ERROR(h(),b),c=c.slice(0,b));return i(c)}).end();function i(a){var e,f,g;return b(\"regeneratorRuntime\").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b(\"regeneratorRuntime\").awrap(d(\"WASmaxDevicesNotifyRPC\").sendNotifyRPC({userArgs:a.map(function(a){return{userJid:a}})}));case 2:e=h.sent;if(!(e.name===\"NotifyResponseSuccess\")){h.next=5;break}return h.abrupt(\"return\");case 5:e.name;f=e.value.errorRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup;if(!(f.name===\"RetryableIQError\")){h.next=14;break}g=f.value.backoff;if(!(g!=null)){h.next=13;break}throw new(d(\"WAPersistedJobManager\").RetryOnBackoff)({algo:{type:\"constant\",delay:g},jitter:0});case 13:throw new(d(\"WAPersistedJobManager\").RetryOnBackoff)({algo:{type:\"exponential\",first:d(\"WATimeUtils\").HOUR_MILLISECONDS\/60},jitter:.1});case 14:throw c(\"WAErr\")(\"Failed with an unexpected error code \"+f.value.code);case 15:case\"end\":return h.stop()}},null,this)}g.notifyDeviceChange=a}),98);\n__d(\"WAGetClockSkewApi\",[\"WAGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(){return d(\"WAGlobals\").getDbImpls().getMeta().then(function(a){a=a.clockSkew;return{clockSkew:a||0}})};g.getClockSkew=a}),98);\n__d(\"WASetAuthKeyPair\",[\"WAGlobals\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){return d(\"WAGlobals\").getDbImpls().setMeta({authKeyPair:a})};g.setAuthKeyPair=a}),98);\n__d(\"WAInitAndGetAuthKeyPair\",[\"Promise\",\"WACryptoCurve25519\",\"WACryptoCurve25519Dependencies\",\"WASetAuthKeyPair\"],(function(a,b,c,d,e,f,g){\"use strict\";var h;function a(a){return a.authKeyPair!=null?(h||(h=b(\"Promise\"))).resolve(a.authKeyPair):new(d(\"WACryptoCurve25519\").Curve25519)(d(\"WACryptoCurve25519Dependencies\").CURVE25519_SIGNAL_DEPENDENCIES).keyPair.then(function(a){return d(\"WASetAuthKeyPair\").setAuthKeyPair(a).then(function(){return a})})}g.initAndGetAuthKeyPair=a}),98);\n__d(\"WASendPresenceStatusProtocol\",[\"WASmaxPresenceAvailabilityRPC\"],(function(a,b,c,d,e,f,g){\"use strict\";function a(a){var b=a.status;a=a.name;return d(\"WASmaxPresenceAvailabilityRPC\").sendAvailabilityRPC({presenceType:b,presenceName:a})}g.sendPresenceStatusProtocol=a}),98);\n__d(\"WAGetGroupInfo\",[\"WAGlobals\",\"regeneratorRuntime\"],(function(a,b,c,d,e,f,g){\"use strict\";a=function(a){return d(\"WAGlobals\").runInTransaction({GroupInfoStore:!0},function(b){b=b.GroupInfoStore;return h({GroupInfoStore:b},a)},\"getGroupInfo\")};function h(a,c){var d,e;return b(\"regeneratorRuntime\").async(function(f){while(1)switch(f.prev=f.next){case 0:d=a.GroupInfoStore;f.next=3;return b(\"regeneratorRuntime\").awrap(d.get(c));case 3:e=f.sent;return f.abrupt(\"return\",e.success?e.value:null);case 5:case\"end\":return f.stop()}},null,this)}g.getGroupInfo=a;g.getGroupInfoTransactor=h}),98);"
        },
        "redirectURL": "",
        "headersSize": -1,
        "bodySize": -1,
        "_transferSize": 325335,
        "_error": null
    },
    "serverIPAddress": "[2a03:2880:f242:1cb:face:b00c:0:43fe]",
    "startedDateTime": "2024-04-12T15:26:10.789Z",
    "time": 2059.329000003345,
    "timings": {
        "blocked": 17.01100000272086,
        "dns": -1,
        "ssl": -1,
        "connect": -1,
        "send": 0.7439999999999998,
        "wait": 955.8880000020922,
        "receive": 1085.6859999985318,
        "_blocked_queueing": 1.534000002720859
    }
}